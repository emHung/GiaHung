var Zie=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var cXe=Zie((OXe,iE)=>{function ese(t,e){for(var r=0;r<e.length;r++){const i=e[r];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in t)){const n=Object.getOwnPropertyDescriptor(i,s);n&&Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function tse(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}),r}var PU={exports:{}},JT={},FU={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C=Symbol.for("react.element"),rse=Symbol.for("react.portal"),nse=Symbol.for("react.fragment"),ise=Symbol.for("react.strict_mode"),sse=Symbol.for("react.profiler"),ose=Symbol.for("react.provider"),ase=Symbol.for("react.context"),lse=Symbol.for("react.forward_ref"),cse=Symbol.for("react.suspense"),use=Symbol.for("react.memo"),hse=Symbol.for("react.lazy"),GH=Symbol.iterator;function fse(t){return t===null||typeof t!="object"?null:(t=GH&&t[GH]||t["@@iterator"],typeof t=="function"?t:null)}var MU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kU=Object.assign,NU={};function w1(t,e,r){this.props=t,this.context=e,this.refs=NU,this.updater=r||MU}w1.prototype.isReactComponent={};w1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};w1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function DU(){}DU.prototype=w1.prototype;function JF(t,e,r){this.props=t,this.context=e,this.refs=NU,this.updater=r||MU}var QF=JF.prototype=new DU;QF.constructor=JF;kU(QF,w1.prototype);QF.isPureReactComponent=!0;var YH=Array.isArray,LU=Object.prototype.hasOwnProperty,ZF={current:null},HU={key:!0,ref:!0,__self:!0,__source:!0};function $U(t,e,r){var i,s={},n=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(n=""+e.key),e)LU.call(e,i)&&!HU.hasOwnProperty(i)&&(s[i]=e[i]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var h=Array(l),d=0;d<l;d++)h[d]=arguments[d+2];s.children=h}if(t&&t.defaultProps)for(i in l=t.defaultProps,l)s[i]===void 0&&(s[i]=l[i]);return{$$typeof:_C,type:t,key:n,ref:o,props:s,_owner:ZF.current}}function dse(t,e){return{$$typeof:_C,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function eM(t){return typeof t=="object"&&t!==null&&t.$$typeof===_C}function gse(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var KH=/\/+/g;function jA(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gse(""+t.key):e.toString(36)}function p2(t,e,r,i,s){var n=typeof t;(n==="undefined"||n==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _C:case rse:o=!0}}if(o)return o=t,s=s(o),t=i===""?"."+jA(o,0):i,YH(s)?(r="",t!=null&&(r=t.replace(KH,"$&/")+"/"),p2(s,e,r,"",function(d){return d})):s!=null&&(eM(s)&&(s=dse(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(KH,"$&/")+"/")+t)),e.push(s)),1;if(o=0,i=i===""?".":i+":",YH(t))for(var l=0;l<t.length;l++){n=t[l];var h=i+jA(n,l);o+=p2(n,e,r,h,s)}else if(h=fse(t),typeof h=="function")for(t=h.call(t),l=0;!(n=t.next()).done;)n=n.value,h=i+jA(n,l++),o+=p2(n,e,r,h,s);else if(n==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rb(t,e,r){if(t==null)return t;var i=[],s=0;return p2(t,i,"","",function(n){return e.call(r,n,s++)}),i}function mse(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var oa={current:null},v2={transition:null},pse={ReactCurrentDispatcher:oa,ReactCurrentBatchConfig:v2,ReactCurrentOwner:ZF};function BU(){throw Error("act(...) is not supported in production builds of React.")}cn.Children={map:rb,forEach:function(t,e,r){rb(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return rb(t,function(){e++}),e},toArray:function(t){return rb(t,function(e){return e})||[]},only:function(t){if(!eM(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cn.Component=w1;cn.Fragment=nse;cn.Profiler=sse;cn.PureComponent=JF;cn.StrictMode=ise;cn.Suspense=cse;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pse;cn.act=BU;cn.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=kU({},t.props),s=t.key,n=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(n=e.ref,o=ZF.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)LU.call(e,h)&&!HU.hasOwnProperty(h)&&(i[h]=e[h]===void 0&&l!==void 0?l[h]:e[h])}var h=arguments.length-2;if(h===1)i.children=r;else if(1<h){l=Array(h);for(var d=0;d<h;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:_C,type:t.type,key:s,ref:n,props:i,_owner:o}};cn.createContext=function(t){return t={$$typeof:ase,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ose,_context:t},t.Consumer=t};cn.createElement=$U;cn.createFactory=function(t){var e=$U.bind(null,t);return e.type=t,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(t){return{$$typeof:lse,render:t}};cn.isValidElement=eM;cn.lazy=function(t){return{$$typeof:hse,_payload:{_status:-1,_result:t},_init:mse}};cn.memo=function(t,e){return{$$typeof:use,type:t,compare:e===void 0?null:e}};cn.startTransition=function(t){var e=v2.transition;v2.transition={};try{t()}finally{v2.transition=e}};cn.unstable_act=BU;cn.useCallback=function(t,e){return oa.current.useCallback(t,e)};cn.useContext=function(t){return oa.current.useContext(t)};cn.useDebugValue=function(){};cn.useDeferredValue=function(t){return oa.current.useDeferredValue(t)};cn.useEffect=function(t,e){return oa.current.useEffect(t,e)};cn.useId=function(){return oa.current.useId()};cn.useImperativeHandle=function(t,e,r){return oa.current.useImperativeHandle(t,e,r)};cn.useInsertionEffect=function(t,e){return oa.current.useInsertionEffect(t,e)};cn.useLayoutEffect=function(t,e){return oa.current.useLayoutEffect(t,e)};cn.useMemo=function(t,e){return oa.current.useMemo(t,e)};cn.useReducer=function(t,e,r){return oa.current.useReducer(t,e,r)};cn.useRef=function(t){return oa.current.useRef(t)};cn.useState=function(t){return oa.current.useState(t)};cn.useSyncExternalStore=function(t,e,r){return oa.current.useSyncExternalStore(t,e,r)};cn.useTransition=function(){return oa.current.useTransition()};cn.version="18.3.1";FU.exports=cn;var We=FU.exports;const br=qF(We),vse=ese({__proto__:null,default:br},[We]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wse=We,yse=Symbol.for("react.element"),Cse=Symbol.for("react.fragment"),Sse=Object.prototype.hasOwnProperty,bse=wse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xse={key:!0,ref:!0,__self:!0,__source:!0};function VU(t,e,r){var i,s={},n=null,o=null;r!==void 0&&(n=""+r),e.key!==void 0&&(n=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Sse.call(e,i)&&!xse.hasOwnProperty(i)&&(s[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:yse,type:t,key:n,ref:o,props:s,_owner:bse.current}}JT.Fragment=Cse;JT.jsx=VU;JT.jsxs=VU;PU.exports=JT;var V=PU.exports,x3={},WU={exports:{}},al={},jU={exports:{}},UU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Pe,Be){var Me=Pe.length;Pe.push(Be);e:for(;0<Me;){var A=Me-1>>>1,O=Pe[A];if(0<s(O,Be))Pe[A]=Be,Pe[Me]=O,Me=A;else break e}}function r(Pe){return Pe.length===0?null:Pe[0]}function i(Pe){if(Pe.length===0)return null;var Be=Pe[0],Me=Pe.pop();if(Me!==Be){Pe[0]=Me;e:for(var A=0,O=Pe.length,N=O>>>1;A<N;){var H=2*(A+1)-1,B=Pe[H],K=H+1,Z=Pe[K];if(0>s(B,Me))K<O&&0>s(Z,B)?(Pe[A]=Z,Pe[K]=Me,A=K):(Pe[A]=B,Pe[H]=Me,A=H);else if(K<O&&0>s(Z,Me))Pe[A]=Z,Pe[K]=Me,A=K;else break e}}return Be}function s(Pe,Be){var Me=Pe.sortIndex-Be.sortIndex;return Me!==0?Me:Pe.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;t.unstable_now=function(){return n.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var h=[],d=[],g=1,y=null,C=3,x=!1,_=!1,E=!1,R=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function D(Pe){for(var Be=r(d);Be!==null;){if(Be.callback===null)i(d);else if(Be.startTime<=Pe)i(d),Be.sortIndex=Be.expirationTime,e(h,Be);else break;Be=r(d)}}function U(Pe){if(E=!1,D(Pe),!_)if(r(h)!==null)_=!0,Ze(X);else{var Be=r(d);Be!==null&&Xe(U,Be.startTime-Pe)}}function X(Pe,Be){_=!1,E&&(E=!1,I(oe),oe=-1),x=!0;var Me=C;try{for(D(Be),y=r(h);y!==null&&(!(y.expirationTime>Be)||Pe&&!ye());){var A=y.callback;if(typeof A=="function"){y.callback=null,C=y.priorityLevel;var O=A(y.expirationTime<=Be);Be=t.unstable_now(),typeof O=="function"?y.callback=O:y===r(h)&&i(h),D(Be)}else i(h);y=r(h)}if(y!==null)var N=!0;else{var H=r(d);H!==null&&Xe(U,H.startTime-Be),N=!1}return N}finally{y=null,C=Me,x=!1}}var te=!1,Y=null,oe=-1,me=5,de=-1;function ye(){return!(t.unstable_now()-de<me)}function Ee(){if(Y!==null){var Pe=t.unstable_now();de=Pe;var Be=!0;try{Be=Y(!0,Pe)}finally{Be?ke():(te=!1,Y=null)}}else te=!1}var ke;if(typeof F=="function")ke=function(){F(Ee)};else if(typeof MessageChannel<"u"){var nt=new MessageChannel,at=nt.port2;nt.port1.onmessage=Ee,ke=function(){at.postMessage(null)}}else ke=function(){R(Ee,0)};function Ze(Pe){Y=Pe,te||(te=!0,ke())}function Xe(Pe,Be){oe=R(function(){Pe(t.unstable_now())},Be)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Pe){Pe.callback=null},t.unstable_continueExecution=function(){_||x||(_=!0,Ze(X))},t.unstable_forceFrameRate=function(Pe){0>Pe||125<Pe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<Pe?Math.floor(1e3/Pe):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return r(h)},t.unstable_next=function(Pe){switch(C){case 1:case 2:case 3:var Be=3;break;default:Be=C}var Me=C;C=Be;try{return Pe()}finally{C=Me}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Pe,Be){switch(Pe){case 1:case 2:case 3:case 4:case 5:break;default:Pe=3}var Me=C;C=Pe;try{return Be()}finally{C=Me}},t.unstable_scheduleCallback=function(Pe,Be,Me){var A=t.unstable_now();switch(typeof Me=="object"&&Me!==null?(Me=Me.delay,Me=typeof Me=="number"&&0<Me?A+Me:A):Me=A,Pe){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Me+O,Pe={id:g++,callback:Be,priorityLevel:Pe,startTime:Me,expirationTime:O,sortIndex:-1},Me>A?(Pe.sortIndex=Me,e(d,Pe),r(h)===null&&Pe===r(d)&&(E?(I(oe),oe=-1):E=!0,Xe(U,Me-A))):(Pe.sortIndex=O,e(h,Pe),_||x||(_=!0,Ze(X))),Pe},t.unstable_shouldYield=ye,t.unstable_wrapCallback=function(Pe){var Be=C;return function(){var Me=C;C=Be;try{return Pe.apply(this,arguments)}finally{C=Me}}}})(UU);jU.exports=UU;var Ese=jU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tse=We,il=Ese;function Rt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zU=new Set,Iy={};function $g(t,e){e1(t,e),e1(t+"Capture",e)}function e1(t,e){for(Iy[t]=e,t=0;t<e.length;t++)zU.add(e[t])}var Kh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),E3=Object.prototype.hasOwnProperty,_se=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,XH={},qH={};function Rse(t){return E3.call(qH,t)?!0:E3.call(XH,t)?!1:_se.test(t)?qH[t]=!0:(XH[t]=!0,!1)}function Ase(t,e,r,i){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ose(t,e,r,i){if(e===null||typeof e>"u"||Ase(t,e,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function aa(t,e,r,i,s,n,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=n,this.removeEmptyString=o}var ao={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ao[t]=new aa(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ao[e]=new aa(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ao[t]=new aa(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ao[t]=new aa(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ao[t]=new aa(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ao[t]=new aa(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ao[t]=new aa(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ao[t]=new aa(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ao[t]=new aa(t,5,!1,t.toLowerCase(),null,!1,!1)});var tM=/[\-:]([a-z])/g;function rM(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(tM,rM);ao[e]=new aa(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(tM,rM);ao[e]=new aa(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(tM,rM);ao[e]=new aa(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ao[t]=new aa(t,1,!1,t.toLowerCase(),null,!1,!1)});ao.xlinkHref=new aa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ao[t]=new aa(t,1,!1,t.toLowerCase(),null,!0,!0)});function nM(t,e,r,i){var s=ao.hasOwnProperty(e)?ao[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ose(e,r,s,i)&&(r=null),i||s===null?Rse(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,i=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,i?t.setAttributeNS(i,e,r):t.setAttribute(e,r))))}var of=Tse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nb=Symbol.for("react.element"),mp=Symbol.for("react.portal"),pp=Symbol.for("react.fragment"),iM=Symbol.for("react.strict_mode"),T3=Symbol.for("react.profiler"),GU=Symbol.for("react.provider"),YU=Symbol.for("react.context"),sM=Symbol.for("react.forward_ref"),_3=Symbol.for("react.suspense"),R3=Symbol.for("react.suspense_list"),oM=Symbol.for("react.memo"),Wf=Symbol.for("react.lazy"),KU=Symbol.for("react.offscreen"),JH=Symbol.iterator;function yv(t){return t===null||typeof t!="object"?null:(t=JH&&t[JH]||t["@@iterator"],typeof t=="function"?t:null)}var Hi=Object.assign,UA;function Nw(t){if(UA===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);UA=e&&e[1]||""}return`
`+UA+t}var zA=!1;function GA(t,e){if(!t||zA)return"";zA=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var i=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){i=d}t.call(e.prototype)}else{try{throw Error()}catch(d){i=d}t()}}catch(d){if(d&&i&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),n=i.stack.split(`
`),o=s.length-1,l=n.length-1;1<=o&&0<=l&&s[o]!==n[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==n[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==n[l]){var h=`
`+s[o].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=o&&0<=l);break}}}finally{zA=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Nw(t):""}function Ise(t){switch(t.tag){case 5:return Nw(t.type);case 16:return Nw("Lazy");case 13:return Nw("Suspense");case 19:return Nw("SuspenseList");case 0:case 2:case 15:return t=GA(t.type,!1),t;case 11:return t=GA(t.type.render,!1),t;case 1:return t=GA(t.type,!0),t;default:return""}}function A3(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pp:return"Fragment";case mp:return"Portal";case T3:return"Profiler";case iM:return"StrictMode";case _3:return"Suspense";case R3:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case YU:return(t.displayName||"Context")+".Consumer";case GU:return(t._context.displayName||"Context")+".Provider";case sM:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case oM:return e=t.displayName||null,e!==null?e:A3(t.type)||"Memo";case Wf:e=t._payload,t=t._init;try{return A3(t(e))}catch{}}return null}function Pse(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A3(e);case 8:return e===iM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Td(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function XU(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Fse(t){var e=XU(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,n=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,n.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ib(t){t._valueTracker||(t._valueTracker=Fse(t))}function qU(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),i="";return t&&(i=XU(t)?t.checked?"true":"false":t.value),t=i,t!==r?(e.setValue(t),!0):!1}function sE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function O3(t,e){var r=e.checked;return Hi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function QH(t,e){var r=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;r=Td(e.value!=null?e.value:r),t._wrapperState={initialChecked:i,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function JU(t,e){e=e.checked,e!=null&&nM(t,"checked",e,!1)}function I3(t,e){JU(t,e);var r=Td(e.value),i=e.type;if(r!=null)i==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?P3(t,e.type,r):e.hasOwnProperty("defaultValue")&&P3(t,e.type,Td(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ZH(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function P3(t,e,r){(e!=="number"||sE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Dw=Array.isArray;function Np(t,e,r,i){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&i&&(t[r].defaultSelected=!0)}else{for(r=""+Td(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,i&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function F3(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Rt(91));return Hi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function e7(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(Rt(92));if(Dw(r)){if(1<r.length)throw Error(Rt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Td(r)}}function QU(t,e){var r=Td(e.value),i=Td(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),i!=null&&(t.defaultValue=""+i)}function t7(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ZU(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function M3(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ZU(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sb,ez=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,i,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,i,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sb=sb||document.createElement("div"),sb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Py(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Yw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mse=["Webkit","ms","Moz","O"];Object.keys(Yw).forEach(function(t){Mse.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yw[e]=Yw[t]})});function tz(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Yw.hasOwnProperty(t)&&Yw[t]?(""+e).trim():e+"px"}function rz(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var i=r.indexOf("--")===0,s=tz(r,e[r],i);r==="float"&&(r="cssFloat"),i?t.setProperty(r,s):t[r]=s}}var kse=Hi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function k3(t,e){if(e){if(kse[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Rt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Rt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Rt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Rt(62))}}function N3(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var D3=null;function aM(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var L3=null,Dp=null,Lp=null;function r7(t){if(t=OC(t)){if(typeof L3!="function")throw Error(Rt(280));var e=t.stateNode;e&&(e=r_(e),L3(t.stateNode,t.type,e))}}function nz(t){Dp?Lp?Lp.push(t):Lp=[t]:Dp=t}function iz(){if(Dp){var t=Dp,e=Lp;if(Lp=Dp=null,r7(t),e)for(t=0;t<e.length;t++)r7(e[t])}}function sz(t,e){return t(e)}function oz(){}var YA=!1;function az(t,e,r){if(YA)return t(e,r);YA=!0;try{return sz(t,e,r)}finally{YA=!1,(Dp!==null||Lp!==null)&&(oz(),iz())}}function Fy(t,e){var r=t.stateNode;if(r===null)return null;var i=r_(r);if(i===null)return null;r=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(Rt(231,e,typeof r));return r}var H3=!1;if(Kh)try{var Cv={};Object.defineProperty(Cv,"passive",{get:function(){H3=!0}}),window.addEventListener("test",Cv,Cv),window.removeEventListener("test",Cv,Cv)}catch{H3=!1}function Nse(t,e,r,i,s,n,o,l,h){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(g){this.onError(g)}}var Kw=!1,oE=null,aE=!1,$3=null,Dse={onError:function(t){Kw=!0,oE=t}};function Lse(t,e,r,i,s,n,o,l,h){Kw=!1,oE=null,Nse.apply(Dse,arguments)}function Hse(t,e,r,i,s,n,o,l,h){if(Lse.apply(this,arguments),Kw){if(Kw){var d=oE;Kw=!1,oE=null}else throw Error(Rt(198));aE||(aE=!0,$3=d)}}function Bg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function lz(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function n7(t){if(Bg(t)!==t)throw Error(Rt(188))}function $se(t){var e=t.alternate;if(!e){if(e=Bg(t),e===null)throw Error(Rt(188));return e!==t?null:t}for(var r=t,i=e;;){var s=r.return;if(s===null)break;var n=s.alternate;if(n===null){if(i=s.return,i!==null){r=i;continue}break}if(s.child===n.child){for(n=s.child;n;){if(n===r)return n7(s),t;if(n===i)return n7(s),e;n=n.sibling}throw Error(Rt(188))}if(r.return!==i.return)r=s,i=n;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,i=n;break}if(l===i){o=!0,i=s,r=n;break}l=l.sibling}if(!o){for(l=n.child;l;){if(l===r){o=!0,r=n,i=s;break}if(l===i){o=!0,i=n,r=s;break}l=l.sibling}if(!o)throw Error(Rt(189))}}if(r.alternate!==i)throw Error(Rt(190))}if(r.tag!==3)throw Error(Rt(188));return r.stateNode.current===r?t:e}function cz(t){return t=$se(t),t!==null?uz(t):null}function uz(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uz(t);if(e!==null)return e;t=t.sibling}return null}var hz=il.unstable_scheduleCallback,i7=il.unstable_cancelCallback,Bse=il.unstable_shouldYield,Vse=il.unstable_requestPaint,rs=il.unstable_now,Wse=il.unstable_getCurrentPriorityLevel,lM=il.unstable_ImmediatePriority,fz=il.unstable_UserBlockingPriority,lE=il.unstable_NormalPriority,jse=il.unstable_LowPriority,dz=il.unstable_IdlePriority,QT=null,Du=null;function Use(t){if(Du&&typeof Du.onCommitFiberRoot=="function")try{Du.onCommitFiberRoot(QT,t,void 0,(t.current.flags&128)===128)}catch{}}var Rc=Math.clz32?Math.clz32:Yse,zse=Math.log,Gse=Math.LN2;function Yse(t){return t>>>=0,t===0?32:31-(zse(t)/Gse|0)|0}var ob=64,ab=4194304;function Lw(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cE(t,e){var r=t.pendingLanes;if(r===0)return 0;var i=0,s=t.suspendedLanes,n=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?i=Lw(l):(n&=o,n!==0&&(i=Lw(n)))}else o=r&~s,o!==0?i=Lw(o):n!==0&&(i=Lw(n));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,n=e&-e,s>=n||s===16&&(n&4194240)!==0))return e;if(i&4&&(i|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)r=31-Rc(e),s=1<<r,i|=t[r],e&=~s;return i}function Kse(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xse(t,e){for(var r=t.suspendedLanes,i=t.pingedLanes,s=t.expirationTimes,n=t.pendingLanes;0<n;){var o=31-Rc(n),l=1<<o,h=s[o];h===-1?(!(l&r)||l&i)&&(s[o]=Kse(l,e)):h<=e&&(t.expiredLanes|=l),n&=~l}}function B3(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gz(){var t=ob;return ob<<=1,!(ob&4194240)&&(ob=64),t}function KA(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function RC(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Rc(e),t[e]=r}function qse(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Rc(r),n=1<<s;e[s]=0,i[s]=-1,t[s]=-1,r&=~n}}function cM(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var i=31-Rc(r),s=1<<i;s&e|t[i]&e&&(t[i]|=e),r&=~s}}var Yn=0;function mz(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pz,uM,vz,wz,yz,V3=!1,lb=[],fd=null,dd=null,gd=null,My=new Map,ky=new Map,Xf=[],Jse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function s7(t,e){switch(t){case"focusin":case"focusout":fd=null;break;case"dragenter":case"dragleave":dd=null;break;case"mouseover":case"mouseout":gd=null;break;case"pointerover":case"pointerout":My.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ky.delete(e.pointerId)}}function Sv(t,e,r,i,s,n){return t===null||t.nativeEvent!==n?(t={blockedOn:e,domEventName:r,eventSystemFlags:i,nativeEvent:n,targetContainers:[s]},e!==null&&(e=OC(e),e!==null&&uM(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Qse(t,e,r,i,s){switch(e){case"focusin":return fd=Sv(fd,t,e,r,i,s),!0;case"dragenter":return dd=Sv(dd,t,e,r,i,s),!0;case"mouseover":return gd=Sv(gd,t,e,r,i,s),!0;case"pointerover":var n=s.pointerId;return My.set(n,Sv(My.get(n)||null,t,e,r,i,s)),!0;case"gotpointercapture":return n=s.pointerId,ky.set(n,Sv(ky.get(n)||null,t,e,r,i,s)),!0}return!1}function Cz(t){var e=eg(t.target);if(e!==null){var r=Bg(e);if(r!==null){if(e=r.tag,e===13){if(e=lz(r),e!==null){t.blockedOn=e,yz(t.priority,function(){vz(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function w2(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=W3(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var i=new r.constructor(r.type,r);D3=i,r.target.dispatchEvent(i),D3=null}else return e=OC(r),e!==null&&uM(e),t.blockedOn=r,!1;e.shift()}return!0}function o7(t,e,r){w2(t)&&r.delete(e)}function Zse(){V3=!1,fd!==null&&w2(fd)&&(fd=null),dd!==null&&w2(dd)&&(dd=null),gd!==null&&w2(gd)&&(gd=null),My.forEach(o7),ky.forEach(o7)}function bv(t,e){t.blockedOn===e&&(t.blockedOn=null,V3||(V3=!0,il.unstable_scheduleCallback(il.unstable_NormalPriority,Zse)))}function Ny(t){function e(s){return bv(s,t)}if(0<lb.length){bv(lb[0],t);for(var r=1;r<lb.length;r++){var i=lb[r];i.blockedOn===t&&(i.blockedOn=null)}}for(fd!==null&&bv(fd,t),dd!==null&&bv(dd,t),gd!==null&&bv(gd,t),My.forEach(e),ky.forEach(e),r=0;r<Xf.length;r++)i=Xf[r],i.blockedOn===t&&(i.blockedOn=null);for(;0<Xf.length&&(r=Xf[0],r.blockedOn===null);)Cz(r),r.blockedOn===null&&Xf.shift()}var Hp=of.ReactCurrentBatchConfig,uE=!0;function eoe(t,e,r,i){var s=Yn,n=Hp.transition;Hp.transition=null;try{Yn=1,hM(t,e,r,i)}finally{Yn=s,Hp.transition=n}}function toe(t,e,r,i){var s=Yn,n=Hp.transition;Hp.transition=null;try{Yn=4,hM(t,e,r,i)}finally{Yn=s,Hp.transition=n}}function hM(t,e,r,i){if(uE){var s=W3(t,e,r,i);if(s===null)i4(t,e,i,hE,r),s7(t,i);else if(Qse(s,t,e,r,i))i.stopPropagation();else if(s7(t,i),e&4&&-1<Jse.indexOf(t)){for(;s!==null;){var n=OC(s);if(n!==null&&pz(n),n=W3(t,e,r,i),n===null&&i4(t,e,i,hE,r),n===s)break;s=n}s!==null&&i.stopPropagation()}else i4(t,e,i,null,r)}}var hE=null;function W3(t,e,r,i){if(hE=null,t=aM(i),t=eg(t),t!==null)if(e=Bg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=lz(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hE=t,null}function Sz(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wse()){case lM:return 1;case fz:return 4;case lE:case jse:return 16;case dz:return 536870912;default:return 16}default:return 16}}var ed=null,fM=null,y2=null;function bz(){if(y2)return y2;var t,e=fM,r=e.length,i,s="value"in ed?ed.value:ed.textContent,n=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(i=1;i<=o&&e[r-i]===s[n-i];i++);return y2=s.slice(t,1<i?1-i:void 0)}function C2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cb(){return!0}function a7(){return!1}function ll(t){function e(r,i,s,n,o){this._reactName=r,this._targetInst=s,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(n):n[l]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?cb:a7,this.isPropagationStopped=a7,this}return Hi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cb)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cb)},persist:function(){},isPersistent:cb}),e}var y1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dM=ll(y1),AC=Hi({},y1,{view:0,detail:0}),roe=ll(AC),XA,qA,xv,ZT=Hi({},AC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gM,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xv&&(xv&&t.type==="mousemove"?(XA=t.screenX-xv.screenX,qA=t.screenY-xv.screenY):qA=XA=0,xv=t),XA)},movementY:function(t){return"movementY"in t?t.movementY:qA}}),l7=ll(ZT),noe=Hi({},ZT,{dataTransfer:0}),ioe=ll(noe),soe=Hi({},AC,{relatedTarget:0}),JA=ll(soe),ooe=Hi({},y1,{animationName:0,elapsedTime:0,pseudoElement:0}),aoe=ll(ooe),loe=Hi({},y1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),coe=ll(loe),uoe=Hi({},y1,{data:0}),c7=ll(uoe),hoe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},foe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},doe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function goe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=doe[t])?!!e[t]:!1}function gM(){return goe}var moe=Hi({},AC,{key:function(t){if(t.key){var e=hoe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=C2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?foe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gM,charCode:function(t){return t.type==="keypress"?C2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?C2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),poe=ll(moe),voe=Hi({},ZT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),u7=ll(voe),woe=Hi({},AC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gM}),yoe=ll(woe),Coe=Hi({},y1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Soe=ll(Coe),boe=Hi({},ZT,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xoe=ll(boe),Eoe=[9,13,27,32],mM=Kh&&"CompositionEvent"in window,Xw=null;Kh&&"documentMode"in document&&(Xw=document.documentMode);var Toe=Kh&&"TextEvent"in window&&!Xw,xz=Kh&&(!mM||Xw&&8<Xw&&11>=Xw),h7=" ",f7=!1;function Ez(t,e){switch(t){case"keyup":return Eoe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tz(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vp=!1;function _oe(t,e){switch(t){case"compositionend":return Tz(e);case"keypress":return e.which!==32?null:(f7=!0,h7);case"textInput":return t=e.data,t===h7&&f7?null:t;default:return null}}function Roe(t,e){if(vp)return t==="compositionend"||!mM&&Ez(t,e)?(t=bz(),y2=fM=ed=null,vp=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xz&&e.locale!=="ko"?null:e.data;default:return null}}var Aoe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d7(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Aoe[t.type]:e==="textarea"}function _z(t,e,r,i){nz(i),e=fE(e,"onChange"),0<e.length&&(r=new dM("onChange","change",null,r,i),t.push({event:r,listeners:e}))}var qw=null,Dy=null;function Ooe(t){Lz(t,0)}function e_(t){var e=Cp(t);if(qU(e))return t}function Ioe(t,e){if(t==="change")return e}var Rz=!1;if(Kh){var QA;if(Kh){var ZA="oninput"in document;if(!ZA){var g7=document.createElement("div");g7.setAttribute("oninput","return;"),ZA=typeof g7.oninput=="function"}QA=ZA}else QA=!1;Rz=QA&&(!document.documentMode||9<document.documentMode)}function m7(){qw&&(qw.detachEvent("onpropertychange",Az),Dy=qw=null)}function Az(t){if(t.propertyName==="value"&&e_(Dy)){var e=[];_z(e,Dy,t,aM(t)),az(Ooe,e)}}function Poe(t,e,r){t==="focusin"?(m7(),qw=e,Dy=r,qw.attachEvent("onpropertychange",Az)):t==="focusout"&&m7()}function Foe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return e_(Dy)}function Moe(t,e){if(t==="click")return e_(e)}function koe(t,e){if(t==="input"||t==="change")return e_(e)}function Noe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fc=typeof Object.is=="function"?Object.is:Noe;function Ly(t,e){if(Fc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var s=r[i];if(!E3.call(e,s)||!Fc(t[s],e[s]))return!1}return!0}function p7(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function v7(t,e){var r=p7(t);t=0;for(var i;r;){if(r.nodeType===3){if(i=t+r.textContent.length,t<=e&&i>=e)return{node:r,offset:e-t};t=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=p7(r)}}function Oz(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Oz(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Iz(){for(var t=window,e=sE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=sE(t.document)}return e}function pM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Doe(t){var e=Iz(),r=t.focusedElem,i=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Oz(r.ownerDocument.documentElement,r)){if(i!==null&&pM(r)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,n=Math.min(i.start,s);i=i.end===void 0?n:Math.min(i.end,s),!t.extend&&n>i&&(s=i,i=n,n=s),s=v7(r,n);var o=v7(r,i);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),n>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Loe=Kh&&"documentMode"in document&&11>=document.documentMode,wp=null,j3=null,Jw=null,U3=!1;function w7(t,e,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;U3||wp==null||wp!==sE(i)||(i=wp,"selectionStart"in i&&pM(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Jw&&Ly(Jw,i)||(Jw=i,i=fE(j3,"onSelect"),0<i.length&&(e=new dM("onSelect","select",null,e,r),t.push({event:e,listeners:i}),e.target=wp)))}function ub(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var yp={animationend:ub("Animation","AnimationEnd"),animationiteration:ub("Animation","AnimationIteration"),animationstart:ub("Animation","AnimationStart"),transitionend:ub("Transition","TransitionEnd")},e4={},Pz={};Kh&&(Pz=document.createElement("div").style,"AnimationEvent"in window||(delete yp.animationend.animation,delete yp.animationiteration.animation,delete yp.animationstart.animation),"TransitionEvent"in window||delete yp.transitionend.transition);function t_(t){if(e4[t])return e4[t];if(!yp[t])return t;var e=yp[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Pz)return e4[t]=e[r];return t}var Fz=t_("animationend"),Mz=t_("animationiteration"),kz=t_("animationstart"),Nz=t_("transitionend"),Dz=new Map,y7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Md(t,e){Dz.set(t,e),$g(e,[t])}for(var t4=0;t4<y7.length;t4++){var r4=y7[t4],Hoe=r4.toLowerCase(),$oe=r4[0].toUpperCase()+r4.slice(1);Md(Hoe,"on"+$oe)}Md(Fz,"onAnimationEnd");Md(Mz,"onAnimationIteration");Md(kz,"onAnimationStart");Md("dblclick","onDoubleClick");Md("focusin","onFocus");Md("focusout","onBlur");Md(Nz,"onTransitionEnd");e1("onMouseEnter",["mouseout","mouseover"]);e1("onMouseLeave",["mouseout","mouseover"]);e1("onPointerEnter",["pointerout","pointerover"]);e1("onPointerLeave",["pointerout","pointerover"]);$g("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$g("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$g("onBeforeInput",["compositionend","keypress","textInput","paste"]);$g("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$g("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$g("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Boe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hw));function C7(t,e,r){var i=t.type||"unknown-event";t.currentTarget=r,Hse(i,e,void 0,t),t.currentTarget=null}function Lz(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var i=t[r],s=i.event;i=i.listeners;e:{var n=void 0;if(e)for(var o=i.length-1;0<=o;o--){var l=i[o],h=l.instance,d=l.currentTarget;if(l=l.listener,h!==n&&s.isPropagationStopped())break e;C7(s,l,d),n=h}else for(o=0;o<i.length;o++){if(l=i[o],h=l.instance,d=l.currentTarget,l=l.listener,h!==n&&s.isPropagationStopped())break e;C7(s,l,d),n=h}}}if(aE)throw t=$3,aE=!1,$3=null,t}function mi(t,e){var r=e[X3];r===void 0&&(r=e[X3]=new Set);var i=t+"__bubble";r.has(i)||(Hz(e,t,2,!1),r.add(i))}function n4(t,e,r){var i=0;e&&(i|=4),Hz(r,t,i,e)}var hb="_reactListening"+Math.random().toString(36).slice(2);function Hy(t){if(!t[hb]){t[hb]=!0,zU.forEach(function(r){r!=="selectionchange"&&(Boe.has(r)||n4(r,!1,t),n4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hb]||(e[hb]=!0,n4("selectionchange",!1,e))}}function Hz(t,e,r,i){switch(Sz(e)){case 1:var s=eoe;break;case 4:s=toe;break;default:s=hM}r=s.bind(null,e,r,t),s=void 0,!H3||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function i4(t,e,r,i,s){var n=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var l=i.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var h=o.tag;if((h===3||h===4)&&(h=o.stateNode.containerInfo,h===s||h.nodeType===8&&h.parentNode===s))return;o=o.return}for(;l!==null;){if(o=eg(l),o===null)return;if(h=o.tag,h===5||h===6){i=n=o;continue e}l=l.parentNode}}i=i.return}az(function(){var d=n,g=aM(r),y=[];e:{var C=Dz.get(t);if(C!==void 0){var x=dM,_=t;switch(t){case"keypress":if(C2(r)===0)break e;case"keydown":case"keyup":x=poe;break;case"focusin":_="focus",x=JA;break;case"focusout":_="blur",x=JA;break;case"beforeblur":case"afterblur":x=JA;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=l7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=ioe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=yoe;break;case Fz:case Mz:case kz:x=aoe;break;case Nz:x=Soe;break;case"scroll":x=roe;break;case"wheel":x=xoe;break;case"copy":case"cut":case"paste":x=coe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=u7}var E=(e&4)!==0,R=!E&&t==="scroll",I=E?C!==null?C+"Capture":null:C;E=[];for(var F=d,D;F!==null;){D=F;var U=D.stateNode;if(D.tag===5&&U!==null&&(D=U,I!==null&&(U=Fy(F,I),U!=null&&E.push($y(F,U,D)))),R)break;F=F.return}0<E.length&&(C=new x(C,_,null,r,g),y.push({event:C,listeners:E}))}}if(!(e&7)){e:{if(C=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",C&&r!==D3&&(_=r.relatedTarget||r.fromElement)&&(eg(_)||_[Xh]))break e;if((x||C)&&(C=g.window===g?g:(C=g.ownerDocument)?C.defaultView||C.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=d,_=_?eg(_):null,_!==null&&(R=Bg(_),_!==R||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=d),x!==_)){if(E=l7,U="onMouseLeave",I="onMouseEnter",F="mouse",(t==="pointerout"||t==="pointerover")&&(E=u7,U="onPointerLeave",I="onPointerEnter",F="pointer"),R=x==null?C:Cp(x),D=_==null?C:Cp(_),C=new E(U,F+"leave",x,r,g),C.target=R,C.relatedTarget=D,U=null,eg(g)===d&&(E=new E(I,F+"enter",_,r,g),E.target=D,E.relatedTarget=R,U=E),R=U,x&&_)t:{for(E=x,I=_,F=0,D=E;D;D=wm(D))F++;for(D=0,U=I;U;U=wm(U))D++;for(;0<F-D;)E=wm(E),F--;for(;0<D-F;)I=wm(I),D--;for(;F--;){if(E===I||I!==null&&E===I.alternate)break t;E=wm(E),I=wm(I)}E=null}else E=null;x!==null&&S7(y,C,x,E,!1),_!==null&&R!==null&&S7(y,R,_,E,!0)}}e:{if(C=d?Cp(d):window,x=C.nodeName&&C.nodeName.toLowerCase(),x==="select"||x==="input"&&C.type==="file")var X=Ioe;else if(d7(C))if(Rz)X=koe;else{X=Foe;var te=Poe}else(x=C.nodeName)&&x.toLowerCase()==="input"&&(C.type==="checkbox"||C.type==="radio")&&(X=Moe);if(X&&(X=X(t,d))){_z(y,X,r,g);break e}te&&te(t,C,d),t==="focusout"&&(te=C._wrapperState)&&te.controlled&&C.type==="number"&&P3(C,"number",C.value)}switch(te=d?Cp(d):window,t){case"focusin":(d7(te)||te.contentEditable==="true")&&(wp=te,j3=d,Jw=null);break;case"focusout":Jw=j3=wp=null;break;case"mousedown":U3=!0;break;case"contextmenu":case"mouseup":case"dragend":U3=!1,w7(y,r,g);break;case"selectionchange":if(Loe)break;case"keydown":case"keyup":w7(y,r,g)}var Y;if(mM)e:{switch(t){case"compositionstart":var oe="onCompositionStart";break e;case"compositionend":oe="onCompositionEnd";break e;case"compositionupdate":oe="onCompositionUpdate";break e}oe=void 0}else vp?Ez(t,r)&&(oe="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(oe="onCompositionStart");oe&&(xz&&r.locale!=="ko"&&(vp||oe!=="onCompositionStart"?oe==="onCompositionEnd"&&vp&&(Y=bz()):(ed=g,fM="value"in ed?ed.value:ed.textContent,vp=!0)),te=fE(d,oe),0<te.length&&(oe=new c7(oe,t,null,r,g),y.push({event:oe,listeners:te}),Y?oe.data=Y:(Y=Tz(r),Y!==null&&(oe.data=Y)))),(Y=Toe?_oe(t,r):Roe(t,r))&&(d=fE(d,"onBeforeInput"),0<d.length&&(g=new c7("onBeforeInput","beforeinput",null,r,g),y.push({event:g,listeners:d}),g.data=Y))}Lz(y,e)})}function $y(t,e,r){return{instance:t,listener:e,currentTarget:r}}function fE(t,e){for(var r=e+"Capture",i=[];t!==null;){var s=t,n=s.stateNode;s.tag===5&&n!==null&&(s=n,n=Fy(t,r),n!=null&&i.unshift($y(t,n,s)),n=Fy(t,e),n!=null&&i.push($y(t,n,s))),t=t.return}return i}function wm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function S7(t,e,r,i,s){for(var n=e._reactName,o=[];r!==null&&r!==i;){var l=r,h=l.alternate,d=l.stateNode;if(h!==null&&h===i)break;l.tag===5&&d!==null&&(l=d,s?(h=Fy(r,n),h!=null&&o.unshift($y(r,h,l))):s||(h=Fy(r,n),h!=null&&o.push($y(r,h,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Voe=/\r\n?/g,Woe=/\u0000|\uFFFD/g;function b7(t){return(typeof t=="string"?t:""+t).replace(Voe,`
`).replace(Woe,"")}function fb(t,e,r){if(e=b7(e),b7(t)!==e&&r)throw Error(Rt(425))}function dE(){}var z3=null,G3=null;function Y3(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var K3=typeof setTimeout=="function"?setTimeout:void 0,joe=typeof clearTimeout=="function"?clearTimeout:void 0,x7=typeof Promise=="function"?Promise:void 0,Uoe=typeof queueMicrotask=="function"?queueMicrotask:typeof x7<"u"?function(t){return x7.resolve(null).then(t).catch(zoe)}:K3;function zoe(t){setTimeout(function(){throw t})}function s4(t,e){var r=e,i=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(i===0){t.removeChild(s),Ny(e);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=s}while(r);Ny(e)}function md(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function E7(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var C1=Math.random().toString(36).slice(2),Iu="__reactFiber$"+C1,By="__reactProps$"+C1,Xh="__reactContainer$"+C1,X3="__reactEvents$"+C1,Goe="__reactListeners$"+C1,Yoe="__reactHandles$"+C1;function eg(t){var e=t[Iu];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xh]||r[Iu]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=E7(t);t!==null;){if(r=t[Iu])return r;t=E7(t)}return e}t=r,r=t.parentNode}return null}function OC(t){return t=t[Iu]||t[Xh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Rt(33))}function r_(t){return t[By]||null}var q3=[],Sp=-1;function kd(t){return{current:t}}function vi(t){0>Sp||(t.current=q3[Sp],q3[Sp]=null,Sp--)}function ai(t,e){Sp++,q3[Sp]=t.current,t.current=e}var _d={},Do=kd(_d),Ra=kd(!1),yg=_d;function t1(t,e){var r=t.type.contextTypes;if(!r)return _d;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},n;for(n in r)s[n]=e[n];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Aa(t){return t=t.childContextTypes,t!=null}function gE(){vi(Ra),vi(Do)}function T7(t,e,r){if(Do.current!==_d)throw Error(Rt(168));ai(Do,e),ai(Ra,r)}function $z(t,e,r){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(Rt(108,Pse(t)||"Unknown",s));return Hi({},r,i)}function mE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_d,yg=Do.current,ai(Do,t),ai(Ra,Ra.current),!0}function _7(t,e,r){var i=t.stateNode;if(!i)throw Error(Rt(169));r?(t=$z(t,e,yg),i.__reactInternalMemoizedMergedChildContext=t,vi(Ra),vi(Do),ai(Do,t)):vi(Ra),ai(Ra,r)}var Ih=null,n_=!1,o4=!1;function Bz(t){Ih===null?Ih=[t]:Ih.push(t)}function Koe(t){n_=!0,Bz(t)}function Nd(){if(!o4&&Ih!==null){o4=!0;var t=0,e=Yn;try{var r=Ih;for(Yn=1;t<r.length;t++){var i=r[t];do i=i(!0);while(i!==null)}Ih=null,n_=!1}catch(s){throw Ih!==null&&(Ih=Ih.slice(t+1)),hz(lM,Nd),s}finally{Yn=e,o4=!1}}return null}var bp=[],xp=0,pE=null,vE=0,Ml=[],kl=0,Cg=null,kh=1,Nh="";function z0(t,e){bp[xp++]=vE,bp[xp++]=pE,pE=t,vE=e}function Vz(t,e,r){Ml[kl++]=kh,Ml[kl++]=Nh,Ml[kl++]=Cg,Cg=t;var i=kh;t=Nh;var s=32-Rc(i)-1;i&=~(1<<s),r+=1;var n=32-Rc(e)+s;if(30<n){var o=s-s%5;n=(i&(1<<o)-1).toString(32),i>>=o,s-=o,kh=1<<32-Rc(e)+s|r<<s|i,Nh=n+t}else kh=1<<n|r<<s|i,Nh=t}function vM(t){t.return!==null&&(z0(t,1),Vz(t,1,0))}function wM(t){for(;t===pE;)pE=bp[--xp],bp[xp]=null,vE=bp[--xp],bp[xp]=null;for(;t===Cg;)Cg=Ml[--kl],Ml[kl]=null,Nh=Ml[--kl],Ml[kl]=null,kh=Ml[--kl],Ml[kl]=null}var rl=null,Za=null,Ti=!1,bc=null;function Wz(t,e){var r=Hl(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function R7(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rl=t,Za=md(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rl=t,Za=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Cg!==null?{id:kh,overflow:Nh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Hl(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,rl=t,Za=null,!0):!1;default:return!1}}function J3(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Q3(t){if(Ti){var e=Za;if(e){var r=e;if(!R7(t,e)){if(J3(t))throw Error(Rt(418));e=md(r.nextSibling);var i=rl;e&&R7(t,e)?Wz(i,r):(t.flags=t.flags&-4097|2,Ti=!1,rl=t)}}else{if(J3(t))throw Error(Rt(418));t.flags=t.flags&-4097|2,Ti=!1,rl=t}}}function A7(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rl=t}function db(t){if(t!==rl)return!1;if(!Ti)return A7(t),Ti=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Y3(t.type,t.memoizedProps)),e&&(e=Za)){if(J3(t))throw jz(),Error(Rt(418));for(;e;)Wz(t,e),e=md(e.nextSibling)}if(A7(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Rt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Za=md(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Za=null}}else Za=rl?md(t.stateNode.nextSibling):null;return!0}function jz(){for(var t=Za;t;)t=md(t.nextSibling)}function r1(){Za=rl=null,Ti=!1}function yM(t){bc===null?bc=[t]:bc.push(t)}var Xoe=of.ReactCurrentBatchConfig;function Ev(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Rt(309));var i=r.stateNode}if(!i)throw Error(Rt(147,t));var s=i,n=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===n?e.ref:(e=function(o){var l=s.refs;o===null?delete l[n]:l[n]=o},e._stringRef=n,e)}if(typeof t!="string")throw Error(Rt(284));if(!r._owner)throw Error(Rt(290,t))}return t}function gb(t,e){throw t=Object.prototype.toString.call(e),Error(Rt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function O7(t){var e=t._init;return e(t._payload)}function Uz(t){function e(I,F){if(t){var D=I.deletions;D===null?(I.deletions=[F],I.flags|=16):D.push(F)}}function r(I,F){if(!t)return null;for(;F!==null;)e(I,F),F=F.sibling;return null}function i(I,F){for(I=new Map;F!==null;)F.key!==null?I.set(F.key,F):I.set(F.index,F),F=F.sibling;return I}function s(I,F){return I=yd(I,F),I.index=0,I.sibling=null,I}function n(I,F,D){return I.index=D,t?(D=I.alternate,D!==null?(D=D.index,D<F?(I.flags|=2,F):D):(I.flags|=2,F)):(I.flags|=1048576,F)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,F,D,U){return F===null||F.tag!==6?(F=d4(D,I.mode,U),F.return=I,F):(F=s(F,D),F.return=I,F)}function h(I,F,D,U){var X=D.type;return X===pp?g(I,F,D.props.children,U,D.key):F!==null&&(F.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Wf&&O7(X)===F.type)?(U=s(F,D.props),U.ref=Ev(I,F,D),U.return=I,U):(U=R2(D.type,D.key,D.props,null,I.mode,U),U.ref=Ev(I,F,D),U.return=I,U)}function d(I,F,D,U){return F===null||F.tag!==4||F.stateNode.containerInfo!==D.containerInfo||F.stateNode.implementation!==D.implementation?(F=g4(D,I.mode,U),F.return=I,F):(F=s(F,D.children||[]),F.return=I,F)}function g(I,F,D,U,X){return F===null||F.tag!==7?(F=fg(D,I.mode,U,X),F.return=I,F):(F=s(F,D),F.return=I,F)}function y(I,F,D){if(typeof F=="string"&&F!==""||typeof F=="number")return F=d4(""+F,I.mode,D),F.return=I,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case nb:return D=R2(F.type,F.key,F.props,null,I.mode,D),D.ref=Ev(I,null,F),D.return=I,D;case mp:return F=g4(F,I.mode,D),F.return=I,F;case Wf:var U=F._init;return y(I,U(F._payload),D)}if(Dw(F)||yv(F))return F=fg(F,I.mode,D,null),F.return=I,F;gb(I,F)}return null}function C(I,F,D,U){var X=F!==null?F.key:null;if(typeof D=="string"&&D!==""||typeof D=="number")return X!==null?null:l(I,F,""+D,U);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case nb:return D.key===X?h(I,F,D,U):null;case mp:return D.key===X?d(I,F,D,U):null;case Wf:return X=D._init,C(I,F,X(D._payload),U)}if(Dw(D)||yv(D))return X!==null?null:g(I,F,D,U,null);gb(I,D)}return null}function x(I,F,D,U,X){if(typeof U=="string"&&U!==""||typeof U=="number")return I=I.get(D)||null,l(F,I,""+U,X);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case nb:return I=I.get(U.key===null?D:U.key)||null,h(F,I,U,X);case mp:return I=I.get(U.key===null?D:U.key)||null,d(F,I,U,X);case Wf:var te=U._init;return x(I,F,D,te(U._payload),X)}if(Dw(U)||yv(U))return I=I.get(D)||null,g(F,I,U,X,null);gb(F,U)}return null}function _(I,F,D,U){for(var X=null,te=null,Y=F,oe=F=0,me=null;Y!==null&&oe<D.length;oe++){Y.index>oe?(me=Y,Y=null):me=Y.sibling;var de=C(I,Y,D[oe],U);if(de===null){Y===null&&(Y=me);break}t&&Y&&de.alternate===null&&e(I,Y),F=n(de,F,oe),te===null?X=de:te.sibling=de,te=de,Y=me}if(oe===D.length)return r(I,Y),Ti&&z0(I,oe),X;if(Y===null){for(;oe<D.length;oe++)Y=y(I,D[oe],U),Y!==null&&(F=n(Y,F,oe),te===null?X=Y:te.sibling=Y,te=Y);return Ti&&z0(I,oe),X}for(Y=i(I,Y);oe<D.length;oe++)me=x(Y,I,oe,D[oe],U),me!==null&&(t&&me.alternate!==null&&Y.delete(me.key===null?oe:me.key),F=n(me,F,oe),te===null?X=me:te.sibling=me,te=me);return t&&Y.forEach(function(ye){return e(I,ye)}),Ti&&z0(I,oe),X}function E(I,F,D,U){var X=yv(D);if(typeof X!="function")throw Error(Rt(150));if(D=X.call(D),D==null)throw Error(Rt(151));for(var te=X=null,Y=F,oe=F=0,me=null,de=D.next();Y!==null&&!de.done;oe++,de=D.next()){Y.index>oe?(me=Y,Y=null):me=Y.sibling;var ye=C(I,Y,de.value,U);if(ye===null){Y===null&&(Y=me);break}t&&Y&&ye.alternate===null&&e(I,Y),F=n(ye,F,oe),te===null?X=ye:te.sibling=ye,te=ye,Y=me}if(de.done)return r(I,Y),Ti&&z0(I,oe),X;if(Y===null){for(;!de.done;oe++,de=D.next())de=y(I,de.value,U),de!==null&&(F=n(de,F,oe),te===null?X=de:te.sibling=de,te=de);return Ti&&z0(I,oe),X}for(Y=i(I,Y);!de.done;oe++,de=D.next())de=x(Y,I,oe,de.value,U),de!==null&&(t&&de.alternate!==null&&Y.delete(de.key===null?oe:de.key),F=n(de,F,oe),te===null?X=de:te.sibling=de,te=de);return t&&Y.forEach(function(Ee){return e(I,Ee)}),Ti&&z0(I,oe),X}function R(I,F,D,U){if(typeof D=="object"&&D!==null&&D.type===pp&&D.key===null&&(D=D.props.children),typeof D=="object"&&D!==null){switch(D.$$typeof){case nb:e:{for(var X=D.key,te=F;te!==null;){if(te.key===X){if(X=D.type,X===pp){if(te.tag===7){r(I,te.sibling),F=s(te,D.props.children),F.return=I,I=F;break e}}else if(te.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Wf&&O7(X)===te.type){r(I,te.sibling),F=s(te,D.props),F.ref=Ev(I,te,D),F.return=I,I=F;break e}r(I,te);break}else e(I,te);te=te.sibling}D.type===pp?(F=fg(D.props.children,I.mode,U,D.key),F.return=I,I=F):(U=R2(D.type,D.key,D.props,null,I.mode,U),U.ref=Ev(I,F,D),U.return=I,I=U)}return o(I);case mp:e:{for(te=D.key;F!==null;){if(F.key===te)if(F.tag===4&&F.stateNode.containerInfo===D.containerInfo&&F.stateNode.implementation===D.implementation){r(I,F.sibling),F=s(F,D.children||[]),F.return=I,I=F;break e}else{r(I,F);break}else e(I,F);F=F.sibling}F=g4(D,I.mode,U),F.return=I,I=F}return o(I);case Wf:return te=D._init,R(I,F,te(D._payload),U)}if(Dw(D))return _(I,F,D,U);if(yv(D))return E(I,F,D,U);gb(I,D)}return typeof D=="string"&&D!==""||typeof D=="number"?(D=""+D,F!==null&&F.tag===6?(r(I,F.sibling),F=s(F,D),F.return=I,I=F):(r(I,F),F=d4(D,I.mode,U),F.return=I,I=F),o(I)):r(I,F)}return R}var n1=Uz(!0),zz=Uz(!1),wE=kd(null),yE=null,Ep=null,CM=null;function SM(){CM=Ep=yE=null}function bM(t){var e=wE.current;vi(wE),t._currentValue=e}function Z3(t,e,r){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===r)break;t=t.return}}function $p(t,e){yE=t,CM=Ep=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(_a=!0),t.firstContext=null)}function Vl(t){var e=t._currentValue;if(CM!==t)if(t={context:t,memoizedValue:e,next:null},Ep===null){if(yE===null)throw Error(Rt(308));Ep=t,yE.dependencies={lanes:0,firstContext:t}}else Ep=Ep.next=t;return e}var tg=null;function xM(t){tg===null?tg=[t]:tg.push(t)}function Gz(t,e,r,i){var s=e.interleaved;return s===null?(r.next=r,xM(e)):(r.next=s.next,s.next=r),e.interleaved=r,qh(t,i)}function qh(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var jf=!1;function EM(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yz(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function pd(t,e,r){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,En&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,qh(t,r)}return s=i.interleaved,s===null?(e.next=e,xM(i)):(e.next=s.next,s.next=e),i.interleaved=e,qh(t,r)}function S2(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,cM(t,r)}}function I7(t,e){var r=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var s=null,n=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};n===null?s=n=o:n=n.next=o,r=r.next}while(r!==null);n===null?s=n=e:n=n.next=e}else s=n=e;r={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:i.shared,effects:i.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function CE(t,e,r,i){var s=t.updateQueue;jf=!1;var n=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var h=l,d=h.next;h.next=null,o===null?n=d:o.next=d,o=h;var g=t.alternate;g!==null&&(g=g.updateQueue,l=g.lastBaseUpdate,l!==o&&(l===null?g.firstBaseUpdate=d:l.next=d,g.lastBaseUpdate=h))}if(n!==null){var y=s.baseState;o=0,g=d=h=null,l=n;do{var C=l.lane,x=l.eventTime;if((i&C)===C){g!==null&&(g=g.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,E=l;switch(C=e,x=r,E.tag){case 1:if(_=E.payload,typeof _=="function"){y=_.call(x,y,C);break e}y=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=E.payload,C=typeof _=="function"?_.call(x,y,C):_,C==null)break e;y=Hi({},y,C);break e;case 2:jf=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,C=s.effects,C===null?s.effects=[l]:C.push(l))}else x={eventTime:x,lane:C,tag:l.tag,payload:l.payload,callback:l.callback,next:null},g===null?(d=g=x,h=y):g=g.next=x,o|=C;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;C=l,l=C.next,C.next=null,s.lastBaseUpdate=C,s.shared.pending=null}}while(!0);if(g===null&&(h=y),s.baseState=h,s.firstBaseUpdate=d,s.lastBaseUpdate=g,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else n===null&&(s.shared.lanes=0);bg|=o,t.lanes=o,t.memoizedState=y}}function P7(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],s=i.callback;if(s!==null){if(i.callback=null,i=r,typeof s!="function")throw Error(Rt(191,s));s.call(i)}}}var IC={},Lu=kd(IC),Vy=kd(IC),Wy=kd(IC);function rg(t){if(t===IC)throw Error(Rt(174));return t}function TM(t,e){switch(ai(Wy,e),ai(Vy,t),ai(Lu,IC),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:M3(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=M3(e,t)}vi(Lu),ai(Lu,e)}function i1(){vi(Lu),vi(Vy),vi(Wy)}function Kz(t){rg(Wy.current);var e=rg(Lu.current),r=M3(e,t.type);e!==r&&(ai(Vy,t),ai(Lu,r))}function _M(t){Vy.current===t&&(vi(Lu),vi(Vy))}var ki=kd(0);function SE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var a4=[];function RM(){for(var t=0;t<a4.length;t++)a4[t]._workInProgressVersionPrimary=null;a4.length=0}var b2=of.ReactCurrentDispatcher,l4=of.ReactCurrentBatchConfig,Sg=0,Li=null,Os=null,Bs=null,bE=!1,Qw=!1,jy=0,qoe=0;function bo(){throw Error(Rt(321))}function AM(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Fc(t[r],e[r]))return!1;return!0}function OM(t,e,r,i,s,n){if(Sg=n,Li=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,b2.current=t===null||t.memoizedState===null?eae:tae,t=r(i,s),Qw){n=0;do{if(Qw=!1,jy=0,25<=n)throw Error(Rt(301));n+=1,Bs=Os=null,e.updateQueue=null,b2.current=rae,t=r(i,s)}while(Qw)}if(b2.current=xE,e=Os!==null&&Os.next!==null,Sg=0,Bs=Os=Li=null,bE=!1,e)throw Error(Rt(300));return t}function IM(){var t=jy!==0;return jy=0,t}function bu(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bs===null?Li.memoizedState=Bs=t:Bs=Bs.next=t,Bs}function Wl(){if(Os===null){var t=Li.alternate;t=t!==null?t.memoizedState:null}else t=Os.next;var e=Bs===null?Li.memoizedState:Bs.next;if(e!==null)Bs=e,Os=t;else{if(t===null)throw Error(Rt(310));Os=t,t={memoizedState:Os.memoizedState,baseState:Os.baseState,baseQueue:Os.baseQueue,queue:Os.queue,next:null},Bs===null?Li.memoizedState=Bs=t:Bs=Bs.next=t}return Bs}function Uy(t,e){return typeof e=="function"?e(t):e}function c4(t){var e=Wl(),r=e.queue;if(r===null)throw Error(Rt(311));r.lastRenderedReducer=t;var i=Os,s=i.baseQueue,n=r.pending;if(n!==null){if(s!==null){var o=s.next;s.next=n.next,n.next=o}i.baseQueue=s=n,r.pending=null}if(s!==null){n=s.next,i=i.baseState;var l=o=null,h=null,d=n;do{var g=d.lane;if((Sg&g)===g)h!==null&&(h=h.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:t(i,d.action);else{var y={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};h===null?(l=h=y,o=i):h=h.next=y,Li.lanes|=g,bg|=g}d=d.next}while(d!==null&&d!==n);h===null?o=i:h.next=l,Fc(i,e.memoizedState)||(_a=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=h,r.lastRenderedState=i}if(t=r.interleaved,t!==null){s=t;do n=s.lane,Li.lanes|=n,bg|=n,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function u4(t){var e=Wl(),r=e.queue;if(r===null)throw Error(Rt(311));r.lastRenderedReducer=t;var i=r.dispatch,s=r.pending,n=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do n=t(n,o.action),o=o.next;while(o!==s);Fc(n,e.memoizedState)||(_a=!0),e.memoizedState=n,e.baseQueue===null&&(e.baseState=n),r.lastRenderedState=n}return[n,i]}function Xz(){}function qz(t,e){var r=Li,i=Wl(),s=e(),n=!Fc(i.memoizedState,s);if(n&&(i.memoizedState=s,_a=!0),i=i.queue,PM(Zz.bind(null,r,i,t),[t]),i.getSnapshot!==e||n||Bs!==null&&Bs.memoizedState.tag&1){if(r.flags|=2048,zy(9,Qz.bind(null,r,i,s,e),void 0,null),Gs===null)throw Error(Rt(349));Sg&30||Jz(r,e,s)}return s}function Jz(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Li.updateQueue,e===null?(e={lastEffect:null,stores:null},Li.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Qz(t,e,r,i){e.value=r,e.getSnapshot=i,eG(e)&&tG(t)}function Zz(t,e,r){return r(function(){eG(e)&&tG(t)})}function eG(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Fc(t,r)}catch{return!0}}function tG(t){var e=qh(t,1);e!==null&&Ac(e,t,1,-1)}function F7(t){var e=bu();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uy,lastRenderedState:t},e.queue=t,t=t.dispatch=Zoe.bind(null,Li,t),[e.memoizedState,t]}function zy(t,e,r,i){return t={tag:t,create:e,destroy:r,deps:i,next:null},e=Li.updateQueue,e===null?(e={lastEffect:null,stores:null},Li.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(i=r.next,r.next=t,t.next=i,e.lastEffect=t)),t}function rG(){return Wl().memoizedState}function x2(t,e,r,i){var s=bu();Li.flags|=t,s.memoizedState=zy(1|e,r,void 0,i===void 0?null:i)}function i_(t,e,r,i){var s=Wl();i=i===void 0?null:i;var n=void 0;if(Os!==null){var o=Os.memoizedState;if(n=o.destroy,i!==null&&AM(i,o.deps)){s.memoizedState=zy(e,r,n,i);return}}Li.flags|=t,s.memoizedState=zy(1|e,r,n,i)}function M7(t,e){return x2(8390656,8,t,e)}function PM(t,e){return i_(2048,8,t,e)}function nG(t,e){return i_(4,2,t,e)}function iG(t,e){return i_(4,4,t,e)}function sG(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function oG(t,e,r){return r=r!=null?r.concat([t]):null,i_(4,4,sG.bind(null,e,t),r)}function FM(){}function aG(t,e){var r=Wl();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&AM(e,i[1])?i[0]:(r.memoizedState=[t,e],t)}function lG(t,e){var r=Wl();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&AM(e,i[1])?i[0]:(t=t(),r.memoizedState=[t,e],t)}function cG(t,e,r){return Sg&21?(Fc(r,e)||(r=gz(),Li.lanes|=r,bg|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_a=!0),t.memoizedState=r)}function Joe(t,e){var r=Yn;Yn=r!==0&&4>r?r:4,t(!0);var i=l4.transition;l4.transition={};try{t(!1),e()}finally{Yn=r,l4.transition=i}}function uG(){return Wl().memoizedState}function Qoe(t,e,r){var i=wd(t);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},hG(t))fG(e,r);else if(r=Gz(t,e,r,i),r!==null){var s=ra();Ac(r,t,i,s),dG(r,e,i)}}function Zoe(t,e,r){var i=wd(t),s={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(hG(t))fG(e,s);else{var n=t.alternate;if(t.lanes===0&&(n===null||n.lanes===0)&&(n=e.lastRenderedReducer,n!==null))try{var o=e.lastRenderedState,l=n(o,r);if(s.hasEagerState=!0,s.eagerState=l,Fc(l,o)){var h=e.interleaved;h===null?(s.next=s,xM(e)):(s.next=h.next,h.next=s),e.interleaved=s;return}}catch{}finally{}r=Gz(t,e,s,i),r!==null&&(s=ra(),Ac(r,t,i,s),dG(r,e,i))}}function hG(t){var e=t.alternate;return t===Li||e!==null&&e===Li}function fG(t,e){Qw=bE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function dG(t,e,r){if(r&4194240){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,cM(t,r)}}var xE={readContext:Vl,useCallback:bo,useContext:bo,useEffect:bo,useImperativeHandle:bo,useInsertionEffect:bo,useLayoutEffect:bo,useMemo:bo,useReducer:bo,useRef:bo,useState:bo,useDebugValue:bo,useDeferredValue:bo,useTransition:bo,useMutableSource:bo,useSyncExternalStore:bo,useId:bo,unstable_isNewReconciler:!1},eae={readContext:Vl,useCallback:function(t,e){return bu().memoizedState=[t,e===void 0?null:e],t},useContext:Vl,useEffect:M7,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,x2(4194308,4,sG.bind(null,e,t),r)},useLayoutEffect:function(t,e){return x2(4194308,4,t,e)},useInsertionEffect:function(t,e){return x2(4,2,t,e)},useMemo:function(t,e){var r=bu();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var i=bu();return e=r!==void 0?r(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Qoe.bind(null,Li,t),[i.memoizedState,t]},useRef:function(t){var e=bu();return t={current:t},e.memoizedState=t},useState:F7,useDebugValue:FM,useDeferredValue:function(t){return bu().memoizedState=t},useTransition:function(){var t=F7(!1),e=t[0];return t=Joe.bind(null,t[1]),bu().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var i=Li,s=bu();if(Ti){if(r===void 0)throw Error(Rt(407));r=r()}else{if(r=e(),Gs===null)throw Error(Rt(349));Sg&30||Jz(i,e,r)}s.memoizedState=r;var n={value:r,getSnapshot:e};return s.queue=n,M7(Zz.bind(null,i,n,t),[t]),i.flags|=2048,zy(9,Qz.bind(null,i,n,r,e),void 0,null),r},useId:function(){var t=bu(),e=Gs.identifierPrefix;if(Ti){var r=Nh,i=kh;r=(i&~(1<<32-Rc(i)-1)).toString(32)+r,e=":"+e+"R"+r,r=jy++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=qoe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},tae={readContext:Vl,useCallback:aG,useContext:Vl,useEffect:PM,useImperativeHandle:oG,useInsertionEffect:nG,useLayoutEffect:iG,useMemo:lG,useReducer:c4,useRef:rG,useState:function(){return c4(Uy)},useDebugValue:FM,useDeferredValue:function(t){var e=Wl();return cG(e,Os.memoizedState,t)},useTransition:function(){var t=c4(Uy)[0],e=Wl().memoizedState;return[t,e]},useMutableSource:Xz,useSyncExternalStore:qz,useId:uG,unstable_isNewReconciler:!1},rae={readContext:Vl,useCallback:aG,useContext:Vl,useEffect:PM,useImperativeHandle:oG,useInsertionEffect:nG,useLayoutEffect:iG,useMemo:lG,useReducer:u4,useRef:rG,useState:function(){return u4(Uy)},useDebugValue:FM,useDeferredValue:function(t){var e=Wl();return Os===null?e.memoizedState=t:cG(e,Os.memoizedState,t)},useTransition:function(){var t=u4(Uy)[0],e=Wl().memoizedState;return[t,e]},useMutableSource:Xz,useSyncExternalStore:qz,useId:uG,unstable_isNewReconciler:!1};function vc(t,e){if(t&&t.defaultProps){e=Hi({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function eP(t,e,r,i){e=t.memoizedState,r=r(i,e),r=r==null?e:Hi({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var s_={isMounted:function(t){return(t=t._reactInternals)?Bg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var i=ra(),s=wd(t),n=Wh(i,s);n.payload=e,r!=null&&(n.callback=r),e=pd(t,n,s),e!==null&&(Ac(e,t,s,i),S2(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var i=ra(),s=wd(t),n=Wh(i,s);n.tag=1,n.payload=e,r!=null&&(n.callback=r),e=pd(t,n,s),e!==null&&(Ac(e,t,s,i),S2(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=ra(),i=wd(t),s=Wh(r,i);s.tag=2,e!=null&&(s.callback=e),e=pd(t,s,i),e!==null&&(Ac(e,t,i,r),S2(e,t,i))}};function k7(t,e,r,i,s,n,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,n,o):e.prototype&&e.prototype.isPureReactComponent?!Ly(r,i)||!Ly(s,n):!0}function gG(t,e,r){var i=!1,s=_d,n=e.contextType;return typeof n=="object"&&n!==null?n=Vl(n):(s=Aa(e)?yg:Do.current,i=e.contextTypes,n=(i=i!=null)?t1(t,s):_d),e=new e(r,n),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=s_,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),e}function N7(t,e,r,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,i),e.state!==t&&s_.enqueueReplaceState(e,e.state,null)}function tP(t,e,r,i){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},EM(t);var n=e.contextType;typeof n=="object"&&n!==null?s.context=Vl(n):(n=Aa(e)?yg:Do.current,s.context=t1(t,n)),s.state=t.memoizedState,n=e.getDerivedStateFromProps,typeof n=="function"&&(eP(t,e,n,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&s_.enqueueReplaceState(s,s.state,null),CE(t,r,s,i),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function s1(t,e){try{var r="",i=e;do r+=Ise(i),i=i.return;while(i);var s=r}catch(n){s=`
Error generating stack: `+n.message+`
`+n.stack}return{value:t,source:e,stack:s,digest:null}}function h4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function rP(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var nae=typeof WeakMap=="function"?WeakMap:Map;function mG(t,e,r){r=Wh(-1,r),r.tag=3,r.payload={element:null};var i=e.value;return r.callback=function(){TE||(TE=!0,fP=i),rP(t,e)},r}function pG(t,e,r){r=Wh(-1,r),r.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;r.payload=function(){return i(s)},r.callback=function(){rP(t,e)}}var n=t.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(r.callback=function(){rP(t,e),typeof i!="function"&&(vd===null?vd=new Set([this]):vd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function D7(t,e,r){var i=t.pingCache;if(i===null){i=t.pingCache=new nae;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(r)||(s.add(r),t=vae.bind(null,t,e,r),e.then(t,t))}function L7(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function H7(t,e,r,i,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Wh(-1,1),e.tag=2,pd(r,e,1))),r.lanes|=1),t)}var iae=of.ReactCurrentOwner,_a=!1;function Ko(t,e,r,i){e.child=t===null?zz(e,null,r,i):n1(e,t.child,r,i)}function $7(t,e,r,i,s){r=r.render;var n=e.ref;return $p(e,s),i=OM(t,e,r,i,n,s),r=IM(),t!==null&&!_a?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jh(t,e,s)):(Ti&&r&&vM(e),e.flags|=1,Ko(t,e,i,s),e.child)}function B7(t,e,r,i,s){if(t===null){var n=r.type;return typeof n=="function"&&!BM(n)&&n.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=n,vG(t,e,n,i,s)):(t=R2(r.type,null,i,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(n=t.child,!(t.lanes&s)){var o=n.memoizedProps;if(r=r.compare,r=r!==null?r:Ly,r(o,i)&&t.ref===e.ref)return Jh(t,e,s)}return e.flags|=1,t=yd(n,i),t.ref=e.ref,t.return=e,e.child=t}function vG(t,e,r,i,s){if(t!==null){var n=t.memoizedProps;if(Ly(n,i)&&t.ref===e.ref)if(_a=!1,e.pendingProps=i=n,(t.lanes&s)!==0)t.flags&131072&&(_a=!0);else return e.lanes=t.lanes,Jh(t,e,s)}return nP(t,e,r,i,s)}function wG(t,e,r){var i=e.pendingProps,s=i.children,n=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ai(_p,Ka),Ka|=r;else{if(!(r&1073741824))return t=n!==null?n.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ai(_p,Ka),Ka|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=n!==null?n.baseLanes:r,ai(_p,Ka),Ka|=i}else n!==null?(i=n.baseLanes|r,e.memoizedState=null):i=r,ai(_p,Ka),Ka|=i;return Ko(t,e,s,r),e.child}function yG(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function nP(t,e,r,i,s){var n=Aa(r)?yg:Do.current;return n=t1(e,n),$p(e,s),r=OM(t,e,r,i,n,s),i=IM(),t!==null&&!_a?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Jh(t,e,s)):(Ti&&i&&vM(e),e.flags|=1,Ko(t,e,r,s),e.child)}function V7(t,e,r,i,s){if(Aa(r)){var n=!0;mE(e)}else n=!1;if($p(e,s),e.stateNode===null)E2(t,e),gG(e,r,i),tP(e,r,i,s),i=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var h=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Vl(d):(d=Aa(r)?yg:Do.current,d=t1(e,d));var g=r.getDerivedStateFromProps,y=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";y||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==i||h!==d)&&N7(e,o,i,d),jf=!1;var C=e.memoizedState;o.state=C,CE(e,i,o,s),h=e.memoizedState,l!==i||C!==h||Ra.current||jf?(typeof g=="function"&&(eP(e,r,g,i),h=e.memoizedState),(l=jf||k7(e,r,l,i,C,h,d))?(y||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=h),o.props=i,o.state=h,o.context=d,i=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,Yz(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:vc(e.type,l),o.props=d,y=e.pendingProps,C=o.context,h=r.contextType,typeof h=="object"&&h!==null?h=Vl(h):(h=Aa(r)?yg:Do.current,h=t1(e,h));var x=r.getDerivedStateFromProps;(g=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==y||C!==h)&&N7(e,o,i,h),jf=!1,C=e.memoizedState,o.state=C,CE(e,i,o,s);var _=e.memoizedState;l!==y||C!==_||Ra.current||jf?(typeof x=="function"&&(eP(e,r,x,i),_=e.memoizedState),(d=jf||k7(e,r,d,i,C,_,h)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,h),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,h)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=h,i=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),i=!1)}return iP(t,e,r,i,n,s)}function iP(t,e,r,i,s,n){yG(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&_7(e,r,!1),Jh(t,e,n);i=e.stateNode,iae.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=n1(e,t.child,null,n),e.child=n1(e,null,l,n)):Ko(t,e,l,n),e.memoizedState=i.state,s&&_7(e,r,!0),e.child}function CG(t){var e=t.stateNode;e.pendingContext?T7(t,e.pendingContext,e.pendingContext!==e.context):e.context&&T7(t,e.context,!1),TM(t,e.containerInfo)}function W7(t,e,r,i,s){return r1(),yM(s),e.flags|=256,Ko(t,e,r,i),e.child}var sP={dehydrated:null,treeContext:null,retryLane:0};function oP(t){return{baseLanes:t,cachePool:null,transitions:null}}function SG(t,e,r){var i=e.pendingProps,s=ki.current,n=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(n=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ai(ki,s&1),t===null)return Q3(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,n?(i=e.mode,n=e.child,o={mode:"hidden",children:o},!(i&1)&&n!==null?(n.childLanes=0,n.pendingProps=o):n=l_(o,i,0,null),t=fg(t,i,r,null),n.return=e,t.return=e,n.sibling=t,e.child=n,e.child.memoizedState=oP(r),e.memoizedState=sP,t):MM(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return sae(t,e,o,i,l,s,r);if(n){n=i.fallback,o=e.mode,s=t.child,l=s.sibling;var h={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=h,e.deletions=null):(i=yd(s,h),i.subtreeFlags=s.subtreeFlags&14680064),l!==null?n=yd(l,n):(n=fg(n,o,r,null),n.flags|=2),n.return=e,i.return=e,i.sibling=n,e.child=i,i=n,n=e.child,o=t.child.memoizedState,o=o===null?oP(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},n.memoizedState=o,n.childLanes=t.childLanes&~r,e.memoizedState=sP,i}return n=t.child,t=n.sibling,i=yd(n,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=r),i.return=e,i.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=i,e.memoizedState=null,i}function MM(t,e){return e=l_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mb(t,e,r,i){return i!==null&&yM(i),n1(e,t.child,null,r),t=MM(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sae(t,e,r,i,s,n,o){if(r)return e.flags&256?(e.flags&=-257,i=h4(Error(Rt(422))),mb(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(n=i.fallback,s=e.mode,i=l_({mode:"visible",children:i.children},s,0,null),n=fg(n,s,o,null),n.flags|=2,i.return=e,n.return=e,i.sibling=n,e.child=i,e.mode&1&&n1(e,t.child,null,o),e.child.memoizedState=oP(o),e.memoizedState=sP,n);if(!(e.mode&1))return mb(t,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var l=i.dgst;return i=l,n=Error(Rt(419)),i=h4(n,i,void 0),mb(t,e,o,i)}if(l=(o&t.childLanes)!==0,_a||l){if(i=Gs,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==n.retryLane&&(n.retryLane=s,qh(t,s),Ac(i,t,s,-1))}return $M(),i=h4(Error(Rt(421))),mb(t,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=wae.bind(null,t),s._reactRetry=e,null):(t=n.treeContext,Za=md(s.nextSibling),rl=e,Ti=!0,bc=null,t!==null&&(Ml[kl++]=kh,Ml[kl++]=Nh,Ml[kl++]=Cg,kh=t.id,Nh=t.overflow,Cg=e),e=MM(e,i.children),e.flags|=4096,e)}function j7(t,e,r){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Z3(t.return,e,r)}function f4(t,e,r,i,s){var n=t.memoizedState;n===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:s}:(n.isBackwards=e,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=r,n.tailMode=s)}function bG(t,e,r){var i=e.pendingProps,s=i.revealOrder,n=i.tail;if(Ko(t,e,i.children,r),i=ki.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&j7(t,r,e);else if(t.tag===19)j7(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ai(ki,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&SE(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),f4(e,!1,s,r,n);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&SE(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}f4(e,!0,r,null,n);break;case"together":f4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function E2(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jh(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),bg|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Rt(153));if(e.child!==null){for(t=e.child,r=yd(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=yd(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function oae(t,e,r){switch(e.tag){case 3:CG(e),r1();break;case 5:Kz(e);break;case 1:Aa(e.type)&&mE(e);break;case 4:TM(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;ai(wE,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ai(ki,ki.current&1),e.flags|=128,null):r&e.child.childLanes?SG(t,e,r):(ai(ki,ki.current&1),t=Jh(t,e,r),t!==null?t.sibling:null);ai(ki,ki.current&1);break;case 19:if(i=(r&e.childLanes)!==0,t.flags&128){if(i)return bG(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ai(ki,ki.current),i)break;return null;case 22:case 23:return e.lanes=0,wG(t,e,r)}return Jh(t,e,r)}var xG,aP,EG,TG;xG=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};aP=function(){};EG=function(t,e,r,i){var s=t.memoizedProps;if(s!==i){t=e.stateNode,rg(Lu.current);var n=null;switch(r){case"input":s=O3(t,s),i=O3(t,i),n=[];break;case"select":s=Hi({},s,{value:void 0}),i=Hi({},i,{value:void 0}),n=[];break;case"textarea":s=F3(t,s),i=F3(t,i),n=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=dE)}k3(r,i);var o;r=null;for(d in s)if(!i.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Iy.hasOwnProperty(d)?n||(n=[]):(n=n||[]).push(d,null));for(d in i){var h=i[d];if(l=s!=null?s[d]:void 0,i.hasOwnProperty(d)&&h!==l&&(h!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||h&&h.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in h)h.hasOwnProperty(o)&&l[o]!==h[o]&&(r||(r={}),r[o]=h[o])}else r||(n||(n=[]),n.push(d,r)),r=h;else d==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,l=l?l.__html:void 0,h!=null&&l!==h&&(n=n||[]).push(d,h)):d==="children"?typeof h!="string"&&typeof h!="number"||(n=n||[]).push(d,""+h):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Iy.hasOwnProperty(d)?(h!=null&&d==="onScroll"&&mi("scroll",t),n||l===h||(n=[])):(n=n||[]).push(d,h))}r&&(n=n||[]).push("style",r);var d=n;(e.updateQueue=d)&&(e.flags|=4)}};TG=function(t,e,r,i){r!==i&&(e.flags|=4)};function Tv(t,e){if(!Ti)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function xo(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,i=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=i,t.childLanes=r,e}function aae(t,e,r){var i=e.pendingProps;switch(wM(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xo(e),null;case 1:return Aa(e.type)&&gE(),xo(e),null;case 3:return i=e.stateNode,i1(),vi(Ra),vi(Do),RM(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(db(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bc!==null&&(mP(bc),bc=null))),aP(t,e),xo(e),null;case 5:_M(e);var s=rg(Wy.current);if(r=e.type,t!==null&&e.stateNode!=null)EG(t,e,r,i,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Rt(166));return xo(e),null}if(t=rg(Lu.current),db(e)){i=e.stateNode,r=e.type;var n=e.memoizedProps;switch(i[Iu]=e,i[By]=n,t=(e.mode&1)!==0,r){case"dialog":mi("cancel",i),mi("close",i);break;case"iframe":case"object":case"embed":mi("load",i);break;case"video":case"audio":for(s=0;s<Hw.length;s++)mi(Hw[s],i);break;case"source":mi("error",i);break;case"img":case"image":case"link":mi("error",i),mi("load",i);break;case"details":mi("toggle",i);break;case"input":QH(i,n),mi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},mi("invalid",i);break;case"textarea":e7(i,n),mi("invalid",i)}k3(r,n),s=null;for(var o in n)if(n.hasOwnProperty(o)){var l=n[o];o==="children"?typeof l=="string"?i.textContent!==l&&(n.suppressHydrationWarning!==!0&&fb(i.textContent,l,t),s=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(n.suppressHydrationWarning!==!0&&fb(i.textContent,l,t),s=["children",""+l]):Iy.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&mi("scroll",i)}switch(r){case"input":ib(i),ZH(i,n,!0);break;case"textarea":ib(i),t7(i);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(i.onclick=dE)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ZU(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(r,{is:i.is}):(t=o.createElement(r),r==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,r),t[Iu]=e,t[By]=i,xG(t,e,!1,!1),e.stateNode=t;e:{switch(o=N3(r,i),r){case"dialog":mi("cancel",t),mi("close",t),s=i;break;case"iframe":case"object":case"embed":mi("load",t),s=i;break;case"video":case"audio":for(s=0;s<Hw.length;s++)mi(Hw[s],t);s=i;break;case"source":mi("error",t),s=i;break;case"img":case"image":case"link":mi("error",t),mi("load",t),s=i;break;case"details":mi("toggle",t),s=i;break;case"input":QH(t,i),s=O3(t,i),mi("invalid",t);break;case"option":s=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},s=Hi({},i,{value:void 0}),mi("invalid",t);break;case"textarea":e7(t,i),s=F3(t,i),mi("invalid",t);break;default:s=i}k3(r,s),l=s;for(n in l)if(l.hasOwnProperty(n)){var h=l[n];n==="style"?rz(t,h):n==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&ez(t,h)):n==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&Py(t,h):typeof h=="number"&&Py(t,""+h):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(Iy.hasOwnProperty(n)?h!=null&&n==="onScroll"&&mi("scroll",t):h!=null&&nM(t,n,h,o))}switch(r){case"input":ib(t),ZH(t,i,!1);break;case"textarea":ib(t),t7(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Td(i.value));break;case"select":t.multiple=!!i.multiple,n=i.value,n!=null?Np(t,!!i.multiple,n,!1):i.defaultValue!=null&&Np(t,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=dE)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return xo(e),null;case 6:if(t&&e.stateNode!=null)TG(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Rt(166));if(r=rg(Wy.current),rg(Lu.current),db(e)){if(i=e.stateNode,r=e.memoizedProps,i[Iu]=e,(n=i.nodeValue!==r)&&(t=rl,t!==null))switch(t.tag){case 3:fb(i.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fb(i.nodeValue,r,(t.mode&1)!==0)}n&&(e.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[Iu]=e,e.stateNode=i}return xo(e),null;case 13:if(vi(ki),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ti&&Za!==null&&e.mode&1&&!(e.flags&128))jz(),r1(),e.flags|=98560,n=!1;else if(n=db(e),i!==null&&i.dehydrated!==null){if(t===null){if(!n)throw Error(Rt(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Rt(317));n[Iu]=e}else r1(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;xo(e),n=!1}else bc!==null&&(mP(bc),bc=null),n=!0;if(!n)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||ki.current&1?Is===0&&(Is=3):$M())),e.updateQueue!==null&&(e.flags|=4),xo(e),null);case 4:return i1(),aP(t,e),t===null&&Hy(e.stateNode.containerInfo),xo(e),null;case 10:return bM(e.type._context),xo(e),null;case 17:return Aa(e.type)&&gE(),xo(e),null;case 19:if(vi(ki),n=e.memoizedState,n===null)return xo(e),null;if(i=(e.flags&128)!==0,o=n.rendering,o===null)if(i)Tv(n,!1);else{if(Is!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=SE(t),o!==null){for(e.flags|=128,Tv(n,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=r,r=e.child;r!==null;)n=r,t=i,n.flags&=14680066,o=n.alternate,o===null?(n.childLanes=0,n.lanes=t,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,t=o.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ai(ki,ki.current&1|2),e.child}t=t.sibling}n.tail!==null&&rs()>o1&&(e.flags|=128,i=!0,Tv(n,!1),e.lanes=4194304)}else{if(!i)if(t=SE(o),t!==null){if(e.flags|=128,i=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Tv(n,!0),n.tail===null&&n.tailMode==="hidden"&&!o.alternate&&!Ti)return xo(e),null}else 2*rs()-n.renderingStartTime>o1&&r!==1073741824&&(e.flags|=128,i=!0,Tv(n,!1),e.lanes=4194304);n.isBackwards?(o.sibling=e.child,e.child=o):(r=n.last,r!==null?r.sibling=o:e.child=o,n.last=o)}return n.tail!==null?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=rs(),e.sibling=null,r=ki.current,ai(ki,i?r&1|2:r&1),e):(xo(e),null);case 22:case 23:return HM(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ka&1073741824&&(xo(e),e.subtreeFlags&6&&(e.flags|=8192)):xo(e),null;case 24:return null;case 25:return null}throw Error(Rt(156,e.tag))}function lae(t,e){switch(wM(e),e.tag){case 1:return Aa(e.type)&&gE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return i1(),vi(Ra),vi(Do),RM(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _M(e),null;case 13:if(vi(ki),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Rt(340));r1()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return vi(ki),null;case 4:return i1(),null;case 10:return bM(e.type._context),null;case 22:case 23:return HM(),null;case 24:return null;default:return null}}var pb=!1,Io=!1,cae=typeof WeakSet=="function"?WeakSet:Set,ar=null;function Tp(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Ki(t,e,i)}else r.current=null}function lP(t,e,r){try{r()}catch(i){Ki(t,e,i)}}var U7=!1;function uae(t,e){if(z3=uE,t=Iz(),pM(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var s=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{r.nodeType,n.nodeType}catch{r=null;break e}var o=0,l=-1,h=-1,d=0,g=0,y=t,C=null;t:for(;;){for(var x;y!==r||s!==0&&y.nodeType!==3||(l=o+s),y!==n||i!==0&&y.nodeType!==3||(h=o+i),y.nodeType===3&&(o+=y.nodeValue.length),(x=y.firstChild)!==null;)C=y,y=x;for(;;){if(y===t)break t;if(C===r&&++d===s&&(l=o),C===n&&++g===i&&(h=o),(x=y.nextSibling)!==null)break;y=C,C=y.parentNode}y=x}r=l===-1||h===-1?null:{start:l,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(G3={focusedElem:t,selectionRange:r},uE=!1,ar=e;ar!==null;)if(e=ar,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ar=t;else for(;ar!==null;){e=ar;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var E=_.memoizedProps,R=_.memoizedState,I=e.stateNode,F=I.getSnapshotBeforeUpdate(e.elementType===e.type?E:vc(e.type,E),R);I.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var D=e.stateNode.containerInfo;D.nodeType===1?D.textContent="":D.nodeType===9&&D.documentElement&&D.removeChild(D.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Rt(163))}}catch(U){Ki(e,e.return,U)}if(t=e.sibling,t!==null){t.return=e.return,ar=t;break}ar=e.return}return _=U7,U7=!1,_}function Zw(t,e,r){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var n=s.destroy;s.destroy=void 0,n!==void 0&&lP(e,r,n)}s=s.next}while(s!==i)}}function o_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var i=r.create;r.destroy=i()}r=r.next}while(r!==e)}}function cP(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function _G(t){var e=t.alternate;e!==null&&(t.alternate=null,_G(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Iu],delete e[By],delete e[X3],delete e[Goe],delete e[Yoe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function RG(t){return t.tag===5||t.tag===3||t.tag===4}function z7(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||RG(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function uP(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=dE));else if(i!==4&&(t=t.child,t!==null))for(uP(t,e,r),t=t.sibling;t!==null;)uP(t,e,r),t=t.sibling}function hP(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(hP(t,e,r),t=t.sibling;t!==null;)hP(t,e,r),t=t.sibling}var eo=null,wc=!1;function xf(t,e,r){for(r=r.child;r!==null;)AG(t,e,r),r=r.sibling}function AG(t,e,r){if(Du&&typeof Du.onCommitFiberUnmount=="function")try{Du.onCommitFiberUnmount(QT,r)}catch{}switch(r.tag){case 5:Io||Tp(r,e);case 6:var i=eo,s=wc;eo=null,xf(t,e,r),eo=i,wc=s,eo!==null&&(wc?(t=eo,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):eo.removeChild(r.stateNode));break;case 18:eo!==null&&(wc?(t=eo,r=r.stateNode,t.nodeType===8?s4(t.parentNode,r):t.nodeType===1&&s4(t,r),Ny(t)):s4(eo,r.stateNode));break;case 4:i=eo,s=wc,eo=r.stateNode.containerInfo,wc=!0,xf(t,e,r),eo=i,wc=s;break;case 0:case 11:case 14:case 15:if(!Io&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var n=s,o=n.destroy;n=n.tag,o!==void 0&&(n&2||n&4)&&lP(r,e,o),s=s.next}while(s!==i)}xf(t,e,r);break;case 1:if(!Io&&(Tp(r,e),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(l){Ki(r,e,l)}xf(t,e,r);break;case 21:xf(t,e,r);break;case 22:r.mode&1?(Io=(i=Io)||r.memoizedState!==null,xf(t,e,r),Io=i):xf(t,e,r);break;default:xf(t,e,r)}}function G7(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new cae),e.forEach(function(i){var s=yae.bind(null,t,i);r.has(i)||(r.add(i),i.then(s,s))})}}function Ql(t,e){var r=e.deletions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];try{var n=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:eo=l.stateNode,wc=!1;break e;case 3:eo=l.stateNode.containerInfo,wc=!0;break e;case 4:eo=l.stateNode.containerInfo,wc=!0;break e}l=l.return}if(eo===null)throw Error(Rt(160));AG(n,o,s),eo=null,wc=!1;var h=s.alternate;h!==null&&(h.return=null),s.return=null}catch(d){Ki(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)OG(e,t),e=e.sibling}function OG(t,e){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ql(e,t),Jc(t),i&4){try{Zw(3,t,t.return),o_(3,t)}catch(E){Ki(t,t.return,E)}try{Zw(5,t,t.return)}catch(E){Ki(t,t.return,E)}}break;case 1:Ql(e,t),Jc(t),i&512&&r!==null&&Tp(r,r.return);break;case 5:if(Ql(e,t),Jc(t),i&512&&r!==null&&Tp(r,r.return),t.flags&32){var s=t.stateNode;try{Py(s,"")}catch(E){Ki(t,t.return,E)}}if(i&4&&(s=t.stateNode,s!=null)){var n=t.memoizedProps,o=r!==null?r.memoizedProps:n,l=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{l==="input"&&n.type==="radio"&&n.name!=null&&JU(s,n),N3(l,o);var d=N3(l,n);for(o=0;o<h.length;o+=2){var g=h[o],y=h[o+1];g==="style"?rz(s,y):g==="dangerouslySetInnerHTML"?ez(s,y):g==="children"?Py(s,y):nM(s,g,y,d)}switch(l){case"input":I3(s,n);break;case"textarea":QU(s,n);break;case"select":var C=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!n.multiple;var x=n.value;x!=null?Np(s,!!n.multiple,x,!1):C!==!!n.multiple&&(n.defaultValue!=null?Np(s,!!n.multiple,n.defaultValue,!0):Np(s,!!n.multiple,n.multiple?[]:"",!1))}s[By]=n}catch(E){Ki(t,t.return,E)}}break;case 6:if(Ql(e,t),Jc(t),i&4){if(t.stateNode===null)throw Error(Rt(162));s=t.stateNode,n=t.memoizedProps;try{s.nodeValue=n}catch(E){Ki(t,t.return,E)}}break;case 3:if(Ql(e,t),Jc(t),i&4&&r!==null&&r.memoizedState.isDehydrated)try{Ny(e.containerInfo)}catch(E){Ki(t,t.return,E)}break;case 4:Ql(e,t),Jc(t);break;case 13:Ql(e,t),Jc(t),s=t.child,s.flags&8192&&(n=s.memoizedState!==null,s.stateNode.isHidden=n,!n||s.alternate!==null&&s.alternate.memoizedState!==null||(DM=rs())),i&4&&G7(t);break;case 22:if(g=r!==null&&r.memoizedState!==null,t.mode&1?(Io=(d=Io)||g,Ql(e,t),Io=d):Ql(e,t),Jc(t),i&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!g&&t.mode&1)for(ar=t,g=t.child;g!==null;){for(y=ar=g;ar!==null;){switch(C=ar,x=C.child,C.tag){case 0:case 11:case 14:case 15:Zw(4,C,C.return);break;case 1:Tp(C,C.return);var _=C.stateNode;if(typeof _.componentWillUnmount=="function"){i=C,r=C.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(E){Ki(i,r,E)}}break;case 5:Tp(C,C.return);break;case 22:if(C.memoizedState!==null){K7(y);continue}}x!==null?(x.return=C,ar=x):K7(y)}g=g.sibling}e:for(g=null,y=t;;){if(y.tag===5){if(g===null){g=y;try{s=y.stateNode,d?(n=s.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(l=y.stateNode,h=y.memoizedProps.style,o=h!=null&&h.hasOwnProperty("display")?h.display:null,l.style.display=tz("display",o))}catch(E){Ki(t,t.return,E)}}}else if(y.tag===6){if(g===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(E){Ki(t,t.return,E)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;g===y&&(g=null),y=y.return}g===y&&(g=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:Ql(e,t),Jc(t),i&4&&G7(t);break;case 21:break;default:Ql(e,t),Jc(t)}}function Jc(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(RG(r)){var i=r;break e}r=r.return}throw Error(Rt(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(Py(s,""),i.flags&=-33);var n=z7(t);hP(t,n,s);break;case 3:case 4:var o=i.stateNode.containerInfo,l=z7(t);uP(t,l,o);break;default:throw Error(Rt(161))}}catch(h){Ki(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function hae(t,e,r){ar=t,IG(t)}function IG(t,e,r){for(var i=(t.mode&1)!==0;ar!==null;){var s=ar,n=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||pb;if(!o){var l=s.alternate,h=l!==null&&l.memoizedState!==null||Io;l=pb;var d=Io;if(pb=o,(Io=h)&&!d)for(ar=s;ar!==null;)o=ar,h=o.child,o.tag===22&&o.memoizedState!==null?X7(s):h!==null?(h.return=o,ar=h):X7(s);for(;n!==null;)ar=n,IG(n),n=n.sibling;ar=s,pb=l,Io=d}Y7(t)}else s.subtreeFlags&8772&&n!==null?(n.return=s,ar=n):Y7(t)}}function Y7(t){for(;ar!==null;){var e=ar;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Io||o_(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Io)if(r===null)i.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:vc(e.type,r.memoizedProps);i.componentDidUpdate(s,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=e.updateQueue;n!==null&&P7(e,n,i);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}P7(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var y=g.dehydrated;y!==null&&Ny(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Rt(163))}Io||e.flags&512&&cP(e)}catch(C){Ki(e,e.return,C)}}if(e===t){ar=null;break}if(r=e.sibling,r!==null){r.return=e.return,ar=r;break}ar=e.return}}function K7(t){for(;ar!==null;){var e=ar;if(e===t){ar=null;break}var r=e.sibling;if(r!==null){r.return=e.return,ar=r;break}ar=e.return}}function X7(t){for(;ar!==null;){var e=ar;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{o_(4,e)}catch(h){Ki(e,r,h)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(h){Ki(e,s,h)}}var n=e.return;try{cP(e)}catch(h){Ki(e,n,h)}break;case 5:var o=e.return;try{cP(e)}catch(h){Ki(e,o,h)}}}catch(h){Ki(e,e.return,h)}if(e===t){ar=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ar=l;break}ar=e.return}}var fae=Math.ceil,EE=of.ReactCurrentDispatcher,kM=of.ReactCurrentOwner,$l=of.ReactCurrentBatchConfig,En=0,Gs=null,ds=null,io=0,Ka=0,_p=kd(0),Is=0,Gy=null,bg=0,a_=0,NM=0,ey=null,Ta=null,DM=0,o1=1/0,Th=null,TE=!1,fP=null,vd=null,vb=!1,td=null,_E=0,ty=0,dP=null,T2=-1,_2=0;function ra(){return En&6?rs():T2!==-1?T2:T2=rs()}function wd(t){return t.mode&1?En&2&&io!==0?io&-io:Xoe.transition!==null?(_2===0&&(_2=gz()),_2):(t=Yn,t!==0||(t=window.event,t=t===void 0?16:Sz(t.type)),t):1}function Ac(t,e,r,i){if(50<ty)throw ty=0,dP=null,Error(Rt(185));RC(t,r,i),(!(En&2)||t!==Gs)&&(t===Gs&&(!(En&2)&&(a_|=r),Is===4&&qf(t,io)),Oa(t,i),r===1&&En===0&&!(e.mode&1)&&(o1=rs()+500,n_&&Nd()))}function Oa(t,e){var r=t.callbackNode;Xse(t,e);var i=cE(t,t===Gs?io:0);if(i===0)r!==null&&i7(r),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(r!=null&&i7(r),e===1)t.tag===0?Koe(q7.bind(null,t)):Bz(q7.bind(null,t)),Uoe(function(){!(En&6)&&Nd()}),r=null;else{switch(mz(i)){case 1:r=lM;break;case 4:r=fz;break;case 16:r=lE;break;case 536870912:r=dz;break;default:r=lE}r=HG(r,PG.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function PG(t,e){if(T2=-1,_2=0,En&6)throw Error(Rt(327));var r=t.callbackNode;if(Bp()&&t.callbackNode!==r)return null;var i=cE(t,t===Gs?io:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=RE(t,i);else{e=i;var s=En;En|=2;var n=MG();(Gs!==t||io!==e)&&(Th=null,o1=rs()+500,hg(t,e));do try{mae();break}catch(l){FG(t,l)}while(!0);SM(),EE.current=n,En=s,ds!==null?e=0:(Gs=null,io=0,e=Is)}if(e!==0){if(e===2&&(s=B3(t),s!==0&&(i=s,e=gP(t,s))),e===1)throw r=Gy,hg(t,0),qf(t,i),Oa(t,rs()),r;if(e===6)qf(t,i);else{if(s=t.current.alternate,!(i&30)&&!dae(s)&&(e=RE(t,i),e===2&&(n=B3(t),n!==0&&(i=n,e=gP(t,n))),e===1))throw r=Gy,hg(t,0),qf(t,i),Oa(t,rs()),r;switch(t.finishedWork=s,t.finishedLanes=i,e){case 0:case 1:throw Error(Rt(345));case 2:G0(t,Ta,Th);break;case 3:if(qf(t,i),(i&130023424)===i&&(e=DM+500-rs(),10<e)){if(cE(t,0)!==0)break;if(s=t.suspendedLanes,(s&i)!==i){ra(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=K3(G0.bind(null,t,Ta,Th),e);break}G0(t,Ta,Th);break;case 4:if(qf(t,i),(i&4194240)===i)break;for(e=t.eventTimes,s=-1;0<i;){var o=31-Rc(i);n=1<<o,o=e[o],o>s&&(s=o),i&=~n}if(i=s,i=rs()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*fae(i/1960))-i,10<i){t.timeoutHandle=K3(G0.bind(null,t,Ta,Th),i);break}G0(t,Ta,Th);break;case 5:G0(t,Ta,Th);break;default:throw Error(Rt(329))}}}return Oa(t,rs()),t.callbackNode===r?PG.bind(null,t):null}function gP(t,e){var r=ey;return t.current.memoizedState.isDehydrated&&(hg(t,e).flags|=256),t=RE(t,e),t!==2&&(e=Ta,Ta=r,e!==null&&mP(e)),t}function mP(t){Ta===null?Ta=t:Ta.push.apply(Ta,t)}function dae(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var s=r[i],n=s.getSnapshot;s=s.value;try{if(!Fc(n(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qf(t,e){for(e&=~NM,e&=~a_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Rc(e),i=1<<r;t[r]=-1,e&=~i}}function q7(t){if(En&6)throw Error(Rt(327));Bp();var e=cE(t,0);if(!(e&1))return Oa(t,rs()),null;var r=RE(t,e);if(t.tag!==0&&r===2){var i=B3(t);i!==0&&(e=i,r=gP(t,i))}if(r===1)throw r=Gy,hg(t,0),qf(t,e),Oa(t,rs()),r;if(r===6)throw Error(Rt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,G0(t,Ta,Th),Oa(t,rs()),null}function LM(t,e){var r=En;En|=1;try{return t(e)}finally{En=r,En===0&&(o1=rs()+500,n_&&Nd())}}function xg(t){td!==null&&td.tag===0&&!(En&6)&&Bp();var e=En;En|=1;var r=$l.transition,i=Yn;try{if($l.transition=null,Yn=1,t)return t()}finally{Yn=i,$l.transition=r,En=e,!(En&6)&&Nd()}}function HM(){Ka=_p.current,vi(_p)}function hg(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,joe(r)),ds!==null)for(r=ds.return;r!==null;){var i=r;switch(wM(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&gE();break;case 3:i1(),vi(Ra),vi(Do),RM();break;case 5:_M(i);break;case 4:i1();break;case 13:vi(ki);break;case 19:vi(ki);break;case 10:bM(i.type._context);break;case 22:case 23:HM()}r=r.return}if(Gs=t,ds=t=yd(t.current,null),io=Ka=e,Is=0,Gy=null,NM=a_=bg=0,Ta=ey=null,tg!==null){for(e=0;e<tg.length;e++)if(r=tg[e],i=r.interleaved,i!==null){r.interleaved=null;var s=i.next,n=r.pending;if(n!==null){var o=n.next;n.next=s,i.next=o}r.pending=i}tg=null}return t}function FG(t,e){do{var r=ds;try{if(SM(),b2.current=xE,bE){for(var i=Li.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}bE=!1}if(Sg=0,Bs=Os=Li=null,Qw=!1,jy=0,kM.current=null,r===null||r.return===null){Is=1,Gy=e,ds=null;break}e:{var n=t,o=r.return,l=r,h=e;if(e=io,l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var d=h,g=l,y=g.tag;if(!(g.mode&1)&&(y===0||y===11||y===15)){var C=g.alternate;C?(g.updateQueue=C.updateQueue,g.memoizedState=C.memoizedState,g.lanes=C.lanes):(g.updateQueue=null,g.memoizedState=null)}var x=L7(o);if(x!==null){x.flags&=-257,H7(x,o,l,n,e),x.mode&1&&D7(n,d,e),e=x,h=d;var _=e.updateQueue;if(_===null){var E=new Set;E.add(h),e.updateQueue=E}else _.add(h);break e}else{if(!(e&1)){D7(n,d,e),$M();break e}h=Error(Rt(426))}}else if(Ti&&l.mode&1){var R=L7(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),H7(R,o,l,n,e),yM(s1(h,l));break e}}n=h=s1(h,l),Is!==4&&(Is=2),ey===null?ey=[n]:ey.push(n),n=o;do{switch(n.tag){case 3:n.flags|=65536,e&=-e,n.lanes|=e;var I=mG(n,h,e);I7(n,I);break e;case 1:l=h;var F=n.type,D=n.stateNode;if(!(n.flags&128)&&(typeof F.getDerivedStateFromError=="function"||D!==null&&typeof D.componentDidCatch=="function"&&(vd===null||!vd.has(D)))){n.flags|=65536,e&=-e,n.lanes|=e;var U=pG(n,l,e);I7(n,U);break e}}n=n.return}while(n!==null)}NG(r)}catch(X){e=X,ds===r&&r!==null&&(ds=r=r.return);continue}break}while(!0)}function MG(){var t=EE.current;return EE.current=xE,t===null?xE:t}function $M(){(Is===0||Is===3||Is===2)&&(Is=4),Gs===null||!(bg&268435455)&&!(a_&268435455)||qf(Gs,io)}function RE(t,e){var r=En;En|=2;var i=MG();(Gs!==t||io!==e)&&(Th=null,hg(t,e));do try{gae();break}catch(s){FG(t,s)}while(!0);if(SM(),En=r,EE.current=i,ds!==null)throw Error(Rt(261));return Gs=null,io=0,Is}function gae(){for(;ds!==null;)kG(ds)}function mae(){for(;ds!==null&&!Bse();)kG(ds)}function kG(t){var e=LG(t.alternate,t,Ka);t.memoizedProps=t.pendingProps,e===null?NG(t):ds=e,kM.current=null}function NG(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=lae(r,e),r!==null){r.flags&=32767,ds=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Is=6,ds=null;return}}else if(r=aae(r,e,Ka),r!==null){ds=r;return}if(e=e.sibling,e!==null){ds=e;return}ds=e=t}while(e!==null);Is===0&&(Is=5)}function G0(t,e,r){var i=Yn,s=$l.transition;try{$l.transition=null,Yn=1,pae(t,e,r,i)}finally{$l.transition=s,Yn=i}return null}function pae(t,e,r,i){do Bp();while(td!==null);if(En&6)throw Error(Rt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(Rt(177));t.callbackNode=null,t.callbackPriority=0;var n=r.lanes|r.childLanes;if(qse(t,n),t===Gs&&(ds=Gs=null,io=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vb||(vb=!0,HG(lE,function(){return Bp(),null})),n=(r.flags&15990)!==0,r.subtreeFlags&15990||n){n=$l.transition,$l.transition=null;var o=Yn;Yn=1;var l=En;En|=4,kM.current=null,uae(t,r),OG(r,t),Doe(G3),uE=!!z3,G3=z3=null,t.current=r,hae(r),Vse(),En=l,Yn=o,$l.transition=n}else t.current=r;if(vb&&(vb=!1,td=t,_E=s),n=t.pendingLanes,n===0&&(vd=null),Use(r.stateNode),Oa(t,rs()),e!==null)for(i=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],i(s.value,{componentStack:s.stack,digest:s.digest});if(TE)throw TE=!1,t=fP,fP=null,t;return _E&1&&t.tag!==0&&Bp(),n=t.pendingLanes,n&1?t===dP?ty++:(ty=0,dP=t):ty=0,Nd(),null}function Bp(){if(td!==null){var t=mz(_E),e=$l.transition,r=Yn;try{if($l.transition=null,Yn=16>t?16:t,td===null)var i=!1;else{if(t=td,td=null,_E=0,En&6)throw Error(Rt(331));var s=En;for(En|=4,ar=t.current;ar!==null;){var n=ar,o=n.child;if(ar.flags&16){var l=n.deletions;if(l!==null){for(var h=0;h<l.length;h++){var d=l[h];for(ar=d;ar!==null;){var g=ar;switch(g.tag){case 0:case 11:case 15:Zw(8,g,n)}var y=g.child;if(y!==null)y.return=g,ar=y;else for(;ar!==null;){g=ar;var C=g.sibling,x=g.return;if(_G(g),g===d){ar=null;break}if(C!==null){C.return=x,ar=C;break}ar=x}}}var _=n.alternate;if(_!==null){var E=_.child;if(E!==null){_.child=null;do{var R=E.sibling;E.sibling=null,E=R}while(E!==null)}}ar=n}}if(n.subtreeFlags&2064&&o!==null)o.return=n,ar=o;else e:for(;ar!==null;){if(n=ar,n.flags&2048)switch(n.tag){case 0:case 11:case 15:Zw(9,n,n.return)}var I=n.sibling;if(I!==null){I.return=n.return,ar=I;break e}ar=n.return}}var F=t.current;for(ar=F;ar!==null;){o=ar;var D=o.child;if(o.subtreeFlags&2064&&D!==null)D.return=o,ar=D;else e:for(o=F;ar!==null;){if(l=ar,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:o_(9,l)}}catch(X){Ki(l,l.return,X)}if(l===o){ar=null;break e}var U=l.sibling;if(U!==null){U.return=l.return,ar=U;break e}ar=l.return}}if(En=s,Nd(),Du&&typeof Du.onPostCommitFiberRoot=="function")try{Du.onPostCommitFiberRoot(QT,t)}catch{}i=!0}return i}finally{Yn=r,$l.transition=e}}return!1}function J7(t,e,r){e=s1(r,e),e=mG(t,e,1),t=pd(t,e,1),e=ra(),t!==null&&(RC(t,1,e),Oa(t,e))}function Ki(t,e,r){if(t.tag===3)J7(t,t,r);else for(;e!==null;){if(e.tag===3){J7(e,t,r);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(vd===null||!vd.has(i))){t=s1(r,t),t=pG(e,t,1),e=pd(e,t,1),t=ra(),e!==null&&(RC(e,1,t),Oa(e,t));break}}e=e.return}}function vae(t,e,r){var i=t.pingCache;i!==null&&i.delete(e),e=ra(),t.pingedLanes|=t.suspendedLanes&r,Gs===t&&(io&r)===r&&(Is===4||Is===3&&(io&130023424)===io&&500>rs()-DM?hg(t,0):NM|=r),Oa(t,e)}function DG(t,e){e===0&&(t.mode&1?(e=ab,ab<<=1,!(ab&130023424)&&(ab=4194304)):e=1);var r=ra();t=qh(t,e),t!==null&&(RC(t,e,r),Oa(t,r))}function wae(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),DG(t,r)}function yae(t,e){var r=0;switch(t.tag){case 13:var i=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Rt(314))}i!==null&&i.delete(e),DG(t,r)}var LG;LG=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ra.current)_a=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return _a=!1,oae(t,e,r);_a=!!(t.flags&131072)}else _a=!1,Ti&&e.flags&1048576&&Vz(e,vE,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;E2(t,e),t=e.pendingProps;var s=t1(e,Do.current);$p(e,r),s=OM(null,e,i,t,s,r);var n=IM();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Aa(i)?(n=!0,mE(e)):n=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,EM(e),s.updater=s_,e.stateNode=s,s._reactInternals=e,tP(e,i,t,r),e=iP(null,e,i,!0,n,r)):(e.tag=0,Ti&&n&&vM(e),Ko(null,e,s,r),e=e.child),e;case 16:i=e.elementType;e:{switch(E2(t,e),t=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=Sae(i),t=vc(i,t),s){case 0:e=nP(null,e,i,t,r);break e;case 1:e=V7(null,e,i,t,r);break e;case 11:e=$7(null,e,i,t,r);break e;case 14:e=B7(null,e,i,vc(i.type,t),r);break e}throw Error(Rt(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:vc(i,s),nP(t,e,i,s,r);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:vc(i,s),V7(t,e,i,s,r);case 3:e:{if(CG(e),t===null)throw Error(Rt(387));i=e.pendingProps,n=e.memoizedState,s=n.element,Yz(t,e),CE(e,i,null,r);var o=e.memoizedState;if(i=o.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=n,e.memoizedState=n,e.flags&256){s=s1(Error(Rt(423)),e),e=W7(t,e,i,r,s);break e}else if(i!==s){s=s1(Error(Rt(424)),e),e=W7(t,e,i,r,s);break e}else for(Za=md(e.stateNode.containerInfo.firstChild),rl=e,Ti=!0,bc=null,r=zz(e,null,i,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(r1(),i===s){e=Jh(t,e,r);break e}Ko(t,e,i,r)}e=e.child}return e;case 5:return Kz(e),t===null&&Q3(e),i=e.type,s=e.pendingProps,n=t!==null?t.memoizedProps:null,o=s.children,Y3(i,s)?o=null:n!==null&&Y3(i,n)&&(e.flags|=32),yG(t,e),Ko(t,e,o,r),e.child;case 6:return t===null&&Q3(e),null;case 13:return SG(t,e,r);case 4:return TM(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=n1(e,null,i,r):Ko(t,e,i,r),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:vc(i,s),$7(t,e,i,s,r);case 7:return Ko(t,e,e.pendingProps,r),e.child;case 8:return Ko(t,e,e.pendingProps.children,r),e.child;case 12:return Ko(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,n=e.memoizedProps,o=s.value,ai(wE,i._currentValue),i._currentValue=o,n!==null)if(Fc(n.value,o)){if(n.children===s.children&&!Ra.current){e=Jh(t,e,r);break e}}else for(n=e.child,n!==null&&(n.return=e);n!==null;){var l=n.dependencies;if(l!==null){o=n.child;for(var h=l.firstContext;h!==null;){if(h.context===i){if(n.tag===1){h=Wh(-1,r&-r),h.tag=2;var d=n.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?h.next=h:(h.next=g.next,g.next=h),d.pending=h}}n.lanes|=r,h=n.alternate,h!==null&&(h.lanes|=r),Z3(n.return,r,e),l.lanes|=r;break}h=h.next}}else if(n.tag===10)o=n.type===e.type?null:n.child;else if(n.tag===18){if(o=n.return,o===null)throw Error(Rt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Z3(o,r,e),o=n.sibling}else o=n.child;if(o!==null)o.return=n;else for(o=n;o!==null;){if(o===e){o=null;break}if(n=o.sibling,n!==null){n.return=o.return,o=n;break}o=o.return}n=o}Ko(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,$p(e,r),s=Vl(s),i=i(s),e.flags|=1,Ko(t,e,i,r),e.child;case 14:return i=e.type,s=vc(i,e.pendingProps),s=vc(i.type,s),B7(t,e,i,s,r);case 15:return vG(t,e,e.type,e.pendingProps,r);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:vc(i,s),E2(t,e),e.tag=1,Aa(i)?(t=!0,mE(e)):t=!1,$p(e,r),gG(e,i,s),tP(e,i,s,r),iP(null,e,i,!0,t,r);case 19:return bG(t,e,r);case 22:return wG(t,e,r)}throw Error(Rt(156,e.tag))};function HG(t,e){return hz(t,e)}function Cae(t,e,r,i){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Hl(t,e,r,i){return new Cae(t,e,r,i)}function BM(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Sae(t){if(typeof t=="function")return BM(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sM)return 11;if(t===oM)return 14}return 2}function yd(t,e){var r=t.alternate;return r===null?(r=Hl(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function R2(t,e,r,i,s,n){var o=2;if(i=t,typeof t=="function")BM(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pp:return fg(r.children,s,n,e);case iM:o=8,s|=8;break;case T3:return t=Hl(12,r,e,s|2),t.elementType=T3,t.lanes=n,t;case _3:return t=Hl(13,r,e,s),t.elementType=_3,t.lanes=n,t;case R3:return t=Hl(19,r,e,s),t.elementType=R3,t.lanes=n,t;case KU:return l_(r,s,n,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case GU:o=10;break e;case YU:o=9;break e;case sM:o=11;break e;case oM:o=14;break e;case Wf:o=16,i=null;break e}throw Error(Rt(130,t==null?t:typeof t,""))}return e=Hl(o,r,e,s),e.elementType=t,e.type=i,e.lanes=n,e}function fg(t,e,r,i){return t=Hl(7,t,i,e),t.lanes=r,t}function l_(t,e,r,i){return t=Hl(22,t,i,e),t.elementType=KU,t.lanes=r,t.stateNode={isHidden:!1},t}function d4(t,e,r){return t=Hl(6,t,null,e),t.lanes=r,t}function g4(t,e,r){return e=Hl(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function bae(t,e,r,i,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=KA(0),this.expirationTimes=KA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=KA(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function VM(t,e,r,i,s,n,o,l,h){return t=new bae(t,e,r,l,h),e===1?(e=1,n===!0&&(e|=8)):e=0,n=Hl(3,null,null,e),t.current=n,n.stateNode=t,n.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},EM(n),t}function xae(t,e,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mp,key:i==null?null:""+i,children:t,containerInfo:e,implementation:r}}function $G(t){if(!t)return _d;t=t._reactInternals;e:{if(Bg(t)!==t||t.tag!==1)throw Error(Rt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Aa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Rt(171))}if(t.tag===1){var r=t.type;if(Aa(r))return $z(t,r,e)}return e}function BG(t,e,r,i,s,n,o,l,h){return t=VM(r,i,!0,t,s,n,o,l,h),t.context=$G(null),r=t.current,i=ra(),s=wd(r),n=Wh(i,s),n.callback=e??null,pd(r,n,s),t.current.lanes=s,RC(t,s,i),Oa(t,i),t}function c_(t,e,r,i){var s=e.current,n=ra(),o=wd(s);return r=$G(r),e.context===null?e.context=r:e.pendingContext=r,e=Wh(n,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=pd(s,e,o),t!==null&&(Ac(t,s,o,n),S2(t,s,o)),o}function AE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Q7(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function WM(t,e){Q7(t,e),(t=t.alternate)&&Q7(t,e)}var VG=typeof reportError=="function"?reportError:function(t){console.error(t)};function jM(t){this._internalRoot=t}u_.prototype.render=jM.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Rt(409));c_(t,e,null,null)};u_.prototype.unmount=jM.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;xg(function(){c_(null,t,null,null)}),e[Xh]=null}};function u_(t){this._internalRoot=t}u_.prototype.unstable_scheduleHydration=function(t){if(t){var e=wz();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Xf.length&&e!==0&&e<Xf[r].priority;r++);Xf.splice(r,0,t),r===0&&Cz(t)}};function UM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function h_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Z7(){}function Eae(t,e,r,i,s){if(s){if(typeof i=="function"){var n=i;i=function(){var d=AE(o);n.call(d)}}var o=BG(e,i,t,0,null,!1,!1,"",Z7);return t._reactRootContainer=o,t[Xh]=o.current,Hy(t.nodeType===8?t.parentNode:t),xg(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof i=="function"){var l=i;i=function(){var d=AE(h);l.call(d)}}var h=VM(t,0,!1,null,null,!1,!1,"",Z7);return t._reactRootContainer=h,t[Xh]=h.current,Hy(t.nodeType===8?t.parentNode:t),xg(function(){c_(e,h,r,i)}),h}function f_(t,e,r,i,s){var n=r._reactRootContainer;if(n){var o=n;if(typeof s=="function"){var l=s;s=function(){var h=AE(o);l.call(h)}}c_(e,o,t,s)}else o=Eae(r,e,t,s,i);return AE(o)}pz=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Lw(e.pendingLanes);r!==0&&(cM(e,r|1),Oa(e,rs()),!(En&6)&&(o1=rs()+500,Nd()))}break;case 13:xg(function(){var i=qh(t,1);if(i!==null){var s=ra();Ac(i,t,1,s)}}),WM(t,1)}};uM=function(t){if(t.tag===13){var e=qh(t,134217728);if(e!==null){var r=ra();Ac(e,t,134217728,r)}WM(t,134217728)}};vz=function(t){if(t.tag===13){var e=wd(t),r=qh(t,e);if(r!==null){var i=ra();Ac(r,t,e,i)}WM(t,e)}};wz=function(){return Yn};yz=function(t,e){var r=Yn;try{return Yn=t,e()}finally{Yn=r}};L3=function(t,e,r){switch(e){case"input":if(I3(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var i=r[e];if(i!==t&&i.form===t.form){var s=r_(i);if(!s)throw Error(Rt(90));qU(i),I3(i,s)}}}break;case"textarea":QU(t,r);break;case"select":e=r.value,e!=null&&Np(t,!!r.multiple,e,!1)}};sz=LM;oz=xg;var Tae={usingClientEntryPoint:!1,Events:[OC,Cp,r_,nz,iz,LM]},_v={findFiberByHostInstance:eg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_ae={bundleType:_v.bundleType,version:_v.version,rendererPackageName:_v.rendererPackageName,rendererConfig:_v.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:of.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cz(t),t===null?null:t.stateNode},findFiberByHostInstance:_v.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wb.isDisabled&&wb.supportsFiber)try{QT=wb.inject(_ae),Du=wb}catch{}}al.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Tae;al.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!UM(e))throw Error(Rt(200));return xae(t,e,null,r)};al.createRoot=function(t,e){if(!UM(t))throw Error(Rt(299));var r=!1,i="",s=VG;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=VM(t,1,!1,null,null,r,!1,i,s),t[Xh]=e.current,Hy(t.nodeType===8?t.parentNode:t),new jM(e)};al.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Rt(188)):(t=Object.keys(t).join(","),Error(Rt(268,t)));return t=cz(e),t=t===null?null:t.stateNode,t};al.flushSync=function(t){return xg(t)};al.hydrate=function(t,e,r){if(!h_(e))throw Error(Rt(200));return f_(null,t,e,!0,r)};al.hydrateRoot=function(t,e,r){if(!UM(t))throw Error(Rt(405));var i=r!=null&&r.hydratedSources||null,s=!1,n="",o=VG;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=BG(e,null,t,1,r??null,s,!1,n,o),t[Xh]=e.current,Hy(t),i)for(t=0;t<i.length;t++)r=i[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new u_(e)};al.render=function(t,e,r){if(!h_(e))throw Error(Rt(200));return f_(null,t,e,!1,r)};al.unmountComponentAtNode=function(t){if(!h_(t))throw Error(Rt(40));return t._reactRootContainer?(xg(function(){f_(null,null,t,!1,function(){t._reactRootContainer=null,t[Xh]=null})}),!0):!1};al.unstable_batchedUpdates=LM;al.unstable_renderSubtreeIntoContainer=function(t,e,r,i){if(!h_(r))throw Error(Rt(200));if(t==null||t._reactInternals===void 0)throw Error(Rt(38));return f_(t,e,r,!1,i)};al.version="18.3.1-next-f1338f8080-20240426";function WG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WG)}catch(t){console.error(t)}}WG(),WU.exports=al;var jG=WU.exports;const UG=qF(jG);var e$=jG;x3.createRoot=e$.createRoot,x3.hydrateRoot=e$.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yy(){return Yy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Yy.apply(this,arguments)}var rd;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rd||(rd={}));const t$="popstate";function Rae(t){t===void 0&&(t={});function e(i,s){let{pathname:n,search:o,hash:l}=i.location;return pP("",{pathname:n,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){return typeof s=="string"?s:GG(s)}return Oae(e,r,null,t)}function ms(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zG(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Aae(){return Math.random().toString(36).substr(2,8)}function r$(t,e){return{usr:t.state,key:t.key,idx:e}}function pP(t,e,r,i){return r===void 0&&(r=null),Yy({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?S1(e):e,{state:r,key:e&&e.key||i||Aae()})}function GG(t){let{pathname:e="/",search:r="",hash:i=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function S1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function Oae(t,e,r,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:n=!1}=i,o=s.history,l=rd.Pop,h=null,d=g();d==null&&(d=0,o.replaceState(Yy({},o.state,{idx:d}),""));function g(){return(o.state||{idx:null}).idx}function y(){l=rd.Pop;let R=g(),I=R==null?null:R-d;d=R,h&&h({action:l,location:E.location,delta:I})}function C(R,I){l=rd.Push;let F=pP(E.location,R,I);d=g()+1;let D=r$(F,d),U=E.createHref(F);try{o.pushState(D,"",U)}catch(X){if(X instanceof DOMException&&X.name==="DataCloneError")throw X;s.location.assign(U)}n&&h&&h({action:l,location:E.location,delta:1})}function x(R,I){l=rd.Replace;let F=pP(E.location,R,I);d=g();let D=r$(F,d),U=E.createHref(F);o.replaceState(D,"",U),n&&h&&h({action:l,location:E.location,delta:0})}function _(R){let I=s.location.origin!=="null"?s.location.origin:s.location.href,F=typeof R=="string"?R:GG(R);return F=F.replace(/ $/,"%20"),ms(I,"No window.location.(origin|href) available to create URL for href: "+F),new URL(F,I)}let E={get action(){return l},get location(){return t(s,o)},listen(R){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(t$,y),h=R,()=>{s.removeEventListener(t$,y),h=null}},createHref(R){return e(s,R)},createURL:_,encodeLocation(R){let I=_(R);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:C,replace:x,go(R){return o.go(R)}};return E}var n$;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(n$||(n$={}));function Iae(t,e,r){return r===void 0&&(r="/"),Pae(t,e,r)}function Pae(t,e,r,i){let s=typeof e=="string"?S1(e):e,n=XG(s.pathname||"/",r);if(n==null)return null;let o=YG(t);Fae(o);let l=null;for(let h=0;l==null&&h<o.length;++h){let d=Uae(n);l=Vae(o[h],d)}return l}function YG(t,e,r,i){e===void 0&&(e=[]),r===void 0&&(r=[]),i===void 0&&(i="");let s=(n,o,l)=>{let h={relativePath:l===void 0?n.path||"":l,caseSensitive:n.caseSensitive===!0,childrenIndex:o,route:n};h.relativePath.startsWith("/")&&(ms(h.relativePath.startsWith(i),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(i.length));let d=dg([i,h.relativePath]),g=r.concat(h);n.children&&n.children.length>0&&(ms(n.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),YG(n.children,e,g,d)),!(n.path==null&&!n.index)&&e.push({path:d,score:$ae(d,n.index),routesMeta:g})};return t.forEach((n,o)=>{var l;if(n.path===""||!((l=n.path)!=null&&l.includes("?")))s(n,o);else for(let h of KG(n.path))s(n,o,h)}),e}function KG(t){let e=t.split("/");if(e.length===0)return[];let[r,...i]=e,s=r.endsWith("?"),n=r.replace(/\?$/,"");if(i.length===0)return s?[n,""]:[n];let o=KG(i.join("/")),l=[];return l.push(...o.map(h=>h===""?n:[n,h].join("/"))),s&&l.push(...o),l.map(h=>t.startsWith("/")&&h===""?"/":h)}function Fae(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Bae(e.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const Mae=/^:[\w-]+$/,kae=3,Nae=2,Dae=1,Lae=10,Hae=-2,i$=t=>t==="*";function $ae(t,e){let r=t.split("/"),i=r.length;return r.some(i$)&&(i+=Hae),e&&(i+=Nae),r.filter(s=>!i$(s)).reduce((s,n)=>s+(Mae.test(n)?kae:n===""?Dae:Lae),i)}function Bae(t,e){return t.length===e.length&&t.slice(0,-1).every((i,s)=>i===e[s])?t[t.length-1]-e[e.length-1]:0}function Vae(t,e,r){let{routesMeta:i}=t,s={},n="/",o=[];for(let l=0;l<i.length;++l){let h=i[l],d=l===i.length-1,g=n==="/"?e:e.slice(n.length)||"/",y=Wae({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),C=h.route;if(!y)return null;Object.assign(s,y.params),o.push({params:s,pathname:dg([n,y.pathname]),pathnameBase:Kae(dg([n,y.pathnameBase])),route:C}),y.pathnameBase!=="/"&&(n=dg([n,y.pathnameBase]))}return o}function Wae(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,i]=jae(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let n=s[0],o=n.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:i.reduce((d,g,y)=>{let{paramName:C,isOptional:x}=g;if(C==="*"){let E=l[y]||"";o=n.slice(0,n.length-E.length).replace(/(.)\/+$/,"$1")}const _=l[y];return x&&!_?d[C]=void 0:d[C]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:n,pathnameBase:o,pattern:t}}function jae(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),zG(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,h)=>(i.push({paramName:l,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function Uae(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zG(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function XG(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,i=t.charAt(r);return i&&i!=="/"?null:t.slice(r)||"/"}function zae(t,e){e===void 0&&(e="/");let{pathname:r,search:i="",hash:s=""}=typeof t=="string"?S1(t):t;return{pathname:r?r.startsWith("/")?r:Gae(r,e):e,search:Xae(i),hash:qae(s)}}function Gae(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function m4(t,e,r,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Yae(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function qG(t,e){let r=Yae(t);return e?r.map((i,s)=>s===r.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function JG(t,e,r,i){i===void 0&&(i=!1);let s;typeof t=="string"?s=S1(t):(s=Yy({},t),ms(!s.pathname||!s.pathname.includes("?"),m4("?","pathname","search",s)),ms(!s.pathname||!s.pathname.includes("#"),m4("#","pathname","hash",s)),ms(!s.search||!s.search.includes("#"),m4("#","search","hash",s)));let n=t===""||s.pathname==="",o=n?"/":s.pathname,l;if(o==null)l=r;else{let y=e.length-1;if(!i&&o.startsWith("..")){let C=o.split("/");for(;C[0]==="..";)C.shift(),y-=1;s.pathname=C.join("/")}l=y>=0?e[y]:"/"}let h=zae(s,l),d=o&&o!=="/"&&o.endsWith("/"),g=(n||o===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}const dg=t=>t.join("/").replace(/\/\/+/g,"/"),Kae=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Xae=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,qae=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Jae(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QG=["post","put","patch","delete"];new Set(QG);const Qae=["get",...QG];new Set(Qae);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ky(){return Ky=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ky.apply(this,arguments)}const zM=We.createContext(null),Zae=We.createContext(null),PC=We.createContext(null),d_=We.createContext(null),Vg=We.createContext({outlet:null,matches:[],isDataRoute:!1}),ZG=We.createContext(null);function FC(){return We.useContext(d_)!=null}function MC(){return FC()||ms(!1),We.useContext(d_).location}function eY(t){We.useContext(PC).static||We.useLayoutEffect(t)}function GM(){let{isDataRoute:t}=We.useContext(Vg);return t?fle():ele()}function ele(){FC()||ms(!1);let t=We.useContext(zM),{basename:e,future:r,navigator:i}=We.useContext(PC),{matches:s}=We.useContext(Vg),{pathname:n}=MC(),o=JSON.stringify(qG(s,r.v7_relativeSplatPath)),l=We.useRef(!1);return eY(()=>{l.current=!0}),We.useCallback(function(d,g){if(g===void 0&&(g={}),!l.current)return;if(typeof d=="number"){i.go(d);return}let y=JG(d,JSON.parse(o),n,g.relative==="path");t==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:dg([e,y.pathname])),(g.replace?i.replace:i.push)(y,g.state,g)},[e,i,o,n,t])}function tle(t,e){return rle(t,e)}function rle(t,e,r,i){FC()||ms(!1);let{navigator:s}=We.useContext(PC),{matches:n}=We.useContext(Vg),o=n[n.length-1],l=o?o.params:{};o&&o.pathname;let h=o?o.pathnameBase:"/";o&&o.route;let d=MC(),g;if(e){var y;let R=typeof e=="string"?S1(e):e;h==="/"||(y=R.pathname)!=null&&y.startsWith(h)||ms(!1),g=R}else g=d;let C=g.pathname||"/",x=C;if(h!=="/"){let R=h.replace(/^\//,"").split("/");x="/"+C.replace(/^\//,"").split("/").slice(R.length).join("/")}let _=Iae(t,{pathname:x}),E=ale(_&&_.map(R=>Object.assign({},R,{params:Object.assign({},l,R.params),pathname:dg([h,s.encodeLocation?s.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?h:dg([h,s.encodeLocation?s.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),n,r,i);return e&&E?We.createElement(d_.Provider,{value:{location:Ky({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:rd.Pop}},E):E}function nle(){let t=hle(),e=Jae(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return We.createElement(We.Fragment,null,We.createElement("h2",null,"Unexpected Application Error!"),We.createElement("h3",{style:{fontStyle:"italic"}},e),r?We.createElement("pre",{style:s},r):null,null)}const ile=We.createElement(nle,null);class sle extends We.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?We.createElement(Vg.Provider,{value:this.props.routeContext},We.createElement(ZG.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ole(t){let{routeContext:e,match:r,children:i}=t,s=We.useContext(zM);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),We.createElement(Vg.Provider,{value:e},i)}function ale(t,e,r,i){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),i===void 0&&(i=null),t==null){var n;if(!r)return null;if(r.errors)t=r.matches;else if((n=i)!=null&&n.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let g=o.findIndex(y=>y.route.id&&(l==null?void 0:l[y.route.id])!==void 0);g>=0||ms(!1),o=o.slice(0,Math.min(o.length,g+1))}let h=!1,d=-1;if(r&&i&&i.v7_partialHydration)for(let g=0;g<o.length;g++){let y=o[g];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=g),y.route.id){let{loaderData:C,errors:x}=r,_=y.route.loader&&C[y.route.id]===void 0&&(!x||x[y.route.id]===void 0);if(y.route.lazy||_){h=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((g,y,C)=>{let x,_=!1,E=null,R=null;r&&(x=l&&y.route.id?l[y.route.id]:void 0,E=y.route.errorElement||ile,h&&(d<0&&C===0?(_=!0,R=null):d===C&&(_=!0,R=y.route.hydrateFallbackElement||null)));let I=e.concat(o.slice(0,C+1)),F=()=>{let D;return x?D=E:_?D=R:y.route.Component?D=We.createElement(y.route.Component,null):y.route.element?D=y.route.element:D=g,We.createElement(ole,{match:y,routeContext:{outlet:g,matches:I,isDataRoute:r!=null},children:D})};return r&&(y.route.ErrorBoundary||y.route.errorElement||C===0)?We.createElement(sle,{location:r.location,revalidation:r.revalidation,component:E,error:x,children:F(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):F()},null)}var tY=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(tY||{}),OE=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(OE||{});function lle(t){let e=We.useContext(zM);return e||ms(!1),e}function cle(t){let e=We.useContext(Zae);return e||ms(!1),e}function ule(t){let e=We.useContext(Vg);return e||ms(!1),e}function rY(t){let e=ule(),r=e.matches[e.matches.length-1];return r.route.id||ms(!1),r.route.id}function hle(){var t;let e=We.useContext(ZG),r=cle(OE.UseRouteError),i=rY(OE.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[i]}function fle(){let{router:t}=lle(tY.UseNavigateStable),e=rY(OE.UseNavigateStable),r=We.useRef(!1);return eY(()=>{r.current=!0}),We.useCallback(function(s,n){n===void 0&&(n={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ky({fromRouteId:e},n)))},[t,e])}const s$={};function dle(t,e){s$[e]||(s$[e]=!0,console.warn(e))}const o$=(t,e,r)=>dle(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function gle(t,e){(t==null?void 0:t.v7_startTransition)===void 0&&o$("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(t==null?void 0:t.v7_relativeSplatPath)===void 0&&!e&&o$("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function nY(t){let{to:e,replace:r,state:i,relative:s}=t;FC()||ms(!1);let{future:n,static:o}=We.useContext(PC),{matches:l}=We.useContext(Vg),{pathname:h}=MC(),d=GM(),g=JG(e,qG(l,n.v7_relativeSplatPath),h,s==="path"),y=JSON.stringify(g);return We.useEffect(()=>d(JSON.parse(y),{replace:r,state:i,relative:s}),[d,y,s,r,i]),null}function A2(t){ms(!1)}function mle(t){let{basename:e="/",children:r=null,location:i,navigationType:s=rd.Pop,navigator:n,static:o=!1,future:l}=t;FC()&&ms(!1);let h=e.replace(/^\/*/,"/"),d=We.useMemo(()=>({basename:h,navigator:n,static:o,future:Ky({v7_relativeSplatPath:!1},l)}),[h,l,n,o]);typeof i=="string"&&(i=S1(i));let{pathname:g="/",search:y="",hash:C="",state:x=null,key:_="default"}=i,E=We.useMemo(()=>{let R=XG(g,h);return R==null?null:{location:{pathname:R,search:y,hash:C,state:x,key:_},navigationType:s}},[h,g,y,C,x,_,s]);return E==null?null:We.createElement(PC.Provider,{value:d},We.createElement(d_.Provider,{children:r,value:E}))}function ple(t){let{children:e,location:r}=t;return tle(vP(e),r)}new Promise(()=>{});function vP(t,e){e===void 0&&(e=[]);let r=[];return We.Children.forEach(t,(i,s)=>{if(!We.isValidElement(i))return;let n=[...e,s];if(i.type===We.Fragment){r.push.apply(r,vP(i.props.children,n));return}i.type!==A2&&ms(!1),!i.props.index||!i.props.children||ms(!1);let o={id:i.props.id||n.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=vP(i.props.children,n)),r.push(o)}),r}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const vle="6";try{window.__reactRouterVersion=vle}catch{}const wle="startTransition",a$=vse[wle];function yle(t){let{basename:e,children:r,future:i,window:s}=t,n=We.useRef();n.current==null&&(n.current=Rae({window:s,v5Compat:!0}));let o=n.current,[l,h]=We.useState({action:o.action,location:o.location}),{v7_startTransition:d}=i||{},g=We.useCallback(y=>{d&&a$?a$(()=>h(y)):h(y)},[h,d]);return We.useLayoutEffect(()=>o.listen(g),[o,g]),We.useEffect(()=>gle(i),[i]),We.createElement(mle,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:i})}var l$;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(l$||(l$={}));var c$;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(c$||(c$={}));function iY(t){var e,r,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=iY(t[e]))&&(i&&(i+=" "),i+=r)}else for(r in t)t[r]&&(i&&(i+=" "),i+=r);return i}function gg(){for(var t,e,r=0,i="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=iY(t))&&(i&&(i+=" "),i+=e);return i}function Cle(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Cle(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var kC=t=>typeof t=="number"&&!isNaN(t),Eg=t=>typeof t=="string",Qh=t=>typeof t=="function",Sle=t=>Eg(t)||kC(t),wP=t=>Eg(t)||Qh(t)?t:null,ble=(t,e)=>t===!1||kC(t)&&t>0?t:e,yP=t=>We.isValidElement(t)||Eg(t)||Qh(t)||kC(t);function xle(t,e,r=300){let{scrollHeight:i,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=i+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,r)})})}function Ele({enter:t,exit:e,appendPosition:r=!1,collapse:i=!0,collapseDuration:s=300}){return function({children:n,position:o,preventExitTransition:l,done:h,nodeRef:d,isIn:g,playToast:y}){let C=r?`${t}--${o}`:t,x=r?`${e}--${o}`:e,_=We.useRef(0);return We.useLayoutEffect(()=>{let E=d.current,R=C.split(" "),I=F=>{F.target===d.current&&(y(),E.removeEventListener("animationend",I),E.removeEventListener("animationcancel",I),_.current===0&&F.type!=="animationcancel"&&E.classList.remove(...R))};E.classList.add(...R),E.addEventListener("animationend",I),E.addEventListener("animationcancel",I)},[]),We.useEffect(()=>{let E=d.current,R=()=>{E.removeEventListener("animationend",R),i?xle(E,h,s):h()};g||(l?R():(_.current=1,E.className+=` ${x}`,E.addEventListener("animationend",R)))},[g]),br.createElement(br.Fragment,null,n)}}function u$(t,e){return{content:sY(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function sY(t,e,r=!1){return We.isValidElement(t)&&!Eg(t.type)?We.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):Qh(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):t}function Tle({closeToast:t,theme:e,ariaLabel:r="close"}){return br.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:i=>{i.stopPropagation(),t(!0)},"aria-label":r},br.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},br.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function _le({delay:t,isRunning:e,closeToast:r,type:i="default",hide:s,className:n,controlledProgress:o,progress:l,rtl:h,isIn:d,theme:g}){let y=s||o&&l===0,C={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(C.transform=`scaleX(${l})`);let x=gg("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${g}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":h}),_=Qh(n)?n({rtl:h,type:i,defaultClassName:x}):gg(x,n),E={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return br.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":y},br.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${g} Toastify__progress-bar--${i}`}),br.createElement("div",{role:"progressbar","aria-hidden":y?"true":"false","aria-label":"notification timer",className:_,style:C,...E}))}var Rle=1,oY=()=>`${Rle++}`;function Ale(t,e,r){let i=1,s=0,n=[],o=[],l=e,h=new Map,d=new Set,g=F=>(d.add(F),()=>d.delete(F)),y=()=>{o=Array.from(h.values()),d.forEach(F=>F())},C=({containerId:F,toastId:D,updateId:U})=>{let X=F?F!==t:t!==1,te=h.has(D)&&U==null;return X||te},x=(F,D)=>{h.forEach(U=>{var X;(D==null||D===U.props.toastId)&&((X=U.toggle)==null||X.call(U,F))})},_=F=>{var D,U;(U=(D=F.props)==null?void 0:D.onClose)==null||U.call(D,F.removalReason),F.isActive=!1},E=F=>{if(F==null)h.forEach(_);else{let D=h.get(F);D&&_(D)}y()},R=()=>{s-=n.length,n=[]},I=F=>{var D,U;let{toastId:X,updateId:te}=F.props,Y=te==null;F.staleId&&h.delete(F.staleId),F.isActive=!0,h.set(X,F),y(),r(u$(F,Y?"added":"updated")),Y&&((U=(D=F.props).onOpen)==null||U.call(D))};return{id:t,props:l,observe:g,toggle:x,removeToast:E,toasts:h,clearQueue:R,buildToast:(F,D)=>{if(C(D))return;let{toastId:U,updateId:X,data:te,staleId:Y,delay:oe}=D,me=X==null;me&&s++;let de={...l,style:l.toastStyle,key:i++,...Object.fromEntries(Object.entries(D).filter(([Ee,ke])=>ke!=null)),toastId:U,updateId:X,data:te,isIn:!1,className:wP(D.className||l.toastClassName),progressClassName:wP(D.progressClassName||l.progressClassName),autoClose:D.isLoading?!1:ble(D.autoClose,l.autoClose),closeToast(Ee){h.get(U).removalReason=Ee,E(U)},deleteToast(){let Ee=h.get(U);if(Ee!=null){if(r(u$(Ee,"removed")),h.delete(U),s--,s<0&&(s=0),n.length>0){I(n.shift());return}y()}}};de.closeButton=l.closeButton,D.closeButton===!1||yP(D.closeButton)?de.closeButton=D.closeButton:D.closeButton===!0&&(de.closeButton=yP(l.closeButton)?l.closeButton:!0);let ye={content:F,props:de,staleId:Y};l.limit&&l.limit>0&&s>l.limit&&me?n.push(ye):kC(oe)?setTimeout(()=>{I(ye)},oe):I(ye)},setProps(F){l=F},setToggle:(F,D)=>{let U=h.get(F);U&&(U.toggle=D)},isToastActive:F=>{var D;return(D=h.get(F))==null?void 0:D.isActive},getSnapshot:()=>o}}var ta=new Map,Xy=[],CP=new Set,Ole=t=>CP.forEach(e=>e(t)),aY=()=>ta.size>0;function Ile(){Xy.forEach(t=>cY(t.content,t.options)),Xy=[]}var Ple=(t,{containerId:e})=>{var r;return(r=ta.get(e||1))==null?void 0:r.toasts.get(t)};function lY(t,e){var r;if(e)return!!((r=ta.get(e))!=null&&r.isToastActive(t));let i=!1;return ta.forEach(s=>{s.isToastActive(t)&&(i=!0)}),i}function Fle(t){if(!aY()){Xy=Xy.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||Sle(t))ta.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=ta.get(t.containerId);e?e.removeToast(t.id):ta.forEach(r=>{r.removeToast(t.id)})}}var Mle=(t={})=>{ta.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function cY(t,e){yP(t)&&(aY()||Xy.push({content:t,options:e}),ta.forEach(r=>{r.buildToast(t,e)}))}function kle(t){var e;(e=ta.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function uY(t,e){ta.forEach(r=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===r.id)&&r.toggle(t,e==null?void 0:e.id)})}function Nle(t){let e=t.containerId||1;return{subscribe(r){let i=Ale(e,t,Ole);ta.set(e,i);let s=i.observe(r);return Ile(),()=>{s(),ta.delete(e)}},setProps(r){var i;(i=ta.get(e))==null||i.setProps(r)},getSnapshot(){var r;return(r=ta.get(e))==null?void 0:r.getSnapshot()}}}function Dle(t){return CP.add(t),()=>{CP.delete(t)}}function Lle(t){return t&&(Eg(t.toastId)||kC(t.toastId))?t.toastId:oY()}function NC(t,e){return cY(t,e),e.toastId}function g_(t,e){return{...e,type:e&&e.type||t,toastId:Lle(e)}}function m_(t){return(e,r)=>NC(e,g_(t,r))}function zt(t,e){return NC(t,g_("default",e))}zt.loading=(t,e)=>NC(t,g_("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function Hle(t,{pending:e,error:r,success:i},s){let n;e&&(n=Eg(e)?zt.loading(e,s):zt.loading(e.render,{...s,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,g,y)=>{if(g==null){zt.dismiss(n);return}let C={type:d,...o,...s,data:y},x=Eg(g)?{render:g}:g;return n?zt.update(n,{...C,...x}):zt(x.render,{...C,...x}),y},h=Qh(t)?t():t;return h.then(d=>l("success",i,d)).catch(d=>l("error",r,d)),h}zt.promise=Hle;zt.success=m_("success");zt.info=m_("info");zt.error=m_("error");zt.warning=m_("warning");zt.warn=zt.warning;zt.dark=(t,e)=>NC(t,g_("default",{theme:"dark",...e}));function $le(t){Fle(t)}zt.dismiss=$le;zt.clearWaitingQueue=Mle;zt.isActive=lY;zt.update=(t,e={})=>{let r=Ple(t,e);if(r){let{props:i,content:s}=r,n={delay:100,...i,...e,toastId:e.toastId||t,updateId:oY()};n.toastId!==t&&(n.staleId=t);let o=n.render||s;delete n.render,NC(o,n)}};zt.done=t=>{zt.update(t,{progress:1})};zt.onChange=Dle;zt.play=t=>uY(!0,t);zt.pause=t=>uY(!1,t);function Ble(t){var e;let{subscribe:r,getSnapshot:i,setProps:s}=We.useRef(Nle(t)).current;s(t);let n=(e=We.useSyncExternalStore(r,i,i))==null?void 0:e.slice();function o(l){if(!n)return[];let h=new Map;return t.newestOnTop&&n.reverse(),n.forEach(d=>{let{position:g}=d.props;h.has(g)||h.set(g,[]),h.get(g).push(d)}),Array.from(h,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:lY,count:n==null?void 0:n.length}}function Vle(t){let[e,r]=We.useState(!1),[i,s]=We.useState(!1),n=We.useRef(null),o=We.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:h,closeToast:d,onClick:g,closeOnClick:y}=t;kle({id:t.toastId,containerId:t.containerId,fn:r}),We.useEffect(()=>{if(t.pauseOnFocusLoss)return C(),()=>{x()}},[t.pauseOnFocusLoss]);function C(){document.hasFocus()||I(),window.addEventListener("focus",R),window.addEventListener("blur",I)}function x(){window.removeEventListener("focus",R),window.removeEventListener("blur",I)}function _(Y){if(t.draggable===!0||t.draggable===Y.pointerType){F();let oe=n.current;o.canCloseOnClick=!0,o.canDrag=!0,oe.style.transition="none",t.draggableDirection==="x"?(o.start=Y.clientX,o.removalDistance=oe.offsetWidth*(t.draggablePercent/100)):(o.start=Y.clientY,o.removalDistance=oe.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function E(Y){let{top:oe,bottom:me,left:de,right:ye}=n.current.getBoundingClientRect();Y.nativeEvent.type!=="touchend"&&t.pauseOnHover&&Y.clientX>=de&&Y.clientX<=ye&&Y.clientY>=oe&&Y.clientY<=me?I():R()}function R(){r(!0)}function I(){r(!1)}function F(){o.didMove=!1,document.addEventListener("pointermove",U),document.addEventListener("pointerup",X)}function D(){document.removeEventListener("pointermove",U),document.removeEventListener("pointerup",X)}function U(Y){let oe=n.current;if(o.canDrag&&oe){o.didMove=!0,e&&I(),t.draggableDirection==="x"?o.delta=Y.clientX-o.start:o.delta=Y.clientY-o.start,o.start!==Y.clientX&&(o.canCloseOnClick=!1);let me=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;oe.style.transform=`translate3d(${me},0)`,oe.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function X(){D();let Y=n.current;if(o.canDrag&&o.didMove&&Y){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){s(!0),t.closeToast(!0),t.collapseAll();return}Y.style.transition="transform 0.2s, opacity 0.2s",Y.style.removeProperty("transform"),Y.style.removeProperty("opacity")}}let te={onPointerDown:_,onPointerUp:E};return l&&h&&(te.onMouseEnter=I,t.stacked||(te.onMouseLeave=R)),y&&(te.onClick=Y=>{g&&g(Y),o.canCloseOnClick&&d(!0)}),{playToast:R,pauseToast:I,isRunning:e,preventExitTransition:i,toastRef:n,eventHandlers:te}}var Wle=typeof window<"u"?We.useLayoutEffect:We.useEffect,p_=({theme:t,type:e,isLoading:r,...i})=>br.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...i});function jle(t){return br.createElement(p_,{...t},br.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function Ule(t){return br.createElement(p_,{...t},br.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function zle(t){return br.createElement(p_,{...t},br.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Gle(t){return br.createElement(p_,{...t},br.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Yle(){return br.createElement("div",{className:"Toastify__spinner"})}var SP={info:Ule,warning:jle,success:zle,error:Gle,spinner:Yle},Kle=t=>t in SP;function Xle({theme:t,type:e,isLoading:r,icon:i}){let s=null,n={theme:t,type:e};return i===!1||(Qh(i)?s=i({...n,isLoading:r}):We.isValidElement(i)?s=We.cloneElement(i,n):r?s=SP.spinner():Kle(e)&&(s=SP[e](n))),s}var qle=t=>{let{isRunning:e,preventExitTransition:r,toastRef:i,eventHandlers:s,playToast:n}=Vle(t),{closeButton:o,children:l,autoClose:h,onClick:d,type:g,hideProgressBar:y,closeToast:C,transition:x,position:_,className:E,style:R,progressClassName:I,updateId:F,role:D,progress:U,rtl:X,toastId:te,deleteToast:Y,isIn:oe,isLoading:me,closeOnClick:de,theme:ye,ariaLabel:Ee}=t,ke=gg("Toastify__toast",`Toastify__toast-theme--${ye}`,`Toastify__toast--${g}`,{"Toastify__toast--rtl":X},{"Toastify__toast--close-on-click":de}),nt=Qh(E)?E({rtl:X,position:_,type:g,defaultClassName:ke}):gg(ke,E),at=Xle(t),Ze=!!U||!h,Xe={closeToast:C,type:g,theme:ye},Pe=null;return o===!1||(Qh(o)?Pe=o(Xe):We.isValidElement(o)?Pe=We.cloneElement(o,Xe):Pe=Tle(Xe)),br.createElement(x,{isIn:oe,done:Y,position:_,preventExitTransition:r,nodeRef:i,playToast:n},br.createElement("div",{id:te,tabIndex:0,onClick:d,"data-in":oe,className:nt,...s,style:R,ref:i,...oe&&{role:D,"aria-label":Ee}},at!=null&&br.createElement("div",{className:gg("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!me})},at),sY(l,t,!e),Pe,!t.customProgressBar&&br.createElement(_le,{...F&&!Ze?{key:`p-${F}`}:{},rtl:X,theme:ye,delay:h,isRunning:e,isIn:oe,closeToast:C,hide:y,type:g,className:I,controlledProgress:Ze,progress:U||0})))},Jle=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),Qle=Ele(Jle("bounce",!0)),Zle={position:"top-right",transition:Qle,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function hY(t){let e={...Zle,...t},r=t.stacked,[i,s]=We.useState(!0),n=We.useRef(null),{getToastToRender:o,isToastActive:l,count:h}=Ble(e),{className:d,style:g,rtl:y,containerId:C,hotKeys:x}=e;function _(R){let I=gg("Toastify__toast-container",`Toastify__toast-container--${R}`,{"Toastify__toast-container--rtl":y});return Qh(d)?d({position:R,rtl:y,defaultClassName:I}):gg(I,wP(d))}function E(){r&&(s(!0),zt.play())}return Wle(()=>{var R;if(r){let I=n.current.querySelectorAll('[data-in="true"]'),F=12,D=(R=e.position)==null?void 0:R.includes("top"),U=0,X=0;Array.from(I).reverse().forEach((te,Y)=>{let oe=te;oe.classList.add("Toastify__toast--stacked"),Y>0&&(oe.dataset.collapsed=`${i}`),oe.dataset.pos||(oe.dataset.pos=D?"top":"bot");let me=U*(i?.2:1)+(i?0:F*Y);oe.style.setProperty("--y",`${D?me:me*-1}px`),oe.style.setProperty("--g",`${F}`),oe.style.setProperty("--s",`${1-(i?X:0)}`),U+=oe.offsetHeight,X+=.025})}},[i,h,r]),We.useEffect(()=>{function R(I){var F;let D=n.current;x(I)&&((F=D.querySelector('[tabIndex="0"]'))==null||F.focus(),s(!1),zt.pause()),I.key==="Escape"&&(document.activeElement===D||D!=null&&D.contains(document.activeElement))&&(s(!0),zt.play())}return document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}},[x]),br.createElement("section",{ref:n,className:"Toastify",id:C,onMouseEnter:()=>{r&&(s(!1),zt.pause())},onMouseLeave:E,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((R,I)=>{let F=I.length?{...g}:{...g,pointerEvents:"none"};return br.createElement("div",{tabIndex:-1,className:_(R),"data-stacked":r,style:F,key:`c-${R}`},I.map(({content:D,props:U})=>br.createElement(qle,{...U,stacked:r,collapseAll:E,isIn:l(U.toastId,U.containerId),key:`t-${U.key}`},D)))}))}var fY={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},h$=br.createContext&&br.createContext(fY),ece=["attr","size","title"];function tce(t,e){if(t==null)return{};var r=rce(t,e),i,s;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function rce(t,e){if(t==null)return{};var r={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;r[i]=t[i]}return r}function IE(){return IE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},IE.apply(this,arguments)}function f$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function PE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?f$(Object(r),!0).forEach(function(i){nce(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f$(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function nce(t,e,r){return e=ice(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ice(t){var e=sce(t,"string");return typeof e=="symbol"?e:e+""}function sce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dY(t){return t&&t.map((e,r)=>br.createElement(e.tag,PE({key:r},e.attr),dY(e.child)))}function YM(t){return e=>br.createElement(oce,IE({attr:PE({},t.attr)},e),dY(t.child))}function oce(t){var e=r=>{var{attr:i,size:s,title:n}=t,o=tce(t,ece),l=s||r.size||"1em",h;return r.className&&(h=r.className),t.className&&(h=(h?h+" ":"")+t.className),br.createElement("svg",IE({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,o,{className:h,style:PE(PE({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),n&&br.createElement("title",null,n),t.children)};return h$!==void 0?br.createElement(h$.Consumer,null,r=>e(r)):e(fY)}function d$(t){return YM({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function ace(t){return YM({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function lce(t){return YM({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}const cce=({onSearch:t})=>{const[e,r]=We.useState(""),[i,s]=We.useState([]),[n,o]=We.useState(!1),[l,h]=We.useState(!1),[d,g]=We.useState(null),[y,C]=We.useState(!1),x=We.useRef(null),[_,E]=We.useState("");We.useEffect(()=>{const D=U=>{x.current&&!x.current.contains(U.target)&&h(!1)};return document.addEventListener("mousedown",D),()=>document.removeEventListener("mousedown",D)},[]),We.useEffect(()=>{const D=localStorage.getItem("userRole");console.log("Current user role:",D),E(D||"")},[]);const R=async D=>{if(!D.trim()){s([]);return}try{o(!0);const X=await(await fetch(`https://backend-giahung.onrender.com/api/products/search?q=${encodeURIComponent(D)}`)).json();X.status==="success"&&s(X.data||[])}catch(U){console.error("Error fetching suggestions:",U)}finally{o(!1)}};We.useEffect(()=>{const D=setTimeout(()=>{e&&R(e)},300);return()=>clearTimeout(D)},[e]);const I=D=>{r(D.name),h(!1),g(D),C(!0),t(D)},F=D=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(D);return console.log("User role in render:",_),console.log("Selected product:",d),V.jsxs("div",{className:"relative w-full",ref:x,children:[V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"text",placeholder:"Tm kim...",value:e,onChange:D=>{r(D.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full px-3 py-1.5 pl-8 pr-3 text-sm text-gray-700 bg-white border border-gray-300 rounded-md focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-200"}),V.jsx(lce,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3"})]}),l&&e&&V.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto",children:n?V.jsx("div",{className:"p-2 text-center text-gray-500",children:V.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}):i.length>0?V.jsx("ul",{className:"py-1",children:i.map(D=>V.jsx("li",{className:"px-3 py-1.5 hover:bg-gray-50 cursor-pointer text-sm",onClick:()=>I(D),children:V.jsxs("div",{className:"flex items-center space-x-2",children:[D.image?V.jsx("img",{src:D.image,alt:D.name,className:"w-8 h-8 object-cover rounded",onError:U=>{U.target.onerror=null,U.target.src="/placeholder.png"}}):V.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-500",children:"No IMG"}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsx("div",{className:"font-medium text-gray-900 truncate",children:D.name}),V.jsx("div",{className:"text-xs text-gray-500",children:F(D.price)})]})]})},D._id))}):V.jsx("div",{className:"p-2 text-center text-sm text-gray-500",children:"Khng tm thy sn phm"})}),y&&d&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",children:[V.jsxs("div",{className:"flex justify-between items-start mb-4",children:[V.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Chi tit sn phm"}),V.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-500",children:V.jsx("span",{className:"text-2xl",children:""})})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[V.jsx("div",{className:"aspect-w-1 aspect-h-1",children:d.image?V.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover rounded-lg"}):V.jsx("div",{className:"w-full h-full bg-gray-100 rounded-lg flex items-center justify-center",children:V.jsx("span",{className:"text-gray-500",children:"Khng c hnh nh"})})}),V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("h4",{className:"text-lg font-medium text-gray-900",children:d.name}),V.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:F(d.price)})]}),V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"M t"}),V.jsx("p",{className:"mt-1 text-gray-600",children:d.description||"Khng c m t"})]}),V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"Danh mc"}),V.jsx("p",{className:"mt-1 text-gray-600",children:d.category||"Cha phn loi"})]}),_==="admin"&&V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"Gi nhp"}),V.jsx("p",{className:"mt-1 text-gray-600",children:F(d.import_price)})]}),V.jsxs("div",{className:"text-xs text-gray-400",children:["Role: ",_]})]})]})]})})]})},uce=[{value:"Ci",label:"Ci"},{value:"Hp",label:"Hp"},{value:"Kg",label:"Kg"},{value:"Cp",label:"Cp"},{value:"Cy",label:"Cy"},{value:"Con",label:"Con"}],hce=()=>{const[t,e]=We.useState([]),[r,i]=We.useState(!1),[s,n]=We.useState(""),[o,l]=We.useState(!1),[h,d]=We.useState([]),[g,y]=We.useState({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]}),[C,x]=We.useState({_id:"",name:"",description:"",import_price:"",price:"",category:"",unit:"Ci",image:null,imagePreview:null}),[_,E]=We.useState(!1),[R,I]=We.useState(!1),[F,D]=We.useState(""),[U,X]=We.useState(null),[te,Y]=We.useState([]),[oe,me]=We.useState(!1),[de,ye]=We.useState([]),[Ee,ke]=We.useState(1),[nt]=We.useState(10),[at,Ze]=We.useState(0),[Xe,Pe]=We.useState(null),[Be,Me]=We.useState(""),[A,O]=We.useState("duplicates"),[N,H]=We.useState([]),[B,K]=We.useState("");We.useState([]);const[Z,we]=We.useState(!1);We.useEffect(()=>{(()=>{const ot=localStorage.getItem("userRole");console.log("=== User Role Check on Mount ==="),console.log("Current Role:",ot),console.log("============================"),n(ot||"")})(),Ce(),z()},[]);const Ce=async()=>{try{i(!0);const et=localStorage.getItem("token"),ft=await(await fetch(`https://backend-giahung.onrender.com/api/products?page=${Ee}&limit=${nt}`,{headers:{Authorization:`Bearer ${et}`}})).json();ft.status==="success"&&(e(ft.data),Ze(ft.total))}catch(et){console.error("Error fetching products:",et),zt.error("Khng th ti danh sch sn phm")}finally{i(!1)}};We.useEffect(()=>{Ce()},[Ee]);const z=async()=>{try{const et=localStorage.getItem("token"),ft=await(await fetch("https://backend-giahung.onrender.com/api/categories",{headers:{Authorization:`Bearer ${et}`}})).json();ft.status==="success"&&d(ft.data)}catch(et){console.error("Error fetching categories:",et),zt.error("Khng th ti danh mc")}},q=et=>{const{name:ot,value:ft}=et.target;y(Nt=>({...Nt,[ot]:ft}))},re=async et=>{et.preventDefault();try{console.log("=== Submitting Form ==="),console.log("Product Data:",g);const ot=new FormData;if(!g.name||!g.price){zt.error("Vui lng in y  tn sn phm v gi bn");return}ot.append("name",g.name),ot.append("price",g.price),g.import_price&&ot.append("import_price",g.import_price),g.description&&ot.append("description",g.description),g.category&&ot.append("category",g.category),g.image instanceof File&&(ot.append("image",g.image),console.log("=== Image File Info ==="),console.log("File name:",g.image.name),console.log("File size:",g.image.size),console.log("File type:",g.image.type)),console.log("=== FormData Contents ===");for(let cr of ot.entries())console.log(cr[0]+":",cr[1]);const ft=localStorage.getItem("token"),Nt=await fetch("https://backend-giahung.onrender.com/api/products",{method:"POST",headers:{Authorization:`Bearer ${ft}`},body:ot});if(console.log("=== Response Status ==="),console.log("Status:",Nt.status),!Nt.ok){const cr=await Nt.json();throw new Error(cr.message||"C li xy ra khi thm sn phm")}const vr=await Nt.json();if(vr.status==="success")zt.success("Thm sn phm thnh cng"),l(!1),Pe(null),Me(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]}),Ce();else throw new Error(vr.message||"Li khi thm sn phm")}catch(ot){console.error("Error:",ot),zt.error(ot.message||"Khng th thm sn phm")}},ve=async et=>{if(window.confirm("Bn c chc chn mun xa sn phm ny?"))try{const ot=localStorage.getItem("token"),ft=await fetch(`https://backend-giahung.onrender.com/api/products/${et}`,{method:"DELETE",headers:{Authorization:`Bearer ${ot}`,"Content-Type":"application/json"}});if(ft.ok)zt.success("Xa sn phm thnh cng"),Ce();else{const Nt=await ft.json();throw new Error(Nt.message||"Khng th xa sn phm")}}catch(ot){console.error("Error deleting product:",ot),zt.error(ot.message||"C li xy ra khi xa sn phm")}},ce=et=>{var ot,ft,Nt;x({_id:et._id,name:et.name,description:et.description||"",import_price:et.import_price||"",price:et.price||"",category:((ot=et.category)==null?void 0:ot._id)||"",unit:et.unit||"Ci",image:et.image||null,imagePreview:((ft=et.image)==null?void 0:ft.url)||null}),Me((Nt=et.image)!=null&&Nt.url?"Current image":""),E(!0)},Re=async et=>{et.preventDefault();try{const ot=new FormData;ot.append("name",C.name||""),ot.append("price",C.price||""),ot.append("import_price",C.import_price||""),ot.append("description",C.description||""),ot.append("category",C.category||""),ot.append("unit",C.unit),ot.append("image",C.image||""),console.log("Sending update with unit:",C.unit);const ft=document.querySelector('input[type="file"]').files[0];ft&&ot.append("image",ft),console.log("=== Update Data ===");for(let Tr of ot.entries())console.log(Tr[0]+": "+Tr[1]);const Nt=localStorage.getItem("token"),vr=await fetch(`https://backend-giahung.onrender.com/api/products/${C._id}`,{method:"PUT",headers:{Authorization:`Bearer ${Nt}`},body:ot});if(!vr.ok)throw new Error("Li khi cp nht sn phm");const cr=await vr.json();if(cr.status==="success")zt.success("Cp nht sn phm thnh cng"),E(!1),Ce();else throw new Error(cr.message||"Li khi cp nht sn phm")}catch(ot){console.error("Update Error:",ot),zt.error("Khng th cp nht sn phm: "+ot.message)}},Oe=async()=>{if(de.length)try{we(!0);const et=localStorage.getItem("token"),ft=await(await fetch("https://backend-giahung.onrender.com/api/products/bulk",{method:"POST",headers:{Authorization:`Bearer ${et}`,"Content-Type":"application/json"},body:JSON.stringify({products:de})})).json();if(ft.status==="success")zt.success(` import ${de.length} sn phm thnh cng`),I(!1),X(null),ye([]),Y([]),Ce();else throw new Error(ft.message||"Li khi import sn phm")}catch(et){console.error("Import Error:",et),zt.error("Khng th import sn phm: "+et.message)}finally{we(!1)}},he=async()=>{try{const et=localStorage.getItem("token"),ot=await fetch("https://backend-giahung.onrender.com/api/products?limit=9999",{headers:{Authorization:`Bearer ${et}`}});if(!ot.ok)throw new Error("Khng th xut d liu");const ft=await ot.json();if(ft.status==="success"){const Nt=ft.data,vr=JSON.stringify(Nt,null,2),cr=new Blob([vr],{type:"application/json"}),Tr=window.URL.createObjectURL(cr),li=document.createElement("a");li.href=Tr,li.download=`products_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(li),li.click(),window.URL.revokeObjectURL(Tr),document.body.removeChild(li),zt.success(` xut ${Nt.length} sn phm thnh cng`),I(!1)}else throw new Error(ft.message||"Li khi xut d liu")}catch(et){console.error("Export Error:",et),zt.error("Khng th xut d liu: "+et.message)}},Ie=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-5xl w-full",children:[V.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Kim tra sn phm import"}),V.jsxs("div",{className:"flex border-b mb-4",children:[V.jsxs("button",{className:`py-2 px-4 mr-2 ${A==="duplicates"?"border-b-2 border-blue-500 text-blue-600 font-medium":"text-gray-500 hover:text-gray-700"}`,onClick:()=>O("duplicates"),children:["Sn phm trng lp (",te.length,")"]}),V.jsxs("button",{className:`py-2 px-4 ${A==="new"?"border-b-2 border-blue-500 text-blue-600 font-medium":"text-gray-500 hover:text-gray-700"}`,onClick:()=>O("new"),children:["Sn phm mi (",de.length,")"]})]}),V.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"n v"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A==="duplicates"?te.map((et,ot)=>{var ft,Nt;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:et.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(ft=et.import_price)==null?void 0:ft.toLocaleString("vi-VN")," "]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(Nt=et.price)==null?void 0:Nt.toLocaleString("vi-VN")," "]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:et.unit||"Ci"})]},ot)}):de.map((et,ot)=>{var ft,Nt;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:et.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(ft=et.import_price)==null?void 0:ft.toLocaleString("vi-VN")," "]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(Nt=et.price)==null?void 0:Nt.toLocaleString("vi-VN")," "]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:et.unit||"Ci"})]},ot)})})]})}),V.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[V.jsx("button",{onClick:()=>me(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 border rounded",children:"Hy"}),V.jsxs("button",{onClick:()=>importProducts(de),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:["Import ",de.length," sn phm mi"]})]})]})}),De=et=>{et<1||et>Math.ceil(at/nt)||(ke(et),console.log("=== Page Change ==="),console.log("Current Page:",et),console.log("Total Products:",at),console.log("Products Per Page:",nt))},$e=()=>{const et=Math.ceil(at/nt),ot=()=>{let ft=[];if(et<=7)for(let Nt=1;Nt<=et;Nt++)ft.push(Nt);else{ft.push(1),Ee>3&&ft.push("...");let Nt=Math.max(2,Ee-1),vr=Math.min(Ee+1,et-1);for(let cr=Nt;cr<=vr;cr++)ft.push(cr);Ee<et-2&&ft.push("..."),et>1&&ft.push(et)}return ft};return V.jsxs("div",{className:"flex justify-between items-center mt-4 pb-4",children:[V.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",Math.min((Ee-1)*nt+1,at)," n"," ",Math.min(Ee*nt,at)," trong s"," ",at," sn phm"]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("button",{onClick:()=>De(Ee-1),disabled:Ee===1,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Trc"}),ot().map((ft,Nt)=>V.jsx("button",{onClick:()=>{ft!=="..."&&De(ft)},disabled:ft==="...",className:`px-3 py-1 border rounded-md ${ft===Ee?"bg-blue-500 text-white":ft==="..."?"cursor-default":"hover:bg-gray-100"}`,children:ft},Nt)),V.jsx("button",{onClick:()=>De(Ee+1),disabled:Ee===et,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sau"})]})]})};We.useEffect(()=>()=>{C.imagePreview&&C.imagePreview.startsWith("blob:")&&URL.revokeObjectURL(C.imagePreview)},[C.imagePreview]);const qe=et=>{const ot=et.target.files[0];if(ot){const ft=new FileReader;ft.onloadend=()=>{x(Nt=>({...Nt,image:ot,imagePreview:ft.result}))},ft.readAsDataURL(ot),Me(ot.name)}},Ft=()=>{x(et=>({...et,image:null,imagePreview:null})),Me("")},bt=()=>{var et;return V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[V.jsx("h3",{className:"text-xl font-semibold mb-4 sticky top-0 bg-white pb-2",children:"Chnh sa sn phm"}),V.jsxs("form",{onSubmit:Re,encType:"multipart/form-data",children:[V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn sn phm"}),V.jsx("input",{type:"text",name:"name",value:C.name||"",onChange:ot=>{const ft=ot.target.value;x(Nt=>({...Nt,name:ft}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:C.description||"",onChange:ot=>{const ft=ot.target.value;x(Nt=>({...Nt,description:ft}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",rows:"3"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"n v"}),V.jsx("select",{name:"unit",value:C.unit||"Ci",onChange:ot=>{const ft=ot.target.value;x(Nt=>({...Nt,unit:ft}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:uce.map(ot=>V.jsx("option",{value:ot.value,children:ot.label},ot.value))})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gi nhp"}),V.jsx("input",{type:"number",name:"import_price",value:C.import_price||"",onChange:ot=>{const ft=ot.target.value;x(Nt=>({...Nt,import_price:ft}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gi bn"}),V.jsx("input",{type:"number",name:"price",value:C.price||"",onChange:ot=>{const ft=ot.target.value;x(Nt=>({...Nt,price:ft}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hnh nh sn phm"}),V.jsxs("div",{className:"mt-1 flex items-center",children:[V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"file",onChange:qe,className:"hidden",id:"edit-image-upload",accept:"image/*"}),V.jsx("label",{htmlFor:"edit-image-upload",className:"cursor-pointer bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Chn hnh nh"})]}),Be&&V.jsx("span",{className:"ml-3 text-sm text-gray-500",children:Be})]}),(C.imagePreview||((et=C.image)==null?void 0:et.url))&&V.jsxs("div",{className:"mt-2 relative",children:[V.jsx("img",{src:C.imagePreview||C.image.url,alt:"Preview",className:"max-h-64 w-auto object-contain rounded-md"}),V.jsx("button",{type:"button",onClick:Ft,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),V.jsxs("div",{className:"mt-6 flex justify-end sticky bottom-0 bg-white pt-2",children:[V.jsx("button",{type:"button",onClick:()=>E(!1),className:"mr-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:"Lu thay i"})]})]})]})})},Gt=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:V.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[V.jsx("div",{className:"sticky top-0 bg-white px-6 py-4 border-b",children:V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("h3",{className:"text-xl font-semibold",children:"Thm sn phm mi"}),V.jsx("button",{type:"button",onClick:()=>{l(!1),Pe(null),Me(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]})},className:"text-gray-400 hover:text-gray-500",children:V.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),V.jsx("div",{className:"px-6 py-4",children:V.jsxs("form",{onSubmit:re,encType:"multipart/form-data",className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn sn phm *"}),V.jsx("input",{type:"text",name:"name",value:g.name,onChange:q,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi nhp"}),V.jsx("input",{type:"number",name:"import_price",value:g.import_price,onChange:q,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi bn *"}),V.jsx("input",{type:"number",name:"price",value:g.price,onChange:q,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),V.jsx("textarea",{name:"description",value:g.description,onChange:q,rows:"3",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Danh mc"}),V.jsxs("select",{name:"category",value:g.category,onChange:q,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[V.jsx("option",{value:"",children:"Chn danh mc"}),h.map(et=>V.jsx("option",{value:et._id,children:et.name},et._id))]})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh nh"}),V.jsxs("div",{className:"flex flex-col space-y-2",children:[V.jsx("input",{type:"file",accept:"image/*",onChange:et=>{const ot=et.target.files[0];if(ot){if(ot.size>5*1024*1024){zt.error("Kch thc file khng c vt qu 5MB"),et.target.value="",Pe(null),Me("");return}Me(ot.name);const ft=new FileReader;ft.onloadend=()=>{Pe(ft.result)},ft.readAsDataURL(ot),y(Nt=>({...Nt,image:ot}))}},className:"w-full"}),Be&&V.jsxs("div",{className:"text-sm text-gray-600",children:["File  chn: ",Be]}),Xe&&V.jsxs("div",{className:"relative inline-block",children:[V.jsx("img",{src:Xe,alt:"Preview",className:"h-32 w-32 object-cover rounded-lg border"}),V.jsx("button",{type:"button",onClick:()=>{Pe(null),Me(""),y(ot=>({...ot,image:null}));const et=document.querySelector('input[type="file"]');et&&(et.value="")},className:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:V.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),V.jsx("div",{className:"sticky bottom-0 bg-white pt-4 pb-4 border-t mt-4",children:V.jsxs("div",{className:"flex justify-end space-x-2",children:[V.jsx("button",{type:"button",onClick:()=>{l(!1),Pe(null),Me(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]})},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Thm sn phm"})]})})]})})]})}),Lr=et=>{H(ot=>ot.includes(et)?ot.filter(ft=>ft!==et):[...ot,et])},Or=et=>{et.target.checked?H(t.map(ot=>ot._id)):H([])},sr=async()=>{if(window.confirm(`Bn c chc chn mun xa ${N.length} sn phm  chn?`))try{const et=localStorage.getItem("token"),ot=N.map(ft=>fetch(`https://backend-giahung.onrender.com/api/products/${ft}`,{method:"DELETE",headers:{Authorization:`Bearer ${et}`,"Content-Type":"application/json"}}));await Promise.all(ot),zt.success(` xa ${N.length} sn phm`),H([]),Ce()}catch(et){console.error("Error deleting products:",et),zt.error("C li xy ra khi xa sn phm")}},er=()=>B.trim()?t.filter(et=>{var ft,Nt,vr,cr,Tr,li,ho;const ot=B.toLowerCase();return((ft=et.name)==null?void 0:ft.toLowerCase().includes(ot))||((Nt=et.description)==null?void 0:Nt.toLowerCase().includes(ot))||((vr=et.unit)==null?void 0:vr.toLowerCase().includes(ot))||((Tr=(cr=et.category)==null?void 0:cr.name)==null?void 0:Tr.toLowerCase().includes(ot))||((li=et.price)==null?void 0:li.toString().includes(B))||((ho=et.import_price)==null?void 0:ho.toString().includes(B))}):t,Hn=()=>F==="export"?V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[V.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Export JSON"}),V.jsx("div",{className:"mb-6",children:V.jsxs("p",{className:"text-gray-600",children:["Bn c mun xut ",at," sn phm ra file JSON khng?"]})}),V.jsxs("div",{className:"flex justify-end space-x-3",children:[V.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Hy"}),V.jsx("button",{onClick:()=>{he(),I(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Xut file"})]})]})}):V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-4xl",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold",children:"Import JSON"}),V.jsx("button",{onClick:()=>I(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),U?V.jsxs("div",{className:"max-h-[80vh] flex flex-col",children:[V.jsx("div",{className:"border-b border-gray-200",children:V.jsxs("nav",{className:"flex space-x-4","aria-label":"Tabs",children:[V.jsxs("button",{onClick:()=>O("new"),className:`px-3 py-2 text-sm font-medium ${A==="new"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Sn phm mi (",de.length,")"]}),V.jsxs("button",{onClick:()=>O("duplicates"),className:`px-3 py-2 text-sm font-medium ${A==="duplicates"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Sn phm trng (",te.length,")"]})]})}),V.jsx("div",{className:"flex-1 overflow-hidden",children:V.jsx("div",{className:"overflow-y-auto h-full",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"n v"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(A==="new"?de:te).map((et,ot)=>{var ft,Nt;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(ft=et.import_price)==null?void 0:ft.toLocaleString("vi-VN")," VN"]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(Nt=et.price)==null?void 0:Nt.toLocaleString("vi-VN")," VN"]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:et.unit})]},ot)})})]})})}),V.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 bg-white",children:V.jsxs("div",{className:"flex justify-between items-center",children:[V.jsx("div",{className:"text-sm text-gray-500",children:A==="new"?`${de.length} sn phm mi`:`${te.length} sn phm trng`}),V.jsxs("div",{className:"flex space-x-3",children:[V.jsx("button",{onClick:()=>{X(null),ye([]),Y([])},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:Z,children:"Hy"}),V.jsx("button",{onClick:Oe,disabled:de.length===0||Z,className:`px-4 py-2 rounded-lg ${Z?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white flex items-center space-x-2`,children:Z?V.jsxs(V.Fragment,{children:[V.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[V.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),V.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),V.jsx("span",{children:"ang import..."})]}):V.jsxs("span",{children:["Import ",de.length," sn phm"]})})]})]})})]}):V.jsxs("div",{className:"text-center py-12",children:[V.jsx("input",{type:"file",accept:".json",onChange:et=>{const ot=et.target.files[0];ot&&Si(ot)},className:"hidden",id:"jsonFileInput"}),V.jsxs("label",{htmlFor:"jsonFileInput",className:"px-6 py-4 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 inline-block",children:[V.jsx("div",{className:"text-gray-600",children:"Click  chn file JSON"}),V.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"hoc ko th file vo y"})]})]})]})}),Si=async et=>{try{const ot=await et.text(),ft=JSON.parse(ot),Nt=[],vr=[];for(const cr of ft)t.some(li=>li.name.toLowerCase()===cr.name.toLowerCase())?Nt.push(cr):vr.push(cr);X(et),ye(vr),Y(Nt),O("new")}catch(ot){console.error("Error reading file:",ot),zt.error("File JSON khng hp l")}};return V.jsxs("div",{className:"container mx-auto px-4 py-8",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsxs("div",{children:[V.jsxs("h1",{className:"text-2xl font-bold",children:["Danh sch sn phm (",at,")"]}),B&&V.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Tm thy ",er().length," sn phm ph hp"]})]}),V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"text",placeholder:"Tm kim sn phm...",value:B,onChange:et=>K(et.target.value),className:"w-80 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),B&&V.jsx("button",{onClick:()=>K(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:""})]}),s==="admin"&&V.jsxs(V.Fragment,{children:[V.jsx("button",{onClick:()=>{D("import"),I(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import JSON"}),V.jsx("button",{onClick:()=>{D("export"),I(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Export JSON"}),V.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm sn phm"})]})]})]}),N.length>0&&s==="admin"&&V.jsx("div",{className:"mb-4",children:V.jsxs("button",{onClick:sr,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:["Xa (",N.length,")"]})}),r?V.jsxs("div",{className:"text-center py-8",children:[V.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),V.jsx("div",{className:"mt-4 text-gray-600",children:"ang ti..."})]}):er().length===0?V.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:V.jsx("div",{className:"text-gray-500 text-lg",children:B?V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"mb-2",children:""}),V.jsxs("div",{children:['Khng tm thy sn phm no ph hp vi "',B,'"']})]}):V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"mb-2",children:""}),V.jsx("div",{children:"Cha c sn phm no"})]})})}):V.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50",children:V.jsxs("tr",{children:[s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:V.jsx("input",{type:"checkbox",onChange:Or,checked:N.length===er().length&&er().length>0,className:"rounded border-gray-300"})}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hnh nh"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M t"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"n v"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Danh mc"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:er().map(et=>{var ot,ft,Nt,vr;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[s==="admin"&&V.jsx("td",{className:"px-6 py-4 whitespace-nowrap w-10",children:V.jsx("input",{type:"checkbox",checked:N.includes(et._id),onChange:()=>Lr(et._id),className:"rounded border-gray-300"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(ot=et.image)!=null&&ot.url?V.jsx("img",{src:et.image.url,alt:et.name,className:"h-16 w-16 object-cover rounded-lg"}):V.jsx("div",{className:"h-16 w-16 bg-gray-100 flex items-center justify-center rounded-lg",children:V.jsx("span",{className:"text-gray-400",children:"No image"})})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:et.name})}),V.jsx("td",{className:"px-6 py-4",children:V.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:et.description||"Khng c m t"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsxs("div",{className:"text-sm text-gray-900",children:[(ft=et.import_price)==null?void 0:ft.toLocaleString("vi-VN")," VN"]})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsxs("div",{className:"text-sm text-gray-900",children:[(Nt=et.price)==null?void 0:Nt.toLocaleString("vi-VN")," VN"]})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:et.unit})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:((vr=et.category)==null?void 0:vr.name)||"Cha phn loi"})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[V.jsx("button",{onClick:()=>ce(et),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Sa"}),V.jsx("button",{onClick:()=>ve(et._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},et._id)})})]})})}),!r&&er().length>0&&V.jsx($e,{}),R&&V.jsx(Hn,{}),o&&V.jsx(Gt,{}),_&&V.jsx(bt,{}),oe&&V.jsx(Ie,{})]})},fce=()=>{const[t,e]=We.useState([]),[r,i]=We.useState(!1),[s,n]=We.useState(""),[o,l]=We.useState(!1),[h,d]=We.useState({name:"",description:""}),[g,y]=We.useState(null),[C,x]=We.useState(!1);We.useEffect(()=>{const U=localStorage.getItem("userRole");n(U||""),_()},[]);const _=async()=>{try{i(!0);const U=localStorage.getItem("token"),te=await(await fetch("https://backend-giahung.onrender.com/api/categories",{headers:{Authorization:`Bearer ${U}`,"Content-Type":"application/json"}})).json();te.status==="success"&&e(te.data)}catch(U){console.error("Error fetching categories:",U),zt.error("Khng th ti danh sch danh mc")}finally{i(!1)}},E=U=>{const{name:X,value:te}=U.target;d(Y=>({...Y,[X]:te}))},R=async U=>{U.preventDefault();try{i(!0);const X=localStorage.getItem("token"),te=await fetch("https://backend-giahung.onrender.com/api/categories",{method:"POST",headers:{Authorization:`Bearer ${X}`,"Content-Type":"application/json"},body:JSON.stringify(h)}),Y=await te.json();if(te.ok)zt.success("Thm danh mc thnh cng"),l(!1),d({name:"",description:""}),_();else throw new Error(Y.message||"C li xy ra khi thm danh mc")}catch(X){zt.error(X.message||"Khng th thm danh mc")}finally{i(!1)}},I=async U=>{if(window.confirm("Bn c chc chn mun xa danh mc ny?"))try{const X=localStorage.getItem("token"),te=await fetch(`https://backend-giahung.onrender.com/api/categories/${U}`,{method:"DELETE",headers:{Authorization:`Bearer ${X}`,"Content-Type":"application/json"}});if(te.ok)zt.success("Xa danh mc thnh cng"),_();else{const Y=await te.json();throw new Error(Y.message||"Khng th xa danh mc")}}catch(X){console.error("Error deleting category:",X),zt.error(X.message||"C li xy ra khi xa danh mc")}},F=U=>{y(U),x(!0)},D=async U=>{U.preventDefault();try{i(!0);const X=localStorage.getItem("token"),te=await fetch(`https://backend-giahung.onrender.com/api/categories/${g._id}`,{method:"PUT",headers:{Authorization:`Bearer ${X}`,"Content-Type":"application/json"},body:JSON.stringify(g)}),Y=await te.json();if(te.ok)zt.success("Cp nht danh mc thnh cng"),x(!1),y(null),_();else throw new Error(Y.message||"C li xy ra khi cp nht danh mc")}catch(X){zt.error(X.message||"Khng th cp nht danh mc")}finally{i(!1)}};return V.jsxs("div",{children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold",children:"Danh sch danh mc"}),s==="admin"&&V.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Thm danh mc"})]}),o&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm danh mc mi"}),V.jsxs("form",{onSubmit:R,className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn danh mc"}),V.jsx("input",{type:"text",name:"name",value:h.name,onChange:E,className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:h.description,onChange:E,rows:"4",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200 resize-none"})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[V.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:r,children:r?"ang x l...":"Thm danh mc"})]})]})]})}),C&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sa danh mc"}),V.jsxs("form",{onSubmit:D,className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn danh mc"}),V.jsx("input",{type:"text",name:"name",value:g==null?void 0:g.name,onChange:U=>y(X=>({...X,name:U.target.value})),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:g==null?void 0:g.description,onChange:U=>y(X=>({...X,description:U.target.value})),rows:"4",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200 resize-none"})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[V.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:r,children:r?"ang x l...":"Cp nht danh mc"})]})]})]})}),r?V.jsx("div",{className:"text-center py-4",children:"ang ti..."}):t.length===0?V.jsx("div",{className:"text-center py-8",children:V.jsx("div",{className:"text-gray-500 text-lg",children:"Cha c danh mc no"})}):V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[V.jsx("thead",{className:"bg-gray-100",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn danh mc"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M t"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngy to"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(U=>V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:U._id})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name})}),V.jsx("td",{className:"px-6 py-4",children:V.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:U.description||"Khng c m t"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-500",children:new Date(U.createdAt).toLocaleDateString("vi-VN")})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[V.jsx("button",{className:"text-blue-600 hover:text-blue-900 mr-3",onClick:()=>F(U),children:"Sa"}),V.jsx("button",{onClick:()=>I(U._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},U._id))})]})})]})},dce=()=>{const[t,e]=We.useState([]),[r,i]=We.useState(!1),[s,n]=We.useState(""),[o,l]=We.useState(null),[h,d]=We.useState(!1);We.useEffect(()=>{(()=>{const E=localStorage.getItem("token"),R=localStorage.getItem("userRole");return console.log("=== Auth Check ==="),console.log("Token:",E?"Present":"Missing"),console.log("Token value:",E),console.log("User Role:",R),console.log("================"),E?(n(R||""),!0):(zt.error("Bn cn ng nhp  xem ni dung ny"),!1)})()&&g()},[]);const g=async()=>{try{i(!0);const _=localStorage.getItem("token");console.log("=== Fetch Customers Request ==="),console.log("Using token:",_);const E=await fetch("https://backend-giahung.onrender.com/api/users",{headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json"}});console.log("Response status:",E.status);const R=await E.json();if(console.log("Response data:",R),console.log("==========================="),E.ok)e(Array.isArray(R)?R:[]);else throw new Error(R.message||"Failed to fetch customers")}catch(_){console.error("Error details:",_),zt.error("Khng th ti danh sch ngi dng")}finally{i(!1)}},y=async _=>{try{const E=localStorage.getItem("token"),R=await fetch(`https://backend-giahung.onrender.com/api/users/${_}`,{method:"DELETE",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"}});if(R.ok)zt.success("Xa ti khon thnh cng"),s==="admin"?fetchAllUsers():(localStorage.removeItem("token"),localStorage.removeItem("userRole"),window.location.href="/login");else{const I=await R.json();throw new Error(I.message)}}catch(E){zt.error(E.message||"Khng th xa ti khon")}},C=_=>{l(_),d(!0)},x=async _=>{_.preventDefault();try{const E=localStorage.getItem("token"),R=s==="admin"?editUser._id:"me",I=await fetch(`https://backend-giahung.onrender.com/api/users/${R}`,{method:"PUT",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify({name:editUser.name,email:editUser.email})});if(I.ok)zt.success("Cp nht thng tin thnh cng"),d(!1),s==="admin"?fetchAllUsers():fetchCurrentUser();else{const F=await I.json();throw new Error(F.message)}}catch(E){zt.error(E.message||"Khng th cp nht thng tin")}};return V.jsxs("div",{children:[V.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Danh sch ngi dng"}),r?V.jsx("div",{className:"text-center py-4",children:"ang ti..."}):t.length===0?V.jsx("div",{className:"text-center py-8",children:V.jsx("div",{className:"text-gray-500 text-lg",children:"Cha c ngi dng no"})}):V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[V.jsx("thead",{className:"bg-gray-100",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"H tn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S in thoi"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vai tr"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngy to"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(_=>V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:_.email})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:_.phone||"Cha cp nht"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${_.role==="admin"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:_.role==="admin"?"Admin":"Khch hng"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-500",children:new Date(_.createdAt).toLocaleDateString("vi-VN")})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[V.jsx("button",{onClick:()=>C(_),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Sa"}),V.jsx("button",{onClick:()=>y(_._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},_._id))})]})}),h&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Chnh sa thng tin ngi dng"}),V.jsxs("form",{onSubmit:x,className:"space-y-6",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"H tn"}),V.jsx("input",{type:"text",value:(o==null?void 0:o.name)||"",onChange:_=>l({...o,name:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),V.jsx("input",{type:"email",value:(o==null?void 0:o.email)||"",onChange:_=>l({...o,email:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"S in thoi"}),V.jsx("input",{type:"tel",value:(o==null?void 0:o.phone)||"",onChange:_=>l({...o,phone:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vai tr"}),V.jsxs("select",{value:(o==null?void 0:o.role)||"",onChange:_=>l({...o,role:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[V.jsx("option",{value:"user",children:"Khch hng"}),V.jsx("option",{value:"admin",children:"Admin"})]})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[V.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:r?"ang x l...":"Cp nht"})]})]})]})})]})},gce=()=>{const[t,e]=We.useState([]),[r,i]=We.useState([]),[s,n]=We.useState(!0);We.useEffect(()=>{o()},[]);const o=async()=>{try{n(!0);const d=await(await fetch("your-api-endpoint")).json();e(d),i(d)}catch(h){console.error("Error fetching data:",h)}finally{n(!1)}},l=h=>{if(!h.trim()){i(t);return}const d=t.filter(g=>g.name.toLowerCase().includes(h.toLowerCase())||g.email.toLowerCase().includes(h.toLowerCase())||g.role.toLowerCase().includes(h.toLowerCase()));i(d)};return V.jsxs("div",{className:"p-6",children:[V.jsxs("div",{className:"mb-8",children:[V.jsx("h1",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Dashboard"}),V.jsx(cce,{onSearch:l})]}),s?V.jsx("div",{className:"flex justify-center items-center h-64",children:V.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):V.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(h=>V.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[V.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:h.name}),V.jsx("p",{className:"text-gray-600",children:h.email}),V.jsx("span",{className:`inline-block px-2 py-1 mt-2 text-sm rounded-full ${h.role==="admin"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:h.role})]},h.id))}),!s&&r.length===0&&V.jsx("div",{className:"text-center text-gray-500 mt-8",children:"Khng tm thy kt qu ph hp"})]})};function O2(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bP={exports:{}},p4={exports:{}};/*! cpexcel.js (C) 2013-present SheetJS -- http://sheetjs.com */var g$;function mce(){return g$||(g$=1,function(t){var e={version:"1.15.0"};e[437]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[620]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[737]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[850]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[852]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[857]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[861]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[865]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[866]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[874]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[895]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[932]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);return{enc:i,dec:r}}(),e[936]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[133]="".split(""),n=0;n!=s[133].length;++n)s[133][n].charCodeAt(0)!==65533&&(i[s[133][n]]=34048+n,r[34048+n]=s[133][n]);for(s[134]="".split(""),n=0;n!=s[134].length;++n)s[134][n].charCodeAt(0)!==65533&&(i[s[134][n]]=34304+n,r[34304+n]=s[134][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[160]="".split(""),n=0;n!=s[160].length;++n)s[160][n].charCodeAt(0)!==65533&&(i[s[160][n]]=40960+n,r[40960+n]=s[160][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);for(s[253]="".split(""),n=0;n!=s[253].length;++n)s[253][n].charCodeAt(0)!==65533&&(i[s[253][n]]=64768+n,r[64768+n]=s[253][n]);for(s[254]="".split(""),n=0;n!=s[254].length;++n)s[254][n].charCodeAt(0)!==65533&&(i[s[254][n]]=65024+n,r[65024+n]=s[254][n]);return{enc:i,dec:r}}(),e[949]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[133]="".split(""),n=0;n!=s[133].length;++n)s[133][n].charCodeAt(0)!==65533&&(i[s[133][n]]=34048+n,r[34048+n]=s[133][n]);for(s[134]="".split(""),n=0;n!=s[134].length;++n)s[134][n].charCodeAt(0)!==65533&&(i[s[134][n]]=34304+n,r[34304+n]=s[134][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[160]="".split(""),n=0;n!=s[160].length;++n)s[160][n].charCodeAt(0)!==65533&&(i[s[160][n]]=40960+n,r[40960+n]=s[160][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);for(s[253]="".split(""),n=0;n!=s[253].length;++n)s[253][n].charCodeAt(0)!==65533&&(i[s[253][n]]=64768+n,r[64768+n]=s[253][n]);return{enc:i,dec:r}}(),e[950]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);return{enc:i,dec:r}}(),e[1250]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1251]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1252]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1253]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1254]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1255]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1256]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1257]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1258]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1e4]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10006]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10007]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10008]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);return{enc:i,dec:r}}(),e[10029]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10079]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10081]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[28591]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(t.exports=e);/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(r,i){if(typeof e>"u")if(typeof O2<"u"){var s=e;t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?t.exports=i(s):r.cptable=i(s)}else throw new Error("cptable not found");else e=i(e)})(kw,function(r){var i={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],n=[932,936,949,950],o=[65001],l={},h={},d={},g={},y=function(Me){return String.fromCharCode(Me)},C=function(Me){return Me.charCodeAt(0)},x=typeof Buffer<"u",_=function(){};if(x){var E=!Buffer.from;if(!E)try{Buffer.from("foo","utf8")}catch{E=!0}_=E?function(Be,Me){return Me?new Buffer(Be,Me):new Buffer(Be)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(Be){return new Buffer(Be)});var R=1024,I=Buffer.allocUnsafe(R),F=function(Me){for(var A=Buffer.allocUnsafe(65536),O=0;O<65536;++O)A[O]=0;for(var N=Object.keys(Me),H=N.length,B=0,K=N[B];B<H;++B)(K=N[B])&&(A[K.charCodeAt(0)]=Me[K]);return A},D=function(Me){var A=F(r[Me].enc);return function(N,H){var B=N.length,K,Z=0,we=0,Ce=0,z=0;if(typeof N=="string")for(K=Buffer.allocUnsafe(B),Z=0;Z<B;++Z)K[Z]=A[N.charCodeAt(Z)];else if(Buffer.isBuffer(N)){for(K=Buffer.allocUnsafe(2*B),we=0,Z=0;Z<B;++Z)Ce=N[Z],Ce<128?K[we++]=A[Ce]:Ce<224?(K[we++]=A[((Ce&31)<<6)+(N[Z+1]&63)],++Z):Ce<240?(K[we++]=A[((Ce&15)<<12)+((N[Z+1]&63)<<6)+(N[Z+2]&63)],Z+=2):(z=((Ce&7)<<18)+((N[Z+1]&63)<<12)+((N[Z+2]&63)<<6)+(N[Z+3]&63),Z+=3,z<65536?K[we++]=A[z]:(z-=65536,K[we++]=A[55296+(z>>10&1023)],K[we++]=A[56320+(z&1023)]));K=K.slice(0,we)}else for(K=Buffer.allocUnsafe(B),Z=0;Z<B;++Z)K[Z]=A[N[Z].charCodeAt(0)];return!H||H==="buf"?K:H!=="arr"?K.toString("binary"):[].slice.call(K)}},U=function(Me){var A=r[Me].dec,O=Buffer.allocUnsafe(131072),N=0,H="";for(N=0;N<A.length;++N)if(H=A[N]){var B=H.charCodeAt(0);O[2*N]=B&255,O[2*N+1]=B>>8}return function(Z){var we=Z.length,Ce=0,z=0;if(2*we>R&&(R=2*we,I=Buffer.allocUnsafe(R)),Buffer.isBuffer(Z))for(Ce=0;Ce<we;Ce++)z=2*Z[Ce],I[2*Ce]=O[z],I[2*Ce+1]=O[z+1];else if(typeof Z=="string")for(Ce=0;Ce<we;Ce++)z=2*Z.charCodeAt(Ce),I[2*Ce]=O[z],I[2*Ce+1]=O[z+1];else for(Ce=0;Ce<we;Ce++)z=2*Z[Ce],I[2*Ce]=O[z],I[2*Ce+1]=O[z+1];return I.slice(0,2*we).toString("ucs2")}},X=function(Me){for(var A=r[Me].enc,O=Buffer.allocUnsafe(131072),N=0;N<131072;++N)O[N]=0;for(var H=Object.keys(A),B=0,K=H[B];B<H.length;++B)if(K=H[B]){var Z=K.charCodeAt(0);O[2*Z]=A[K]&255,O[2*Z+1]=A[K]>>8}return function(Ce,z){var q=Ce.length,re=Buffer.allocUnsafe(2*q),ve=0,ce=0,Re=0,Oe=0,he=0;if(typeof Ce=="string"){for(ve=Oe=0;ve<q;++ve)ce=Ce.charCodeAt(ve)*2,re[Oe++]=O[ce+1]||O[ce],O[ce+1]>0&&(re[Oe++]=O[ce]);re=re.slice(0,Oe)}else if(Buffer.isBuffer(Ce)){for(ve=Oe=0;ve<q;++ve)he=Ce[ve],he<128?ce=he:he<224?(ce=((he&31)<<6)+(Ce[ve+1]&63),++ve):he<240?(ce=((he&15)<<12)+((Ce[ve+1]&63)<<6)+(Ce[ve+2]&63),ve+=2):(ce=((he&7)<<18)+((Ce[ve+1]&63)<<12)+((Ce[ve+2]&63)<<6)+(Ce[ve+3]&63),ve+=3),ce<65536?(ce*=2,re[Oe++]=O[ce+1]||O[ce],O[ce+1]>0&&(re[Oe++]=O[ce])):(Re=ce-65536,ce=2*(55296+(Re>>10&1023)),re[Oe++]=O[ce+1]||O[ce],O[ce+1]>0&&(re[Oe++]=O[ce]),ce=2*(56320+(Re&1023)),re[Oe++]=O[ce+1]||O[ce],O[ce+1]>0&&(re[Oe++]=O[ce]));re=re.slice(0,Oe)}else for(ve=Oe=0;ve<q;ve++)ce=Ce[ve].charCodeAt(0)*2,re[Oe++]=O[ce+1]||O[ce],O[ce+1]>0&&(re[Oe++]=O[ce]);return!z||z==="buf"?re:z!=="arr"?re.toString("binary"):[].slice.call(re)}},te=function(Me){var A=r[Me].dec,O=Buffer.allocUnsafe(131072),N=0,H,B=0,K=0,Z=0;for(Z=0;Z<65536;++Z)O[2*Z]=255,O[2*Z+1]=253;for(N=0;N<A.length;++N)(H=A[N])&&(B=H.charCodeAt(0),K=2*N,O[K]=B&255,O[K+1]=B>>8);return function(Ce){var z=Ce.length,q=Buffer.allocUnsafe(2*z),re=0,ve=0,ce=0;if(Buffer.isBuffer(Ce))for(re=0;re<z;re++)ve=2*Ce[re],O[ve]===255&&O[ve+1]===253&&(ve=2*((Ce[re]<<8)+Ce[re+1]),++re),q[ce++]=O[ve],q[ce++]=O[ve+1];else if(typeof Ce=="string")for(re=0;re<z;re++)ve=2*Ce.charCodeAt(re),O[ve]===255&&O[ve+1]===253&&(ve=2*((Ce.charCodeAt(re)<<8)+Ce.charCodeAt(re+1)),++re),q[ce++]=O[ve],q[ce++]=O[ve+1];else for(re=0;re<z;re++)ve=2*Ce[re],O[ve]===255&&O[ve+1]===253&&(ve=2*((Ce[re]<<8)+Ce[re+1]),++re),q[ce++]=O[ve],q[ce++]=O[ve+1];return q.slice(0,ce).toString("ucs2")}};l[65001]=function Be(Me){if(typeof Me=="string")return Be(Me.split("").map(C));var A=Me.length,O=0,N=0;4*A>R&&(R=4*A,I=Buffer.allocUnsafe(R));var H=0;A>=3&&Me[0]==239&&Me[1]==187&&Me[2]==191&&(H=3);for(var B=1,K=0,Z=0;H<A;H+=B)B=1,Z=Me[H],Z<128?O=Z:Z<224?(O=(Z&31)*64+(Me[H+1]&63),B=2):Z<240?(O=((Z&15)<<12)+(Me[H+1]&63)*64+(Me[H+2]&63),B=3):(O=(Z&7)*262144+((Me[H+1]&63)<<12)+(Me[H+2]&63)*64+(Me[H+3]&63),B=4),O<65536?(I[K++]=O&255,I[K++]=O>>8):(O-=65536,N=55296+(O>>10&1023),O=56320+(O&1023),I[K++]=N&255,I[K++]=N>>>8,I[K++]=O&255,I[K++]=O>>>8&255);return I.slice(0,K).toString("ucs2")},h[65001]=function(Me,A){if(x&&Buffer.isBuffer(Me))return!A||A==="buf"?Me:A!=="arr"?Me.toString("binary"):[].slice.call(Me);var O=Me.length,N=0,H=0,B=0,K=typeof Me=="string";4*O>R&&(R=4*O,I=Buffer.allocUnsafe(R));for(var Z=0;Z<O;++Z)N=K?Me.charCodeAt(Z):Me[Z].charCodeAt(0),N<=127?I[B++]=N:N<=2047?(I[B++]=192+(N>>6),I[B++]=128+(N&63)):N>=55296&&N<=57343?(N-=55296,++Z,H=(K?Me.charCodeAt(Z):Me[Z].charCodeAt(0))-56320+(N<<10),I[B++]=240+(H>>>18&7),I[B++]=144+(H>>>12&63),I[B++]=128+(H>>>6&63),I[B++]=128+(H&63)):(I[B++]=224+(N>>12),I[B++]=128+(N>>6&63),I[B++]=128+(N&63));return!A||A==="buf"?I.slice(0,B):A!=="arr"?I.slice(0,B).toString("binary"):[].slice.call(I,0,B)}}var Y=function(){if(x){if(d[s[0]])return;var Me=0,A=0;for(Me=0;Me<s.length;++Me)A=s[Me],r[A]&&(d[A]=U(A),g[A]=D(A));for(Me=0;Me<n.length;++Me)A=n[Me],r[A]&&(d[A]=te(A),g[A]=X(A));for(Me=0;Me<o.length;++Me)A=o[Me],l[A]&&(d[A]=l[A]),h[A]&&(g[A]=h[A])}},oe=function(Be,Me){return""},me=function(Me){delete d[Me],delete g[Me]},de=function(){if(x){if(!d[s[0]])return;s.forEach(me),n.forEach(me),o.forEach(me)}nt=oe,at=0},ye={encache:Y,decache:de,sbcs:s,dbcs:n};Y();var Ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",nt=oe,at=0,Ze=function Be(Me,A,O){if(Me===at&&nt)return nt(A,O);if(g[Me])return nt=g[at=Me],nt(A,O);x&&Buffer.isBuffer(A)&&(A=A.toString("utf8"));var N=A.length,H=x?Buffer.allocUnsafe(4*N):[],B=0,K=0,Z=0,we=0,Ce=r[Me],z,q="",re=typeof A=="string";if(Ce&&(z=Ce.enc))for(K=0;K<N;++K,++Z)B=z[re?A.charAt(K):A[K]],B>255?(H[Z]=B>>8,H[++Z]=B&255):H[Z]=B&255;else if(q=i[Me])switch(q){case"utf8":if(x&&re){H=_(A,q),Z=H.length;break}for(K=0;K<N;++K,++Z)B=re?A.charCodeAt(K):A[K].charCodeAt(0),B<=127?H[Z]=B:B<=2047?(H[Z]=192+(B>>6),H[++Z]=128+(B&63)):B>=55296&&B<=57343?(B-=55296,we=(re?A.charCodeAt(++K):A[++K].charCodeAt(0))-56320+(B<<10),H[Z]=240+(we>>>18&7),H[++Z]=144+(we>>>12&63),H[++Z]=128+(we>>>6&63),H[++Z]=128+(we&63)):(H[Z]=224+(B>>12),H[++Z]=128+(B>>6&63),H[++Z]=128+(B&63));break;case"ascii":if(x&&typeof A=="string"){H=_(A,q),Z=H.length;break}for(K=0;K<N;++K,++Z)if(B=re?A.charCodeAt(K):A[K].charCodeAt(0),B<=127)H[Z]=B;else throw new Error("bad ascii "+B);break;case"utf16le":if(x&&typeof A=="string"){H=_(A,q),Z=H.length;break}for(K=0;K<N;++K)B=re?A.charCodeAt(K):A[K].charCodeAt(0),H[Z++]=B&255,H[Z++]=B>>8;break;case"utf16be":for(K=0;K<N;++K)B=re?A.charCodeAt(K):A[K].charCodeAt(0),H[Z++]=B>>8,H[Z++]=B&255;break;case"utf32le":for(K=0;K<N;++K)B=re?A.charCodeAt(K):A[K].charCodeAt(0),B>=55296&&B<=57343&&(B=65536+(B-55296<<10)+(A[++K].charCodeAt(0)-56320)),H[Z++]=B&255,B>>=8,H[Z++]=B&255,B>>=8,H[Z++]=B&255,B>>=8,H[Z++]=B&255;break;case"utf32be":for(K=0;K<N;++K)B=re?A.charCodeAt(K):A[K].charCodeAt(0),B>=55296&&B<=57343&&(B=65536+(B-55296<<10)+(A[++K].charCodeAt(0)-56320)),H[Z+3]=B&255,B>>=8,H[Z+2]=B&255,B>>=8,H[Z+1]=B&255,B>>=8,H[Z]=B&255,Z+=4;break;case"utf7":for(K=0;K<N;K++){var ve=re?A.charAt(K):A[K].charAt(0);if(ve==="+"){H[Z++]=43,H[Z++]=45;continue}if(ke.indexOf(ve)>-1){H[Z++]=ve.charCodeAt(0);continue}var ce=Be(1201,ve);H[Z++]=43,H[Z++]=Ee.charCodeAt(ce[0]>>2),H[Z++]=Ee.charCodeAt(((ce[0]&3)<<4)+((ce[1]||0)>>4)),H[Z++]=Ee.charCodeAt(((ce[1]&15)<<2)+((ce[2]||0)>>6)),H[Z++]=45}break;default:throw new Error("Unsupported magic: "+Me+" "+i[Me])}else throw new Error("Unrecognized CP: "+Me);return H=H.slice(0,Z),x?!O||O==="buf"?H:O!=="arr"?H.toString("binary"):[].slice.call(H):O=="str"?H.map(y).join(""):H},Xe=function Be(Me,A){var O;if(O=d[Me])return O(A);if(typeof A=="string")return Be(Me,A.split("").map(C));var N=A.length,H=new Array(N),B="",K=0,Z=0,we=1,Ce=0,z=0,q=r[Me],re,ve="";if(q&&(re=q.dec))for(Z=0;Z<N;Z+=we){if(we=2,B=re[(A[Z]<<8)+A[Z+1]],B||(we=1,B=re[A[Z]]),!B)throw new Error("Unrecognized code: "+A[Z]+" "+A[Z+we-1]+" "+Z+" "+we+" "+re[A[Z]]);H[Ce++]=B}else if(ve=i[Me])switch(ve){case"utf8":for(N>=3&&A[0]==239&&A[1]==187&&A[2]==191&&(Z=3);Z<N;Z+=we)we=1,A[Z]<128?K=A[Z]:A[Z]<224?(K=(A[Z]&31)*64+(A[Z+1]&63),we=2):A[Z]<240?(K=((A[Z]&15)<<12)+(A[Z+1]&63)*64+(A[Z+2]&63),we=3):(K=(A[Z]&7)*262144+((A[Z+1]&63)<<12)+(A[Z+2]&63)*64+(A[Z+3]&63),we=4),K<65536||(K-=65536,z=55296+(K>>10&1023),K=56320+(K&1023),H[Ce++]=String.fromCharCode(z)),H[Ce++]=String.fromCharCode(K);break;case"ascii":if(x&&Buffer.isBuffer(A))return A.toString(ve);for(Z=0;Z<N;Z++)H[Z]=String.fromCharCode(A[Z]);Ce=N;break;case"utf16le":if(N>=2&&A[0]==255&&A[1]==254&&(Z=2),x&&Buffer.isBuffer(A))return A.toString(ve);for(we=2;Z+1<N;Z+=we)H[Ce++]=String.fromCharCode((A[Z+1]<<8)+A[Z]);break;case"utf16be":for(N>=2&&A[0]==254&&A[1]==255&&(Z=2),we=2;Z+1<N;Z+=we)H[Ce++]=String.fromCharCode((A[Z]<<8)+A[Z+1]);break;case"utf32le":for(N>=4&&A[0]==255&&A[1]==254&&A[2]===0&&A[3]===0&&(Z=4),we=4;Z<N;Z+=we)K=(A[Z+3]<<24)+(A[Z+2]<<16)+(A[Z+1]<<8)+A[Z],K>65535?(K-=65536,H[Ce++]=String.fromCharCode(55296+(K>>10&1023)),H[Ce++]=String.fromCharCode(56320+(K&1023))):H[Ce++]=String.fromCharCode(K);break;case"utf32be":for(N>=4&&A[3]==255&&A[2]==254&&A[1]===0&&A[0]===0&&(Z=4),we=4;Z<N;Z+=we)K=(A[Z]<<24)+(A[Z+1]<<16)+(A[Z+2]<<8)+A[Z+3],K>65535?(K-=65536,H[Ce++]=String.fromCharCode(55296+(K>>10&1023)),H[Ce++]=String.fromCharCode(56320+(K&1023))):H[Ce++]=String.fromCharCode(K);break;case"utf7":for(N>=4&&A[0]==43&&A[1]==47&&A[2]==118&&(N>=5&&A[3]==56&&A[4]==45?Z=5:(A[3]==56||A[3]==57||A[3]==43||A[3]==47)&&(Z=4));Z<N;Z+=we){if(A[Z]!==43){we=1,H[Ce++]=String.fromCharCode(A[Z]);continue}if(we=1,A[Z+1]===45){we=2,H[Ce++]="+";continue}for(;String.fromCharCode(A[Z+we]).match(/[A-Za-z0-9+\/]/);)we++;var ce=0;A[Z+we]===45&&(++we,ce=1);for(var Re=[],Oe="",he=0,Ie=0,De=0,$e=0,qe=0,Ft=0,bt=0,Gt=1;Gt<we-ce&&($e=Ee.indexOf(String.fromCharCode(A[Z+Gt++])),qe=Ee.indexOf(String.fromCharCode(A[Z+Gt++])),he=$e<<2|qe>>4,Re.push(he),Ft=Ee.indexOf(String.fromCharCode(A[Z+Gt++])),!(Ft===-1||(Ie=(qe&15)<<4|Ft>>2,Re.push(Ie),bt=Ee.indexOf(String.fromCharCode(A[Z+Gt++])),bt===-1)));)De=(Ft&3)<<6|bt,bt<64&&Re.push(De);for(Oe=Be(1201,Re),Gt=0;Gt<Oe.length;++Gt)H[Ce++]=Oe.charAt(Gt)}break;default:throw new Error("Unsupported magic: "+Me+" "+i[Me])}else throw new Error("Unrecognized CP: "+Me);return H.slice(0,Ce).join("")},Pe=function(Me){return!!(r[Me]||i[Me])};return r.utils={decode:Xe,encode:Ze,hascp:Pe,magic:i,cache:ye},r})}(p4)),p4.exports}const pce={},vce=Object.freeze(Object.defineProperty({__proto__:null,default:pce},Symbol.toStringTag,{value:"Module"})),v4=tse(vce);(function(t,e){var r={};function i(s){s.version="0.18.5",s.style_version="1.2.0";var n,o=1200,l=1252;typeof cptable<"u"?n=cptable:typeof O2<"u"&&(n=mce());var h=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],d={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},g=function(a){h.indexOf(a)!=-1&&(l=d[0]=a)},y=function(a){g(o=a)};function C(){y(1200),g(1252)}function x(a){for(var c=[],u=0,f=a.length;u<f;++u)c[u]=a.charCodeAt(u);return c}function _(a){for(var c=[],u=0;u<a.length>>1;++u)c[u]=String.fromCharCode(a.charCodeAt(2*u+1)+(a.charCodeAt(2*u)<<8));return c.join("")}var E=function(a){var c=a.charCodeAt(0),u=a.charCodeAt(1);return c==255&&u==254?function(f){for(var m=[],v=0;v<f.length>>1;++v)m[v]=String.fromCharCode(f.charCodeAt(2*v)+(f.charCodeAt(2*v+1)<<8));return m.join("")}(a.slice(2)):c==254&&u==255?_(a.slice(2)):c==65279?a.slice(1):a},R=function(a){return String.fromCharCode(a)},I=function(a){return String.fromCharCode(a)};n!==void 0&&(y=function(a){g(o=a)},E=function(a){return a.charCodeAt(0)===255&&a.charCodeAt(1)===254?n.utils.decode(1200,x(a.slice(2))):a},R=function(a){return o===1200?String.fromCharCode(a):n.utils.decode(o,[255&a,a>>8])[0]},I=function(a){return n.utils.decode(l,[a])[0]});var F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function D(a){for(var c,u,f,m,v,p="",w=0,S=0,b=0;b<a.length;)m=(c=a.charCodeAt(b++))>>2,v=(3&c)<<4|(u=a.charCodeAt(b++))>>4,w=(15&u)<<2|(f=a.charCodeAt(b++))>>6,S=63&f,isNaN(u)?w=S=64:isNaN(f)&&(S=64),p+=F.charAt(m)+F.charAt(v)+F.charAt(w)+F.charAt(S);return p}function U(a){var c,u,f,m,v,p,w="";a=a.replace(/[^\w\+\/\=]/g,"");for(var S=0;S<a.length;)c=F.indexOf(a.charAt(S++))<<2|(m=F.indexOf(a.charAt(S++)))>>4,w+=String.fromCharCode(c),u=(15&m)<<4|(v=F.indexOf(a.charAt(S++)))>>2,v!==64&&(w+=String.fromCharCode(u)),f=(3&v)<<6|(p=F.indexOf(a.charAt(S++))),p!==64&&(w+=String.fromCharCode(f));return w}var X=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,te=function(){if(typeof Buffer>"u")return function(){};var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(c,u){return u?new Buffer(c,u):new Buffer(c)}:Buffer.from.bind(Buffer)}();function Y(a){return X?Buffer.alloc?Buffer.alloc(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}function oe(a){return X?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}var me=function(a){return X?te(a,"binary"):a.split("").map(function(c){return 255&c.charCodeAt(0)})};function de(a){if(typeof ArrayBuffer>"u")return me(a);for(var c=new ArrayBuffer(a.length),u=new Uint8Array(c),f=0;f!=a.length;++f)u[f]=255&a.charCodeAt(f);return c}function ye(a){if(Array.isArray(a))return a.map(function(f){return String.fromCharCode(f)}).join("");for(var c=[],u=0;u<a.length;++u)c[u]=String.fromCharCode(a[u]);return c.join("")}function Ee(a){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(a instanceof ArrayBuffer)return Ee(new Uint8Array(a));for(var c=new Array(a.length),u=0;u<a.length;++u)c[u]=a[u];return c}var ke=X?function(a){return Buffer.concat(a.map(function(c){return Buffer.isBuffer(c)?c:te(c)}))}:function(a){if(typeof Uint8Array>"u")return[].concat.apply([],a.map(function(v){return Array.isArray(v)?v:[].slice.call(v)}));for(var u=0,c=0,u=0;u<a.length;++u)c+=a[u].length;for(var f,m=new Uint8Array(c),c=u=0;u<a.length;c+=f,++u)if(f=a[u].length,a[u]instanceof Uint8Array)m.set(a[u],c);else{if(typeof a[u]=="string")throw"wtf";m.set(new Uint8Array(a[u]),c)}return m},nt=/\u0000/g,at=/[\u0001-\u0006]/g;function Ze(a){for(var c="",u=a.length-1;0<=u;)c+=a.charAt(u--);return c}function Xe(a,c){return a=""+a,c<=a.length?a:Ye("0",c-a.length)+a}function Pe(a,c){return a=""+a,c<=a.length?a:Ye(" ",c-a.length)+a}function Be(a,c){return a=""+a,c<=a.length?a:a+Ye(" ",c-a.length)}var Me=Math.pow(2,32);function A(m,c){if(Me<m||m<-Me)return u=m,f=c,u=""+Math.round(u),f<=u.length?u:Ye("0",f-u.length)+u;var u,f,m=Math.round(m);return(c=c)<=(m=""+(m=m)).length?m:Ye("0",c-m.length)+m}function O(a,c){return c=c||0,a.length>=7+c&&(32|a.charCodeAt(c))==103&&(32|a.charCodeAt(c+1))==101&&(32|a.charCodeAt(c+2))==110&&(32|a.charCodeAt(c+3))==101&&(32|a.charCodeAt(c+4))==114&&(32|a.charCodeAt(c+5))==97&&(32|a.charCodeAt(c+6))==108}var N=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],H=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],B={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Z={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function we(a,c,u){for(var f=a<0?-1:1,m=a*f,v=0,p=1,w=0,S=1,b=0,T=0,P=Math.floor(m);b<c&&(w=(P=Math.floor(m))*p+v,T=P*b+S,!(m-P<5e-8));)m=1/(m-P),v=p,p=w,S=b,b=T;return c<T&&(w=c<b?(T=S,v):(T=b,p)),u?(u=Math.floor(f*w/T),[u,f*w-u*T,T]):[0,f*w,T]}function Ce(w,c,u){if(2958465<w||w<0)return null;var f=0|w,m=Math.floor(86400*(w-f)),v=0,p=[],w={D:f,T:m,u:86400*(w-f)-m,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(w.u)<1e-6&&(w.u=0),c&&c.date1904&&(f+=1462),.9999<w.u&&(w.u=0,++m==86400&&(w.T=m=0,++f,++w.D)),f===60?(p=u?[1317,10,29]:[1900,2,29],v=3):f===0?(p=u?[1317,8,29]:[1900,1,0],v=6):(60<f&&--f,(c=new Date(1900,0,1)).setDate(c.getDate()+f-1),p=[c.getFullYear(),c.getMonth()+1,c.getDate()],v=c.getDay(),f<60&&(v=(v+6)%7),u&&(v=function(S,b){return b[0]-=581,b=S.getDay(),S<60&&(b=(b+6)%7),b}(c,p))),w.y=p[0],w.m=p[1],w.d=p[2],w.S=m%60,m=Math.floor(m/60),w.M=m%60,m=Math.floor(m/60),w.H=m,w.q=v,w}var z=new Date(1899,11,31,0,0,0),q=z.getTime(),re=new Date(1900,2,1,0,0,0);function ve(a,c){var u=a.getTime();return c?u-=1262304e5:re<=a&&(u+=864e5),(u-(q+6e4*(a.getTimezoneOffset()-z.getTimezoneOffset())))/864e5}function ce(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Re(a){var c,u,f,m=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),v=-4<=m&&m<=-1?a.toPrecision(10+m):Math.abs(m)<=9?(u=(c=a)<0?12:11,(f=ce(c.toFixed(12))).length<=u||(f=c.toPrecision(10)).length<=u?f:c.toExponential(5)):m===10?a.toFixed(10).substr(0,12):(v=ce((a=a).toFixed(11))).length>(a<0?12:11)||v==="0"||v==="-0"?a.toPrecision(6):v;return ce((v=v.toUpperCase()).indexOf("E")==-1?v:v.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Oe(a,c){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(0|a)===a?a.toString(10):Re(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return vr(14,ve(a,c&&c.date1904),c)}throw new Error("unsupported value in General format: "+a)}function he(a){if(a.length<=3)return a;for(var c=a.length%3,u=a.substr(0,c);c!=a.length;c+=3)u+=(0<u.length?",":"")+a.substr(c,3);return u}var Ie=/%/g,De=/# (\?+)( ?)\/( ?)(\d+)/,$e=/^#*0*\.([0#]+)/,qe=/\).*[0#]/,Ft=/\(###\) ###\\?-####/;function bt(a){for(var c,u="",f=0;f!=a.length;++f)switch(c=a.charCodeAt(f)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(c)}return u}function Gt(a,c){return c=Math.pow(10,c),""+Math.round(a*c)/c}function Lr(f,c){var u=f-Math.floor(f),f=Math.pow(10,c);return c<(""+Math.round(u*f)).length?0:Math.round(u*f)}function Or(a,c,u){if(a.charCodeAt(0)===40&&!c.match(qe)){var f=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?Or("n",f,u):"("+Or("n",f,-u)+")"}if(c.charCodeAt(c.length-1)===44)return function(W,J,ne){for(var se=J.length-1;J.charCodeAt(se-1)===44;)--se;return er(W,J.substr(0,se),ne/Math.pow(10,3*(J.length-se)))}(a,c,u);if(c.indexOf("%")!==-1)return w=a,b=u,S=(T=c).replace(Ie,""),T=T.length-S.length,er(w,S,b*Math.pow(10,2*T))+Ye("%",T);var m;if(c.indexOf("E")!==-1)return function W(J,ne){var se,xe=J.indexOf("E")-J.indexOf(".")-1;if(J.match(/^#+0.0E\+0$/)){if(ne==0)return"0.0E+0";if(ne<0)return"-"+W(J,-ne);var He=J.indexOf(".");He===-1&&(He=J.indexOf("E"));var Fe=Math.floor(Math.log(ne)*Math.LOG10E)%He;if(Fe<0&&(Fe+=He),(se=(ne/Math.pow(10,Fe)).toPrecision(1+xe+(He+Fe)%He)).indexOf("e")===-1){var Ue=Math.floor(Math.log(ne)*Math.LOG10E);for(se.indexOf(".")===-1?se=se.charAt(0)+"."+se.substr(1)+"E+"+(Ue-se.length+Fe):se+="E+"+(Ue-Fe);se.substr(0,2)==="0.";)se=(se=se.charAt(0)+se.substr(2,He)+"."+se.substr(2+He)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");se=se.replace(/\+-/,"-")}se=se.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(ct,ut,Ke,St){return ut+Ke+St.substr(0,(He+Fe)%He)+"."+St.substr(Fe)+"E"})}else se=ne.toExponential(xe);return J.match(/E\+00$/)&&se.match(/e[+-]\d$/)&&(se=se.substr(0,se.length-1)+"0"+se.charAt(se.length-1)),(se=J.match(/E\-/)&&se.match(/e\+/)?se.replace(/e\+/,"e"):se).replace("e","E")}(c,u);if(c.charCodeAt(0)===36)return"$"+Or(a,c.substr(c.charAt(1)==" "?2:1),u);var v,p,w,S,b,T,P,M=Math.abs(u),k=u<0?"-":"";if(c.match(/^00+$/))return k+A(M,c.length);if(c.match(/^[#?]+$/))return(m=(m=A(u,0))==="0"?"":m).length>c.length?m:bt(c.substr(0,c.length-m.length))+m;if(v=c.match(De))return P=v,w=M,S=k,b=parseInt(P[4],10),T=Math.round(w*b),w=Math.floor(T/b),S+(w===0?"":""+w)+" "+((T-=w*b)==0?Ye(" ",P[1].length+1+P[4].length):Pe(T,P[1].length)+P[2]+"/"+P[3]+Xe(b,P[4].length));if(c.match(/^#+0+$/))return k+A(M,c.length-c.indexOf("0"));if(v=c.match($e))return m=Gt(u,v[1].length).replace(/^([^\.]+)$/,"$1."+bt(v[1])).replace(/\.$/,"."+bt(v[1])).replace(/\.(\d*)$/,function(W,J){return"."+J+Ye("0",bt(v[1]).length-J.length)}),c.indexOf("0.")!==-1?m:m.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),v=c.match(/^(0*)\.(#*)$/))return k+Gt(M,v[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=c.match(/^#{1,3},##0(\.?)$/))return k+he(A(M,0));if(v=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+Or(a,c,-u):he(""+(Math.floor(u)+(P=u,(j=v[1].length)<(""+Math.round((P-Math.floor(P))*Math.pow(10,j))).length?1:0)))+"."+Xe(Lr(u,v[1].length),v[1].length);if(v=c.match(/^#,#*,#0/))return Or(a,c.replace(/^#,#*,/,""),u);if(v=c.match(/^([0#]+)(\\?-([0#]+))+$/))return m=Ze(Or(a,c.replace(/[\\-]/g,""),u)),p=0,Ze(Ze(c.replace(/\\/g,"")).replace(/[0#]/g,function(W){return p<m.length?m.charAt(p++):W==="0"?"0":""}));if(c.match(Ft))return"("+(m=Or(a,"##########",u)).substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);var j="";if(v=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(v[4].length,7),L=we(M,Math.pow(10,p)-1,!1),m=k,(j=er("n",v[1],L[1])).charAt(j.length-1)==" "&&(j=j.substr(0,j.length-1)+"0"),m+=j+v[2]+"/"+v[3],(j=Be(L[2],p)).length<v[4].length&&(j=bt(v[4].substr(v[4].length-j.length))+j),m+=j;if(v=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(Math.max(v[1].length,v[4].length),7),k+((L=we(M,Math.pow(10,p)-1,!0))[0]||(L[1]?"":"0"))+" "+(L[1]?Pe(L[1],p)+v[2]+"/"+v[3]+Be(L[2],p):Ye(" ",2*p+1+v[2].length+v[3].length));if(v=c.match(/^[#0?]+$/))return m=A(u,0),c.length<=m.length?m:bt(c.substr(0,c.length-m.length))+m;if(v=c.match(/^([#0?]+)\.([#0]+)$/)){m=""+u.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1"),p=m.indexOf(".");var L=c.indexOf(".")-p,Q=c.length-m.length-L;return bt(c.substr(0,L)+m+c.substr(c.length-Q))}if(v=c.match(/^00,000\.([#0]*0)$/))return p=Lr(u,v[1].length),u<0?"-"+Or(a,c,-u):he((Q=u)<2147483647&&-2147483648<Q?""+(0<=Q?0|Q:Q-1|0):""+Math.floor(Q)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(W){return"00,"+(W.length<3?Xe(0,3-W.length):"")+W})+"."+Xe(p,v[1].length);switch(c){case"###,##0.00":return Or(a,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var G=he(A(M,0));return G!=="0"?k+G:"";case"###,###.00":return Or(a,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return Or(a,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+c+"|")}function sr(a,c,u){if(a.charCodeAt(0)===40&&!c.match(qe)){var f=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?sr("n",f,u):"("+sr("n",f,-u)+")"}if(c.charCodeAt(c.length-1)===44)return function(L,Q,G){for(var W=Q.length-1;Q.charCodeAt(W-1)===44;)--W;return er(L,Q.substr(0,W),G/Math.pow(10,3*(Q.length-W)))}(a,c,u);if(c.indexOf("%")!==-1)return m=a,p=u,f=(v=c).replace(Ie,""),v=v.length-f.length,er(m,f,p*Math.pow(10,2*v))+Ye("%",v);var m,v,p,w;if(c.indexOf("E")!==-1)return function L(Q,G){var W,J=Q.indexOf("E")-Q.indexOf(".")-1;if(Q.match(/^#+0.0E\+0$/)){if(G==0)return"0.0E+0";if(G<0)return"-"+L(Q,-G);var ne=Q.indexOf(".");ne===-1&&(ne=Q.indexOf("E"));var se,xe=Math.floor(Math.log(G)*Math.LOG10E)%ne;xe<0&&(xe+=ne),(W=(G/Math.pow(10,xe)).toPrecision(1+J+(ne+xe)%ne)).match(/[Ee]/)||(se=Math.floor(Math.log(G)*Math.LOG10E),W.indexOf(".")===-1?W=W.charAt(0)+"."+W.substr(1)+"E+"+(se-W.length+xe):W+="E+"+(se-xe),W=W.replace(/\+-/,"-")),W=W.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(He,Fe,Ue,ct){return Fe+Ue+ct.substr(0,(ne+xe)%ne)+"."+ct.substr(xe)+"E"})}else W=G.toExponential(J);return Q.match(/E\+00$/)&&W.match(/e[+-]\d$/)&&(W=W.substr(0,W.length-1)+"0"+W.charAt(W.length-1)),(W=Q.match(/E\-/)&&W.match(/e\+/)?W.replace(/e\+/,"e"):W).replace("e","E")}(c,u);if(c.charCodeAt(0)===36)return"$"+sr(a,c.substr(c.charAt(1)==" "?2:1),u);var S,b,T=Math.abs(u),P=u<0?"-":"";if(c.match(/^00+$/))return P+Xe(T,c.length);if(c.match(/^[#?]+$/))return(w=u===0?"":""+u).length>c.length?w:bt(c.substr(0,c.length-w.length))+w;if(S=c.match(De))return P+((M=T)===0?"":""+M)+Ye(" ",(M=S)[1].length+2+M[4].length);if(c.match(/^#+0+$/))return P+Xe(T,c.length-c.indexOf("0"));if(S=c.match($e))return w=(w=(""+u).replace(/^([^\.]+)$/,"$1."+bt(S[1])).replace(/\.$/,"."+bt(S[1]))).replace(/\.(\d*)$/,function(L,Q){return"."+Q+Ye("0",bt(S[1]).length-Q.length)}),c.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),S=c.match(/^(0*)\.(#*)$/))return P+(""+T).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,S[1].length?"0.":".");if(S=c.match(/^#{1,3},##0(\.?)$/))return P+he(""+T);if(S=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+sr(a,c,-u):he(""+u)+"."+Ye("0",S[1].length);if(S=c.match(/^#,#*,#0/))return sr(a,c.replace(/^#,#*,/,""),u);if(S=c.match(/^([0#]+)(\\?-([0#]+))+$/))return w=Ze(sr(a,c.replace(/[\\-]/g,""),u)),b=0,Ze(Ze(c.replace(/\\/g,"")).replace(/[0#]/g,function(L){return b<w.length?w.charAt(b++):L==="0"?"0":""}));if(c.match(Ft))return"("+(w=sr(a,"##########",u)).substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var M="";if(S=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(S[4].length,7),k=we(T,Math.pow(10,b)-1,!1),w=P,(M=er("n",S[1],k[1])).charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),w+=M+S[2]+"/"+S[3],(M=Be(k[2],b)).length<S[4].length&&(M=bt(S[4].substr(S[4].length-M.length))+M),w+=M;if(S=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(S[1].length,S[4].length),7),P+((k=we(T,Math.pow(10,b)-1,!0))[0]||(k[1]?"":"0"))+" "+(k[1]?Pe(k[1],b)+S[2]+"/"+S[3]+Be(k[2],b):Ye(" ",2*b+1+S[2].length+S[3].length));if(S=c.match(/^[#0?]+$/))return w=""+u,c.length<=w.length?w:bt(c.substr(0,c.length-w.length))+w;if(S=c.match(/^([#0]+)\.([#0]+)$/)){w=""+u.toFixed(Math.min(S[2].length,10)).replace(/([^0])0+$/,"$1"),b=w.indexOf(".");var M=c.indexOf(".")-b,k=c.length-w.length-M;return bt(c.substr(0,M)+w+c.substr(c.length-k))}if(S=c.match(/^00,000\.([#0]*0)$/))return u<0?"-"+sr(a,c,-u):he(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(L){return"00,"+(L.length<3?Xe(0,3-L.length):"")+L})+"."+Xe(0,S[1].length);switch(c){case"###,###":case"##,###":case"#,###":var j=he(""+T);return j!=="0"?P+j:"";default:if(c.match(/\.[0#?]*$/))return sr(a,c.slice(0,c.lastIndexOf(".")),u)+bt(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}function er(a,c,u){return((0|u)===u?sr:Or)(a,c,u)}var Hn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Si(a){for(var c=0,u="",f="";c<a.length;)switch(u=a.charAt(c)){case"G":O(a,c)&&(c+=6),c++;break;case'"':for(;a.charCodeAt(++c)!==34&&c<a.length;);++c;break;case"\\":case"_":c+=2;break;case"@":++c;break;case"B":case"b":if(a.charAt(c+1)==="1"||a.charAt(c+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(a.substr(c,3).toUpperCase()==="A/P"||a.substr(c,5).toUpperCase()==="AM/PM"||a.substr(c,5).toUpperCase()==="/")return!0;++c;break;case"[":for(f=u;a.charAt(c++)!=="]"&&c<a.length;)f+=a.charAt(c);if(f.match(Hn))return!0;break;case".":case"0":case"#":for(;c<a.length&&(-1<"0#?.,E+-%".indexOf(u=a.charAt(++c))||u=="\\"&&a.charAt(c+1)=="-"&&-1<"0#".indexOf(a.charAt(c+2))););break;case"?":for(;a.charAt(++c)===u;);break;case"*":++c,a.charAt(c)!=" "&&a.charAt(c)!="*"||++c;break;case"(":case")":++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;c<a.length&&-1<"0123456789".indexOf(a.charAt(++c)););break;case" ":default:++c}return!1}function et(a,c,u,f){for(var m,v,p,w=[],S="",b=0,T="",P="t",M="H";b<a.length;)switch(T=a.charAt(b)){case"G":if(!O(a,b))throw new Error("unrecognized character "+T+" in "+a);w[w.length]={t:"G",v:"General"},b+=7;break;case'"':for(S="";(p=a.charCodeAt(++b))!==34&&b<a.length;)S+=String.fromCharCode(p);w[w.length]={t:"t",v:S},++b;break;case"\\":var k=a.charAt(++b),j=k==="("||k===")"?k:"t";w[w.length]={t:j,v:k},++b;break;case"_":w[w.length]={t:"t",v:" "},b+=2;break;case"@":w[w.length]={t:"T",v:c},++b;break;case"B":case"b":if(a.charAt(b+1)==="1"||a.charAt(b+1)==="2"){if(m==null&&(m=Ce(c,u,a.charAt(b+1)==="2"))==null)return"";w[w.length]={t:"X",v:a.substr(b,2)},P=T,b+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(c<0||m==null&&(m=Ce(c,u))==null)return"";for(S=T;++b<a.length&&a.charAt(b).toLowerCase()===T;)S+=T;(T=T==="m"&&P.toLowerCase()==="h"?"M":T)==="h"&&(T=M),w[w.length]={t:T,v:S},P=T;break;case"A":case"a":case"":if(k={t:T,v:T},m==null&&(m=Ce(c,u)),a.substr(b,3).toUpperCase()==="A/P"?(m!=null&&(k.v=12<=m.H?"P":"A"),k.t="T",M="h",b+=3):a.substr(b,5).toUpperCase()==="AM/PM"?(m!=null&&(k.v=12<=m.H?"PM":"AM"),k.t="T",b+=5,M="h"):a.substr(b,5).toUpperCase()==="/"?(m!=null&&(k.v=12<=m.H?"":""),k.t="T",b+=5,M="h"):(k.t="t",++b),m==null&&k.t==="T")return"";w[w.length]=k,P=T;break;case"[":for(S=T;a.charAt(b++)!=="]"&&b<a.length;)S+=a.charAt(b);if(S.slice(-1)!=="]")throw'unterminated "[" block: |'+S+"|";if(S.match(Hn)){if(m==null&&(m=Ce(c,u))==null)return"";w[w.length]={t:"Z",v:S.toLowerCase()},P=S.charAt(1)}else-1<S.indexOf("$")&&(S=(S.match(/\$([^-\[\]]*)/)||[])[1]||"$",Si(a)||(w[w.length]={t:"t",v:S}));break;case".":if(m!=null){for(S=T;++b<a.length&&(T=a.charAt(b))==="0";)S+=T;w[w.length]={t:"s",v:S};break}case"0":case"#":for(S=T;++b<a.length&&-1<"0#?.,E+-%".indexOf(T=a.charAt(b));)S+=T;w[w.length]={t:"n",v:S};break;case"?":for(S=T;a.charAt(++b)===T;)S+=T;w[w.length]={t:T,v:S},P=T;break;case"*":++b,a.charAt(b)!=" "&&a.charAt(b)!="*"||++b;break;case"(":case")":w[w.length]={t:f===1?"t":T,v:T},++b;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(S=T;b<a.length&&-1<"0123456789".indexOf(a.charAt(++b));)S+=a.charAt(b);w[w.length]={t:"D",v:S};break;case" ":w[w.length]={t:T,v:T},++b;break;case"$":w[w.length]={t:"t",v:"$"},++b;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+a);w[w.length]={t:"t",v:T},++b}var L,Q=0,G=0;for(b=w.length-1,P="t";0<=b;--b)switch(w[b].t){case"h":case"H":w[b].t=M,P="h",Q<1&&(Q=1);break;case"s":(L=w[b].v.match(/\.0+$/))&&(G=Math.max(G,L[0].length-1)),Q<3&&(Q=3);case"d":case"y":case"M":case"e":P=w[b].t;break;case"m":P==="s"&&(w[b].t="M",Q<2&&(Q=2));break;case"X":break;case"Z":(Q=(Q=Q<1&&w[b].v.match(/[Hh]/)?1:Q)<2&&w[b].v.match(/[Mm]/)?2:Q)<3&&w[b].v.match(/[Ss]/)&&(Q=3)}switch(Q){case 0:break;case 1:.5<=m.u&&(m.u=0,++m.S),60<=m.S&&(m.S=0,++m.M),60<=m.M&&(m.M=0,++m.H);break;case 2:.5<=m.u&&(m.u=0,++m.S),60<=m.S&&(m.S=0,++m.M)}var W,J="";for(b=0;b<w.length;++b)switch(w[b].t){case"t":case"T":case" ":case"D":break;case"X":w[b].v="",w[b].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":w[b].v=function(ct,ut,Ke,St){var Wt,$t="",Ot=0,Pt=0,_t=Ke.y,mt=0;switch(ct){case 98:_t=Ke.y+543;case 121:switch(ut.length){case 1:case 2:Wt=_t%100,mt=2;break;default:Wt=_t%1e4,mt=4}break;case 109:switch(ut.length){case 1:case 2:Wt=Ke.m,mt=ut.length;break;case 3:return H[Ke.m-1][1];case 5:return H[Ke.m-1][0];default:return H[Ke.m-1][2]}break;case 100:switch(ut.length){case 1:case 2:Wt=Ke.d,mt=ut.length;break;case 3:return N[Ke.q][0];default:return N[Ke.q][1]}break;case 104:switch(ut.length){case 1:case 2:Wt=1+(Ke.H+11)%12,mt=ut.length;break;default:throw"bad hour format: "+ut}break;case 72:switch(ut.length){case 1:case 2:Wt=Ke.H,mt=ut.length;break;default:throw"bad hour format: "+ut}break;case 77:switch(ut.length){case 1:case 2:Wt=Ke.M,mt=ut.length;break;default:throw"bad minute format: "+ut}break;case 115:if(ut!="s"&&ut!="ss"&&ut!=".0"&&ut!=".00"&&ut!=".000")throw"bad second format: "+ut;return Ke.u!==0||ut!="s"&&ut!="ss"?(60*(Pt=2<=St?St===3?1e3:100:St===1?10:1)<=(Ot=Math.round(Pt*(Ke.S+Ke.u)))&&(Ot=0),ut==="s"?Ot===0?"0":""+Ot/Pt:($t=Xe(Ot,2+St),ut==="ss"?$t.substr(0,2):"."+$t.substr(2,ut.length-1))):Xe(Ke.S,ut.length);case 90:switch(ut){case"[h]":case"[hh]":Wt=24*Ke.D+Ke.H;break;case"[m]":case"[mm]":Wt=60*(24*Ke.D+Ke.H)+Ke.M;break;case"[s]":case"[ss]":Wt=60*(60*(24*Ke.D+Ke.H)+Ke.M)+Math.round(Ke.S+Ke.u);break;default:throw"bad abstime format: "+ut}mt=ut.length===3?1:2;break;case 101:Wt=_t,mt=1}return 0<mt?Xe(Wt,mt):""}(w[b].t.charCodeAt(0),w[b].v,m,G),w[b].t="t";break;case"n":case"?":for(W=b+1;w[W]!=null&&((T=w[W].t)==="?"||T==="D"||(T===" "||T==="t")&&w[W+1]!=null&&(w[W+1].t==="?"||w[W+1].t==="t"&&w[W+1].v==="/")||w[b].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(w[W].v==="/"||w[W].v===" "&&w[W+1]!=null&&w[W+1].t=="?"));)w[b].v+=w[W].v,w[W]={v:"",t:";"},++W;J+=w[b].v,b=W-1;break;case"G":w[b].t="t",w[b].v=Oe(c,u)}var ne,se,xe="";if(0<J.length){J.charCodeAt(0)==40?(ne=c<0&&J.charCodeAt(0)===45?-c:c,se=er("n",J,ne)):(se=er("n",J,ne=c<0&&1<f?-c:c),ne<0&&w[0]&&w[0].t=="t"&&(se=se.substr(1),w[0].v="-"+w[0].v)),W=se.length-1;for(var He=w.length,b=0;b<w.length;++b)if(w[b]!=null&&w[b].t!="t"&&-1<w[b].v.indexOf(".")){He=b;break}var Fe=w.length;if(He===w.length&&se.indexOf("E")===-1){for(b=w.length-1;0<=b;--b)w[b]!=null&&"n?".indexOf(w[b].t)!==-1&&(W>=w[b].v.length-1?(W-=w[b].v.length,w[b].v=se.substr(W+1,w[b].v.length)):W<0?w[b].v="":(w[b].v=se.substr(0,W+1),W=-1),w[b].t="t",Fe=b);0<=W&&Fe<w.length&&(w[Fe].v=se.substr(0,W+1)+w[Fe].v)}else if(He!==w.length&&se.indexOf("E")===-1){for(W=se.indexOf(".")-1,b=He;0<=b;--b)if(w[b]!=null&&"n?".indexOf(w[b].t)!==-1){for(v=-1<w[b].v.indexOf(".")&&b===He?w[b].v.indexOf(".")-1:w[b].v.length-1,xe=w[b].v.substr(v+1);0<=v;--v)0<=W&&(w[b].v.charAt(v)==="0"||w[b].v.charAt(v)==="#")&&(xe=se.charAt(W--)+xe);w[b].v=xe,w[b].t="t",Fe=b}for(0<=W&&Fe<w.length&&(w[Fe].v=se.substr(0,W+1)+w[Fe].v),W=se.indexOf(".")+1,b=He;b<w.length;++b)if(w[b]!=null&&("n?(".indexOf(w[b].t)!==-1||b===He)){for(v=-1<w[b].v.indexOf(".")&&b===He?w[b].v.indexOf(".")+1:0,xe=w[b].v.substr(0,v);v<w[b].v.length;++v)W<se.length&&(xe+=se.charAt(W++));w[b].v=xe,w[b].t="t",Fe=b}}}for(b=0;b<w.length;++b)w[b]!=null&&-1<"n?".indexOf(w[b].t)&&(ne=1<f&&c<0&&0<b&&w[b-1].v==="-"?-c:c,w[b].v=er(w[b].t,w[b].v,ne),w[b].t="t");var Ue="";for(b=0;b!==w.length;++b)w[b]!=null&&(Ue+=w[b].v);return Ue}var ot=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ft(a,c){if(c!=null){var u=parseFloat(c[2]);switch(c[1]){case"=":if(a==u)return 1;break;case">":if(u<a)return 1;break;case"<":if(a<u)return 1;break;case"<>":if(a!=u)return 1;break;case">=":if(u<=a)return 1;break;case"<=":if(a<=u)return 1}}}function Nt(a,c){var u=function(p){for(var w=[],S=!1,b=0,T=0;b<p.length;++b)switch(p.charCodeAt(b)){case 34:S=!S;break;case 95:case 42:case 92:++b;break;case 59:w[w.length]=p.substr(T,b-T),T=b+1}if(w[w.length]=p.substr(T),S===!0)throw new Error("Format |"+p+"| unterminated string ");return w}(a),f=u.length,m=u[f-1].indexOf("@");if(f<4&&-1<m&&--f,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof c!="number")return[4,u.length===4||-1<m?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<m?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<m?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<m?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var v=0<c?u[0]:c<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[f,v]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[f,v]:(a=u[0].match(ot),v=u[1].match(ot),ft(c,a)?[f,u[0]]:ft(c,v)?[f,u[1]]:[f,u[a!=null&&v!=null?2:1]])}function vr(a,c,u){u==null&&(u={});var f="";switch(typeof a){case"string":f=a=="m/d/yy"&&u.dateNF?u.dateNF:a;break;case"number":(f=(f=a==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:B)[a])==null?u.table&&u.table[K[a]]||B[K[a]]:f)==null&&(f=Z[a]||"General")}if(O(f,0))return Oe(c,u);var m=Nt(f,c=c instanceof Date?ve(c,u.date1904):c);if(O(m[1]))return Oe(c,u);if(c===!0)c="TRUE";else if(c===!1)c="FALSE";else if(c===""||c==null)return"";return et(m[1],c,u,m[0])}function cr(a,c){if(typeof c!="number"){c=+c||-1;for(var u=0;u<392;++u)if(B[u]!=null){if(B[u]==a){c=u;break}}else c<0&&(c=u);c<0&&(c=391)}return B[c]=a,c}function Tr(a){for(var c=0;c!=392;++c)a[c]!==void 0&&cr(a[c],c)}function li(){var a;(a=a||{})[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',B=a}var ho={format:vr,load:cr,_table:B,load_table:Tr,parse_date_code:Ce,is_date:Si,get_table:function(){return ho._table=B}},Ju={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},rm=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,fo,gf=function(){var a={};a.version="1.2.0";var c=function(){for(var W=0,J=new Array(256),ne=0;ne!=256;++ne)W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=ne)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1,J[ne]=W;return typeof Int32Array<"u"?new Int32Array(J):J}(),u=function(W){for(var J=0,ne=0,xe=0,se=new(typeof Int32Array<"u"?Int32Array:Array)(4096),xe=0;xe!=256;++xe)se[xe]=W[xe];for(xe=0;xe!=256;++xe)for(ne=W[xe],J=256+xe;J<4096;J+=256)ne=se[J]=ne>>>8^W[255&ne];var He=[];for(xe=1;xe!=16;++xe)He[xe-1]=typeof Int32Array<"u"?se.subarray(256*xe,256*xe+256):se.slice(256*xe,256*xe+256);return He}(c),f=u[0],m=u[1],v=u[2],p=u[3],w=u[4],S=u[5],b=u[6],T=u[7],P=u[8],M=u[9],k=u[10],j=u[11],L=u[12],Q=u[13],G=u[14];return a.table=c,a.bstr=function(W,J){for(var ne=-1^J,se=0,xe=W.length;se<xe;)ne=ne>>>8^c[255&(ne^W.charCodeAt(se++))];return~ne},a.buf=function(W,J){for(var ne=-1^J,se=W.length-15,xe=0;xe<se;)ne=G[W[xe++]^255&ne]^Q[W[xe++]^ne>>8&255]^L[W[xe++]^ne>>16&255]^j[W[xe++]^ne>>>24]^k[W[xe++]]^M[W[xe++]]^P[W[xe++]]^T[W[xe++]]^b[W[xe++]]^S[W[xe++]]^w[W[xe++]]^p[W[xe++]]^v[W[xe++]]^m[W[xe++]]^f[W[xe++]]^c[W[xe++]];for(se+=15;xe<se;)ne=ne>>>8^c[255&(ne^W[xe++])];return~ne},a.str=function(W,J){for(var ne,se=-1^J,xe=0,He=W.length,Fe=0;xe<He;)se=(Fe=W.charCodeAt(xe++))<128?se>>>8^c[255&(se^Fe)]:Fe<2048?(se=se>>>8^c[255&(se^(192|Fe>>6&31))])>>>8^c[255&(se^(128|63&Fe))]:55296<=Fe&&Fe<57344?(Fe=64+(1023&Fe),ne=1023&W.charCodeAt(xe++),(se=(se=(se=se>>>8^c[255&(se^(240|Fe>>8&7))])>>>8^c[255&(se^(128|Fe>>2&63))])>>>8^c[255&(se^(128|ne>>6&15|(3&Fe)<<4))])>>>8^c[255&(se^(128|63&ne))]):(se=(se=se>>>8^c[255&(se^(224|Fe>>12&15))])>>>8^c[255&(se^(128|Fe>>6&63))])>>>8^c[255&(se^(128|63&Fe))];return~se},a}(),wr=function(){var a,c={};function u(fe){if(fe.charAt(fe.length-1)=="/")return fe.slice(0,-1).indexOf("/")===-1?fe:u(fe.slice(0,-1));var Je=fe.lastIndexOf("/");return Je===-1?fe:fe.slice(0,Je+1)}function f(fe){if(fe.charAt(fe.length-1)=="/")return f(fe.slice(0,-1));var Je=fe.lastIndexOf("/");return Je===-1?fe:fe.slice(Je+1)}function m(fe){Xs(fe,0);for(var Je,be={};fe.l<=fe.length-4;){var ze=fe.read_shift(2),Se=fe.read_shift(2),vt=fe.l+Se,Ge={};ze===21589&&(1&(Je=fe.read_shift(1))&&(Ge.mtime=fe.read_shift(4)),5<Se&&(2&Je&&(Ge.atime=fe.read_shift(4)),4&Je&&(Ge.ctime=fe.read_shift(4))),Ge.mtime&&(Ge.mt=new Date(1e3*Ge.mtime))),fe.l=vt,be[ze]=Ge}return be}function v(){return a=a||v4}function p(fe,Je){if(fe[0]==80&&fe[1]==75)return Tn(fe,Je);if((32|fe[0])==109&&(32|fe[1])==105)return function(Tt,mr){if(W(Tt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Xt=mr&&mr.root||"",It=(X&&Buffer.isBuffer(Tt)?Tt.toString("binary"):W(Tt)).split(`\r
`),xr=0,Er="";for(xr=0;xr<It.length;++xr)if(Er=It[xr],/^Content-Location:/i.test(Er)&&(Er=Er.slice(Er.indexOf("file")),Xt=Xt||Er.slice(0,Er.lastIndexOf("/")+1),Er.slice(0,Xt.length)!=Xt))for(;0<Xt.length&&(Xt=(Xt=Xt.slice(0,Xt.length-1)).slice(0,Xt.lastIndexOf("/")+1),Er.slice(0,Xt.length)!=Xt););if(Tt=(It[1]||"").match(/boundary="(.*?)"/),!Tt)throw new Error("MAD cannot find boundary");var ti="--"+(Tt[1]||""),Pr={FileIndex:[],FullPaths:[]};S(Pr);var Wr,hr=0;for(xr=0;xr<It.length;++xr){var nn=It[xr];nn!==ti&&nn!==ti+"--"||(hr++&&function(an,jt,rr){for(var Qt,Yr="",xn="",Es="",Ns=0;Ns<10;++Ns){var cs=jt[Ns];if(!cs||cs.match(/^\s*$/))break;var Co=cs.match(/^(.*?):\s*([^\s].*)$/);if(Co)switch(Co[1].toLowerCase()){case"content-location":Yr=Co[2].trim();break;case"content-type":Es=Co[2].trim();break;case"content-transfer-encoding":xn=Co[2].trim()}}switch(++Ns,xn.toLowerCase()){case"base64":Qt=me(U(jt.slice(Ns).join("")));break;case"quoted-printable":Qt=function(So){for(var n0=[],Vo=0;Vo<So.length;++Vo){for(var sh=So[Vo];Vo<=So.length&&sh.charAt(sh.length-1)=="=";)sh=sh.slice(0,sh.length-1)+So[++Vo];n0.push(sh)}for(var i0=0;i0<n0.length;++i0)n0[i0]=n0[i0].replace(/[=][0-9A-Fa-f]{2}/g,function(Qie){return String.fromCharCode(parseInt(Qie.slice(1),16))});return me(n0.join(`\r
`))}(jt.slice(Ns));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xn)}rr=vl(an,Yr.slice(rr.length),Qt,{unsafe:!0}),Es&&(rr.ctype=Es)}(Pr,It.slice(Wr,xr),Xt),Wr=xr)}return Pr}(fe,Je);if(fe.length<512)throw new Error("CFB file size "+fe.length+" < 512");var be,ze,Se,vt=3,Ge=512,Mt=0,tt=[],je=fe.slice(0,512);Xs(je,0);var lt=function(Tt){if(Tt[Tt.l]==80&&Tt[Tt.l+1]==75)return[0,0];Tt.chk(j,"Header Signature: "),Tt.l+=16;var mr=Tt.read_shift(2,"u");return[Tt.read_shift(2,"u"),mr]}(je);switch(vt=lt[0]){case 3:Ge=512;break;case 4:Ge=4096;break;case 0:if(lt[1]==0)return Tn(fe,Je);default:throw new Error("Major Version: Expected 3 or 4 saw "+vt)}Ge!==512&&Xs(je=fe.slice(0,Ge),28);var Et=fe.slice(0,Ge);(function(Tt,mr){var Xt=9;switch(Tt.l+=2,Xt=Tt.read_shift(2)){case 9:if(mr!=3)throw new Error("Sector Shift: Expected 9 saw "+Xt);break;case 12:if(mr!=4)throw new Error("Sector Shift: Expected 12 saw "+Xt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Xt)}Tt.chk("0600","Mini Sector Shift: "),Tt.chk("000000000000","Reserved: ")})(je,vt);var fr=je.read_shift(4,"i");if(vt===3&&fr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+fr);je.l+=4,ze=je.read_shift(4,"i"),je.l+=4,je.chk("00100000","Mini Stream Cutoff Size: "),Se=je.read_shift(4,"i"),be=je.read_shift(4,"i"),dr=je.read_shift(4,"i"),Mt=je.read_shift(4,"i");for(var ur,Jt=0;Jt<109&&!((ur=je.read_shift(4,"i"))<0);++Jt)tt[Jt]=ur;var Bt=function(Tt,mr){for(var Xt=Math.ceil(Tt.length/mr)-1,It=[],xr=1;xr<Xt;++xr)It[xr-1]=Tt.slice(xr*mr,(xr+1)*mr);return It[Xt-1]=Tt.slice(Xt*mr),It}(fe,Ge);(function Tt(mr,Xt,It,xr,Er){var ti=k;if(mr===k){if(Xt!==0)throw new Error("DIFAT chain shorter than expected")}else if(mr!==-1){var Pr=It[mr],Wr=(xr>>>2)-1;if(Pr){for(var hr=0;hr<Wr&&(ti=Ud(Pr,4*hr))!==k;++hr)Er.push(ti);Tt(Ud(Pr,xr-4),Xt-1,It,xr,Er)}}})(dr,Mt,Bt,Ge,tt);var tr=function(Tt,mr,Xt,It){var xr=Tt.length,Er=[],ti=[],Pr=[],Wr=[],hr=It-1,nn=0,an=0,jt=0,rr=0;for(nn=0;nn<xr;++nn)if(Pr=[],xr<=(jt=nn+mr)&&(jt-=xr),!ti[jt]){Wr=[];var Qt=[];for(an=jt;0<=an;){Qt[an]=!0,ti[an]=!0,Pr[Pr.length]=an,Wr.push(Tt[an]);var Yr=Xt[Math.floor(4*an/It)];if(It<4+(rr=4*an&hr))throw new Error("FAT boundary crossed: "+an+" 4 "+It);if(!Tt[Yr]||(an=Ud(Tt[Yr],rr),Qt[an]))break}Er[jt]={nodes:Pr,data:A5([Wr])}}return Er}(Bt,ze,tt,Ge);tr[ze].name="!Directory",0<be&&Se!==k&&(tr[Se].name="!MiniFAT"),tr[tt[0]].name="!FAT",tr.fat_addrs=tt,tr.ssz=Ge;var fr=[],dr=[],Mt=[];return function(Tt,mr,Xt,It,xr,Er,ti){for(var Pr,Wr=0,hr=Xt.length?2:0,nn=Tt[ze].data,an=0,jt=0;an<nn.length;an+=128){var rr=nn.slice(an,an+128);Xs(rr,64),jt=rr.read_shift(2),Pr=bS(rr,0,jt-hr),Xt.push(Pr);var Qt={name:Pr,type:rr.read_shift(1),color:rr.read_shift(1),L:rr.read_shift(4,"i"),R:rr.read_shift(4,"i"),C:rr.read_shift(4,"i"),clsid:rr.read_shift(16),state:rr.read_shift(4,"i"),start:0,size:0};rr.read_shift(2)+rr.read_shift(2)+rr.read_shift(2)+rr.read_shift(2)!==0&&(Qt.ct=w(rr,rr.l-8)),rr.read_shift(2)+rr.read_shift(2)+rr.read_shift(2)+rr.read_shift(2)!==0&&(Qt.mt=w(rr,rr.l-8)),Qt.start=rr.read_shift(4,"i"),Qt.size=rr.read_shift(4,"i"),Qt.size<0&&Qt.start<0&&(Qt.size=Qt.type=0,Qt.start=k,Qt.name=""),Qt.type===5?(Wr=Qt.start,0<It&&Wr!==k&&(Tt[Wr].name="!StreamData")):4096<=Qt.size?(Qt.storage="fat",Tt[Qt.start]===void 0&&(Tt[Qt.start]=function(Yr,xn,Es,Ns,cs){var Co=[],So=[];cs=cs||[];var n0=Ns-1,Vo=0,sh=0;for(Vo=xn;0<=Vo;){cs[Vo]=!0,Co[Co.length]=Vo,So.push(Yr[Vo]);var i0=Es[Math.floor(4*Vo/Ns)];if(Ns<4+(sh=4*Vo&n0))throw new Error("FAT boundary crossed: "+Vo+" 4 "+Ns);if(!Yr[i0])break;Vo=Ud(Yr[i0],sh)}return{nodes:Co,data:A5([So])}}(mr,Qt.start,Tt.fat_addrs,Tt.ssz)),Tt[Qt.start].name=Qt.name,Qt.content=Tt[Qt.start].data.slice(0,Qt.size)):(Qt.storage="minifat",Qt.size<0?Qt.size=0:Wr!==k&&Qt.start!==k&&Tt[Wr]&&(Qt.content=function(Yr,xn,Es){for(var Ns=Yr.start,cs=Yr.size,Co=[],So=Ns;Es&&0<cs&&0<=So;)Co.push(xn.slice(So*M,So*M+M)),cs-=M,So=Ud(Es,4*So);return Co.length===0?it(0):ke(Co).slice(0,Yr.size)}(Qt,Tt[Wr].data,(Tt[ti]||{}).data))),Qt.content&&Xs(Qt.content,0),xr[Pr]=Qt,Er.push(Qt)}}(tr,Bt,fr,be,{},dr,Se),function(Tt,mr,Xt){for(var It=0,xr=0,Er=0,ti=0,Pr=0,Wr=Xt.length,hr=[],nn=[];It<Wr;++It)hr[It]=nn[It]=It,mr[It]=Xt[It];for(;Pr<nn.length;++Pr)It=nn[Pr],xr=Tt[It].L,Er=Tt[It].R,ti=Tt[It].C,hr[It]===It&&(xr!==-1&&hr[xr]!==xr&&(hr[It]=hr[xr]),Er!==-1&&hr[Er]!==Er&&(hr[It]=hr[Er])),ti!==-1&&(hr[ti]=It),xr!==-1&&It!=hr[It]&&(hr[xr]=hr[It],nn.lastIndexOf(xr)<Pr&&nn.push(xr)),Er!==-1&&It!=hr[It]&&(hr[Er]=hr[It],nn.lastIndexOf(Er)<Pr&&nn.push(Er));for(It=1;It<Wr;++It)hr[It]===It&&(Er!==-1&&hr[Er]!==Er?hr[It]=hr[Er]:xr!==-1&&hr[xr]!==xr&&(hr[It]=hr[xr]));for(It=1;It<Wr;++It)if(Tt[It].type!==0){if((Pr=It)!=hr[Pr])for(;Pr=hr[Pr],mr[It]=mr[Pr]+"/"+mr[It],Pr!==0&&hr[Pr]!==-1&&Pr!=hr[Pr];);hr[It]=-1}for(mr[0]+="/",It=1;It<Wr;++It)Tt[It].type!==2&&(mr[It]+="/")}(dr,Mt,fr),fr.shift(),Mt={FileIndex:dr,FullPaths:Mt},Je&&Je.raw&&(Mt.raw={header:Et,sectors:Bt}),Mt}function w(fe,Je){return new Date(1e3*(Ms(fe,Je+4)/1e7*Math.pow(2,32)+Ms(fe,Je)/1e7-11644473600))}function S(fe,ze){var be=ze||{},ze=be.root||"Root Entry";if(fe.FullPaths||(fe.FullPaths=[]),fe.FileIndex||(fe.FileIndex=[]),fe.FullPaths.length!==fe.FileIndex.length)throw new Error("inconsistent CFB structure");fe.FullPaths.length===0&&(fe.FullPaths[0]=ze+"/",fe.FileIndex[0]={name:ze,type:5}),be.CLSID&&(fe.FileIndex[0].clsid=be.CLSID),ze=fe,be="Sh33tJ5",wr.find(ze,"/"+be)||((fe=it(4))[0]=55,fe[1]=fe[3]=50,fe[2]=54,ze.FileIndex.push({name:be,type:2,content:fe,size:4,L:69,R:69,C:69}),ze.FullPaths.push(ze.FullPaths[0]+be),b(ze))}function b(fe,Je){S(fe);for(var be=!1,ze=!1,Se=fe.FullPaths.length-1;0<=Se;--Se){var vt=fe.FileIndex[Se];switch(vt.type){case 0:ze?be=!0:(fe.FileIndex.pop(),fe.FullPaths.pop());break;case 1:case 2:case 5:ze=!0,isNaN(vt.R*vt.L*vt.C)&&(be=!0),-1<vt.R&&-1<vt.L&&vt.R==vt.L&&(be=!0);break;default:be=!0}}if(be||Je){for(var Ge=new Date(1987,1,19),tt=0,je=Object.create?Object.create(null):{},lt=[],Se=0;Se<fe.FullPaths.length;++Se)je[fe.FullPaths[Se]]=!0,fe.FileIndex[Se].type!==0&&lt.push([fe.FullPaths[Se],fe.FileIndex[Se]]);for(Se=0;Se<lt.length;++Se){var Et=u(lt[Se][0]);(ze=je[Et])||(lt.push([Et,{name:f(Et).replace("/",""),type:1,clsid:Q,ct:Ge,mt:Ge,content:null}]),je[Et]=!0)}for(lt.sort(function(Bt,tr){return function(fr,dr){for(var Mt,Tt=fr.split("/"),mr=dr.split("/"),Xt=0,It=Math.min(Tt.length,mr.length);Xt<It;++Xt){if(Mt=Tt[Xt].length-mr[Xt].length)return Mt;if(Tt[Xt]!=mr[Xt])return Tt[Xt]<mr[Xt]?-1:1}return Tt.length-mr.length}(Bt[0],tr[0])}),fe.FullPaths=[],fe.FileIndex=[],Se=0;Se<lt.length;++Se)fe.FullPaths[Se]=lt[Se][0],fe.FileIndex[Se]=lt[Se][1];for(Se=0;Se<lt.length;++Se){var ur=fe.FileIndex[Se],Jt=fe.FullPaths[Se];if(ur.name=f(Jt).replace("/",""),ur.L=ur.R=ur.C=-(ur.color=1),ur.size=ur.content?ur.content.length:0,ur.start=0,ur.clsid=ur.clsid||Q,Se===0)ur.C=1<lt.length?1:-1,ur.size=0,ur.type=5;else if(Jt.slice(-1)=="/"){for(tt=Se+1;tt<lt.length&&u(fe.FullPaths[tt])!=Jt;++tt);for(ur.C=tt>=lt.length?-1:tt,tt=Se+1;tt<lt.length&&u(fe.FullPaths[tt])!=u(Jt);++tt);ur.R=tt>=lt.length?-1:tt,ur.type=1}else u(fe.FullPaths[Se+1]||"")==u(Jt)&&(ur.R=Se+1),ur.type=2}}}function T(fe,Je){var be=Je||{};if(be.fileType=="mad")return function(Jt,Bt){for(var tr=Bt||{},fr=tr.boundary||"SheetJS",dr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(fr="------="+fr).slice(2)+'"',"","",""],Mt=Jt.FullPaths[0],Tt=Mt,mr=Jt.FileIndex[0],Xt=1;Xt<Jt.FullPaths.length;++Xt)if(Tt=Jt.FullPaths[Xt].slice(Mt.length),(mr=Jt.FileIndex[Xt]).size&&mr.content&&Tt!="Sh33tJ5"){Tt=Tt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(hr){return"_x"+hr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(hr){return"_u"+hr.charCodeAt(0).toString(16)+"_"});for(var It=mr.content,xr=X&&Buffer.isBuffer(It)?It.toString("binary"):W(It),Er=0,ti=Math.min(1024,xr.length),Pr=0,Wr=0;Wr<=ti;++Wr)32<=(Pr=xr.charCodeAt(Wr))&&Pr<128&&++Er;It=4*ti/5<=Er,dr.push(fr),dr.push("Content-Location: "+(tr.root||"file:///C:/SheetJS/")+Tt),dr.push("Content-Transfer-Encoding: "+(It?"quoted-printable":"base64")),dr.push("Content-Type: "+function(jt,nn){if(jt.ctype)return jt.ctype;var an=jt.name||"",jt=an.match(/\.([^\.]+)$/);return jt&&xs[jt[1]]||nn&&(jt=(an=nn).match(/[\.\\]([^\.\\])+$/))&&xs[jt[1]]?xs[jt[1]]:"application/octet-stream"}(mr,Tt)),dr.push(""),dr.push((It?function(hr){hr=hr.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Es){return Es=Es.charCodeAt(0).toString(16).toUpperCase(),"="+(Es.length==1?"0"+Es:Es)}),(hr=hr.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(hr="=0D"+hr.slice(1)),hr=hr.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var nn=[],an=hr.split(`\r
`),jt=0;jt<an.length;++jt){var rr=an[jt];if(rr.length!=0)for(var Qt=0;Qt<rr.length;){var Yr=76,xn=rr.slice(Qt,Qt+Yr);xn.charAt(Yr-1)=="="?Yr--:xn.charAt(Yr-2)=="="?Yr-=2:xn.charAt(Yr-3)=="="&&(Yr-=3),xn=rr.slice(Qt,Qt+Yr),(Qt+=Yr)<rr.length&&(xn+="="),nn.push(xn)}else nn.push("")}return nn.join(`\r
`)}:function(hr){for(var nn=D(hr),an=[],jt=0;jt<nn.length;jt+=76)an.push(nn.slice(jt,jt+76));return an.join(`\r
`)+`\r
`})(xr))}return dr.push(fr+`--\r
`),dr.join(`\r
`)}(fe,be);if(b(fe),be.fileType==="zip")return function(Jt,tr){var tr=tr||{},fr=[],dr=[],Mt=it(1),Tt=tr.compression?8:0,mr=0,Xt=0,It=0,xr=0,Er=0,ti=Jt.FullPaths[0],Pr=ti,Wr=Jt.FileIndex[0],hr=[],nn=0;for(Xt=1;Xt<Jt.FullPaths.length;++Xt)if(Pr=Jt.FullPaths[Xt].slice(ti.length),(Wr=Jt.FileIndex[Xt]).size&&Wr.content&&Pr!="Sh33tJ5"){var an=xr,jt=it(Pr.length);for(It=0;It<Pr.length;++It)jt.write_shift(1,127&Pr.charCodeAt(It));jt=jt.slice(0,jt.l),hr[Er]=gf.buf(Wr.content,0);var rr=Wr.content;Tt==8&&(rr=function(Qt){return P?P.deflateRawSync(Qt):Kt(Qt)}(rr)),(Mt=it(30)).write_shift(4,67324752),Mt.write_shift(2,20),Mt.write_shift(2,mr),Mt.write_shift(2,Tt),Wr.mt?function(Qt,Yr){var xn=(Yr=typeof Yr=="string"?new Date(Yr):Yr).getHours();xn=(xn=xn<<6|Yr.getMinutes())<<5|Yr.getSeconds()>>>1,Qt.write_shift(2,xn),xn=(xn=(xn=Yr.getFullYear()-1980)<<4|Yr.getMonth()+1)<<5|Yr.getDate(),Qt.write_shift(2,xn)}(Mt,Wr.mt):Mt.write_shift(4,0),Mt.write_shift(-4,hr[Er]),Mt.write_shift(4,rr.length),Mt.write_shift(4,Wr.content.length),Mt.write_shift(2,jt.length),Mt.write_shift(2,0),xr+=Mt.length,fr.push(Mt),xr+=jt.length,fr.push(jt),xr+=rr.length,fr.push(rr),(Mt=it(46)).write_shift(4,33639248),Mt.write_shift(2,0),Mt.write_shift(2,20),Mt.write_shift(2,mr),Mt.write_shift(2,Tt),Mt.write_shift(4,0),Mt.write_shift(-4,hr[Er]),Mt.write_shift(4,rr.length),Mt.write_shift(4,Wr.content.length),Mt.write_shift(2,jt.length),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(4,0),Mt.write_shift(4,an),nn+=Mt.l,dr.push(Mt),nn+=jt.length,dr.push(jt),++Er}return(Mt=it(22)).write_shift(4,101010256),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,Er),Mt.write_shift(2,Er),Mt.write_shift(4,nn),Mt.write_shift(4,xr),Mt.write_shift(2,0),ke([ke(fr),ke(dr),Mt])}(fe,be);for(var ze=function(Jt){for(var Bt=0,tr=0,fr=0;fr<Jt.FileIndex.length;++fr){var dr=Jt.FileIndex[fr];dr.content&&0<(dr=dr.content.length)&&(dr<4096?Bt+=dr+63>>6:tr+=dr+511>>9)}for(var Mt=Jt.FullPaths.length+3>>2,Tt=Bt+127>>7,mr=(Bt+7>>3)+tr+Mt+Tt,Xt=mr+127>>7,It=Xt<=109?0:Math.ceil((Xt-109)/127);Xt<mr+Xt+It+127>>7;)It=++Xt<=109?0:Math.ceil((Xt-109)/127);return Mt=[1,It,Xt,Tt,Mt,tr,Bt,0],Jt.FileIndex[0].size=Bt<<6,Mt[7]=(Jt.FileIndex[0].start=Mt[0]+Mt[1]+Mt[2]+Mt[3]+Mt[4]+Mt[5])+(Mt[6]+7>>3),Mt}(fe),Se=it(ze[7]<<9),Ge=0,vt=0,Ge=0;Ge<8;++Ge)Se.write_shift(1,L[Ge]);for(Ge=0;Ge<8;++Ge)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Ge=0;Ge<3;++Ge)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,ze[2]),Se.write_shift(4,ze[0]+ze[1]+ze[2]+ze[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,ze[3]?ze[0]+ze[1]+ze[2]-1:k),Se.write_shift(4,ze[3]),Se.write_shift(-4,ze[1]?ze[0]-1:k),Se.write_shift(4,ze[1]),Ge=0;Ge<109;++Ge)Se.write_shift(-4,Ge<ze[2]?ze[1]+Ge:-1);if(ze[1])for(vt=0;vt<ze[1];++vt){for(;Ge<236+127*vt;++Ge)Se.write_shift(-4,Ge<ze[2]?ze[1]+Ge:-1);Se.write_shift(-4,vt===ze[1]-1?k:vt+1)}function tt(Jt){for(vt+=Jt;Ge<vt-1;++Ge)Se.write_shift(-4,Ge+1);Jt&&(++Ge,Se.write_shift(-4,k))}for(vt=Ge=0,vt+=ze[1];Ge<vt;++Ge)Se.write_shift(-4,G.DIFSECT);for(vt+=ze[2];Ge<vt;++Ge)Se.write_shift(-4,G.FATSECT);tt(ze[3]),tt(ze[4]);for(var je=0,lt=0,Et=fe.FileIndex[0];je<fe.FileIndex.length;++je)(Et=fe.FileIndex[je]).content&&((lt=Et.content.length)<4096||(Et.start=vt,tt(lt+511>>9)));for(tt(ze[6]+7>>3);511&Se.l;)Se.write_shift(-4,G.ENDOFCHAIN);for(je=vt=Ge=0;je<fe.FileIndex.length;++je)(Et=fe.FileIndex[je]).content&&(!(lt=Et.content.length)||4096<=lt||(Et.start=vt,tt(lt+63>>6)));for(;511&Se.l;)Se.write_shift(-4,G.ENDOFCHAIN);for(Ge=0;Ge<ze[4]<<2;++Ge){var ur=fe.FullPaths[Ge];if(ur&&ur.length!==0){if(Et=fe.FileIndex[Ge],Ge===0&&(Et.start=Et.size?Et.start-1:k),ur=Ge===0&&be.root||Et.name,lt=2*(ur.length+1),Se.write_shift(64,ur,"utf16le"),Se.write_shift(2,lt),Se.write_shift(1,Et.type),Se.write_shift(1,Et.color),Se.write_shift(-4,Et.L),Se.write_shift(-4,Et.R),Se.write_shift(-4,Et.C),Et.clsid)Se.write_shift(16,Et.clsid,"hex");else for(je=0;je<4;++je)Se.write_shift(4,0);Se.write_shift(4,Et.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Et.start),Se.write_shift(4,Et.size),Se.write_shift(4,0)}else{for(je=0;je<17;++je)Se.write_shift(4,0);for(je=0;je<3;++je)Se.write_shift(4,-1);for(je=0;je<12;++je)Se.write_shift(4,0)}}for(Ge=1;Ge<fe.FileIndex.length;++Ge)if(4096<=(Et=fe.FileIndex[Ge]).size)if(Se.l=Et.start+1<<9,X&&Buffer.isBuffer(Et.content))Et.content.copy(Se,Se.l,0,Et.size),Se.l+=Et.size+511&-512;else{for(je=0;je<Et.size;++je)Se.write_shift(1,Et.content[je]);for(;511&je;++je)Se.write_shift(1,0)}for(Ge=1;Ge<fe.FileIndex.length;++Ge)if(0<(Et=fe.FileIndex[Ge]).size&&Et.size<4096)if(X&&Buffer.isBuffer(Et.content))Et.content.copy(Se,Se.l,0,Et.size),Se.l+=Et.size+63&-64;else{for(je=0;je<Et.size;++je)Se.write_shift(1,Et.content[je]);for(;63&je;++je)Se.write_shift(1,0)}if(X)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}c.version="1.2.1";var P,M=64,k=-2,j="d0cf11e0a1b11ae1",L=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:k,FREESECT:-1,HEADER_SIGNATURE:j,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(fe){for(var Je=new Array(fe.length),be=0;be<fe.length;++be)Je[be]=String.fromCharCode(fe[be]);return Je.join("")}for(var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],xe,He=typeof Uint8Array<"u",Fe=He?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)Fe[Ue]=255&((xe=139536&((xe=Ue)<<1|xe<<11)|558144&(xe<<5|xe<<15))>>16|xe>>8|xe);function ct(fe,ze){var be=7&ze,ze=ze>>>3;return(fe[ze]|(be<=5?0:fe[1+ze]<<8))>>>be&7}function ut(fe,ze){var be=7&ze,ze=ze>>>3;return(fe[ze]|(be<=3?0:fe[1+ze]<<8))>>>be&31}function Ke(fe,ze){var be=7&ze,ze=ze>>>3;return(fe[ze]|(be<=1?0:fe[1+ze]<<8))>>>be&127}function St(fe,Ge,be){var ze=7&Ge,Se=Ge>>>3,vt=(1<<be)-1,Ge=fe[Se]>>>ze;return be<8-ze?Ge&vt:(Ge|=fe[1+Se]<<8-ze,be<16-ze?Ge&vt:(Ge|=fe[2+Se]<<16-ze,be<24-ze?Ge&vt:(Ge|=fe[3+Se]<<24-ze)&vt))}function Wt(fe,Je,be){var ze=7&Je,Se=Je>>>3;return ze<=5?fe[Se]|=(7&be)<<ze:(fe[Se]|=be<<ze&255,fe[1+Se]=(7&be)>>8-ze),Je+3}function $t(fe,Je,be){var ze=Je>>>3;return be<<=7&Je,fe[ze]|=255&be,be>>>=8,fe[1+ze]=be,Je+8}function Ot(fe,Je,be){var ze=Je>>>3;return be<<=7&Je,fe[ze]|=255&be,be>>>=8,fe[1+ze]=255&be,fe[2+ze]=be>>>8,Je+16}function Pt(fe,Je){var be=fe.length,ze=Je<2*be?2*be:Je+5,Se=0;if(Je<=be)return fe;if(X){var vt=oe(ze);if(fe.copy)fe.copy(vt);else for(;Se<fe.length;++Se)vt[Se]=fe[Se];return vt}if(He){var Ge=new Uint8Array(ze);if(Ge.set)Ge.set(fe);else for(;Se<be;++Se)Ge[Se]=fe[Se];return Ge}return fe.length=ze,fe}function _t(fe){for(var Je=new Array(fe),be=0;be<fe;++be)Je[be]=0;return Je}function mt(fe,Je,be){for(var ze,Se=1,lt=0,vt=0,Ge=0,tt=fe.length,je=He?new Uint16Array(32):_t(32),lt=0;lt<32;++lt)je[lt]=0;for(lt=tt;lt<be;++lt)fe[lt]=0;tt=fe.length;var Et=He?new Uint16Array(tt):_t(tt);for(lt=0;lt<tt;++lt)je[ze=fe[lt]]++,Se<ze&&(Se=ze),Et[lt]=0;for(je[0]=0,lt=1;lt<=Se;++lt)je[lt+16]=Ge=Ge+je[lt-1]<<1;for(lt=0;lt<tt;++lt)(Ge=fe[lt])!=0&&(Et[lt]=je[Ge+16]++);var ur,Jt,Bt,tr;for(lt=0;lt<tt;++lt)if((ur=fe[lt])!=0)for(Jt=Et[lt],Bt=Se,tr=void 0,tr=Fe[255&Jt],Ge=(Bt<=8?tr>>>8-Bt:(tr=tr<<8|Fe[Jt>>8&255],Bt<=16?tr>>>16-Bt:(tr=tr<<8|Fe[Jt>>16&255])>>>24-Bt))>>Se-ur,vt=(1<<Se+4-ur)-1;0<=vt;--vt)Je[Ge|vt<<ur]=15&ur|lt<<4;return Se}var Zt=He?new Uint16Array(512):_t(512),or=He?new Uint16Array(32):_t(32);if(!He){for(var Cr=0;Cr<512;++Cr)Zt[Cr]=0;for(Cr=0;Cr<32;++Cr)or[Cr]=0}(function(){for(var fe=[],Je=0;Je<32;Je++)fe.push(5);mt(fe,or,32);for(var be=[],Je=0;Je<=143;Je++)be.push(8);for(;Je<=255;Je++)be.push(9);for(;Je<=279;Je++)be.push(7);for(;Je<=287;Je++)be.push(8);mt(be,Zt,288)})();var Gr=function(){for(var fe=He?new Uint8Array(32768):[],Je=0,be=0;Je<se.length-1;++Je)for(;be<se[Je+1];++be)fe[be]=Je;for(;be<32768;++be)fe[be]=29;for(var ze=He?new Uint8Array(259):[],Je=0,be=0;Je<ne.length-1;++Je)for(;be<ne[Je+1];++be)ze[be]=Je;return function(Se,vt){return(Se.length<8?function(Ge,tt){for(var je=0;je<Ge.length;){var lt=Math.min(65535,Ge.length-je),Et=je+lt==Ge.length;for(tt.write_shift(1,+Et),tt.write_shift(2,lt),tt.write_shift(2,65535&~lt);0<lt--;)tt[tt.l++]=Ge[je++]}return tt.l}:function(Ge,tt){for(var je=0,lt=0,Et=He?new Uint16Array(32768):[];lt<Ge.length;){var ur=Math.min(65535,Ge.length-lt);if(ur<10){for(7&(je=Wt(tt,je,+(lt+ur==Ge.length)))&&(je+=8-(7&je)),tt.l=je/8|0,tt.write_shift(2,ur),tt.write_shift(2,65535&~ur);0<ur--;)tt[tt.l++]=Ge[lt++];je=8*tt.l}else{je=Wt(tt,je,+(lt+ur==Ge.length)+2);for(var Jt=0;0<ur--;){var Bt=Ge[lt],Jt=32767&(Jt<<5^Bt),tr=-1,fr=0;if((tr=Et[Jt])&&(lt<(tr|=-32768&lt)&&(tr-=32768),tr<lt))for(;Ge[tr+fr]==Ge[lt+fr]&&fr<250;)++fr;if(2<fr){(Bt=ze[fr])<=22?je=$t(tt,je,Fe[Bt+1]>>1)-1:($t(tt,je,3),$t(tt,je+=5,Fe[Bt-23]>>5),je+=3);var dr=Bt<8?0:Bt-4>>2;0<dr&&(Ot(tt,je,fr-ne[Bt]),je+=dr),Bt=fe[lt-tr],je=$t(tt,je,Fe[Bt]>>3),je-=3;var Mt=Bt<4?0:Bt-2>>1;0<Mt&&(Ot(tt,je,lt-tr-se[Bt]),je+=Mt);for(var Tt=0;Tt<fr;++Tt)Et[Jt]=32767&lt,Jt=32767&(Jt<<5^Ge[lt]),++lt;ur-=fr-1}else Bt<=143?Bt+=48:(dr=((dr=1)&dr)<<(7&(Mt=je)),tt[Mt>>>3]|=dr,je=Mt+1),je=$t(tt,je,Fe[Bt]),Et[Jt]=32767&lt,++lt}je=$t(tt,je,0)-1}}return tt.l=(je+7)/8|0,tt.l})(Se,vt)}}();function Kt(be){var Je=it(50+Math.floor(1.1*be.length)),be=Gr(be,Je);return Je.slice(0,be)}var Ct=He?new Uint16Array(32768):_t(32768),Dr=He?new Uint16Array(32768):_t(32768),fn=He?new Uint16Array(128):_t(128),rn=1,In=1;function Wi(fe,Je){if(fe[0]==3&&!(3&fe[1]))return[Y(Je),2];for(var be=0,ze=0,Se=oe(Je||1<<18),vt=0,Ge=Se.length>>>0,tt=0,je=0;!(1&ze);)if(ze=ct(fe,be),be+=3,ze>>>1!=0)for(je=ze>>1==1?(tt=9,5):(be=function(fr,dr){var Mt,Tt,mr,Xt=ut(fr,dr)+257,It=ut(fr,dr+=5)+1,xr=(mr=7&(Tt=dr+=5),4+(((Mt=fr)[Tt=Tt>>>3]|(mr<=4?0:Mt[1+Tt]<<8))>>>mr&15));dr+=4;for(var Er=0,ti=He?new Uint8Array(19):_t(19),Pr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Wr=1,hr=He?new Uint8Array(8):_t(8),nn=He?new Uint8Array(8):_t(8),an=ti.length,jt=0;jt<xr;++jt)ti[J[jt]]=Er=ct(fr,dr),Wr<Er&&(Wr=Er),hr[Er]++,dr+=3;var rr=0;for(hr[0]=0,jt=1;jt<=Wr;++jt)nn[jt]=rr=rr+hr[jt-1]<<1;for(jt=0;jt<an;++jt)(rr=ti[jt])!=0&&(Pr[jt]=nn[rr]++);for(var Qt,jt=0;jt<an;++jt)if((Qt=ti[jt])!=0){rr=Fe[Pr[jt]]>>8-Qt;for(var Yr=(1<<7-Qt)-1;0<=Yr;--Yr)fn[rr|Yr<<Qt]=7&Qt|jt<<3}for(var xn,Es,Ns,cs=[],Wr=1;cs.length<Xt+It;)switch(dr+=7&(rr=fn[Ke(fr,dr)]),rr>>>=3){case 16:for(Er=3+(Ns=void 0,Ns=7&(Es=dr),((xn=fr)[Es=Es>>>3]|(Ns<=6?0:xn[1+Es]<<8))>>>Ns&3),dr+=2,rr=cs[cs.length-1];0<Er--;)cs.push(rr);break;case 17:for(Er=3+ct(fr,dr),dr+=3;0<Er--;)cs.push(0);break;case 18:for(Er=11+Ke(fr,dr),dr+=7;0<Er--;)cs.push(0);break;default:cs.push(rr),Wr<rr&&(Wr=rr)}var Co=cs.slice(0,Xt),So=cs.slice(Xt);for(jt=Xt;jt<286;++jt)Co[jt]=0;for(jt=It;jt<30;++jt)So[jt]=0;return rn=mt(Co,Ct,286),In=mt(So,Dr,30),dr}(fe,be),tt=rn,In);;){!Je&&Ge<vt+32767&&(Ge=(Se=Pt(Se,vt+32767)).length);var lt=St(fe,be,tt),Et=(ze>>>1==1?Zt:Ct)[lt];if(be+=15&Et,((Et>>>=4)>>>8&255)==0)Se[vt++]=Et;else{if(Et==256)break;var ur=(Et-=257)<8?0:Et-4>>2;5<ur&&(ur=0);var Jt=vt+ne[Et];0<ur&&(Jt+=St(fe,be,ur),be+=ur),lt=St(fe,be,je),be+=15&(Et=(ze>>>1==1?or:Dr)[lt]);var lt=(Et>>>=4)<4?0:Et-2>>1,Bt=se[Et];for(0<lt&&(Bt+=St(fe,be,lt),be+=lt),!Je&&Ge<Jt&&(Ge=(Se=Pt(Se,Jt+100)).length);vt<Jt;)Se[vt]=Se[vt-Bt],++vt}}else{7&be&&(be+=8-(7&be));var tr=fe[be>>>3]|fe[1+(be>>>3)]<<8;if(be+=32,0<tr)for(!Je&&Ge<vt+tr&&(Ge=(Se=Pt(Se,vt+tr)).length);0<tr--;)Se[vt++]=fe[be>>>3],be+=8}return Je?[Se,be+7>>>3]:[Se.slice(0,vt),be+7>>>3]}function _e(fe,Je){return Je=Wi(fe.slice(fe.l||0),Je),fe.l+=Je[1],Je[0]}function Pn(fe,Je){if(!fe)throw new Error(Je);typeof console<"u"&&console.error(Je)}function Tn(fe,Je){var be=fe;Xs(be,0);var ze={FileIndex:[],FullPaths:[]};S(ze,{root:Je.root});for(var Se=be.length-4;(be[Se]!=80||be[Se+1]!=75||be[Se+2]!=5||be[Se+3]!=6)&&0<=Se;)--Se;be.l=Se+4,be.l+=4;var vt=be.read_shift(2);for(be.l+=6,Je=be.read_shift(4),be.l=Je,Se=0;Se<vt;++Se){be.l+=20;var Ge=be.read_shift(4),tt=be.read_shift(4),je=be.read_shift(2),lt=be.read_shift(2),Et=be.read_shift(2);be.l+=8;var ur=be.read_shift(4),Jt=m(be.slice(be.l+je,be.l+je+lt));be.l+=je+lt+Et,Et=be.l,be.l=ur+4,function(Bt,tr,fr,dr,Mt){Bt.l+=2;var Tt=Bt.read_shift(2),mr=Bt.read_shift(2),Xt=function(xn){var jt=65535&xn.read_shift(2),rr=65535&xn.read_shift(2),Qt=new Date,Yr=31&rr,xn=15&(rr>>>=5);return rr>>>=4,Qt.setMilliseconds(0),Qt.setFullYear(1980+rr),Qt.setMonth(xn-1),Qt.setDate(Yr),xn=31&jt,Yr=63&(jt>>>=5),jt>>>=6,Qt.setHours(jt),Qt.setMinutes(Yr),Qt.setSeconds(xn<<1),Qt}(Bt);if(8257&Tt)throw new Error("Unsupported ZIP encryption");Bt.read_shift(4);for(var It,xr=Bt.read_shift(4),Er=Bt.read_shift(4),ti=Bt.read_shift(2),Pr=Bt.read_shift(2),Wr="",hr=0;hr<ti;++hr)Wr+=String.fromCharCode(Bt[Bt.l++]);Pr&&(((It=m(Bt.slice(Bt.l,Bt.l+Pr)))[21589]||{}).mt&&(Xt=It[21589].mt),((Mt||{})[21589]||{}).mt&&(Xt=Mt[21589].mt)),Bt.l+=Pr;var nn=Bt.slice(Bt.l,Bt.l+xr);switch(mr){case 8:nn=function(an,Qt){if(!P)return _e(an,Qt);var rr=new P.InflateRaw,Qt=rr._processChunk(an.slice(an.l),rr._finishFlushFlag);return an.l+=rr.bytesRead,Qt}(Bt,Er);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+mr)}Pr=!1,8&Tt&&(Bt.read_shift(4)==134695760&&(Bt.read_shift(4),Pr=!0),xr=Bt.read_shift(4),Er=Bt.read_shift(4)),xr!=tr&&Pn(Pr,"Bad compressed size: "+tr+" != "+xr),Er!=fr&&Pn(Pr,"Bad uncompressed size: "+fr+" != "+Er),vl(dr,Wr,nn,{unsafe:!0,mt:Xt})}(be,Ge,tt,ze,Jt),be.l=Et}return ze}var xs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vl(fe,Je,be,ze){var Se=ze&&ze.unsafe;Se||S(fe);var vt,Ge=!Se&&wr.find(fe,Je);return Ge||(vt=fe.FullPaths[0],vt=Je.slice(0,vt.length)==vt?Je:(vt.slice(-1)!="/"&&(vt+="/"),(vt+Je).replace("//","/")),Ge={name:f(Je),type:2},fe.FileIndex.push(Ge),fe.FullPaths.push(vt),Se||wr.utils.cfb_gc(fe)),Ge.content=be,Ge.size=be?be.length:0,ze&&(ze.CLSID&&(Ge.clsid=ze.CLSID),ze.mt&&(Ge.mt=ze.mt),ze.ct&&(Ge.ct=ze.ct)),Ge}return c.find=function(fe,Je){var be=fe.FullPaths.map(function(je){return je.toUpperCase()}),ze=be.map(function(je){var lt=je.split("/");return lt[lt.length-(je.slice(-1)=="/"?2:1)]}),Se=!1;Je.charCodeAt(0)===47?(Se=!0,Je=be[0].slice(0,-1)+Je):Se=Je.indexOf("/")!==-1;var tt=Je.toUpperCase(),vt=(Se===!0?be:ze).indexOf(tt);if(vt!==-1)return fe.FileIndex[vt];var Ge=!tt.match(at),tt=tt.replace(nt,"");for(Ge&&(tt=tt.replace(at,"!")),vt=0;vt<be.length;++vt)if((Ge?be[vt].replace(at,"!"):be[vt]).replace(nt,"")==tt||(Ge?ze[vt].replace(at,"!"):ze[vt]).replace(nt,"")==tt)return fe.FileIndex[vt];return null},c.read=function(fe,Je){var be,ze,Se=Je&&Je.type;switch(Se||X&&Buffer.isBuffer(fe)&&(Se="buffer"),Se||"base64"){case"file":return be=fe,ze=Je,v(),p(a.readFileSync(be),ze);case"base64":return p(me(U(fe)),Je);case"binary":return p(me(fe),Je)}return p(fe,Je)},c.parse=p,c.write=function(fe,Je){var be=T(fe,Je);switch(Je&&Je.type||"buffer"){case"file":return v(),a.writeFileSync(Je.filename,be),be;case"binary":return typeof be=="string"?be:W(be);case"base64":return D(typeof be=="string"?be:W(be));case"buffer":if(X)return Buffer.isBuffer(be)?be:te(be);case"array":return typeof be=="string"?me(be):be}return be},c.writeFile=function(fe,Je,be){v(),be=T(fe,be),a.writeFileSync(Je,be)},c.utils={cfb_new:function(fe){var Je={};return S(Je,fe),Je},cfb_add:vl,cfb_del:function(fe,Je){S(fe);var be=wr.find(fe,Je);if(be){for(var ze=0;ze<fe.FileIndex.length;++ze)if(fe.FileIndex[ze]==be)return fe.FileIndex.splice(ze,1),fe.FullPaths.splice(ze,1),!0}return!1},cfb_mov:function(fe,Je,be){S(fe);var ze=wr.find(fe,Je);if(ze){for(var Se=0;Se<fe.FileIndex.length;++Se)if(fe.FileIndex[Se]==ze)return fe.FileIndex[Se].name=f(be),fe.FullPaths[Se]=be,!0}return!1},cfb_gc:function(fe){b(fe,!0)},ReadShift:K1,CheckField:I5,prep_blob:Xs,bconcat:ke,use_zlib:function(fe){try{var Je=new fe.InflateRaw;if(Je._processChunk(new Uint8Array([3,0]),Je._finishFlushFlag),!Je.bytesRead)throw new Error("zlib does not expose bytesRead");P=fe}catch(be){console.error("cannot use native zlib: "+(be.message||be))}},_deflateRaw:Kt,_inflateRaw:_e,consts:G},c}();if(typeof O2<"u")try{fo=v4}catch{}function Bi(a){return typeof a=="string"?de(a):Array.isArray(a)?function(c){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(c)}(a):a}function ua(a,c,u){if(fo!==void 0&&fo.writeFileSync)return u?fo.writeFileSync(a,c,u):fo.writeFileSync(a,c);if(typeof Deno<"u"){if(u&&typeof c=="string")switch(u){case"utf8":c=new TextEncoder(u).encode(c);break;case"binary":c=de(c);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(a,c)}var f=u=="utf8"?zc(c):c;if(typeof IE_SaveFile<"u")return IE_SaveFile(f,a);if(typeof Blob<"u"){if(f=new Blob([Bi(f)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(f,a);if(typeof saveAs<"u")return saveAs(f,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var m=URL.createObjectURL(f);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(m)},6e4),chrome.downloads.download({url:m,filename:a,saveAs:!0});if(f=document.createElement("a"),f.download!=null)return f.download=a,f.href=m,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(m)},6e4),m}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var v=File(a);return v.open("w"),v.encoding="binary",Array.isArray(c)&&(c=ye(c)),v.write(c),v.close(),c}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+a)}function ii(a){for(var c=Object.keys(a),u=[],f=0;f<c.length;++f)Object.prototype.hasOwnProperty.call(a,c[f])&&u.push(c[f]);return u}function Vd(a,c){for(var u=[],f=ii(a),m=0;m!==f.length;++m)u[a[f[m]][c]]==null&&(u[a[f[m]][c]]=f[m]);return u}function jc(a){for(var c=[],u=ii(a),f=0;f!==u.length;++f)c[a[u[f]]]=u[f];return c}function Qu(a){for(var c=[],u=ii(a),f=0;f!==u.length;++f)c[a[u[f]]]=parseInt(u[f],10);return c}var Zu=new Date(1899,11,30,0,0,0);function ci(a,c){var u=a.getTime();return(u-(Zu.getTime()+6e4*(a.getTimezoneOffset()-Zu.getTimezoneOffset())))/864e5}var Ys=new Date,mf=Zu.getTime()+6e4*(Ys.getTimezoneOffset()-Zu.getTimezoneOffset()),Wd=Ys.getTimezoneOffset();function ee(a){var c=new Date;return c.setTime(24*a*60*60*1e3+mf),c.getTimezoneOffset()!==Wd&&c.setTime(c.getTime()+6e4*(c.getTimezoneOffset()-Wd)),c}var ge=new Date("2017-02-19T19:06:09.000Z"),ae=isNaN(ge.getFullYear())?new Date("2/19/17"):ge,le=ae.getFullYear()==2017;function ue(a,c){var u=new Date(a);return le?(0<c?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):c<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):a instanceof Date?a:ae.getFullYear()==1917&&!isNaN(u.getFullYear())?(c=u.getFullYear(),-1<a.indexOf(""+c)||u.setFullYear(u.getFullYear()+100),u):(u=a.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<a.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function pe(a,c){if(X&&Buffer.isBuffer(a)){if(c){if(a[0]==255&&a[1]==254)return zc(a.slice(2).toString("utf16le"));if(a[1]==254&&a[2]==255)return zc(_(a.slice(2).toString("binary")))}return a.toString("binary")}if(typeof TextDecoder<"u")try{if(c){if(a[0]==255&&a[1]==254)return zc(new TextDecoder("utf-16le").decode(a.slice(2)));if(a[0]==254&&a[1]==255)return zc(new TextDecoder("utf-16be").decode(a.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(v){return u[v]||v})}catch{}for(var f=[],m=0;m!=a.length;++m)f.push(String.fromCharCode(a[m]));return f.join("")}function Le(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var c,u={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(u[c]=Le(a[c]));return u}function Ye(a,c){for(var u="";u.length<c;)u+=a;return u}function Ve(f){var c=Number(f);if(!isNaN(c))return isFinite(c)?c:NaN;if(!/\d/.test(f))return c;var u=1,f=f.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(c=Number(f))?(f=f.replace(/[(](.*)[)]/,function(m,v){return u=-u,v}),isNaN(c=Number(f))?c:c/u):c/u}var Ae=["january","february","march","april","may","june","july","august","september","october","november","december"];function ie(a){var c=new Date(a),u=new Date(NaN),f=c.getYear(),m=c.getMonth(),v=c.getDate();if(isNaN(v))return u;var p=a.toLowerCase();if(p.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(p=p.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&Ae.indexOf(p)==-1)return u}else if(p.match(/[a-z]/))return u;return f<0||8099<f||(!(0<m||1<v)||f==101)&&a.match(/[^-0-9:,\/\\]/)?u:c}var Ne,Qe=(Ne="abacaba".split(/(:?b)/i).length==5,function(a,c,u){if(Ne||typeof c=="string")return a.split(c);for(var f=a.split(c),m=[f[0]],v=1;v<f.length;++v)m.push(u),m.push(f[v]);return m});function xt(a){return a?a.content&&a.type?pe(a.content,!0):a.data?E(a.data):a.asNodeBuffer&&X?E(a.asNodeBuffer().toString("binary")):a.asBinary?E(a.asBinary()):a._data&&a._data.getContent?E(pe(Array.prototype.slice.call(a._data.getContent(),0))):null:null}function dt(a){if(!a)return null;if(a.data)return x(a.data);if(a.asNodeBuffer&&X)return a.asNodeBuffer();if(a._data&&a._data.getContent){var c=a._data.getContent();return typeof c=="string"?x(c):Array.prototype.slice.call(c)}return a.content&&a.type?a.content:null}function yt(a,c){for(var u=a.FullPaths||ii(a.files),f=c.toLowerCase().replace(/[\/]/g,"\\"),m=f.replace(/\\/g,"/"),v=0;v<u.length;++v){var p=u[v].replace(/^Root Entry[\/]/,"").toLowerCase();if(f==p||m==p)return a.files?a.files[u[v]]:a.FileIndex[v]}return null}function gr(a,c){if(a=yt(a,c),a==null)throw new Error("Cannot find file "+c+" in zip");return a}function _r(a,c,u){if(!u)return((u=gr(a,c))&&u.name.slice(-4)===".bin"?dt:xt)(u);if(!c)return null;try{return _r(a,c)}catch{return null}}function Vr(a,c,u){if(!u)return xt(gr(a,c));if(!c)return null;try{return Vr(a,c)}catch{return null}}function mn(a){for(var c=a.FullPaths||ii(a.files),u=[],f=0;f<c.length;++f)c[f].slice(-1)!="/"&&u.push(c[f].replace(/^Root Entry[\/]/,""));return u.sort()}function Mr(a,c,u){if(a.FullPaths){if(typeof u=="string"){var f=(X?te:function(m){for(var v=[],p=0,w=m.length+250,S=Y(m.length+255),b=0;b<m.length;++b){var T,P=m.charCodeAt(b);P<128?S[p++]=P:P<2048?(S[p++]=192|P>>6&31,S[p++]=128|63&P):55296<=P&&P<57344?(P=64+(1023&P),T=1023&m.charCodeAt(++b),S[p++]=240|P>>8&7,S[p++]=128|P>>2&63,S[p++]=128|T>>6&15|(3&P)<<4,S[p++]=128|63&T):(S[p++]=224|P>>12&15,S[p++]=128|P>>6&63,S[p++]=128|63&P),w<p&&(v.push(S.slice(0,p)),p=0,S=Y(65535),w=65530)}return v.push(S.slice(0,p)),ke(v)})(u);return wr.utils.cfb_add(a,c,f)}wr.utils.cfb_add(a,c,u)}else a.file(c,u)}function ul(){return wr.utils.cfb_new()}function pf(a,c){switch(c.type){case"base64":return wr.read(a,{type:"base64"});case"binary":return wr.read(a,{type:"binary"});case"buffer":case"array":return wr.read(a,{type:"buffer"})}throw new Error("Unrecognized type "+c.type)}function Na(a,c){if(a.charAt(0)=="/")return a.slice(1);var u=c.split("/");c.slice(-1)!="/"&&u.pop();for(var f=a.split("/");f.length!==0;){var m=f.shift();m===".."?u.pop():m!=="."&&u.push(m)}return u.join("/")}var ui=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Xl=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,YS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,go=ui.match(YS)?YS:/<[^>]*>/g,zte=/<\w*:/,Gte=/<(\/?)\w+:/;function kr(a,c,u){for(var f={},m=0,v=0;m!==a.length&&(v=a.charCodeAt(m))!==32&&v!==10&&v!==13;++m);if(c||(f[0]=a.slice(0,m)),m===a.length)return f;var p,w,S,b=a.match(Xl),T=0,P=0,M="",k="";if(b)for(P=0;P!=b.length;++P){for(k=b[P],v=0;v!=k.length&&k.charCodeAt(v)!==61;++v);for(M=k.slice(0,v).trim();k.charCodeAt(v+1)==32;)++v;for(w=(m=k.charCodeAt(v+1))==34||m==39?1:0,p=k.slice(v+1+w,k.length-w),T=0;T!=M.length&&M.charCodeAt(T)!==58;++T);T===M.length?(f[M=0<M.indexOf("_")?M.slice(0,M.indexOf("_")):M]=p,f[M.toLowerCase()]=p):f[S=(T===5&&M.slice(0,5)==="xmlns"?"xmlns":"")+M.slice(T+1)]&&M.slice(T-3,T)=="ext"||(f[S]=p,f[S.toLowerCase()]=p)}return f}function Uc(a){return a.replace(Gte,"<$1")}var o5,a5,l5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},AR=jc(l5),Sn=(o5=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,a5=/_x([\da-fA-F]{4})_/gi,function a(c){var u=c+"",f=u.indexOf("<![CDATA[");return f==-1?u.replace(o5,function(m,v){return l5[m]||String.fromCharCode(parseInt(v,-1<m.indexOf("x")?16:10))||m}).replace(a5,function(m,v){return String.fromCharCode(parseInt(v,16))}):(c=u.indexOf("]]>"),a(u.slice(0,f))+u.slice(f+9,c)+a(u.slice(c+3)))}),OR=/[&<>'"]/g,Yte=/[\u0000-\u0008\u000b-\u001f]/g;function $n(a){return(a+"").replace(OR,function(c){return AR[c]}).replace(Yte,function(c){return"_x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+"_"})}function c5(a){return $n(a).replace(/ /g,"_x0020_")}var u5=/[\u0000-\u001f]/g;function IR(a){return(a+"").replace(OR,function(c){return AR[c]}).replace(/\n/g,"<br/>").replace(u5,function(c){return"&#x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+";"})}var h5,f5=(h5=/&#(\d+);/g,function(a){return a.replace(h5,Kte)});function Kte(a,c){return String.fromCharCode(parseInt(c,10))}function hi(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function PR(a){for(var c,u,f,m,v="",p=0,w=0;p<a.length;)(c=a.charCodeAt(p++))<128?v+=String.fromCharCode(c):(u=a.charCodeAt(p++),191<c&&c<224?(w=(31&c)<<6,w|=63&u,v+=String.fromCharCode(w)):(f=a.charCodeAt(p++),c<240?v+=String.fromCharCode((15&c)<<12|(63&u)<<6|63&f):(m=((7&c)<<18|(63&u)<<12|(63&f)<<6|63&(w=a.charCodeAt(p++)))-65536,v+=String.fromCharCode(55296+(m>>>10&1023)),v+=String.fromCharCode(56320+(1023&m)))));return v}function d5(a){for(var c,u,f=Y(2*a.length),m=1,v=0,p=0,w=0;w<a.length;w+=m)m=1,(u=a.charCodeAt(w))<128?c=u:u<224?(c=64*(31&u)+(63&a.charCodeAt(w+1)),m=2):u<240?(c=4096*(15&u)+64*(63&a.charCodeAt(w+1))+(63&a.charCodeAt(w+2)),m=3):(m=4,c=262144*(7&u)+4096*(63&a.charCodeAt(w+1))+64*(63&a.charCodeAt(w+2))+(63&a.charCodeAt(w+3)),p=55296+((c-=65536)>>>10&1023),c=56320+(1023&c)),p!==0&&(f[v++]=255&p,f[v++]=p>>>8,p=0),f[v++]=c%256,f[v++]=c>>>8;return f.slice(0,v).toString("ucs2")}function g5(a){return te(a,"binary").toString("utf8")}var FR,CS,SS,pm="foo bar baz",qn=X&&(g5(pm)==PR(pm)?g5:d5(pm)==PR(pm)&&d5)||PR,zc=X?function(a){return te(a,"utf8").toString("binary")}:function(a){for(var c,u=[],f=0,m=0;f<a.length;)switch(!0){case(m=a.charCodeAt(f++))<128:u.push(String.fromCharCode(m));break;case m<2048:u.push(String.fromCharCode(192+(m>>6))),u.push(String.fromCharCode(128+(63&m)));break;case(55296<=m&&m<57344):m-=55296,c=a.charCodeAt(f++)-56320+(m<<10),u.push(String.fromCharCode(240+(c>>18&7))),u.push(String.fromCharCode(144+(c>>12&63))),u.push(String.fromCharCode(128+(c>>6&63))),u.push(String.fromCharCode(128+(63&c)));break;default:u.push(String.fromCharCode(224+(m>>12))),u.push(String.fromCharCode(128+(m>>6&63))),u.push(String.fromCharCode(128+(63&m)))}return u.join("")},z1=(FR={},function(a,c){var u=a+"|"+(c||"");return FR[u]||(FR[u]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",c||""))}),m5=(CS=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]}),function(a){for(var c=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<CS.length;++u)c=c.replace(CS[u][0],CS[u][1]);return c}),Xte=(SS={},function(a){return SS[a]!==void 0?SS[a]:SS[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}),qte=/<\/?(?:vt:)?variant>/g,Jte=/<(?:vt:)([^>]*)>([\s\S]*)</;function p5(f,c){var u=kr(f),f=f.match(Xte(u.baseType))||[],m=[];if(f.length==u.size)return f.forEach(function(v){v=v.replace(qte,"").match(Jte),v&&m.push({v:qn(v[2]),t:v[1]})}),m;if(c.WTF)throw new Error("unexpected vector length "+f.length+" != "+u.size);return m}var v5=/(^\s|\s$|\n)/;function Ks(a,c){return"<"+a+(c.match(v5)?' xml:space="preserve"':"")+">"+c+"</"+a+">"}function G1(a){return ii(a).map(function(c){return" "+c+'="'+a[c]+'"'}).join("")}function Dt(a,c,u){return"<"+a+(u!=null?G1(u):"")+(c!=null?(c.match(v5)?' xml:space="preserve"':"")+">"+c+"</"+a:"/")+">"}function MR(a,c){try{return a.toISOString().replace(/\.\d*/,"")}catch(u){if(c)throw u}return""}function kR(a){if(X&&Buffer.isBuffer(a))return a.toString("utf8");if(typeof a=="string")return a;if(typeof Uint8Array<"u"&&a instanceof Uint8Array)return qn(ye(Ee(a)));throw new Error("Bad input format: expected Buffer or string")}var Y1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,bs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},jd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Da={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function w5(a){for(var c=[],u=0;u<a[0].length;++u)if(a[0][u])for(var f=0,m=a[0][u].length;f<m;f+=10240)c.push.apply(c,a[0][u].slice(f,f+10240));return c}function y5(a,c,u){for(var f=[],m=c;m<u;m+=2)f.push(String.fromCharCode(eh(a,m)));return f.join("").replace(nt,"")}function C5(a,c,u){for(var f=[],m=c;m<c+u;++m)f.push(("0"+a[m].toString(16)).slice(-2));return f.join("")}function S5(a,c,u){for(var f=[],m=c;m<u;m++)f.push(String.fromCharCode(im(a,m)));return f.join("")}function b5(a,c){var u=Ms(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function x5(a,c){var u=Ms(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function E5(a,c){var u=2*Ms(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function T5(a,c){var u=Ms(a,c);return 0<u?bS(a,c+4,c+4+u):""}function _5(a,c){var u=Ms(a,c);return 0<u?nm(a,c+4,c+4+u):""}function R5(a,c){for(var u=1-2*(a[c+7]>>>7),f=((127&a[c+7])<<4)+(a[c+6]>>>4&15),m=15&a[c+6],v=5;0<=v;--v)m=256*m+a[c+v];return f==2047?m==0?1/0*u:NaN:(f==0?f=-1022:(f-=1023,m+=Math.pow(2,52)),u*Math.pow(2,f-52)*m)}var A5=X?function(a){return 0<a[0].length&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(c){return Buffer.isBuffer(c)?c:te(c)})):w5(a)}:w5,bS=X?function(a,c,u){return Buffer.isBuffer(a)?a.toString("utf16le",c,u).replace(nt,""):y5(a,c,u)}:y5,O5=X?function(a,c,u){return Buffer.isBuffer(a)?a.toString("hex",c,c+u):C5(a,c,u)}:C5,nm=X?function(a,c,u){return Buffer.isBuffer(a)?a.toString("utf8",c,u):S5(a,c,u)}:S5,NR=b5,DR=x5,LR=E5,HR=T5,$R=_5,xS=R5,BR=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};X&&(NR=function(a,c){if(!Buffer.isBuffer(a))return b5(a,c);var u=a.readUInt32LE(c);return 0<u?a.toString("utf8",c+4,c+4+u-1):""},DR=function(a,c){if(!Buffer.isBuffer(a))return x5(a,c);var u=a.readUInt32LE(c);return 0<u?a.toString("utf8",c+4,c+4+u-1):""},LR=function(a,c){if(!Buffer.isBuffer(a))return E5(a,c);var u=2*a.readUInt32LE(c);return a.toString("utf16le",c+4,c+4+u-1)},HR=function(a,c){if(!Buffer.isBuffer(a))return T5(a,c);var u=a.readUInt32LE(c);return a.toString("utf16le",c+4,c+4+u)},$R=function(a,c){if(!Buffer.isBuffer(a))return _5(a,c);var u=a.readUInt32LE(c);return a.toString("utf8",c+4,c+4+u)},xS=function(a,c){return Buffer.isBuffer(a)?a.readDoubleLE(c):R5(a,c)},BR=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array}),n!==void 0&&(bS=function(a,c,u){return n.utils.decode(1200,a.slice(c,u)).replace(nt,"")},nm=function(a,c,u){return n.utils.decode(65001,a.slice(c,u))},NR=function(a,c){var u=Ms(a,c);return 0<u?n.utils.decode(l,a.slice(c+4,c+4+u-1)):""},DR=function(a,c){var u=Ms(a,c);return 0<u?n.utils.decode(o,a.slice(c+4,c+4+u-1)):""},LR=function(a,c){var u=2*Ms(a,c);return 0<u?n.utils.decode(1200,a.slice(c+4,c+4+u-1)):""},HR=function(a,c){var u=Ms(a,c);return 0<u?n.utils.decode(1200,a.slice(c+4,c+4+u)):""},$R=function(a,c){var u=Ms(a,c);return 0<u?n.utils.decode(65001,a.slice(c+4,c+4+u)):""});var im=function(a,c){return a[c]},eh=function(a,c){return 256*a[c+1]+a[c]},Qte=function(a,c){return c=256*a[c+1]+a[c],c<32768?c:-1*(65535-c+1)},Ms=function(a,c){return a[c+3]*(1<<24)+(a[c+2]<<16)+(a[c+1]<<8)+a[c]},Ud=function(a,c){return a[c+3]<<24|a[c+2]<<16|a[c+1]<<8|a[c]},Zte=function(a,c){return a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3]};function K1(a,c){var u,f,m,v,p,w,S="",b=[];switch(c){case"dbcs":if(w=this.l,X&&Buffer.isBuffer(this))S=this.slice(this.l,this.l+2*a).toString("utf16le");else for(p=0;p<a;++p)S+=String.fromCharCode(eh(this,w)),w+=2;a*=2;break;case"utf8":S=nm(this,this.l,this.l+a);break;case"utf16le":a*=2,S=bS(this,this.l,this.l+a);break;case"wstr":if(n===void 0)return K1.call(this,a,"dbcs");S=n.utils.decode(o,this.slice(this.l,this.l+2*a)),a*=2;break;case"lpstr-ansi":S=NR(this,this.l),a=4+Ms(this,this.l);break;case"lpstr-cp":S=DR(this,this.l),a=4+Ms(this,this.l);break;case"lpwstr":S=LR(this,this.l),a=4+2*Ms(this,this.l);break;case"lpp4":a=4+Ms(this,this.l),S=HR(this,this.l),2&a&&(a+=2);break;case"8lpp4":a=4+Ms(this,this.l),S=$R(this,this.l),3&a&&(a+=4-(3&a));break;case"cstr":for(a=0,S="";(m=im(this,this.l+a++))!==0;)b.push(R(m));S=b.join("");break;case"_wstr":for(a=0,S="";(m=eh(this,this.l+a))!==0;)b.push(R(m)),a+=2;a+=2,S=b.join("");break;case"dbcs-cont":for(S="",w=this.l,p=0;p<a;++p){if(this.lens&&this.lens.indexOf(w)!==-1)return m=im(this,w),this.l=w+1,v=K1.call(this,a-p,m?"dbcs-cont":"sbcs-cont"),b.join("")+v;b.push(R(eh(this,w))),w+=2}S=b.join(""),a*=2;break;case"cpstr":if(n!==void 0){S=n.utils.decode(o,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(S="",w=this.l,p=0;p!=a;++p){if(this.lens&&this.lens.indexOf(w)!==-1)return m=im(this,w),this.l=w+1,v=K1.call(this,a-p,m?"dbcs-cont":"sbcs-cont"),b.join("")+v;b.push(R(im(this,w))),w+=1}S=b.join("");break;default:switch(a){case 1:return u=im(this,this.l),this.l++,u;case 2:return u=(c==="i"?Qte:eh)(this,this.l),this.l+=2,u;case 4:case-4:return c==="i"||!(128&this[this.l+3])?(u=(0<a?Ud:Zte)(this,this.l),this.l+=4,u):(f=Ms(this,this.l),this.l+=4,f);case 8:case-8:if(c==="f")return f=a==8?xS(this,this.l):xS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,f;a=8;case 16:S=O5(this,this.l,a)}}return this.l+=a,S}var ere=function(a,c,u){a[u]=255&c,a[u+1]=c>>>8&255,a[u+2]=c>>>16&255,a[u+3]=c>>>24&255},tre=function(a,c,u){a[u]=255&c,a[u+1]=c>>8&255,a[u+2]=c>>16&255,a[u+3]=c>>24&255},rre=function(a,c,u){a[u]=255&c,a[u+1]=c>>>8&255};function nre(a,c,u){var f=0,m=0;if(u==="dbcs"){for(m=0;m!=c.length;++m)rre(this,c.charCodeAt(m),this.l+2*m);f=2*c.length}else if(u==="sbcs"){if(n!==void 0&&l==874)for(m=0;m!=c.length;++m){var v=n.utils.encode(l,c.charAt(m));this[this.l+m]=v[0]}else for(c=c.replace(/[^\x00-\x7F]/g,"_"),m=0;m!=c.length;++m)this[this.l+m]=255&c.charCodeAt(m);f=c.length}else{if(u==="hex"){for(;m<a;++m)this[this.l++]=parseInt(c.slice(2*m,2*m+2),16)||0;return this}if(u==="utf16le"){for(var p=Math.min(this.l+a,this.length),m=0;m<Math.min(c.length,a);++m){var w=c.charCodeAt(m);this[this.l++]=255&w,this[this.l++]=w>>8}for(;this.l<p;)this[this.l++]=0;return this}switch(a){case 1:f=1,this[this.l]=255&c;break;case 2:f=2,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c;break;case 3:f=3,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c,c>>>=8,this[this.l+2]=255&c;break;case 4:f=4,ere(this,c,this.l);break;case 8:if(f=8,u==="f"){(function(S,b,T){var P=(b<0||1/b==-1/0?1:0)<<7,M=0,k=0,j=P?-b:b;isFinite(j)?j==0?M=k=0:(M=Math.floor(Math.log(j)/Math.LN2),k=j*Math.pow(2,52-M),M<=-1023&&(!isFinite(k)||k<Math.pow(2,52))?M=-1022:(k-=Math.pow(2,52),M+=1023)):(M=2047,k=isNaN(b)?26985:0);for(var L=0;L<=5;++L,k/=256)S[T+L]=255&k;S[T+6]=(15&M)<<4|15&k,S[T+7]=M>>4|P})(this,c,this.l);break}case 16:break;case-4:f=4,tre(this,c,this.l)}}return this.l+=f,this}function I5(a,c){var u=O5(this,this.l,a.length>>1);if(u!==a)throw new Error(c+"Expected "+a+" saw "+u);this.l+=a.length>>1}function Xs(a,c){a.l=c,a.read_shift=K1,a.chk=I5,a.write_shift=nre}function mo(a,c){a.l+=c}function it(a){return a=Y(a),Xs(a,0),a}function th(a,c,u){if(a){Xs(a,a.l||0);for(var f,m=a.length,v=0;a.l<m;){128&(v=a.read_shift(1))&&(v=(127&v)+((127&a.read_shift(1))<<7));for(var p,w=pv[v]||pv[65535],S=127&(p=a.read_shift(1)),b=1;b<4&&128&p;++b)S+=(127&(p=a.read_shift(1)))<<7*b;f=a.l+S;var T=w.f&&w.f(a,S,u);if(a.l=f,c(T,w,v))return}}}function ha(){function a(p){return Xs(p=it(p),0),p}function c(){v&&(v.length>v.l&&((v=v.slice(0,v.l)).l=v.length),0<v.length&&f.push(v),v=null)}function u(p){return v&&p<v.length-v.l?v:(c(),v=a(Math.max(p+1,m)))}var f=[],m=X?256:2048,v=a(m);return{next:u,push:function(p){c(),(v=p).l==null&&(v.l=v.length),u(m)},end:function(){return c(),ke(f)},_bufs:f}}function gt(a,c,u,f){var m=+c;if(!isNaN(m)){c=1+(128<=m?1:0)+1,128<=(f=f||pv[m].p||(u||[]).length||0)&&++c,16384<=f&&++c,2097152<=f&&++c;var v=a.next(c);m<=127?v.write_shift(1,m):(v.write_shift(1,128+(127&m)),v.write_shift(1,m>>7));for(var p=0;p!=4;++p){if(!(128<=f)){v.write_shift(1,f);break}v.write_shift(1,128+(127&f)),f>>=7}0<f&&BR(u)&&a.push(u)}}function X1(a,c,u){var f=Le(a);if(c.s?(f.cRel&&(f.c+=c.s.c),f.rRel&&(f.r+=c.s.r)):(f.cRel&&(f.c+=c.c),f.rRel&&(f.r+=c.r)),!u||u.biff<12){for(;256<=f.c;)f.c-=256;for(;65536<=f.r;)f.r-=65536}return f}function P5(a,c,u){return a=Le(a),a.s=X1(a.s,c.s,u),a.e=X1(a.e,c.s,u),a}function q1(a,c){if(a.cRel&&a.c<0)for(a=Le(a);a.c<0;)a.c+=8<c?16384:256;if(a.rRel&&a.r<0)for(a=Le(a);a.r<0;)a.r+=8<c?1048576:5<c?65536:16384;var u=Nr(a);return a.cRel||a.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!a.rRel&&a.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function VR(a,c){return a.s.r!=0||a.s.rRel||a.e.r!=(12<=c.biff?1048575:8<=c.biff?65536:16384)||a.e.rRel?a.s.c!=0||a.s.cRel||a.e.c!=(12<=c.biff?16383:255)||a.e.cRel?q1(a.s,c.biff)+":"+q1(a.e,c.biff):(a.s.rRel?"":"$")+Vi(a.s.r)+":"+(a.e.rRel?"":"$")+Vi(a.e.r):(a.s.cRel?"":"$")+fi(a.s.c)+":"+(a.e.cRel?"":"$")+fi(a.e.c)}function WR(a){return parseInt(a.replace(/\$(\d+)$/,"$1"),10)-1}function Vi(a){return""+(a+1)}function jR(a){for(var c=a.replace(/^\$([A-Z])/,"$1"),u=0,f=0;f!==c.length;++f)u=26*u+c.charCodeAt(f)-64;return u-1}function fi(a){if(a<0)throw new Error("invalid column "+a);var c="";for(++a;a;a=Math.floor((a-1)/26))c=String.fromCharCode((a-1)%26+65)+c;return c}function Ri(a){for(var c=0,u=0,f=0;f<a.length;++f){var m=a.charCodeAt(f);48<=m&&m<=57?c=10*c+(m-48):65<=m&&m<=90&&(u=26*u+(m-64))}return{c:u-1,r:c-1}}function Nr(a){for(var c=a.c+1,u="";c;c=(c-1)/26|0)u=String.fromCharCode((c-1)%26+65)+u;return u+(a.r+1)}function Ho(a){var c=a.indexOf(":");return c==-1?{s:Ri(a),e:Ri(a)}:{s:Ri(a.slice(0,c)),e:Ri(a.slice(c+1))}}function jr(a,c){return c===void 0||typeof c=="number"?jr(a.s,a.e):(a=typeof a!="string"?Nr(a):a)==(c=typeof c!="string"?Nr(c):c)?a:a+":"+c}function un(a){for(var c={s:{c:0,r:0},e:{c:0,r:0}},v=0,u=0,f=0,m=a.length,v=0;u<m&&!((f=a.charCodeAt(u)-64)<1||26<f);++u)v=26*v+f;for(c.s.c=--v,v=0;u<m&&!((f=a.charCodeAt(u)-48)<0||9<f);++u)v=10*v+f;if(c.s.r=--v,u===m||f!=10)return c.e.c=c.s.c,c.e.r=c.s.r,c;for(++u,v=0;u!=m&&!((f=a.charCodeAt(u)-64)<1||26<f);++u)v=26*v+f;for(c.e.c=--v,v=0;u!=m&&!((f=a.charCodeAt(u)-48)<0||9<f);++u)v=10*v+f;return c.e.r=--v,c}function ire(a,c){var u=a.t=="d"&&c instanceof Date;if(a.z!=null)try{return a.w=vr(a.z,u?ci(c):c)}catch{}try{return a.w=vr((a.XF||{}).numFmtId||(u?14:0),u?ci(c):c)}catch{return""+c}}function Gc(a,c,u){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&u&&u.dateNF&&(a.z=u.dateNF),a.t=="e"?rh[a.v]||a.v:ire(a,c??a.v))}function vf(a,f){var u=f&&f.sheet?f.sheet:"Sheet1",f={};return f[u]=a,{SheetNames:[u],Sheets:f}}function F5(a,c,u){var f=u||{},m=a?Array.isArray(a):f.dense,v=a||(m?[]:{}),p=0,w=0;v&&f.origin!=null&&(typeof f.origin=="number"?p=f.origin:(p=(S=typeof f.origin=="string"?Ri(f.origin):f.origin).r,w=S.c),v["!ref"]||(v["!ref"]="A1:A1"));var S,b={s:{c:1e7,r:1e7},e:{c:0,r:0}};v["!ref"]&&(S=un(v["!ref"]),b.s.c=S.s.c,b.s.r=S.s.r,b.e.c=Math.max(b.e.c,S.e.c),b.e.r=Math.max(b.e.r,S.e.r),p==-1&&(b.e.r=p=S.e.r+1));for(var T=0;T!=c.length;++T)if(c[T]){if(!Array.isArray(c[T]))throw new Error("aoa_to_sheet expects an array of arrays");for(var P=0;P!=c[T].length;++P)if(c[T][P]!==void 0){var M={v:c[T][P]},k=p+T,j=w+P;if(b.s.r>k&&(b.s.r=k),b.s.c>j&&(b.s.c=j),b.e.r<k&&(b.e.r=k),b.e.c<j&&(b.e.c=j),!c[T][P]||typeof c[T][P]!="object"||Array.isArray(c[T][P])||c[T][P]instanceof Date)if(Array.isArray(M.v)&&(M.f=c[T][P][1],M.v=M.v[0]),M.v===null)if(M.f)M.t="n";else if(f.nullError)M.t="e",M.v=0;else{if(!f.sheetStubs)continue;M.t="z"}else typeof M.v=="number"?M.t="n":typeof M.v=="boolean"?M.t="b":M.v instanceof Date?(M.z=f.dateNF||B[14],f.cellDates?(M.t="d",M.w=vr(M.z,ci(M.v))):(M.t="n",M.v=ci(M.v),M.w=vr(M.z,M.v))):M.t="s";else M=c[T][P];m?(v[k]||(v[k]=[]),v[k][j]&&v[k][j].z&&(M.z=v[k][j].z),v[k][j]=M):(v[k=Nr({c:j,r:k})]&&v[k].z&&(M.z=v[k].z),v[k]=M)}}return b.s.c<1e7&&(v["!ref"]=jr(b)),v}function sm(a,c){return F5(null,a,c)}function ql(a,c){return(c=c||it(4)).write_shift(4,a),c}function po(a){var c=a.read_shift(4);return c===0?"":a.read_shift(c,"dbcs")}function ks(a,c){var u=!1;return c==null&&(u=!0,c=it(4+2*a.length)),c.write_shift(4,a.length),0<a.length&&c.write_shift(0,a,"dbcs"),u?c.slice(0,c.l):c}function UR(a,c){var u,f=a.l,m=a.read_shift(1),p=po(a),v=[],p={t:p,h:p};if(1&m){for(var w=a.read_shift(4),S=0;S!=w;++S)v.push({ich:(u=a).read_shift(2),ifnt:u.read_shift(2)});p.r=v}else p.r=[{ich:0,ifnt:0}];return a.l=f+c,p}var sre=UR;function ore(a,c){var u,f=!1;return c==null&&(f=!0,c=it(23+4*a.t.length)),c.write_shift(1,1),ks(a.t,c),c.write_shift(4,1),u={ich:0,ifnt:0},(a=(a=c)||it(4)).write_shift(2,u.ich||0),a.write_shift(2,u.ifnt||0),f?c.slice(0,c.l):c}function hl(a){var c=a.read_shift(4),u=a.read_shift(2);return u+=a.read_shift(1)<<16,a.l++,{c,iStyleRef:u}}function zd(a,c){return(c=c??it(8)).write_shift(-4,a.c),c.write_shift(3,a.iStyleRef||a.s),c.write_shift(1,0),c}function Gd(a){var c=a.read_shift(2);return c+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:c}}function Yd(a,c){return(c=c??it(4)).write_shift(3,a.iStyleRef||a.s),c.write_shift(1,0),c}var are=po,M5=ks;function zR(a){var c=a.read_shift(4);return c===0||c===4294967295?"":a.read_shift(c,"dbcs")}function ES(a,c){var u=!1;return c==null&&(u=!0,c=it(127)),c.write_shift(4,0<a.length?a.length:4294967295),0<a.length&&c.write_shift(0,a,"dbcs"),u?c.slice(0,c.l):c}var lre=po,GR=zR,YR=ES;function KR(a){var c=a.slice(a.l,a.l+4),u=1&c[0],f=2&c[0];return a.l+=4,c=f==0?xS([0,0,0,0,252&c[0],c[1],c[2],c[3]],0):Ud(c,0)>>2,u?c/100:c}function k5(a,c){c==null&&(c=it(4));var u=0,f=0,m=100*a;if(a==(0|a)&&-(1<<29)<=a&&a<1<<29?f=1:m==(0|m)&&-(1<<29)<=m&&m<1<<29&&(u=f=1),!f)throw new Error("unsupported RkNumber "+a);c.write_shift(-4,((u?m:a)<<2)+(u+2))}function N5(a){var c={s:{},e:{}};return c.s.r=a.read_shift(4),c.e.r=a.read_shift(4),c.s.c=a.read_shift(4),c.e.c=a.read_shift(4),c}var Kd=N5,om=function(a,c){return(c=c||it(16)).write_shift(4,a.s.r),c.write_shift(4,a.e.r),c.write_shift(4,a.s.c),c.write_shift(4,a.e.c),c};function vo(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function am(a,c){return(c||it(8)).write_shift(8,a,"f")}function TS(a,c){if(c=c||it(8),!a||a.auto)return c.write_shift(4,0),c.write_shift(4,0),c;a.index!=null?(c.write_shift(1,2),c.write_shift(1,a.index)):a.theme!=null?(c.write_shift(1,6),c.write_shift(1,a.theme)):(c.write_shift(1,5),c.write_shift(1,0));var u=a.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),c.write_shift(2,u),a.rgb&&a.theme==null?(typeof(a=a.rgb||"FFFFFF")=="number"&&(a=("000000"+a.toString(16)).slice(-6)),c.write_shift(1,parseInt(a.slice(0,2),16)),c.write_shift(1,parseInt(a.slice(2,4),16)),c.write_shift(1,parseInt(a.slice(4,6),16)),c.write_shift(1,255)):(c.write_shift(2,0),c.write_shift(1,0),c.write_shift(1,0)),c}function D5(a,c){var u=a.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[a.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return a.l-=4,a.read_shift(0,c==1?"lpstr":"lpwstr")}var XR=2,fa=3,L5=12,H5=81,cre=[80,H5],qR={1:{n:"CodePage",t:XR},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:fa},5:{n:"LineCount",t:fa},6:{n:"ParagraphCount",t:fa},7:{n:"SlideCount",t:fa},8:{n:"NoteCount",t:fa},9:{n:"HiddenCount",t:fa},10:{n:"MultimediaClipCount",t:fa},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:fa},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:fa,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},JR={1:{n:"CodePage",t:XR},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:fa},15:{n:"WordCount",t:fa},16:{n:"CharCount",t:fa},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:fa},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},$5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ure=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],J1=Le([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(a){return[a>>16&255,a>>8&255,255&a]})),rh={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},QR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_S={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ZR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function V5(a,c){var u,f=function(S){for(var b=[],T=ii(S),P=0;P!==T.length;++P)b[S[T[P]]]==null&&(b[S[T[P]]]=[]),b[S[T[P]]].push(T[P]);return b}(QR),m=[];m[m.length]=ui,m[m.length]=Dt("Types",null,{xmlns:bs.CT,"xmlns:xsd":bs.xsd,"xmlns:xsi":bs.xsi}),m=m.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(S){return Dt("Default",null,{Extension:S[0],ContentType:S[1]})}));function v(S){a[S]&&0<a[S].length&&(u=a[S][0],m[m.length]=Dt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:_S[S][c.bookType]||_S[S].xlsx}))}function p(S){(a[S]||[]).forEach(function(b){m[m.length]=Dt("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:_S[S][c.bookType]||_S[S].xlsx})})}function w(S){(a[S]||[]).forEach(function(b){m[m.length]=Dt("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:f[S][0]})})}return v("workbooks"),p("sheets"),p("charts"),w("themes"),["strs","styles"].forEach(v),["coreprops","extprops","custprops"].forEach(w),w("vba"),w("comments"),w("threadedcomments"),w("drawings"),p("metadata"),w("people"),2<m.length&&(m[m.length]="</Types>",m[1]=m[1].replace("/>",">")),m.join("")}var zr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Q1(a){var c=a.lastIndexOf("/");return a.slice(0,c+1)+"_rels/"+a.slice(c+1)+".rels"}function Z1(a,c){var u={"!id":{}};if(!a)return u;c.charAt(0)!=="/"&&(c="/"+c);var f={};return(a.match(go)||[]).forEach(function(m){var v,p=kr(m);p[0]==="<Relationship"&&((v={}).Type=p.Type,v.Target=p.Target,v.Id=p.Id,p.TargetMode&&(v.TargetMode=p.TargetMode),m=p.TargetMode==="External"?p.Target:Na(p.Target,c),u[m]=v,f[p.Id]=v)}),u["!id"]=f,u}function lm(a){var c=[ui,Dt("Relationships",null,{xmlns:bs.RELS})];return ii(a["!id"]).forEach(function(u){c[c.length]=Dt("Relationship",null,a["!id"][u])}),2<c.length&&(c[c.length]="</Relationships>",c[1]=c[1].replace("/>",">")),c.join("")}function Bn(a,c,u,f,m,v){if(m=m||{},a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),c<0)for(c=a["!idx"];a["!id"]["rId"+c];++c);if(a["!idx"]=c+1,m.Id="rId"+c,m.Type=f,m.Target=u,-1<[zr.HLINK,zr.XPATH,zr.XMISS].indexOf(m.Type)&&(m.TargetMode="External"),a["!id"][m.Id])throw new Error("Cannot rewrite rId "+c);return a["!id"][m.Id]=m,a[("/"+m.Target).replace("//","/")]=m,c}var hre="application/vnd.oasis.opendocument.spreadsheet";function W5(a,c,u){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+c+`"/>
`,`  </rdf:Description>
`].join("")}function j5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var fl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fre=function(){for(var a=new Array(fl.length),c=0;c<fl.length;++c){var u=fl[c],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);a[c]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return a}();function U5(a){var c={};a=qn(a);for(var u=0;u<fl.length;++u){var f=fl[u],m=a.match(fre[u]);m!=null&&0<m.length&&(c[f[1]]=Sn(m[1])),f[2]==="date"&&c[f[1]]&&(c[f[1]]=ue(c[f[1]]))}return c}function eA(a,c,u,f,m){m[a]==null&&c!=null&&c!==""&&(c=$n(m[a]=c),f[f.length]=u?Dt(a,c,u):Ks(a,c))}function z5(a,c){var u=c||{},f=[ui,Dt("cp:coreProperties",null,{"xmlns:cp":bs.CORE_PROPS,"xmlns:dc":bs.dc,"xmlns:dcterms":bs.dcterms,"xmlns:dcmitype":bs.dcmitype,"xmlns:xsi":bs.xsi})],m={};if(!a&&!u.Props)return f.join("");a&&(a.CreatedDate!=null&&eA("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:MR(a.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},f,m),a.ModifiedDate!=null&&eA("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:MR(a.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},f,m));for(var v=0;v!=fl.length;++v){var p=fl[v],w=u.Props&&u.Props[p[1]]!=null?u.Props[p[1]]:a?a[p[1]]:null;w===!0?w="1":w===!1?w="0":typeof w=="number"&&(w=String(w)),w!=null&&eA(p[0],w,null,f,m)}return 2<f.length&&(f[f.length]="</cp:coreProperties>",f[1]=f[1].replace("/>",">")),f.join("")}var Xd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],G5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Y5(a,c,u,f){var m=[];if(typeof a=="string")m=p5(a,f);else for(var v=0;v<a.length;++v)m=m.concat(a[v].map(function(T){return{v:T}}));var p,w=typeof c=="string"?p5(c,f).map(function(T){return T.v}):c,S=0;if(0<w.length)for(var b=0;b!==m.length;b+=2){switch(p=+m[b+1].v,m[b].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=p,u.SheetNames=w.slice(S,S+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=p,u.DefinedNames=w.slice(S,S+p);break;case"Charts":case"Diagramme":u.Chartsheets=p,u.ChartNames=w.slice(S,S+p)}S+=p}}function K5(a){var c=[],u=Dt;return(a=a||{}).Application="SheetJS",c[c.length]=ui,c[c.length]=Dt("Properties",null,{xmlns:bs.EXT_PROPS,"xmlns:vt":bs.vt}),Xd.forEach(function(f){if(a[f[1]]!==void 0){var m;switch(f[2]){case"string":m=$n(String(a[f[1]]));break;case"bool":m=a[f[1]]?"true":"false"}m!==void 0&&(c[c.length]=u(f[0],m))}}),c[c.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),c[c.length]=u("TitlesOfParts",u("vt:vector",a.SheetNames.map(function(f){return"<vt:lpstr>"+$n(f)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var dre=/<[^>]+>[^<]*/g;function X5(a){var c=[ui,Dt("Properties",null,{xmlns:bs.CUST_PROPS,"xmlns:vt":bs.vt})];if(!a)return c.join("");var u=1;return ii(a).forEach(function(f){++u,c[c.length]=Dt("property",function(m,v){switch(typeof m){case"string":var p=Dt("vt:lpwstr",$n(m));return p=p.replace(/&quot;/g,"_x0022_");case"number":return Dt((0|m)==m?"vt:i4":"vt:r8",$n(String(m)));case"boolean":return Dt("vt:bool",m?"true":"false")}if(m instanceof Date)return Dt("vt:filetime",MR(m));throw new Error("Unable to serialize "+m)}(a[f]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:$n(f)})}),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var q5,tA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rA(u){var c=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+c/1e7-11644473600)).toISOString().replace(/\.000/,"")}function J5(a,c,u){var f=a.l,m=a.read_shift(0,"lpstr-cp");if(u)for(;a.l-f&3;)++a.l;return m}function Q5(a,c,u){var f=a.read_shift(0,"lpwstr");return f}function Z5(a,c,u){return c===31?Q5(a):J5(a,0,u)}function eL(a,c,u){return Z5(a,c,u===!1?0:4)}function gre(a){for(var c,u,f,m=a.read_shift(4),v=[],p=0;p<m/2;++p)v.push((f=u=void 0,u=(c=a).l,f=RS(c,H5),c[c.l]==0&&c[c.l+1]==0&&c.l-u&2&&(c.l+=2),[f,RS(c,fa)]));return v}function tL(a,c){for(var u=a.read_shift(4),f={},m=0;m!=u;++m){var v=a.read_shift(4),p=a.read_shift(4);f[v]=a.read_shift(p,c===1200?"utf16le":"utf8").replace(nt,"").replace(at,"!"),c===1200&&p%2&&(a.l+=2)}return 3&a.l&&(a.l=a.l>>3<<2),f}function rL(a){var c=a.read_shift(4),u=a.slice(a.l,a.l+c);return a.l+=c,0<(3&c)&&(a.l+=4-(3&c)&3),u}function RS(a,c,u){var f,m,v=a.read_shift(2),p=u||{};if(a.l+=2,c!==L5&&v!==c&&cre.indexOf(c)===-1&&((65534&c)!=4126||(65534&v)!=4126))throw new Error("Expected type "+c+" saw "+v);switch(c===L5?v:c){case 2:return f=a.read_shift(2,"i"),p.raw||(a.l+=2),f;case 3:return f=a.read_shift(4,"i");case 11:return a.read_shift(4)!==0;case 19:return f=a.read_shift(4);case 30:return J5(a,0,4).replace(nt,"");case 31:return Q5(a);case 64:return rA(a);case 65:return rL(a);case 71:return(m={}).Size=(f=a).read_shift(4),f.l+=m.Size+3-(m.Size-1)%4,m;case 80:return eL(a,v,!p.raw).replace(nt,"");case 81:return function(w,S){if(!S)throw new Error("VtUnalignedString must have positive length");return Z5(w,S,0)}(a,v).replace(nt,"");case 4108:return gre(a);case 4126:case 4127:return(v==4127?function(w){for(var S=w.read_shift(4),b=[],T=0;T!=S;++T){var P=w.l;b[T]=w.read_shift(0,"lpwstr").replace(nt,""),w.l-P&2&&(w.l+=2)}return b}:function(w){for(var S=w.read_shift(4),b=[],T=0;T!=S;++T)b[T]=w.read_shift(0,"lpstr-cp").replace(nt,"");return b})(a);default:throw new Error("TypedPropertyValue unrecognized type "+c+" "+v)}}function nL(a,c){var u,f,m,v=it(4),p=it(4);switch(v.write_shift(4,a==80?31:a),a){case 3:p.write_shift(-4,c);break;case 5:(p=it(8)).write_shift(8,c,"f");break;case 11:p.write_shift(4,c?1:0);break;case 64:f=(typeof(u=c)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,m=f%Math.pow(2,32),u=(f-m)/Math.pow(2,32),u*=1e7,0<(f=(m*=1e7)/Math.pow(2,32)|0)&&(m%=Math.pow(2,32),u+=f),(f=it(8)).write_shift(4,m),f.write_shift(4,u),p=f;break;case 31:case 80:for((p=it(4+2*(c.length+1)+(c.length%2?0:2))).write_shift(4,c.length+1),p.write_shift(0,c,"dbcs");p.l!=p.length;)p.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+c)}return ke([v,p])}function iL(a,c){for(var u=a.l,f=a.read_shift(4),m=a.read_shift(4),v=[],b=0,p=0,w=-1,S={},b=0;b!=m;++b){var T=a.read_shift(4),P=a.read_shift(4);v[b]=[T,P+u]}v.sort(function(G,W){return G[1]-W[1]});var M={};for(b=0;b!=m;++b){if(a.l!==v[b][1]){var k=!0;if(0<b&&c)switch(c[v[b-1][0]].t){case 2:a.l+2===v[b][1]&&(a.l+=2,k=!1);break;case 80:case 4108:a.l<=v[b][1]&&(a.l=v[b][1],k=!1)}if((!c||b==0)&&a.l<=v[b][1]&&(k=!1,a.l=v[b][1]),k)throw new Error("Read Error: Expected address "+v[b][1]+" at "+a.l+" :"+b)}if(c){var j=c[v[b][0]];if(M[j.n]=RS(a,j.t,{raw:!0}),j.p==="version"&&(M[j.n]=String(M[j.n]>>16)+"."+("0000"+String(65535&M[j.n])).slice(-4)),j.n=="CodePage")switch(M[j.n]){case 0:M[j.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:y(p=M[j.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+M[j.n])}}else if(v[b][0]===1)p=M.CodePage=RS(a,XR),y(p),w!==-1&&(Q=a.l,a.l=v[w][1],S=tL(a,p),a.l=Q);else if(v[b][0]===0)p!==0?S=tL(a,p):(w=b,a.l=v[b+1][1]);else{var L,Q=S[v[b][0]];switch(a[a.l]){case 65:a.l+=4,L=rL(a);break;case 30:case 31:a.l+=4,L=eL(a,a[a.l-4]).replace(/\u0000+$/,"");break;case 3:a.l+=4,L=a.read_shift(4,"i");break;case 19:a.l+=4,L=a.read_shift(4);break;case 5:a.l+=4,L=a.read_shift(8,"f");break;case 11:a.l+=4,L=es(a,4);break;case 64:a.l+=4,L=ue(rA(a));break;default:throw new Error("unparsed value: "+a[a.l])}M[Q]=L}}return a.l=u+f,M}var sL=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function oL(a,c,u){var f,m,v,p,w=it(8),S=[],b=[],T=8,P=0,M=it(8),k=it(8);if(M.write_shift(4,2),M.write_shift(4,1200),k.write_shift(4,1),b.push(M),S.push(k),T+=8+M.length,!c){(k=it(8)).write_shift(4,0),S.unshift(k);var j=[it(4)];for(j[0].write_shift(4,a.length),P=0;P<a.length;++P){var L=a[P][0];for((M=it(8+2*(L.length+1)+(L.length%2?0:2))).write_shift(4,P+2),M.write_shift(4,L.length+1),M.write_shift(0,L,"dbcs");M.l!=M.length;)M.write_shift(1,0);j.push(M)}M=ke(j),b.unshift(M),T+=8+M.length}for(P=0;P<a.length;++P)c&&!c[a[P][0]]||-1<sL.indexOf(a[P][0])||-1<G5.indexOf(a[P][0])||a[P][1]!=null&&(v=a[P][1],f=0,M=c?((p=u[f=+c[a[P][0]]]).p=="version"&&typeof v=="string"&&(v=(+(m=v.split("."))[0]<<16)+(+m[1]||0)),nL(p.t,v)):((p=function(G){switch(typeof G){case"boolean":return 11;case"number":return(0|G)==G?3:5;case"string":return 31;case"object":if(G instanceof Date)return 64}return-1}(v))==-1&&(p=31,v=String(v)),nL(p,v)),b.push(M),(k=it(8)).write_shift(4,c?f:2+P),S.push(k),T+=8+M.length);for(var Q=8*(b.length+1),P=0;P<b.length;++P)S[P].write_shift(4,Q),Q+=b[P].length;return w.write_shift(4,T),w.write_shift(4,b.length),ke([w].concat(S).concat(b))}function aL(a,c,u){var f=a.content;if(!f)return{};Xs(f,0);var m,v=0;f.chk("feff","Byte Order: "),f.read_shift(2);var p=f.read_shift(4),w=f.read_shift(16);if(w!==wr.utils.consts.HEADER_CLSID&&w!==u)throw new Error("Bad PropertySet CLSID "+w);if((a=f.read_shift(4))!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(u=f.read_shift(16),w=f.read_shift(4),a===1&&w!==f.l)throw new Error("Length mismatch: "+w+" !== "+f.l);a===2&&(m=f.read_shift(16),v=f.read_shift(4));var S,b,T=iL(f,c),P={SystemIdentifier:p};for(S in T)P[S]=T[S];if(P.FMTID=u,a===1)return P;if(v-f.l==2&&(f.l+=2),f.l!==v)throw new Error("Length mismatch 2: "+f.l+" !== "+v);try{b=iL(f,null)}catch{}for(S in b)P[S]=b[S];return P.FMTID=[u,m],P}function lL(a,c,u,f,m,v){var p=it(m?68:48),w=[p];return p.write_shift(2,65534),p.write_shift(2,0),p.write_shift(4,842412599),p.write_shift(16,wr.utils.consts.HEADER_CLSID,"hex"),p.write_shift(4,m?2:1),p.write_shift(16,c,"hex"),p.write_shift(4,m?68:48),f=oL(a,u,f),w.push(f),m&&(m=oL(m,null,null),p.write_shift(16,v,"hex"),p.write_shift(4,68+f.length),w.push(m)),ke(w)}function wf(a,c){return a.read_shift(c),null}function es(a,c){return a.read_shift(c)===1}function $o(a,c){return(c=c||it(2)).write_shift(2,+!!a),c}function as(a){return a.read_shift(2,"u")}function dl(a,c){return(c=c||it(2)).write_shift(2,a),c}function cL(a,c){return function(u,f,m){for(var v=[],p=u.l+f;u.l<p;)v.push(m(u,p-u.l));if(p!==u.l)throw new Error("Slurp error");return v}(a,c,as)}function uL(a,c,u){return(u=u||it(2)).write_shift(1,c=="e"?+a:+!!a),u.write_shift(1,c=="e"?1:0),u}function ev(a,c,u){var f=a.read_shift(u&&12<=u.biff?2:1),m="sbcs-cont",v=o;return u&&8<=u.biff&&(o=1200),u&&u.biff!=8?u.biff==12&&(m="wstr"):a.read_shift(1)&&(m="dbcs-cont"),2<=u.biff&&u.biff<=5&&(m="cpstr"),m=f?a.read_shift(f,m):"",o=v,m}function qd(a,c,u){if(u){if(2<=u.biff&&u.biff<=5)return a.read_shift(c,"cpstr");if(12<=u.biff)return a.read_shift(c,"dbcs-cont")}return a.read_shift(1)===0?a.read_shift(c,"sbcs-cont"):a.read_shift(c,"dbcs-cont")}function tv(a,c,u){var f=a.read_shift(u&&u.biff==2?1:2);return f===0?(a.l++,""):qd(a,f,u)}function Jd(a,c,u){if(5<u.biff)return tv(a,0,u);var f=a.read_shift(1);return f===0?(a.l++,""):a.read_shift(f,u.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function hL(a,c,u){return(u=u||it(3+2*a.length)).write_shift(2,a.length),u.write_shift(1,1),u.write_shift(31,a,"utf16le"),u}function mre(a){var c,u,f,m,v=a.read_shift(16);switch(v){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(c=a).read_shift(4),f=c.l,m=!1,24<u&&(c.l+=u-24,c.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(m=!0),c.l=f),u=c.read_shift((m?u-24:u)>>1,"utf16le").replace(nt,""),m&&(c.l+=24),u;case"0303000000000000c000000000000046":return function(p){for(var w=p.read_shift(2),S="";0<w--;)S+="../";var b=p.read_shift(0,"lpstr-ansi");if(p.l+=2,p.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(p.read_shift(4)===0)return S+b.replace(/\\/g,"/");if(b=p.read_shift(4),p.read_shift(2)!=3)throw new Error("Bad FileMoniker");return S+p.read_shift(b>>1,"utf16le").replace(nt,"")}(a);default:throw new Error("Unsupported Moniker "+v)}}function AS(a){var c=a.read_shift(4);return 0<c?a.read_shift(c,"utf16le").replace(nt,""):""}function fL(a,c){(c=c||it(6+2*a.length)).write_shift(4,1+a.length);for(var u=0;u<a.length;++u)c.write_shift(2,a.charCodeAt(u));return c.write_shift(2,0),c}function dL(a){return[a.read_shift(1),a.read_shift(1),a.read_shift(1),a.read_shift(1)]}function gL(a){return a=dL(a),a[3]=0,a}function Yc(a){return{r:a.read_shift(2),c:a.read_shift(2),ixfe:a.read_shift(2)}}function Qd(a,c,u,f){return(f=f||it(6)).write_shift(2,a),f.write_shift(2,c),f.write_shift(2,u||0),f}function mL(a){return[a.read_shift(2),KR(a)]}function OS(a){var c=a.read_shift(2),u=a.read_shift(2);return{s:{c:a.read_shift(2),r:c},e:{c:a.read_shift(2),r:u}}}function pL(a,c){return(c=c||it(8)).write_shift(2,a.s.r),c.write_shift(2,a.e.r),c.write_shift(2,a.s.c),c.write_shift(2,a.e.c),c}function vL(a){var c=a.read_shift(2),u=a.read_shift(2);return{s:{c:a.read_shift(1),r:c},e:{c:a.read_shift(1),r:u}}}var pre=vL;function wL(a){a.l+=4;var c=a.read_shift(2),u=a.read_shift(2),f=a.read_shift(2);return a.l+=12,[u,c,f]}function wo(a){a.l+=2,a.l+=a.read_shift(2)}var vre={0:wo,4:wo,5:wo,6:wo,7:function(a){return a.l+=4,a.cf=a.read_shift(2),{}},8:wo,9:wo,10:wo,11:wo,12:wo,13:function(a){var c={};return a.l+=4,a.l+=16,c.fSharedNote=a.read_shift(2),a.l+=4,c},14:wo,15:wo,16:wo,17:wo,18:wo,19:wo,20:wo,21:wL};function IS(a,c){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=a.read_shift(2),2<=(c-=2)&&(u.dt=a.read_shift(2),a.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<c)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return a.read_shift(c),u}function nA(a,c,u){var f=1536,m=16;switch(u.bookType){case"biff8":break;case"biff5":f=1280,m=8;break;case"biff4":f=4,m=6;break;case"biff3":f=3,m=6;break;case"biff2":f=2,m=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=it(m),u.write_shift(2,f),u.write_shift(2,c),4<m&&u.write_shift(2,29282),6<m&&u.write_shift(2,1997),8<m&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function wre(a){var c=it(8);c.write_shift(4,a.Count),c.write_shift(4,a.Unique);for(var u,f,m,v=[],p=0;p<a.length;++p)v[p]=(u=a[p],m=f=void 0,f=u.t||"",(m=it(3)).write_shift(2,f.length),m.write_shift(1,1),(u=it(2*f.length)).write_shift(2*f.length,f,"utf16le"),ke([m,u]));var w=ke([c].concat(v));return w.parts=[c.length].concat(v.map(function(S){return S.length})),w}function yL(a,c,u){var f=0;return u&&u.biff==2||(f=a.read_shift(2)),a=a.read_shift(2),u&&u.biff==2&&(f=1-(a>>15),a&=32767),[{Unsynced:1&f,DyZero:(2&f)>>1,ExAsc:(4&f)>>2,ExDsc:(8&f)>>3},a]}var vm=Jd;function CL(a,v,p){var f=a.l+v,w=p.biff!=8&&p.biff?2:4,m=a.read_shift(w),v=a.read_shift(w),p=a.read_shift(2),w=a.read_shift(2);return a.l=f,{s:{r:m,c:p},e:{r:v,c:w}}}function SL(a,c,u,f){return u=u&&u.biff==5,(f=f||it(u?16:20)).write_shift(2,0),a.style?(f.write_shift(2,a.numFmtId||0),f.write_shift(2,65524)):(f.write_shift(2,a.numFmtId||0),f.write_shift(2,c<<4)),c=0,0<a.numFmtId&&u&&(c|=1024),f.write_shift(4,c),f.write_shift(4,0),u||f.write_shift(4,0),f.write_shift(2,0),f}function bL(a,c,u){var f=Yc(a);return u.biff!=2&&c!=9||++a.l,a=(c=a).read_shift(1),a=c.read_shift(1)===1?a:a===1,f.val=a,f.t=a===!0||a===!1?"b":"e",f}function xL(a,c,u){return c===0?"":Jd(a,0,u)}function EL(a,c,u){var f,m=a.read_shift(2),m={fBuiltIn:1&m,fWantAdvise:m>>>1&1,fWantPict:m>>>2&1,fOle:m>>>3&1,fOleLink:m>>>4&1,cf:m>>>5&1023,fIcon:m>>>15&1};return u.sbcch===14849&&(f=function(v,b,w){v.l+=4,b-=4;var S=v.l+b,b=ev(v,0,w);if((w=v.read_shift(2))!==(S-=v.l))throw new Error("Malformed AddinUdf: padding = "+S+" != "+w);return v.l+=w,b}(a,c-2,u)),m.body=f||a.read_shift(c-2),typeof f=="string"&&(m.Name=f),m}var yre=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function TL(a,S,u){var f=a.l+S,m=a.read_shift(2),v=a.read_shift(1),p=a.read_shift(1),w=a.read_shift(u&&u.biff==2?1:2),S=0;return(!u||5<=u.biff)&&(u.biff!=5&&(a.l+=2),S=a.read_shift(2),u.biff==5&&(a.l+=2),a.l+=4),p=qd(a,p,u),32&m&&(p=yre[p.charCodeAt(0)]),m=f-a.l,u&&u.biff==2&&--m,{chKey:v,Name:p,itab:S,rgce:f!=a.l&&w!==0&&0<m?function(b,j,P,L){var k,j=b.l+j,L=hv(b,L,P);return j!==b.l&&(k=uv(b,j-b.l,L,P)),[L,k]}(a,m,u,w):[]}}function _L(a,c,u){if(u.biff<8)return function(w,S){return w[w.l+1]==3&&w[w.l]++,S=ev(w,0,S),S.charCodeAt(0)==3?S.slice(1):S}(a,u);for(var f,m,v=[],c=a.l+c,p=a.read_shift(8<u.biff?4:2);p--!=0;)v.push((f=a,u.biff,m=8<(m=u).biff?4:2,[f.read_shift(m),f.read_shift(m,"i"),f.read_shift(m,"i")]));if(a.l!=c)throw new Error("Bad ExternSheet: "+a.l+" != "+c);return v}function RL(a,c,u){var f=pre(a);switch(u.biff){case 2:a.l++,c-=7;break;case 3:case 4:a.l+=2,c-=8;break;default:a.l+=6,c-=12}return[f,function(m,v,p){var w,S=m.l+v,b=p.biff==2?1:2,T=m.read_shift(b);if(T==65535)return[[],mo(m,v-2)];var P=hv(m,T,p);return v!==T+b&&(w=uv(m,v-T-b,P,p)),m.l=S,[P,w]}(a,c,u)]}var Cre={8:function(a,c){var u=a.l+c;a.l+=10;var f=a.read_shift(2);return a.l+=4,a.l+=2,a.l+=2,a.l+=2,a.l+=4,c=a.read_shift(1),a.l+=c,a.l=u,{fmt:f}}};function Sre(a){var c=it(24),u=Ri(a[0]);c.write_shift(2,u.r),c.write_shift(2,u.r),c.write_shift(2,u.c),c.write_shift(2,u.c);for(var f="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),m=0;m<16;++m)c.write_shift(1,parseInt(f[m],16));return ke([c,function(v){var p=it(512),w=0,S=v.Target,b=-1<(v=(S=S.slice(0,7)=="file://"?S.slice(7):S).indexOf("#"))?31:23;switch(S.charAt(0)){case"#":b=28;break;case".":b&=-3}p.write_shift(4,2),p.write_shift(4,b);for(var T=[8,6815827,6619237,4849780,83],w=0;w<T.length;++w)p.write_shift(4,T[w]);if(b==28)fL(S=S.slice(1),p);else if(2&b){for(T="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),w=0;w<T.length;++w)p.write_shift(1,parseInt(T[w],16));var P=-1<v?S.slice(0,v):S;for(p.write_shift(4,2*(P.length+1)),w=0;w<P.length;++w)p.write_shift(2,P.charCodeAt(w));p.write_shift(2,0),8&b&&fL(-1<v?S.slice(v+1):"",p)}else{for(T="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),w=0;w<T.length;++w)p.write_shift(1,parseInt(T[w],16));for(var M=0;S.slice(3*M,3*M+3)=="../"||S.slice(3*M,3*M+3)=="..\\";)++M;for(p.write_shift(2,M),p.write_shift(4,S.length-3*M+1),w=0;w<S.length-3*M;++w)p.write_shift(1,255&S.charCodeAt(w+3*M));for(p.write_shift(1,0),p.write_shift(2,65535),p.write_shift(2,57005),w=0;w<6;++w)p.write_shift(4,0)}return p.slice(0,p.l)}(a[1])])}function AL(a,S,u){if(!u.cellStyles)return mo(a,S);var f=u&&12<=u.biff?4:2,m=a.read_shift(f),v=a.read_shift(f),p=a.read_shift(f),w=a.read_shift(f),S=a.read_shift(2);return f==2&&(a.l+=2),w={s:m,e:v,w:p,ixfe:w,flags:S},(5<=u.biff||!u.biff)&&(w.level=S>>8&7),w}var bre=Yc,xre=cL,WA=tv,OL,IL,PS,Ere=[2,3,48,49,131,139,140,245],iA=(OL={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},IL=jc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),PS={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(a,c){try{return vf(PL(a,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:PL,from_sheet:function(a,c){if(0<=+(c=c||{}).codepage&&y(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=ha(),f=(c=ZS(a,{header:1,raw:!0,cellDates:!0}))[0],m=c.slice(1),v=a["!cols"]||[],b=0,p=0,w=0,S=1,b=0;b<f.length;++b)if(((v[b]||{}).DBF||{}).name)f[b]=v[b].DBF.name,++w;else if(f[b]!=null){if(++w,typeof f[b]=="number"&&(f[b]=f[b].toString(10)),typeof f[b]!="string")throw new Error("DBF Invalid column name "+f[b]+" |"+typeof f[b]+"|");if(f.indexOf(f[b])!==b){for(p=0;p<1024;++p)if(f.indexOf(f[b]+"_"+p)==-1){f[b]+="_"+p;break}}}var T=un(a["!ref"]),P=[],M=[],k=[];for(b=0;b<=T.e.c-T.s.c;++b){for(var j="",L="",Q=0,G=[],p=0;p<m.length;++p)m[p][b]!=null&&G.push(m[p][b]);if(G.length!=0&&f[b]!=null){for(p=0;p<G.length;++p){switch(typeof G[p]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=G[p]instanceof Date?"D":"C";break;default:L="C"}Q=Math.max(Q,String(G[p]).length),j=j&&j!=L?"C":L}250<Q&&(Q=250),(L=((v[b]||{}).DBF||{}).type)=="C"&&v[b].DBF.len>Q&&(Q=v[b].DBF.len),j=="B"&&L=="N"&&(j="N",k[b]=v[b].DBF.dec,Q=v[b].DBF.len),M[b]=j=="C"||L=="N"?Q:PS[j]||0,S+=M[b],P[b]=j}else P[b]="?"}var W,J,ne=u.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,m.length),ne.write_shift(2,296+32*w),ne.write_shift(2,S),b=0;b<4;++b)ne.write_shift(4,0);for(ne.write_shift(4,0|(+IL[l]||3)<<8),p=b=0;b<f.length;++b)f[b]!=null&&(W=u.next(32),J=(f[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),W.write_shift(1,J,"sbcs"),W.write_shift(1,P[b]=="?"?"C":P[b],"sbcs"),W.write_shift(4,p),W.write_shift(1,M[b]||PS[P[b]]||0),W.write_shift(1,k[b]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),p+=M[b]||PS[P[b]]||0);var se=u.next(264);for(se.write_shift(4,13),b=0;b<65;++b)se.write_shift(4,0);for(b=0;b<m.length;++b){var xe=u.next(S);for(xe.write_shift(1,0),p=0;p<f.length;++p)if(f[p]!=null)switch(P[p]){case"L":xe.write_shift(1,m[b][p]==null?63:m[b][p]?84:70);break;case"B":xe.write_shift(8,m[b][p]||0,"f");break;case"N":var He="0";for(typeof m[b][p]=="number"&&(He=m[b][p].toFixed(k[p]||0)),w=0;w<M[p]-He.length;++w)xe.write_shift(1,32);xe.write_shift(1,He,"sbcs");break;case"D":m[b][p]?(xe.write_shift(4,("0000"+m[b][p].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(m[b][p].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+m[b][p].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var Fe=String(m[b][p]!=null?m[b][p]:"").slice(0,M[p]);for(xe.write_shift(1,Fe,"sbcs"),w=0;w<M[p]-Fe.length;++w)xe.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function PL(a,c){return c=c||{},c.dateNF||(c.dateNF="yyyymmdd"),a=sm(function(u,f){var m=[],v=Y(1);switch(f.type){case"base64":v=me(U(u));break;case"binary":v=me(u);break;case"buffer":case"array":v=u}Xs(v,0);var p=v.read_shift(1),w=!!(136&p),S=!1,b=!1;switch(p){case 2:case 3:break;case 48:case 49:w=S=!0;break;case 131:case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var T=0,P=521;p==2&&(T=v.read_shift(2)),v.l+=3,1048576<(T=p!=2?v.read_shift(4):T)&&(T=1e6),p!=2&&(P=v.read_shift(2));var M=v.read_shift(2),k=f.codepage||1252;p!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(k=OL[v[v.l]]),v.l+=1,v.l+=2),b&&(v.l+=36);for(var j=[],L={},Q=Math.min(v.length,p==2?521:P-10-(S?264:0)),G=b?32:11;v.l<Q&&v[v.l]!=13;)switch((L={}).name=n.utils.decode(k,v.slice(v.l,v.l+G)).replace(/[\u0000\r\n].*$/g,""),v.l+=G,L.type=String.fromCharCode(v.read_shift(1)),p==2||b||(L.offset=v.read_shift(4)),L.len=v.read_shift(1),p==2&&(L.offset=v.read_shift(2)),L.dec=v.read_shift(1),L.name.length&&j.push(L),p!=2&&(v.l+=b?13:14),L.type){case"B":S&&L.len==8||!f.WTF||console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(v[v.l]!==13&&(v.l=P-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=P;var W=0,J=0;for(m[0]=[],J=0;J!=j.length;++J)m[0][J]=j[J].name;for(;0<T--;)if(v[v.l]!==42)for(++v.l,m[++W]=[],J=J=0;J!=j.length;++J){var ne=v.slice(v.l,v.l+j[J].len);v.l+=j[J].len,Xs(ne,0);var se=n.utils.decode(k,ne);switch(j[J].type){case"C":se.trim().length&&(m[W][J]=se.replace(/\s+$/,""));break;case"D":se.length===8?m[W][J]=new Date(+se.slice(0,4),+se.slice(4,6)-1,+se.slice(6,8)):m[W][J]=se;break;case"F":m[W][J]=parseFloat(se.trim());break;case"+":case"I":m[W][J]=b?2147483648^ne.read_shift(-4,"i"):ne.read_shift(4,"i");break;case"L":switch(se.trim().toUpperCase()){case"Y":case"T":m[W][J]=!0;break;case"N":case"F":m[W][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+se+"|")}break;case"M":if(!w)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));m[W][J]="##MEMO##"+(b?parseInt(se.trim(),10):ne.read_shift(4));break;case"N":(se=se.replace(/\u0000/g,"").trim())&&se!="."&&(m[W][J]=+se||0);break;case"@":m[W][J]=new Date(ne.read_shift(-8,"f")-621356832e5);break;case"T":m[W][J]=new Date(864e5*(ne.read_shift(4)-2440588)+ne.read_shift(4));break;case"Y":m[W][J]=ne.read_shift(4,"i")/1e4+ne.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[W][J]=-ne.read_shift(-8,"f");break;case"B":if(S&&j[J].len==8){m[W][J]=ne.read_shift(8,"f");break}case"G":case"P":ne.l+=j[J].len;break;case"0":if(j[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[J].type)}}else v.l+=M;if(p!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=j,m}(a,c),c),a["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,a}var FS,FL,ML,kL,NL=(FS={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},FL=new RegExp("\x1BN("+ii(FS).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),ML=function(a,c){return c=FS[c],typeof c=="number"?I(c):c},kL=function(a,c,u){return u=c.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?a:I(u)},FS["|"]=254,{to_workbook:function(a,c){return vf(DL(a,c),c)},to_sheet:DL,from_sheet:function(a,c){var u,f,m=["ID;PWXL;N;E"],v=[],p=un(a["!ref"]),w=Array.isArray(a),S=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),a["!cols"]&&(u=m,a["!cols"].forEach(function(M,k){k="F;W"+(k+1)+" "+(k+1)+" ",M.hidden?k+="0":(typeof M.width!="number"||M.wpx||(M.wpx=iv(M.width)),typeof M.wpx!="number"||M.wch||(M.wch=sv(M.wpx)),typeof M.wch=="number"&&(k+=Math.round(M.wch))),k.charAt(k.length-1)!=" "&&u.push(k)})),a["!rows"]&&(f=m,a["!rows"].forEach(function(M,k){var j="F;";M.hidden?j+="M0;":M.hpt?j+="M"+20*M.hpt+";":M.hpx&&(j+="M"+20*ov(M.hpx)+";"),2<j.length&&f.push(j+"R"+(k+1))})),m.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var b=p.s.r;b<=p.e.r;++b)for(var T=p.s.c;T<=p.e.c;++T){var P=Nr({r:b,c:T});(P=w?(a[b]||[])[T]:a[P])&&(P.v!=null||P.f&&!P.F)&&v.push(function(M,k,j){var L="C;Y"+(k+1)+";X"+(j+1)+";K";switch(M.t){case"n":L+=M.v||0,M.f&&!M.F&&(L+=";E"+yA(M.f,{r:k,c:j}));break;case"b":L+=M.v?"TRUE":"FALSE";break;case"e":L+=M.w||M.v;break;case"d":L+='"'+(M.w||M.v)+'"';break;case"s":L+='"'+M.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return L}(P,b,T))}return m.join(S)+S+v.join(S)+S+"E"+S}});function MS(M,c){var u,f,m=M.split(/[\n\r]+/),v=-1,p=-1,w=0,S=0,b=[],T=[],P=null,M={},k=[],j=[],L=0;for(0<=+c.codepage&&y(+c.codepage);w!==m.length;++w){L=0;var Q,G=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,kL).replace(FL,ML),W=G.replace(/;;/g,"\0").split(";").map(function(St){return St.replace(/\u0000/g,";")}),J=W[0];if(0<G.length)switch(J){case"ID":case"E":case"B":case"O":case"W":break;case"P":W[1].charAt(0)=="P"&&T.push(G.slice(3).replace(/;;/g,";"));break;case"C":for(var ne=!1,se=!1,xe=!1,He=!1,Fe=-1,Ue=-1,S=1;S<W.length;++S)switch(W[S].charAt(0)){case"A":break;case"X":p=parseInt(W[S].slice(1))-1,se=!0;break;case"Y":for(v=parseInt(W[S].slice(1))-1,se||(p=0),f=b.length;f<=v;++f)b[f]=[];break;case"K":(Q=W[S].slice(1)).charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Ve(Q))?isNaN(ie(Q).getDate())||(Q=ue(Q)):(Q=Ve(Q),P!==null&&Si(P)&&(Q=ee(Q))),n!==void 0&&typeof Q=="string"&&(c||{}).type!="string"&&(c||{}).codepage&&(Q=n.utils.decode(c.codepage,Q)),ne=!0;break;case"E":He=!0;var ct=gm(W[S].slice(1),{r:v,c:p});b[v][p]=[b[v][p],ct];break;case"S":xe=!0,b[v][p]=[b[v][p],"S5S"];break;case"G":break;case"R":Fe=parseInt(W[S].slice(1))-1;break;case"C":Ue=parseInt(W[S].slice(1))-1;break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}if(ne&&(b[v][p]&&b[v][p].length==2?b[v][p][0]=Q:b[v][p]=Q,P=null),xe){if(He)throw new Error("SYLK shared formula cannot have own formula");var ut=-1<Fe&&b[Fe][Ue];if(!ut||!ut[1])throw new Error("SYLK shared formula cannot find base");b[v][p][1]=P8(ut[1],{r:v-Fe,c:p-Ue})}break;case"F":var Ke=0;for(S=1;S<W.length;++S)switch(W[S].charAt(0)){case"X":p=parseInt(W[S].slice(1))-1,++Ke;break;case"Y":for(v=parseInt(W[S].slice(1))-1,f=b.length;f<=v;++f)b[f]=[];break;case"M":L=parseInt(W[S].slice(1))/20;break;case"F":case"G":break;case"P":P=T[parseInt(W[S].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=W[S].slice(1).split(" "),f=parseInt(u[0],10);f<=parseInt(u[1],10);++f)L=parseInt(u[2],10),j[f-1]=L===0?{hidden:!0}:{wch:L},yf(j[f-1]);break;case"C":j[p=parseInt(W[S].slice(1))-1]||(j[p]={});break;case"R":k[v=parseInt(W[S].slice(1))-1]||(k[v]={}),0<L?(k[v].hpt=L,k[v].hpx=fm(L)):L===0&&(k[v].hidden=!0);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}Ke<1&&(P=null);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}}return 0<k.length&&(M["!rows"]=k),0<j.length&&(M["!cols"]=j),[b=c&&c.sheetRows?b.slice(0,c.sheetRows):b,M]}function DL(f,c){var u=function(p,w){switch(w.type){case"base64":return MS(U(p),w);case"binary":return MS(p,w);case"buffer":return MS(X&&Buffer.isBuffer(p)?p.toString("binary"):ye(p),w);case"array":return MS(pe(p),w)}throw new Error("Unrecognized type "+w.type)}(f,c),f=u[0],m=u[1],v=sm(f,c);return ii(m).forEach(function(p){v[p]=m[p]}),v}var LL={to_workbook:function(a,c){return vf(HL(a,c),c)},to_sheet:HL,from_sheet:function(a){var c=[],u=un(a["!ref"]),f=Array.isArray(a);NS(c,"TABLE",0,1,"sheetjs"),NS(c,"VECTORS",0,u.e.r-u.s.r+1,""),NS(c,"TUPLES",0,u.e.c-u.s.c+1,""),NS(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){Kc(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var p,w=Nr({r:m,c:v});if(p=f?(a[m]||[])[v]:a[w])switch(p.t){case"n":var S=p.w;(S=!S&&p.v!=null?p.v:S)==null?p.f&&!p.F?Kc(c,1,0,"="+p.f):Kc(c,1,0,""):Kc(c,0,S,"V");break;case"b":Kc(c,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":Kc(c,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=vr(p.z||B[14],ci(ue(p.v)))),Kc(c,0,p.w,"V");break;default:Kc(c,1,0,"")}else Kc(c,1,0,"")}}return Kc(c,-1,0,"EOD"),c.join(`\r
`)}};function kS(a,c){for(var u=a.split(`
`),f=-1,m=-1,v=0,p=[];v!==u.length;++v)if(u[v].trim()!=="BOT"){if(!(f<0)){for(var w=u[v].trim().split(","),S=w[0],b=w[1],T=u[++v]||"";1&(T.match(/["]/g)||[]).length&&v<u.length-1;)T+=`
`+u[++v];switch(T=T.trim(),+S){case-1:if(T==="BOT"){p[++f]=[],m=0;continue}if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?p[f][m]=!0:T==="FALSE"?p[f][m]=!1:isNaN(Ve(b))?isNaN(ie(b).getDate())?p[f][m]=b:p[f][m]=ue(b):p[f][m]=Ve(b),++m;break;case 1:T=(T=T.slice(1,T.length-1)).replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),p[f][m++]=T!==""?T:null}if(T==="EOD")break}}else p[++f]=[],m=0;return p=c&&c.sheetRows?p.slice(0,c.sheetRows):p}function HL(a,c){return sm(function(u,f){switch(f.type){case"base64":return kS(U(u),f);case"binary":return kS(u,f);case"buffer":return kS(X&&Buffer.isBuffer(u)?u.toString("binary"):ye(u),f);case"array":return kS(pe(u),f)}throw new Error("Unrecognized type "+f.type)}(a,c),c)}function NS(a,c,u,f,m){a.push(c),a.push(u+","+f),a.push('"'+m.replace(/"/g,'""')+'"')}function Kc(a,c,u,f){a.push(c+","+u),a.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)}var $L,sA,BL,VL,WL=($L=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),sA=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,BL=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),VL="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(a,c){return vf(jL(a,c),c)},to_sheet:jL,from_sheet:function(a){return[$L,sA,BL,sA,function(c){if(!c||!c["!ref"])return"";for(var u,f,m=[],v=[],p=Ho(c["!ref"]),w=Array.isArray(c),S=p.s.r;S<=p.e.r;++S)for(var b=p.s.c;b<=p.e.c;++b)if(f=Nr({r:S,c:b}),(u=w?(c[S]||[])[b]:c[f])&&u.v!=null&&u.t!=="z"){switch(v=["cell",f,"t"],u.t){case"s":case"str":v.push(oA(u.v));break;case"n":u.f?(v[2]="vtf",v[3]="n",v[4]=u.v,v[5]=oA(u.f)):(v[2]="v",v[3]=u.v);break;case"b":v[2]="vt"+(u.f?"f":"c"),v[3]="nl",v[4]=u.v?"1":"0",v[5]=oA(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var T=ci(ue(u.v));v[2]="vtc",v[3]="nd",v[4]=""+T,v[5]=u.w||vr(u.z||B[14],T);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}(a),VL].join(`
`)}});function oA(a){return a.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function jL(a,c){return sm(function(u,f){for(var m,v=u.split(`
`),p=-1,w=0,S=[];w!==v.length;++w){var b=v[w].trim().split(":");if(b[0]==="cell"){var T=Ri(b[1]);if(S.length<=T.r)for(p=S.length;p<=T.r;++p)S[p]||(S[p]=[]);switch(p=T.r,m=T.c,b[2]){case"t":S[p][m]=b[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":S[p][m]=+b[3];break;case"vtf":var P=b[b.length-1];case"vtc":b[3]==="nl"?S[p][m]=!!+b[4]:S[p][m]=+b[4],b[2]=="vtf"&&(S[p][m]=[S[p][m],P])}}}return S=f&&f.sheetRows?S.slice(0,f.sheetRows):S}(a,c),c)}var aA,DS,cm=(aA={44:",",9:"	",59:";",124:"|"},DS={44:3,9:2,59:1,124:0},{to_workbook:function(a,c){return vf(GL(a,c),c)},to_sheet:GL,from_sheet:function(a){for(var c=[],u=un(a["!ref"]),f=Array.isArray(a),m=u.s.r;m<=u.e.r;++m){for(var v=[],p=u.s.c;p<=u.e.c;++p){var w=Nr({r:m,c:p});if((w=f?(a[m]||[])[p]:a[w])&&w.v!=null){for(var S=(w.w||(Gc(w),w.w)||"").slice(0,10);S.length<10;)S+=" ";v.push(S+(p===0?" ":""))}else v.push("          ")}c.push(v.join(""))}return c.join(`
`)}});function UL(a,c,u,f,m){m.raw?c[u][f]=a:a===""||(a==="TRUE"?c[u][f]=!0:a==="FALSE"?c[u][f]=!1:isNaN(Ve(a))?isNaN(ie(a).getDate())?c[u][f]=a:c[u][f]=ue(a):c[u][f]=Ve(a))}function zL(a){for(var c={},u=!1,f=0,m=0;f<a.length;++f)(m=a.charCodeAt(f))==34?u=!u:!u&&m in aA&&(c[m]=(c[m]||0)+1);for(f in m=[],c)Object.prototype.hasOwnProperty.call(c,f)&&m.push([c[f],f]);if(!m.length)for(f in c=DS)Object.prototype.hasOwnProperty.call(c,f)&&m.push([c[f],f]);return m.sort(function(v,p){return v[0]-p[0]||DS[v[1]]-DS[p[1]]}),aA[m.pop()[1]]||44}function Tre(a,f){var u=f||{},f="",m=u.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};a.slice(0,4)=="sep="?a.charCodeAt(5)==13&&a.charCodeAt(6)==10?(f=a.charAt(4),a=a.slice(7)):a.charCodeAt(5)==13||a.charCodeAt(5)==10?(f=a.charAt(4),a=a.slice(6)):f=zL(a.slice(0,1024)):f=u.FS?u.FS:zL(a.slice(0,1024));var p=0,w=0,S=0,b=0,T=0,P=f.charCodeAt(0),M=!1,k=0,j=a.charCodeAt(0);a=a.replace(/\r\n/gm,`
`);var L=u.dateNF!=null?(f=(f=typeof(f=u.dateNF)=="number"?B[f]:f).replace(rm,"(\\d+)"),new RegExp("^"+f+"$")):null;function Q(){var G,W=a.slice(b,T),J={};if((W=W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'?W.slice(1,-1).replace(/""/g,'"'):W).length===0?J.t="z":u.raw||W.trim().length===0?(J.t="s",J.v=W):W.charCodeAt(0)==61?W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(J.t="s",J.v=W.slice(2,-1).replace(/""/g,'"')):W.length!=1?(J.t="n",J.f=W.slice(1)):(J.t="s",J.v=W):W=="TRUE"?(J.t="b",J.v=!0):W=="FALSE"?(J.t="b",J.v=!1):isNaN(S=Ve(W))?!isNaN(ie(W).getDate())||L&&W.match(L)?(J.z=u.dateNF||B[14],G=0,L&&W.match(L)&&(W=function(ne,se){var xe=-1,He=-1,Fe=-1,Ue=-1,ct=-1,ut=-1;(ne.match(rm)||[]).forEach(function(St,Wt){var $t=parseInt(se[Wt+1],10);switch(St.toLowerCase().charAt(0)){case"y":xe=$t;break;case"d":Fe=$t;break;case"h":Ue=$t;break;case"s":ut=$t;break;case"m":0<=Ue?ct=$t:He=$t}}),0<=ut&&ct==-1&&0<=He&&(ct=He,He=-1);var Ke=(""+(0<=xe?xe:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=He?He:1)).slice(-2)+"-"+("00"+(1<=Fe?Fe:1)).slice(-2);return(Ke=Ke.length==7?"0"+Ke:Ke).length==8&&(Ke="20"+Ke),ne=("00"+(0<=Ue?Ue:0)).slice(-2)+":"+("00"+(0<=ct?ct:0)).slice(-2)+":"+("00"+(0<=ut?ut:0)).slice(-2),Ue==-1&&ct==-1&&ut==-1?Ke:xe==-1&&He==-1&&Fe==-1?ne:Ke+"T"+ne}(u.dateNF,W.match(L)||[]),G=1),u.cellDates?(J.t="d",J.v=ue(W,G)):(J.t="n",J.v=ci(ue(W,G))),u.cellText!==!1&&(J.w=vr(J.z,J.v instanceof Date?ci(J.v):J.v)),u.cellNF||delete J.z):(J.t="s",J.v=W):(!(J.t="n")!==u.cellText&&(J.w=W),J.v=S),J.t=="z"||(u.dense?(m[p]||(m[p]=[]),m[p][w]=J):m[Nr({c:w,r:p})]=J),b=T+1,j=a.charCodeAt(b),v.e.c<w&&(v.e.c=w),v.e.r<p&&(v.e.r=p),k!=P)return w=0,++p,u.sheetRows&&u.sheetRows<=p?1:void 0;++w}e:for(;T<a.length;++T)switch(k=a.charCodeAt(T)){case 34:j===34&&(M=!M);break;case P:case 10:case 13:if(!M&&Q())break e}return 0<T-b&&Q(),m["!ref"]=jr(v),m}function _re(a,c){return!c||!c.PRN||c.FS||a.slice(0,4)=="sep="||0<=a.indexOf("	")||0<=a.indexOf(",")||0<=a.indexOf(";")?Tre(a,c):sm(function(u,f){var m=f||{},v=[];if(!u||u.length===0)return v;for(var p=u.split(/[\r\n]/),w=p.length-1;0<=w&&p[w].length===0;)--w;for(var S=10,b=0,T=0;T<=w;++T)(b=p[T].indexOf(" "))==-1?b=p[T].length:b++,S=Math.max(S,b);for(T=0;T<=w;++T){v[T]=[];var P=0;for(UL(p[T].slice(0,S).trim(),v,T,P,m),P=1;P<=(p[T].length-S)/10+1;++P)UL(p[T].slice(S+10*(P-1),S+10*P).trim(),v,T,P,m)}return v=m.sheetRows?v.slice(0,m.sheetRows):v}(a,c),c)}function GL(a,c){var u="",f=c.type=="string"?[0,0,0,0]:NA(a,c);switch(c.type){case"base64":u=U(a);break;case"binary":u=a;break;case"buffer":u=c.codepage==65001?a.toString("utf8"):c.codepage&&n!==void 0?n.utils.decode(c.codepage,a):X&&Buffer.isBuffer(a)?a.toString("binary"):ye(a);break;case"array":u=pe(a);break;case"string":u=a;break;default:throw new Error("Unrecognized type "+c.type)}return f[0]==239&&f[1]==187&&f[2]==191?u=qn(u.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?u=qn(u):c.type=="binary"&&n!==void 0&&c.codepage&&(u=n.utils.decode(c.codepage,n.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?WL.to_sheet(c.type=="string"?u:qn(u),c):_re(u,c)}var LS,lA,cA,YL,Zd=(LS={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},lA=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],cA={0:{n:"BOF",f:as},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(a,c,u){var f={s:{c:0,r:0},e:{c:0,r:0}};return c==8&&u.qpro?(f.s.c=a.read_shift(1),a.l++,f.s.r=a.read_shift(2),f.e.c=a.read_shift(1),a.l++,f.e.r=a.read_shift(2)):(f.s.c=a.read_shift(2),f.s.r=a.read_shift(2),c==12&&u.qpro&&(a.l+=2),f.e.c=a.read_shift(2),f.e.r=a.read_shift(2),c==12&&u.qpro&&(a.l+=2),f.s.c==65535&&(f.s.c=f.e.c=f.s.r=f.e.r=0)),f}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(a,c,u){return(u=HS(a,0,u))[1].v=a.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(a,c,u){return(u=HS(a,0,u))[1].v=a.read_shift(8,"f"),u}},15:{n:"LABEL",f:XL},16:{n:"FORMULA",f:function(a,c,u){var f=a.l+c;return(c=HS(a,0,u))[1].v=a.read_shift(8,"f"),u.qpro?a.l=f:(f=a.read_shift(2),function(m,v){Xs(m,0);for(var p=[],w=0,S="",b="",T="",P="";m.l<m.length;){var M=m[m.l++];switch(M){case 0:p.push(m.read_shift(8,"f"));break;case 1:b=um(v[0].c,m.read_shift(2),!0),S=um(v[0].r,m.read_shift(2),!1),p.push(b+S);break;case 2:var k=um(v[0].c,m.read_shift(2),!0),j=um(v[0].r,m.read_shift(2),!1);b=um(v[0].c,m.read_shift(2),!0),S=um(v[0].r,m.read_shift(2),!1),p.push(k+j+":"+b+S);break;case 3:if(m.l<m.length)return console.error("WK1 premature formula end");break;case 4:p.push("("+p.pop()+")");break;case 5:p.push(m.read_shift(2));break;case 6:for(var L="";M=m[m.l++];)L+=String.fromCharCode(M);p.push('"'+L.replace(/"/g,'""')+'"');break;case 8:p.push("-"+p.pop());break;case 23:p.push("+"+p.pop());break;case 22:p.push("NOT("+p.pop()+")");break;case 20:case 21:P=p.pop(),T=p.pop(),p.push(["AND","OR"][M-20]+"("+T+","+P+")");break;default:if(M<32&&lA[M])P=p.pop(),T=p.pop(),p.push(T+lA[M]+P);else{if(!LS[M])return M<=7?console.error("WK1 invalid opcode "+M.toString(16)):M<=24?console.error("WK1 unsupported op "+M.toString(16)):M<=30?console.error("WK1 invalid opcode "+M.toString(16)):M<=115?console.error("WK1 unsupported function opcode "+M.toString(16)):console.error("WK1 unrecognized opcode "+M.toString(16));if((w=(w=LS[M][1])==69?m[m.l++]:w)>p.length)return console.error("WK1 bad formula parse 0x"+M.toString(16)+":|"+p.join("|")+"|");j=p.slice(-w),p.length-=w,p.push(LS[M][0]+"("+j.join(",")+")")}}}p.length==1?v[1].f=""+p[0]:console.error("WK1 bad formula parse |"+p.join("|")+"|")}(a.slice(a.l,a.l+f),c),a.l+=f),c}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:XL},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:QL},222:{n:"SHEETNAMELP",f:function(a,c){var u=a[a.l++];c-1<u&&(u=c-1);for(var f="";f.length<u;)f+=String.fromCharCode(a[a.l++]);return f}},65535:{n:""}},YL={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(a,c){var u=rv(a);return u[1].t="s",u[1].v=a.read_shift(c-4,"cstr"),u}},23:{n:"NUMBER17",f:qL},24:{n:"NUMBER18",f:function(a,c){var u=rv(a);u[1].v=a.read_shift(2);var f=u[1].v>>1;if(1&u[1].v)switch(7&f){case 0:f=5e3*(f>>3);break;case 1:f=500*(f>>3);break;case 2:f=(f>>3)/20;break;case 3:f=(f>>3)/200;break;case 4:f=(f>>3)/2e3;break;case 5:f=(f>>3)/2e4;break;case 6:f=(f>>3)/16;break;case 7:f=(f>>3)/64}return u[1].v=f,u}},25:{n:"FORMULA19",f:function(a,c){var u=qL(a);return a.l+=c-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(a,c){for(var u={},f=a.l+c;a.l<f;){var m=a.read_shift(2);if(m==14e3){for(u[m]=[0,""],u[m][0]=a.read_shift(2);a[a.l];)u[m][1]+=String.fromCharCode(a[a.l]),a.l++;a.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(f,c){var u=rv(f),f=f.read_shift(4);return u[1].v=f>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:JL},40:{n:"FORMULA28",f:function(a,c){var u=JL(a);return a.l+=c-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:QL},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(a,c,u){if(u.qpro&&!(c<21))return u=a.read_shift(1),a.l+=17,a.l+=1,a.l+=2,[u,a.read_shift(c-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(a,c){var u=c||{};if(0<=+u.codepage&&y(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var f=ha(),m=un(a["!ref"]),v=Array.isArray(a),p=[];Lt(f,0,(c=1030,(u=it(2)).write_shift(2,c),u)),Lt(f,6,(c=m,(u=it(8)).write_shift(2,c.s.c),u.write_shift(2,c.s.r),u.write_shift(2,c.e.c),u.write_shift(2,c.e.r),u));for(var w,S,b,T,P=Math.min(m.e.r,8191),M=m.s.r;M<=P;++M)for(var k=Vi(M),j=m.s.c;j<=m.e.c;++j){M===m.s.r&&(p[j]=fi(j));var L=p[j]+k,L=v?(a[M]||[])[j]:a[L];L&&L.t!="z"&&(L.t=="n"?(0|L.v)==L.v&&-32768<=L.v&&L.v<=32767?Lt(f,13,(w=M,S=j,b=L.v,T=void 0,(T=it(7)).write_shift(1,255),T.write_shift(2,S),T.write_shift(2,w),T.write_shift(2,b,"i"),T)):Lt(f,14,(S=M,w=j,b=L.v,T=void 0,(T=it(13)).write_shift(1,255),T.write_shift(2,w),T.write_shift(2,S),T.write_shift(8,b,"f"),T)):Lt(f,15,function(Q,G,W){var J=it(7+W.length);J.write_shift(1,255),J.write_shift(2,G),J.write_shift(2,Q),J.write_shift(1,39);for(var ne=0;ne<J.length;++ne){var se=W.charCodeAt(ne);J.write_shift(1,128<=se?95:se)}return J.write_shift(1,0),J}(M,j,Gc(L).slice(0,239))))}return Lt(f,1),f.end()},book_to_wk3:function(a,c){if(0<=+(c=c||{}).codepage&&y(+c.codepage),c.type=="string")throw new Error("Cannot write WK3 to JS string");var u=ha();Lt(u,0,function(L){var Q=it(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var G=0,W=0,J=0,ne=0;ne<L.SheetNames.length;++ne){var se=L.SheetNames[ne],se=L.Sheets[se];se&&se["!ref"]&&(++J,se=Ho(se["!ref"]),G<se.e.r&&(G=se.e.r),W<se.e.c&&(W=se.e.c))}return 8191<G&&(G=8191),Q.write_shift(2,G),Q.write_shift(1,J),Q.write_shift(1,W),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}(a));for(var f=0,m=0;f<a.SheetNames.length;++f)(a.Sheets[a.SheetNames[f]]||{})["!ref"]&&Lt(u,27,function(L,Q){var G=it(5+L.length);G.write_shift(2,14e3),G.write_shift(2,Q);for(var W=0;W<L.length;++W){var J=L.charCodeAt(W);G[G.l++]=127<J?95:J}return G[G.l++]=0,G}(a.SheetNames[f],m++));for(var v=0,f=0;f<a.SheetNames.length;++f){var p=a.Sheets[a.SheetNames[f]];if(p&&p["!ref"]){for(var w=un(p["!ref"]),S=Array.isArray(p),b=[],T=Math.min(w.e.r,8191),P=w.s.r;P<=T;++P)for(var M=Vi(P),k=w.s.c;k<=w.e.c;++k){P===w.s.r&&(b[k]=fi(k));var j=b[k]+M,j=S?(p[P]||[])[k]:p[j];j&&j.t!="z"&&(j.t=="n"?Lt(u,23,function(xe,Fe,He,J){var ne=it(14);if(ne.write_shift(2,xe),ne.write_shift(1,He),ne.write_shift(1,Fe),J==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var se=0,xe=0,He=0,Fe=0;return J<0&&(se=1,J=-J),xe=0|Math.log2(J),J/=Math.pow(2,xe-31),!(2147483648&(Fe=J>>>0))&&(++xe,Fe=(J/=2)>>>0),J-=Fe,Fe|=2147483648,Fe>>>=0,J*=Math.pow(2,32),He=J>>>0,ne.write_shift(4,He),ne.write_shift(4,Fe),xe+=16383+(se?32768:0),ne.write_shift(2,xe),ne}(P,k,v,j.v)):Lt(u,22,function(Q,G,W,J){var ne=it(6+J.length);ne.write_shift(2,Q),ne.write_shift(1,W),ne.write_shift(1,G),ne.write_shift(1,39);for(var se=0;se<J.length;++se){var xe=J.charCodeAt(se);ne.write_shift(1,128<=xe?95:xe)}return ne.write_shift(1,0),ne}(P,k,v,Gc(j).slice(0,239))))}++v}}return Lt(u,1),u.end()},to_workbook:function(a,c){switch(c.type){case"base64":return uA(me(U(a)),c);case"binary":return uA(me(a),c);case"buffer":case"array":return uA(a,c)}throw"Unsupported type "+c.type}});function KL(a,c,u){if(a){Xs(a,a.l||0);for(var f=u.Enum||cA;a.l<a.length;){var m=a.read_shift(2),v=f[m]||f[65535],w=a.read_shift(2),p=a.l+w,w=v.f&&v.f(a,w,u);if(a.l=p,c(w,v,m))return}}}function uA(a,c){if(!a)return a;var u=c||{},f=u.dense?[]:{},m="Sheet1",v="",p=0,w={},S=[],b=[],T={s:{r:0,c:0},e:{r:0,c:0}},P=u.sheetRows||0;if(a[2]==0&&(a[3]==8||a[3]==9)&&16<=a.length&&a[14]==5&&a[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(a[2]==2)u.Enum=cA,KL(a,function(L,Q,G){switch(G){case 0:4096<=(u.vers=L)&&(u.qpro=!0);break;case 6:T=L;break;case 204:L&&(v=L);break;case 222:v=L;break;case 15:case 51:u.qpro||(L[1].v=L[1].v.slice(1));case 13:case 14:case 16:G==14&&(112&L[2])==112&&1<(15&L[2])&&(15&L[2])<15&&(L[1].z=u.dateNF||B[14],u.cellDates&&(L[1].t="d",L[1].v=ee(L[1].v))),u.qpro&&L[3]>p&&(f["!ref"]=jr(T),w[m]=f,S.push(m),f=u.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},p=L[3],m=v||"Sheet"+(p+1),v="");var W=u.dense?(f[L[0].r]||[])[L[0].c]:f[Nr(L[0])];if(W){W.t=L[1].t,W.v=L[1].v,L[1].z!=null&&(W.z=L[1].z),L[1].f!=null&&(W.f=L[1].f);break}u.dense?(f[L[0].r]||(f[L[0].r]=[]),f[L[0].r][L[0].c]=L[1]):f[Nr(L[0])]=L[1]}},u);else{if(a[2]!=26&&a[2]!=14)throw new Error("Unrecognized LOTUS BOF "+a[2]);u.Enum=YL,a[2]==14&&(u.qpro=!0,a.l=0),KL(a,function(L,Q,G){switch(G){case 204:m=L;break;case 22:L[1].v=L[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(L[3]>p&&(f["!ref"]=jr(T),w[m]=f,S.push(m),f=u.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},p=L[3],m="Sheet"+(p+1)),0<P&&L[0].r>=P)break;u.dense?(f[L[0].r]||(f[L[0].r]=[]),f[L[0].r][L[0].c]=L[1]):f[Nr(L[0])]=L[1],T.e.c<L[0].c&&(T.e.c=L[0].c),T.e.r<L[0].r&&(T.e.r=L[0].r);break;case 27:L[14e3]&&(b[L[14e3][0]]=L[14e3][1]);break;case 1537:b[L[0]]=L[1],L[0]==p&&(m=L[1])}},u)}if(f["!ref"]=jr(T),w[v||m]=f,S.push(v||m),!b.length)return{SheetNames:S,Sheets:w};for(var M={},k=[],j=0;j<b.length;++j)w[S[j]]?(k.push(b[j]||S[j]),M[b[j]]=w[b[j]]||w[S[j]]):(k.push(b[j]),M[b[j]]={"!ref":"A1"});return{SheetNames:k,Sheets:M}}function HS(a,c,u){var f=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(f[0].c=a.read_shift(1),f[3]=a.read_shift(1),f[0].r=a.read_shift(2),a.l+=2):(f[2]=a.read_shift(1),f[0].c=a.read_shift(2),f[0].r=a.read_shift(2)),f}function XL(a,m,u){var f=a.l+m,m=HS(a,0,u);return m[1].t="s",u.vers!=20768?(u.qpro&&a.l++,m[1].v=a.read_shift(f-a.l,"cstr"),m):(a.l++,f=a.read_shift(1),m[1].v=a.read_shift(f,"utf8"),m)}function um(a,c,u){var f=32768&c;return(f?"":"$")+(u?fi:Vi)(c=(f?a:0)+(8192<=(c&=-32769)?c-16384:c))}function rv(a){var c=[{c:0,r:0},{t:"n",v:0},0];return c[0].r=a.read_shift(2),c[3]=a[a.l++],c[0].c=a[a.l++],c}function qL(v,c){var u=rv(v),f=v.read_shift(4),m=v.read_shift(4);if((p=v.read_shift(2))==65535)return f===0&&m===3221225472?(u[1].t="e",u[1].v=15):f===0&&m===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var v=32768&p,p=(32767&p)-16446;return u[1].v=(1-2*v)*(m*Math.pow(2,32+p)+f*Math.pow(2,p)),u}function JL(f,c){var u=rv(f),f=f.read_shift(8,"f");return u[1].v=f,u}function QL(a,c){return a[a.l+c-1]==0?a.read_shift(c,"cstr"):""}var ZL,e8,t8,r8,Rre=(ZL=z1("t"),e8=z1("rPr"),t8=/<(?:\w+:)?r>/g,r8=/<\/(?:\w+:)?r>/,function(a){return a.replace(t8,"").split(r8).map(Are).filter(function(c){return c.v})});function Are(a){var c=a.match(ZL);return c?(c={t:"s",v:Sn(c[1])},a=a.match(e8),a&&(c.s=function(u){var f={},m=u.match(go),v=0,p=!1;if(m)for(;v!=m.length;++v){var w=kr(m[v]);switch(w[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!w.val)break;case"<shadow>":case"<shadow/>":f.shadow=1;break;case"</shadow>":break;case"<charset":if(w.val=="1")break;f.cp=d[parseInt(w.val,10)];break;case"<outline":if(!w.val)break;case"<outline>":case"<outline/>":f.outline=1;break;case"</outline>":break;case"<rFont":f.name=w.val;break;case"<sz":f.sz=w.val;break;case"<strike":if(!w.val)break;case"<strike>":case"<strike/>":f.strike=1;break;case"</strike>":break;case"<u":if(!w.val)break;switch(w.val){case"double":f.uval="double";break;case"singleAccounting":f.uval="single-accounting";break;case"doubleAccounting":f.uval="double-accounting"}case"<u>":case"<u/>":f.u=1;break;case"</u>":break;case"<b":if(w.val=="0")break;case"<b>":case"<b/>":f.b=1;break;case"</b>":break;case"<i":if(w.val=="0")break;case"<i>":case"<i/>":f.i=1;break;case"</i>":break;case"<color":w.rgb&&(f.color=w.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":f.family=w.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":f.valign=w.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(w[0].charCodeAt(1)!==47&&!p)throw new Error("Unrecognized rich format "+w[0])}}return f}(a[1])),c):{t:"s",v:""}}var n8,Ore=(n8=/(\r\n|\n)/g,function(a){return a.map(Ire).join("")});function Ire(a){var c,u,f,m=[[],a.v,[]];return a.v?(a.s&&(c=a.s,u=m[0],f=m[2],a=[],c.u&&a.push("text-decoration: underline;"),c.uval&&a.push("text-underline-style:"+c.uval+";"),c.sz&&a.push("font-size:"+c.sz+"pt;"),c.outline&&a.push("text-effect: outline;"),c.shadow&&a.push("text-shadow: auto;"),u.push('<span style="'+a.join("")+'">'),c.b&&(u.push("<b>"),f.push("</b>")),c.i&&(u.push("<i>"),f.push("</i>")),c.strike&&(u.push("<s>"),f.push("</s>")),(a=c.valign||"")=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(u.push("<"+a+">"),f.push("</"+a+">")),f.push("</span>")),m[0].join("")+m[1].replace(n8,"<br/>")+m[2].join("")):""}var Pre=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Fre=/<(?:\w+:)?r>/,Mre=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hA(a,f){var u=!f||f.cellHTML,f={};return a?(a.match(/^\s*<(?:\w+:)?t[^>]*>/)?(f.t=Sn(qn(a.slice(a.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),f.r=qn(a),u&&(f.h=IR(f.t))):a.match(Fre)&&(f.r=qn(a),f.t=Sn(qn((a.replace(Mre,"").match(Pre)||[]).join("").replace(go,""))),u&&(f.h=Ore(Rre(f.r)))),f):{t:""}}var kre=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Nre=/<(?:\w+:)?(?:si|sstItem)>/g,Dre=/<\/(?:\w+:)?(?:si|sstItem)>/,Lre=/^\s|\s$|[\t\n\r]/;function i8(a,c){if(!c.bookSST)return"";var u=[ui];u[u.length]=Dt("sst",null,{xmlns:jd[0],count:a.Count,uniqueCount:a.Unique});for(var f,m,v=0;v!=a.length;++v)a[v]!=null&&(m="<si>",(f=a[v]).r?m+=f.r:(m+="<t",f.t||(f.t=""),f.t.match(Lre)&&(m+=' xml:space="preserve"'),m+=">"+$n(f.t)+"</t>"),m+="</si>",u[u.length]=m);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var Hre=function(a,c){var u=!1;return c==null&&(u=!0,c=it(15+4*a.t.length)),c.write_shift(1,0),ks(a.t,c),u?c.slice(0,c.l):c};function $re(a){var c,u,f=ha();gt(f,159,(c=a,(u=u||it(8)).write_shift(4,c.Count),u.write_shift(4,c.Unique),u));for(var m=0;m<a.length;++m)gt(f,19,Hre(a[m]));return gt(f,160),f.end()}function s8(a){if(n!==void 0)return n.utils.encode(l,a);for(var c=[],u=a.split(""),f=0;f<u.length;++f)c[f]=u[f].charCodeAt(0);return c}function nh(a,c){var u={};return u.Major=a.read_shift(2),u.Minor=a.read_shift(2),4<=c&&(a.l+=c-4),u}function Bre(a){var c=[];a.l+=4;for(var u=a.read_shift(4);0<u--;)c.push(function(f){for(var v=f.read_shift(4),m=f.l+v-4,v={},p=f.read_shift(4),w=[];0<p--;)w.push({t:f.read_shift(4),v:f.read_shift(0,"lpp4")});if(v.name=f.read_shift(0,"lpp4"),v.comps=w,f.l!=m)throw new Error("Bad DataSpaceMapEntry: "+f.l+" != "+m);return v}(a));return c}function Vre(a){var c,u,u=(u={},(c=a).read_shift(4),c.l+=4,u.id=c.read_shift(0,"lpp4"),u.name=c.read_shift(0,"lpp4"),u.R=nh(c,4),u.U=nh(c,4),u.W=nh(c,4),u);if(u.ename=a.read_shift(0,"8lpp4"),u.blksz=a.read_shift(4),u.cmode=a.read_shift(4),a.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function o8(a,u){var u=a.l+u,f={};f.Flags=63&a.read_shift(4),a.l+=4,f.AlgID=a.read_shift(4);var m=!1;switch(f.AlgID){case 26126:case 26127:case 26128:m=f.Flags==36;break;case 26625:m=f.Flags==4;break;case 0:m=f.Flags==16||f.Flags==4||f.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+f.AlgID}if(!m)throw new Error("Encryption Flags/AlgID mismatch");return f.AlgIDHash=a.read_shift(4),f.KeySize=a.read_shift(4),f.ProviderType=a.read_shift(4),a.l+=8,f.CSPName=a.read_shift(u-a.l>>1,"utf16le"),a.l=u,f}function a8(a,f){var u={},f=a.l+f;return a.l+=4,u.Salt=a.slice(a.l,a.l+16),a.l+=16,u.Verifier=a.slice(a.l,a.l+16),a.l+=16,a.read_shift(4),u.VerifierHash=a.slice(a.l,f),a.l=f,u}function Wre(a){var c=nh(a);switch(c.Minor){case 2:return[c.Minor,function(m){if((63&m.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var f=m.read_shift(4),f=o8(m,f),m=a8(m,m.length-m.l);return{t:"Std",h:f,v:m}}(a)];case 3:return[c.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[c.Minor,function(m){var f=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];m.l+=4;var m=m.read_shift(m.length-m.l,"utf8"),v={};return m.replace(go,function(p){var w=kr(p);switch(Uc(w[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":f.forEach(function(S){v[S]=w[S]});break;case"<dataIntegrity":v.encryptedHmacKey=w.encryptedHmacKey,v.encryptedHmacValue=w.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":v.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":v.uri=w.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":v.encs.push(w);break;default:throw w[0]}}),v}(a)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+c.Minor)}function fA(a){var c,u=0,f=s8(a),m=f.length+1,v=Y(m);for(v[0]=f.length,c=1;c!=m;++c)v[c]=f[c-1];for(c=m-1;0<=c;--c)u=((16384&u?1:0)|u<<1&32767)^v[c];return 52811^u}var dA,l8,c8,u8=(dA=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],l8=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],c8=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(a){for(var c,u,f=s8(a),m=function(S){for(var b=l8[S.length-1],T=104,P=S.length-1;0<=P;--P)for(var M=S[P],k=0;k!=7;++k)64&M&&(b^=c8[T]),M*=2,--T;return b}(f),v=f.length,p=Y(16),w=0;w!=16;++w)p[w]=0;for((1&v)==1&&(c=m>>8,p[v]=hm(dA[0],c),--v,c=255&m,a=f[f.length-1],p[v]=hm(a,c));0<v;)c=m>>8,p[--v]=hm(f[v],c),c=255&m,p[--v]=hm(f[v],c);for(u=(v=15)-f.length;0<u;)c=m>>8,p[v]=hm(dA[u],c),--u,c=255&m,p[--v]=hm(f[v],c),--v,--u;return p});function hm(a,c){return 255&((c=a^c)/2|128*c)}var jre=function(a){var c=0,u=u8(a);return function(f){return f=function(m,v,p,w,S){var b,T;for(S=S||v,w=w||u8(m),b=0;b!=v.length;++b)T=v[b],T=255&((T^=w[p])>>5|T<<3),S[b]=T,++p;return[S,p,w]}("",f,c,u),c=f[1],f[0]}};function Ure(a,c,u){return u=u||{},u.Info=a.read_shift(2),a.l-=2,u.Info===1?u.Data=function(f){var m={},v=m.EncryptionVersionInfo=nh(f,4);if(v.Major!=1||v.Minor!=1)throw"unrecognized version code "+v.Major+" : "+v.Minor;return m.Salt=f.read_shift(16),m.EncryptedVerifier=f.read_shift(16),m.EncryptedVerifierHash=f.read_shift(16),m}(a):u.Data=function(f,m){var v={},p=v.EncryptionVersionInfo=nh(f,4);if(m-=4,p.Minor!=2)throw new Error("unrecognized minor version code: "+p.Minor);if(4<p.Major||p.Major<2)throw new Error("unrecognized major version code: "+p.Major);return v.Flags=f.read_shift(4),m-=4,p=f.read_shift(4),m-=4,v.EncryptionHeader=o8(f,p),m-=p,v.EncryptionVerifier=a8(f,m),v}(a,c),u}var h8={to_workbook:function(a,c){return vf(f8(a,c),c)},to_sheet:f8,from_sheet:function(a){for(var c=["{\\rtf1\\ansi"],u=un(a["!ref"]),f=Array.isArray(a),m=u.s.r;m<=u.e.r;++m){c.push("\\trowd\\trautofit1");for(var v=u.s.c;v<=u.e.c;++v)c.push("\\cellx"+(v+1));for(c.push("\\pard\\intbl"),v=u.s.c;v<=u.e.c;++v){var p=Nr({r:m,c:v});(p=f?(a[m]||[])[v]:a[p])&&(p.v!=null||p.f&&!p.F)&&(c.push(" "+(p.w||(Gc(p),p.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}};function f8(a,c){switch(c.type){case"base64":return $S(U(a),c);case"binary":return $S(a,c);case"buffer":return $S(X&&Buffer.isBuffer(a)?a.toString("binary"):ye(a),c);case"array":return $S(pe(a),c)}throw new Error("Unrecognized type "+c.type)}function $S(f,c){var u=(c||{}).dense?[]:{},f=f.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(v,p){Array.isArray(u)&&(u[p]=[]);for(var w,S=/\\\w+\b/g,b=0,T=-1;w=S.exec(v);)w[0]==="\\cell"&&(++T,(w=(w=v.slice(b,S.lastIndex-w[0].length))[0]==" "?w.slice(1):w).length&&(w={v:w,t:"s"},Array.isArray(u)?u[p][T]=w:u[Nr({r:p,c:T})]=w)),b=S.lastIndex;T>m.e.c&&(m.e.c=T)}),u["!ref"]=jr(m),u}function nv(a){for(var c=0,u=1;c!=3;++c)u=256*u+(255<a[c]?255:a[c]<0?0:a[c]);return u.toString(16).toUpperCase().slice(1)}function BS(a,c){return c===0?a:(a=function(T){var f=T[0]/255,m=T[1]/255,v=T[2]/255,p=Math.max(f,m,v),w=Math.min(f,m,v),S=p-w;if(S==0)return[0,0,f];var b=0,T=0,T=S/(1<(w=p+w)?2-w:w);switch(p){case f:b=((m-v)/S+6)%6;break;case m:b=(v-f)/S+2;break;case v:b=(f-m)/S+4}return[b/6,T,w/2]}((a=(a=a).slice(a[0]==="#"?1:0).slice(0,6),[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)])),a[2]=c<0?a[2]*(1+c):1-(1-a[2])*(1-c),nv(function(p){var f,m=p[0],v=p[1],p=p[2],w=2*v*(p<.5?p:1-p),S=[p=p-w/2,p,p],b=6*m;if(v!==0)switch(0|b){case 0:case 6:f=w*b,S[0]+=w,S[1]+=f;break;case 1:f=w*(2-b),S[0]+=f,S[1]+=w;break;case 2:f=w*(b-2),S[1]+=w,S[2]+=f;break;case 3:f=w*(4-b),S[1]+=f,S[2]+=w;break;case 4:f=w*(b-4),S[2]+=w,S[0]+=f;break;case 5:f=w*(6-b),S[2]+=f,S[0]+=w}for(var T=0;T!=3;++T)S[T]=Math.round(255*S[T]);return S}(a)))}var d8=6,zre=15,Gre=1,yo=d8;function iv(a){return Math.floor((a+Math.round(128/yo)/256)*yo)}function sv(a){return Math.floor((a-5)/yo*100+.5)/100}function VS(a){return Math.round((a*yo+5)/yo*256)/256}function gA(a){return VS(sv(iv(a)))}function mA(a){var c=Math.abs(a-gA(a)),u=yo;if(.005<c)for(yo=Gre;yo<zre;++yo)Math.abs(a-gA(a))<=c&&(c=Math.abs(a-gA(a)),u=yo);yo=u}function yf(a){a.width?(a.wpx=iv(a.width),a.wch=sv(a.wpx),a.MDW=yo):a.wpx?(a.wch=sv(a.wpx),a.width=VS(a.wch),a.MDW=yo):typeof a.wch=="number"&&(a.width=VS(a.wch),a.wpx=iv(a.width),a.MDW=yo),a.customWidth&&delete a.customWidth}var g8=96;function ov(a){return 96*a/g8}function fm(a){return a*g8/96}var Yre={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},WS=["numFmtId","fillId","fontId","borderId","xfId"],jS=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],m8,p8,v8,w8,y8,av,Kre=(m8=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,p8=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,v8=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,w8=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,y8=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(a,c,u){var f,m,v,p,w,S={};return a&&((f=(a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(m8))&&function(b,T,P){T.NumberFmt=[];for(var M=ii(B),k=0;k<M.length;++k)T.NumberFmt[M[k]]=B[M[k]];var j=b[0].match(go);if(j)for(k=0;k<j.length;++k){var L=kr(j[k]);switch(Uc(L[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var Q=Sn(qn(L.formatCode)),G=parseInt(L.numFmtId,10);if(T.NumberFmt[G]=Q,0<G){if(392<G){for(G=392;60<G&&T.NumberFmt[G]!=null;--G);T.NumberFmt[G]=Q}cr(Q,G)}break;case"</numFmt>":break;default:if(P.WTF)throw new Error("unrecognized "+L[0]+" in numFmts")}}}(f,S,u),(f=a.match(w8))&&function(b,T,P,M){T.Fonts=[];var k={},j=!1;(b[0].match(go)||[]).forEach(function(L){var Q,G=kr(L);switch(Uc(G[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":T.Fonts.push(k),k={};break;case"<name":G.val&&(k.name=qn(G.val));break;case"<name/>":case"</name>":break;case"<b":k.bold=G.val?hi(G.val):1;break;case"<b/>":k.bold=1;break;case"<i":k.italic=G.val?hi(G.val):1;break;case"<i/>":k.italic=1;break;case"<u":switch(G.val){case"none":k.underline=0;break;case"single":k.underline=1;break;case"double":k.underline=2;break;case"singleAccounting":k.underline=33;break;case"doubleAccounting":k.underline=34}break;case"<u/>":k.underline=1;break;case"<strike":k.strike=G.val?hi(G.val):1;break;case"<strike/>":k.strike=1;break;case"<outline":k.outline=G.val?hi(G.val):1;break;case"<outline/>":k.outline=1;break;case"<shadow":k.shadow=G.val?hi(G.val):1;break;case"<shadow/>":k.shadow=1;break;case"<condense":k.condense=G.val?hi(G.val):1;break;case"<condense/>":k.condense=1;break;case"<extend":k.extend=G.val?hi(G.val):1;break;case"<extend/>":k.extend=1;break;case"<sz":G.val&&(k.sz=+G.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":G.val&&(k.vertAlign=G.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":G.val&&(k.family=parseInt(G.val,10));break;case"<family/>":case"</family>":break;case"<scheme":G.val&&(k.scheme=G.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(G.val=="1")break;G.codepage=d[parseInt(G.val,10)];break;case"<color":k.color||(k.color={}),G.auto&&(k.color.auto=hi(G.auto)),G.rgb?k.color.rgb=G.rgb.slice(-6):G.indexed?(k.color.index=parseInt(G.indexed,10),Q=J1[k.color.index],Q=(Q=k.color.index==81?J1[1]:Q)||J1[1],k.color.rgb=Q[0].toString(16)+Q[1].toString(16)+Q[2].toString(16)):G.theme&&(k.color.theme=parseInt(G.theme,10),G.tint&&(k.color.tint=parseFloat(G.tint)),G.theme&&P.themeElements&&P.themeElements.clrScheme&&(k.color.rgb=BS(P.themeElements.clrScheme[k.color.theme].rgb,k.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":j=!0;break;case"</AlternateContent>":j=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":j=!0;break;case"</ext>":j=!1;break;default:if(M&&M.WTF&&!j)throw new Error("unrecognized "+G[0]+" in fonts")}})}(f,S,c,u),(f=a.match(v8))&&function(b,T,P){T.Fills=[];var M={},k=!1;(b[0].match(go)||[]).forEach(function(j){var L=kr(j);switch(Uc(L[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":M={},T.Fills.push(M);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":T.Fills.push(M),M={};break;case"<patternFill":case"<patternFill>":L.patternType&&(M.patternType=L.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":M.bgColor||(M.bgColor={}),L.indexed&&(M.bgColor.indexed=parseInt(L.indexed,10)),L.theme&&(M.bgColor.theme=parseInt(L.theme,10)),L.tint&&(M.bgColor.tint=parseFloat(L.tint)),L.rgb&&(M.bgColor.rgb=L.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":M.fgColor||(M.fgColor={}),L.theme&&(M.fgColor.theme=parseInt(L.theme,10)),L.tint&&(M.fgColor.tint=parseFloat(L.tint)),L.rgb!=null&&(M.fgColor.rgb=L.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":k=!0;break;case"</ext>":k=!1;break;default:if(P&&P.WTF&&!k)throw new Error("unrecognized "+L[0]+" in fills")}})}(f,S,u),(f=a.match(y8))&&function(b,T,P){T.Borders=[];var M={},k=!1;(b[0].match(go)||[]).forEach(function(j){var L=kr(j);switch(Uc(L[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":M={},L.diagonalUp&&(M.diagonalUp=hi(L.diagonalUp)),L.diagonalDown&&(M.diagonalDown=hi(L.diagonalDown)),T.Borders.push(M);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":k=!0;break;case"</ext>":k=!1;break;default:if(P&&P.WTF&&!k)throw new Error("unrecognized "+L[0]+" in borders")}})}(f,S,u),(f=a.match(p8))&&(f=f,v=u,w=!((m=S).CellXf=[]),(f[0].match(go)||[]).forEach(function(b){var T=kr(b),P=0;switch(Uc(T[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(p=T)[0],P=0;P<WS.length;++P)p[WS[P]]&&(p[WS[P]]=parseInt(p[WS[P]],10));for(P=0;P<jS.length;++P)p[jS[P]]&&(p[jS[P]]=hi(p[jS[P]]));if(m.NumberFmt&&392<p.numFmtId){for(P=392;60<P;--P)if(m.NumberFmt[p.numFmtId]==m.NumberFmt[P]){p.numFmtId=P;break}}m.CellXf.push(p);break;case"</xf>":break;case"<alignment":case"<alignment/>":var M={};T.vertical&&(M.vertical=T.vertical),T.horizontal&&(M.horizontal=T.horizontal),T.textRotation!=null&&(M.textRotation=T.textRotation),T.indent&&(M.indent=T.indent),T.wrapText&&(M.wrapText=hi(T.wrapText)),p.alignment=M;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":w=!0;break;case"</AlternateContent>":w=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(v&&v.WTF&&!w)throw new Error("unrecognized "+T[0]+" in cellXfs")}}))),S});function C8(a,c){if(av!==void 0)return av.toXml();var u,f,m,v,p=[ui,Dt("styleSheet",null,{xmlns:jd[0],"xmlns:vt":bs.vt})];return a.SSF&&(f=a.SSF,m=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(w){for(var S=w[0];S<=w[1];++S)f[S]!=null&&(m[m.length]=Dt("numFmt",null,{numFmtId:S,formatCode:$n(f[S])}))}),(u=m.length===1?"":(m[m.length]="</numFmts>",m[0]=Dt("numFmts",null,{count:m.length-2}).replace("/>",">"),m.join("")))!=null)&&(p[p.length]=u),p[p.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',p[p.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',p[p.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',p[p.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',c=c.cellXfs,(v=[])[v.length]="<cellXfs/>",c.forEach(function(w){v[v.length]=Dt("xf",null,w)}),v[v.length]="</cellXfs>",(u=v.length===2?"":(v[0]=Dt("cellXfs",null,{count:v.length-2}).replace("/>",">"),v.join("")))&&(p[p.length]=u),p[p.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',p[p.length]='<dxfs count="0"/>',p[p.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<p.length&&(p[p.length]="</styleSheet>",p[1]=p[1].replace("/>",">")),p.join("")}function Xre(a,c){var u;(c=c||it(153)).write_shift(2,20*a.sz),u=a,f=(f=c)||it(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),f.write_shift(1,u),f.write_shift(1,0),c.write_shift(2,a.bold?700:400);var f=0;return a.vertAlign=="superscript"?f=1:a.vertAlign=="subscript"&&(f=2),c.write_shift(2,f),c.write_shift(1,a.underline||0),c.write_shift(1,a.family||0),c.write_shift(1,a.charset||0),c.write_shift(1,0),TS(a.color,c),f=0,a.scheme=="major"&&(f=1),a.scheme=="minor"&&(f=2),c.write_shift(1,f),ks(a.name,c),c.length>c.l?c.slice(0,c.l):c}var S8,qre=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Jre=mo;function b8(a,c){c=c||it(84),a=(S8=S8||jc(qre))[a.patternType],a==null&&(a=40),c.write_shift(4,a);var u=0;if(a!=40)for(TS({auto:1},c),TS({auto:1},c);u<12;++u)c.write_shift(4,0);else{for(;u<4;++u)c.write_shift(4,0);for(;u<12;++u)c.write_shift(4,0)}return c.length>c.l?c.slice(0,c.l):c}function x8(a,c,u){return(u=u||it(16)).write_shift(2,c||0),u.write_shift(2,a.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function lv(a,c){return(c=c||it(10)).write_shift(1,0),c.write_shift(1,0),c.write_shift(4,0),c.write_shift(4,0),c}Ys=mo;function Qre(a,c){var u;c&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m=f[0];m<=f[1];++m)c[m]!=null&&++u}),u!=0&&(gt(a,615,ql(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m,v,p,w=f[0];w<=f[1];++w)c[w]!=null&&gt(a,44,(m=w,v=c[w],(p=(p=void 0)||it(6+4*v.length)).write_shift(2,m),ks(v,p),v=p.length>p.l?p.slice(0,p.l):p,p.l==null&&(p.l=p.length),v))}),gt(a,616)))}function Zre(a){var c;gt(a,613,ql(1)),gt(a,46,((c=c||it(51)).write_shift(1,0),lv(0,c),lv(0,c),lv(0,c),lv(0,c),lv(0,c),c.length>c.l?c.slice(0,c.l):c)),gt(a,614)}function ene(a){var c,u;gt(a,619,ql(1)),gt(a,48,(c={xfId:0,builtinId:0,name:"Normal"},(u=u||it(52)).write_shift(4,c.xfId),u.write_shift(2,1),u.write_shift(1,+c.builtinId),u.write_shift(1,0),ES(c.name||"",u),u.length>u.l?u.slice(0,u.l):u)),gt(a,620)}function tne(a){var c,u,f,m;gt(a,508,(c=0,u="TableStyleMedium9",f="PivotStyleMedium4",(m=it(2052)).write_shift(4,c),ES(u,m),ES(f,m),m.length>m.l?m.slice(0,m.l):m)),gt(a,509)}function rne(a,c){var u,f=ha();return gt(f,278),Qre(f,a.SSF),gt(a=f,611,ql(1)),gt(a,43,Xre({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),gt(a,612),gt(a=f,603,ql(2)),gt(a,45,b8({patternType:"none"})),gt(a,45,b8({patternType:"gray125"})),gt(a,604),Zre(f),gt(a=f,626,ql(1)),gt(a,47,x8({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),gt(a,627),u=f,c=c.cellXfs,gt(u,617,ql(c.length)),c.forEach(function(m){gt(u,47,x8(m,0))}),gt(u,618),ene(f),gt(c=f,505,ql(0)),gt(c,506),tne(f),gt(f,279),f.end()}var nne=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ine(a,c,u){c.themeElements.clrScheme=[];var f={};(a[0].match(go)||[]).forEach(function(m){var v=kr(m);switch(v[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":f.rgb=v.val;break;case"<a:sysClr":f.rgb=v.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":v[0].charAt(1)==="/"?(c.themeElements.clrScheme[nne.indexOf(v[0])]=f,f={}):f.name=v[0].slice(3,v[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+v[0]+" in clrScheme")}})}function sne(){}function one(){}var ane=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,lne=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cne=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,une=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function E8(a,c){var u,f,m,v,p,w={};if(!(u=(a=!a||a.length===0?pA():a).match(une)))throw new Error("themeElements not found in theme");return f=u[0],v=c,(m=w).themeElements={},[["clrScheme",ane,ine],["fontScheme",lne,sne],["fmtScheme",cne,one]].forEach(function(S){if(!(p=f.match(S[1])))throw new Error(S[0]+" not found in themeElements");S[2](p,m,v)}),w.raw=a,w}function pA(a,c){return c&&c.themeXLSX?c.themeXLSX:a&&typeof a.raw=="string"?a.raw:(a=[ui],a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join(""))}function hne(a){var c={};switch(c.xclrType=a.read_shift(2),c.nTintShade=a.read_shift(2),c.xclrType){case 0:a.l+=4;break;case 1:c.xclrValue=mo(a,4);break;case 2:c.xclrValue=dL(a);break;case 3:c.xclrValue=a.read_shift(4);break;case 4:a.l+=4}return a.l+=8,c}function fne(a){var c=a.read_shift(2),u=a.read_shift(2)-4,f=[c];switch(c){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:f[1]=hne(a);break;case 6:f[1]=mo(a,u);break;case 14:case 15:f[1]=a.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+c+" "+u)}return f}function dne(){var a,c,u,f=ha();return gt(f,332),gt(f,334,ql(1)),gt(f,335,((u=it(12+2*(c={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,c.flags),u.write_shift(4,c.version),ks(c.name,u),u.slice(0,u.l))),gt(f,336),gt(f,339,(a=1,(u=it(8+2*(c="XLDAPR").length)).write_shift(4,a),ks(c,u),u.slice(0,u.l))),gt(f,52),gt(f,35,ql(514)),gt(f,4096,ql(0)),gt(f,4097,dl(1)),gt(f,36),gt(f,53),gt(f,340),gt(f,337,(a=1,c=!0,(u=it(8)).write_shift(4,a),u.write_shift(4,c?1:0),u)),gt(f,51,function(m){var v=it(4+8*m.length);v.write_shift(4,m.length);for(var p=0;p<m.length;++p)v.write_shift(4,m[p][0]),v.write_shift(4,m[p][1]);return v}([[1,0]])),gt(f,338),gt(f,333),f.end()}function T8(){var a=[ui];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}var dm=1024;function _8(a,c){for(var u=[21600,21600],f=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),m=[Dt("xml",null,{"xmlns:v":Da.v,"xmlns:o":Da.o,"xmlns:x":Da.x,"xmlns:mv":Da.mv}).replace(/\/>/,">"),Dt("o:shapelayout",Dt("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Dt("v:shapetype",[Dt("v:stroke",null,{joinstyle:"miter"}),Dt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:f})];dm<1e3*a;)dm+=1e3;return c.forEach(function(v){var p=Ri(v[0]),S={color2:"#BEFF82",type:"gradient"};S.type=="gradient"&&(S.angle="-180");var w=S.type=="gradient"?Dt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,S=Dt("v:fill",w,S);++dm,m=m.concat(["<v:shape"+G1({id:"_x0000_s"+dm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(v[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",S,Dt("v:shadow",null,{on:"t",obscured:"t"}),Dt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ks("x:Anchor",[p.c+1,0,p.r+1,0,p.c+3,20,p.r+5,20].join(",")),Ks("x:AutoFill","False"),Ks("x:Row",String(p.r)),Ks("x:Column",String(p.c)),v[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),m.push("</xml>"),m.join("")}function R8(a,c,u,f){var m,v=Array.isArray(a);c.forEach(function(p){var w,S=Ri(p.ref);(m=v?(a[S.r]||(a[S.r]=[]),a[S.r][S.c]):a[p.ref])||(m={t:"z"},v?a[S.r][S.c]=m:a[p.ref]=m,(w=un(a["!ref"]||"BDWGO1000001:A1")).s.r>S.r&&(w.s.r=S.r),w.e.r<S.r&&(w.e.r=S.r),w.s.c>S.c&&(w.s.c=S.c),w.e.c<S.c&&(w.e.c=S.c),(w=jr(w))!==a["!ref"]&&(a["!ref"]=w)),m.c||(m.c=[]);var b={a:p.author,t:p.t,r:p.r,T:u};p.h&&(b.h=p.h);for(var T=m.c.length-1;0<=T;--T){if(!u&&m.c[T].T)return;u&&!m.c[T].T&&m.c.splice(T,1)}if(u&&f){for(T=0;T<f.length;++T)if(b.a==f[T].id){b.a=f[T].name||b.a;break}}m.c.push(b)})}function A8(a){var c=[ui,Dt("comments",null,{xmlns:jd[0]})],u=[];return c.push("<authors>"),a.forEach(function(f){f[1].forEach(function(m){var v=$n(m.a);u.indexOf(v)==-1&&(u.push(v),c.push("<author>"+v+"</author>")),m.T&&m.ID&&u.indexOf("tc="+m.ID)==-1&&(u.push("tc="+m.ID),c.push("<author>tc="+m.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),c.push("<author>SheetJ5</author>")),c.push("</authors>"),c.push("<commentList>"),a.forEach(function(f){var m=0,v=[];if(f[1][0]&&f[1][0].T&&f[1][0].ID?m=u.indexOf("tc="+f[1][0].ID):f[1].forEach(function(S){S.a&&(m=u.indexOf($n(S.a))),v.push(S.t||"")}),c.push('<comment ref="'+f[0]+'" authorId="'+m+'"><text>'),v.length<=1)c.push(Ks("t",$n(v[0]||"")));else{for(var p=`Comment:
    `+v[0]+`
`,w=1;w<v.length;++w)p+=`Reply:
    `+v[w]+`
`;c.push(Ks("t",$n(p)))}c.push("</text></comment>")}),c.push("</commentList>"),2<c.length&&(c[c.length]="</comments>",c[1]=c[1].replace("/>",">")),c.join("")}ge=po;function gne(a){var c=ha(),u=[];return gt(c,628),gt(c,630),a.forEach(function(f){f[1].forEach(function(m){-1<u.indexOf(m.a)||(u.push(m.a.slice(0,54)),gt(c,632,ks(m.a.slice(0,54))))})}),gt(c,631),gt(c,633),a.forEach(function(f){f[1].forEach(function(m){m.iauthor=u.indexOf(m.a);var v,p={s:Ri(f[0]),e:Ri(f[0])};gt(c,635,(p=[p,m],(v=v??it(36)).write_shift(4,p[1].iauthor),om(p[0],v),v.write_shift(4,0),v.write_shift(4,0),v.write_shift(4,0),v.write_shift(4,0),v)),m.t&&0<m.t.length&&gt(c,637,ore(m)),gt(c,636),delete m.iauthor})}),gt(c,634),gt(c,629),c.end()}var mne="application/vnd.ms-office.vbaProject",O8=["xlsb","xlsm","xlam","biff8","xla"],vA,I8,gm=(I8=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(a,c){return vA=c,a.replace(I8,pne)});function pne(a,c,u,f){var m=!1,v=!1;return u.length==0?v=!0:u.charAt(0)=="["&&(v=!0,u=u.slice(1,-1)),f.length==0?m=!0:f.charAt(0)=="["&&(m=!0,f=f.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,f=0<f.length?0|parseInt(f,10):0,m?f+=vA.c:--f,v?u+=vA.r:--u,c+(m?"":"$")+fi(f)+(v?"":"$")+Vi(u)}var wA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yA=function(a,c){return a.replace(wA,function(u,f,m,v,p,w){return v=jR(v)-(m?0:c.c),w=WR(w)-(p?0:c.r),f+"R"+(w==0?"":p?1+w:"["+w+"]")+"C"+(v==0?"":m?1+v:"["+v+"]")})};function P8(a,c){return a.replace(wA,function(u,f,m,v,p,w){return f+(m=="$"?m+v:fi(jR(v)+c.c))+(p=="$"?p+w:Vi(WR(w)+c.r))})}function F8(a){return a.replace(/_xlfn\./g,"")}function ls(a){a.l+=1}function Cf(a,c){return c=a.read_shift(c==1?1:2),[16383&c,c>>14&1,c>>15&1]}function M8(p,c,m){var v=2;if(m){if(2<=m.biff&&m.biff<=5)return k8(p);m.biff==12&&(v=4)}var f=p.read_shift(v),m=p.read_shift(v),v=Cf(p,2),p=Cf(p,2);return{s:{r:f,c:v[0],cRel:v[1],rRel:v[2]},e:{r:m,c:p[0],cRel:p[1],rRel:p[2]}}}function k8(m){var c=Cf(m,2),u=Cf(m,2),f=m.read_shift(1),m=m.read_shift(1);return{s:{r:c[0],c:f,cRel:c[1],rRel:c[2]},e:{r:u[0],c:m,cRel:u[1],rRel:u[2]}}}function N8(p,c,v){if(v&&2<=v.biff&&v.biff<=5)return m=Cf(f=p,2),f=f.read_shift(1),{r:m[0],c:f,cRel:m[1],rRel:m[2]};var f,m,v=p.read_shift(v&&v.biff==12?4:2),p=Cf(p,2);return{r:v,c:p[0],cRel:p[1],rRel:p[2]}}function vne(p,c,v){if(v=v&&v.biff?v.biff:8,2<=v&&v<=5)return function(P){var S=P.read_shift(2),b=P.read_shift(1),T=(32768&S)>>15,P=(16384&S)>>14;return S&=16383,T==1&&8192<=S&&(S-=16384),P==1&&128<=b&&(b-=256),{r:S,c:b,cRel:P,rRel:T}}(p);var f=p.read_shift(12<=v?4:2),m=p.read_shift(2),v=(16384&m)>>14,p=(32768&m)>>15;if(m&=16383,p==1)for(;524287<f;)f-=1048576;if(v==1)for(;8191<m;)m-=16384;return{r:f,c:m,cRel:v,rRel:p}}function D8(a){var c=1&a[a.l+1];return a.l+=4,[c,1]}function L8(a){return[a.read_shift(1),a.read_shift(1)]}function wne(a,c,u){var f=0,m=0;u.biff==12?(f=a.read_shift(4),m=a.read_shift(4)):(m=1+a.read_shift(1),f=1+a.read_shift(2)),2<=u.biff&&u.biff<8&&(--f,--m==0&&(m=256));for(var v=0,p=[];v!=f&&(p[v]=[]);++v)for(var w=0;w!=m;++w)p[v][w]=function(S,b){var T=[S.read_shift(1)];if(b==12)switch(T[0]){case 2:T[0]=4;break;case 4:T[0]=16;break;case 0:T[0]=1;break;case 1:T[0]=2}switch(T[0]){case 4:T[1]=es(S,1)?"TRUE":"FALSE",b!=12&&(S.l+=7);break;case 37:case 16:T[1]=rh[S[S.l]],S.l+=b==12?4:8;break;case 0:S.l+=8;break;case 1:T[1]=vo(S);break;case 2:T[1]=Jd(S,0,{biff:0<b&&b<8?2:b});break;default:throw new Error("Bad SerAr: "+T[0])}return T}(a,u.biff);return p}function cv(a,c,u){return a.l+=2,[(a=(f=a).read_shift(2),f=f.read_shift(2),{r:a,c:255&f,fQuoted:!!(16384&f),cRel:f>>15,rRel:f>>15})];var f}function CA(a){return a.l+=6,[]}function H8(a){return a.l+=2,[as(a),1&a.read_shift(2)]}var yne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],$8={1:{n:"PtgExp",f:function(a,c,u){return a.l++,u&&u.biff==12?[a.read_shift(4,"i"),0]:[a.read_shift(2),a.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:mo},3:{n:"PtgAdd",f:ls},4:{n:"PtgSub",f:ls},5:{n:"PtgMul",f:ls},6:{n:"PtgDiv",f:ls},7:{n:"PtgPower",f:ls},8:{n:"PtgConcat",f:ls},9:{n:"PtgLt",f:ls},10:{n:"PtgLe",f:ls},11:{n:"PtgEq",f:ls},12:{n:"PtgGe",f:ls},13:{n:"PtgGt",f:ls},14:{n:"PtgNe",f:ls},15:{n:"PtgIsect",f:ls},16:{n:"PtgUnion",f:ls},17:{n:"PtgRange",f:ls},18:{n:"PtgUplus",f:ls},19:{n:"PtgUminus",f:ls},20:{n:"PtgPercent",f:ls},21:{n:"PtgParen",f:ls},22:{n:"PtgMissArg",f:ls},23:{n:"PtgStr",f:function(a,c,u){return a.l++,ev(a,0,u)}},26:{n:"PtgSheet",f:function(a,c,u){return a.l+=5,a.l+=2,a.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(a,c,u){return a.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(a){return a.l++,rh[a.read_shift(1)]}},29:{n:"PtgBool",f:function(a){return a.l++,a.read_shift(1)!==0}},30:{n:"PtgInt",f:function(a){return a.l++,a.read_shift(2)}},31:{n:"PtgNum",f:function(a){return a.l++,vo(a)}},32:{n:"PtgArray",f:function(a,c,u){var f=(96&a[a.l++])>>5;return a.l+=u.biff==2?6:u.biff==12?14:7,[f]}},33:{n:"PtgFunc",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,u=a.read_shift(u&&u.biff<=3?1:2),[One[u],W8[u],f]}},34:{n:"PtgFuncVar",f:function(a,c,u){var f=a[a.l++],m=a.read_shift(1),v=u&&u.biff<=3?[f==88?-1:0,a.read_shift(1)]:[(v=a)[v.l+1]>>7,32767&v.read_shift(2)];return[m,(v[0]===0?W8:Ane)[v[1]]]}},35:{n:"PtgName",f:function(a,c,u){var f=a.read_shift(1)>>>5&3,m=!u||8<=u.biff?4:2,m=a.read_shift(m);switch(u.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12}return[f,0,m]}},36:{n:"PtgRef",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,[f,N8(a,0,u)]}},37:{n:"PtgArea",f:function(a,c,u){return[(96&a[a.l++])>>5,M8(a,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(a,c,u){var f=a.read_shift(1)>>>5&3;return a.l+=u&&u.biff==2?3:4,[f,a.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:mo},40:{n:"PtgMemNoMem",f:mo},41:{n:"PtgMemFunc",f:function(a,c,u){return[a.read_shift(1)>>>5&3,a.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(a,c,u){var f=a.read_shift(1)>>>5&3;return a.l+=4,u.biff<8&&a.l--,u.biff==12&&(a.l+=2),[f]}},43:{n:"PtgAreaErr",f:function(a,c,u){var f=(96&a[a.l++])>>5;return a.l+=u&&8<u.biff?12:u.biff<8?6:8,[f]}},44:{n:"PtgRefN",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,[f,vne(a,0,u)]}},45:{n:"PtgAreaN",f:function(a,c,u){return[(96&a[a.l++])>>5,function(S,w){if(w.biff<8)return k8(S);var v=S.read_shift(w.biff==12?4:2),p=S.read_shift(w.biff==12?4:2),w=Cf(S,2),S=Cf(S,2);return{s:{r:v,c:w[0],cRel:w[1],rRel:w[2]},e:{r:p,c:S[0],cRel:S[1],rRel:S[2]}}}(a,u)]}},46:{n:"PtgMemAreaN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},57:{n:"PtgNameX",f:function(a,c,u){return u.biff==5?function(f){var m=f.read_shift(1)>>>5&3,v=f.read_shift(2,"i");f.l+=8;var p=f.read_shift(2);return f.l+=12,[m,v,p]}(a):[a.read_shift(1)>>>5&3,a.read_shift(2),a.read_shift(4)]}},58:{n:"PtgRef3d",f:function(a,c,u){var f=(96&a[a.l])>>5;a.l+=1;var m=a.read_shift(2);return u&&u.biff==5&&(a.l+=12),[f,m,N8(a,0,u)]}},59:{n:"PtgArea3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2,"i");if(u)switch(u.biff){case 5:a.l+=12;break}return[f,m,M8(a,0,u)]}},60:{n:"PtgRefErr3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2),v=4;if(u)switch(u.biff){case 5:v=15;break;case 12:v=6}return a.l+=v,[f,m]}},61:{n:"PtgAreaErr3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2),v=8;if(u)switch(u.biff){case 5:a.l+=12,v=6;break;case 12:v=12}return a.l+=v,[f,m]}},255:{}},Cne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Sne={1:{n:"PtgElfLel",f:H8},2:{n:"PtgElfRw",f:cv},3:{n:"PtgElfCol",f:cv},6:{n:"PtgElfRwV",f:cv},7:{n:"PtgElfColV",f:cv},10:{n:"PtgElfRadical",f:cv},11:{n:"PtgElfRadicalS",f:CA},13:{n:"PtgElfColS",f:CA},15:{n:"PtgElfColSV",f:CA},16:{n:"PtgElfRadicalLel",f:H8},25:{n:"PtgList",f:function(v){v.l+=2;var c=v.read_shift(2),u=v.read_shift(2),f=v.read_shift(4),m=v.read_shift(2),v=v.read_shift(2);return{ixti:c,coltype:3&u,rt:yne[u>>2&31],idx:f,c:m,C:v}}},29:{n:"PtgSxName",f:function(a){return a.l+=2,[a.read_shift(4)]}},255:{}},bne={0:{n:"PtgAttrNoop",f:function(a){return a.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=u&&u.biff==2?3:4,[f]}},2:{n:"PtgAttrIf",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=2,[f,a.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(a,c,u){a.l+=2;for(var f=a.read_shift(u&&u.biff==2?1:2),m=[],v=0;v<=f;++v)m.push(a.read_shift(u&&u.biff==2?1:2));return m}},8:{n:"PtgAttrGoto",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=2,[f,a.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(a,c,u){a.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:D8},33:{n:"PtgAttrBaxcel",f:D8},64:{n:"PtgAttrSpace",f:function(a){return a.read_shift(2),L8(a)}},65:{n:"PtgAttrSpaceSemi",f:function(a){return a.read_shift(2),L8(a)}},128:{n:"PtgAttrIfError",f:function(a){var c=255&a[a.l+1]?1:0;return a.l+=2,[c,a.read_shift(2)]}},255:{}};function uv(a,c,u,f){if(f.biff<8)return mo(a,c);for(var m=a.l+c,v=[],p=0;p!==u.length;++p)switch(u[p][0]){case"PtgArray":u[p][1]=wne(a,0,f),v.push(u[p][1]);break;case"PtgMemArea":u[p][2]=function(w,S){for(var b=w.read_shift(S.biff==12?4:2),T=[],P=0;P!=b;++P)T.push((S.biff==12?Kd:OS)(w));return T}(a,(u[p][1],f)),v.push(u[p][2]);break;case"PtgExp":f&&f.biff==12&&(u[p][1][1]=a.read_shift(4),v.push(u[p][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[p][0]}return(c=m-a.l)!==0&&v.push(mo(a,c)),v}function hv(a,c,u){for(var f,m,v=a.l+c,p=[];v!=a.l;)c=v-a.l,m=a[a.l],f=$8[m]||$8[Cne[m]],(f=m===24||m===25?(m===24?Sne:bne)[a[a.l+1]]:f)&&f.f?p.push([f.n,f.f(a,c,u)]):mo(a,c);return p}var xne={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function B8(a,c,u){if(!a)return"SH33TJSERR0";if(8<u.biff&&(!a.XTI||!a.XTI[c]))return a.SheetNames[c];if(!a.XTI)return"SH33TJSERR6";var f=a.XTI[c];if(u.biff<8)return 1e4<c&&(c-=65536),(c=c<0?-c:c)==0?"":a.XTI[c-1];if(!f)return"SH33TJSERR1";var m="";if(8<u.biff)switch(a[f[0]][0]){case 357:return m=f[1]==-1?"#REF":a.SheetNames[f[1]],f[1]==f[2]?m:m+":"+a.SheetNames[f[2]];case 358:return u.SID!=null?a.SheetNames[u.SID]:"SH33TJSSAME"+a[f[0]][0];case 355:default:return"SH33TJSSRC"+a[f[0]][0]}switch(a[f[0]][0][0]){case 1025:return m=f[1]==-1?"#REF":a.SheetNames[f[1]]||"SH33TJSERR3",f[1]==f[2]?m:m+":"+a.SheetNames[f[2]];case 14849:return a[f[0]].slice(1).map(function(v){return v.Name}).join(";;");default:return a[f[0]][0][3]?(m=f[1]==-1?"#REF":a[f[0]][0][3][f[1]]||"SH33TJSERR4",f[1]==f[2]?m:m+":"+a[f[0]][0][3][f[2]]):"SH33TJSERR2"}}function V8(a,c,u){return c=B8(a,c,u),c=="#REF"?c:function(f,m){if(!(f||m&&m.biff<=5&&2<=m.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(f)?"'"+f+"'":f}(c,u)}function Bo(a,c,u,f,m){var v,p,w,S=m&&m.biff||8,b={s:{c:0,r:0},e:{c:0,r:0}},T=[],P=0,M=0,k="";if(!a[0]||!a[0][0])return"";for(var j=-1,L="",Q=0,G=a[0].length;Q<G;++Q){var W=a[0][Q];switch(W[0]){case"PtgUminus":T.push("-"+T.pop());break;case"PtgUplus":T.push("+"+T.pop());break;case"PtgPercent":T.push(T.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Wt=T.pop(),v=T.pop(),0<=j){switch(a[0][j][1][0]){case 0:L=Ye(" ",a[0][j][1][1]);break;case 1:L=Ye("\r",a[0][j][1][1]);break;default:if(L="",m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][j][1][0])}v+=L,j=-1}T.push(v+xne[W[0]]+Wt);break;case"PtgIsect":Wt=T.pop(),v=T.pop(),T.push(v+" "+Wt);break;case"PtgUnion":Wt=T.pop(),v=T.pop(),T.push(v+","+Wt);break;case"PtgRange":Wt=T.pop(),v=T.pop(),T.push(v+":"+Wt);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":p=X1(W[1][1],b,m),T.push(q1(p,S));break;case"PtgRefN":p=u?X1(W[1][1],u,m):W[1][1],T.push(q1(p,S));break;case"PtgRef3d":P=W[1][1],p=X1(W[1][2],b,m),k=V8(f,P,m),T.push(k+"!"+q1(p,S));break;case"PtgFunc":case"PtgFuncVar":var ne=W[1][0],J=W[1][1],ne=ne||0,se=(ne&=127)==0?[]:T.slice(-ne);T.length-=ne,J==="User"&&(J=se.shift()),T.push(J+"("+se.join(",")+")");break;case"PtgBool":T.push(W[1]?"TRUE":"FALSE");break;case"PtgInt":T.push(W[1]);break;case"PtgNum":T.push(String(W[1]));break;case"PtgStr":T.push('"'+W[1].replace(/"/g,'""')+'"');break;case"PtgErr":T.push(W[1]);break;case"PtgAreaN":w=P5(W[1][1],u?{s:u}:b,m),T.push(VR(w,m));break;case"PtgArea":w=P5(W[1][1],b,m),T.push(VR(w,m));break;case"PtgArea3d":P=W[1][1],w=W[1][2],k=V8(f,P,m),T.push(k+"!"+VR(w,m));break;case"PtgAttrSum":T.push("SUM("+T.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":M=W[1][2];var xe=(f.names||[])[M-1]||(f[0]||[])[M],He=xe?xe.Name:"SH33TJSNAME"+String(M);He&&He.slice(0,6)=="_xlfn."&&!m.xlfn&&(He=He.slice(6)),T.push(He);break;case"PtgNameX":var Fe,Ue=W[1][1],M=W[1][2];if(!(m.biff<=5)){xe="",((f[Ue]||[])[0]||[])[0]==14849||(((f[Ue]||[])[0]||[])[0]==1025?f[Ue][M]&&0<f[Ue][M].itab&&(xe=f.SheetNames[f[Ue][M].itab-1]+"!"):xe=f.SheetNames[M-1]+"!"),f[Ue]&&f[Ue][M]?xe+=f[Ue][M].Name:f[0]&&f[0][M]?xe+=f[0][M].Name:(He=(B8(f,Ue,m)||"").split(";;"))[M-1]?xe=He[M-1]:xe+="SH33TJSERRX",T.push(xe);break}Fe=(Fe=f[Ue=Ue<0?-Ue:Ue]?f[Ue][M]:Fe)||{Name:"SH33TJSERRY"},T.push(Fe.Name);break;case"PtgParen":var ct="(",ut=")";if(0<=j){switch(L="",a[0][j][1][0]){case 2:ct=Ye(" ",a[0][j][1][1])+ct;break;case 3:ct=Ye("\r",a[0][j][1][1])+ct;break;case 4:ut=Ye(" ",a[0][j][1][1])+ut;break;case 5:ut=Ye("\r",a[0][j][1][1])+ut;break;default:if(m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][j][1][0])}j=-1}T.push(ct+T.pop()+ut);break;case"PtgRefErr":case"PtgRefErr3d":T.push("#REF!");break;case"PtgExp":p={c:W[1][1],r:W[1][0]};var Ke={c:u.c,r:u.r};if(f.sharedf[Nr(p)])Ue=f.sharedf[Nr(p)],T.push(Bo(Ue,0,Ke,f,m));else{for(var St=!1,Wt=0;Wt!=f.arrayf.length;++Wt)if(v=f.arrayf[Wt],!(p.c<v[0].s.c||p.c>v[0].e.c||p.r<v[0].s.r||p.r>v[0].e.r)){T.push(Bo(v[1],0,Ke,f,m)),St=!0;break}St||T.push(W[1])}break;case"PtgArray":T.push("{"+function(Pt){for(var _t=[],mt=0;mt<Pt.length;++mt){for(var Zt=Pt[mt],or=[],Cr=0;Cr<Zt.length;++Cr){var Gr=Zt[Cr];Gr?Gr[0]===2?or.push('"'+Gr[1].replace(/"/g,'""')+'"'):or.push(Gr[1]):or.push("")}_t.push(or.join(","))}return _t.join(";")}(W[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":j=Q;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":T.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":T.push("#REF!");break;case"PtgList":T.push("Table"+W[1].idx+"[#"+W[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(W))}if(m.biff!=3&&0<=j&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(a[0][Q][0])==-1){var $t=!0;switch((W=a[0][j])[1][0]){case 4:$t=!1;case 0:L=Ye(" ",W[1][1]);break;case 5:$t=!1;case 1:L=Ye("\r",W[1][1]);break;default:if(L="",m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+W[1][0])}T.push(($t?L:"")+T.pop()+($t?"":L)),j=-1}}if(1<T.length&&m.WTF)throw new Error("bad formula stack");return T[0]}function SA(a,p,u){var f=a.l+p,m=Yc(a);u.biff==2&&++a.l;var v=function(w){var S;if(eh(w,w.l+6)!==65535)return[vo(w),"n"];switch(w[w.l]){case 0:return w.l+=8,["String","s"];case 1:return S=w[w.l+2]===1,w.l+=8,[S,"b"];case 2:return S=w[w.l+2],w.l+=8,[S,"e"];case 3:return w.l+=8,["","s"]}return[]}(a),p=a.read_shift(1);return u.biff!=2&&(a.read_shift(1),5<=u.biff&&a.read_shift(4)),u=function(w,S,b){var T,P=w.l+S,M=b.biff==2?1:2,k=w.read_shift(M);if(k==65535)return[[],mo(w,S-2)];var j=hv(w,k,b);return S!==k+M&&(T=uv(w,S-k-M,j,b)),w.l=P,[j,T]}(a,f-a.l,u),{cell:m,val:v[0],formula:u,shared:p>>3&1,tt:v[1]}}function Ene(a,c,u,f,m){c=Qd(c,u,m),m=(u=a.v)!=null?am(typeof u=="number"?u:0):((u=it(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=it(6),u.write_shift(2,33),u.write_shift(4,0);for(var v=it(a.bf.length),p=0;p<a.bf.length;++p)v[p]=a.bf[p];return ke([c,m,u,v])}function US(a,c,u){var m=a.read_shift(4),f=hv(a,m,u),m=a.read_shift(4);return[f,0<m?uv(a,m,f,u):null]}var Tne=US,zS=US,_ne=US,Rne=US,Ane={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},W8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},One={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function j8(a){return(a=(a=(a=(a=(a=a.slice(0,3)=="of:"?a.slice(3):a).charCodeAt(0)==61&&(a=a.slice(1)).charCodeAt(0)==61?a.slice(1):a).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(c,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function bA(a){return a=a.split(":"),[a[0].split(".")[0],a[0].split(".")[1]+(1<a.length?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}var fv={},mm={},dv=typeof Map<"u";function xA(a,c,u){var f=0,m=a.length;if(u){if(dv?u.has(c):Object.prototype.hasOwnProperty.call(u,c)){for(var v=dv?u.get(c):u[c];f<v.length;++f)if(a[v[f]].t===c)return a.Count++,v[f]}}else for(;f<m;++f)if(a[f].t===c)return a.Count++,f;return a[m]={t:c},a.Count++,a.Unique++,u&&(dv?(u.has(c)||u.set(c,[]),u.get(c).push(m)):(Object.prototype.hasOwnProperty.call(u,c)||(u[c]=[]),u[c].push(m))),m}function GS(f,c){var u={min:f+1,max:f+1},f=-1;return c.MDW&&(yo=c.MDW),c.width!=null?u.customWidth=1:c.wpx!=null?f=sv(c.wpx):c.wch!=null&&(f=c.wch),-1<f?(u.width=VS(f),u.customWidth=1):c.width!=null&&(u.width=c.width),c.hidden&&(u.hidden=!0),c.level!=null&&(u.outlineLevel=u.level=c.level),u}function e0(a,c){a&&(c=c=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],a.left==null&&(a.left=c[0]),a.right==null&&(a.right=c[1]),a.top==null&&(a.top=c[2]),a.bottom==null&&(a.bottom=c[3]),a.header==null&&(a.header=c[4]),a.footer==null&&(a.footer=c[5]))}function Sf(a,c,u){if(av!==void 0){if(/^\d+$/.exec(c.s)||c.s&&c.s==+c.s)return c.s;var f=c.s||{};return c.z&&(f.numFmt=c.z),av.addStyle(f)}var m=u.revssf[c.z!=null?c.z:"General"],v=60,p=a.length;if(m==null&&u.ssf){for(;v<392;++v)if(u.ssf[v]==null){cr(c.z,v),u.ssf[v]=c.z,u.revssf[c.z]=m=v;break}}for(v=0;v!=p;++v)if(a[v].numFmtId===m)return v;return a[p]={numFmtId:m,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},p}function U8(a,c,u,f,m,v){try{f.cellNF&&(a.z=B[c])}catch(w){if(f.WTF)throw w}if(a.t!=="z"||f.cellStyles){if(a.t==="d"&&typeof a.v=="string"&&(a.v=ue(a.v)),(!f||f.cellText!==!1)&&a.t!=="z")try{if(B[c]==null&&cr(Ju[c]||"General",c),a.t==="e")a.w=a.w||rh[a.v];else if(c===0)if(a.t==="n")(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Re(a.v);else if(a.t==="d"){var p=ci(a.v);a.w=(0|p)===p?p.toString(10):Re(p)}else{if(a.v===void 0)return;a.w=Oe(a.v,mm)}else a.t==="d"?a.w=vr(c,ci(a.v),mm):a.w=vr(c,a.v,mm)}catch(w){if(f.WTF)throw w}if(f.cellStyles&&u!=null)try{a.s=v.Fills[u],a.s.fgColor&&a.s.fgColor.theme&&!a.s.fgColor.rgb&&(a.s.fgColor.rgb=BS(m.themeElements.clrScheme[a.s.fgColor.theme].rgb,a.s.fgColor.tint||0),f.WTF&&(a.s.fgColor.raw_rgb=m.themeElements.clrScheme[a.s.fgColor.theme].rgb)),a.s.bgColor&&a.s.bgColor.theme&&(a.s.bgColor.rgb=BS(m.themeElements.clrScheme[a.s.bgColor.theme].rgb,a.s.bgColor.tint||0),f.WTF&&(a.s.bgColor.raw_rgb=m.themeElements.clrScheme[a.s.bgColor.theme].rgb))}catch(w){if(f.WTF&&v.Fills)throw w}}}var Ine=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Pne=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Fne=/<(?:\w:)?hyperlink [^>]*>/gm,Mne=/"(\w*:\w*)"/,kne=/<(?:\w:)?col\b[^>]*[\/]?>/g,Nne=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Dne=/<(?:\w:)?pageMargins[^>]*\/>/g,z8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Lne=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Hne=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $ne(a,c,u,f,m,v,p){if(!a)return a;f=f||{"!id":{}};var w=c.dense?[]:{},S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b="",He="",T=a.match(Pne);T?(b=a.slice(0,T.index),He=a.slice(T.index+T[0].length)):b=He=a;var P=b.match(z8);P?EA(P[0],0,m,u):(P=b.match(Lne))&&(a=P[0],P[1],P=w,M=m,k=u,EA(a.slice(0,a.indexOf(">")),0,M,k));var M,k,j=(b.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<j&&(M=b.slice(j,j+50).match(Mne))&&(k=w,(Q=un(Q=M[1])).s.r<=Q.e.r&&Q.s.c<=Q.e.c&&0<=Q.s.r&&0<=Q.s.c&&(k["!ref"]=jr(Q)));var L,Q=b.match(Hne);Q&&Q[1]&&(W=Q[1],(L=m).Views||(L.Views=[{}]),(W.match(Wne)||[]).forEach(function(Fe,Ue){Fe=kr(Fe),L.Views[Ue]||(L.Views[Ue]={}),+Fe.zoomScale&&(L.Views[Ue].zoom=+Fe.zoomScale),hi(Fe.rightToLeft)&&(L.Views[Ue].RTL=!0)}));var G,W=[];c.cellStyles&&(G=b.match(kne))&&function(Fe,Ue){for(var ct=!1,ut=0;ut!=Ue.length;++ut){var Ke=kr(Ue[ut],!0);Ke.hidden&&(Ke.hidden=hi(Ke.hidden));var St=parseInt(Ke.min,10)-1,Wt=parseInt(Ke.max,10)-1;for(Ke.outlineLevel&&(Ke.level=+Ke.outlineLevel||0),delete Ke.min,delete Ke.max,Ke.width=+Ke.width,!ct&&Ke.width&&(ct=!0,mA(Ke.width)),yf(Ke);St<=Wt;)Fe[St++]=Le(Ke)}}(W,G),T&&jne(T[1],w,c,S,v,p),p=He.match(Nne),p&&(w["!autofilter"]={ref:(p[0].match(/ref="([^"]*)"/)||[])[1]});var J=[],ne=He.match(Ine);if(ne)for(j=0;j!=ne.length;++j)J[j]=un(ne[j].slice(ne[j].indexOf('"')+1));p=He.match(Fne),p&&function(Fe,Ue,ct){for(var ut=Array.isArray(Fe),Ke=0;Ke!=Ue.length;++Ke){var St=kr(qn(Ue[Ke]),!0);if(!St.ref)return;var Wt=((ct||{})["!id"]||[])[St.id];Wt?(St.Target=Wt.Target,St.location&&(St.Target+="#"+Sn(St.location))):(St.Target="#"+Sn(St.location),Wt={Target:St.Target,TargetMode:"Internal"}),St.Rel=Wt,St.tooltip&&(St.Tooltip=St.tooltip,delete St.tooltip);for(var $t=un(St.ref),Ot=$t.s.r;Ot<=$t.e.r;++Ot)for(var Pt=$t.s.c;Pt<=$t.e.c;++Pt){var _t=Nr({c:Pt,r:Ot});ut?(Fe[Ot]||(Fe[Ot]=[]),Fe[Ot][Pt]||(Fe[Ot][Pt]={t:"z",v:void 0}),Fe[Ot][Pt].l=St):(Fe[_t]||(Fe[_t]={t:"z",v:void 0}),Fe[_t].l=St)}}}(w,p,f);var se,xe,He=He.match(Dne);return He&&(w["!margins"]=(se=kr(He[0]),xe={},["left","right","top","bottom","header","footer"].forEach(function(Fe){se[Fe]&&(xe[Fe]=parseFloat(se[Fe]))}),xe)),!w["!ref"]&&S.e.c>=S.s.c&&S.e.r>=S.s.r&&(w["!ref"]=jr(S)),0<c.sheetRows&&w["!ref"]&&(He=un(w["!ref"]),c.sheetRows<=+He.e.r&&(He.e.r=c.sheetRows-1,He.e.r>S.e.r&&(He.e.r=S.e.r),He.e.r<He.s.r&&(He.s.r=He.e.r),He.e.c>S.e.c&&(He.e.c=S.e.c),He.e.c<He.s.c&&(He.s.c=He.e.c),w["!fullref"]=w["!ref"],w["!ref"]=jr(He))),0<W.length&&(w["!cols"]=W),0<J.length&&(w["!merges"]=J),w}function EA(a,c,u,f){a=kr(a),u.Sheets[f]||(u.Sheets[f]={}),a.codeName&&(u.Sheets[f].CodeName=Sn(qn(a.codeName)))}var Bne=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Vne=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],Wne=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,G8,Y8,K8,X8,q8,J8,Q8,jne=(G8=/<(?:\w+:)?c[ \/>]/,Y8=/<\/(?:\w+:)?row>/,K8=/r=["']([^"']*)["']/,X8=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,q8=/ref=["']([^"']*)["']/,J8=z1("v"),Q8=z1("f"),function(a,c,u,f,m,v){for(var p,w,S,b,T,P,M=0,k="",j=[],L=[],Q=0,G=0,W="",J=0,ne=0,se=0,xe=0,He=Array.isArray(v.CellXf),Fe=[],Ue=[],ct=Array.isArray(c),ut=[],Ke={},St=!1,Wt=!!u.sheetStubs,$t=a.split(Y8),Ot=0,Pt=$t.length;Ot!=Pt;++Ot){var _t=(k=$t[Ot].trim()).length;if(_t!==0){var mt=0;e:for(M=0;M<_t;++M)switch(k[M]){case">":if(k[M-1]!="/"){++M;break e}if(u&&u.cellStyles){if(J=(S=kr(k.slice(mt,M),!0)).r!=null?parseInt(S.r,10):J+1,ne=-1,u.sheetRows&&u.sheetRows<J)continue;St=!(Ke={}),S.ht&&(St=!0,Ke.hpt=parseFloat(S.ht),Ke.hpx=fm(Ke.hpt)),S.hidden=="1"&&(St=!0,Ke.hidden=!0),S.outlineLevel!=null&&(St=!0,Ke.level=+S.outlineLevel),St&&(ut[J-1]=Ke)}break;case"<":mt=M}if(M<=mt)break;if(J=(S=kr(k.slice(mt,M),!0)).r!=null?parseInt(S.r,10):J+1,ne=-1,!(u.sheetRows&&u.sheetRows<J)){f.s.r>J-1&&(f.s.r=J-1),f.e.r<J-1&&(f.e.r=J-1),u&&u.cellStyles&&(St=!(Ke={}),S.ht&&(St=!0,Ke.hpt=parseFloat(S.ht),Ke.hpx=fm(Ke.hpt)),S.hidden=="1"&&(St=!0,Ke.hidden=!0),S.outlineLevel!=null&&(St=!0,Ke.level=+S.outlineLevel),St&&(ut[J-1]=Ke)),j=k.slice(M).split(G8);for(var Zt,or=0;or!=j.length&&j[or].trim().charAt(0)=="<";++or);for(j=j.slice(or),M=0;M!=j.length;++M)if((k=j[M].trim()).length!==0){if(L=k.match(K8),Q=M,G=0,k="<c "+(k.slice(0,1)=="<"?">":"")+k,L!=null&&L.length===2){for(Q=0,W=L[1],G=0;G!=W.length&&!((p=W.charCodeAt(G)-64)<1||26<p);++G)Q=26*Q+p;ne=--Q}else++ne;for(G=0;G!=k.length&&k.charCodeAt(G)!==62;++G);if(++G,(S=kr(k.slice(0,G),!0)).r||(S.r=Nr({r:J-1,c:ne})),w={t:""},(L=(W=k.slice(G)).match(J8))!=null&&L[1]!==""&&(w.v=Sn(L[1])),u.cellFormula){(L=W.match(Q8))!=null&&L[1]!==""?(w.f=Sn(qn(L[1])).replace(/\r\n/g,`
`),u.xlfn||(w.f=F8(w.f)),-1<L[0].indexOf('t="array"')?(w.F=(W.match(q8)||[])[1],-1<w.F.indexOf(":")&&Fe.push([un(w.F),w.F])):-1<L[0].indexOf('t="shared"')&&(T=kr(L[0]),Zt=Sn(qn(L[1])),u.xlfn||(Zt=F8(Zt)),Ue[parseInt(T.si,10)]=[T,Zt,S.r])):(L=W.match(/<f[^>]*\/>/))&&Ue[(T=kr(L[0])).si]&&(w.f=(P=Ue[T.si][1],Kt=Ue[T.si][2],Zt=S.r,Kt=Ho(Kt).s,Zt=Ri(Zt),P8(P,{r:Zt.r-Kt.r,c:Zt.c-Kt.c})));for(var Cr=Ri(S.r),G=0;G<Fe.length;++G)Cr.r>=Fe[G][0].s.r&&Cr.r<=Fe[G][0].e.r&&Cr.c>=Fe[G][0].s.c&&Cr.c<=Fe[G][0].e.c&&(w.F=Fe[G][1])}if(S.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else{if(!Wt)continue;w.t="z"}else w.t=S.t||"n";switch(f.s.c>ne&&(f.s.c=ne),f.e.c<ne&&(f.e.c=ne),w.t){case"n":if(w.v==""||w.v==null){if(!Wt)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(w.v===void 0){if(!Wt)continue;w.t="z"}else b=fv[parseInt(w.v,10)],w.v=b.t,w.r=b.r,u.cellHTML&&(w.h=b.h);break;case"str":w.t="s",w.v=w.v!=null?qn(w.v):"",u.cellHTML&&(w.h=IR(w.v));break;case"inlineStr":L=W.match(X8),w.t="s",L!=null&&(b=hA(L[1]))?(w.v=b.t,u.cellHTML&&(w.h=b.h)):w.v="";break;case"b":w.v=hi(w.v);break;case"d":u.cellDates?w.v=ue(w.v,1):(w.v=ci(ue(w.v,1)),w.t="n");break;case"e":u&&u.cellText===!1||(w.w=w.v),w.v=B5[w.v]}var Gr,se=xe=0,Kt=null;He&&S.s!==void 0&&(Kt=v.CellXf[S.s])!=null&&(Kt.numFmtId!=null&&(se=Kt.numFmtId),u.cellStyles&&Kt.fillId!=null&&(xe=Kt.fillId)),U8(w,se,xe,u,m,v),u.cellDates&&He&&w.t=="n"&&Si(B[se])&&(w.t="d",w.v=ee(w.v)),S.cm&&u.xlmeta&&(Gr=(u.xlmeta.Cell||[])[+S.cm-1])&&Gr.type=="XLDAPR"&&(w.D=!0),ct?(c[(Gr=Ri(S.r)).r]||(c[Gr.r]=[]),c[Gr.r][Gr.c]=w):c[S.r]=w}}}}0<ut.length&&(c["!rows"]=ut)});function Une(a,c){for(var u,f,m,v,p=[],w=[],S=un(a["!ref"]),b=[],T=0,L=0,P=a["!rows"],M=Array.isArray(a),k={r:""},j=-1,L=S.s.c;L<=S.e.c;++L)b[L]=fi(L);for(T=S.s.r;T<=S.e.r;++T){for(w=[],m=Vi(T),L=S.s.c;L<=S.e.c;++L){f=b[L]+m;var Q=M?(a[T]||[])[L]:a[f];Q!==void 0&&(u=function(G,W,J,ne){if(G.c&&J["!comments"].push([W,G.c]),G.v===void 0&&typeof G.f!="string"||G.t==="z"&&!G.f)return"";var se="",xe=G.t,He=G.v;if(G.t!=="z")switch(G.t){case"b":se=G.v?"1":"0";break;case"n":se=""+G.v;break;case"e":se=rh[G.v];break;case"d":se=ne&&ne.cellDates?ue(G.v,-1).toISOString():((G=Le(G)).t="n",""+(G.v=ci(ue(G.v)))),G.z===void 0&&(G.z=B[14]);break;default:se=G.v}var Fe=Ks("v",$n(se)),Ue={r:W},ct=Sf(ne.cellXfs,G,ne);switch(ct!==0&&(Ue.s=ct),G.t){case"n":break;case"d":Ue.t="d";break;case"b":Ue.t="b";break;case"e":Ue.t="e";break;case"z":break;default:if(G.v==null){delete G.t;break}if(32767<G.v.length)throw new Error("Text length must not exceed 32767 characters");if(ne&&ne.bookSST){Fe=Ks("v",""+xA(ne.Strings,G.v,ne.revStrings)),Ue.t="s";break}Ue.t="str"}return G.t!=xe&&(G.t=xe,G.v=He),typeof G.f=="string"&&G.f&&(He=G.F&&G.F.slice(0,W.length)==W?{t:"array",ref:G.F}:null,Fe=Dt("f",$n(G.f),He)+(G.v!=null?Fe:"")),G.l&&J["!links"].push([W,G.l]),G.D&&(Ue.cm=1),Dt("c",Fe,Ue)}(Q,f,a,c))!=null&&w.push(u)}(0<w.length||P&&P[T])&&(k={r:m},P&&P[T]&&((v=P[T]).hidden&&(k.hidden=1),j=-1,v.hpx?j=ov(v.hpx):v.hpt&&(j=v.hpt),-1<j&&(k.ht=j,k.customHeight=1),v.level&&(k.outlineLevel=v.level)),p[p.length]=Dt("row",w.join(""),k))}if(P)for(;T<P.length;++T)P&&P[T]&&(k={r:T+1},(v=P[T]).hidden&&(k.hidden=1),j=-1,v.hpx?j=ov(v.hpx):v.hpt&&(j=v.hpt),-1<j&&(k.ht=j,k.customHeight=1),v.level&&(k.outlineLevel=v.level),p[p.length]=Dt("row","",k));return p.join("")}function Z8(a,c,u,f){var m,v,p=[ui,Dt("worksheet",null,{xmlns:jd[0],"xmlns:r":bs.r})],w=u.SheetNames[a],S=u.Sheets[w],b=(S=S??{})["!ref"]||"A1",T=un(b);if(16383<T.e.c||1048575<T.e.r){if(c.WTF)throw new Error("Range "+b+" exceeds format limit A1:XFD1048576");T.e.c=Math.min(T.e.c,16383),T.e.r=Math.min(T.e.c,1048575),b=jr(T)}f=f||{},S["!comments"]=[];var P,M,k=[];(function(G,W,J,ne,se){var xe=!1,He={},Fe=null;if(ne.bookType!=="xlsx"&&W.vbaraw){var Ue=W.SheetNames[J];try{W.Workbook&&(Ue=W.Workbook.Sheets[J].CodeName||Ue)}catch{}xe=!0,He.codeName=zc($n(Ue))}G&&G["!outline"]&&(ne={summaryBelow:1,summaryRight:1},G["!outline"].above&&(ne.summaryBelow=0),G["!outline"].left&&(ne.summaryRight=0),Fe=(Fe||"")+Dt("outlinePr",null,ne)),(xe||Fe)&&(se[se.length]=Dt("sheetPr",Fe,He))})(S,u,a,c,p),p[p.length]=Dt("dimension",null,{ref:b}),p[p.length]=(w={workbookViewId:"0"},((((T=u)||{}).Workbook||{}).Views||[])[0]&&(w.rightToLeft=T.Workbook.Views[0].RTL?"1":"0"),Dt("sheetViews",Dt("sheetView",null,w),{})),c.sheetFormat&&(p[p.length]=Dt("sheetFormatPr",null,{defaultRowHeight:c.sheetFormat.defaultRowHeight||"16",baseColWidth:c.sheetFormat.baseColWidth||"10",outlineLevelRow:c.sheetFormat.outlineLevelRow||"7"})),S["!cols"]!=null&&0<S["!cols"].length&&(p[p.length]=function(G){for(var W,J=["<cols>"],ne=0;ne!=G.length;++ne)(W=G[ne])&&(J[J.length]=Dt("col",null,GS(ne,W)));return J[J.length]="</cols>",J.join("")}(S["!cols"])),p[m=p.length]="<sheetData/>",S["!links"]=[],S["!ref"]!=null&&0<(v=Une(S,c)).length&&(p[p.length]=v),p.length>m+1&&(p[p.length]="</sheetData>",p[m]=p[m].replace("/>",">")),S["!protect"]&&(p[p.length]=(P=S["!protect"],M={sheet:1},Bne.forEach(function(G){P[G]!=null&&P[G]&&(M[G]="1")}),Vne.forEach(function(G){P[G]==null||P[G]||(M[G]="0")}),P.password&&(M.password=fA(P.password).toString(16).toUpperCase()),Dt("sheetProtection",null,M))),S["!autofilter"]!=null&&(p[p.length]=function(G,W,J,ne){var se=typeof G.ref=="string"?G.ref:jr(G.ref);J.Workbook||(J.Workbook={Sheets:[]}),J.Workbook.Names||(J.Workbook.Names=[]);var xe=J.Workbook.Names;(G=Ho(se)).s.r==G.e.r&&(G.e.r=Ho(W["!ref"]).e.r,se=jr(G));for(var He=0;He<xe.length;++He){var Fe=xe[He];if(Fe.Name=="_xlnm._FilterDatabase"&&Fe.Sheet==ne){Fe.Ref="'"+J.SheetNames[ne]+"'!"+se;break}}return He==xe.length&&xe.push({Name:"_xlnm._FilterDatabase",Sheet:ne,Ref:"'"+J.SheetNames[ne]+"'!"+se}),Dt("autoFilter",null,{ref:se})}(S["!autofilter"],S,u,a)),S["!merges"]!=null&&0<S["!merges"].length&&(p[p.length]=function(G){if(G.length===0)return"";for(var W='<mergeCells count="'+G.length+'">',J=0;J!=G.length;++J)W+='<mergeCell ref="'+jr(G[J])+'"/>';return W+"</mergeCells>"}(S["!merges"]));var j,L,Q=-1;return 0<S["!links"].length&&(p[p.length]="<hyperlinks>",S["!links"].forEach(function(G){G[1].Target&&(L={ref:G[0]},G[1].Target.charAt(0)!="#"&&(Q=Bn(f,-1,$n(G[1].Target).replace(/#.*$/,""),zr.HLINK),L["r:id"]="rId"+Q),-1<(j=G[1].Target.indexOf("#"))&&(L.location=$n(G[1].Target.slice(j+1))),G[1].Tooltip&&(L.tooltip=$n(G[1].Tooltip)),p[p.length]=Dt("hyperlink",null,L))}),p[p.length]="</hyperlinks>"),delete S["!links"],S["!margins"]!=null&&(p[p.length]=(e0(u=S["!margins"]),Dt("pageMargins",null,u))),c&&!c.ignoreEC&&c.ignoreEC!=null||(p[p.length]=Ks("ignoredErrors",Dt("ignoredError",null,{numberStoredAsText:1,sqref:b}))),0<k.length&&(Q=Bn(f,-1,"../drawings/drawing"+(a+1)+".xml",zr.DRAW),p[p.length]=Dt("drawing",null,{"r:id":"rId"+Q}),S["!drawing"]=k),0<S["!comments"].length&&(Q=Bn(f,-1,"../drawings/vmlDrawing"+(a+1)+".vml",zr.VML),p[p.length]=Dt("legacyDrawing",null,{"r:id":"rId"+Q}),S["!legacy"]=Q),1<p.length&&(p[p.length]="</worksheet>",p[1]=p[1].replace("/>",">")),p.join("")}function zne(a,c,u,f){u=function(m,v,p){var w=it(145),S=(p["!rows"]||[])[m]||{};w.write_shift(4,m),w.write_shift(4,0);var T=320;S.hpx?T=20*ov(S.hpx):S.hpt&&(T=20*S.hpt),w.write_shift(2,T),w.write_shift(1,0),T=0,S.level&&(T|=S.level),S.hidden&&(T|=16),(S.hpx||S.hpt)&&(T|=32),w.write_shift(1,T),w.write_shift(1,0);var b=0,T=w.l;w.l+=4;for(var P={r:m,c:0},M=0;M<16;++M)if(!(v.s.c>M+1<<10||v.e.c<M<<10)){for(var k=-1,j=-1,L=M<<10;L<M+1<<10;++L)P.c=L,(Array.isArray(p)?(p[P.r]||[])[P.c]:p[Nr(P)])&&(k<0&&(k=L),j=L);k<0||(++b,w.write_shift(4,k),w.write_shift(4,j))}return m=w.l,w.l=T,w.write_shift(4,b),w.l=m,w.length>w.l?w.slice(0,w.l):w}(f,u,c),(17<u.length||(c["!rows"]||[])[f])&&gt(a,0,u)}var YS=Kd,Gne=om;function eH(a){return[Gd(a),vo(a),"n"]}var pm=Kd,Yne=om,tH=["left","right","top","bottom","header","footer"];function Kne(a,c,u,f,m,v,p){if(c.v===void 0)return!1;var w="";switch(c.t){case"b":w=c.v?"1":"0";break;case"d":(c=Le(c)).z=c.z||B[14],c.v=ci(ue(c.v)),c.t="n";break;case"n":case"e":w=""+c.v;break;default:w=c.v}var S,b,T,P,M,k,j,L,Q,G,W,J,ne,se,xe,He,Fe,Ue,ct,ut,Ke={r:u,c:f};switch(Ke.s=Sf(m.cellXfs,c,m),c.l&&v["!links"].push([Nr(Ke),c.l]),c.c&&v["!comments"].push([Nr(Ke),c.c]),c.t){case"s":case"str":return m.bookSST?(w=xA(m.Strings,c.v,m.revStrings),Ke.t="s",Ke.v=w,p?gt(a,18,(Yd(Fe=Ke,Ue=Ue??it(8)),Ue.write_shift(4,Fe.v),Ue)):gt(a,7,(zd(Fe=Ke,He=He??it(12)),He.write_shift(4,Fe.v),He))):(Ke.t="str",p?gt(a,17,(se=c,Yd(Ke,xe=xe??it(8+4*se.v.length)),ks(se.v,xe),xe.length>xe.l?xe.slice(0,xe.l):xe)):gt(a,6,(se=c,zd(Ke,ne=ne??it(12+4*se.v.length)),ks(se.v,ne),ne.length>ne.l?ne.slice(0,ne.l):ne))),!0;case"n":return c.v==(0|c.v)&&-1e3<c.v&&c.v<1e3?p?gt(a,13,(W=c,Yd(Ke,J=J??it(8)),k5(W.v,J),J)):gt(a,2,(W=c,zd(Ke,G=G??it(12)),k5(W.v,G),G)):p?gt(a,16,(L=c,Yd(Ke,Q=Q??it(12)),am(L.v,Q),Q)):gt(a,5,(L=c,zd(Ke,j=j??it(16)),am(L.v,j),j)),!0;case"b":return Ke.t="b",p?gt(a,15,(M=c,Yd(Ke,k=k??it(5)),k.write_shift(1,M.v?1:0),k)):gt(a,4,(M=c,zd(Ke,P=P??it(9)),P.write_shift(1,M.v?1:0),P)),!0;case"e":return Ke.t="e",p?gt(a,14,(b=c,Yd(Ke,T=T??it(8)),T.write_shift(1,b.v),T.write_shift(2,0),T.write_shift(1,0),T)):gt(a,3,(b=c,zd(Ke,S=S??it(9)),S.write_shift(1,b.v),S)),!0}return p?gt(a,12,Yd(Ke,ut=ut??it(4))):gt(a,1,zd(Ke,ct=ct??it(8))),!0}function Xne(a,c){var u,f;c&&c["!merges"]&&(gt(a,177,(u=c["!merges"].length,(f=f??it(4)).write_shift(4,u),f)),c["!merges"].forEach(function(m){gt(a,176,Yne(m))}),gt(a,178))}function qne(a,c){c&&c["!cols"]&&(gt(a,390),c["!cols"].forEach(function(u,f){u&&gt(a,60,function(m,v,p){p==null&&(p=it(18));var w=GS(m,v);return p.write_shift(-4,m),p.write_shift(-4,m),p.write_shift(4,256*(w.width||10)),p.write_shift(4,0),m=0,v.hidden&&(m|=1),typeof w.width=="number"&&(m|=2),v.level&&(m|=v.level<<8),p.write_shift(2,m),p}(f,u))}),gt(a,391))}function Jne(a,c){var u;c&&c["!ref"]&&(gt(a,648),gt(a,649,(u=un(c["!ref"]),(c=it(24)).write_shift(4,4),c.write_shift(4,1),om(u,c),c)),gt(a,650))}function Qne(a,c,u){c["!links"].forEach(function(f){var m,v;f[1].Target&&(m=Bn(u,-1,f[1].Target.replace(/#.*$/,""),zr.HLINK),gt(a,494,(v=m,f=it(50+4*((m=f)[1].Target.length+(m[1].Tooltip||"").length)),om({s:Ri(m[0]),e:Ri(m[0])},f),YR("rId"+v,f),ks(((v=m[1].Target.indexOf("#"))==-1?"":m[1].Target.slice(v+1))||"",f),ks(m[1].Tooltip||"",f),ks("",f),f.slice(0,f.l))))}),delete c["!links"]}function Zne(a,c,u){gt(a,133),gt(a,137,function(f,m){m==null&&(m=it(30));var v=924;return(((f||{}).Views||[])[0]||{}).RTL&&(v|=32),m.write_shift(2,v),m.write_shift(4,0),m.write_shift(4,0),m.write_shift(4,0),m.write_shift(1,0),m.write_shift(1,0),m.write_shift(2,0),m.write_shift(2,100),m.write_shift(2,0),m.write_shift(2,0),m.write_shift(2,0),m.write_shift(4,0),m}(u)),gt(a,138),gt(a,134)}function eie(a,c){var u,f;c["!protect"]&&gt(a,535,(u=c["!protect"],(f=f??it(66)).write_shift(2,u.password?fA(u.password):0),f.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(m){m[1]?f.write_shift(4,u[m[0]]==null||u[m[0]]?0:1):f.write_shift(4,u[m[0]]!=null&&u[m[0]]?0:1)}),f))}function tie(a,c,u,f){var m=ha(),b=u.SheetNames[a],v=u.Sheets[b]||{},p=b;try{u&&u.Workbook&&(p=u.Workbook.Sheets[a].CodeName||p)}catch{}var w,S,b=un(v["!ref"]||"A1");if(16383<b.e.c||1048575<b.e.r){if(c.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575)}return v["!links"]=[],v["!comments"]=[],gt(m,129),(u.vbaraw||v["!outline"])&&gt(m,147,function(T,P,M){M==null&&(M=it(84+4*T.length));var k=192;P&&(P.above&&(k&=-65),P.left&&(k&=-129)),M.write_shift(1,k);for(var j=1;j<3;++j)M.write_shift(1,0);return TS({auto:1},M),M.write_shift(-4,-1),M.write_shift(-4,-1),M5(T,M),M.slice(0,M.l)}(p,v["!outline"])),gt(m,148,Gne(b)),Zne(m,0,u.Workbook),qne(m,v),function(T,P,M){var k,j=un(P["!ref"]||"A1"),L=[];gt(T,145);var Q=Array.isArray(P),G=j.e.r;P["!rows"]&&(G=Math.max(j.e.r,P["!rows"].length-1));for(var W=j.s.r;W<=G;++W){k=Vi(W),zne(T,P,j,W);var J=!1;if(W<=j.e.r)for(var ne=j.s.c;ne<=j.e.c;++ne){W===j.s.r&&(L[ne]=fi(ne)),se=L[ne]+k;var se=Q?(P[W]||[])[ne]:P[se];se?J=Kne(T,se,W,ne,M,P,J):J=!1}}gt(T,146)}(m,v,c),eie(m,v),function(T,P,M,k){if(P["!autofilter"]){var Q=P["!autofilter"],j=typeof Q.ref=="string"?Q.ref:jr(Q.ref);M.Workbook||(M.Workbook={Sheets:[]}),M.Workbook.Names||(M.Workbook.Names=[]);var L=M.Workbook.Names,Q=Ho(j);Q.s.r==Q.e.r&&(Q.e.r=Ho(P["!ref"]).e.r,j=jr(Q));for(var G=0;G<L.length;++G){var W=L[G];if(W.Name=="_xlnm._FilterDatabase"&&W.Sheet==k){W.Ref="'"+M.SheetNames[k]+"'!"+j;break}}G==L.length&&L.push({Name:"_xlnm._FilterDatabase",Sheet:k,Ref:"'"+M.SheetNames[k]+"'!"+j}),gt(T,161,om(un(j))),gt(T,162)}}(m,v,u,a),Xne(m,v),Qne(m,v,f),v["!margins"]&&gt(m,476,(w=v["!margins"],S==null&&(S=it(48)),e0(w),tH.forEach(function(T){am(w[T],S)}),S)),c&&!c.ignoreEC&&c.ignoreEC!=null||Jne(m,v),b=m,c=a,f=f,0<(v=v)["!comments"].length&&(c=Bn(f,-1,"../drawings/vmlDrawing"+(c+1)+".vml",zr.VML),gt(b,551,YR("rId"+c)),v["!legacy"]=c),gt(m,130),m.end()}function rie(a,c,u,f,m,v){var p=v||{"!type":"chart"};if(!a)return v;var w,S=0,b=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(a.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(P){var M=function(k){var j,L=[],Q=k.match(/^<c:numCache>/);(k.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(W){W=W.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),W&&(L[+W[1]]=Q?+W[2]:W[2])});var G=Sn((k.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(k.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(W){j=W.replace(/<.*?>/g,"")}),[L,G,j]}(P);T.s.r=T.s.c=0,T.e.c=S,w=fi(S),M[0].forEach(function(k,j){p[w+Vi(j)]={t:"n",v:k,z:M[1]},b=j}),T.e.r<b&&(T.e.r=b),++S}),0<S&&(p["!ref"]=jr(T)),p}var TA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],iie=[],sie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function rH(a,c){for(var u=0;u!=a.length;++u)for(var f=a[u],m=0;m!=c.length;++m){var v=c[m];if(f[v[0]]==null)f[v[0]]=v[1];else switch(v[2]){case"bool":typeof f[v[0]]=="string"&&(f[v[0]]=hi(f[v[0]]));break;case"int":typeof f[v[0]]=="string"&&(f[v[0]]=parseInt(f[v[0]],10))}}}function nH(a,c){for(var u=0;u!=c.length;++u){var f=c[u];if(a[f[0]]==null)a[f[0]]=f[1];else switch(f[2]){case"bool":typeof a[f[0]]=="string"&&(a[f[0]]=hi(a[f[0]]));break;case"int":typeof a[f[0]]=="string"&&(a[f[0]]=parseInt(a[f[0]],10))}}}function iH(a){nH(a.WBProps,TA),nH(a.CalcPr,sie),rH(a.WBView,nie),rH(a.Sheets,iie),mm.date1904=hi(a.WBProps.date1904)}var oie="][*?/\\".split("");function sH(a,c){if(31<a.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return oie.forEach(function(f){if(a.indexOf(f)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function oH(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var c,u,f,m=a.Workbook&&a.Workbook.Sheets||[];c=a.SheetNames,u=m,f=!!a.vbaraw,c.forEach(function(p,w){sH(p);for(var S=0;S<w;++S)if(p==c[S])throw new Error("Duplicate Sheet Name: "+p);if(f){var b=u&&u[w]&&u[w].CodeName||p;if(b.charCodeAt(0)==95&&22<b.length)throw new Error("Bad Code Name: Worksheet"+b)}});for(var v=0;v<a.SheetNames.length;++v)(function(p,w){if(p&&p["!ref"]){var S=un(p["!ref"]);if(S.e.c<S.s.c||S.e.r<S.s.r)throw new Error("Bad range ("+w+"): "+p["!ref"])}})(a.Sheets[a.SheetNames[v]],(a.SheetNames[v],v))}var aie=/<\w+:workbook/;function aH(a){var c=[ui];c[c.length]=Dt("workbook",null,{xmlns:jd[0],"xmlns:r":bs.r});var u=a.Workbook&&0<(a.Workbook.Names||[]).length,f={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(TA.forEach(function(w){a.Workbook.WBProps[w[0]]!=null&&a.Workbook.WBProps[w[0]]!=w[1]&&(f[w[0]]=a.Workbook.WBProps[w[0]])}),a.Workbook.WBProps.CodeName&&(f.codeName=a.Workbook.WBProps.CodeName,delete f.CodeName)),c[c.length]=Dt("workbookPr",null,f);var m=a.Workbook&&a.Workbook.Sheets||[],v=0;if(m[0]&&m[0].Hidden){for(c[c.length]="<bookViews>",v=0;v!=a.SheetNames.length&&m[v]&&m[v].Hidden;++v);v==a.SheetNames.length&&(v=0),c[c.length]='<workbookView firstSheet="'+v+'" activeTab="'+v+'"/>',c[c.length]="</bookViews>"}for(c[c.length]="<sheets>",v=0;v!=a.SheetNames.length;++v){var p={name:$n(a.SheetNames[v].slice(0,31))};if(p.sheetId=""+(v+1),p["r:id"]="rId"+(v+1),m[v])switch(m[v].Hidden){case 1:p.state="hidden";break;case 2:p.state="veryHidden"}c[c.length]=Dt("sheet",null,p)}return c[c.length]="</sheets>",u&&(c[c.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(w){var S={name:w.Name};w.Comment&&(S.comment=w.Comment),w.Sheet!=null&&(S.localSheetId=""+w.Sheet),w.Hidden&&(S.hidden="1"),w.Ref&&(c[c.length]=Dt("definedName",$n(w.Ref),S))}),c[c.length]="</definedNames>"),2<c.length&&(c[c.length]="</workbook>",c[1]=c[1].replace("/>",">")),c.join("")}function lie(a,c){var u={};return a.read_shift(4),u.ArchID=a.read_shift(4),a.l+=c-8,u}function cie(a,c){gt(a,143);for(var u,f=0;f!=c.SheetNames.length;++f){var m={Hidden:c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[f]&&c.Workbook.Sheets[f].Hidden||0,iTabID:f+1,strRelID:"rId"+(f+1),name:c.SheetNames[f]};gt(a,156,(u=m,(m=(m=void 0)||it(127)).write_shift(4,u.Hidden),m.write_shift(4,u.iTabID),YR(u.strRelID,m),ks(u.name.slice(0,31),m),m.length>m.l?m.slice(0,m.l):m))}gt(a,144)}function uie(a,c){if(c.Workbook&&c.Workbook.Sheets){for(var u,f=c.Workbook.Sheets,m=0,v=-1,p=-1;m<f.length;++m)!f[m]||!f[m].Hidden&&v==-1?v=m:f[m].Hidden==1&&p==-1&&(p=m);v<p||(gt(a,135),gt(a,158,(c=v,(u=u||it(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,c),u.write_shift(4,c),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),gt(a,136))}}function hie(a,c){var u=ha();return gt(u,131),gt(u,128,function(f){f=f||it(127);for(var m=0;m!=4;++m)f.write_shift(4,0);return ks("SheetJS",f),ks(s.version,f),ks(s.version,f),ks("7262",f),f.length>f.l?f.slice(0,f.l):f}()),gt(u,153,function(f,m){m=m||it(72);var v=0;return f&&f.filterPrivacy&&(v|=8),m.write_shift(4,v),m.write_shift(4,0),M5(f&&f.CodeName||"ThisWorkbook",m),m.slice(0,m.l)}(a.Workbook&&a.Workbook.WBProps||null)),uie(u,a),cie(u,a),gt(u,132),u.end()}function fie(a,c,u){return(c.slice(-4)===".bin"?function(f,m){var v={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},p=[],w=!1;(m=m||{}).biff=12;var S=[],b=[[]];return b.SheetNames=[],b.XTI=[],pv[16]={n:"BrtFRTArchID$",f:lie},th(f,function(T,P,M){switch(M){case 156:b.SheetNames.push(T.name),v.Sheets.push(T);break;case 153:v.WBProps=T;break;case 39:T.Sheet!=null&&(m.SID=T.Sheet),T.Ref=Bo(T.Ptg,0,null,b,m),delete m.SID,delete T.Ptg,S.push(T);break;case 1036:break;case 357:case 358:case 355:case 667:b[0].length?b.push([M,T]):b[0]=[M,T],b[b.length-1].XTI=[];break;case 362:b.length===0&&(b[0]=[],b[0].XTI=[]),b[b.length-1].XTI=b[b.length-1].XTI.concat(T),b.XTI=b.XTI.concat(T);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:p.push(M),w=!0;break;case 36:p.pop(),w=!1;break;case 37:p.push(M),w=!0;break;case 38:p.pop(),w=!1;break;case 16:break;default:if(!P.T&&(!w||m.WTF&&p[p.length-1]!=37&&p[p.length-1]!=35))throw new Error("Unexpected record 0x"+M.toString(16))}},m),iH(v),v.Names=S,v.supbooks=b,v}:function(f,m){if(!f)throw new Error("Could not find file");var v={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},p=!1,w="xmlns",S={},b=0;if(f.replace(go,function(T,P){var M=kr(T);switch(Uc(M[0])){case"<?xml":break;case"<workbook":T.match(aie)&&(w="xmlns"+T.match(/<(\w+):/)[1]),v.xmlns=M[w];break;case"</workbook>":break;case"<fileVersion":delete M[0],v.AppVersion=M;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":TA.forEach(function(k){if(M[k[0]]!=null)switch(k[2]){case"bool":v.WBProps[k[0]]=hi(M[k[0]]);break;case"int":v.WBProps[k[0]]=parseInt(M[k[0]],10);break;default:v.WBProps[k[0]]=M[k[0]]}}),M.codeName&&(v.WBProps.CodeName=qn(M.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete M[0],v.WBView.push(M);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(M.state){case"hidden":M.Hidden=1;break;case"veryHidden":M.Hidden=2;break;default:M.Hidden=0}delete M.state,M.name=Sn(qn(M.name)),delete M[0],v.Sheets.push(M);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":p=!0;break;case"</definedNames>":p=!1;break;case"<definedName":(S={}).Name=qn(M.name),M.comment&&(S.Comment=M.comment),M.localSheetId&&(S.Sheet=+M.localSheetId),hi(M.hidden||"0")&&(S.Hidden=!0),b=P+T.length;break;case"</definedName>":S.Ref=Sn(qn(f.slice(b,P))),v.Names.push(S);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete M[0],v.CalcPr=M;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":p=!0;break;case"</AlternateContent>":p=!1;break;case"<revisionPtr":break;default:if(!p&&m.WTF)throw new Error("unrecognized "+M[0]+" in workbook")}return T}),jd.indexOf(v.xmlns)===-1)throw new Error("Unknown Namespace: "+v.xmlns);return iH(v),v})(a,u)}function die(a,c,u,f,m,v,p,w){return(c.slice(-4)===".bin"?function(S,b,T,P,M,k,j){if(!S)return S;var L=b||{};P=P||{"!id":{}};var Q,G,W,J,ne,se,xe,He,Fe,Ue,ct=L.dense?[]:{},ut={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ke=!1,St=!1,Wt=[];L.biff=12;var $t=L["!row"]=0,Ot=!1,Pt=[],_t={},mt=L.supbooks||M.supbooks||[[]];if(mt.sharedf=_t,mt.arrayf=Pt,mt.SheetNames=M.SheetNames||M.Sheets.map(function(Ct){return Ct.name}),!L.supbooks&&(L.supbooks=mt,M.Names))for(var Zt=0;Zt<M.Names.length;++Zt)mt[0][Zt+1]=M.Names[Zt];var or,Cr=[],Gr=[],Kt=!1;return pv[16]={n:"BrtShortReal",f:eH},th(S,function(Ct,Dr,fn){if(!St)switch(fn){case 148:Q=Ct;break;case 0:G=Ct,L.sheetRows&&L.sheetRows<=G.r&&(St=!0),Fe=Vi(ne=G.r),L["!row"]=G.r,(Ct.hidden||Ct.hpt||Ct.level!=null)&&(Ct.hpt&&(Ct.hpx=fm(Ct.hpt)),Gr[Ct.r]=Ct);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(W={t:Ct[2]},Ct[2]){case"n":W.v=Ct[1];break;case"s":He=fv[Ct[1]],W.v=He.t,W.r=He.r;break;case"b":W.v=!!Ct[1];break;case"e":W.v=Ct[1],L.cellText!==!1&&(W.w=rh[W.v]);break;case"str":W.t="s",W.v=Ct[1];break;case"is":W.t="s",W.v=Ct[1].t}if((J=j.CellXf[Ct[0].iStyleRef])&&U8(W,J.numFmtId,null,L,k,j),se=Ct[0].c==-1?se+1:Ct[0].c,L.dense?(ct[ne]||(ct[ne]=[]),ct[ne][se]=W):ct[fi(se)+Fe]=W,L.cellFormula){for(Ot=!1,$t=0;$t<Pt.length;++$t){var rn=Pt[$t];G.r>=rn[0].s.r&&G.r<=rn[0].e.r&&se>=rn[0].s.c&&se<=rn[0].e.c&&(W.F=jr(rn[0]),Ot=!0)}!Ot&&3<Ct.length&&(W.f=Ct[3])}ut.s.r>G.r&&(ut.s.r=G.r),ut.s.c>se&&(ut.s.c=se),ut.e.r<G.r&&(ut.e.r=G.r),ut.e.c<se&&(ut.e.c=se),L.cellDates&&J&&W.t=="n"&&Si(B[J.numFmtId])&&(In=Ce(W.v))&&(W.t="d",W.v=new Date(In.y,In.m-1,In.d,In.H,In.M,In.S,In.u)),or&&(or.type=="XLDAPR"&&(W.D=!0),or=void 0);break;case 1:case 12:if(!L.sheetStubs||Ke)break;W={t:"z",v:void 0},se=Ct[0].c==-1?se+1:Ct[0].c,L.dense?(ct[ne]||(ct[ne]=[]),ct[ne][se]=W):ct[fi(se)+Fe]=W,ut.s.r>G.r&&(ut.s.r=G.r),ut.s.c>se&&(ut.s.c=se),ut.e.r<G.r&&(ut.e.r=G.r),ut.e.c<se&&(ut.e.c=se),or&&(or.type=="XLDAPR"&&(W.D=!0),or=void 0);break;case 176:Wt.push(Ct);break;case 49:or=((L.xlmeta||{}).Cell||[])[Ct-1];break;case 494:var In=P["!id"][Ct.relId];for(In?(Ct.Target=In.Target,Ct.loc&&(Ct.Target+="#"+Ct.loc),Ct.Rel=In):Ct.relId==""&&(Ct.Target="#"+Ct.loc),ne=Ct.rfx.s.r;ne<=Ct.rfx.e.r;++ne)for(se=Ct.rfx.s.c;se<=Ct.rfx.e.c;++se)L.dense?(ct[ne]||(ct[ne]=[]),ct[ne][se]||(ct[ne][se]={t:"z",v:void 0}),ct[ne][se].l=Ct):(xe=Nr({c:se,r:ne}),ct[xe]||(ct[xe]={t:"z",v:void 0}),ct[xe].l=Ct);break;case 426:if(!L.cellFormula)break;Pt.push(Ct),(Ue=L.dense?ct[ne][se]:ct[fi(se)+Fe]).f=Bo(Ct[1],0,{r:G.r,c:se},mt,L),Ue.F=jr(Ct[0]);break;case 427:if(!L.cellFormula)break;_t[Nr(Ct[0].s)]=Ct[1],(Ue=L.dense?ct[ne][se]:ct[fi(se)+Fe]).f=Bo(Ct[1],0,{r:G.r,c:se},mt,L);break;case 60:if(!L.cellStyles)break;for(;Ct.e>=Ct.s;)Cr[Ct.e--]={width:Ct.w/256,hidden:!!(1&Ct.flags),level:Ct.level},Kt||(Kt=!0,mA(Ct.w/256)),yf(Cr[Ct.e+1]);break;case 161:ct["!autofilter"]={ref:jr(Ct)};break;case 476:ct["!margins"]=Ct;break;case 147:M.Sheets[T]||(M.Sheets[T]={}),Ct.name&&(M.Sheets[T].CodeName=Ct.name),(Ct.above||Ct.left)&&(ct["!outline"]={above:Ct.above,left:Ct.left});break;case 137:M.Views||(M.Views=[{}]),M.Views[0]||(M.Views[0]={}),Ct.RTL&&(M.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:Ke=!0;break;case 36:Ke=!1;break;case 37:Ke=!0;break;case 38:Ke=!1;break;default:if(!Dr.T&&(!Ke||L.WTF))throw new Error("Unexpected record 0x"+fn.toString(16))}},L),delete L.supbooks,delete L["!row"],!ct["!ref"]&&(ut.s.r<2e6||Q&&(0<Q.e.r||0<Q.e.c||0<Q.s.r||0<Q.s.c))&&(ct["!ref"]=jr(Q||ut)),L.sheetRows&&ct["!ref"]&&(S=un(ct["!ref"]),L.sheetRows<=+S.e.r&&(S.e.r=L.sheetRows-1,S.e.r>ut.e.r&&(S.e.r=ut.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>ut.e.c&&(S.e.c=ut.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),ct["!fullref"]=ct["!ref"],ct["!ref"]=jr(S))),0<Wt.length&&(ct["!merges"]=Wt),0<Cr.length&&(ct["!cols"]=Cr),0<Gr.length&&(ct["!rows"]=Gr),ct}:$ne)(a,f,u,m,v,p,w)}function gie(a,c,u,f,m,v){return c.slice(-4)===".bin"?function(p,w,S,b,T){if(!p)return p;b=b||{"!id":{}};var P={"!type":"chart","!drawel":null,"!rel":""},M=!1;return th(p,function(k,j,L){switch(L){case 550:P["!rel"]=k;break;case 651:T.Sheets[S]||(T.Sheets[S]={}),k.name&&(T.Sheets[S].CodeName=k.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:M=!0;break;case 36:M=!1;break;case 37:break;case 38:break;default:if(!(0<j.T)){if(!(j.T<0)){if(!M||w.WTF)throw new Error("Unexpected record 0x"+L.toString(16))}}}},w),b["!id"][P["!rel"]]&&(P["!drawel"]=b["!id"][P["!rel"]]),P}(a,f,u,m,v):function(p,w,S,b){if(!p)return p;S=S||{"!id":{}};var T={"!type":"chart","!drawel":null,"!rel":""},P=p.match(z8);return P&&EA(P[0],0,b,w),(p=p.match(/drawing r:id="(.*?)"/))&&(T["!rel"]=p[1]),S["!id"][T["!rel"]]&&(T["!drawel"]=S["!id"][T["!rel"]]),T}(a,u,m,v)}function mie(a,c,u,f){return(c.slice(-4)===".bin"?function(m,v,p){var w,S={NumberFmt:[]};for(w in B)S.NumberFmt[w]=B[w];S.CellXf=[],S.Fonts=[];var b=[],T=!1;return th(m,function(P,M,k){switch(k){case 44:S.NumberFmt[P[0]]=P[1],cr(P[1],P[0]);break;case 43:S.Fonts.push(P),P.color.theme!=null&&v&&v.themeElements&&v.themeElements.clrScheme&&(P.color.rgb=BS(v.themeElements.clrScheme[P.color.theme].rgb,P.color.tint||0));break;case 1025:case 45:case 46:break;case 47:b[b.length-1]==617&&S.CellXf.push(P);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:T=!0;break;case 36:T=!1;break;case 37:b.push(k),T=!0;break;case 38:b.pop(),T=!1;break;default:if(0<M.T)b.push(k);else if(M.T<0)b.pop();else if(!T||p.WTF&&b[b.length-1]!=37)throw new Error("Unexpected record 0x"+k.toString(16))}}),S}:Kre)(a,u,f)}function pie(a,c,u){return c.slice(-4)===".bin"?(f=u,v=!(m=[]),th(a,function(p,w,S){switch(S){case 159:m.Count=p[0],m.Unique=p[1];break;case 19:m.push(p);break;case 160:return 1;case 35:v=!0;break;case 36:v=!1;break;default:if(w.T,!v||f.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}}),m):function(p,w){var S=[],b="";if(!p)return S;if(p=p.match(kre)){b=p[2].replace(Nre,"").split(Dre);for(var T=0;T!=b.length;++T){var P=hA(b[T].trim(),w);P!=null&&(S[S.length]=P)}p=kr(p[1]),S.Count=p.count,S.Unique=p.uniqueCount}return S}(a,u);var f,m,v}function vie(a,c,u){return c.slice(-4)===".bin"?(f=u,m=[],v=[],w=!(p={}),th(a,function(S,b,T){switch(T){case 632:v.push(S);break;case 635:p=S;break;case 637:p.t=S.t,p.h=S.h,p.r=S.r;break;case 636:if(p.author=v[p.iauthor],delete p.iauthor,f.sheetRows&&p.rfx&&f.sheetRows<=p.rfx.r)break;p.t||(p.t=""),delete p.rfx,m.push(p);break;case 3072:break;case 35:w=!0;break;case 36:w=!1;break;case 37:case 38:break;default:if(!b.T&&(!w||f.WTF))throw new Error("Unexpected record 0x"+T.toString(16))}}),m):function(S,b){if(S.match(/<(?:\w+:)?comments *\/>/))return[];var T=[],P=[],M=S.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return M&&M[1]&&M[1].split(/<\/\w*:?author>/).forEach(function(k){k===""||k.trim()===""||(k=k.match(/<(?:\w+:)?author[^>]*>(.*)/))&&T.push(k[1])}),(S=S.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&S[1]&&S[1].split(/<\/\w*:?comment>/).forEach(function(k){var j,L;k===""||k.trim()===""||(j=k.match(/<(?:\w+:)?comment[^>]*>/))&&(j={author:(L=kr(j[0])).authorId&&T[L.authorId]||"sheetjsghost",ref:L.ref,guid:L.guid},L=Ri(L.ref),b.sheetRows&&b.sheetRows<=L.r||(k=!!(k=k.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!k[1]&&hA(k[1])||{r:"",t:"",h:""},j.r=k.r,k.r=="<t></t>"&&(k.t=k.h=""),j.t=(k.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),b.cellHTML&&(j.h=k.h),P.push(j)))}),P}(a,u);var f,m,v,p,w}function wie(a,c){return c.slice(-4)===".bin"?(u=[],th(a,function(f,m,v){if(v===63)u.push(f);else if(!m.T)throw new Error("Unexpected record 0x"+v.toString(16))}),u):function(f){var m=[];if(!f)return m;var v=1;return(f.match(go)||[]).forEach(function(p){var w=kr(p);switch(w[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete w[0],w.i?v=w.i:w.i=v,m.push(w)}}),m}(a);var u}function yie(a,c,u,f){if(u.slice(-4)===".bin")return function(m,v){if(!m)return m;var p=v||{},w=!1;th(m,function(S,b,T){switch(T){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:w=!0;break;case 36:w=!1;break;default:if(!b.T&&(!w||p.WTF))throw new Error("Unexpected record 0x"+T.toString(16))}},p)}(a,f)}function Cie(a,c,u){return c.slice(-4)===".bin"?(f={Types:[],Cell:[],Value:[]},m=u||{},p=!(v=[]),w=2,th(a,function(S,b,T){switch(T){case 335:f.Types.push({name:S.name});break;case 51:S.forEach(function(P){w==1?f.Cell.push({type:f.Types[P[0]-1].name,index:P[1]}):w==0&&f.Value.push({type:f.Types[P[0]-1].name,index:P[1]})});break;case 337:w=S?1:0;break;case 338:w=2;break;case 35:v.push(T),p=!0;break;case 36:v.pop(),p=!1;break;default:if(!b.T&&(!p||m.WTF&&v[v.length-1]!=35))throw new Error("Unexpected record 0x"+T.toString(16))}}),f):function(S,b){var T={Types:[],Cell:[],Value:[]};if(!S)return T;var P,M=!1,k=2;return S.replace(go,function(j){var L=kr(j);switch(Uc(L[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":T.Types.push({name:L.name});break;case"</metadataType>":break;case"<futureMetadata":for(var Q=0;Q<T.Types.length;++Q)T.Types[Q].name==L.name&&(P=T.Types[Q]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":k==1?T.Cell.push({type:T.Types[L.t-1].name,index:+L.v}):k==0&&T.Value.push({type:T.Types[L.t-1].name,index:+L.v});break;case"</rc>":break;case"<cellMetadata":k=1;break;case"</cellMetadata>":k=2;break;case"<valueMetadata":k=0;break;case"</valueMetadata>":k=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":M=!0;break;case"</ext>":M=!1;break;case"<rvb":if(!P)break;P.offsets||(P.offsets=[]),P.offsets.push(+L.i);break;default:if(!M&&b.WTF)throw new Error("unrecognized "+L[0]+" in metadata")}return j}),T}(a,u);var f,m,v,p,w}var gv,lH=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cH=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Jl(a,c){var u=a.split(/\s+/),f=[];if(f[0]=u[0],u.length===1)return f;var m,v,p,w=a.match(lH);if(w)for(p=0;p!=w.length;++p)(v=(m=w[p].match(cH))[1].indexOf(":"))===-1?f[m[1]]=m[2].slice(1,m[2].length-1):f[m[1].slice(0,6)==="xmlns:"?"xmlns"+m[1].slice(6):m[1].slice(v+1)]=m[2].slice(1,m[2].length-1);return f}function Sie(a,c,u){if(a.t!=="z"){if(!u||u.cellText!==!1)try{a.t==="e"?a.w=a.w||rh[a.v]:c==="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Re(a.v):a.w=Oe(a.v):a.w=(f=c||"General",m=a.v,(f=gv[f]||Sn(f))==="General"?Oe(m):vr(f,m))}catch(p){if(u.WTF)throw p}var f,m;try{var v=gv[c]||c||"General";u.cellNF&&(a.z=v),u.cellDates&&a.t=="n"&&Si(v)&&(v=Ce(a.v))&&(a.t="d",a.v=new Date(v.y,v.m-1,v.d,v.H,v.M,v.S,v.u))}catch(p){if(u.WTF)throw p}}}function _A(a,c){var u=c||{};li();var f,m=E(kR(a)),v=(m=u.type=="binary"||u.type=="array"||u.type=="base64"?n!==void 0?n.utils.decode(65001,x(m)):qn(m):m).slice(0,1024).toLowerCase(),p=!1;if((1023&(v=v.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&v.indexOf(","),1023&v.indexOf(";"))){var w=Le(u);return w.type="string",cm.to_workbook(m,w)}if(v.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Se){0<=v.indexOf("<"+Se)&&(p=!0)}),p)return function(Se,vt){if(Se=Se.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Se||Se.length==0)throw new Error("Invalid HTML: could not find <table>");if(Se.length==1)return vf(fH(Se[0],vt),vt);var Ge=BA();return Se.forEach(function(tt,je){VA(Ge,fH(tt,vt),"Sheet"+(je+1))}),Ge}(m,u);gv={"General Number":"General","General Date":B[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":B[15],"Short Date":B[14],"Long Time":B[19],"Medium Time":B[18],"Short Time":B[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:B[2],Standard:B[4],Percent:B[10],Scientific:B[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var S,b=[],T,P={},M=[],k=u.dense?[]:{},j="",L={},Q={},G=Jl('<Data ss:Type="String">'),W=0,J=0,ne=0,se={s:{r:2e6,c:2e6},e:{r:0,c:0}},xe={},He={},Fe="",Ue=0,ct=[],ut={},Ke={},St=0,Wt=[],$t=[],Ot={},Pt=[],_t=!1,mt=[],Zt=[],or={},Cr=0,Gr=0,Kt={Sheets:[],WBProps:{date1904:!1}},Ct={};Y1.lastIndex=0,m=m.replace(/<!--([\s\S]*?)-->/gm,"");for(var Dr,fn,rn,In,Wi="";f=Y1.exec(m);)switch(f[3]=(Wi=f[3]).toLowerCase()){case"data":if(Wi=="data"){if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break}if(b[b.length-1][1])break;f[1]==="/"?function(Se,vt,Ge,tt,je,lt,Et,ur,Jt,Bt){var tr="General",fr=tt.StyleID,dr={};Bt=Bt||{};var Mt=[],Tt=0;for((fr=fr===void 0&&ur?ur.StyleID:fr)===void 0&&Et&&(fr=Et.StyleID);lt[fr]!==void 0&&(lt[fr].nf&&(tr=lt[fr].nf),lt[fr].Interior&&Mt.push(lt[fr].Interior),lt[fr].Parent);)fr=lt[fr].Parent;switch(Ge.Type){case"Boolean":tt.t="b",tt.v=hi(Se);break;case"String":tt.t="s",tt.r=f5(Sn(Se)),tt.v=-1<Se.indexOf("<")?Sn(vt||Se).replace(/<.*?>/g,""):tt.r;break;case"DateTime":Se.slice(-1)!="Z"&&(Se+="Z"),tt.v=(ue(Se)-new Date(Date.UTC(1899,11,30)))/864e5,tt.v!=tt.v?tt.v=Sn(Se):tt.v<60&&(tt.v=tt.v-1),tr&&tr!="General"||(tr="yyyy-mm-dd");case"Number":tt.v===void 0&&(tt.v=+Se),tt.t||(tt.t="n");break;case"Error":tt.t="e",tt.v=B5[Se],Bt.cellText!==!1&&(tt.w=Se);break;default:Se==""&&vt==""?tt.t="z":(tt.t="s",tt.v=f5(vt||Se))}if(Sie(tt,tr,Bt),Bt.cellFormula!==!1)if(tt.Formula)Ge=Sn(tt.Formula),Ge.charCodeAt(0)==61&&(Ge=Ge.slice(1)),tt.f=gm(Ge,je),delete tt.Formula,tt.ArrayRange=="RC"?tt.F=gm("RC:RC",je):tt.ArrayRange&&(tt.F=gm(tt.ArrayRange,je),Jt.push([un(tt.F),tt.F]));else for(Tt=0;Tt<Jt.length;++Tt)je.r>=Jt[Tt][0].s.r&&je.r<=Jt[Tt][0].e.r&&je.c>=Jt[Tt][0].s.c&&je.c<=Jt[Tt][0].e.c&&(tt.F=Jt[Tt][1]);Bt.cellStyles&&(Mt.forEach(function(mr){!dr.patternType&&mr.patternType&&(dr.patternType=mr.patternType)}),tt.s=dr),tt.StyleID!==void 0&&(tt.ixfe=tt.StyleID)}(m.slice(W,f.index),Fe,G,b[b.length-1][0]=="comment"?Ot:L,{c:J,r:ne},xe,Pt[J],Q,mt,u):(Fe="",G=Jl(f[0]),W=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(0<$t.length&&(L.c=$t),(!u.sheetRows||u.sheetRows>ne)&&L.v!==void 0&&(u.dense?(k[ne]||(k[ne]=[]),k[ne][J]=L):k[fi(J)+Vi(ne)]=L),L.HRef&&(L.l={Target:Sn(L.HRef)},L.HRefScreenTip&&(L.l.Tooltip=L.HRefScreenTip),delete L.HRef,delete L.HRefScreenTip),(L.MergeAcross||L.MergeDown)&&(Cr=J+(0|parseInt(L.MergeAcross,10)),Gr=ne+(0|parseInt(L.MergeDown,10)),ct.push({s:{c:J,r:ne},e:{c:Cr,r:Gr}})),u.sheetStubs)if(L.MergeAcross||L.MergeDown){for(var _e=J;_e<=Cr;++_e)for(var Pn=ne;Pn<=Gr;++Pn)(J<_e||ne<Pn)&&(u.dense?(k[Pn]||(k[Pn]=[]),k[Pn][_e]={t:"z"}):k[fi(_e)+Vi(Pn)]={t:"z"});J=Cr+1}else++J;else L.MergeAcross?J=Cr+1:++J;else(J=(L=function(Se){var vt={};if(Se.split(/\s+/).length===1)return vt;var Ge,tt,je,lt=Se.match(lH);if(lt)for(je=0;je!=lt.length;++je)(tt=(Ge=lt[je].match(cH))[1].indexOf(":"))===-1?vt[Ge[1]]=Ge[2].slice(1,Ge[2].length-1):vt[Ge[1].slice(0,6)==="xmlns:"?"xmlns"+Ge[1].slice(6):Ge[1].slice(tt+1)]=Ge[2].slice(1,Ge[2].length-1);return vt}(f[0])).Index?+L.Index-1:J)<se.s.c&&(se.s.c=J),J>se.e.c&&(se.e.c=J),f[0].slice(-2)==="/>"&&++J,$t=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(ne<se.s.r&&(se.s.r=ne),ne>se.e.r&&(se.e.r=ne),f[0].slice(-2)==="/>"&&(Q=Jl(f[0])).Index&&(ne=+Q.Index-1),J=0,++ne):((Q=Jl(f[0])).Index&&(ne=+Q.Index-1),or={},Q.AutoFitHeight!="0"&&!Q.Height||(or.hpx=parseInt(Q.Height,10),or.hpt=ov(or.hpx),Zt[ne]=or),Q.Hidden=="1"&&(or.hidden=!0,Zt[ne]=or));break;case"worksheet":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"));M.push(j),se.s.r<=se.e.r&&se.s.c<=se.e.c&&(k["!ref"]=jr(se),u.sheetRows&&u.sheetRows<=se.e.r&&(k["!fullref"]=k["!ref"],se.e.r=u.sheetRows-1,k["!ref"]=jr(se))),ct.length&&(k["!merges"]=ct),0<Pt.length&&(k["!cols"]=Pt),0<Zt.length&&(k["!rows"]=Zt),P[j]=k}else se={s:{r:2e6,c:2e6},e:{r:0,c:0}},ne=J=0,b.push([f[3],!1]),S=Jl(f[0]),j=Sn(S.Name),k=u.dense?[]:{},ct=[],mt=[],Zt=[],Ct={name:j,Hidden:0},Kt.Sheets.push(Ct);break;case"table":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else{if(f[0].slice(-2)=="/>")break;b.push([f[3],!1]),_t=!(Pt=[])}break;case"style":f[1]==="/"?(fn=xe,rn=He,(In=u).cellStyles&&(!rn.Interior||(In=rn.Interior).Pattern&&(In.patternType=Yre[In.Pattern]||In.Pattern)),fn[rn.ID]=rn):He=Jl(f[0]);break;case"numberformat":He.nf=Sn(Jl(f[0]).Format||"General"),gv[He.nf]&&(He.nf=gv[He.nf]);for(var Tn=0;Tn!=392&&B[Tn]!=He.nf;++Tn);if(Tn==392){for(Tn=57;Tn!=392;++Tn)if(B[Tn]==null){cr(He.nf,Tn);break}}break;case"column":if(b[b.length-1][0]!=="table")break;if((T=Jl(f[0])).Hidden&&(T.hidden=!0,delete T.Hidden),T.Width&&(T.wpx=parseInt(T.Width,10)),!_t&&10<T.wpx){_t=!0,yo=d8;for(var xs=0;xs<Pt.length;++xs)Pt[xs]&&yf(Pt[xs])}_t&&yf(T),Pt[T.Index-1||Pt.length]=T;for(var vl=0;vl<+T.Span;++vl)Pt[Pt.length]=Le(T);break;case"namedrange":if(f[1]==="/")break;Kt.Names||(Kt.Names=[]);var fe=kr(f[0]),Je={Name:fe.Name,Ref:gm(fe.RefersTo.slice(1),{r:0,c:0})};0<Kt.Sheets.length&&(Je.Sheet=Kt.Sheets.length-1),Kt.Names.push(Je);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?Fe+=m.slice(Ue,f.index):Ue=f.index+f[0].length;break;case"interior":if(!u.cellStyles)break;He.Interior=Jl(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?(rn=ut,fe=Wi,Je=m.slice(St,f.index),rn[fe=(q5=q5||jc(tA))[fe]||fe]=Je):St=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else b.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"));(Dr=Ot).t=Dr.v||"",Dr.t=Dr.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),Dr.v=Dr.w=Dr.ixfe=void 0,$t.push(Ot)}else b.push([f[3],!1]),Ot={a:(S=Jl(f[0])).Author};break;case"autofilter":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&(Dr=Jl(f[0]),k["!autofilter"]={ref:gm(Dr.Range).replace(/\$/g,"")},b.push([f[3],!0]));break;case"name":break;case"datavalidation":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break;case"null":break;default:if(b.length==0&&f[3]=="document"||b.length==0&&f[3]=="uof")return EH(m,u);var be=!0;switch(b[b.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:be=!1}break;case"componentoptions":switch(f[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:be=!1}break;case"excelworkbook":switch(f[3]){case"date1904":Kt.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:be=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":case"height":case"width":break;default:be=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(m.slice(St,f.index)){case"SheetHidden":Ct.Hidden=1;break;case"SheetVeryHidden":Ct.Hidden=2}else St=f.index+f[0].length;break;case"header":k["!margins"]||e0(k["!margins"]={},"xlml"),isNaN(+kr(f[0]).Margin)||(k["!margins"].header=+kr(f[0]).Margin);break;case"footer":k["!margins"]||e0(k["!margins"]={},"xlml"),isNaN(+kr(f[0]).Margin)||(k["!margins"].footer=+kr(f[0]).Margin);break;case"pagemargins":var ze=kr(f[0]);k["!margins"]||e0(k["!margins"]={},"xlml"),isNaN(+ze.Top)||(k["!margins"].top=+ze.Top),isNaN(+ze.Left)||(k["!margins"].left=+ze.Left),isNaN(+ze.Right)||(k["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(k["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":Kt.Views||(Kt.Views=[]),Kt.Views[0]||(Kt.Views[0]={}),Kt.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:be=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:be=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:be=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:be=!1}break;case"querytable":switch(f[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:be=!1}break;case"datavalidation":switch(f[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:be=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:be=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:be=!1}break;case"smarttags":break;default:be=!1}if(be||f[3].match(/!\[CDATA/))break;if(!b[b.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+b.join("|");if(b[b.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?function(Se,vt,Ge,tt){var je=tt;switch((Ge[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":je=hi(tt);break;case"i2":case"int":je=parseInt(tt,10);break;case"r4":case"float":je=parseFloat(tt);break;case"date":case"dateTime.tz":je=ue(tt);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+Ge[0])}Se[Sn(vt)]=je}(Ke,Wi,Wt,m.slice(St,f.index)):St=(Wt=f).index+f[0].length;break}if(u.WTF)throw"Unrecognized tag: "+f[3]+"|"+b.join("|")}return w={},u.bookSheets||u.bookProps||(w.Sheets=P),w.SheetNames=M,w.Workbook=Kt,w.SSF=Le(B),w.Props=ut,w.Custprops=Ke,w}function RA(a,c){switch(MA(c=c||{}),c.type||"base64"){case"base64":return _A(U(a),c);case"binary":case"buffer":case"file":return _A(a,c);case"array":return _A(ye(a),c)}}function bie(a,c){var u,f,m,v,p,w,S,b=[];return a.Props&&b.push((u=a.Props,f=c,m=[],ii(tA).map(function(T){for(var P=0;P<fl.length;++P)if(fl[P][1]==T)return fl[P];for(P=0;P<Xd.length;++P)if(Xd[P][1]==T)return Xd[P];throw T}).forEach(function(T){var P;u[T[1]]!=null&&(P=(f&&f.Props&&f.Props[T[1]]!=null?f.Props:u)[T[1]],typeof(P=T[2]==="date"?new Date(P).toISOString().replace(/\.\d*Z/,"Z"):P)=="number"?P=String(P):P===!0||P===!1?P=P?"1":"0":P instanceof Date&&(P=new Date(P).toISOString().replace(/\.\d*Z/,"")),m.push(Ks(tA[T[1]]||T[1],P)))}),Dt("DocumentProperties",m.join(""),{xmlns:Da.o}))),a.Custprops&&b.push((v=a.Props,p=a.Custprops,w=["Worksheets","SheetNames"],a="CustomDocumentProperties",S=[],v&&ii(v).forEach(function(T){if(Object.prototype.hasOwnProperty.call(v,T)){for(var P=0;P<fl.length;++P)if(T==fl[P][1])return;for(P=0;P<Xd.length;++P)if(T==Xd[P][1])return;for(P=0;P<w.length;++P)if(T==w[P])return;var M="string",k=typeof(k=v[T])=="number"?(M="float",String(k)):k===!0||k===!1?(M="boolean",k?"1":"0"):String(k);S.push(Dt(c5(T),k,{"dt:dt":M}))}}),p&&ii(p).forEach(function(T){var P,M;Object.prototype.hasOwnProperty.call(p,T)&&(v&&Object.prototype.hasOwnProperty.call(v,T)||(P="string",M=typeof(M=p[T])=="number"?(P="float",String(M)):M===!0||M===!1?(P="boolean",M?"1":"0"):M instanceof Date?(P="dateTime.tz",M.toISOString()):String(M),S.push(Dt(c5(T),M,{"dt:dt":P}))))}),"<"+a+' xmlns="'+Da.o+'">'+S.join("")+"</"+a+">")),b.join("")}function uH(a){return Dt("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+yA(a.Ref,{r:0,c:0})})}function xie(a,c,u,f,m,v,p){if(!a||a.v==null&&a.f==null)return"";var w={};if(a.f&&(w["ss:Formula"]="="+$n(yA(a.f,p))),a.F&&a.F.slice(0,c.length)==c&&(c=Ri(a.F.slice(c.length+1)),w["ss:ArrayRange"]="RC:R"+(c.r==p.r?"":"["+(c.r-p.r)+"]")+"C"+(c.c==p.c?"":"["+(c.c-p.c)+"]")),a.l&&a.l.Target&&(w["ss:HRef"]=$n(a.l.Target),a.l.Tooltip&&(w["x:HRefScreenTip"]=$n(a.l.Tooltip))),u["!merges"])for(var S=u["!merges"],b=0;b!=S.length;++b)S[b].s.c==p.c&&S[b].s.r==p.r&&(S[b].e.c>S[b].s.c&&(w["ss:MergeAcross"]=S[b].e.c-S[b].s.c),S[b].e.r>S[b].s.r&&(w["ss:MergeDown"]=S[b].e.r-S[b].s.r));var T="",P="";switch(a.t){case"z":if(!f.sheetStubs)return"";break;case"n":T="Number",P=String(a.v);break;case"b":T="Boolean",P=a.v?"1":"0";break;case"e":T="Error",P=rh[a.v];break;case"d":T="DateTime",P=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||B[14]);break;case"s":T="String",P=((a.v||"")+"").replace(OR,function(M){return AR[M]}).replace(u5,function(M){return"&#x"+M.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=Sf(f.cellXfs,a,f),w["ss:StyleID"]="s"+(21+u),w["ss:Index"]=p.c+1,u=a.v!=null?P:"",u=a.t=="z"?"":'<Data ss:Type="'+T+'">'+u+"</Data>",0<(a.c||[]).length&&(u+=a.c.map(function(M){var k=Dt("ss:Data",(M.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Dt("Comment",k,{"ss:Author":M.a})}).join("")),Dt("Cell",u,w)}function Eie(a,c){if(!a["!ref"])return"";var u=un(a["!ref"]),f=a["!merges"]||[],m=0,v=[];a["!cols"]&&a["!cols"].forEach(function(Q,ne){yf(Q);var W=!!Q.width,J=GS(ne,Q),ne={"ss:Index":ne+1};W&&(ne["ss:Width"]=iv(J.width)),Q.hidden&&(ne["ss:Hidden"]="1"),v.push(Dt("Column",null,ne))});for(var p,w,S=Array.isArray(a),b=u.s.r;b<=u.e.r;++b){for(var T=[(p=b,w=(a["!rows"]||[])[b],p='<Row ss:Index="'+(p+1)+'"',w&&(w.hpt&&!w.hpx&&(w.hpx=fm(w.hpt)),w.hpx&&(p+=' ss:AutoFitHeight="0" ss:Height="'+w.hpx+'"'),w.hidden&&(p+=' ss:Hidden="1"')),p+">")],P=u.s.c;P<=u.e.c;++P){for(var M,k,j,L=!1,m=0;m!=f.length;++m)if(!(f[m].s.c>P||f[m].s.r>b||f[m].e.c<P||f[m].e.r<b)){f[m].s.c==P&&f[m].s.r==b||(L=!0);break}L||(k=Nr(M={r:b,c:P}),j=S?(a[b]||[])[P]:a[k],T.push(xie(j,k,a,c,0,0,M)))}T.push("</Row>"),2<T.length&&v.push(T.join(""))}return v.join("")}function Tie(a,c,u){var f=[],v=u.SheetNames[a],m=u.Sheets[v],v=m?function(p,w,S){if(!p||!((S||{}).Workbook||{}).Names)return"";for(var b=S.Workbook.Names,T=[],P=0;P<b.length;++P){var M=b[P];M.Sheet==w&&(M.Name.match(/^_xlfn\./)||T.push(uH(M)))}return T.join("")}(m,a,u):"";return 0<v.length&&f.push("<Names>"+v+"</Names>"),0<(v=m?Eie(m,c):"").length&&f.push("<Table>"+v+"</Table>"),f.push(function(p,w,S){if(!p)return"";var b=[];if(p["!margins"]&&(b.push("<PageSetup>"),p["!margins"].header&&b.push(Dt("Header",null,{"x:Margin":p["!margins"].header})),p["!margins"].footer&&b.push(Dt("Footer",null,{"x:Margin":p["!margins"].footer})),b.push(Dt("PageMargins",null,{"x:Bottom":p["!margins"].bottom||"0.75","x:Left":p["!margins"].left||"0.7","x:Right":p["!margins"].right||"0.7","x:Top":p["!margins"].top||"0.75"})),b.push("</PageSetup>")),S&&S.Workbook&&S.Workbook.Sheets&&S.Workbook.Sheets[w])if(S.Workbook.Sheets[w].Hidden)b.push(Dt("Visible",S.Workbook.Sheets[w].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var T=0;T<w&&(!S.Workbook.Sheets[T]||S.Workbook.Sheets[T].Hidden);++T);T==w&&b.push("<Selected/>")}return((((S||{}).Workbook||{}).Views||[])[0]||{}).RTL&&b.push("<DisplayRightToLeft/>"),p["!protect"]&&(b.push(Ks("ProtectContents","True")),p["!protect"].objects&&b.push(Ks("ProtectObjects","True")),p["!protect"].scenarios&&b.push(Ks("ProtectScenarios","True")),p["!protect"].selectLockedCells==null||p["!protect"].selectLockedCells?p["!protect"].selectUnlockedCells==null||p["!protect"].selectUnlockedCells||b.push(Ks("EnableSelection","UnlockedCells")):b.push(Ks("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(P){p["!protect"][P[0]]&&b.push("<"+P[1]+"/>")})),b.length==0?"":Dt("WorksheetOptions",b.join(""),{xmlns:Da.x})}(m,a,u)),f.join("")}function _ie(a,c){c=c||{},a.SSF||(a.SSF=Le(B)),a.SSF&&(li(),Tr(a.SSF),c.revssf=Qu(a.SSF),c.revssf[a.SSF[65535]]=0,c.ssf=a.SSF,c.cellXfs=[],Sf(c.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(bie(a,c)),u.push(""),u.push(""),u.push("");for(var f,m=0;m<a.SheetNames.length;++m)u.push(Dt("Worksheet",Tie(m,c,a),{"ss:Name":$n(a.SheetNames[m])}));return u[2]=(f=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],c.cellXfs.forEach(function(v,p){var w=[];w.push(Dt("NumberFormat",null,{"ss:Format":$n(B[v.numFmtId])})),p={"ss:ID":"s"+(21+p)},f.push(Dt("Style",w.join(""),p))}),Dt("Styles",f.join(""))),u[3]=function(v){if(!((v||{}).Workbook||{}).Names)return"";for(var p=v.Workbook.Names,w=[],S=0;S<p.length;++S){var b=p[S];b.Sheet==null&&(b.Name.match(/^_xlfn\./)||w.push(uH(b)))}return Dt("Names",w.join(""))}(a),ui+Dt("Workbook",u.join(""),{xmlns:Da.ss,"xmlns:o":Da.o,"xmlns:x":Da.x,"xmlns:ss":Da.ss,"xmlns:dt":Da.dt,"xmlns:html":Da.html})}function Rie(a){var c={},u=a.content;return u.l=28,c.AnsiUserType=u.read_shift(0,"lpstr-ansi"),c.AnsiClipboardFormat=D5(u,1),u.length-u.l<=4?c:(a=u.read_shift(4),a==0||40<a?c:(u.l-=4,c.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(a=u.read_shift(4))!==1907505652?c:(c.UnicodeClipboardFormat=D5(u,2),(a=u.read_shift(4))==0||40<a?c:(u.l-=4,void(c.Reserved2=u.read_shift(0,"lpwstr"))))))}var Aie=[60,1084,2066,2165,2175];function Xc(a,c,u){if(a.t!=="z"&&a.XF){var f,m=0;try{m=a.z||a.XF.numFmtId||0,c.cellNF&&(a.z=B[m])}catch(v){if(c.WTF)throw v}if(!c||c.cellText!==!1)try{a.t==="e"?a.w=a.w||rh[a.v]:m===0||m=="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=Re(a.v):a.w=Oe(a.v):a.w=vr(m,a.v,{date1904:!!u,dateNF:c&&c.dateNF})}catch(v){if(c.WTF)throw v}c.cellDates&&m&&a.t=="n"&&Si(B[m]||String(m))&&(f=Ce(a.v))&&(a.t="d",a.v=new Date(f.y,f.m-1,f.d,f.H,f.M,f.S,f.u))}}function KS(a,c,u){return{v:a,ixfe:c,t:u}}function Oie(a,c){var u={opts:{}},f={};function m(je){return!(je<8)&&je<64&&xe[je-8]||J1[je]}function v(je,lt,Et){if(!(1<_t||Et.sheetRows&&je.r>=Et.sheetRows)){var ur,Jt,Bt;if(Et.cellStyles&&lt.XF&&lt.XF.data&&(Jt=Et,(Bt=(ur=lt).XF.data)&&Bt.patternType&&Jt&&Jt.cellStyles&&(ur.s={},ur.s.patternType=Bt.patternType,(Jt=nv(m(Bt.icvFore)))&&(ur.s.fgColor={rgb:Jt}),(Jt=nv(m(Bt.icvBack)))&&(ur.s.bgColor={rgb:Jt}))),delete lt.ixfe,delete lt.XF,W=Nr(p=je),k&&k.s&&k.e||(k={s:{r:0,c:0},e:{r:0,c:0}}),je.r<k.s.r&&(k.s.r=je.r),je.c<k.s.c&&(k.s.c=je.c),je.r+1>k.e.r&&(k.e.r=je.r+1),je.c+1>k.e.c&&(k.e.c=je.c+1),Et.cellFormula&&lt.f){for(var tr=0;tr<ne.length;++tr)if(!(ne[tr][0].s.c>je.c||ne[tr][0].s.r>je.r||ne[tr][0].e.c<je.c||ne[tr][0].e.r<je.r)){lt.F=jr(ne[tr][0]),ne[tr][0].s.c==je.c&&ne[tr][0].s.r==je.r||delete lt.f,lt.f&&(lt.f=""+Bo(ne[tr][1],0,je,$t,Ue));break}}Et.dense?(P[je.r]||(P[je.r]=[]),P[je.r][je.c]=lt):P[W]=lt}}var p,w,S,b,T,P=c.dense?[]:{},M={},k={},j=null,L=[],Q="",G={},W="",J={},ne=[],se=[],xe=[],He={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Fe={},Ue={enc:!1,sbcch:0,snames:[],sharedf:J,arrayf:ne,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!c&&!!c.cellStyles,WTF:!!c&&!!c.wtf};c.password&&(Ue.password=c.password);var ct=[],ut=[],Ke=[],St=[],Wt=!1,$t=[];$t.SheetNames=Ue.snames,$t.sharedf=Ue.sharedf,$t.arrayf=Ue.arrayf,$t.names=[],$t.XTI=[];var Ot,Pt=0,_t=0,mt=0,Zt=[],or=[];Ue.codepage=1200,y(1200);for(var Cr=!1;a.l<a.length-1;){var Gr=a.l,Kt=a.read_shift(2);if(Kt===0&&Pt===10)break;var Ct=a.l===a.length?0:a.read_shift(2),Dr=AA[Kt];if(Dr&&Dr.f){if(c.bookSheets&&Pt===133&&Kt!==133)break;if(Pt=Kt,Dr.r===2||Dr.r==12){var fn=a.read_shift(2);if(Ct-=2,!Ue.enc&&fn!==Kt&&((255&fn)<<8|fn>>8)!==Kt)throw new Error("rt mismatch: "+fn+"!="+Kt);Dr.r==12&&(a.l+=10,Ct-=10)}var rn,In,Wi,_e={},_e=Kt===10?Dr.f(a,Ct,Ue):function(je,lt,Et,ur,Jt){var Bt=ur,tr=[],fr=Et.slice(Et.l,Et.l+Bt);if(Jt.enc&&Jt.enc.insitu&&0<fr.length)switch(je){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:Jt.enc.insitu(fr)}tr.push(fr),Et.l+=Bt;for(var dr=eh(Et,Et.l),Mt=AA[dr],Tt=0;Mt!=null&&-1<Aie.indexOf(dr);)Bt=eh(Et,Et.l+2),Tt=Et.l+4,dr==2066?Tt+=4:dr!=2165&&dr!=2175||(Tt+=12),fr=Et.slice(Tt,Et.l+4+Bt),tr.push(fr),Et.l+=4+Bt,Mt=AA[dr=eh(Et,Et.l)];var mr=ke(tr);Xs(mr,0);var Xt=0;mr.lens=[];for(var It=0;It<tr.length;++It)mr.lens.push(Xt),Xt+=tr[It].length;if(mr.length<ur)throw"XLS Record 0x"+je.toString(16)+" Truncated: "+mr.length+" < "+ur;return lt.f(mr,mr.length,Jt)}(Kt,Dr,a,Ct,Ue);if(_t!=0||[9,521,1033,2057].indexOf(Pt)!==-1)switch(Kt){case 34:u.opts.Date1904=He.WBProps.date1904=_e;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(Ue.enc||(a.l=0),Ue.enc=_e,!c.password)throw new Error("File is password-protected");if(_e.valid==null)throw new Error("Encryption scheme unsupported");if(!_e.valid)throw new Error("Password is incorrect");break;case 92:Ue.lastuser=_e;break;case 66:var Pn=Number(_e);switch(Pn){case 21010:Pn=1200;break;case 32768:Pn=1e4;break;case 32769:Pn=1252}y(Ue.codepage=Pn),Cr=!0;break;case 317:Ue.rrtabid=_e;break;case 25:Ue.winlocked=_e;break;case 439:u.opts.RefreshAll=_e;break;case 12:u.opts.CalcCount=_e;break;case 16:u.opts.CalcDelta=_e;break;case 17:u.opts.CalcIter=_e;break;case 13:u.opts.CalcMode=_e;break;case 14:u.opts.CalcPrecision=_e;break;case 95:u.opts.CalcSaveRecalc=_e;break;case 15:Ue.CalcRefMode=_e;break;case 2211:u.opts.FullCalc=_e;break;case 129:_e.fDialog&&(P["!type"]="dialog"),_e.fBelow||((P["!outline"]||(P["!outline"]={})).above=!0),_e.fRight||((P["!outline"]||(P["!outline"]={})).left=!0);break;case 224:se.push(_e);break;case 430:$t.push([_e]),$t[$t.length-1].XTI=[];break;case 35:case 547:$t[$t.length-1].push(_e);break;case 24:case 536:Ot={Name:_e.Name,Ref:Bo(_e.rgce,0,null,$t,Ue)},0<_e.itab&&(Ot.Sheet=_e.itab-1),$t.names.push(Ot),$t[0]||($t[0]=[],$t[0].XTI=[]),$t[$t.length-1].push(_e),_e.Name=="_xlnm._FilterDatabase"&&0<_e.itab&&_e.rgce&&_e.rgce[0]&&_e.rgce[0][0]&&_e.rgce[0][0][0]=="PtgArea3d"&&(or[_e.itab-1]={ref:jr(_e.rgce[0][0][1][2])});break;case 22:Ue.ExternCount=_e;break;case 23:$t.length==0&&($t[0]=[],$t[0].XTI=[]),$t[$t.length-1].XTI=$t[$t.length-1].XTI.concat(_e),$t.XTI=$t.XTI.concat(_e);break;case 2196:if(Ue.biff<8)break;Ot!=null&&(Ot.Comment=_e[1]);break;case 18:P["!protect"]=_e;break;case 19:_e!==0&&Ue.WTF&&console.error("Password verifier: "+_e);break;case 133:M[_e.pos]=_e,Ue.snames.push(_e.name);break;case 10:if(--_t)break;k.e&&(0<k.e.r&&0<k.e.c&&(k.e.r--,k.e.c--,P["!ref"]=jr(k),c.sheetRows&&c.sheetRows<=k.e.r&&(Tn=k.e.r,k.e.r=c.sheetRows-1,P["!fullref"]=P["!ref"],P["!ref"]=jr(k),k.e.r=Tn),k.e.r++,k.e.c++),0<ct.length&&(P["!merges"]=ct),0<ut.length&&(P["!objects"]=ut),0<Ke.length&&(P["!cols"]=Ke),0<St.length&&(P["!rows"]=St),He.Sheets.push(Fe)),Q===""?G=P:f[Q]=P,P=c.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(Ue.biff===8&&(Ue.biff={9:2,521:3,1033:4}[Kt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[_e.BIFFVer]||8),Ue.biffguess=_e.BIFFVer==0,_e.BIFFVer==0&&_e.dt==4096&&(Ue.biff=5,Cr=!0,y(Ue.codepage=28591)),Ue.biff==8&&_e.BIFFVer==0&&_e.dt==16&&(Ue.biff=2),_t++)break;var Tn,P=c.dense?[]:{};Ue.biff<8&&!Cr&&(Cr=!0,y(Ue.codepage=c.codepage||1252)),Ue.biff<5||_e.BIFFVer==0&&_e.dt==4096?(Q===""&&(Q="Sheet1"),k={s:{r:0,c:0},e:{r:0,c:0}},Tn={pos:a.l-Ct,name:Q},M[Tn.pos]=Tn,Ue.snames.push(Q)):Q=(M[Gr]||{name:""}).name,_e.dt==32&&(P["!type"]="chart"),_e.dt==64&&(P["!type"]="macro"),ct=[],ut=[],Ue.arrayf=ne=[],Ke=[],Wt=!(St=[]),Fe={Hidden:(M[Gr]||{hs:0}).hs,name:Q};break;case 515:case 3:case 2:P["!type"]=="chart"&&(c.dense?(P[_e.r]||[])[_e.c]:P[Nr({c:_e.c,r:_e.r})])&&++_e.c,fe={ixfe:_e.ixfe,XF:se[_e.ixfe]||{},v:_e.val,t:"n"},0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c);break;case 5:case 517:fe={ixfe:_e.ixfe,XF:se[_e.ixfe],v:_e.val,t:_e.t},0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c);break;case 638:fe={ixfe:_e.ixfe,XF:se[_e.ixfe],v:_e.rknum,t:"n"},0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c);break;case 189:for(var xs=_e.c;xs<=_e.C;++xs){var vl=_e.rkrec[xs-_e.c][0],fe={ixfe:vl,XF:se[vl],v:_e.rkrec[xs-_e.c][1],t:"n"};0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:xs,r:_e.r},fe,c)}break;case 6:case 518:case 1030:if(_e.val=="String"){j=_e;break}(fe=KS(_e.val,_e.cell.ixfe,_e.tt)).XF=se[fe.ixfe],c.cellFormula&&(!((Je=_e.formula)&&Je[0]&&Je[0][0]&&Je[0][0][0]=="PtgExp")||J[Wi=Nr({r:rn=Je[0][0][1][0],c:In=Je[0][0][1][1]})]?fe.f=""+Bo(_e.formula,0,_e.cell,$t,Ue):fe.F=((c.dense?(P[rn]||[])[In]:P[Wi])||{}).F),0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v(_e.cell,fe,c),j=_e;break;case 7:case 519:if(!j)throw new Error("String record expects Formula");(fe=KS(j.val=_e,j.cell.ixfe,"s")).XF=se[fe.ixfe],c.cellFormula&&(fe.f=""+Bo(j.formula,0,j.cell,$t,Ue)),0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v(j.cell,fe,c),j=null;break;case 33:case 545:ne.push(_e);var Je=Nr(_e[0].s),be=c.dense?(P[_e[0].s.r]||[])[_e[0].s.c]:P[Je];if(c.cellFormula&&be){if(!j||!Je||!be)break;be.f=""+Bo(_e[1],0,_e[0],$t,Ue),be.F=jr(_e[0])}break;case 1212:if(!c.cellFormula)break;if(W){if(!j)break;J[Nr(j.cell)]=_e[0],((be=c.dense?(P[j.cell.r]||[])[j.cell.c]:P[Nr(j.cell)])||{}).f=""+Bo(_e[0],0,p,$t,Ue)}break;case 253:fe=KS(L[_e.isst].t,_e.ixfe,"s"),L[_e.isst].h&&(fe.h=L[_e.isst].h),fe.XF=se[fe.ixfe],0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c);break;case 513:c.sheetStubs&&(fe={ixfe:_e.ixfe,XF:se[_e.ixfe],t:"z"},0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c));break;case 190:if(c.sheetStubs)for(var ze=_e.c;ze<=_e.C;++ze){var Se=_e.ixfe[ze-_e.c];fe={ixfe:Se,XF:se[Se],t:"z"},0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:ze,r:_e.r},fe,c)}break;case 214:case 516:case 4:(fe=KS(_e.val,_e.ixfe,"s")).XF=se[fe.ixfe],0<mt&&(fe.z=Zt[fe.ixfe>>8&63]),Xc(fe,c,u.opts.Date1904),v({c:_e.c,r:_e.r},fe,c);break;case 0:case 512:_t===1&&(k=_e);break;case 252:L=_e;break;case 1054:if(Ue.biff==4){Zt[mt++]=_e[1];for(var vt=0;vt<mt+163&&B[vt]!=_e[1];++vt);163<=vt&&cr(_e[1],mt+163)}else cr(_e[1],_e[0]);break;case 30:Zt[mt++]=_e;for(var Ge=0;Ge<mt+163&&B[Ge]!=_e;++Ge);163<=Ge&&cr(_e,mt+163);break;case 229:ct=ct.concat(_e);break;case 93:ut[_e.cmo[0]]=Ue.lastobj=_e;break;case 438:Ue.lastobj.TxO=_e;break;case 127:Ue.lastobj.ImData=_e;break;case 440:for(S=_e[0].s.r;S<=_e[0].e.r;++S)for(w=_e[0].s.c;w<=_e[0].e.c;++w)(be=c.dense?(P[S]||[])[w]:P[Nr({c:w,r:S})])&&(be.l=_e[1]);break;case 2048:for(S=_e[0].s.r;S<=_e[0].e.r;++S)for(w=_e[0].s.c;w<=_e[0].e.c;++w)(be=c.dense?(P[S]||[])[w]:P[Nr({c:w,r:S})])&&be.l&&(be.l.Tooltip=_e[1]);break;case 28:if(Ue.biff<=5&&2<=Ue.biff)break;be=c.dense?(P[_e[0].r]||[])[_e[0].c]:P[Nr(_e[0])];var tt=ut[_e[2]];be||(be=c.dense?(P[_e[0].r]||(P[_e[0].r]=[]),P[_e[0].r][_e[0].c]={t:"z"}):P[Nr(_e[0])]={t:"z"},k.e.r=Math.max(k.e.r,_e[0].r),k.s.r=Math.min(k.s.r,_e[0].r),k.e.c=Math.max(k.e.c,_e[0].c),k.s.c=Math.min(k.s.c,_e[0].c)),be.c||(be.c=[]),tt={a:_e[1],t:tt.TxO.t},be.c.push(tt);break;case 2173:se[_e.ixfe],_e.ext.forEach(function(lt){lt[0]});break;case 125:if(!Ue.cellStyles)break;for(;_e.e>=_e.s;)Ke[_e.e--]={width:_e.w/256,level:_e.level||0,hidden:!!(1&_e.flags)},Wt||(Wt=!0,mA(_e.w/256)),yf(Ke[_e.e+1]);break;case 520:tt={},_e.level!=null&&((St[_e.r]=tt).level=_e.level),_e.hidden&&((St[_e.r]=tt).hidden=!0),_e.hpt&&((St[_e.r]=tt).hpt=_e.hpt,tt.hpx=fm(_e.hpt));break;case 38:case 39:case 40:case 41:P["!margins"]||e0(P["!margins"]={}),P["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Kt]]=_e;break;case 161:P["!margins"]||e0(P["!margins"]={}),P["!margins"].header=_e.header,P["!margins"].footer=_e.footer;break;case 574:_e.RTL&&(He.Views[0].RTL=!0);break;case 146:xe=_e;break;case 2198:T=_e;break;case 140:b=_e;break;case 442:Q?Fe.CodeName=_e||Fe.name:He.WBProps.CodeName=_e||"ThisWorkbook"}}else Dr||console.error("Missing Info for XLS Record 0x"+Kt.toString(16)),a.l+=Ct}return u.SheetNames=ii(M).sort(function(je,lt){return Number(je)-Number(lt)}).map(function(je){return M[je].name}),c.bookSheets||(u.Sheets=f),!u.SheetNames.length&&G["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=G)):u.Preamble=G,u.Sheets&&or.forEach(function(je,lt){u.Sheets[u.SheetNames[lt]]["!autofilter"]=je}),u.Strings=L,u.SSF=Le(B),Ue.enc&&(u.Encryption=Ue.enc),T&&(u.Themes=T),u.Metadata={},b!==void 0&&(u.Metadata.Country=b),0<$t.names.length&&(He.Names=$t.names),u.Workbook=He,u}var mv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function XS(a,c){var u,f,m,v,p;if(MA(c=c||{}),C(),c.codepage&&g(c.codepage),a.FullPaths){if(wr.find(a,"/encryption"))throw new Error("File is password-protected");u=wr.find(a,"!CompObj"),m=wr.find(a,"/Workbook")||wr.find(a,"/Book")}else{switch(c.type){case"base64":a=me(U(a));break;case"binary":a=me(a);break;case"buffer":break;case"array":Array.isArray(a)||(a=Array.prototype.slice.call(a))}Xs(a,0),m={content:a}}if(u&&Rie(u),c.bookProps&&!c.bookSheets)f={};else{var w=X?"buffer":"array";if(m&&m.content)f=Oie(m.content,c);else if((m=wr.find(a,"PerfectOffice_MAIN"))&&m.content)f=Zd.to_workbook(m.content,(c.type=w,c));else{if(!(m=wr.find(a,"NativeContent_MAIN"))||!m.content)throw(m=wr.find(a,"MN0"))&&m.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");f=Zd.to_workbook(m.content,(c.type=w,c))}c.bookVBA&&a.FullPaths&&wr.find(a,"/_VBA_PROJECT_CUR/VBA/dir")&&(f.vbaraw=(v=a,p=wr.utils.cfb_new({root:"R"}),v.FullPaths.forEach(function(S,b){S.slice(-1)!=="/"&&S.match(/_VBA_PROJECT_CUR/)&&(S=S.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),wr.utils.cfb_add(p,S,v.FileIndex[b].content))}),wr.write(p)))}return w={},a.FullPaths&&function(S,b,T){var P=wr.find(S,"/!DocumentSummaryInformation");if(P&&0<P.size)try{var M,k=aL(P,qR,mv.DSI);for(M in k)b[M]=k[M]}catch(G){if(T.WTF)throw G}var j=wr.find(S,"/!SummaryInformation");if(j&&0<j.size)try{var L,Q=aL(j,JR,mv.SI);for(L in Q)b[L]==null&&(b[L]=Q[L])}catch(G){if(T.WTF)throw G}b.HeadingPairs&&b.TitlesOfParts&&(Y5(b.HeadingPairs,b.TitlesOfParts,b,T),delete b.HeadingPairs,delete b.TitlesOfParts)}(a,w,c),f.Props=f.Custprops=w,c.bookFiles&&(f.cfb=a),f}function Iie(a,v){var u,f,m=v||{},v=wr.utils.cfb_new({root:"R"}),p="/Workbook";switch(m.bookType||"xls"){case"xls":m.bookType="biff8";case"xla":m.bookType||(m.bookType="xla");case"biff8":p="/Workbook",m.biff=8;break;case"biff5":p="/Book",m.biff=5;break;default:throw new Error("invalid type "+m.bookType+" for XLS CFB")}return wr.utils.cfb_add(v,p,hH(a,m)),m.biff==8&&(a.Props||a.Custprops)&&function(w,S){var b,T=[],P=[],M=[],k=0,j=Vd(qR,"n"),L=Vd(JR,"n");if(w.Props)for(b=ii(w.Props),k=0;k<b.length;++k)(Object.prototype.hasOwnProperty.call(j,b[k])?T:Object.prototype.hasOwnProperty.call(L,b[k])?P:M).push([b[k],w.Props[b[k]]]);if(w.Custprops)for(b=ii(w.Custprops),k=0;k<b.length;++k)Object.prototype.hasOwnProperty.call(w.Props||{},b[k])||(Object.prototype.hasOwnProperty.call(j,b[k])?T:Object.prototype.hasOwnProperty.call(L,b[k])?P:M).push([b[k],w.Custprops[b[k]]]);for(var Q=[],k=0;k<M.length;++k)-1<sL.indexOf(M[k][0])||-1<G5.indexOf(M[k][0])||M[k][1]!=null&&Q.push(M[k]);P.length&&wr.utils.cfb_add(S,"/SummaryInformation",lL(P,mv.SI,L,JR)),(T.length||Q.length)&&wr.utils.cfb_add(S,"/DocumentSummaryInformation",lL(T,mv.DSI,j,qR,Q.length?Q:null,mv.UDI))}(a,v),m.biff==8&&a.vbaraw&&(u=v,(f=wr.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(w,S){S==0||(w=w.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&wr.utils.cfb_add(u,w,f.FileIndex[S].content)})),v}var pv={0:{f:function(a,c){var u={},f=a.l+c;u.r=a.read_shift(4),a.l+=4;var m=a.read_shift(2);return a.l+=1,c=a.read_shift(1),a.l=f,7&c&&(u.level=7&c),16&c&&(u.hidden=!0),32&c&&(u.hpt=m/20),u}},1:{f:function(a){return[hl(a)]}},2:{f:function(a){return[hl(a),KR(a),"n"]}},3:{f:function(a){return[hl(a),a.read_shift(1),"e"]}},4:{f:function(a){return[hl(a),a.read_shift(1),"b"]}},5:{f:function(a){return[hl(a),vo(a),"n"]}},6:{f:function(a){return[hl(a),po(a),"str"]}},7:{f:function(a){return[hl(a),a.read_shift(4),"s"]}},8:{f:function(a,c,u){var f=a.l+c,m=hl(a);m.r=u["!row"];var v=[m,po(a),"str"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=Bo(c,0,m,u.supbooks,u)):a.l=f,v}},9:{f:function(a,c,u){var f=a.l+c,m=hl(a);m.r=u["!row"];var v=[m,vo(a),"n"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=Bo(c,0,m,u.supbooks,u)):a.l=f,v}},10:{f:function(a,c,u){var f=a.l+c,m=hl(a);m.r=u["!row"];var v=[m,a.read_shift(1),"b"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=Bo(c,0,m,u.supbooks,u)):a.l=f,v}},11:{f:function(a,c,u){var f=a.l+c,m=hl(a);m.r=u["!row"];var v=[m,a.read_shift(1),"e"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=Bo(c,0,m,u.supbooks,u)):a.l=f,v}},12:{f:function(a){return[Gd(a)]}},13:{f:function(a){return[Gd(a),KR(a),"n"]}},14:{f:function(a){return[Gd(a),a.read_shift(1),"e"]}},15:{f:function(a){return[Gd(a),a.read_shift(1),"b"]}},16:{f:eH},17:{f:function(a){return[Gd(a),po(a),"str"]}},18:{f:function(a){return[Gd(a),a.read_shift(4),"s"]}},19:{f:UR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(a,p,w){var f=a.l+p;a.l+=4,a.l+=1;var m=a.read_shift(4),v=lre(a),p=_ne(a,0,w),w=zR(a);return a.l=f,p={Name:v,Ptg:p},m<268435455&&(p.Sheet=m),w&&(p.Comment=w),p}},40:{},42:{},43:{f:function(a,c,u){var f={};f.sz=a.read_shift(2)/20;var m,v=(v=(m=a).read_shift(1),m.l++,{fBold:1&v,fItalic:2&v,fUnderline:4&v,fStrikeout:8&v,fOutline:16&v,fShadow:32&v,fCondense:64&v,fExtend:128&v});switch(v.fItalic&&(f.italic=1),v.fCondense&&(f.condense=1),v.fExtend&&(f.extend=1),v.fShadow&&(f.shadow=1),v.fOutline&&(f.outline=1),v.fStrikeout&&(f.strike=1),a.read_shift(2)===700&&(f.bold=1),a.read_shift(2)){case 1:f.vertAlign="superscript";break;case 2:f.vertAlign="subscript"}switch((v=a.read_shift(1))!=0&&(f.underline=v),0<(v=a.read_shift(1))&&(f.family=v),0<(v=a.read_shift(1))&&(f.charset=v),a.l++,f.color=function(p){var w={},S=p.read_shift(1)>>>1,b=p.read_shift(1),T=p.read_shift(2,"i"),P=p.read_shift(1),M=p.read_shift(1),k=p.read_shift(1);switch(p.l++,S){case 0:w.auto=1;break;case 1:w.index=b;var j=J1[b];j&&(w.rgb=nv(j));break;case 2:w.rgb=nv([P,M,k]);break;case 3:w.theme=b}return T!=0&&(w.tint=0<T?T/32767:T/32768),w}(a),a.read_shift(1)){case 1:f.scheme="major";break;case 2:f.scheme="minor"}return f.name=po(a),f}},44:{f:function(a,c){return[a.read_shift(2),po(a)]}},45:{f:Jre},46:{f:Ys},47:{f:function(a,m){var u=a.l+m,f=a.read_shift(2),m=a.read_shift(2);return a.l=u,{ixfe:f,numFmtId:m}}},48:{},49:{f:function(a){return a.read_shift(4,"i")}},50:{},51:{f:function(a){for(var c=[],u=a.read_shift(4);0<u--;)c.push([a.read_shift(4),a.read_shift(4)]);return c}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:AL},62:{f:function(a){return[hl(a),UR(a),"is"]}},63:{f:function(a){var c={};c.i=a.read_shift(4);var u={};return u.r=a.read_shift(4),u.c=a.read_shift(4),c.r=Nr(u),2&(a=a.read_shift(1))&&(c.l="1"),8&a&&(c.a="1"),c}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(a){var c=a.read_shift(2);return a.l+=28,{RTL:32&c}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(a,c){var u={},f=a[a.l];return++a.l,u.above=!(64&f),u.left=!(128&f),a.l+=18,u.name=are(a),u}},148:{f:YS,p:16},151:{f:function(){}},152:{},153:{f:function(a,c){var u={},f=a.read_shift(4);return u.defaultThemeVersion=a.read_shift(4),0<(a=8<c?po(a):"").length&&(u.CodeName=a),u.autoCompressPictures=!!(65536&f),u.backupFile=!!(64&f),u.checkCompatibility=!!(4096&f),u.date1904=!!(1&f),u.filterPrivacy=!!(8&f),u.hidePivotFieldList=!!(1024&f),u.promptedSolutions=!!(16&f),u.publishItems=!!(2048&f),u.refreshAllConnections=!!(262144&f),u.saveExternalLinkValues=!!(128&f),u.showBorderUnselectedTables=!!(4&f),u.showInkAnnotation=!!(32&f),u.showObjects=["all","placeholders","none"][f>>13&3],u.showPivotChartFilter=!!(32768&f),u.updateLinks=["userSet","never","always"][f>>8&3],u}},154:{},155:{},156:{f:function(a,c){var u={};return u.Hidden=a.read_shift(4),u.iTabID=a.read_shift(4),u.strRelID=GR(a),u.name=po(a),u}},157:{},158:{},159:{T:1,f:function(a){return[a.read_shift(4),a.read_shift(4)]}},160:{T:-1},161:{T:1,f:Kd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pm},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(a,c){return{flags:a.read_shift(4),version:a.read_shift(4),name:po(a)}}},336:{T:-1},337:{f:function(a){return a.l+=4,a.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:GR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_L},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(a,v,u){var f=a.l+v,m=N5(a),v=a.read_shift(1);return(m=[m])[2]=v,u.cellFormula?(u=Tne(a,f-a.l,u),m[1]=u):a.l=f,m}},427:{f:function(a,m,u){var f=a.l+m,m=[Kd(a)];return u.cellFormula&&(u=Rne(a,f-a.l,u),m[1]=u),a.l=f,m}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(a){var c={};return tH.forEach(function(u){c[u]=vo(a)}),c}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(a,w){var u=a.l+w,f=Kd(a),m=zR(a),v=po(a),p=po(a),w=po(a);return a.l=u,w={rfx:f,relId:m,loc:v,display:w},p&&(w.Tooltip=p),w}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:GR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ge},633:{T:1},634:{T:-1},635:{T:1,f:function(a){var c={};c.iauthor=a.read_shift(4);var u=Kd(a);return c.rfx=u.s,c.ref=Nr(u.s),a.l+=16,c}},636:{T:-1},637:{f:sre},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(a,c){return a.l+=10,{name:po(a)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},AA={6:{f:SA},10:{f:wf},12:{f:as},13:{f:as},14:{f:es},15:{f:es},16:{f:vo},17:{f:es},18:{f:es},19:{f:as},20:{f:xL},21:{f:xL},23:{f:_L},24:{f:TL},25:{f:es},26:{},27:{},28:{f:function(a,c,u){return function(f,m){if(!(m.biff<8)){var v=f.read_shift(2),p=f.read_shift(2),w=f.read_shift(2),S=f.read_shift(2),b=Jd(f,0,m);return m.biff<8&&f.read_shift(1),[{r:v,c:p},b,S,w]}}(a,u)}},29:{},34:{f:es},35:{f:EL},38:{f:vo},39:{f:vo},40:{f:vo},41:{f:vo},42:{f:es},43:{f:es},47:{f:function(a,c,u){var f={Type:8<=u.biff?a.read_shift(2):0};return f.Type?Ure(a,c-2,f):(c=a,u.biff,a=u,u=f,c={key:as(c),verificationBytes:as(c)},a.password&&(c.verifier=fA(a.password)),u.valid=c.verificationBytes===c.verifier,u.valid&&(u.insitu=jre(a.password))),f}},49:{f:function(a,c,u){var f={dyHeight:a.read_shift(2),fl:a.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:a.l+=2;break;default:a.l+=10}return f.name=ev(a,0,u),f}},51:{f:as},60:{},61:{f:function(a){return{Pos:[a.read_shift(2),a.read_shift(2)],Dim:[a.read_shift(2),a.read_shift(2)],Flags:a.read_shift(2),CurTab:a.read_shift(2),FirstTab:a.read_shift(2),Selected:a.read_shift(2),TabRatio:a.read_shift(2)}}},64:{f:es},65:{f:function(){}},66:{f:as},77:{},80:{},81:{},82:{},85:{f:as},89:{},90:{},91:{},92:{f:function(a,c,m){if(m.enc)return a.l+=c,"";var f=a.l,m=Jd(a,0,m);return a.read_shift(c+f-a.l),m}},93:{f:function(a,c,u){return u&&u.biff<8?function(f,m,v){f.l+=4;var p=f.read_shift(2),w=f.read_shift(2),S=f.read_shift(2);f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=6,m-=36;var b=[];return b.push((Cre[p]||mo)(f,m,v)),{cmo:[w,p,S],ft:b}}(a,c,u):{cmo:u=wL(a),ft:function(f,m){for(var v=f.l+m,p=[];f.l<v;){var w=f.read_shift(2);f.l-=2;try{p.push(vre[w](f,v-f.l))}catch{return f.l=v,p}}return f.l!=v&&(f.l=v),p}(a,c-22,u[1])}}},94:{},95:{f:es},96:{},97:{},99:{f:es},125:{f:AL},128:{f:function(a){if(a.l+=4,(a=[a.read_shift(2),a.read_shift(2)])[0]!==0&&a[0]--,a[1]!==0&&a[1]--,7<a[0]||7<a[1])throw new Error("Bad Gutters: "+a.join("|"));return a}},129:{f:function(a,c,u){return{fDialog:16&(c=u&&u.biff==8||c==2?a.read_shift(2):(a.l+=c,0)),fBelow:64&c,fRight:128&c}}},130:{f:as},131:{f:es},132:{f:es},133:{f:function(a,c,u){var f=a.read_shift(4),m=3&a.read_shift(1),v=a.read_shift(1);switch(v){case 0:v="Worksheet";break;case 1:v="Macrosheet";break;case 2:v="Chartsheet";break;case 6:v="VBAModule"}return u=ev(a,0,u),{pos:f,hs:m,dt:v,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(a){var c=[0,0],u=a.read_shift(2);return c[0]=$5[u]||u,u=a.read_shift(2),c[1]=$5[u]||u,c}},141:{f:as},144:{},146:{f:function(a){for(var c=a.read_shift(2),u=[];0<c--;)u.push(gL(a));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:as},157:{},158:{},160:{f:xre},161:{f:function(a,c){var u={};return c<32||(a.l+=16,u.header=vo(a),u.footer=vo(a),a.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(a,c){for(var u=a.l+c-2,f=a.read_shift(2),m=a.read_shift(2),v=[];a.l<u;)v.push(mL(a));if(a.l!==u)throw new Error("MulRK read error");if(c=a.read_shift(2),v.length!=c-m+1)throw new Error("MulRK length mismatch");return{r:f,c:m,C:c,rkrec:v}}},190:{f:function(a,c){for(var u=a.l+c-2,f=a.read_shift(2),m=a.read_shift(2),v=[];a.l<u;)v.push(a.read_shift(2));if(a.l!==u)throw new Error("MulBlank read error");if(c=a.read_shift(2),v.length!=c-m+1)throw new Error("MulBlank length mismatch");return{r:f,c:m,C:c,ixfe:v}}},193:{f:wf},197:{},198:{},199:{},200:{},201:{},202:{f:es},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:as},220:{},221:{f:es},222:{},224:{f:function(a,c,u){var f,m,v,p={};return p.ifnt=a.read_shift(2),p.numFmtId=a.read_shift(2),p.flags=a.read_shift(2),p.fStyle=p.flags>>2&1,c-=6,p.data=(f=a,p.fStyle,m=u,v={},c=f.read_shift(4),a=f.read_shift(4),u=f.read_shift(4),f=f.read_shift(2),v.patternType=ure[u>>26],m.cellStyles&&(v.alc=7&c,v.fWrap=c>>3&1,v.alcV=c>>4&7,v.fJustLast=c>>7&1,v.trot=c>>8&255,v.cIndent=c>>16&15,v.fShrinkToFit=c>>20&1,v.iReadOrder=c>>22&2,v.fAtrNum=c>>26&1,v.fAtrFnt=c>>27&1,v.fAtrAlc=c>>28&1,v.fAtrBdr=c>>29&1,v.fAtrPat=c>>30&1,v.fAtrProt=c>>31&1,v.dgLeft=15&a,v.dgRight=a>>4&15,v.dgTop=a>>8&15,v.dgBottom=a>>12&15,v.icvLeft=a>>16&127,v.icvRight=a>>23&127,v.grbitDiag=a>>30&3,v.icvTop=127&u,v.icvBottom=u>>7&127,v.icvDiag=u>>14&127,v.dgDiag=u>>21&15,v.icvFore=127&f,v.icvBack=f>>7&127,v.fsxButton=f>>14&1),v),p}},225:{f:function(a,c){return c===0||a.read_shift(2),1200}},226:{f:wf},227:{},229:{f:function(a,c){for(var u=[],f=a.read_shift(2);f--;)u.push(OS(a));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(a,c){for(var u=a.l+c,c=a.read_shift(4),f=a.read_shift(4),m=[],v=0;v!=f&&a.l<u;++v)m.push(function(w){var S=o;o=1200;var b,T=w.read_shift(2),P=4&(L=w.read_shift(1)),M=8&L,k=1+(1&L),j=0,L={};return M&&(j=w.read_shift(2)),P&&(b=w.read_shift(4)),k=k==2?"dbcs-cont":"sbcs-cont",k=T===0?"":w.read_shift(T,k),M&&(w.l+=4*j),P&&(w.l+=b),L.t=k,M||(L.raw="<t>"+L.t+"</t>",L.r=L.t),o=S,L}(a));return m.Count=c,m.Unique=f,m}},253:{f:function(a){var c=Yc(a);return c.isst=a.read_shift(4),c}},255:{f:function(a,c){var u={};return u.dsst=a.read_shift(2),a.l+=c-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cL},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:es},353:{f:wf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(a,v,u){var f=a.l+v,m=a.read_shift(2),v=a.read_shift(2);if((u.sbcch=v)==1025||v==14849)return[v,m];if(v<1||255<v)throw new Error("Unexpected SupBook type: "+v);for(var u=qd(a,v),p=[];f>a.l;)p.push(tv(a));return[v,m,u,p]}},431:{f:es},432:{},433:{},434:{},437:{},438:{f:function(a,c,u){var f=a.l,m="";try{a.l+=4;var v=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(v)==-1?a.l+=6:function(b){var T=b.read_shift(1);b.l++;var P=b.read_shift(2);b.l+=2}(a);var p=a.read_shift(2);a.read_shift(2),as(a),v=a.read_shift(2),a.l+=v;for(var w=1;w<a.lens.length-1;++w){if(a.l-f!=a.lens[w])throw new Error("TxO: bad continue record");var S=a[a.l];if((m+=qd(a,a.lens[w+1]-a.lens[w]-1)).length>=(S?p:2*p))break}if(m.length!==p&&m.length!==2*p)throw new Error("cchText: "+p+" != "+m.length);return a.l=f+c,{t:m}}catch{return a.l=f+c,{t:m}}}},439:{f:es},440:{f:function(a,c){var u=OS(a);return a.l+=16,[u,function(f,m){var v=f.l+m;if((P=f.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+P);m=f.read_shift(2),f.l+=2;var p,w,S,b,T,P="";16&m&&(p=AS(f,f.l)),128&m&&(w=AS(f,f.l)),(257&m)==257&&(S=AS(f,f.l)),(257&m)==1&&(M=mre(f,f.l)),8&m&&(P=AS(f,f.l)),32&m&&(b=f.read_shift(16)),64&m&&(T=rA(f)),f.l=v;var M=w||S||M||"";return M&&P&&(M+="#"+P),M=M||"#"+P,M={Target:M=2&m&&M.charAt(0)=="/"&&M.charAt(1)!="/"?"file://"+M:M},b&&(M.guid=b),T&&(M.time=T),p&&(M.Tooltip=p),M}(a,c-24)]}},441:{},442:{f:tv},443:{},444:{f:as},445:{},446:{},448:{f:wf},449:{f:function(a){return a.read_shift(2),a.read_shift(4)},r:2},450:{f:wf},512:{f:CL},513:{f:bre},515:{f:function(a,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=Yc(a),a=vo(a),u.val=a,u}},516:{f:function(a,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),a.l,c=Yc(a),u.biff==2&&a.l++,u=tv(a,a.l,u),c.val=u,c}},517:{f:bL},519:{f:WA},520:{f:function(a){var c={};c.r=a.read_shift(2),c.c=a.read_shift(2),c.cnt=a.read_shift(2)-c.c;var u=a.read_shift(2);a.l+=4;var f=a.read_shift(1);return a.l+=3,7&f&&(c.level=7&f),32&f&&(c.hidden=!0),64&f&&(c.hpt=u/20),c}},523:{},545:{f:RL},549:{f:yL},566:{},574:{f:function(a,c,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&a.read_shift(2)}}},638:{f:function(f){var c=f.read_shift(2),u=f.read_shift(2),f=mL(f);return{r:c,c:u,ixfe:f[0],rknum:f[1]}}},659:{},1048:{},1054:{f:function(a,c,u){return[a.read_shift(2),Jd(a,0,u)]}},1084:{},1212:{f:function(a,c,u){var f=vL(a);a.l++;var m=a.read_shift(1);return[function(v,p,w){var S,b=v.l+p,T=v.read_shift(2),P=hv(v,T,w);return T==65535?[[],mo(v,p-2)]:(p!==T+2&&(S=uv(v,b-T-2,P,w)),[P,S])}(a,c-=8,u),m,f]}},2048:{f:function(a,c){return a.read_shift(2),[OS(a),a.read_shift((c-10)/2,"dbcs-cont").replace(nt,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:IS},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(a){a.l+=2;var c={cxfs:0,crc:0};return c.cxfs=a.read_shift(2),c.crc=a.read_shift(4),c},r:12},2173:{f:function(a,c){a.l,a.l+=2,c=a.read_shift(2),a.l+=2;for(var u=a.read_shift(2),f=[];0<u--;)f.push(fne(a,a.l));return{ixfe:c,ext:f}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:es,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(a,c,u){if(!(u.biff<8)){var f=a.read_shift(2),m=a.read_shift(2);return[qd(a,f,u),qd(a,m,u)]}a.l+=c},r:12},2197:{},2198:{f:function(a,c,u){var f=a.l+c;if(a.read_shift(4)!==124226)if(u.cellStyles){var m,v=a.slice(a.l);a.l=f;try{m=pf(v,{type:"array"})}catch{return}if(c=Vr(m,"theme/theme/theme1.xml",!0),c)return E8(c,u)}else a.l=f},r:12},2199:{},2200:{},2201:{},2202:{f:function(a){return[a.read_shift(4)!==0,a.read_shift(4)!==0,a.read_shift(4)]},r:12},2203:{f:wf},2204:{},2205:{},2206:{},2207:{},2211:{f:function(a){var c,u,f=(u=(c=a).read_shift(2),f=c.read_shift(2),c.l+=8,{type:u,flags:f});if(f.type!=2211)throw new Error("Invalid Future Record "+f.type);return a.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:as},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(a,c,u){var f={area:!1};return u.biff!=5?a.l+=c:(c=a.read_shift(1),a.l+=3,16&c&&(f.area=!0)),f}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(a){for(var c=a.read_shift(2),u=[];0<c--;)u.push(gL(a));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:CL},1:{},2:{f:function(a){var c=Yc(a);return++a.l,a=a.read_shift(2),c.t="n",c.val=a,c}},3:{f:function(a){var c=Yc(a);return++a.l,a=vo(a),c.t="n",c.val=a,c}},4:{f:function(a,c,u){u.biffguess&&u.biff==5&&(u.biff=2);var f=Yc(a);return++a.l,u=Jd(a,0,u),f.t="str",f.val=u,f}},5:{f:bL},7:{f:function(a){var c=a.read_shift(1);return c===0?(a.l++,""):a.read_shift(c,"sbcs-cont")}},8:{},9:{f:IS},11:{},22:{f:as},30:{f:vm},31:{},32:{},33:{f:RL},36:{},37:{f:yL},50:{f:function(a,c){a.l+=6,a.l+=2,a.l+=1,a.l+=3,a.l+=1,a.l+=c-13}},62:{},52:{},67:{},68:{f:as},69:{},86:{},126:{},127:{f:function(a){var c=a.read_shift(2),f=a.read_shift(2),u=a.read_shift(4),f={fmt:c,env:f,len:u,data:a.slice(a.l,a.l+u)};return a.l+=u,f}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(a,v,p){var f=a.l+v,m=Yc(a),v=a.read_shift(2),p=qd(a,v,p);return a.l=f,m.t="str",m.val=p,m}},223:{},234:{},354:{},421:{},518:{f:SA},521:{f:IS},536:{f:TL},547:{f:EL},561:{},579:{},1030:{f:SA},1033:{f:IS},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Lt(a,c,u,f){var m=c;isNaN(m)||(c=f||(u||[]).length||0,(f=a.next(4)).write_shift(2,m),f.write_shift(2,c),0<c&&BR(u)&&a.push(u))}function vv(a,c,u){return(a=a||it(7)).write_shift(2,c),a.write_shift(2,u),a.write_shift(2,0),a.write_shift(1,0),a}function Pie(a,c,u,f){if(c.v!=null)switch(c.t){case"d":case"n":var m=c.t=="d"?ci(ue(c.v)):c.v;return void(m==(0|m)&&0<=m&&m<65536?Lt(a,2,(T=u,P=f,M=m,vv(k=it(9),T,P),k.write_shift(2,M),k)):Lt(a,3,(M=u,k=f,m=m,vv(b=it(15),M,k),b.write_shift(8,m,"f"),b)));case"b":case"e":return void Lt(a,5,(b=u,v=f,p=c.v,w=c.t,vv(S=it(9),b,v),uL(p,w||"b",S),S));case"s":case"str":return void Lt(a,4,(v=u,p=f,w=(c.v||"").slice(0,255),vv(S=it(8+2*w.length),v,p),S.write_shift(1,w.length),S.write_shift(w.length,w,"sbcs"),S.l<S.length?S.slice(0,S.l):S))}var v,p,w,S,b,T,P,M,k;Lt(a,1,vv(null,u,f))}function Fie(a,c){for(var u=c||{},c=ha(),f=0,m=0;m<a.SheetNames.length;++m)a.SheetNames[m]==u.sheet&&(f=m);if(f==0&&u.sheet&&a.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return Lt(c,u.biff==4?1033:u.biff==3?521:9,nA(0,16,u)),function(v,p,w){var S,b,T=Array.isArray(p),P=un(p["!ref"]||"A1"),M=[];if(255<P.e.c||16383<P.e.r){if(w.WTF)throw new Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");P.e.c=Math.min(P.e.c,255),P.e.r=Math.min(P.e.c,16383),S=jr(P)}for(var k=P.s.r;k<=P.e.r;++k){b=Vi(k);for(var j=P.s.c;j<=P.e.c;++j){k===P.s.r&&(M[j]=fi(j)),S=M[j]+b;var L=T?(p[k]||[])[j]:p[S];L&&Pie(v,L,k,j)}}}(c,a.Sheets[a.SheetNames[f]],u),Lt(c,10),c.end()}function Mie(a,c,u){var f,m;Lt(a,49,(m=(f={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(a=it((u=(a=u)&&a.biff==5)?15+m.length:16+2*m.length)).write_shift(2,20*(f.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,m.length),u||a.write_shift(1,1),a.write_shift((u?1:2)*m.length,m,u?"sbcs":"utf16le"),a))}function kie(a,c,u){c&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m,v,p,w,S=f[0];S<=f[1];++S)c[S]!=null&&Lt(a,1054,(m=S,v=c[S],w=void 0,p=(p=u)&&p.biff==5,(w=w||it(p?3+v.length:5+2*v.length)).write_shift(2,m),w.write_shift(p?1:2,v.length),p||w.write_shift(1,1),w.write_shift((p?1:2)*v.length,v,p?"sbcs":"utf16le"),(w=w.length>w.l?w.slice(0,w.l):w).l==null&&(w.l=w.length),w))})}function Nie(a,c){for(var u=0;u<c["!links"].length;++u){var f=c["!links"][u];Lt(a,440,Sre(f)),f[1].Tooltip&&Lt(a,2048,function(m){var v=m[1].Tooltip,p=it(10+2*(v.length+1));p.write_shift(2,2048),m=Ri(m[0]),p.write_shift(2,m.r),p.write_shift(2,m.r),p.write_shift(2,m.c),p.write_shift(2,m.c);for(var w=0;w<v.length;++w)p.write_shift(2,v.charCodeAt(w));return p.write_shift(2,0),p}(f))}delete c["!links"]}function Die(a,c){var u;c&&(u=0,c.forEach(function(f,m){var v;++u<=256&&f&&Lt(a,125,(v=GS(m,f),f=m,(m=it(12)).write_shift(2,f),m.write_shift(2,f),m.write_shift(2,256*v.width),m.write_shift(2,0),f=0,v.hidden&&(f|=1),m.write_shift(1,f),f=v.level||0,m.write_shift(1,f),m.write_shift(2,0),m))}))}function Lie(a,c,u,f,m){var v,p,w,S,b,T,P,M,k,j,L,Q=16+Sf(m.cellXfs,c,m);if(c.v!=null||c.bf)if(c.bf)Lt(a,6,Ene(c,u,f,0,Q));else switch(c.t){case"d":case"n":var G=c.t=="d"?ci(ue(c.v)):c.v;Lt(a,515,(T=u,P=f,M=G,k=Q,j=it(14),Qd(T,P,k,j),am(M,j),j));break;case"b":case"e":Lt(a,517,(G=u,T=f,P=c.v,k=Q,M=c.t,j=it(8),Qd(G,T,k,j),uL(P,M,j),j));break;case"s":case"str":m.bookSST?(L=xA(m.Strings,c.v,m.revStrings),Lt(a,253,(v=u,p=f,w=L,S=Q,b=it(10),Qd(v,p,S,b),b.write_shift(4,w),b))):Lt(a,516,(L=u,v=f,p=(c.v||"").slice(0,255),S=Q,w=it(+(b=!(w=m)||w.biff==8)+8+(1+b)*p.length),Qd(L,v,S,w),w.write_shift(2,p.length),b&&w.write_shift(1,1),w.write_shift((1+b)*p.length,p,b?"utf16le":"sbcs"),w));break;default:Lt(a,513,Qd(u,f,Q))}else Lt(a,513,Qd(u,f,Q))}function Hie(a,c,u){var f,m,v=ha(),J=u.SheetNames[a],p=u.Sheets[J]||{},w=(u||{}).Workbook||{},S=(w.Sheets||[])[a]||{},b=Array.isArray(p),T=c.biff==8,P=[],M=un(p["!ref"]||"A1"),k=T?65536:16384;if(255<M.e.c||M.e.r>=k){if(c.WTF)throw new Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");M.e.c=Math.min(M.e.c,255),M.e.r=Math.min(M.e.c,k-1)}Lt(v,2057,nA(0,16,c)),Lt(v,13,dl(1)),Lt(v,12,dl(100)),Lt(v,15,$o(!0)),Lt(v,17,$o(!1)),Lt(v,16,am(.001)),Lt(v,95,$o(!0)),Lt(v,42,$o(!1)),Lt(v,43,$o(!1)),Lt(v,130,dl(1)),Lt(v,128,(u=[0,0],(a=it(8)).write_shift(4,0),a.write_shift(2,u[0]?u[0]+1:0),a.write_shift(2,u[1]?u[1]+1:0),a)),Lt(v,131,$o(!1)),Lt(v,132,$o(!1)),T&&Die(v,p["!cols"]),Lt(v,512,(k=M,(u=it(2*(a=(u=c).biff!=8&&u.biff?2:4)+6)).write_shift(a,k.s.r),u.write_shift(a,k.e.r+1),u.write_shift(2,k.s.c),u.write_shift(2,k.e.c+1),u.write_shift(2,0),u)),T&&(p["!links"]=[]);for(var j=M.s.r;j<=M.e.r;++j){m=Vi(j);for(var L=M.s.c;L<=M.e.c;++L){j===M.s.r&&(P[L]=fi(L)),f=P[L]+m;var Q=b?(p[j]||[])[L]:p[f];Q&&(Lie(v,Q,j,L,c),T&&Q.l&&p["!links"].push([f,Q.l]))}}var G,W,J=S.CodeName||S.name||J;return T&&Lt(v,574,(w=(w.Views||[])[0],W=it(18),G=1718,w&&w.RTL&&(G|=64),W.write_shift(2,G),W.write_shift(4,0),W.write_shift(4,64),W.write_shift(4,0),W.write_shift(4,0),W)),T&&(p["!merges"]||[]).length&&Lt(v,229,function(ne){var se=it(2+8*ne.length);se.write_shift(2,ne.length);for(var xe=0;xe<ne.length;++xe)pL(ne[xe],se);return se}(p["!merges"])),T&&Nie(v,p),Lt(v,442,hL(J)),T&&(G=v,W=p,(J=it(19)).write_shift(4,2151),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,3),J.write_shift(1,1),J.write_shift(4,0),Lt(G,2151,J),(J=it(39)).write_shift(4,2152),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,3),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(2,1),J.write_shift(4,4),J.write_shift(2,0),pL(un(W["!ref"]||"A1"),J),J.write_shift(4,4),Lt(G,2152,J)),Lt(v,10),v.end()}function $ie(a,c,u){var f=ha(),w=(a||{}).Workbook||{},m=w.Sheets||[],v=w.WBProps||{},p=u.biff==8,w=u.biff==5;Lt(f,2057,nA(0,5,u)),u.bookType=="xla"&&Lt(f,135),Lt(f,225,p?dl(1200):null),Lt(f,193,function(G,W){W=W||it(G);for(var J=0;J<G;++J)W.write_shift(1,0);return W}(2)),w&&Lt(f,191),w&&Lt(f,192),Lt(f,226),Lt(f,92,function(G){var W=!G||G.biff==8,J=it(W?112:54);for(J.write_shift(G.biff==8?2:1,7),W&&J.write_shift(1,0),J.write_shift(4,859007059),J.write_shift(4,5458548|(W?0:536870912));J.l<J.length;)J.write_shift(1,W?0:32);return J}(u)),Lt(f,66,dl(p?1200:1252)),p&&Lt(f,353,dl(0)),p&&Lt(f,448),Lt(f,317,function(G){for(var W=it(2*G),J=0;J<G;++J)W.write_shift(2,J+1);return W}(a.SheetNames.length)),p&&a.vbaraw&&Lt(f,211),p&&a.vbaraw&&Lt(f,442,hL(v.CodeName||"ThisWorkbook")),Lt(f,156,dl(17)),Lt(f,25,$o(!1)),Lt(f,18,$o(!1)),Lt(f,19,dl(0)),p&&Lt(f,431,$o(!1)),p&&Lt(f,444,dl(0)),Lt(f,61,((w=it(18)).write_shift(2,0),w.write_shift(2,0),w.write_shift(2,29280),w.write_shift(2,17600),w.write_shift(2,56),w.write_shift(2,0),w.write_shift(2,0),w.write_shift(2,1),w.write_shift(2,500),w)),Lt(f,64,$o(!1)),Lt(f,141,dl(0)),Lt(f,34,$o(((v=a).Workbook&&v.Workbook.WBProps&&hi(v.Workbook.WBProps.date1904)?"true":"false")=="true")),Lt(f,14,$o(!0)),p&&Lt(f,439,$o(!1)),Lt(f,218,dl(0)),Mie(f,0,u),kie(f,a.SSF,u),function(G,W){for(var J=0;J<16;++J)Lt(G,224,SL({numFmtId:0,style:!0},0,W));W.cellXfs.forEach(function(ne){Lt(G,224,SL(ne,0,W))})}(f,u),p&&Lt(f,352,$o(!1)),w=f.end(),v=ha(),p&&Lt(v,140,((Q=Q||it(4)).write_shift(2,1),Q.write_shift(2,1),Q)),p&&u.Strings&&function(G,W,J){var ne=(J||[]).length||0;if(ne<=8224)return Lt(G,W,J,ne);if(!isNaN(W)){for(var se=J.parts||[],xe=0,He=0,Fe=0;Fe+(se[xe]||8224)<=8224;)Fe+=se[xe]||8224,xe++;var Ue=G.next(4);for(Ue.write_shift(2,W),Ue.write_shift(2,Fe),G.push(J.slice(He,He+Fe)),He+=Fe;He<ne;){for((Ue=G.next(4)).write_shift(2,60),Fe=0;Fe+(se[xe]||8224)<=8224;)Fe+=se[xe]||8224,xe++;Ue.write_shift(2,Fe),G.push(J.slice(He,He+Fe)),He+=Fe}}}(v,252,wre(u.Strings)),Lt(v,10);for(var f=v.end(),S=ha(),b=0,T=0,T=0;T<a.SheetNames.length;++T)b+=(p?12:11)+(p?2:1)*a.SheetNames[T].length;var P,M,k,j,L=w.length+b+f.length;for(T=0;T<a.SheetNames.length;++T)Lt(S,133,(P={pos:L,hs:(m[T]||{}).Hidden||0,dt:0,name:a.SheetNames[T]},j=k=void 0,k=!(M=u)||8<=M.biff?2:1,(j=it(8+k*P.name.length)).write_shift(4,P.pos),j.write_shift(1,P.hs||0),j.write_shift(1,P.dt),j.write_shift(1,P.name.length),8<=M.biff&&j.write_shift(1,1),j.write_shift(k*P.name.length,P.name,M.biff<8?"sbcs":"utf16le"),(M=j.slice(0,j.l)).l=j.l,M)),L+=c[T].length;var Q=S.end();if(b!=Q.length)throw new Error("BS8 "+b+" != "+Q.length);return v=[],w.length&&v.push(w),Q.length&&v.push(Q),f.length&&v.push(f),ke(v)}function hH(a,c){for(var u=0;u<=a.SheetNames.length;++u){var f=a.Sheets[a.SheetNames[u]];f&&f["!ref"]&&255<Ho(f["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var m=c||{};switch(m.biff||2){case 8:case 5:return function(v,p){var w=p||{},S=[];v&&!v.SSF&&(v.SSF=Le(B)),v&&v.SSF&&(li(),Tr(v.SSF),w.revssf=Qu(v.SSF),w.revssf[v.SSF[65535]]=0,w.ssf=v.SSF),w.Strings=[],w.Strings.Count=0,w.Strings.Unique=0,kA(w),w.cellXfs=[],Sf(w.cellXfs,{},{revssf:{General:0}}),v.Props||(v.Props={});for(var b=0;b<v.SheetNames.length;++b)S[S.length]=Hie(b,w,v);return S.unshift($ie(v,S,w)),ke(S)}(a,c);case 4:case 3:case 2:return Fie(a,c)}throw new Error("invalid type "+m.bookType+" for BIFF")}function fH(a,c){var u=c||{},f=u.dense?[]:{},m=(a=a.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!m)throw new Error("Invalid HTML: could not find <table>");for(var v,c=a.match(/<\/table/i),M=m.index,p=c&&c.index||a.length,w=Qe(a.slice(M,p),/(:?<tr[^>]*>)/i,"<tr>"),S=-1,b=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},P=[],M=0;M<w.length;++M){var k=w[M].trim(),j=k.slice(0,3).toLowerCase();if(j!="<tr"){if(j=="<td"||j=="<th")for(var L=k.split(/<\/t[dh]>/i),p=0;p<L.length;++p){var Q=L[p].trim();if(Q.match(/<t[dh]/i)){for(var G=Q,W=0;G.charAt(0)=="<"&&-1<(W=G.indexOf(">"));)G=G.slice(W+1);for(var J=0;J<P.length;++J){var ne=P[J];ne.s.c==b&&ne.s.r<S&&S<=ne.e.r&&(b=ne.e.c+1,J=-1)}var se=kr(Q.slice(0,Q.indexOf(">"))),xe=se.colspan?+se.colspan:1;(1<(v=+se.rowspan)||1<xe)&&P.push({s:{r:S,c:b},e:{r:S+(v||1)-1,c:b+xe-1}}),Q=se.t||se["data-t"]||"",G.length&&(G=m5(G),T.s.r>S&&(T.s.r=S),T.e.r<S&&(T.e.r=S),T.s.c>b&&(T.s.c=b),T.e.c<b&&(T.e.c=b),G.length&&(se={t:"s",v:G},u.raw||!G.trim().length||Q=="s"||(G==="TRUE"?se={t:"b",v:!0}:G==="FALSE"?se={t:"b",v:!1}:isNaN(Ve(G))?isNaN(ie(G).getDate())||(se={t:"d",v:ue(G)},(se=u.cellDates?se:{t:"n",v:ci(se.v)}).z=u.dateNF||B[14]):se={t:"n",v:Ve(G)}),u.dense?(f[S]||(f[S]=[]),f[S][b]=se):f[Nr({r:S,c:b})]=se)),b+=xe}}}else{if(++S,u.sheetRows&&u.sheetRows<=S){--S;break}b=0}}return f["!ref"]=jr(T),P.length&&(f["!merges"]=P),f}function dH(a,c,u,f){for(var m=a["!merges"]||[],v=[],p=c.s.c;p<=c.e.c;++p){for(var w,S,b,T,P=0,M=0,k=0;k<m.length;++k)if(!(m[k].s.r>u||m[k].s.c>p||m[k].e.r<u||m[k].e.c<p)){if(m[k].s.r<u||m[k].s.c<p){P=-1;break}P=m[k].e.r-m[k].s.r+1,M=m[k].e.c-m[k].s.c+1;break}P<0||(w=Nr({r:u,c:p}),b=(S=f.dense?(a[u]||[])[p]:a[w])&&S.v!=null&&(S.h||IR(S.w||(Gc(S),S.w)||""))||"",T={},1<P&&(T.rowspan=P),1<M&&(T.colspan=M),f.editable?b='<span contenteditable="true">'+b+"</span>":S&&(T["data-t"]=S&&S.t||"z",S.v!=null&&(T["data-v"]=S.v),S.z!=null&&(T["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+S.l.Target+'">'+b+"</a>")),T.id=(f.id||"sjs")+"-"+w,v.push(Dt("td",b,T)))}return"<tr>"+v.join("")+"</tr>"}var gH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',mH="</body></html>";function pH(a,c,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function vH(a,m){var u=m||{},f=u.header!=null?u.header:gH,m=u.footer!=null?u.footer:mH,v=[f],p=Ho(a["!ref"]);u.dense=Array.isArray(a),v.push(pH(0,0,u));for(var w=p.s.r;w<=p.e.r;++w)v.push(dH(a,p,w,u));return v.push("</table>"+m),v.join("")}function wH(a,c,u){var f=u||{},m=0,v=0;f.origin!=null&&(typeof f.origin=="number"?m=f.origin:(m=(u=typeof f.origin=="string"?Ri(f.origin):f.origin).r,v=u.c));var p=c.getElementsByTagName("tr"),w=Math.min(f.sheetRows||1e7,p.length),S={s:{r:0,c:0},e:{r:m,c:v}};a["!ref"]&&(c=Ho(a["!ref"]),S.s.r=Math.min(S.s.r,c.s.r),S.s.c=Math.min(S.s.c,c.s.c),S.e.r=Math.max(S.e.r,c.e.r),S.e.c=Math.max(S.e.c,c.e.c),m==-1&&(S.e.r=m=c.e.r+1));var b,T,P=[],M=0,k=a["!rows"]||(a["!rows"]=[]),j=0,L=0,Q=0,G=0;for(a["!cols"]||(a["!cols"]=[]);j<p.length&&L<w;++j){var W=p[j];if(CH(W)){if(f.display)continue;k[L]={hidden:!0}}for(var J=W.children,Q=G=0;Q<J.length;++Q){var ne=J[Q];if(!f.display||!CH(ne)){for(var se=ne.hasAttribute("data-v")?ne.getAttribute("data-v"):ne.hasAttribute("v")?ne.getAttribute("v"):m5(ne.innerHTML),xe=ne.getAttribute("data-z")||ne.getAttribute("z"),M=0;M<P.length;++M){var He=P[M];He.s.c==G+v&&He.s.r<L+m&&L+m<=He.e.r&&(G=He.e.c+1-v,M=-1)}T=+ne.getAttribute("colspan")||1,(1<(b=+ne.getAttribute("rowspan")||1)||1<T)&&P.push({s:{r:L+m,c:G+v},e:{r:L+m+(b||1)-1,c:G+v+(T||1)-1}});var Fe={t:"s",v:se},Ue=ne.getAttribute("data-t")||ne.getAttribute("t")||"";se!=null&&(se.length==0?Fe.t=Ue||"z":f.raw||se.trim().length==0||Ue=="s"||(se==="TRUE"?Fe={t:"b",v:!0}:se==="FALSE"?Fe={t:"b",v:!1}:isNaN(Ve(se))?isNaN(ie(se).getDate())||(Fe={t:"d",v:ue(se)},(Fe=f.cellDates?Fe:{t:"n",v:ci(Fe.v)}).z=f.dateNF||B[14]):Fe={t:"n",v:Ve(se)})),Fe.z===void 0&&xe!=null&&(Fe.z=xe);var ct="",ut=ne.getElementsByTagName("A");if(ut&&ut.length)for(var Ke=0;Ke<ut.length&&(!ut[Ke].hasAttribute("href")||(ct=ut[Ke].getAttribute("href")).charAt(0)=="#");++Ke);ct&&ct.charAt(0)!="#"&&(Fe.l={Target:ct}),f.dense?(a[L+m]||(a[L+m]=[]),a[L+m][G+v]=Fe):a[Nr({c:G+v,r:L+m})]=Fe,S.e.c<G+v&&(S.e.c=G+v),G+=T}}++L}return P.length&&(a["!merges"]=(a["!merges"]||[]).concat(P)),S.e.r=Math.max(S.e.r,L-1+m),a["!ref"]=jr(S),w<=L&&(a["!fullref"]=jr((S.e.r=p.length-j+L-1+m,S))),a}function yH(a,c){return wH((c||{}).dense?[]:{},a,c)}function CH(a){var u,c="",u=(u=a).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(c=(c=u?u(a).getPropertyValue("display"):c)||a.style&&a.style.display)==="none"}var SH={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bH(a,c){var u=c||{},f,m,v,p,w,S=kR(a),b=[],T={name:""},P="",M=0,k={},j=[],L=u.dense?[]:{},Q={value:""},G="",W=0,J=[],ne=-1,se=-1,xe={s:{r:1e6,c:1e7},e:{r:0,c:0}},He=0,Fe={},Ue=[],ct={},ut=[],Ke=1,St=1,Wt=[],$t={Names:[]},Ot={},Pt=["",""],_t=[],mt={},Zt="",or=0,Cr=!1,Gr=!1,Kt=0;for(Y1.lastIndex=0,S=S.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Y1.exec(S);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(xe.e.c>=xe.s.c&&xe.e.r>=xe.s.r?L["!ref"]=jr(xe):L["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=xe.e.r&&(L["!fullref"]=L["!ref"],xe.e.r=u.sheetRows-1,L["!ref"]=jr(xe)),Ue.length&&(L["!merges"]=Ue),ut.length&&(L["!rows"]=ut),v.name=v.||v.name,typeof JSON<"u"&&JSON.stringify(v),j.push(v.name),k[v.name]=L,Gr=!1):p[0].charAt(p[0].length-2)!=="/"&&(v=kr(p[0],!1),ne=se=-1,xe.s.r=xe.s.c=1e7,xe.e.r=xe.e.c=0,L=u.dense?[]:{},Ue=[],ut=[],Gr=!0);break;case"table-row-group":p[1]==="/"?--He:++He;break;case"table-row":case"":if(p[1]==="/"){ne+=Ke,Ke=1;break}if((Ct=kr(p[0],!1)).?ne=Ct.-1:ne==-1&&(ne=0),(Ke=+Ct["number-rows-repeated"]||1)<10)for(Kt=0;Kt<Ke;++Kt)0<He&&(ut[ne+Kt]={level:He});se=-1;break;case"covered-table-cell":p[1]!=="/"&&++se,u.sheetStubs&&(u.dense?(L[ne]||(L[ne]=[]),L[ne][se]={t:"z"}):L[Nr({r:ne,c:se})]={t:"z"}),G="",J=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++se,Q=kr(p[0],!1),St=parseInt(Q["number-columns-repeated"]||"1",10),w={t:"z",v:null},Q.formula&&u.cellFormula!=0&&(w.f=j8(Sn(Q.formula))),(Q.||Q["value-type"])=="string"&&(w.t="s",w.v=Sn(Q["string-value"]||""),u.dense?(L[ne]||(L[ne]=[]),L[ne][se]=w):L[Nr({r:ne,c:se})]=w),se+=St-1;else if(p[1]!=="/"){G="",W=0,J=[],St=1;var Ct=Ke?ne+Ke-1:ne;if(++se>xe.e.c&&(xe.e.c=se),se<xe.s.c&&(xe.s.c=se),ne<xe.s.r&&(xe.s.r=ne),Ct>xe.e.r&&(xe.e.r=Ct),_t=[],mt={},w={t:(Q=kr(p[0],!1)).||Q["value-type"],v:null},u.cellFormula)if(Q.formula&&(Q.formula=Sn(Q.formula)),Q["number-matrix-columns-spanned"]&&Q["number-matrix-rows-spanned"]&&(ct={s:{r:ne,c:se},e:{r:ne+(parseInt(Q["number-matrix-rows-spanned"],10)||0)-1,c:se+(parseInt(Q["number-matrix-columns-spanned"],10)||0)-1}},w.F=jr(ct),Wt.push([ct,w.F])),Q.formula)w.f=j8(Q.formula);else for(Kt=0;Kt<Wt.length;++Kt)ne>=Wt[Kt][0].s.r&&ne<=Wt[Kt][0].e.r&&se>=Wt[Kt][0].s.c&&se<=Wt[Kt][0].e.c&&(w.F=Wt[Kt][1]);switch((Q["number-columns-spanned"]||Q["number-rows-spanned"])&&(ct={s:{r:ne,c:se},e:{r:ne+(parseInt(Q["number-rows-spanned"],10)||0)-1,c:se+(parseInt(Q["number-columns-spanned"],10)||0)-1}},Ue.push(ct)),Q["number-columns-repeated"]&&(St=parseInt(Q["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=hi(Q["boolean-value"]);break;case"float":case"percentage":case"currency":w.t="n",w.v=parseFloat(Q.value);break;case"date":w.t="d",w.v=ue(Q["date-value"]),u.cellDates||(w.t="n",w.v=ci(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=function(rn){var In=0,Wi=0,_e=!1,Pn=rn.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Pn)throw new Error("|"+rn+"| is not an ISO8601 Duration");for(var Tn=1;Tn!=Pn.length;++Tn)if(Pn[Tn]){switch(Wi=1,3<Tn&&(_e=!0),Pn[Tn].slice(Pn[Tn].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Pn[Tn].slice(Pn[Tn].length-1));case"D":Wi*=24;case"H":Wi*=60;case"M":if(!_e)throw new Error("Unsupported ISO Duration Field: M");Wi*=60}In+=Wi*parseInt(Pn[Tn],10)}return In}(Q["time-value"])/86400,u.cellDates&&(w.t="d",w.v=ee(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(Q.);break;default:if(w.t!=="string"&&w.t!=="text"&&w.t)throw new Error("Unsupported value type "+w.t);w.t="s",Q["string-value"]!=null&&(G=Sn(Q["string-value"]),J=[])}}else{if(Cr=!1,w.t==="s"&&(w.v=G||"",J.length&&(w.R=J),Cr=W==0),Ot.Target&&(w.l=Ot),0<_t.length&&(w.c=_t,_t=[]),G&&u.cellText!==!1&&(w.w=G),Cr&&(w.t="z",delete w.v),(!Cr||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=ne))for(var Dr=0;Dr<Ke;++Dr){if(St=parseInt(Q["number-columns-repeated"]||"1",10),u.dense)for(L[ne+Dr]||(L[ne+Dr]=[]),L[ne+Dr][se]=Dr==0?w:Le(w);0<--St;)L[ne+Dr][se+St]=Le(w);else for(L[Nr({r:ne+Dr,c:se})]=w;0<--St;)L[Nr({r:ne+Dr,c:se+St})]=Le(w);xe.e.c<=se&&(xe.e.c=se)}se+=(St=parseInt(Q["number-columns-repeated"]||"1",10))-1,St=0,w={},G="",J=[]}Ot={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f;mt.t=G,J.length&&(mt.R=J),mt.a=Zt,_t.push(mt)}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!1]);G=Zt="",W=or=0,J=[];break;case"creator":p[1]==="/"?Zt=S.slice(or,p.index):or=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!1]);G="",W=0,J=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(Fe[T.name]=P,(f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&(P="",T=kr(p[0],!1),b.push([p[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(b[b.length-1][0]){case"time-style":case"date-style":m=kr(p[0],!1),P+=SH[p[3]][m.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(b[b.length-1][0]){case"time-style":case"date-style":m=kr(p[0],!1),P+=SH[p[3]][m.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(b[b.length-1][0]){case"number-style":case"date-style":case"time-style":P+=S.slice(M,p.index)}else M=p.index+p[0].length;break;case"named-range":Pt=bA((m=kr(p[0],!1))["cell-range-address"]);var fn={Name:m.name,Ref:Pt[0]+"!"+Pt[1]};Gr&&(fn.Sheet=j.length),$t.Names.push(fn);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(b[b.length-1][0]))break;p[1]!=="/"||Q&&Q["string-value"]?(kr(p[0],!1),W=p.index+p[0].length):(fn=(fn=S.slice(W,p.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(rn,In){return Array(parseInt(In,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),fn=[Sn(fn.replace(/<[^>]*>/g,""))],G=(0<G.length?G+`
`:"")+fn[0]);break;case"s":break;case"database-range":if(p[1]==="/")break;try{k[(Pt=bA(kr(p[0])["target-range-address"]))[0]]["!autofilter"]={ref:Pt[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(p[1]!=="/"){if(!(Ot=kr(p[0],!1)).href)break;Ot.Target=Sn(Ot.href),delete Ot.href,Ot.Target.charAt(0)=="#"&&-1<Ot.Target.indexOf(".")?(Pt=bA(Ot.Target.slice(1)),Ot.Target="#"+Pt[0]+"!"+Pt[1]):Ot.Target.match(/^\.\.[\\\/]/)&&(Ot.Target=Ot.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(p)}}return a={Sheets:k,SheetNames:j,Workbook:$t},u.bookSheets&&delete a.Sheets,a}function xH(a,c){c=c||{},yt(a,"META-INF/manifest.xml")&&function(f,m){for(var v,p,w=kR(f);v=Y1.exec(w);)switch(v[3]){case"manifest":break;case"file-entry":if((p=kr(v[0],!1)).path=="/"&&p.type!==hre)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(m&&m.WTF)throw v}}(_r(a,"META-INF/manifest.xml"),c);var u=Vr(a,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return c=bH(qn(u),c),yt(a,"meta.xml")&&(c.Props=U5(_r(a,"meta.xml"))),c}function EH(a,c){return bH(a,c)}var Bie=function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),c="<office:document-styles "+G1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return ui+c}}(),TH=function(){function a(u,f,m){var v=[];v.push('      <table:table table:name="'+$n(f.SheetNames[m])+`" table:style-name="ta1">
`);var p=0,w=0,S=Ho(u["!ref"]||"A1"),b=u["!merges"]||[],T=0,P=Array.isArray(u);if(u["!cols"])for(w=0;w<=S.e.c;++w)v.push("        <table:table-column"+(u["!cols"][w]?' table:style-name="co'+u["!cols"][w].ods+'"':"")+`></table:table-column>
`);for(var M="",k=u["!rows"]||[],p=0;p<S.s.r;++p)M=k[p]?' table:style-name="ro'+k[p].ods+'"':"",v.push("        <table:table-row"+M+`></table:table-row>
`);for(;p<=S.e.r;++p){for(M=k[p]?' table:style-name="ro'+k[p].ods+'"':"",v.push("        <table:table-row"+M+`>
`),w=0;w<S.s.c;++w)v.push(c);for(;w<=S.e.c;++w){for(var j=!1,L={},Q="",T=0;T!=b.length;++T)if(!(b[T].s.c>w||b[T].s.r>p||b[T].e.c<w||b[T].e.r<p)){b[T].s.c==w&&b[T].s.r==p||(j=!0),L["table:number-columns-spanned"]=b[T].e.c-b[T].s.c+1,L["table:number-rows-spanned"]=b[T].e.r-b[T].s.r+1;break}if(j)v.push(`          <table:covered-table-cell/>
`);else{var G=Nr({r:p,c:w}),W=P?(u[p]||[])[w]:u[G];if(W&&W.f&&(L["table:formula"]=$n(("of:="+W.f.replace(wA,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),W.F&&W.F.slice(0,G.length)==G&&(J=Ho(W.F),L["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,L["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1)),W){switch(W.t){case"b":Q=W.v?"TRUE":"FALSE",L["office:value-type"]="boolean",L["office:boolean-value"]=W.v?"true":"false";break;case"n":Q=W.w||String(W.v||0),L["office:value-type"]="float",L["office:value"]=W.v||0;break;case"s":case"str":Q=W.v==null?"":W.v,L["office:value-type"]="string";break;case"d":Q=W.w||ue(W.v).toISOString(),L["office:value-type"]="date",L["office:date-value"]=ue(W.v).toISOString(),L["table:style-name"]="ce1";break;default:v.push(c);continue}var J,G=$n(Q).replace(/  +/g,function(se){return'<text:s text:c="'+se.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");W.l&&W.l.Target&&(G=Dt("text:a",G,{"xlink:href":(J=(J=(J=W.l.Target).charAt(0)=="#"?"#"+J.slice(1).replace(/\./,"!"):J).charAt(0)!="#"&&!J.match(/^\w+:/)?"../"+J:J).replace(/&/g,"&amp;")})),v.push("          "+Dt("table:table-cell",Dt("text:p",G,{}),L)+`
`)}else v.push(c)}}v.push(`        </table:table-row>
`)}return v.push(`      </table:table>
`),v.join("")}var c=`          <table:table-cell />
`;return function(u,f){var m=[ui],v=G1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=G1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(m.push("<office:document"+v+p+`>
`),m.push(j5().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+v+`>
`),function(S,b){S.push(` <office:automatic-styles>
`),S.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),S.push(`   <number:month number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:day number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:year/>
`),S.push(`  </number:date-style>
`);var T=0;b.SheetNames.map(function(M){return b.Sheets[M]}).forEach(function(M){if(M&&M["!cols"]){for(var k=0;k<M["!cols"].length;++k)if(M["!cols"][k]){var j=M["!cols"][k];if(j.width==null&&j.wpx==null&&j.wch==null)continue;yf(j),j.ods=T,j=M["!cols"][k].wpx+"px",S.push('  <style:style style:name="co'+T+`" style:family="table-column">
`),S.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+j+`"/>
`),S.push(`  </style:style>
`),++T}}});var P=0;b.SheetNames.map(function(M){return b.Sheets[M]}).forEach(function(M){if(M&&M["!rows"])for(var k,j=0;j<M["!rows"].length;++j)M["!rows"][j]&&(M["!rows"][j].ods=P,k=M["!rows"][j].hpx+"px",S.push('  <style:style style:name="ro'+P+`" style:family="table-row">
`),S.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+k+`"/>
`),S.push(`  </style:style>
`),++P)}),S.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),S.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),S.push(`  </style:style>
`),S.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),S.push(` </office:automatic-styles>
`)}(m,u),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var w=0;w!=u.SheetNames.length;++w)m.push(a(u.Sheets[u.SheetNames[w]],u,w));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),f.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function _H(a,c){if(c.bookType=="fods")return TH(a,c);var u=ul(),f=[],m=[];return Mr(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),Mr(u,"content.xml",TH(a,c)),f.push(["content.xml","text/xml"]),m.push(["content.xml","ContentFile"]),Mr(u,"styles.xml",Bie(a,c)),f.push(["styles.xml","text/xml"]),m.push(["styles.xml","StylesFile"]),Mr(u,"meta.xml",ui+j5()),f.push(["meta.xml","text/xml"]),m.push(["meta.xml","MetadataFile"]),Mr(u,"manifest.rdf",function(v){var p=[ui];p.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var w=0;w!=v.length;++w)p.push(W5(v[w][0],v[w][1])),p.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+v[w][0]+`"/>
`,`  </rdf:Description>
`].join(""));return p.push(W5("","Document","pkg")),p.push("</rdf:RDF>"),p.join("")}(m)),f.push(["manifest.rdf","application/rdf+xml"]),Mr(u,"META-INF/manifest.xml",function(v){var p=[ui];p.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),p.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var w=0;w<v.length;++w)p.push('  <manifest:file-entry manifest:full-path="'+v[w][0]+'" manifest:media-type="'+v[w][1]+`"/>
`);return p.push("</manifest:manifest>"),p.join("")}(f)),u}function ih(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function OA(a){return typeof TextDecoder<"u"?new TextDecoder().decode(a):qn(ye(a))}function RH(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):me(zc(a))}function bf(a){var c=a.reduce(function(m,v){return m+v.length},0),u=new Uint8Array(c),f=0;return a.forEach(function(m){u.set(m,f),f+=m.length}),u}function AH(a){return 16843009*((a=(858993459&(a-=a>>1&1431655765))+(a>>2&858993459))+(a>>4)&252645135)>>>24}function wv(a,c){var u=c?c[0]:0,f=127&a[u];return 128<=a[u++]&&(f|=(127&a[u])<<7,a[u++]<128||(f|=(127&a[u])<<14,a[u++]<128||(f|=(127&a[u])<<21,a[u++]<128||(f+=(127&a[u])*Math.pow(2,28),++u,a[u++]<128||(f+=(127&a[u])*Math.pow(2,35),++u,a[u++]<128||(f+=(127&a[u])*Math.pow(2,42),++u,a[u++])))))),c&&(c[0]=u),f}function bn(a){var c=new Uint8Array(7);c[0]=127&a;var u=1;return 127<a&&(c[u-1]|=128,c[u]=a>>7&127,++u,a<=16383||(c[u-1]|=128,c[u]=a>>14&127,++u,a<=2097151||(c[u-1]|=128,c[u]=a>>21&127,++u,a<=268435455||(c[u-1]|=128,c[u]=a/256>>>21&127,++u,a<=34359738367||(c[u-1]|=128,c[u]=a/65536>>>21&127,++u,a<=4398046511103||(c[u-1]|=128,c[u]=a/16777216>>>21&127,++u)))))),c.slice(0,u)}function bi(a){var c=0,u=127&a[0];return 128<=a[c++]&&(u|=(127&a[1])<<7,a[c++]<128||(u|=(127&a[2])<<14,a[c++]<128||(u|=(127&a[3])<<21,a[+c]<128||(u|=(127&a[4])<<28)))),u}function hn(a){for(var c=[],u=[0];u[0]<a.length;){var f,m=u[0],v=wv(a,u),p=7&v,w=0;if((v=Math.floor(v/8))==0)break;switch(p){case 0:for(var S=u[0];128<=a[u[0]++];);f=a.slice(S,u[0]);break;case 5:w=4,f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 1:w=8,f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 2:w=wv(a,u),f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 3:case 4:default:throw new Error("PB Type ".concat(p," for Field ").concat(v," at offset ").concat(m))}var b={data:f,type:p};c[v]==null?c[v]=[b]:c[v].push(b)}return c}function Ai(a){var c=[];return a.forEach(function(u,f){f!=0&&u.forEach(function(m){m.data&&(c.push(bn(8*f+m.type)),m.type==2&&c.push(bn(m.data.length)),c.push(m.data))})}),bf(c)}function IA(a,c){return(a==null?void 0:a.map(function(u){return c(u.data)}))||[]}function gl(a){for(var c=[],u=[0];u[0]<a.length;){var f=wv(a,u),m=hn(a.slice(u[0],u[0]+f));u[0]+=f;var v={id:bi(m[1][0].data),messages:[]};m[2].forEach(function(S){var w=hn(S.data),S=bi(w[3][0].data);v.messages.push({meta:w,data:a.slice(u[0],u[0]+S)}),u[0]+=S}),(f=m[3])!=null&&f[0]&&(v.merge=0<bi(m[3][0].data)>>>0),c.push(v)}return c}function t0(a){var c=[];return a.forEach(function(u){var f=[[],[{data:bn(u.id),type:0}],[]];u.merge!=null&&(f[3]=[{data:bn(+!!u.merge),type:0}]);var m=[];u.messages.forEach(function(v){m.push(v.data),v.meta[3]=[{type:0,data:bn(v.data.length)}],f[2].push({data:Ai(v.meta),type:2})}),u=Ai(f),c.push(bn(u.length)),c.push(u),m.forEach(function(v){return c.push(v)})}),bf(c)}function ml(a){for(var c=[],u=0;u<a.length;){var f=a[u++],m=a[u]|a[u+1]<<8|a[u+2]<<16;u+=3,c.push(function(v,p){if(v!=0)throw new Error("Unexpected Snappy chunk type ".concat(v));for(var w=[0],S=wv(p,w),b=[];w[0]<p.length;){var T=3&p[w[0]];if(T!=0){var P=0,M=0;if(T==1?(M=4+(p[w[0]]>>2&7),P=(224&p[w[0]++])<<3,P|=p[w[0]++]):(M=1+(p[w[0]++]>>2),T==2?(P=p[w[0]]|p[w[0]+1]<<8,w[0]+=2):(P=(p[w[0]]|p[w[0]+1]<<8|p[w[0]+2]<<16|p[w[0]+3]<<24)>>>0,w[0]+=4)),b=[bf(b)],P==0)throw new Error("Invalid offset 0");if(P>b[0].length)throw new Error("Invalid offset beyond length");if(P<=M)for(b.push(b[0].slice(-P)),M-=P;M>=b[b.length-1].length;)b.push(b[b.length-1]),M-=b[b.length-1].length;b.push(b[0].slice(-P,-P+M))}else T=p[w[0]++]>>2,T<60?++T:(P=T-59,T=p[w[0]],1<P&&(T|=p[w[0]+1]<<8),2<P&&(T|=p[w[0]+2]<<16),3<P&&(T|=p[w[0]+3]<<24),T>>>=0,T++,w[0]+=P),b.push(p.slice(w[0],w[0]+T)),w[0]+=T}if((v=bf(b)).length!=S)throw new Error("Unexpected length: ".concat(v.length," != ").concat(S));return v}(f,a.slice(u,u+m))),u+=m}if(u!==a.length)throw new Error("data is not a valid framed stream!");return bf(c)}function r0(a){for(var c=[],u=0;u<a.length;){var f=Math.min(a.length-u,268435455),m=new Uint8Array(4);c.push(m);var v=bn(f),p=v.length;c.push(v),f<=60?(p++,c.push(new Uint8Array([f-1<<2]))):f<=256?(p+=2,c.push(new Uint8Array([240,f-1&255]))):f<=65536?(p+=3,c.push(new Uint8Array([244,f-1&255,f-1>>8&255]))):f<=16777216?(p+=4,c.push(new Uint8Array([248,f-1&255,f-1>>8&255,f-1>>16&255]))):f<=4294967296&&(p+=5,c.push(new Uint8Array([252,f-1&255,f-1>>8&255,f-1>>16&255,f-1>>>24&255]))),c.push(a.slice(u,u+f)),p+=f,m[0]=0,m[1]=255&p,m[2]=p>>8&255,m[3]=p>>16&255,u+=f}return bf(c)}function Vie(a,c,u){var f,m=ih(a),v=m.getUint32(8,!0),p=12,w=-1,S=-1,b=NaN,T=NaN,P=new Date(2001,0,1);switch(1&v&&(b=function(M,k){for(var j=(127&M[k+15])<<7|M[k+14]>>1,L=1&M[k+14],Q=k+13;k<=Q;--Q)L=256*L+M[Q];return(128&M[k+15]?-L:L)*Math.pow(10,j-6176)}(a,p),p+=16),2&v&&(T=m.getFloat64(p,!0),p+=8),4&v&&(P.setTime(P.getTime()+1e3*m.getFloat64(p,!0)),p+=8),8&v&&(S=m.getUint32(p,!0),p+=4),16&v&&(w=m.getUint32(p,!0),p+=4),a[1]){case 0:break;case 2:f={t:"n",v:b};break;case 3:f={t:"s",v:c[S]};break;case 5:f={t:"d",v:P};break;case 6:f={t:"b",v:0<T};break;case 7:f={t:"n",v:T/86400};break;case 8:f={t:"e",v:0};break;case 9:if(!(-1<w))throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&v," : ").concat(a.slice(0,4)));f={t:"s",v:u[w]};break;case 10:f={t:"n",v:b};break;default:throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&v," : ").concat(a.slice(0,4)))}return f}function PA(a,c){var u=new Uint8Array(32),f=ih(u),m=12,v=0;switch(u[0]=5,a.t){case"n":u[1]=2,function(p,w,S){var b=Math.floor(S==0?0:Math.LOG10E*Math.log(Math.abs(S)))+6176-16,T=S/Math.pow(10,b-6176);p[w+15]|=b>>7,p[w+14]|=(127&b)<<1;for(var P=0;1<=T;++P,T/=256)p[w+P]=255&T;p[w+15]|=0<=S?0:128}(u,m,a.v),v|=1,m+=16;break;case"b":u[1]=6,f.setFloat64(m,a.v?1:0,!0),v|=2,m+=8;break;case"s":if(c.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));u[1]=3,f.setUint32(m,c.indexOf(a.v),!0),v|=8,m+=4;break;default:throw"unsupported cell type "+a.t}return f.setUint32(8,v,!0),u.slice(0,m)}function FA(a,c){var u=new Uint8Array(32),f=ih(u),m=12,v=0;switch(u[0]=3,a.t){case"n":u[2]=2,f.setFloat64(m,a.v,!0),v|=32,m+=8;break;case"b":u[2]=6,f.setFloat64(m,a.v?1:0,!0),v|=32,m+=8;break;case"s":if(c.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));u[2]=3,f.setUint32(m,c.indexOf(a.v),!0),v|=16,m+=4;break;default:throw"unsupported cell type "+a.t}return f.setUint32(4,v,!0),u.slice(0,m)}function Wie(a,c,u){switch(a[0]){case 0:case 1:case 2:case 3:return function(f,m,v,p){var w,S=ih(f),b=S.getUint32(4,!0),T=(1<p?12:8)+4*AH(b&(1<p?3470:398)),P=-1,M=-1,k=NaN,j=new Date(2001,0,1);switch(512&b&&(P=S.getUint32(T,!0),T+=4),T+=4*AH(b&(1<p?12288:4096)),16&b&&(M=S.getUint32(T,!0),T+=4),32&b&&(k=S.getFloat64(T,!0),T+=8),64&b&&(j.setTime(j.getTime()+1e3*S.getFloat64(T,!0)),T+=8),f[2]){case 0:break;case 2:w={t:"n",v:k};break;case 3:w={t:"s",v:m[M]};break;case 5:w={t:"d",v:j};break;case 6:w={t:"b",v:0<k};break;case 7:w={t:"n",v:k/86400};break;case 8:w={t:"e",v:0};break;case 9:if(-1<P)w={t:"s",v:v[P]};else if(-1<M)w={t:"s",v:m[M]};else{if(isNaN(k))throw new Error("Unsupported cell type ".concat(f.slice(0,4)));w={t:"n",v:k}}break;default:throw new Error("Unsupported cell type ".concat(f.slice(0,4)))}return w}(a,c,u,a[0]);case 5:return Vie(a,c,u);default:throw new Error("Unsupported payload version ".concat(a[0]))}}function qs(a){return wv(hn(a)[1][0].data)}function OH(a,f){var f=hn(f.data),u=bi(f[1][0].data),f=f[3],m=[];return(f||[]).forEach(function(v){var p=hn(v.data),w=bi(p[1][0].data)>>>0;switch(u){case 1:m[w]=OA(p[3][0].data);break;case 8:var b=hn(a[qs(p[9][0].data)][0].data),S=a[qs(b[1][0].data)][0],b=bi(S.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));S=hn(S.data),m[w]=S[3].map(function(T){return OA(T.data)}).join("")}}),m}function jie(a,m){var u=hn(m.data),f=(m=u==null?void 0:u[7])!=null&&m[0]?0<bi(u[7][0].data)>>>0?1:0:-1,m=IA(u[5],function(v){return function(p,w){var S,b,T,P=hn(p),M=bi(P[1][0].data)>>>0,k=bi(P[2][0].data)>>>0,j=((p=(j=P[8])==null?void 0:j[0])==null?void 0:p.data)&&0<bi(P[8][0].data)||!1;if((p=(p=P[7])==null?void 0:p[0])!=null&&p.data&&w!=0)b=(S=(S=P[7])==null?void 0:S[0])==null?void 0:S.data,T=(S=(S=P[6])==null?void 0:S[0])==null?void 0:S.data;else{if((S=(S=P[4])==null?void 0:S[0])==null||!S.data||w==1)throw"NUMBERS Tile missing ".concat(w," cell storage");b=(w=(w=P[4])==null?void 0:w[0])==null?void 0:w.data,T=(P=(P=P[3])==null?void 0:P[0])==null?void 0:P.data}for(var L=j?4:1,Q=ih(b),G=[],W=0;W<b.length/2;++W){var J=Q.getUint16(2*W,!0);J<65535&&G.push([W,J])}if(G.length!=k)throw"Expected ".concat(k," cells, found ").concat(G.length);for(var ne=[],W=0;W<G.length-1;++W)ne[G[W][0]]=T.subarray(G[W][1]*L,G[W+1][1]*L);return 1<=G.length&&(ne[G[G.length-1][0]]=T.subarray(G[G.length-1][1]*L)),{R:M,cells:ne}}(v,f)});return{nrows:bi(u[4][0].data)>>>0,data:m.reduce(function(v,p){return v[p.R]||(v[p.R]=[]),p.cells.forEach(function(w,S){if(v[p.R][S])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(S));v[p.R][S]=w}),v},[])}}function Uie(a,m){var u={"!ref":"A1"},f=a[qs(hn(m.data)[2][0].data)],m=bi(f[0].meta[1][0].data);if(m!=6001)throw new Error("6000 unexpected reference to ".concat(m));return function(v,S,w){var P=hn(S.data);if((S={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(bi(P[6][0].data)>>>0)-1,S.e.r<0)throw new Error("Invalid row varint ".concat(P[6][0].data));if(S.e.c=(bi(P[7][0].data)>>>0)-1,S.e.c<0)throw new Error("Invalid col varint ".concat(P[7][0].data));w["!ref"]=jr(S);var S=hn(P[4][0].data),b=OH(v,v[qs(S[4][0].data)][0]),T=(P=S[17])!=null&&P[0]?OH(v,v[qs(S[17][0].data)][0]):[],P=hn(S[3][0].data),M=0;if(P[1].forEach(function(j){var L=hn(j.data),j=v[qs(L[2][0].data)][0],L=bi(j.meta[1][0].data);if(L!=6002)throw new Error("6001 unexpected reference to ".concat(L));j=jie(0,j),j.data.forEach(function(Q,G){Q.forEach(function(W,J){J=Nr({r:M+G,c:J}),W=Wie(W,b,T),W&&(w[J]=W)})}),M+=j.nrows}),(P=S[13])!=null&&P[0]){if(P=v[qs(S[13][0].data)][0],S=bi(P.meta[1][0].data),S!=6144)throw new Error("Expected merge type 6144, found ".concat(S));w["!merges"]=(P=hn(P.data))==null?void 0:P[1].map(function(j){var L=hn(j.data),j=ih(hn(L[1][0].data)[1][0].data),L=ih(hn(L[2][0].data)[1][0].data);return{s:{r:j.getUint16(0,!0),c:j.getUint16(2,!0)},e:{r:j.getUint16(0,!0)+L.getUint16(0,!0)-1,c:j.getUint16(2,!0)+L.getUint16(2,!0)-1}}})}}(a,f[0],u),u}function zie(a,c){var u=BA(),f=hn(c.data);if((c=f[2])!=null&&c[0])throw new Error("Keynote presentations are not supported");if(IA(f[1],qs).forEach(function(m){a[m].forEach(function(v){var p,w,S,b;bi(v.meta[1][0].data)==2&&(w=a,v=hn((S=v).data),b={name:(S=v[1])!=null&&S[0]?OA(v[1][0].data):"",sheets:[]},IA(v[2],qs).forEach(function(T){w[T].forEach(function(P){bi(P.meta[1][0].data)==6e3&&b.sheets.push(Uie(w,P))})}),(p=b).sheets.forEach(function(T,P){VA(u,T,P==0?p.name:p.name+"_"+P,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function IH(a){var c={},u=[];if(a.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),a.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var v,p;try{v=ml(m.content)}catch(w){return console.log("?? "+m.content.length+" "+(w.message||w))}try{p=gl(v)}catch(w){return console.log("## "+(w.message||w))}p.forEach(function(w){c[w.id]=w.messages,u.push(w.id)})}}),!u.length)throw new Error("File has no messages");if((a=(a=(a=(a=c==null?void 0:c[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])!=null&&a[0].data&&bi(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var f=((a=(a=(a=(a=c==null?void 0:c[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])==null?void 0:a[0].data)&&bi(c[1][0].meta[1][0].data)==1&&c[1][0];if(f||u.forEach(function(m){c[m].forEach(function(v){if(bi(v.meta[1][0].data)>>>0==1){if(f)throw new Error("Document has multiple roots");f=v}})}),!f)throw new Error("Cannot find Document root");return zie(c,f)}function Gie(a,c){if(!c||!c.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=a.Sheets[a.SheetNames[0]];1<a.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var f=Ho(u["!ref"]);f.s.r=f.s.c=0;var m=!1;9<f.e.c&&(m=!0,f.e.c=9),49<f.e.r&&(m=!0,f.e.r=49),m&&console.error("The Numbers writer is currently limited to ".concat(jr(f)));var v=ZS(u,{range:f,header:1}),p=["~Sh33tJ5~"];v.forEach(function(Ot){return Ot.forEach(function(Pt){typeof Pt=="string"&&p.push(Pt)})});var w={},S=[],b=wr.read(c.numbers,{type:"base64"});b.FileIndex.map(function(Ot,Pt){return[Ot,b.FullPaths[Pt]]}).forEach(function(Ot){var Pt=Ot[0],_t=Ot[1];Pt.type==2&&Pt.name.match(/\.iwa/)&&gl(ml(Pt.content)).forEach(function(mt){S.push(mt.id),w[mt.id]={deps:[],location:_t,type:bi(mt.messages[0].meta[1][0].data)}})}),S.sort(function(Ot,Pt){return Ot-Pt});var T=S.filter(function(Ot){return 1<Ot}).map(function(Ot){return[Ot,bn(Ot)]});b.FileIndex.map(function(Ot,Pt){return[Ot,b.FullPaths[Pt]]}).forEach(function(Ot){var Pt=Ot[0];Ot[1],Pt.name.match(/\.iwa/)&&gl(ml(Pt.content)).forEach(function(_t){_t.messages.forEach(function(mt){T.forEach(function(Zt){_t.messages.some(function(or){return bi(or.meta[1][0].data)!=11006&&function(Cr,Gr){e:for(var Kt=0;Kt<=Cr.length-Gr.length;++Kt){for(var Ct=0;Ct<Gr.length;++Ct)if(Cr[Kt+Ct]!=Gr[Ct])continue e;return!0}return!1}(or.data,Zt[1])})&&w[Zt[0]].deps.push(_t.id)})})})});for(var P,M=wr.find(b,w[1].location),k=gl(ml(M.content)),j=0;j<k.length;++j){var L=k[j];L.id==1&&(P=L)}for(var Q=qs(hn(P.messages[0].data)[1][0].data),k=gl(ml((M=wr.find(b,w[Q].location)).content)),j=0;j<k.length;++j)(L=k[j]).id==Q&&(P=L);var ct=hn(P.messages[0].data);for(ct[1]=[{type:2,data:RH(a.SheetNames[0])}],P.messages[0].data=Ai(ct),M.content=r0(t0(k)),M.size=M.content.length,Q=qs(ct[2][0].data),k=gl(ml((M=wr.find(b,w[Q].location)).content)),j=0;j<k.length;++j)(L=k[j]).id==Q&&(P=L);for(Q=qs(hn(P.messages[0].data)[2][0].data),k=gl(ml((M=wr.find(b,w[Q].location)).content)),j=0;j<k.length;++j)(L=k[j]).id==Q&&(P=L);m=hn(P.messages[0].data),m[6][0].data=bn(f.e.r+1),m[7][0].data=bn(f.e.c+1);for(var G=qs(m[46][0].data),c=wr.find(b,w[G].location),W=gl(ml(c.content)),J=0;J<W.length&&W[J].id!=G;++J);if(W[J].id!=G)throw"Bad ColumnRowUIDMapArchive";var ne=hn(W[J].messages[0].data);ne[1]=[],ne[2]=[],ne[3]=[];for(var se=0;se<=f.e.c;++se)ne[1].push({type:2,data:Ai([[],[{type:0,data:bn(se+420690)}],[{type:0,data:bn(se+420690)}]])}),ne[2].push({type:0,data:bn(se)}),ne[3].push({type:0,data:bn(se)});ne[4]=[],ne[5]=[],ne[6]=[];for(var xe=0;xe<=f.e.r;++xe)ne[4].push({type:2,data:Ai([[],[{type:0,data:bn(xe+726270)}],[{type:0,data:bn(xe+726270)}]])}),ne[5].push({type:0,data:bn(xe)}),ne[6].push({type:0,data:bn(xe)});if(W[J].messages[0].data=Ai(ne),c.content=r0(t0(W)),c.size=c.content.length,delete m[46],a=hn(m[4][0].data),a[7][0].data=bn(f.e.r+1),ct=qs(hn(a[1][0].data)[2][0].data),(W=gl(ml((c=wr.find(b,w[ct].location)).content)))[0].id!=ct)throw"Bad HeaderStorageBucket";for(var He=hn(W[0].messages[0].data),xe=0;xe<v.length;++xe){var Fe=hn(He[2][0].data);Fe[1][0].data=bn(xe),Fe[4][0].data=bn(v[xe].length),He[2][xe]={type:He[2][0].type,data:Ai(Fe)}}W[0].messages[0].data=Ai(He),c.content=r0(t0(W)),c.size=c.content.length;var Ue,ct=qs(a[2][0].data);if((W=gl(ml((c=wr.find(b,w[ct].location)).content)))[0].id!=ct)throw"Bad HeaderStorageBucket";for(He=hn(W[0].messages[0].data),se=0;se<=f.e.c;++se)(Fe=hn(He[2][0].data))[1][0].data=bn(se),Fe[4][0].data=bn(f.e.r+1),He[2][se]={type:He[2][0].type,data:Ai(Fe)};W[0].messages[0].data=Ai(He),c.content=r0(t0(W)),c.size=c.content.length,u["!merges"]&&(Wt=function(Ot){for(var Pt=927262;Pt<2e6;++Pt)if(!w[Pt])return w[Pt]=Ot,Pt;throw new Error("Too many messages")}({type:6144,deps:[Q],location:w[Q].location}),Ue=[[],[]],u["!merges"].forEach(function(Ot){Ue[1].push({type:2,data:Ai([[],[{type:2,data:Ai([[],[{type:5,data:new Uint8Array(new Uint16Array([Ot.s.r,Ot.s.c]).buffer)}]])}],[{type:2,data:Ai([[],[{type:5,data:new Uint8Array(new Uint16Array([Ot.e.r-Ot.s.r+1,Ot.e.c-Ot.s.c+1]).buffer)}]])}]])})}),a[13]=[{type:2,data:Ai([[],[{type:0,data:bn(Wt)}]])}],k.push({id:Wt,messages:[(St=6144,Wt=Ai(Ue),{meta:[[],[{type:0,data:bn(St)}]],data:Wt})]}));var ut=qs(a[4][0].data);(function(){for(var Ot,Pt=wr.find(b,w[ut].location),_t=gl(ml(Pt.content)),mt=0;mt<_t.length;++mt){var Zt=_t[mt];Zt.id==ut&&(Ot=Zt)}var or=hn(Ot.messages[0].data);or[3]=[],p.forEach(function(Cr,Gr){or[3].push({type:2,data:Ai([[],[{type:0,data:bn(Gr)}],[{type:0,data:bn(1)}],[{type:2,data:RH(Cr)}]])})}),Ot.messages[0].data=Ai(or),Pt.content=r0(t0(_t)),Pt.size=Pt.content.length})();var Ke=hn(a[3][0].data),St=Ke[1][0];delete Ke[2];var St,Wt,Wt=hn(St.data),$t=qs(Wt[2][0].data);return function(){for(var Ot,Pt=wr.find(b,w[$t].location),_t=gl(ml(Pt.content)),mt=0;mt<_t.length;++mt){var Zt=_t[mt];Zt.id==$t&&(Ot=Zt)}var or=hn(Ot.messages[0].data);delete or[6],delete Ke[7];var Cr=new Uint8Array(or[5][0].data);or[5]=[];for(var Gr=0,Kt=0;Kt<=f.e.r;++Kt){var Ct=hn(Cr);Gr+=function(Dr,fn,rn){var In,Wi;if((In=Dr[6])==null||!In[0]||(Wi=Dr[7])==null||!Wi[0])throw"Mutation only works on post-BNC storages!";if((Wi=(Wi=Dr[8])==null?void 0:Wi[0])!=null&&Wi.data&&0<bi(Dr[8][0].data))throw"Math only works with normal offsets";for(var _e,Pn,Tn=0,xs=ih(Dr[7][0].data),vl=0,fe=[],Je=ih(Dr[4][0].data),be=0,ze=[],Se=0;Se<fn.length;++Se)if(fn[Se]!=null){switch(xs.setUint16(2*Se,vl,!0),Je.setUint16(2*Se,be,!0),typeof fn[Se]){case"string":_e=PA({t:"s",v:fn[Se]},rn),Pn=FA({t:"s",v:fn[Se]},rn);break;case"number":_e=PA({t:"n",v:fn[Se]},rn),Pn=FA({t:"n",v:fn[Se]},rn);break;case"boolean":_e=PA({t:"b",v:fn[Se]},rn),Pn=FA({t:"b",v:fn[Se]},rn);break;default:throw new Error("Unsupported value "+fn[Se])}fe.push(_e),vl+=_e.length,ze.push(Pn),be+=Pn.length,++Tn}else xs.setUint16(2*Se,65535,!0),Je.setUint16(2*Se,65535);for(Dr[2][0].data=bn(Tn);Se<Dr[7][0].data.length/2;++Se)xs.setUint16(2*Se,65535,!0),Je.setUint16(2*Se,65535,!0);return Dr[6][0].data=bf(fe),Dr[3][0].data=bf(ze),Tn}(Ct,v[Kt],p),Ct[1][0].data=bn(Kt),or[5].push({data:Ai(Ct),type:2})}or[1]=[{type:0,data:bn(f.e.c+1)}],or[2]=[{type:0,data:bn(f.e.r+1)}],or[3]=[{type:0,data:bn(Gr)}],or[4]=[{type:0,data:bn(f.e.r+1)}],Ot.messages[0].data=Ai(or),Pt.content=r0(t0(_t)),Pt.size=Pt.content.length}(),St.data=Ai(Wt),a[3][0].data=Ai(Ke),m[4][0].data=Ai(a),P.messages[0].data=Ai(m),M.content=r0(t0(k)),M.size=M.content.length,b}function PH(a){return function(c){for(var u=0;u!=a.length;++u){var f=a[u];c[f[0]]===void 0&&(c[f[0]]=f[1]),f[2]==="n"&&(c[f[0]]=Number(c[f[0]]))}}}function MA(a){PH([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(a)}function kA(a){PH([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function Yie(a,c){if(!a)return 0;try{a=c.map(function(u){return u.id||(u.id=u.strRelID),[u.name,a["!id"][u.id].Target,(u=a["!id"][u.id].Type,-1<zr.WS.indexOf(u)?"sheet":zr.CS&&u==zr.CS?"chart":zr.DS&&u==zr.DS?"dialog":zr.MS&&u==zr.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return a&&a.length!==0?a:null}function Kie(a,c,u,f,m,v,p,w,S,b,T,P){try{v[f]=Z1(Vr(a,u,!0),c);var M=_r(a,c);switch(w){case"sheet":L=die(M,c,m,S,v[f],b,T,P);break;case"chart":if(!(L=gie(M,c,m,S,v[f],b))||!L["!drawel"])break;var j=Na(L["!drawel"].Target,c),k=Q1(j),W=Na((W=Vr(a,j,!0),k=Z1(Vr(a,k,!0),j),W?(W=(W.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],k["!id"][W].Target):"??"),j),j=Q1(W),L=rie(Vr(a,W,!0),0,0,Z1(Vr(a,j,!0),W),0,L);break;case"macro":G=c,v[f],G.slice(-4),L={"!type":"macro"};break;case"dialog":G=c,v[f],G.slice(-4),L={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+w)}p[f]=L;var Q=[];v&&v[f]&&ii(v[f]).forEach(function(J){var ne,se,xe,He,Fe,Ue,ct="";if(v[f][J].Type==zr.CMNT){ct=Na(v[f][J].Target,c);var ut=vie(_r(a,ct,!0),ct,S);if(!ut||!ut.length)return;R8(L,ut,!1)}v[f][J].Type==zr.TCMNT&&(ct=Na(v[f][J].Target,c),Q=Q.concat((ne=_r(a,ct,!0),se=S,He=!(xe=[]),Fe={},Ue=0,ne.replace(go,function(Ke,St){var Wt=kr(Ke);switch(Uc(Wt[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Fe={author:Wt.personId,guid:Wt.id,ref:Wt.ref,T:1};break;case"</threadedComment>":Fe.t!=null&&xe.push(Fe);break;case"<text>":case"<text":Ue=St+Ke.length;break;case"</text>":Fe.t=ne.slice(Ue,St).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":He=!0;break;case"</mentions>":He=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":He=!0;break;case"</ext>":He=!1;break;default:if(!He&&se.WTF)throw new Error("unrecognized "+Wt[0]+" in threaded comments")}return Ke}),xe)))}),Q&&Q.length&&R8(L,Q,!0,S.people||[])}catch(J){if(S.WTF)throw J}var G,W}function pl(a){return a.charAt(0)=="/"?a.slice(1):a}function FH(a,c){if(li(),MA(c=c||{}),yt(a,"META-INF/manifest.xml")||yt(a,"objectdata.xml"))return xH(a,c);if(yt(a,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(a.FileIndex)return IH(a);var u=wr.utils.cfb_new();return mn(a).forEach(function(_t){Mr(u,_t,function(Zt,or,Cr){return dt(gr(Zt,or))}(a,_t))}),IH(u)}if(!yt(a,"[Content_Types].xml"))throw yt(a,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):yt(a,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var f,m,v=mn(a),p=function(_t){var mt=ZR();if(!_t||!_t.match)return mt;var Zt={};if((_t.match(go)||[]).forEach(function(or){var Cr=kr(or);switch(Cr[0].replace(zte,"<")){case"<?xml":break;case"<Types":mt.xmlns=Cr["xmlns"+(Cr[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":Zt[Cr.Extension]=Cr.ContentType;break;case"<Override":mt[QR[Cr.ContentType]]!==void 0&&mt[QR[Cr.ContentType]].push(Cr.PartName)}}),mt.xmlns!==bs.CT)throw new Error("Unknown Namespace: "+mt.xmlns);return mt.calcchain=0<mt.calcchains.length?mt.calcchains[0]:"",mt.sst=0<mt.strs.length?mt.strs[0]:"",mt.style=0<mt.styles.length?mt.styles[0]:"",mt.defaults=Zt,delete mt.calcchains,mt}(Vr(a,"[Content_Types].xml")),Fe=!1;if(p.workbooks.length===0&&_r(a,m="xl/workbook.xml",!0)&&p.workbooks.push(m),p.workbooks.length===0){if(!_r(a,m="xl/workbook.bin",!0))throw new Error("Could not find workbook");p.workbooks.push(m),Fe=!0}p.workbooks[0].slice(-3)=="bin"&&(Fe=!0);var w={},S={};if(!c.bookSheets&&!c.bookProps){if(fv=[],p.sst)try{fv=pie(_r(a,pl(p.sst)),p.sst,c)}catch(_t){if(c.WTF)throw _t}c.cellStyles&&p.themes.length&&(j=Vr(a,p.themes[0].replace(/^\//,""),!0)||"",p.themes[0],w=E8(j,c)),p.style&&(S=mie(_r(a,pl(p.style)),p.style,w,c))}p.links.map(function(_t){try{return Z1(Vr(a,Q1(pl(_t))),_t),yie(_r(a,pl(_t)),0,_t,c)}catch{}});var b,T,P,M=fie(_r(a,pl(p.workbooks[0])),p.workbooks[0],c),k={},j="";p.coreprops.length&&((j=_r(a,pl(p.coreprops[0]),!0))&&(k=U5(j)),p.extprops.length!==0&&(j=_r(a,pl(p.extprops[0]),!0))&&(L=c,P={},T=(T=k)||{},b=qn(b=j),Xd.forEach(function(_t){var mt=(b.match(z1(_t[0]))||[])[1];switch(_t[2]){case"string":mt&&(T[_t[1]]=Sn(mt));break;case"bool":T[_t[1]]=mt==="true";break;case"raw":var Zt=b.match(new RegExp("<"+_t[0]+"[^>]*>([\\s\\S]*?)</"+_t[0]+">"));Zt&&0<Zt.length&&(P[_t[1]]=Zt[1])}}),P.HeadingPairs&&P.TitlesOfParts&&Y5(P.HeadingPairs,P.TitlesOfParts,T,L)));var L={};c.bookSheets&&!c.bookProps||p.custprops.length!==0&&(j=Vr(a,pl(p.custprops[0]),!0))&&(L=function(_t,mt){var Zt={},or="",Cr=_t.match(dre);if(Cr)for(var Gr=0;Gr!=Cr.length;++Gr){var Kt=Cr[Gr],Ct=kr(Kt);switch(Ct[0]){case"<?xml":case"<Properties":break;case"<property":or=Sn(Ct.name);break;case"</property>":or=null;break;default:if(Kt.indexOf("<vt:")===0){var Dr=Kt.split(">"),fn=Dr[0].slice(4),rn=Dr[1];switch(fn){case"lpstr":case"bstr":case"lpwstr":Zt[or]=Sn(rn);break;case"bool":Zt[or]=hi(rn);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":Zt[or]=parseInt(rn,10);break;case"r4":case"r8":case"decimal":Zt[or]=parseFloat(rn);break;case"filetime":case"date":Zt[or]=ue(rn);break;case"cy":case"error":Zt[or]=Sn(rn);break;default:if(fn.slice(-1)=="/")break;mt.WTF&&typeof console<"u"&&console.warn("Unexpected",Kt,fn,Dr)}}else if(Kt.slice(0,2)!=="</"&&mt.WTF)throw new Error(Kt)}}return Zt}(j,c));var Q={};if((c.bookSheets||c.bookProps)&&(M.Sheets?f=M.Sheets.map(function(_t){return _t.name}):k.Worksheets&&0<k.SheetNames.length&&(f=k.SheetNames),c.bookProps&&(Q.Props=k,Q.Custprops=L),c.bookSheets&&f!==void 0&&(Q.SheetNames=f),c.bookSheets?Q.SheetNames:c.bookProps))return Q;f={},j={},c.bookDeps&&p.calcchain&&(j=wie(_r(a,pl(p.calcchain)),p.calcchain));var G,W,J=0,ne={},se=M.Sheets;k.Worksheets=se.length,k.SheetNames=[];for(var xe=0;xe!=se.length;++xe)k.SheetNames[xe]=se[xe].name;var He=Fe?"bin":"xml",Fe=p.workbooks[0].lastIndexOf("/"),Ue=(p.workbooks[0].slice(0,Fe+1)+"_rels/"+p.workbooks[0].slice(Fe+1)+".rels").replace(/^\//,"");yt(a,Ue)||(Ue="xl/_rels/workbook."+He+".rels");var ct,ut,Ke,St=Z1(Vr(a,Ue,!0),Ue.replace(/_rels.*/,"s5s"));1<=(p.metadata||[]).length&&(c.xlmeta=Cie(_r(a,pl(p.metadata[0])),p.metadata[0],c)),1<=(p.people||[]).length&&(c.people=(Fe=_r(a,pl(p.people[0])),ct=c,Ke=!(ut=[]),Fe.replace(go,function(_t){var mt=kr(_t);switch(Uc(mt[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":ut.push({name:mt.displayname,id:mt.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":Ke=!0;break;case"</ext>":Ke=!1;break;default:if(!Ke&&ct.WTF)throw new Error("unrecognized "+mt[0]+" in threaded comments")}return _t}),ut)),St=St&&Yie(St,M.Sheets);var Wt=_r(a,"xl/worksheets/sheet.xml",!0)?1:0;e:for(J=0;J!=k.Worksheets;++J){var $t="sheet";if(St&&St[J]?(G="xl/"+St[J][1].replace(/[\/]?xl\//,""),yt(a,G)||(G=St[J][1]),yt(a,G)||(G=Ue.replace(/_rels\/.*$/,"")+St[J][1]),$t=St[J][2]):G=(G="xl/worksheets/sheet"+(J+1-Wt)+"."+He).replace(/sheet0\./,"sheet."),W=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),c&&c.sheets!=null)switch(typeof c.sheets){case"number":if(J!=c.sheets)continue e;break;case"string":if(k.SheetNames[J].toLowerCase()!=c.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(c.sheets)){for(var Ot=!1,Pt=0;Pt!=c.sheets.length;++Pt)typeof c.sheets[Pt]=="number"&&c.sheets[Pt]==J&&(Ot=1),typeof c.sheets[Pt]=="string"&&c.sheets[Pt].toLowerCase()==k.SheetNames[J].toLowerCase()&&(Ot=1);if(!Ot)continue e}}Kie(a,G,W,k.SheetNames[J],J,ne,f,$t,c,M,w,S)}return Q={Directory:p,Workbook:M,Props:k,Custprops:L,Deps:j,Sheets:f,SheetNames:k.SheetNames,Strings:fv,Styles:S,Themes:w,SSF:Le(B)},c&&c.bookFiles&&(a.files?(Q.keys=v,Q.files=a.files):(Q.keys=[],Q.files={},a.FullPaths.forEach(function(_t,mt){_t=_t.replace(/^Root Entry[\/]/,""),Q.keys.push(_t),Q.files[_t]=a.FileIndex[mt]}))),c&&c.bookVBA&&(0<p.vba.length?Q.vbaraw=_r(a,pl(p.vba[0]),!0):p.defaults&&p.defaults.bin===mne&&(Q.vbaraw=_r(a,"xl/vbaProject.bin",!0))),Q}function Xie(a,c){var u,f=c||{},m="Workbook",v=wr.find(a,m);try{if(m="/!DataSpaces/Version",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(p=v.content,(u={}).id=p.read_shift(0,"lpp4"),u.R=nh(p,4),u.U=nh(p,4),u.W=nh(p,4),m="/!DataSpaces/DataSpaceMap",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);var p=Bre(v.content);if(p.length!==1||p[0].comps.length!==1||p[0].comps[0].t!==0||p[0].name!=="StrongEncryptionDataSpace"||p[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+m);if(m="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(p=function(w){var S=[];w.l+=4;for(var b=w.read_shift(4);0<b--;)S.push(w.read_shift(0,"lpp4"));return S}(v.content),p.length!=1||p[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+m);if(m="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);Vre(v.content)}catch{}if(m="/EncryptionInfo",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(c=Wre(v.content),m="/EncryptedPackage",!(v=wr.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],v.content,f.password||"",f);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],v.content,f.password||"",f);throw new Error("File is password-protected")}function qie(a,c){return(c.bookType=="ods"?_H:c.bookType=="numbers"?Gie:c.bookType=="xlsb"?function(u,f){dm=1024,u&&!u.SSF&&(u.SSF=Le(B)),u&&u.SSF&&(li(),Tr(u.SSF),f.revssf=Qu(u.SSF),f.revssf[u.SSF[65535]]=0,f.ssf=u.SSF),f.rels={},f.wbrels={},f.Strings=[],f.Strings.Count=0,f.Strings.Unique=0,dv?f.revStrings=new Map:(f.revStrings={},f.revStrings.foo=[],delete f.revStrings.foo);var m=f.bookType=="xlsb"?"bin":"xml",v=-1<O8.indexOf(f.bookType),p=ZR();kA(f=f||{});var w=ul(),S="",b=0;if(f.cellXfs=[],Sf(f.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),Mr(w,S="docProps/core.xml",z5(u.Props,f)),p.coreprops.push(S),Bn(f.rels,2,S,zr.CORE_PROPS),S="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var T=[],P=0;P<u.SheetNames.length;++P)(u.Workbook.Sheets[P]||{}).Hidden!=2&&T.push(u.SheetNames[P]);u.Props.SheetNames=T}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,Mr(w,S,K5(u.Props)),p.extprops.push(S),Bn(f.rels,3,S,zr.EXT_PROPS),u.Custprops!==u.Props&&0<ii(u.Custprops||{}).length&&(Mr(w,S="docProps/custom.xml",X5(u.Custprops)),p.custprops.push(S),Bn(f.rels,4,S,zr.CUST_PROPS)),b=1;b<=u.SheetNames.length;++b){var M,k,j,L={"!id":{}},Q=u.Sheets[u.SheetNames[b-1]];Mr(w,S="xl/worksheets/sheet"+b+"."+m,function(G,W,J,ne,se){return(W.slice(-4)===".bin"?tie:Z8)(G,J,ne,se)}(b-1,S,f,u,L)),p.sheets.push(S),Bn(f.wbrels,-1,"worksheets/sheet"+b+"."+m,zr.WS[0]),Q&&(M=Q["!comments"],k=!1,j="",M&&0<M.length&&(Mr(w,j="xl/comments"+b+"."+m,function(G,W,J){return(W.slice(-4)===".bin"?gne:A8)(G)}(M,j)),p.comments.push(j),Bn(L,-1,"../comments"+b+"."+m,zr.CMNT),k=!0),Q["!legacy"]&&k&&Mr(w,"xl/drawings/vmlDrawing"+b+".vml",_8(b,Q["!comments"])),delete Q["!comments"],delete Q["!legacy"]),L["!id"].rId1&&Mr(w,Q1(S),lm(L))}return f.Strings!=null&&0<f.Strings.length&&(Mr(w,S="xl/sharedStrings."+m,function(G,W,J){return(W.slice(-4)===".bin"?$re:i8)(G,J)}(f.Strings,S,f)),p.strs.push(S),Bn(f.wbrels,-1,"sharedStrings."+m,zr.SST)),Mr(w,S="xl/workbook."+m,function(G,W,J){return(W.slice(-4)===".bin"?hie:aH)(G)}(u,S)),p.workbooks.push(S),Bn(f.rels,1,S,zr.WB),Mr(w,S="xl/theme/theme1.xml",pA(u.Themes,f)),p.themes.push(S),Bn(f.wbrels,-1,"theme/theme1.xml",zr.THEME),Mr(w,S="xl/styles."+m,function(G,W,J){return(W.slice(-4)===".bin"?rne:C8)(G,J)}(u,S,f)),p.styles.push(S),Bn(f.wbrels,-1,"styles."+m,zr.STY),u.vbaraw&&v&&(Mr(w,S="xl/vbaProject.bin",u.vbaraw),p.vba.push(S),Bn(f.wbrels,-1,"vbaProject.bin",zr.VBA)),Mr(w,S="xl/metadata."+m,function(G){return(G.slice(-4)===".bin"?dne:T8)()}(S)),p.metadata.push(S),Bn(f.wbrels,-1,"metadata."+m,zr.XLMETA),Mr(w,"[Content_Types].xml",V5(p,f)),Mr(w,"_rels/.rels",lm(f.rels)),Mr(w,"xl/_rels/workbook."+m+".rels",lm(f.wbrels)),delete f.revssf,delete f.ssf,w}:MH)(a,c)}function MH(a,c){dm=1024,a&&!a.SSF&&(a.SSF=Le(B)),a&&a.SSF&&(li(),Tr(a.SSF),c.revssf=Qu(a.SSF),c.revssf[a.SSF[65535]]=0,c.ssf=a.SSF),c.rels={},c.wbrels={},c.Strings=[],c.Strings.Count=0,c.Strings.Unique=0,dv?c.revStrings=new Map:(c.revStrings={},c.revStrings.foo=[],delete c.revStrings.foo);var u="xml",f=-1<O8.indexOf(c.bookType),m=ZR();kA(c=c||{});var v=ul(),p="",w=0;if(c.cellXfs=[],Sf(c.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),p="docProps/core.xml",Mr(v,p,z5(a.Props,c)),m.coreprops.push(p),Bn(c.rels,2,p,zr.CORE_PROPS),p="docProps/app.xml",!a.Props||!a.Props.SheetNames)if(a.Workbook&&a.Workbook.Sheets){for(var S=[],b=0;b<a.SheetNames.length;++b)(a.Workbook.Sheets[b]||{}).Hidden!=2&&S.push(a.SheetNames[b]);a.Props.SheetNames=S}else a.Props.SheetNames=a.SheetNames;a.Props.Worksheets=a.Props.SheetNames.length,Mr(v,p,K5(a.Props)),m.extprops.push(p),Bn(c.rels,3,p,zr.EXT_PROPS),a.Custprops!==a.Props&&0<ii(a.Custprops||{}).length&&(Mr(v,p="docProps/custom.xml",X5(a.Custprops)),m.custprops.push(p),Bn(c.rels,4,p,zr.CUST_PROPS));var T,P=["SheetJ5"];for(c.tcid=0,w=1;w<=a.SheetNames.length;++w){var M,k,j,L,Q={"!id":{}},G=a.Sheets[a.SheetNames[w-1]];Mr(v,p="xl/worksheets/sheet"+w+"."+u,Z8(w-1,c,a,Q)),m.sheets.push(p),Bn(c.wbrels,-1,"worksheets/sheet"+w+"."+u,zr.WS[0]),G&&(k=!1,j="",(M=G["!comments"])&&0<M.length&&(L=!1,M.forEach(function(W){W[1].forEach(function(J){J.T==1&&(L=!0)})}),L&&(Mr(v,j="xl/threadedComments/threadedComment"+w+"."+u,function(W,J,ne){var se=[ui,Dt("ThreadedComments",null,{xmlns:bs.TCMNT}).replace(/[\/]>/,">")];return W.forEach(function(xe){var He="";(xe[1]||[]).forEach(function(Fe,Ue){var ct;Fe.T?(Fe.a&&J.indexOf(Fe.a)==-1&&J.push(Fe.a),ct={ref:xe[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+ne.tcid++).slice(-12)+"}"},Ue==0?He=ct.id:ct.parentId=He,Fe.ID=ct.id,Fe.a&&(ct.personId="{54EE7950-7262-4200-6969-"+("000000000000"+J.indexOf(Fe.a)).slice(-12)+"}"),se.push(Dt("threadedComment",Ks("text",Fe.t||""),ct))):delete Fe.ID})}),se.push("</ThreadedComments>"),se.join("")}(M,P,c)),m.threadedcomments.push(j),Bn(Q,-1,"../threadedComments/threadedComment"+w+"."+u,zr.TCMNT)),Mr(v,j="xl/comments"+w+"."+u,A8(M)),m.comments.push(j),Bn(Q,-1,"../comments"+w+"."+u,zr.CMNT),k=!0),G["!legacy"]&&k&&Mr(v,"xl/drawings/vmlDrawing"+w+".vml",_8(w,G["!comments"])),delete G["!comments"],delete G["!legacy"]),Q["!id"].rId1&&Mr(v,Q1(p),lm(Q))}return c.Strings!=null&&0<c.Strings.length&&(Mr(v,p="xl/sharedStrings.xml",i8(c.Strings,c)),m.strs.push(p),Bn(c.wbrels,-1,"sharedStrings.xml",zr.SST)),Mr(v,p="xl/workbook.xml",aH(a)),m.workbooks.push(p),Bn(c.rels,1,p,zr.WB),Mr(v,p="xl/theme/theme1.xml",pA(a.Themes,c)),m.themes.push(p),Bn(c.wbrels,-1,"theme/theme1.xml",zr.THEME),Mr(v,p="xl/styles.xml",C8(a,c)),m.styles.push(p),Bn(c.wbrels,-1,"styles.xml",zr.STY),a.vbaraw&&f&&(Mr(v,p="xl/vbaProject.bin",a.vbaraw),m.vba.push(p),Bn(c.wbrels,-1,"vbaProject.bin",zr.VBA)),Mr(v,p="xl/metadata.xml",T8()),m.metadata.push(p),Bn(c.wbrels,-1,"metadata.xml",zr.XLMETA),1<P.length&&(Mr(v,p="xl/persons/person.xml",(f=P,T=[ui,Dt("personList",null,{xmlns:bs.TCMNT,"xmlns:x":jd[0]}).replace(/[\/]>/,">")],f.forEach(function(W,J){T.push(Dt("person",null,{displayName:W,id:"{54EE7950-7262-4200-6969-"+("000000000000"+J).slice(-12)+"}",userId:W,providerId:"None"}))}),T.push("</personList>"),T.join(""))),m.people.push(p),Bn(c.wbrels,-1,"persons/person.xml",zr.PEOPLE)),Mr(v,"[Content_Types].xml",V5(m,c)),Mr(v,"_rels/.rels",lm(c.rels)),Mr(v,"xl/_rels/workbook.xml.rels",lm(c.wbrels)),delete c.revssf,delete c.ssf,v}function NA(a,c){var u="";switch((c||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":u=U(a.slice(0,12));break;case"binary":u=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(c&&c.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function kH(a,c){var u=0;e:for(;u<a.length;)switch(a.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return RA(a.slice(u),c);default:break e}return cm.to_workbook(a,c)}function DA(a,c,u,f){return f?(u.type="string",cm.to_workbook(a,u)):cm.to_workbook(c,u)}function qS(a,c){C();var u=c||{};if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer)return qS(new Uint8Array(a),((u=Le(u)).type="array",u));typeof Uint8Array<"u"&&a instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var f,m,v,p,w,S=a,b=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),mm={},u.dateNF&&(mm.dateNF=u.dateNF),u.type||(u.type=X&&Buffer.isBuffer(a)?"buffer":"base64"),u.type=="file"&&(u.type=X?"buffer":"binary",S=function(P){if(fo!==void 0)return fo.readFileSync(P);if(typeof Deno<"u")return Deno.readFileSync(P);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var M=File(P);M.open("r"),M.encoding="binary";var k=M.read();return M.close(),k}catch(j){if(!j.message||!j.message.match(/onstruct/))throw j}throw new Error("Cannot access file "+P)}(a),typeof Uint8Array>"u"||X||(u.type="array")),u.type=="string"&&(b=!0,u.type="binary",u.codepage=65001,S=(T=a).match(/[^\x00-\x7F]/)?zc(T):T),u.type=="array"&&typeof Uint8Array<"u"&&a instanceof Uint8Array&&typeof ArrayBuffer<"u"){var T=new ArrayBuffer(3),T=new Uint8Array(T);if(T.foo="bar",!T.foo)return(u=Le(u)).type="array",qS(Ee(S),u)}switch((f=NA(S,u))[0]){case 208:if(f[1]===207&&f[2]===17&&f[3]===224&&f[4]===161&&f[5]===177&&f[6]===26&&f[7]===225)return p=wr.read(S,u),w=u,(wr.find(p,"EncryptedPackage")?Xie:XS)(p,w);break;case 9:if(f[1]<=8)return XS(S,u);break;case 60:return RA(S,u);case 73:if(f[1]===73&&f[2]===42&&f[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(f[1]===68)return function(P,M){var k=M||{},j=!!k.WTF;k.WTF=!0;try{var L=NL.to_workbook(P,k);return k.WTF=j,L}catch(Q){if(k.WTF=j,!Q.message.match(/SYLK bad record ID/)&&j)throw Q;return cm.to_workbook(P,M)}}(S,u);break;case 84:if(f[1]===65&&f[2]===66&&f[3]===76)return LL.to_workbook(S,u);break;case 80:return f[1]===75&&f[2]<9&&f[3]<9?(v=w=S,(m=(m=u)||{}).type||(m.type=X&&Buffer.isBuffer(w)?"buffer":"base64"),FH(pf(v,m),m)):DA(a,S,u,b);case 239:return f[3]===60?RA(S,u):DA(a,S,u,b);case 255:if(f[1]===254)return v=S,(m=u).type=="base64"&&(v=U(v)),v=n.utils.decode(1200,v.slice(2),"str"),m.type="binary",kH(v,m);if(f[1]===0&&f[2]===2&&f[3]===0)return Zd.to_workbook(S,u);break;case 0:if(f[1]===0&&(2<=f[2]&&f[3]===0||f[2]===0&&(f[3]===8||f[3]===9)))return Zd.to_workbook(S,u);break;case 3:case 131:case 139:case 140:return iA.to_workbook(S,u);case 123:if(f[1]===92&&f[2]===114&&f[3]===116)return h8.to_workbook(S,u);break;case 10:case 13:case 32:return function(P,M){var k="",j=NA(P,M);switch(M.type){case"base64":k=U(P);break;case"binary":k=P;break;case"buffer":k=P.toString("binary");break;case"array":k=pe(P);break;default:throw new Error("Unrecognized type "+M.type)}return j[0]==239&&j[1]==187&&j[2]==191&&(k=qn(k)),M.type="binary",kH(k,M)}(S,u);case 137:if(f[1]===80&&f[2]===78&&f[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<Ere.indexOf(f[0])&&f[2]<=12&&f[3]<=31?iA.to_workbook(S,u):DA(a,S,u,b)}function NH(a,c){return c=c||{},c.type="file",qS(a,c)}function DH(a,c){switch(c.type){case"base64":case"binary":break;case"buffer":case"array":c.type="";break;case"file":return ua(c.file,wr.write(a,{type:X?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");default:throw new Error("Unrecognized type "+c.type)}return wr.write(a,c)}function LH(a,c){var u={},f=X?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(c.compression&&(u.compression="DEFLATE"),c.password)u.type=f;else switch(c.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");case"buffer":case"file":u.type=f;break;default:throw new Error("Unrecognized type "+c.type)}if(a=a.FullPaths?wr.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!c.compression}):a.generate(u),typeof Deno<"u"&&typeof a=="string"){if(c.type=="binary"||c.type=="base64")return a;a=new Uint8Array(de(a))}return c.password&&typeof encrypt_agile<"u"?DH(encrypt_agile(a,c.password),c):c.type==="file"?ua(c.file,a):c.type=="string"?qn(a):a}function qc(a,c,u){var f=(u=u||"")+a;switch(c.type){case"base64":return D(zc(f));case"binary":return zc(f);case"string":return a;case"file":return ua(c.file,f,"utf8");case"buffer":return X?te(f,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(f):qc(f,{type:"binary"}).split("").map(function(m){return m.charCodeAt(0)})}throw new Error("Unrecognized type "+c.type)}function JS(a,c){switch(c.type){case"string":case"base64":case"binary":for(var u="",f=0;f<a.length;++f)u+=String.fromCharCode(a[f]);return c.type=="base64"?D(u):c.type=="string"?qn(u):u;case"file":return ua(c.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+c.type)}}function LA(a,c){C(),oH(a);var u,f=Le(c||{});return f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),f.type!="array"?(u=a,c=Le((c=f)||{}),LH(MH(u,c),c)):(f.type="binary",a=LA(a,f),f.type="array",de(a))}function QS(a,c){C(),oH(a);var u=Le(c||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",c=QS(a,u),u.type="array",de(c);var f,m,v,p=0;if(u.sheet&&(p=typeof u.sheet=="number"?u.sheet:a.SheetNames.indexOf(u.sheet),!a.SheetNames[p]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return qc(_ie(a,u),u);case"slk":case"sylk":return qc(NL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"htm":case"html":return qc(vH(a.Sheets[a.SheetNames[p]],u),u);case"txt":return function(w,S){switch(S.type){case"base64":return D(w);case"binary":case"string":return w;case"file":return ua(S.file,w,"binary");case"buffer":return X?te(w,"binary"):w.split("").map(function(b){return b.charCodeAt(0)})}throw new Error("Unrecognized type "+S.type)}(WH(a.Sheets[a.SheetNames[p]],u),u);case"csv":return qc($A(a.Sheets[a.SheetNames[p]],u),u,"\uFEFF");case"dif":return qc(LL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"dbf":return JS(iA.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"prn":return qc(cm.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"rtf":return qc(h8.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"eth":return qc(WL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"fods":return qc(_H(a,u),u);case"wk1":return JS(Zd.sheet_to_wk1(a.Sheets[a.SheetNames[p]],u),u);case"wk3":return JS(Zd.book_to_wk3(a,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),JS(hH(a,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),DH(Iie(a,v=(v=u)||{}),v);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return f=a,v=Le((m=u)||{}),av=new Jie(m),LH(qie(f,v),v);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function HA(a){var c;a.bookType||((c=a.file.slice(a.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(a.bookType=c.slice(1)),a.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[a.bookType]||a.bookType)}function HH(a,c,u){return u=u||{},u.type="file",u.file=c,HA(u),QS(a,u)}function $H(a,c,u,f,m,v,p,w){var S=Vi(u),b=w.defval,T=w.raw||!Object.prototype.hasOwnProperty.call(w,"raw"),P=!0,M=m===1?[]:{};if(m!==1)if(Object.defineProperty)try{Object.defineProperty(M,"__rowNum__",{value:u,enumerable:!1})}catch{M.__rowNum__=u}else M.__rowNum__=u;if(!p||a[u])for(var k=c.s.c;k<=c.e.c;++k){var j=p?a[u][k]:a[f[k]+S];if(j!==void 0&&j.t!==void 0){var L=j.v;switch(j.t){case"z":if(L==null)break;continue;case"e":L=L==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+j.t)}if(v[k]!=null){if(L==null)if(j.t=="e"&&L===null)M[v[k]]=null;else if(b!==void 0)M[v[k]]=b;else{if(!T||L!==null)continue;M[v[k]]=null}else M[v[k]]=T&&(j.t!=="n"||j.t==="n"&&w.rawNumbers!==!1)?L:Gc(j,L,w);L!=null&&(P=!1)}}else b!==void 0&&v[k]!=null&&(M[v[k]]=b)}return{row:M,isempty:P}}function ZS(a,c){if(a==null||a["!ref"]==null)return[];var u,f={t:"n",v:0},m=0,v=1,p=[],w="",S={s:{r:0,c:0},e:{r:0,c:0}},b=c||{},T=b.range!=null?b.range:a["!ref"];switch(b.header===1?m=1:b.header==="A"?m=2:Array.isArray(b.header)?m=3:b.header==null&&(m=0),typeof T){case"string":S=un(T);break;case"number":(S=un(a["!ref"])).s.r=T;break;default:S=T}0<m&&(v=0);var P=Vi(S.s.r),M=[],k=[],j=0,L=0,Q=Array.isArray(a),G=S.s.r,W=0,J={};Q&&!a[G]&&(a[G]=[]);for(var ne,se=b.skipHidden&&a["!cols"]||[],xe=b.skipHidden&&a["!rows"]||[],W=S.s.c;W<=S.e.c;++W)if(!(se[W]||{}).hidden)switch(M[W]=fi(W),f=Q?a[G][W]:a[M[W]+P],m){case 1:p[W]=W-S.s.c;break;case 2:p[W]=M[W];break;case 3:p[W]=b.header[W-S.s.c];break;default:if(w=u=Gc(f=f??{w:"__EMPTY",t:"s"},null,b),L=J[u]||0){for(;w=u+"_"+L++,J[w];);J[u]=L,J[w]=1}else J[u]=1;p[W]=w}for(G=S.s.r+v;G<=S.e.r;++G)(xe[G]||{}).hidden||(ne=$H(a,S,G,M,m,p,Q,b)).isempty!==!1&&(m===1?b.blankrows===!1:!b.blankrows)||(k[j++]=ne.row);return k.length=j,k}var BH=/"/g;function VH(a,c,u,f,m,v,p,w){for(var S=!0,b=[],T="",P=Vi(u),M=c.s.c;M<=c.e.c;++M)if(f[M]){var k=w.dense?(a[u]||[])[M]:a[f[M]+P];if(k==null)T="";else if(k.v!=null){S=!1,T=""+(w.rawNumbers&&k.t=="n"?k.v:Gc(k,null,w));for(var j,L=0;L!==T.length;++L)if((j=T.charCodeAt(L))===m||j===v||j===34||w.forceQuotes){T='"'+T.replace(BH,'""')+'"';break}T=="ID"&&(T='"ID"')}else k.f==null||k.F?T="":(S=!1,0<=(T="="+k.f).indexOf(",")&&(T='"'+T.replace(BH,'""')+'"'));b.push(T)}return w.blankrows===!1&&S?null:b.join(p)}function $A(a,c){var u=[],f=c??{};if(a==null||a["!ref"]==null)return"";var m=un(a["!ref"]),v=f.FS!==void 0?f.FS:",",p=v.charCodeAt(0),w=f.RS!==void 0?f.RS:`
`,S=w.charCodeAt(0),b=new RegExp((v=="|"?"\\|":v)+"+$"),T="",P=[];f.dense=Array.isArray(a);for(var M=f.skipHidden&&a["!cols"]||[],k=f.skipHidden&&a["!rows"]||[],j=m.s.c;j<=m.e.c;++j)(M[j]||{}).hidden||(P[j]=fi(j));for(var L=0,Q=m.s.r;Q<=m.e.r;++Q)(k[Q]||{}).hidden||(T=VH(a,m,Q,P,p,S,v,f))!=null&&(!(T=f.strip?T.replace(b,""):T)&&f.blankrows===!1||u.push((L++?w:"")+T));return delete f.dense,u.join("")}function WH(a,c){return(c=c||{}).FS="	",c.RS=`
`,a=$A(a,c),n===void 0||c.type=="string"?a:(a=n.utils.encode(1200,a,"str"),""+a)}function jH(T,c,u){var f,m=u||{},v=+!m.skipHeader,p=T||{},w=0,S=0;m.origin!=null&&(typeof m.origin=="number"?w=m.origin:(b=typeof m.origin=="string"?Ri(m.origin):m.origin,w=b.r,S=b.c));var b,T={s:{c:0,r:0},e:{c:S,r:w+c.length-1+v}};p["!ref"]?(b=un(p["!ref"]),T.e.c=Math.max(T.e.c,b.e.c),T.e.r=Math.max(T.e.r,b.e.r),w==-1&&(w=b.e.r+1,T.e.r=w+c.length-1+v)):w==-1&&(w=0,T.e.r=c.length-1+v);var P=m.header||[],M=0;c.forEach(function(j,L){ii(j).forEach(function(ne){(M=P.indexOf(ne))==-1&&(P[M=P.length]=ne);var G=j[ne],W="z",J="",ne=Nr({c:S+M,r:w+L+v});f=eb(p,ne),!G||typeof G!="object"||G instanceof Date?(typeof G=="number"?W="n":typeof G=="boolean"?W="b":typeof G=="string"?W="s":G instanceof Date?(W="d",m.cellDates||(W="n",G=ci(G)),J=m.dateNF||B[14]):G===null&&m.nullError&&(W="e",G=0),f?(f.t=W,f.v=G,delete f.w,delete f.R,J&&(f.z=J)):p[ne]=f={t:W,v:G},J&&(f.z=J)):p[ne]=G})}),T.e.c=Math.max(T.e.c,S+P.length-1);var k=Vi(w);if(v)for(M=0;M<P.length;++M)p[fi(M+S)+k]={t:"s",v:P[M]};return p["!ref"]=jr(T),p}function eb(a,c,u){return typeof c!="string"?eb(a,Nr(typeof c!="number"?c:{r:c,c:u||0})):Array.isArray(a)?(u=Ri(c),a[u.r]||(a[u.r]=[]),a[u.r][u.c]||(a[u.r][u.c]={t:"z"})):a[c]||(a[c]={t:"z"})}function BA(){return{SheetNames:[],Sheets:{}}}function VA(a,c,u,f){var m=1;if(!u)for(;m<=65535&&a.SheetNames.indexOf(u="Sheet"+m)!=-1;++m,u=void 0);if(!u||65535<=a.SheetNames.length)throw new Error("Too many worksheets");if(f&&0<=a.SheetNames.indexOf(u)){var f=u.match(/(^.*?)(\d+)$/),m=f&&+f[2]||0,v=f&&f[1]||u;for(++m;m<=65535&&a.SheetNames.indexOf(u=v+m)!=-1;++m);}if(sH(u),0<=a.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return a.SheetNames.push(u),a.Sheets[u]=c,u}function UH(a,c,u){return c?(a.l={Target:c},u&&(a.l.Tooltip=u)):delete a.l,a}var tb,WA={encode_col:fi,encode_row:Vi,encode_cell:Nr,encode_range:jr,decode_col:jR,decode_row:WR,split_cell:function(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Ri,decode_range:Ho,format_cell:Gc,sheet_add_aoa:F5,sheet_add_json:jH,sheet_add_dom:wH,aoa_to_sheet:sm,json_to_sheet:function(a,c){return jH(null,a,c)},table_to_sheet:yH,table_to_book:function(a,c){return vf(yH(a,c),c)},sheet_to_csv:$A,sheet_to_txt:WH,sheet_to_json:ZS,sheet_to_html:vH,sheet_to_formulae:function(a){var c,u="",f="";if(a==null||a["!ref"]==null)return[];for(var m,v=un(a["!ref"]),p=[],w=[],S=Array.isArray(a),b=v.s.c;b<=v.e.c;++b)p[b]=fi(b);for(var T=v.s.r;T<=v.e.r;++T)for(m=Vi(T),b=v.s.c;b<=v.e.c;++b)if(u=p[b]+m,f="",(c=S?(a[T]||[])[b]:a[u])!==void 0){if(c.F!=null){if(u=c.F,!c.f)continue;f=c.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(c.f!=null)f=c.f;else{if(c.t=="z")continue;if(c.t=="n"&&c.v!=null)f=""+c.v;else if(c.t=="b")f=c.v?"TRUE":"FALSE";else if(c.w!==void 0)f="'"+c.w;else{if(c.v===void 0)continue;f=c.t=="s"?"'"+c.v:""+c.v}}w[w.length]=u+"="+f}return w},sheet_to_row_object_array:ZS,sheet_get_cell:eb,book_new:BA,book_append_sheet:VA,book_set_sheet_visibility:function(a,c,u){switch(a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]),c=function(f,m){if(typeof m=="number"){if(0<=m&&f.SheetNames.length>m)return m;throw new Error("Cannot find sheet # "+m)}if(typeof m!="string")throw new Error("Cannot find sheet |"+m+"|");if(-1<(f=f.SheetNames.indexOf(m)))return f;throw new Error("Cannot find sheet name |"+m+"|")}(a,c),a.Workbook.Sheets[c]||(a.Workbook.Sheets[c]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}a.Workbook.Sheets[c].Hidden=u},cell_set_number_format:function(a,c){return a.z=c,a},cell_set_hyperlink:UH,cell_set_internal_link:function(a,c,u){return UH(a,"#"+c,u)},cell_add_comment:function(a,c,u){a.c||(a.c=[]),a.c.push({t:c,a:u||"SheetJS"})},sheet_set_array_formula:function(a,c,u,f){for(var m=typeof c!="string"?c:un(c),v=typeof c=="string"?c:jr(c),p=m.s.r;p<=m.e.r;++p)for(var w=m.s.c;w<=m.e.c;++w){var S=eb(a,p,w);S.t="n",S.F=v,delete S.v,p==m.s.r&&w==m.s.c&&(S.f=u,f&&(S.D=!0))}return a},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function zH(a){tb=a}var vm={to_json:function(a,c){var u=tb({objectMode:!0});if(a==null||a["!ref"]==null)return u.push(null),u;var f,m={t:"n",v:0},v=0,p=1,w=[],S="",b={s:{r:0,c:0},e:{r:0,c:0}},T=c||{},P=T.range!=null?T.range:a["!ref"];switch(T.header===1?v=1:T.header==="A"?v=2:Array.isArray(T.header)&&(v=3),typeof P){case"string":b=un(P);break;case"number":(b=un(a["!ref"])).s.r=P;break;default:b=P}0<v&&(p=0);var M=Vi(b.s.r),k=[],j=0,L=Array.isArray(a),Q=b.s.r,G=0,W={};L&&!a[Q]&&(a[Q]=[]);for(var J=T.skipHidden&&a["!cols"]||[],ne=T.skipHidden&&a["!rows"]||[],G=b.s.c;G<=b.e.c;++G)if(!(J[G]||{}).hidden)switch(k[G]=fi(G),m=L?a[Q][G]:a[k[G]+M],v){case 1:w[G]=G-b.s.c;break;case 2:w[G]=k[G];break;case 3:w[G]=T.header[G-b.s.c];break;default:if(S=f=Gc(m=m??{w:"__EMPTY",t:"s"},null,T),j=W[f]||0){for(;S=f+"_"+j++,W[S];);W[f]=j,W[S]=1}else W[f]=1;w[G]=S}return Q=b.s.r+p,u._read=function(){for(;Q<=b.e.r;)if(!(ne[Q-1]||{}).hidden){var se=$H(a,b,Q,k,v,w,L,T);if(++Q,se.isempty===!1||(v===1?T.blankrows!==!1:T.blankrows))return void u.push(se.row)}return u.push(null)},u},to_html:function(a,m){var u=tb(),f=m||{},m=f.header!=null?f.header:gH,v=f.footer!=null?f.footer:mH;u.push(m);var p=Ho(a["!ref"]);f.dense=Array.isArray(a),u.push(pH(0,0,f));var w=p.s.r,S=!1;return u._read=function(){if(w>p.e.r)return S||(S=!0,u.push("</table>"+v)),u.push(null);for(;w<=p.e.r;){u.push(dH(a,p,w,f)),++w;break}},u},to_csv:function(a,c){var u=tb(),f=c??{};if(a==null||a["!ref"]==null)return u.push(null),u;var m=un(a["!ref"]),v=f.FS!==void 0?f.FS:",",p=v.charCodeAt(0),w=f.RS!==void 0?f.RS:`
`,S=w.charCodeAt(0),b=new RegExp((v=="|"?"\\|":v)+"+$"),T="",P=[];f.dense=Array.isArray(a);for(var M=f.skipHidden&&a["!cols"]||[],k=f.skipHidden&&a["!rows"]||[],j=m.s.c;j<=m.e.c;++j)(M[j]||{}).hidden||(P[j]=fi(j));var L=m.s.r,Q=!1,G=0;return u._read=function(){if(!Q)return Q=!0,u.push("\uFEFF");for(;L<=m.e.r;)if(++L,!(k[L-1]||{}).hidden&&(T=VH(a,m,L-1,P,p,S,v,f),T!=null&&((T=f.strip?T.replace(b,""):T)||f.blankrows!==!1)))return u.push((G++?w:"")+T);return u.push(null)},u},set_readable:zH},pn=function(){function a(c,u,f){return this instanceof a?(this.tagName=c,this._attributes=u||{},this._children=f||[],this._prefix="",this):new a(c,u,f)}return a.prototype.createElement=function(){return new a(arguments)},a.prototype.children=function(){return this._children},a.prototype.append=function(c){return this._children.push(c),this},a.prototype.prefix=function(c){return arguments.length==0?this._prefix:(this._prefix=c,this)},a.prototype.attr=function(c,u){if(u==null)return delete this._attributes[c],this;if(arguments.length==0)return this._attributes;if(typeof c=="string"&&arguments.length==1)return this._attributes.attr[c];if(typeof c=="object"&&arguments.length==1)for(var f in c)this._attributes[f]=c[f];else arguments.length==2&&typeof c=="string"&&(this._attributes[c]=u);return this},a.prototype.escapeAttributeValue=function(c){return'"'+c.replace(/\"/g,"&quot;")+'"'},a.prototype.toXml=function(c){var u=(c=c||this)._prefix;if(u+="<"+c.tagName,c._attributes)for(var f in c._attributes)u+=" "+f+"="+this.escapeAttributeValue(""+c._attributes[f]);if(c._children&&0<c._children.length){u+=">";for(var m=0;m<c._children.length;m++)u+=this.toXml(c._children[m]);u+="</"+c.tagName+">"}else u+="/>";return u},a}(),Jie=function(a){var c,u=164,f={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},m={};for(c in f)m[f[c]]=c;var v={};return{initialize:function(p){this.$fonts=pn("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=pn("fills").attr("count",0),this.$borders=pn("borders").attr("count",0),this.$numFmts=pn("numFmts").attr("count",0),this.$cellStyleXfs=pn("cellStyleXfs"),this.$xf=pn("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=pn("cellXfs").attr("count",0),this.$cellStyles=pn("cellStyles").append(pn("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=pn("dxfs").attr("count","0"),this.$tableStyles=pn("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=pn("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var w=p.defaultCellStyle||{};return w.font||(w.font={name:"Calibri",sz:"11"}),w.font.name||(w.font.name="Calibri"),w.font.sz||(w.font.sz=11),w.fill||(w.fill={patternType:"none",fgColor:{}}),w.border||(w.border={}),w.numFmt||(w.numFmt=0),this.defaultStyle=w,p=JSON.parse(JSON.stringify(w)),p.fill={patternType:"gray125",fgColor:{}},this.addStyles([w,p]),this},addStyle:function(p){var w=JSON.stringify(p),S=v[w];return S==null?(S=this._addXf(p),v[w]=S):S=v[w],S},addStyles:function(p){var w=this;return p.map(function(S){return w.addStyle(S)})},_duckTypeStyle:function(p){return typeof p=="object"&&(p.patternFill||p.fgColor)?{fill:p}:p.font||p.numFmt||p.border||p.fill?p:this._getStyleCSS(p)},_getStyleCSS:function(p){return p},_addXf:function(p){var w=this._addFont(p.font),S=this._addFill(p.fill),b=this._addBorder(p.border),T=this._addNumFmt(p.numFmt),P=pn("xf").attr("numFmtId",T).attr("fontId",w).attr("fillId",S).attr("borderId",b).attr("xfId","0");return 0<w&&P.attr("applyFont","1"),0<S&&P.attr("applyFill","1"),0<b&&P.attr("applyBorder","1"),0<T&&P.attr("applyNumberFormat","1"),p.alignment&&(T=pn("alignment"),p.alignment.horizontal&&T.attr("horizontal",p.alignment.horizontal),p.alignment.vertical&&T.attr("vertical",p.alignment.vertical),p.alignment.indent&&T.attr("indent",p.alignment.indent),p.alignment.readingOrder&&T.attr("readingOrder",p.alignment.readingOrder),p.alignment.wrapText&&T.attr("wrapText",p.alignment.wrapText),p.alignment.textRotation!=null&&T.attr("textRotation",p.alignment.textRotation),P.append(T).attr("applyAlignment",1)),this.$cellXfs.append(P),P=+this.$cellXfs.children().length,this.$cellXfs.attr("count",P),P-1},_addFont:function(p){if(!p)return 0;var w=pn("font").append(pn("sz").attr("val",p.sz||this.defaultStyle.font.sz)).append(pn("name").attr("val",p.name||this.defaultStyle.font.name));return p.bold&&w.append(pn("b")),p.underline&&w.append(pn("u")),p.italic&&w.append(pn("i")),p.strike&&w.append(pn("strike")),p.outline&&w.append(pn("outline")),p.shadow&&w.append(pn("shadow")),p.vertAlign&&w.append(pn("vertAlign").attr("val",p.vertAlign)),p.color&&(p.color.theme?(w.append(pn("color").attr("theme",p.color.theme)),p.color.tint&&w.append(pn("tint").attr("theme",p.color.tint))):p.color.rgb&&w.append(pn("color").attr("rgb",p.color.rgb))),this.$fonts.append(w),w=this.$fonts.children().length,this.$fonts.attr("count",w),w-1},_addNumFmt:function(p){if(!p)return 0;if(typeof p=="string"){var w=m[p];if(0<=w)return w}return/^[0-9]+$/.exec(p)?p:(p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),p=pn("numFmt").attr("numFmtId",++u).attr("formatCode",p),this.$numFmts.append(p),p=this.$numFmts.children().length,this.$numFmts.attr("count",p),u)},_addFill:function(p){if(!p)return 0;var w,S=pn("patternFill").attr("patternType",p.patternType||"solid");return p.fgColor&&(w=pn("fgColor"),p.fgColor.rgb?(p.fgColor.rgb.length==6&&(p.fgColor.rgb="FF"+p.fgColor.rgb),w.attr("rgb",p.fgColor.rgb),S.append(w)):p.fgColor.theme&&(w.attr("theme",p.fgColor.theme),p.fgColor.tint&&w.attr("tint",p.fgColor.tint),S.append(w)),p.bgColor||(p.bgColor={indexed:"64"})),p.bgColor&&(p=pn("bgColor").attr(p.bgColor),S.append(p)),S=pn("fill").append(S),this.$fills.append(S),S=this.$fills.children().length,this.$fills.attr("count",S),S-1},_getSubBorder:function(p,w){var S=pn(p);return w&&(S.attr("style",w.style||"medium"),w.color&&(p=pn("color"),w.color.auto?p.attr("auto",w.color.auto):w.color.rgb?p.attr("rgb",w.color.rgb):(w.color.theme||w.color.tint)&&(p.attr("theme",w.color.theme||"1"),p.attr("tint",w.color.tint||"0")),S.append(p))),S},_addBorder:function(p){if(!p)return 0;var w=this,S=pn("border").attr("diagonalUp",p.diagonalUp).attr("diagonalDown",p.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(T){S.append(w._getSubBorder(T,p[T]))}),this.$borders.append(S);var b=this.$borders.children().length;return this.$borders.attr("count",b),b-1},toXml:function(){return this.$styles.toXml()}}.initialize(a||{})};XS!==void 0&&(s.parse_xlscfb=XS),s.parse_zip=FH,s.read=qS,s.readFile=NH,s.readFileSync=NH,s.write=QS,s.writeFile=HH,s.writeFileSync=HH,s.writeFileAsync=function(a,c,u,f){var m=u||{};return m.type="file",m.file=a,HA(m),m.type="buffer",f instanceof Function||(f=u),fo.writeFile(a,QS(c,m),f)},s.utils=WA,s.writeXLSX=LA,s.writeFileXLSX=function(a,c,u){return(u=u||{}).type="file",u.file=c,HA(u),LA(a,u)},s.SSF=ho,vm!==void 0&&(s.stream=vm),wr!==void 0&&(s.CFB=wr),typeof O2>"u"||((vm=v4)||{}).Readable&&zH(vm.Readable)}if(i(e),typeof window<"u"&&!window.XLSX)try{window.XLSX=r}catch{}})(bP,bP.exports);var wce=bP.exports;const Ef=qF(wce);var Rv=function(t){return t&&t.Math===Math&&t},Fs=Rv(typeof globalThis=="object"&&globalThis)||Rv(typeof window=="object"&&window)||Rv(typeof self=="object"&&self)||Rv(typeof kw=="object"&&kw)||Rv(typeof kw=="object"&&kw)||function(){return this}()||Function("return this")(),KM={},co=function(t){try{return!!t()}catch{return!0}},yce=co,Ul=!yce(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Cce=co,v_=!Cce(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Sce=v_,yb=Function.prototype.call,Lo=Sce?yb.bind(yb):function(){return yb.apply(yb,arguments)},gY={},mY={}.propertyIsEnumerable,pY=Object.getOwnPropertyDescriptor,bce=pY&&!mY.call({1:2},1);gY.f=bce?function(e){var r=pY(this,e);return!!r&&r.enumerable}:mY;var w_=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},vY=v_,wY=Function.prototype,xP=wY.call,xce=vY&&wY.bind.bind(xP,xP),ss=vY?xce:function(t){return function(){return xP.apply(t,arguments)}},yY=ss,Ece=yY({}.toString),Tce=yY("".slice),Wg=function(t){return Tce(Ece(t),8,-1)},_ce=ss,Rce=co,Ace=Wg,w4=Object,Oce=_ce("".split),Ice=Rce(function(){return!w4("z").propertyIsEnumerable(0)})?function(t){return Ace(t)==="String"?Oce(t,""):w4(t)}:w4,y_=function(t){return t==null},Pce=y_,Fce=TypeError,DC=function(t){if(Pce(t))throw new Fce("Can't call method on "+t);return t},Mce=Ice,kce=DC,LC=function(t){return Mce(kce(t))},y4=typeof document=="object"&&document.all,ys=typeof y4>"u"&&y4!==void 0?function(t){return typeof t=="function"||t===y4}:function(t){return typeof t=="function"},Nce=ys,Lc=function(t){return typeof t=="object"?t!==null:Nce(t)},C4=Fs,Dce=ys,Lce=function(t){return Dce(t)?t:void 0},b1=function(t,e){return arguments.length<2?Lce(C4[t]):C4[t]&&C4[t][e]},Hce=ss,HC=Hce({}.isPrototypeOf),$ce=Fs,m$=$ce.navigator,p$=m$&&m$.userAgent,C_=p$?String(p$):"",CY=Fs,S4=C_,v$=CY.process,w$=CY.Deno,y$=v$&&v$.versions||w$&&w$.version,C$=y$&&y$.v8,xc,FE;C$&&(xc=C$.split("."),FE=xc[0]>0&&xc[0]<4?1:+(xc[0]+xc[1]));!FE&&S4&&(xc=S4.match(/Edge\/(\d+)/),(!xc||xc[1]>=74)&&(xc=S4.match(/Chrome\/(\d+)/),xc&&(FE=+xc[1])));var Bce=FE,S$=Bce,Vce=co,Wce=Fs,jce=Wce.String,XM=!!Object.getOwnPropertySymbols&&!Vce(function(){var t=Symbol("symbol detection");return!jce(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&S$&&S$<41}),Uce=XM,SY=Uce&&!Symbol.sham&&typeof Symbol.iterator=="symbol",zce=b1,Gce=ys,Yce=HC,Kce=SY,Xce=Object,qM=Kce?function(t){return typeof t=="symbol"}:function(t){var e=zce("Symbol");return Gce(e)&&Yce(e.prototype,Xce(t))},qce=String,S_=function(t){try{return qce(t)}catch{return"Object"}},Jce=ys,Qce=S_,Zce=TypeError,ka=function(t){if(Jce(t))return t;throw new Zce(Qce(t)+" is not a function")},eue=ka,tue=y_,$C=function(t,e){var r=t[e];return tue(r)?void 0:eue(r)},b4=Lo,x4=ys,E4=Lc,rue=TypeError,nue=function(t,e){var r,i;if(e==="string"&&x4(r=t.toString)&&!E4(i=b4(r,t))||x4(r=t.valueOf)&&!E4(i=b4(r,t))||e!=="string"&&x4(r=t.toString)&&!E4(i=b4(r,t)))return i;throw new rue("Can't convert object to primitive value")},bY={exports:{}},JM=!1,b$=Fs,iue=Object.defineProperty,QM=function(t,e){try{iue(b$,t,{value:e,configurable:!0,writable:!0})}catch{b$[t]=e}return e},sue=Fs,oue=QM,x$="__core-js_shared__",E$=bY.exports=sue[x$]||oue(x$,{});(E$.versions||(E$.versions=[])).push({version:"3.39.0",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var ZM=bY.exports,T$=ZM,xY=function(t,e){return T$[t]||(T$[t]=e||{})},aue=DC,lue=Object,x1=function(t){return lue(aue(t))},cue=ss,uue=x1,hue=cue({}.hasOwnProperty),zl=Object.hasOwn||function(e,r){return hue(uue(e),r)},fue=ss,due=0,gue=Math.random(),mue=fue(1 .toString),EY=function(t){return"Symbol("+(t===void 0?"":t)+")_"+mue(++due+gue,36)},pue=Fs,vue=xY,_$=zl,wue=EY,yue=XM,Cue=SY,Rp=pue.Symbol,T4=vue("wks"),Sue=Cue?Rp.for||Rp:Rp&&Rp.withoutSetter||wue,Hc=function(t){return _$(T4,t)||(T4[t]=yue&&_$(Rp,t)?Rp[t]:Sue("Symbol."+t)),T4[t]},bue=Lo,R$=Lc,A$=qM,xue=$C,Eue=nue,Tue=Hc,_ue=TypeError,Rue=Tue("toPrimitive"),Aue=function(t,e){if(!R$(t)||A$(t))return t;var r=xue(t,Rue),i;if(r){if(e===void 0&&(e="default"),i=bue(r,t,e),!R$(i)||A$(i))return i;throw new _ue("Can't convert object to primitive value")}return e===void 0&&(e="number"),Eue(t,e)},Oue=Aue,Iue=qM,TY=function(t){var e=Oue(t,"string");return Iue(e)?e:e+""},Pue=Fs,O$=Lc,EP=Pue.document,Fue=O$(EP)&&O$(EP.createElement),ek=function(t){return Fue?EP.createElement(t):{}},Mue=Ul,kue=co,Nue=ek,_Y=!Mue&&!kue(function(){return Object.defineProperty(Nue("div"),"a",{get:function(){return 7}}).a!==7}),Due=Ul,Lue=Lo,Hue=gY,$ue=w_,Bue=LC,Vue=TY,Wue=zl,jue=_Y,I$=Object.getOwnPropertyDescriptor;KM.f=Due?I$:function(e,r){if(e=Bue(e),r=Vue(r),jue)try{return I$(e,r)}catch{}if(Wue(e,r))return $ue(!Lue(Hue.f,e,r),e[r])};var af={},Uue=Ul,zue=co,RY=Uue&&zue(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Gue=Lc,Yue=String,Kue=TypeError,Cs=function(t){if(Gue(t))return t;throw new Kue(Yue(t)+" is not an object")},Xue=Ul,que=_Y,Jue=RY,Cb=Cs,P$=TY,Que=TypeError,_4=Object.defineProperty,Zue=Object.getOwnPropertyDescriptor,R4="enumerable",A4="configurable",O4="writable";af.f=Xue?Jue?function(e,r,i){if(Cb(e),r=P$(r),Cb(i),typeof e=="function"&&r==="prototype"&&"value"in i&&O4 in i&&!i[O4]){var s=Zue(e,r);s&&s[O4]&&(e[r]=i.value,i={configurable:A4 in i?i[A4]:s[A4],enumerable:R4 in i?i[R4]:s[R4],writable:!1})}return _4(e,r,i)}:_4:function(e,r,i){if(Cb(e),r=P$(r),Cb(i),que)try{return _4(e,r,i)}catch{}if("get"in i||"set"in i)throw new Que("Accessors not supported");return"value"in i&&(e[r]=i.value),e};var ehe=Ul,the=af,rhe=w_,E1=ehe?function(t,e,r){return the.f(t,e,rhe(1,r))}:function(t,e,r){return t[e]=r,t},AY={exports:{}},TP=Ul,nhe=zl,OY=Function.prototype,ihe=TP&&Object.getOwnPropertyDescriptor,tk=nhe(OY,"name"),she=tk&&(function(){}).name==="something",ohe=tk&&(!TP||TP&&ihe(OY,"name").configurable),ahe={EXISTS:tk,PROPER:she,CONFIGURABLE:ohe},lhe=ss,che=ys,_P=ZM,uhe=lhe(Function.toString);che(_P.inspectSource)||(_P.inspectSource=function(t){return uhe(t)});var hhe=_P.inspectSource,fhe=Fs,dhe=ys,F$=fhe.WeakMap,ghe=dhe(F$)&&/native code/.test(String(F$)),mhe=xY,phe=EY,M$=mhe("keys"),rk=function(t){return M$[t]||(M$[t]=phe(t))},nk={},vhe=ghe,IY=Fs,whe=Lc,yhe=E1,I4=zl,P4=ZM,Che=rk,She=nk,k$="Object already initialized",RP=IY.TypeError,bhe=IY.WeakMap,ME,qy,kE,xhe=function(t){return kE(t)?qy(t):ME(t,{})},Ehe=function(t){return function(e){var r;if(!whe(e)||(r=qy(e)).type!==t)throw new RP("Incompatible receiver, "+t+" required");return r}};if(vhe||P4.state){var Qc=P4.state||(P4.state=new bhe);Qc.get=Qc.get,Qc.has=Qc.has,Qc.set=Qc.set,ME=function(t,e){if(Qc.has(t))throw new RP(k$);return e.facade=t,Qc.set(t,e),e},qy=function(t){return Qc.get(t)||{}},kE=function(t){return Qc.has(t)}}else{var ym=Che("state");She[ym]=!0,ME=function(t,e){if(I4(t,ym))throw new RP(k$);return e.facade=t,yhe(t,ym,e),e},qy=function(t){return I4(t,ym)?t[ym]:{}},kE=function(t){return I4(t,ym)}}var PY={set:ME,get:qy,has:kE,enforce:xhe,getterFor:Ehe},ik=ss,The=co,_he=ys,Sb=zl,AP=Ul,Rhe=ahe.CONFIGURABLE,Ahe=hhe,FY=PY,Ohe=FY.enforce,Ihe=FY.get,N$=String,I2=Object.defineProperty,Phe=ik("".slice),Fhe=ik("".replace),Mhe=ik([].join),khe=AP&&!The(function(){return I2(function(){},"length",{value:8}).length!==8}),Nhe=String(String).split("String"),Dhe=AY.exports=function(t,e,r){Phe(N$(e),0,7)==="Symbol("&&(e="["+Fhe(N$(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Sb(t,"name")||Rhe&&t.name!==e)&&(AP?I2(t,"name",{value:e,configurable:!0}):t.name=e),khe&&r&&Sb(r,"arity")&&t.length!==r.arity&&I2(t,"length",{value:r.arity});try{r&&Sb(r,"constructor")&&r.constructor?AP&&I2(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=Ohe(t);return Sb(i,"source")||(i.source=Mhe(Nhe,typeof e=="string"?e:"")),t};Function.prototype.toString=Dhe(function(){return _he(this)&&Ihe(this).source||Ahe(this)},"toString");var MY=AY.exports,Lhe=ys,Hhe=af,$he=MY,Bhe=QM,sk=function(t,e,r,i){i||(i={});var s=i.enumerable,n=i.name!==void 0?i.name:e;if(Lhe(r)&&$he(r,n,i),i.global)s?t[e]=r:Bhe(e,r);else{try{i.unsafe?t[e]&&(s=!0):delete t[e]}catch{}s?t[e]=r:Hhe.f(t,e,{value:r,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},kY={},Vhe=Math.ceil,Whe=Math.floor,jhe=Math.trunc||function(e){var r=+e;return(r>0?Whe:Vhe)(r)},Uhe=jhe,BC=function(t){var e=+t;return e!==e||e===0?0:Uhe(e)},zhe=BC,Ghe=Math.max,Yhe=Math.min,Khe=function(t,e){var r=zhe(t);return r<0?Ghe(r+e,0):Yhe(r,e)},Xhe=BC,qhe=Math.min,Jhe=function(t){var e=Xhe(t);return e>0?qhe(e,9007199254740991):0},Qhe=Jhe,T1=function(t){return Qhe(t.length)},Zhe=LC,efe=Khe,tfe=T1,D$=function(t){return function(e,r,i){var s=Zhe(e),n=tfe(s);if(n===0)return!t&&-1;var o=efe(i,n),l;if(t&&r!==r){for(;n>o;)if(l=s[o++],l!==l)return!0}else for(;n>o;o++)if((t||o in s)&&s[o]===r)return t||o||0;return!t&&-1}},rfe={includes:D$(!0),indexOf:D$(!1)},nfe=ss,F4=zl,ife=LC,sfe=rfe.indexOf,ofe=nk,L$=nfe([].push),NY=function(t,e){var r=ife(t),i=0,s=[],n;for(n in r)!F4(ofe,n)&&F4(r,n)&&L$(s,n);for(;e.length>i;)F4(r,n=e[i++])&&(~sfe(s,n)||L$(s,n));return s},ok=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],afe=NY,lfe=ok,cfe=lfe.concat("length","prototype");kY.f=Object.getOwnPropertyNames||function(e){return afe(e,cfe)};var DY={};DY.f=Object.getOwnPropertySymbols;var ufe=b1,hfe=ss,ffe=kY,dfe=DY,gfe=Cs,mfe=hfe([].concat),pfe=ufe("Reflect","ownKeys")||function(e){var r=ffe.f(gfe(e)),i=dfe.f;return i?mfe(r,i(e)):r},H$=zl,vfe=pfe,wfe=KM,yfe=af,LY=function(t,e,r){for(var i=vfe(e),s=yfe.f,n=wfe.f,o=0;o<i.length;o++){var l=i[o];!H$(t,l)&&!(r&&H$(r,l))&&s(t,l,n(e,l))}},Cfe=co,Sfe=ys,bfe=/#|\.prototype\./,VC=function(t,e){var r=Efe[xfe(t)];return r===_fe?!0:r===Tfe?!1:Sfe(e)?Cfe(e):!!e},xfe=VC.normalize=function(t){return String(t).replace(bfe,".").toLowerCase()},Efe=VC.data={},Tfe=VC.NATIVE="N",_fe=VC.POLYFILL="P",Rfe=VC,bb=Fs,Afe=KM.f,Ofe=E1,Ife=sk,Pfe=QM,Ffe=LY,Mfe=Rfe,ni=function(t,e){var r=t.target,i=t.global,s=t.stat,n,o,l,h,d,g;if(i?o=bb:s?o=bb[r]||Pfe(r,{}):o=bb[r]&&bb[r].prototype,o)for(l in e){if(d=e[l],t.dontCallGetSet?(g=Afe(o,l),h=g&&g.value):h=o[l],n=Mfe(i?l:r+(s?".":"#")+l,t.forced),!n&&h!==void 0){if(typeof d==typeof h)continue;Ffe(d,h)}(t.sham||h&&h.sham)&&Ofe(d,"sham",!0),Ife(o,l,d,t)}},kfe=v_,HY=Function.prototype,$$=HY.apply,B$=HY.call,b_=typeof Reflect=="object"&&Reflect.apply||(kfe?B$.bind($$):function(){return B$.apply($$,arguments)}),Nfe=ss,Dfe=ka,$Y=function(t,e,r){try{return Nfe(Dfe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},Lfe=Lc,Hfe=function(t){return Lfe(t)||t===null},$fe=Hfe,Bfe=String,Vfe=TypeError,Wfe=function(t){if($fe(t))return t;throw new Vfe("Can't set "+Bfe(t)+" as a prototype")},jfe=$Y,Ufe=Lc,zfe=DC,Gfe=Wfe,BY=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=jfe(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(s,n){return zfe(s),Gfe(n),Ufe(s)&&(t?r(s,n):s.__proto__=n),s}}():void 0),Yfe=af.f,Kfe=function(t,e,r){r in t||Yfe(t,r,{configurable:!0,get:function(){return e[r]},set:function(i){e[r]=i}})},Xfe=ys,qfe=Lc,V$=BY,Jfe=function(t,e,r){var i,s;return V$&&Xfe(i=e.constructor)&&i!==r&&qfe(s=i.prototype)&&s!==r.prototype&&V$(t,s),t},Qfe=Hc,Zfe=Qfe("toStringTag"),VY={};VY[Zfe]="z";var ede=String(VY)==="[object z]",tde=ede,rde=ys,P2=Wg,nde=Hc,ide=nde("toStringTag"),sde=Object,ode=P2(function(){return arguments}())==="Arguments",ade=function(t,e){try{return t[e]}catch{}},WY=tde?P2:function(t){var e,r,i;return t===void 0?"Undefined":t===null?"Null":typeof(r=ade(e=sde(t),ide))=="string"?r:ode?P2(e):(i=P2(e))==="Object"&&rde(e.callee)?"Arguments":i},lde=WY,cde=String,x_=function(t){if(lde(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return cde(t)},ude=x_,hde=function(t,e){return t===void 0?arguments.length<2?"":e:ude(t)},fde=Lc,dde=E1,gde=function(t,e){fde(e)&&"cause"in e&&dde(t,"cause",e.cause)},mde=ss,jY=Error,pde=mde("".replace),vde=function(t){return String(new jY(t).stack)}("zxcasd"),UY=/\n\s*at [^:]*:[^\n]*/,wde=UY.test(vde),yde=function(t,e){if(wde&&typeof t=="string"&&!jY.prepareStackTrace)for(;e--;)t=pde(t,UY,"");return t},Cde=co,Sde=w_,bde=!Cde(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",Sde(1,7)),t.stack!==7):!0}),xde=E1,Ede=yde,Tde=bde,W$=Error.captureStackTrace,_de=function(t,e,r,i){Tde&&(W$?W$(t,e):xde(t,"stack",Ede(r,i)))},j$=b1,Rde=zl,U$=E1,Ade=HC,z$=BY,G$=LY,Y$=Kfe,Ode=Jfe,Ide=hde,Pde=gde,Fde=_de,Mde=Ul,kde=function(t,e,r,i){var s="stackTraceLimit",n=i?2:1,o=t.split("."),l=o[o.length-1],h=j$.apply(null,o);if(h){var d=h.prototype;if(Rde(d,"cause")&&delete d.cause,!r)return h;var g=j$("Error"),y=e(function(C,x){var _=Ide(i?x:C,void 0),E=i?new h(C):new h;return _!==void 0&&U$(E,"message",_),Fde(E,y,E.stack,2),this&&Ade(d,this)&&Ode(E,this,y),arguments.length>n&&Pde(E,arguments[n]),E});y.prototype=d,l!=="Error"?z$?z$(y,g):G$(y,g,{name:!0}):Mde&&s in h&&(Y$(y,h,s),Y$(y,h,"prepareStackTrace")),G$(y,h);try{d.name!==l&&U$(d,"name",l),d.constructor=y}catch{}return y}},zY=ni,Nde=Fs,Uu=b_,GY=kde,OP="WebAssembly",K$=Nde[OP],NE=new Error("e",{cause:7}).cause!==7,jg=function(t,e){var r={};r[t]=GY(t,e,NE),zY({global:!0,constructor:!0,arity:1,forced:NE},r)},ak=function(t,e){if(K$&&K$[t]){var r={};r[t]=GY(OP+"."+t,e,NE),zY({target:OP,stat:!0,constructor:!0,arity:1,forced:NE},r)}};jg("Error",function(t){return function(r){return Uu(t,this,arguments)}});jg("EvalError",function(t){return function(r){return Uu(t,this,arguments)}});jg("RangeError",function(t){return function(r){return Uu(t,this,arguments)}});jg("ReferenceError",function(t){return function(r){return Uu(t,this,arguments)}});jg("SyntaxError",function(t){return function(r){return Uu(t,this,arguments)}});jg("TypeError",function(t){return function(r){return Uu(t,this,arguments)}});jg("URIError",function(t){return function(r){return Uu(t,this,arguments)}});ak("CompileError",function(t){return function(r){return Uu(t,this,arguments)}});ak("LinkError",function(t){return function(r){return Uu(t,this,arguments)}});ak("RuntimeError",function(t){return function(r){return Uu(t,this,arguments)}});var Dde=Wg,YY=Array.isArray||function(e){return Dde(e)==="Array"},Lde=Ul,Hde=YY,$de=TypeError,Bde=Object.getOwnPropertyDescriptor,Vde=Lde&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),KY=Vde?function(t,e){if(Hde(t)&&!Bde(t,"length").writable)throw new $de("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Wde=TypeError,jde=9007199254740991,XY=function(t){if(t>jde)throw Wde("Maximum allowed index exceeded");return t},Ude=ni,zde=x1,Gde=T1,Yde=KY,Kde=XY,Xde=co,qde=Xde(function(){return[].push.call({length:4294967296},1)!==4294967297}),Jde=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Qde=qde||!Jde();Ude({target:"Array",proto:!0,arity:1,forced:Qde},{push:function(e){var r=zde(this),i=Gde(r),s=arguments.length;Kde(i+s);for(var n=0;n<s;n++)r[i]=arguments[n],i++;return Yde(r,i),i}});var M4=ss,xb=Set.prototype,zu={Set,add:M4(xb.add),has:M4(xb.has),remove:M4(xb.delete),proto:xb},Zde=zu.has,Ug=function(t){return Zde(t),t},e0e=Lo,zg=function(t,e,r){for(var i=r?t:t.iterator,s=t.next,n,o;!(n=e0e(s,i)).done;)if(o=e(n.value),o!==void 0)return o},qY=ss,t0e=zg,JY=zu,r0e=JY.Set,QY=JY.proto,n0e=qY(QY.forEach),ZY=qY(QY.keys),i0e=ZY(new r0e).next,WC=function(t,e,r){return r?t0e({iterator:ZY(t),next:i0e},e):n0e(t,e)},eK=zu,s0e=WC,o0e=eK.Set,a0e=eK.add,lk=function(t){var e=new o0e;return s0e(t,function(r){a0e(e,r)}),e},l0e=$Y,c0e=zu,jC=l0e(c0e.proto,"size","get")||function(t){return t.size},Gu=function(t){return{iterator:t,next:t.next,done:!1}},X$=ka,tK=Cs,q$=Lo,u0e=BC,h0e=Gu,J$="Invalid size",f0e=RangeError,d0e=TypeError,g0e=Math.max,rK=function(t,e){this.set=t,this.size=g0e(e,0),this.has=X$(t.has),this.keys=X$(t.keys)};rK.prototype={getIterator:function(){return h0e(tK(q$(this.keys,this.set)))},includes:function(t){return q$(this.has,this.set,t)}};var Gg=function(t){tK(t);var e=+t.size;if(e!==e)throw new d0e(J$);var r=u0e(e);if(r<0)throw new f0e(J$);return new rK(t,r)},m0e=Ug,nK=zu,p0e=lk,v0e=jC,w0e=Gg,y0e=WC,C0e=zg,S0e=nK.has,Q$=nK.remove,b0e=function(e){var r=m0e(this),i=w0e(e),s=p0e(r);return v0e(r)<=i.size?y0e(r,function(n){i.includes(n)&&Q$(s,n)}):C0e(i.getIterator(),function(n){S0e(r,n)&&Q$(s,n)}),s},x0e=b1,Z$=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},Yg=function(t){var e=x0e("Set");try{new e()[t](Z$(0));try{return new e()[t](Z$(-1)),!1}catch{return!0}}catch{return!1}},E0e=ni,T0e=b0e,_0e=Yg;E0e({target:"Set",proto:!0,real:!0,forced:!_0e("difference")},{difference:T0e});var R0e=Ug,ck=zu,A0e=jC,O0e=Gg,I0e=WC,P0e=zg,F0e=ck.Set,e9=ck.add,M0e=ck.has,k0e=function(e){var r=R0e(this),i=O0e(e),s=new F0e;return A0e(r)>i.size?P0e(i.getIterator(),function(n){M0e(r,n)&&e9(s,n)}):I0e(r,function(n){i.includes(n)&&e9(s,n)}),s},N0e=ni,D0e=co,L0e=k0e,H0e=Yg,$0e=!H0e("intersection")||D0e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});N0e({target:"Set",proto:!0,real:!0,forced:$0e},{intersection:L0e});var B0e=Lo,t9=Cs,V0e=$C,_1=function(t,e,r){var i,s;t9(t);try{if(i=V0e(t,"return"),!i){if(e==="throw")throw r;return r}i=B0e(i,t)}catch(n){s=!0,i=n}if(e==="throw")throw r;if(s)throw i;return t9(i),r},W0e=Ug,j0e=zu.has,U0e=jC,z0e=Gg,G0e=WC,Y0e=zg,K0e=_1,X0e=function(e){var r=W0e(this),i=z0e(e);if(U0e(r)<=i.size)return G0e(r,function(n){if(i.includes(n))return!1},!0)!==!1;var s=i.getIterator();return Y0e(s,function(n){if(j0e(r,n))return K0e(s,"normal",!1)})!==!1},q0e=ni,J0e=X0e,Q0e=Yg;q0e({target:"Set",proto:!0,real:!0,forced:!Q0e("isDisjointFrom")},{isDisjointFrom:J0e});var Z0e=Ug,ege=jC,tge=WC,rge=Gg,nge=function(e){var r=Z0e(this),i=rge(e);return ege(r)>i.size?!1:tge(r,function(s){if(!i.includes(s))return!1},!0)!==!1},ige=ni,sge=nge,oge=Yg;ige({target:"Set",proto:!0,real:!0,forced:!oge("isSubsetOf")},{isSubsetOf:sge});var age=Ug,lge=zu.has,cge=jC,uge=Gg,hge=zg,fge=_1,dge=function(e){var r=age(this),i=uge(e);if(cge(r)<i.size)return!1;var s=i.getIterator();return hge(s,function(n){if(!lge(r,n))return fge(s,"normal",!1)})!==!1},gge=ni,mge=dge,pge=Yg;gge({target:"Set",proto:!0,real:!0,forced:!pge("isSupersetOf")},{isSupersetOf:mge});var vge=Ug,uk=zu,wge=lk,yge=Gg,Cge=zg,Sge=uk.add,bge=uk.has,xge=uk.remove,Ege=function(e){var r=vge(this),i=yge(e).getIterator(),s=wge(r);return Cge(i,function(n){bge(r,n)?xge(s,n):Sge(s,n)}),s},Tge=ni,_ge=Ege,Rge=Yg;Tge({target:"Set",proto:!0,real:!0,forced:!Rge("symmetricDifference")},{symmetricDifference:_ge});var Age=Ug,Oge=zu.add,Ige=lk,Pge=Gg,Fge=zg,Mge=function(e){var r=Age(this),i=Pge(e).getIterator(),s=Ige(r);return Fge(i,function(n){Oge(s,n)}),s},kge=ni,Nge=Mge,Dge=Yg;kge({target:"Set",proto:!0,real:!0,forced:!Dge("union")},{union:Nge});var Lge=HC,Hge=TypeError,$ge=function(t,e){if(Lge(e,t))return t;throw new Hge("Incorrect invocation")},Bge=co,Vge=!Bge(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Wge=zl,jge=ys,Uge=x1,zge=rk,Gge=Vge,r9=zge("IE_PROTO"),IP=Object,Yge=IP.prototype,iK=Gge?IP.getPrototypeOf:function(t){var e=Uge(t);if(Wge(e,r9))return e[r9];var r=e.constructor;return jge(r)&&e instanceof r?r.prototype:e instanceof IP?Yge:null},n9=MY,Kge=af,Xge=function(t,e,r){return r.get&&n9(r.get,e,{getter:!0}),r.set&&n9(r.set,e,{setter:!0}),Kge.f(t,e,r)},qge=Ul,Jge=af,Qge=w_,sK=function(t,e,r){qge?Jge.f(t,e,Qge(0,r)):t[e]=r},oK={},Zge=NY,eme=ok,tme=Object.keys||function(e){return Zge(e,eme)},rme=Ul,nme=RY,ime=af,sme=Cs,ome=LC,ame=tme;oK.f=rme&&!nme?Object.defineProperties:function(e,r){sme(e);for(var i=ome(r),s=ame(r),n=s.length,o=0,l;n>o;)ime.f(e,l=s[o++],i[l]);return e};var lme=b1,aK=lme("document","documentElement"),cme=Cs,ume=oK,i9=ok,hme=nk,fme=aK,dme=ek,gme=rk,s9=">",o9="<",PP="prototype",FP="script",lK=gme("IE_PROTO"),k4=function(){},cK=function(t){return o9+FP+s9+t+o9+"/"+FP+s9},a9=function(t){t.write(cK("")),t.close();var e=t.parentWindow.Object;return t=null,e},mme=function(){var t=dme("iframe"),e="java"+FP+":",r;return t.style.display="none",fme.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(cK("document.F=Object")),r.close(),r.F},Eb,F2=function(){try{Eb=new ActiveXObject("htmlfile")}catch{}F2=typeof document<"u"?document.domain&&Eb?a9(Eb):mme():a9(Eb);for(var t=i9.length;t--;)delete F2[PP][i9[t]];return F2()};hme[lK]=!0;var uK=Object.create||function(e,r){var i;return e!==null?(k4[PP]=cme(e),i=new k4,k4[PP]=null,i[lK]=e):i=F2(),r===void 0?i:ume.f(i,r)},pme=co,vme=ys,wme=Lc,l9=iK,yme=sk,Cme=Hc,MP=Cme("iterator"),hK=!1,Tg,N4,D4;[].keys&&(D4=[].keys(),"next"in D4?(N4=l9(l9(D4)),N4!==Object.prototype&&(Tg=N4)):hK=!0);var Sme=!wme(Tg)||pme(function(){var t={};return Tg[MP].call(t)!==t});Sme&&(Tg={});vme(Tg[MP])||yme(Tg,MP,function(){return this});var fK={IteratorPrototype:Tg,BUGGY_SAFARI_ITERATORS:hK},bme=ni,xme=Fs,Eme=$ge,Tme=Cs,_me=ys,Rme=iK,Ame=Xge,Ome=sK,Ime=co,hk=zl,Pme=Hc,Hu=fK.IteratorPrototype,Fme=Ul,L4="constructor",dK="Iterator",c9=Pme("toStringTag"),gK=TypeError,H4=xme[dK],mK=!_me(H4)||H4.prototype!==Hu||!Ime(function(){H4({})}),fk=function(){if(Eme(this,Hu),Rme(this)===Hu)throw new gK("Abstract class Iterator not directly constructable")},pK=function(t,e){Fme?Ame(Hu,t,{configurable:!0,get:function(){return e},set:function(r){if(Tme(this),this===Hu)throw new gK("You can't redefine this property");hk(this,t)?this[t]=r:Ome(this,t,r)}}):Hu[t]=e};hk(Hu,c9)||pK(c9,dK);(mK||!hk(Hu,L4)||Hu[L4]===Object)&&pK(L4,fk);fk.prototype=Hu;bme({global:!0,constructor:!0,forced:mK},{Iterator:fk});var Mme=sk,kme=function(t,e,r){for(var i in e)Mme(t,i,e[i],r);return t},Nme=function(t,e){return{value:t,done:e}},Dme=Lo,Lme=uK,Hme=E1,$me=kme,Bme=Hc,vK=PY,Vme=$C,Wme=fK.IteratorPrototype,$4=Nme,B4=_1,jme=Bme("toStringTag"),wK="IteratorHelper",yK="WrapForValidIterator",Ume=vK.set,CK=function(t){var e=vK.getterFor(t?yK:wK);return $me(Lme(Wme),{next:function(){var i=e(this);if(t)return i.nextHandler();try{var s=i.done?void 0:i.nextHandler();return $4(s,i.done)}catch(n){throw i.done=!0,n}},return:function(){var r=e(this),i=r.iterator;if(r.done=!0,t){var s=Vme(i,"return");return s?Dme(s,i):$4(void 0,!0)}if(r.inner)try{B4(r.inner.iterator,"normal")}catch(n){return B4(i,"throw",n)}return i&&B4(i,"normal"),$4(void 0,!0)}})},zme=CK(!0),SK=CK(!1);Hme(SK,jme,"Iterator Helper");var dk=function(t,e){var r=function(s,n){n?(n.iterator=s.iterator,n.next=s.next):n=s,n.type=e?yK:wK,n.nextHandler=t,n.counter=0,n.done=!1,Ume(this,n)};return r.prototype=e?zme:SK,r},Gme=Cs,Yme=_1,bK=function(t,e,r,i){try{return i?e(Gme(r)[0],r[1]):e(r)}catch(s){Yme(t,"throw",s)}},Kme=ni,Xme=Lo,qme=ka,xK=Cs,Jme=Gu,Qme=dk,Zme=bK,epe=JM,tpe=Qme(function(){for(var t=this.iterator,e=this.predicate,r=this.next,i,s,n;;){if(i=xK(Xme(r,t)),s=this.done=!!i.done,s)return;if(n=i.value,Zme(t,e,[n,this.counter++],!0))return n}});Kme({target:"Iterator",proto:!0,real:!0,forced:epe},{filter:function(e){return xK(this),qme(e),new tpe(Jme(this),{predicate:e})}});var rpe=Wg,npe=ss,ipe=function(t){if(rpe(t)==="Function")return npe(t)},u9=ipe,spe=ka,ope=v_,ape=u9(u9.bind),EK=function(t,e){return spe(t),e===void 0?t:ope?ape(t,e):function(){return t.apply(e,arguments)}},TK={},lpe=Hc,cpe=TK,upe=lpe("iterator"),hpe=Array.prototype,fpe=function(t){return t!==void 0&&(cpe.Array===t||hpe[upe]===t)},dpe=WY,h9=$C,gpe=y_,mpe=TK,ppe=Hc,vpe=ppe("iterator"),gk=function(t){if(!gpe(t))return h9(t,vpe)||h9(t,"@@iterator")||mpe[dpe(t)]},wpe=Lo,ype=ka,Cpe=Cs,Spe=S_,bpe=gk,xpe=TypeError,Epe=function(t,e){var r=arguments.length<2?bpe(t):e;if(ype(r))return Cpe(wpe(r,t));throw new xpe(Spe(t)+" is not iterable")},Tpe=EK,_pe=Lo,Rpe=Cs,Ape=S_,Ope=fpe,Ipe=T1,f9=HC,Ppe=Epe,Fpe=gk,d9=_1,Mpe=TypeError,M2=function(t,e){this.stopped=t,this.result=e},g9=M2.prototype,R1=function(t,e,r){var i=r&&r.that,s=!!(r&&r.AS_ENTRIES),n=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),h=Tpe(e,i),d,g,y,C,x,_,E,R=function(F){return d&&d9(d,"normal",F),new M2(!0,F)},I=function(F){return s?(Rpe(F),l?h(F[0],F[1],R):h(F[0],F[1])):l?h(F,R):h(F)};if(n)d=t.iterator;else if(o)d=t;else{if(g=Fpe(t),!g)throw new Mpe(Ape(t)+" is not iterable");if(Ope(g)){for(y=0,C=Ipe(t);C>y;y++)if(x=I(t[y]),x&&f9(g9,x))return x;return new M2(!1)}d=Ppe(t,g)}for(_=n?t.next:d.next;!(E=_pe(_,d)).done;){try{x=I(E.value)}catch(F){d9(d,"throw",F)}if(typeof x=="object"&&x&&f9(g9,x))return x}return new M2(!1)},kpe=ni,Npe=R1,Dpe=ka,Lpe=Cs,Hpe=Gu;kpe({target:"Iterator",proto:!0,real:!0},{forEach:function(e){Lpe(this),Dpe(e);var r=Hpe(this),i=0;Npe(r,function(s){e(s,i++)},{IS_RECORD:!0})}});var $pe=Lo,Bpe=ka,_K=Cs,Vpe=Gu,Wpe=dk,jpe=bK,Upe=Wpe(function(){var t=this.iterator,e=_K($pe(this.next,t)),r=this.done=!!e.done;if(!r)return jpe(t,this.mapper,[e.value,this.counter++],!0)}),zpe=function(e){return _K(this),Bpe(e),new Upe(Vpe(this),{mapper:e})},Gpe=ni,Ype=zpe,Kpe=JM;Gpe({target:"Iterator",proto:!0,real:!0,forced:Kpe},{map:Ype});var Xpe=ss,mk=Xpe([].slice),qpe=TypeError,RK=function(t,e){if(t<e)throw new qpe("Not enough arguments");return t},Jpe=C_,Qpe=/(?:ipad|iphone|ipod).*applewebkit/i.test(Jpe),Av=Fs,Zpe=C_,e1e=Wg,Tb=function(t){return Zpe.slice(0,t.length)===t},AK=function(){return Tb("Bun/")?"BUN":Tb("Cloudflare-Workers")?"CLOUDFLARE":Tb("Deno/")?"DENO":Tb("Node.js/")?"NODE":Av.Bun&&typeof Bun.version=="string"?"BUN":Av.Deno&&typeof Deno.version=="object"?"DENO":e1e(Av.process)==="process"?"NODE":Av.window&&Av.document?"BROWSER":"REST"}(),t1e=AK,r1e=t1e==="NODE",el=Fs,n1e=b_,i1e=EK,m9=ys,s1e=zl,OK=co,p9=aK,o1e=mk,v9=ek,a1e=RK,l1e=Qpe,c1e=r1e,kP=el.setImmediate,NP=el.clearImmediate,u1e=el.process,V4=el.Dispatch,h1e=el.Function,w9=el.MessageChannel,f1e=el.String,W4=0,ry={},y9="onreadystatechange",Jy,s0,j4,U4;OK(function(){Jy=el.location});var pk=function(t){if(s1e(ry,t)){var e=ry[t];delete ry[t],e()}},z4=function(t){return function(){pk(t)}},C9=function(t){pk(t.data)},S9=function(t){el.postMessage(f1e(t),Jy.protocol+"//"+Jy.host)};(!kP||!NP)&&(kP=function(e){a1e(arguments.length,1);var r=m9(e)?e:h1e(e),i=o1e(arguments,1);return ry[++W4]=function(){n1e(r,void 0,i)},s0(W4),W4},NP=function(e){delete ry[e]},c1e?s0=function(t){u1e.nextTick(z4(t))}:V4&&V4.now?s0=function(t){V4.now(z4(t))}:w9&&!l1e?(j4=new w9,U4=j4.port2,j4.port1.onmessage=C9,s0=i1e(U4.postMessage,U4)):el.addEventListener&&m9(el.postMessage)&&!el.importScripts&&Jy&&Jy.protocol!=="file:"&&!OK(S9)?(s0=S9,el.addEventListener("message",C9,!1)):y9 in v9("script")?s0=function(t){p9.appendChild(v9("script"))[y9]=function(){p9.removeChild(this),pk(t)}}:s0=function(t){setTimeout(z4(t),0)});var IK={set:kP,clear:NP},d1e=ni,g1e=Fs,b9=IK.clear;d1e({global:!0,bind:!0,enumerable:!0,forced:g1e.clearImmediate!==b9},{clearImmediate:b9});var PK=Fs,m1e=b_,p1e=ys,v1e=AK,w1e=C_,y1e=mk,C1e=RK,S1e=PK.Function,b1e=/MSIE .\./.test(w1e)||v1e==="BUN"&&function(){var t=PK.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),x1e=function(t,e){var r=e?2:1;return b1e?function(i,s){var n=C1e(arguments.length,1)>r,o=p1e(i)?i:S1e(i),l=n?y1e(arguments,r):[],h=n?function(){m1e(o,this,l)}:o;return e?t(h,s):t(h)}:t},E1e=ni,FK=Fs,x9=IK.set,T1e=x1e,E9=FK.setImmediate?T1e(x9,!1):x9;E1e({global:!0,bind:!0,enumerable:!0,forced:FK.setImmediate!==E9},{setImmediate:E9});/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries:MK,setPrototypeOf:T9,isFrozen:_1e,getPrototypeOf:R1e,getOwnPropertyDescriptor:A1e}=Object;let{freeze:ia,seal:jl,create:kK}=Object,{apply:DP,construct:LP}=typeof Reflect<"u"&&Reflect;ia||(ia=function(e){return e});jl||(jl=function(e){return e});DP||(DP=function(e,r,i){return e.apply(r,i)});LP||(LP=function(e,r){return new e(...r)});const _b=sl(Array.prototype.forEach),_9=sl(Array.prototype.pop),Ov=sl(Array.prototype.push),k2=sl(String.prototype.toLowerCase),G4=sl(String.prototype.toString),R9=sl(String.prototype.match),Iv=sl(String.prototype.replace),O1e=sl(String.prototype.indexOf),I1e=sl(String.prototype.trim),fc=sl(Object.prototype.hasOwnProperty),Wo=sl(RegExp.prototype.test),Pv=P1e(TypeError);function sl(t){return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return DP(t,e,i)}}function P1e(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return LP(t,r)}}function ln(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:k2;T9&&T9(t,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const n=r(s);n!==s&&(_1e(e)||(e[i]=n),s=n)}t[s]=!0}return t}function F1e(t){for(let e=0;e<t.length;e++)fc(t,e)||(t[e]=null);return t}function Y0(t){const e=kK(null);for(const[r,i]of MK(t))fc(t,r)&&(Array.isArray(i)?e[r]=F1e(i):i&&typeof i=="object"&&i.constructor===Object?e[r]=Y0(i):e[r]=i);return e}function Fv(t,e){for(;t!==null;){const i=A1e(t,e);if(i){if(i.get)return sl(i.get);if(typeof i.value=="function")return sl(i.value)}t=R1e(t)}function r(){return null}return r}const A9=ia(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Y4=ia(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),K4=ia(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M1e=ia(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),X4=ia(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),k1e=ia(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),O9=ia(["#text"]),I9=ia(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),q4=ia(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),P9=ia(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rb=ia(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N1e=jl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),D1e=jl(/<%[\w\W]*|[\w\W]*%>/gm),L1e=jl(/\$\{[\w\W]*}/gm),H1e=jl(/^data-[\-\w.\u00B7-\uFFFF]+$/),$1e=jl(/^aria-[\-\w]+$/),NK=jl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B1e=jl(/^(?:\w+script|data):/i),V1e=jl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DK=jl(/^html$/i),W1e=jl(/^[a-z][.\w]*(-[.\w]+)+$/i);var F9=Object.freeze({__proto__:null,ARIA_ATTR:$1e,ATTR_WHITESPACE:V1e,CUSTOM_ELEMENT:W1e,DATA_ATTR:H1e,DOCTYPE_NAME:DK,ERB_EXPR:D1e,IS_ALLOWED_URI:NK,IS_SCRIPT_OR_DATA:B1e,MUSTACHE_EXPR:N1e,TMPLIT_EXPR:L1e});const Mv={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},j1e=function(){return typeof window>"u"?null:window},U1e=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(i=r.getAttribute(s));const n="dompurify"+(i?"#"+i:"");try{return e.createPolicy(n,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}},M9=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function LK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j1e();const e=Ae=>LK(Ae);if(e.version="3.2.3",e.removed=[],!t||!t.document||t.document.nodeType!==Mv.document)return e.isSupported=!1,e;let{document:r}=t;const i=r,s=i.currentScript,{DocumentFragment:n,HTMLTemplateElement:o,Node:l,Element:h,NodeFilter:d,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:y,DOMParser:C,trustedTypes:x}=t,_=h.prototype,E=Fv(_,"cloneNode"),R=Fv(_,"remove"),I=Fv(_,"nextSibling"),F=Fv(_,"childNodes"),D=Fv(_,"parentNode");if(typeof o=="function"){const Ae=r.createElement("template");Ae.content&&Ae.content.ownerDocument&&(r=Ae.content.ownerDocument)}let U,X="";const{implementation:te,createNodeIterator:Y,createDocumentFragment:oe,getElementsByTagName:me}=r,{importNode:de}=i;let ye=M9();e.isSupported=typeof MK=="function"&&typeof D=="function"&&te&&te.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ee,ERB_EXPR:ke,TMPLIT_EXPR:nt,DATA_ATTR:at,ARIA_ATTR:Ze,IS_SCRIPT_OR_DATA:Xe,ATTR_WHITESPACE:Pe,CUSTOM_ELEMENT:Be}=F9;let{IS_ALLOWED_URI:Me}=F9,A=null;const O=ln({},[...A9,...Y4,...K4,...X4,...O9]);let N=null;const H=ln({},[...I9,...q4,...P9,...Rb]);let B=Object.seal(kK(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Z=null,we=!0,Ce=!0,z=!1,q=!0,re=!1,ve=!0,ce=!1,Re=!1,Oe=!1,he=!1,Ie=!1,De=!1,$e=!0,qe=!1;const Ft="user-content-";let bt=!0,Gt=!1,Lr={},Or=null;const sr=ln({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let er=null;const Hn=ln({},["audio","video","img","source","image","track"]);let Si=null;const et=ln({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",ft="http://www.w3.org/2000/svg",Nt="http://www.w3.org/1999/xhtml";let vr=Nt,cr=!1,Tr=null;const li=ln({},[ot,ft,Nt],G4);let ho=ln({},["mi","mo","mn","ms","mtext"]),Ju=ln({},["annotation-xml"]);const rm=ln({},["title","style","font","a","script"]);let fo=null;const gf=["application/xhtml+xml","text/html"],wr="text/html";let Bi=null,ua=null;const ii=r.createElement("form"),Vd=function(ie){return ie instanceof RegExp||ie instanceof Function},jc=function(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(ua&&ua===ie)){if((!ie||typeof ie!="object")&&(ie={}),ie=Y0(ie),fo=gf.indexOf(ie.PARSER_MEDIA_TYPE)===-1?wr:ie.PARSER_MEDIA_TYPE,Bi=fo==="application/xhtml+xml"?G4:k2,A=fc(ie,"ALLOWED_TAGS")?ln({},ie.ALLOWED_TAGS,Bi):O,N=fc(ie,"ALLOWED_ATTR")?ln({},ie.ALLOWED_ATTR,Bi):H,Tr=fc(ie,"ALLOWED_NAMESPACES")?ln({},ie.ALLOWED_NAMESPACES,G4):li,Si=fc(ie,"ADD_URI_SAFE_ATTR")?ln(Y0(et),ie.ADD_URI_SAFE_ATTR,Bi):et,er=fc(ie,"ADD_DATA_URI_TAGS")?ln(Y0(Hn),ie.ADD_DATA_URI_TAGS,Bi):Hn,Or=fc(ie,"FORBID_CONTENTS")?ln({},ie.FORBID_CONTENTS,Bi):sr,K=fc(ie,"FORBID_TAGS")?ln({},ie.FORBID_TAGS,Bi):{},Z=fc(ie,"FORBID_ATTR")?ln({},ie.FORBID_ATTR,Bi):{},Lr=fc(ie,"USE_PROFILES")?ie.USE_PROFILES:!1,we=ie.ALLOW_ARIA_ATTR!==!1,Ce=ie.ALLOW_DATA_ATTR!==!1,z=ie.ALLOW_UNKNOWN_PROTOCOLS||!1,q=ie.ALLOW_SELF_CLOSE_IN_ATTR!==!1,re=ie.SAFE_FOR_TEMPLATES||!1,ve=ie.SAFE_FOR_XML!==!1,ce=ie.WHOLE_DOCUMENT||!1,he=ie.RETURN_DOM||!1,Ie=ie.RETURN_DOM_FRAGMENT||!1,De=ie.RETURN_TRUSTED_TYPE||!1,Oe=ie.FORCE_BODY||!1,$e=ie.SANITIZE_DOM!==!1,qe=ie.SANITIZE_NAMED_PROPS||!1,bt=ie.KEEP_CONTENT!==!1,Gt=ie.IN_PLACE||!1,Me=ie.ALLOWED_URI_REGEXP||NK,vr=ie.NAMESPACE||Nt,ho=ie.MATHML_TEXT_INTEGRATION_POINTS||ho,Ju=ie.HTML_INTEGRATION_POINTS||Ju,B=ie.CUSTOM_ELEMENT_HANDLING||{},ie.CUSTOM_ELEMENT_HANDLING&&Vd(ie.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(B.tagNameCheck=ie.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ie.CUSTOM_ELEMENT_HANDLING&&Vd(ie.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(B.attributeNameCheck=ie.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ie.CUSTOM_ELEMENT_HANDLING&&typeof ie.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(B.allowCustomizedBuiltInElements=ie.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),re&&(Ce=!1),Ie&&(he=!0),Lr&&(A=ln({},O9),N=[],Lr.html===!0&&(ln(A,A9),ln(N,I9)),Lr.svg===!0&&(ln(A,Y4),ln(N,q4),ln(N,Rb)),Lr.svgFilters===!0&&(ln(A,K4),ln(N,q4),ln(N,Rb)),Lr.mathMl===!0&&(ln(A,X4),ln(N,P9),ln(N,Rb))),ie.ADD_TAGS&&(A===O&&(A=Y0(A)),ln(A,ie.ADD_TAGS,Bi)),ie.ADD_ATTR&&(N===H&&(N=Y0(N)),ln(N,ie.ADD_ATTR,Bi)),ie.ADD_URI_SAFE_ATTR&&ln(Si,ie.ADD_URI_SAFE_ATTR,Bi),ie.FORBID_CONTENTS&&(Or===sr&&(Or=Y0(Or)),ln(Or,ie.FORBID_CONTENTS,Bi)),bt&&(A["#text"]=!0),ce&&ln(A,["html","head","body"]),A.table&&(ln(A,["tbody"]),delete K.tbody),ie.TRUSTED_TYPES_POLICY){if(typeof ie.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ie.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');U=ie.TRUSTED_TYPES_POLICY,X=U.createHTML("")}else U===void 0&&(U=U1e(x,s)),U!==null&&typeof X=="string"&&(X=U.createHTML(""));ia&&ia(ie),ua=ie}},Qu=ln({},[...Y4,...K4,...M1e]),Zu=ln({},[...X4,...k1e]),ci=function(ie){let Ne=D(ie);(!Ne||!Ne.tagName)&&(Ne={namespaceURI:vr,tagName:"template"});const Qe=k2(ie.tagName),xt=k2(Ne.tagName);return Tr[ie.namespaceURI]?ie.namespaceURI===ft?Ne.namespaceURI===Nt?Qe==="svg":Ne.namespaceURI===ot?Qe==="svg"&&(xt==="annotation-xml"||ho[xt]):!!Qu[Qe]:ie.namespaceURI===ot?Ne.namespaceURI===Nt?Qe==="math":Ne.namespaceURI===ft?Qe==="math"&&Ju[xt]:!!Zu[Qe]:ie.namespaceURI===Nt?Ne.namespaceURI===ft&&!Ju[xt]||Ne.namespaceURI===ot&&!ho[xt]?!1:!Zu[Qe]&&(rm[Qe]||!Qu[Qe]):!!(fo==="application/xhtml+xml"&&Tr[ie.namespaceURI]):!1},Ys=function(ie){Ov(e.removed,{element:ie});try{D(ie).removeChild(ie)}catch{R(ie)}},mf=function(ie,Ne){try{Ov(e.removed,{attribute:Ne.getAttributeNode(ie),from:Ne})}catch{Ov(e.removed,{attribute:null,from:Ne})}if(Ne.removeAttribute(ie),ie==="is")if(he||Ie)try{Ys(Ne)}catch{}else try{Ne.setAttribute(ie,"")}catch{}},Wd=function(ie){let Ne=null,Qe=null;if(Oe)ie="<remove></remove>"+ie;else{const yt=R9(ie,/^[\r\n\t ]+/);Qe=yt&&yt[0]}fo==="application/xhtml+xml"&&vr===Nt&&(ie='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ie+"</body></html>");const xt=U?U.createHTML(ie):ie;if(vr===Nt)try{Ne=new C().parseFromString(xt,fo)}catch{}if(!Ne||!Ne.documentElement){Ne=te.createDocument(vr,"template",null);try{Ne.documentElement.innerHTML=cr?X:xt}catch{}}const dt=Ne.body||Ne.documentElement;return ie&&Qe&&dt.insertBefore(r.createTextNode(Qe),dt.childNodes[0]||null),vr===Nt?me.call(Ne,ce?"html":"body")[0]:ce?Ne.documentElement:dt},ee=function(ie){return Y.call(ie.ownerDocument||ie,ie,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},ge=function(ie){return ie instanceof y&&(typeof ie.nodeName!="string"||typeof ie.textContent!="string"||typeof ie.removeChild!="function"||!(ie.attributes instanceof g)||typeof ie.removeAttribute!="function"||typeof ie.setAttribute!="function"||typeof ie.namespaceURI!="string"||typeof ie.insertBefore!="function"||typeof ie.hasChildNodes!="function")},ae=function(ie){return typeof l=="function"&&ie instanceof l};function le(Ae,ie,Ne){_b(Ae,Qe=>{Qe.call(e,ie,Ne,ua)})}const ue=function(ie){let Ne=null;if(le(ye.beforeSanitizeElements,ie,null),ge(ie))return Ys(ie),!0;const Qe=Bi(ie.nodeName);if(le(ye.uponSanitizeElement,ie,{tagName:Qe,allowedTags:A}),ie.hasChildNodes()&&!ae(ie.firstElementChild)&&Wo(/<[/\w]/g,ie.innerHTML)&&Wo(/<[/\w]/g,ie.textContent)||ie.nodeType===Mv.progressingInstruction||ve&&ie.nodeType===Mv.comment&&Wo(/<[/\w]/g,ie.data))return Ys(ie),!0;if(!A[Qe]||K[Qe]){if(!K[Qe]&&Le(Qe)&&(B.tagNameCheck instanceof RegExp&&Wo(B.tagNameCheck,Qe)||B.tagNameCheck instanceof Function&&B.tagNameCheck(Qe)))return!1;if(bt&&!Or[Qe]){const xt=D(ie)||ie.parentNode,dt=F(ie)||ie.childNodes;if(dt&&xt){const yt=dt.length;for(let gr=yt-1;gr>=0;--gr){const _r=E(dt[gr],!0);_r.__removalCount=(ie.__removalCount||0)+1,xt.insertBefore(_r,I(ie))}}}return Ys(ie),!0}return ie instanceof h&&!ci(ie)||(Qe==="noscript"||Qe==="noembed"||Qe==="noframes")&&Wo(/<\/no(script|embed|frames)/i,ie.innerHTML)?(Ys(ie),!0):(re&&ie.nodeType===Mv.text&&(Ne=ie.textContent,_b([Ee,ke,nt],xt=>{Ne=Iv(Ne,xt," ")}),ie.textContent!==Ne&&(Ov(e.removed,{element:ie.cloneNode()}),ie.textContent=Ne)),le(ye.afterSanitizeElements,ie,null),!1)},pe=function(ie,Ne,Qe){if($e&&(Ne==="id"||Ne==="name")&&(Qe in r||Qe in ii))return!1;if(!(Ce&&!Z[Ne]&&Wo(at,Ne))){if(!(we&&Wo(Ze,Ne))){if(!N[Ne]||Z[Ne]){if(!(Le(ie)&&(B.tagNameCheck instanceof RegExp&&Wo(B.tagNameCheck,ie)||B.tagNameCheck instanceof Function&&B.tagNameCheck(ie))&&(B.attributeNameCheck instanceof RegExp&&Wo(B.attributeNameCheck,Ne)||B.attributeNameCheck instanceof Function&&B.attributeNameCheck(Ne))||Ne==="is"&&B.allowCustomizedBuiltInElements&&(B.tagNameCheck instanceof RegExp&&Wo(B.tagNameCheck,Qe)||B.tagNameCheck instanceof Function&&B.tagNameCheck(Qe))))return!1}else if(!Si[Ne]){if(!Wo(Me,Iv(Qe,Pe,""))){if(!((Ne==="src"||Ne==="xlink:href"||Ne==="href")&&ie!=="script"&&O1e(Qe,"data:")===0&&er[ie])){if(!(z&&!Wo(Xe,Iv(Qe,Pe,"")))){if(Qe)return!1}}}}}}return!0},Le=function(ie){return ie!=="annotation-xml"&&R9(ie,Be)},Ye=function(ie){le(ye.beforeSanitizeAttributes,ie,null);const{attributes:Ne}=ie;if(!Ne||ge(ie))return;const Qe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:N,forceKeepAttr:void 0};let xt=Ne.length;for(;xt--;){const dt=Ne[xt],{name:yt,namespaceURI:gr,value:_r}=dt,Vr=Bi(yt);let mn=yt==="value"?_r:I1e(_r);if(Qe.attrName=Vr,Qe.attrValue=mn,Qe.keepAttr=!0,Qe.forceKeepAttr=void 0,le(ye.uponSanitizeAttribute,ie,Qe),mn=Qe.attrValue,qe&&(Vr==="id"||Vr==="name")&&(mf(yt,ie),mn=Ft+mn),ve&&Wo(/((--!?|])>)|<\/(style|title)/i,mn)){mf(yt,ie);continue}if(Qe.forceKeepAttr||(mf(yt,ie),!Qe.keepAttr))continue;if(!q&&Wo(/\/>/i,mn)){mf(yt,ie);continue}re&&_b([Ee,ke,nt],ul=>{mn=Iv(mn,ul," ")});const Mr=Bi(ie.nodeName);if(pe(Mr,Vr,mn)){if(U&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!gr)switch(x.getAttributeType(Mr,Vr)){case"TrustedHTML":{mn=U.createHTML(mn);break}case"TrustedScriptURL":{mn=U.createScriptURL(mn);break}}try{gr?ie.setAttributeNS(gr,yt,mn):ie.setAttribute(yt,mn),ge(ie)?Ys(ie):_9(e.removed)}catch{}}}le(ye.afterSanitizeAttributes,ie,null)},Ve=function Ae(ie){let Ne=null;const Qe=ee(ie);for(le(ye.beforeSanitizeShadowDOM,ie,null);Ne=Qe.nextNode();)le(ye.uponSanitizeShadowNode,Ne,null),ue(Ne),Ye(Ne),Ne.content instanceof n&&Ae(Ne.content);le(ye.afterSanitizeShadowDOM,ie,null)};return e.sanitize=function(Ae){let ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ne=null,Qe=null,xt=null,dt=null;if(cr=!Ae,cr&&(Ae="<!-->"),typeof Ae!="string"&&!ae(Ae))if(typeof Ae.toString=="function"){if(Ae=Ae.toString(),typeof Ae!="string")throw Pv("dirty is not a string, aborting")}else throw Pv("toString is not a function");if(!e.isSupported)return Ae;if(Re||jc(ie),e.removed=[],typeof Ae=="string"&&(Gt=!1),Gt){if(Ae.nodeName){const _r=Bi(Ae.nodeName);if(!A[_r]||K[_r])throw Pv("root node is forbidden and cannot be sanitized in-place")}}else if(Ae instanceof l)Ne=Wd("<!---->"),Qe=Ne.ownerDocument.importNode(Ae,!0),Qe.nodeType===Mv.element&&Qe.nodeName==="BODY"||Qe.nodeName==="HTML"?Ne=Qe:Ne.appendChild(Qe);else{if(!he&&!re&&!ce&&Ae.indexOf("<")===-1)return U&&De?U.createHTML(Ae):Ae;if(Ne=Wd(Ae),!Ne)return he?null:De?X:""}Ne&&Oe&&Ys(Ne.firstChild);const yt=ee(Gt?Ae:Ne);for(;xt=yt.nextNode();)ue(xt),Ye(xt),xt.content instanceof n&&Ve(xt.content);if(Gt)return Ae;if(he){if(Ie)for(dt=oe.call(Ne.ownerDocument);Ne.firstChild;)dt.appendChild(Ne.firstChild);else dt=Ne;return(N.shadowroot||N.shadowrootmode)&&(dt=de.call(i,dt,!0)),dt}let gr=ce?Ne.outerHTML:Ne.innerHTML;return ce&&A["!doctype"]&&Ne.ownerDocument&&Ne.ownerDocument.doctype&&Ne.ownerDocument.doctype.name&&Wo(DK,Ne.ownerDocument.doctype.name)&&(gr="<!DOCTYPE "+Ne.ownerDocument.doctype.name+`>
`+gr),re&&_b([Ee,ke,nt],_r=>{gr=Iv(gr,_r," ")}),U&&De?U.createHTML(gr):gr},e.setConfig=function(){let Ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};jc(Ae),Re=!0},e.clearConfig=function(){ua=null,Re=!1},e.isValidAttribute=function(Ae,ie,Ne){ua||jc({});const Qe=Bi(Ae),xt=Bi(ie);return pe(Qe,xt,Ne)},e.addHook=function(Ae,ie){typeof ie=="function"&&Ov(ye[Ae],ie)},e.removeHook=function(Ae){return _9(ye[Ae])},e.removeHooks=function(Ae){ye[Ae]=[]},e.removeAllHooks=function(){ye=M9()},e}var z1e=LK();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var HK;function wt(){return HK.apply(null,arguments)}function G1e(t){HK=t}function Mc(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function mg(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function vk(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Rn(t,e))return!1;return!0}function ya(t){return t===void 0}function Zh(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function UC(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function $K(t,e){var r=[],i,s=t.length;for(i=0;i<s;++i)r.push(e(t[i],i));return r}function nd(t,e){for(var r in e)Rn(e,r)&&(t[r]=e[r]);return Rn(e,"toString")&&(t.toString=e.toString),Rn(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Yu(t,e,r,i){return lX(t,e,r,i,!0).utc()}function Y1e(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Kr(t){return t._pf==null&&(t._pf=Y1e()),t._pf}var HP;Array.prototype.some?HP=Array.prototype.some:HP=function(t){var e=Object(this),r=e.length>>>0,i;for(i=0;i<r;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function wk(t){var e=null,r=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Kr(t),r=HP.call(e.parsedDateParts,function(s){return s!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function E_(t){var e=Yu(NaN);return t!=null?nd(Kr(e),t):Kr(e).userInvalidated=!0,e}var k9=wt.momentProperties=[],J4=!1;function yk(t,e){var r,i,s,n=k9.length;if(ya(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ya(e._i)||(t._i=e._i),ya(e._f)||(t._f=e._f),ya(e._l)||(t._l=e._l),ya(e._strict)||(t._strict=e._strict),ya(e._tzm)||(t._tzm=e._tzm),ya(e._isUTC)||(t._isUTC=e._isUTC),ya(e._offset)||(t._offset=e._offset),ya(e._pf)||(t._pf=Kr(e)),ya(e._locale)||(t._locale=e._locale),n>0)for(r=0;r<n;r++)i=k9[r],s=e[i],ya(s)||(t[i]=s);return t}function zC(t){yk(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),J4===!1&&(J4=!0,wt.updateOffset(this),J4=!1)}function kc(t){return t instanceof zC||t!=null&&t._isAMomentObject!=null}function BK(t){wt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Gl(t,e){var r=!0;return nd(function(){if(wt.deprecationHandler!=null&&wt.deprecationHandler(null,t),r){var i=[],s,n,o,l=arguments.length;for(n=0;n<l;n++){if(s="",typeof arguments[n]=="object"){s+=`
[`+n+"] ";for(o in arguments[0])Rn(arguments[0],o)&&(s+=o+": "+arguments[0][o]+", ");s=s.slice(0,-2)}else s=arguments[n];i.push(s)}BK(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var N9={};function VK(t,e){wt.deprecationHandler!=null&&wt.deprecationHandler(t,e),N9[t]||(BK(e),N9[t]=!0)}wt.suppressDeprecationWarnings=!1;wt.deprecationHandler=null;function Ku(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function K1e(t){var e,r;for(r in t)Rn(t,r)&&(e=t[r],Ku(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function $P(t,e){var r=nd({},t),i;for(i in e)Rn(e,i)&&(mg(t[i])&&mg(e[i])?(r[i]={},nd(r[i],t[i]),nd(r[i],e[i])):e[i]!=null?r[i]=e[i]:delete r[i]);for(i in t)Rn(t,i)&&!Rn(e,i)&&mg(t[i])&&(r[i]=nd({},r[i]));return r}function Ck(t){t!=null&&this.set(t)}var BP;Object.keys?BP=Object.keys:BP=function(t){var e,r=[];for(e in t)Rn(t,e)&&r.push(e);return r};var X1e={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function q1e(t,e,r){var i=this._calendar[t]||this._calendar.sameElse;return Ku(i)?i.call(e,r):i}function Bu(t,e,r){var i=""+Math.abs(t),s=e-i.length,n=t>=0;return(n?r?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+i}var Sk=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ab=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Q4={},Vp={};function Rr(t,e,r,i){var s=i;typeof i=="string"&&(s=function(){return this[i]()}),t&&(Vp[t]=s),e&&(Vp[e[0]]=function(){return Bu(s.apply(this,arguments),e[1],e[2])}),r&&(Vp[r]=function(){return this.localeData().ordinal(s.apply(this,arguments),t)})}function J1e(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Q1e(t){var e=t.match(Sk),r,i;for(r=0,i=e.length;r<i;r++)Vp[e[r]]?e[r]=Vp[e[r]]:e[r]=J1e(e[r]);return function(s){var n="",o;for(o=0;o<i;o++)n+=Ku(e[o])?e[o].call(s,t):e[o];return n}}function N2(t,e){return t.isValid()?(e=WK(e,t.localeData()),Q4[e]=Q4[e]||Q1e(e),Q4[e](t)):t.localeData().invalidDate()}function WK(t,e){var r=5;function i(s){return e.longDateFormat(s)||s}for(Ab.lastIndex=0;r>=0&&Ab.test(t);)t=t.replace(Ab,i),Ab.lastIndex=0,r-=1;return t}var Z1e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function eve(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(Sk).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var tve="Invalid date";function rve(){return this._invalidDate}var nve="%d",ive=/\d{1,2}/;function sve(t){return this._ordinal.replace("%d",t)}var ove={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ave(t,e,r,i){var s=this._relativeTime[r];return Ku(s)?s(t,e,r,i):s.replace(/%d/i,t)}function lve(t,e){var r=this._relativeTime[t>0?"future":"past"];return Ku(r)?r(e):r.replace(/%s/i,e)}var D9={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Yl(t){return typeof t=="string"?D9[t]||D9[t.toLowerCase()]:void 0}function bk(t){var e={},r,i;for(i in t)Rn(t,i)&&(r=Yl(i),r&&(e[r]=t[i]));return e}var cve={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uve(t){var e=[],r;for(r in t)Rn(t,r)&&e.push({unit:r,priority:cve[r]});return e.sort(function(i,s){return i.priority-s.priority}),e}var jK=/\d/,cl=/\d\d/,UK=/\d{3}/,xk=/\d{4}/,T_=/[+-]?\d{6}/,Ci=/\d\d?/,zK=/\d\d\d\d?/,GK=/\d\d\d\d\d\d?/,__=/\d{1,3}/,Ek=/\d{1,4}/,R_=/[+-]?\d{1,6}/,A1=/\d+/,A_=/[+-]?\d+/,hve=/Z|[+-]\d\d:?\d\d/gi,O_=/Z|[+-]\d\d(?::?\d\d)?/gi,fve=/[+-]?\d+(\.\d{1,3})?/,GC=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,O1=/^[1-9]\d?/,Tk=/^([1-9]\d|\d)/,DE;DE={};function ir(t,e,r){DE[t]=Ku(e)?e:function(i,s){return i&&r?r:e}}function dve(t,e){return Rn(DE,t)?DE[t](e._strict,e._locale):new RegExp(gve(t))}function gve(t){return jh(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,i,s,n){return r||i||s||n}))}function jh(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Nl(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function gn(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Nl(e)),r}var VP={};function ei(t,e){var r,i=e,s;for(typeof t=="string"&&(t=[t]),Zh(e)&&(i=function(n,o){o[e]=gn(n)}),s=t.length,r=0;r<s;r++)VP[t[r]]=i}function YC(t,e){ei(t,function(r,i,s,n){s._w=s._w||{},e(r,s._w,s,n)})}function mve(t,e,r){e!=null&&Rn(VP,t)&&VP[t](e,r._a,r,t)}function I_(t){return t%4===0&&t%100!==0||t%400===0}var Mo=0,Dh=1,Pu=2,Ps=3,Tc=4,Lh=5,ng=6,pve=7,vve=8;Rr("Y",0,0,function(){var t=this.year();return t<=9999?Bu(t,4):"+"+t});Rr(0,["YY",2],0,function(){return this.year()%100});Rr(0,["YYYY",4],0,"year");Rr(0,["YYYYY",5],0,"year");Rr(0,["YYYYYY",6,!0],0,"year");ir("Y",A_);ir("YY",Ci,cl);ir("YYYY",Ek,xk);ir("YYYYY",R_,T_);ir("YYYYYY",R_,T_);ei(["YYYYY","YYYYYY"],Mo);ei("YYYY",function(t,e){e[Mo]=t.length===2?wt.parseTwoDigitYear(t):gn(t)});ei("YY",function(t,e){e[Mo]=wt.parseTwoDigitYear(t)});ei("Y",function(t,e){e[Mo]=parseInt(t,10)});function ny(t){return I_(t)?366:365}wt.parseTwoDigitYear=function(t){return gn(t)+(gn(t)>68?1900:2e3)};var YK=I1("FullYear",!0);function wve(){return I_(this.year())}function I1(t,e){return function(r){return r!=null?(KK(this,t,r),wt.updateOffset(this,e),this):Qy(this,t)}}function Qy(t,e){if(!t.isValid())return NaN;var r=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return i?r.getUTCSeconds():r.getSeconds();case"Minutes":return i?r.getUTCMinutes():r.getMinutes();case"Hours":return i?r.getUTCHours():r.getHours();case"Date":return i?r.getUTCDate():r.getDate();case"Day":return i?r.getUTCDay():r.getDay();case"Month":return i?r.getUTCMonth():r.getMonth();case"FullYear":return i?r.getUTCFullYear():r.getFullYear();default:return NaN}}function KK(t,e,r){var i,s,n,o,l;if(!(!t.isValid()||isNaN(r))){switch(i=t._d,s=t._isUTC,e){case"Milliseconds":return void(s?i.setUTCMilliseconds(r):i.setMilliseconds(r));case"Seconds":return void(s?i.setUTCSeconds(r):i.setSeconds(r));case"Minutes":return void(s?i.setUTCMinutes(r):i.setMinutes(r));case"Hours":return void(s?i.setUTCHours(r):i.setHours(r));case"Date":return void(s?i.setUTCDate(r):i.setDate(r));case"FullYear":break;default:return}n=r,o=t.month(),l=t.date(),l=l===29&&o===1&&!I_(n)?28:l,s?i.setUTCFullYear(n,o,l):i.setFullYear(n,o,l)}}function yve(t){return t=Yl(t),Ku(this[t])?this[t]():this}function Cve(t,e){if(typeof t=="object"){t=bk(t);var r=uve(t),i,s=r.length;for(i=0;i<s;i++)this[r[i].unit](t[r[i].unit])}else if(t=Yl(t),Ku(this[t]))return this[t](e);return this}function Sve(t,e){return(t%e+e)%e}var ts;Array.prototype.indexOf?ts=Array.prototype.indexOf:ts=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function _k(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Sve(e,12);return t+=(e-r)/12,r===1?I_(t)?29:28:31-r%7%2}Rr("M",["MM",2],"Mo",function(){return this.month()+1});Rr("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Rr("MMMM",0,0,function(t){return this.localeData().months(this,t)});ir("M",Ci,O1);ir("MM",Ci,cl);ir("MMM",function(t,e){return e.monthsShortRegex(t)});ir("MMMM",function(t,e){return e.monthsRegex(t)});ei(["M","MM"],function(t,e){e[Dh]=gn(t)-1});ei(["MMM","MMMM"],function(t,e,r,i){var s=r._locale.monthsParse(t,i,r._strict);s!=null?e[Dh]=s:Kr(r).invalidMonth=t});var bve="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),XK="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),qK=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,xve=GC,Eve=GC;function Tve(t,e){return t?Mc(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||qK).test(e)?"format":"standalone"][t.month()]:Mc(this._months)?this._months:this._months.standalone}function _ve(t,e){return t?Mc(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[qK.test(e)?"format":"standalone"][t.month()]:Mc(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Rve(t,e,r){var i,s,n,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)n=Yu([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(n,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(n,"").toLocaleLowerCase();return r?e==="MMM"?(s=ts.call(this._shortMonthsParse,o),s!==-1?s:null):(s=ts.call(this._longMonthsParse,o),s!==-1?s:null):e==="MMM"?(s=ts.call(this._shortMonthsParse,o),s!==-1?s:(s=ts.call(this._longMonthsParse,o),s!==-1?s:null)):(s=ts.call(this._longMonthsParse,o),s!==-1?s:(s=ts.call(this._shortMonthsParse,o),s!==-1?s:null))}function Ave(t,e,r){var i,s,n;if(this._monthsParseExact)return Rve.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(s=Yu([2e3,i]),r&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[i]&&(n="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(n.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(r&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!r&&this._monthsParse[i].test(t))return i}}function JK(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=gn(e);else if(e=t.localeData().monthsParse(e),!Zh(e))return t}var r=e,i=t.date();return i=i<29?i:Math.min(i,_k(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,i):t._d.setMonth(r,i),t}function QK(t){return t!=null?(JK(this,t),wt.updateOffset(this,!0),this):Qy(this,"Month")}function Ove(){return _k(this.year(),this.month())}function Ive(t){return this._monthsParseExact?(Rn(this,"_monthsRegex")||ZK.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Rn(this,"_monthsShortRegex")||(this._monthsShortRegex=xve),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Pve(t){return this._monthsParseExact?(Rn(this,"_monthsRegex")||ZK.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Rn(this,"_monthsRegex")||(this._monthsRegex=Eve),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function ZK(){function t(h,d){return d.length-h.length}var e=[],r=[],i=[],s,n,o,l;for(s=0;s<12;s++)n=Yu([2e3,s]),o=jh(this.monthsShort(n,"")),l=jh(this.months(n,"")),e.push(o),r.push(l),i.push(l),i.push(o);e.sort(t),r.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Fve(t,e,r,i,s,n,o){var l;return t<100&&t>=0?(l=new Date(t+400,e,r,i,s,n,o),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,r,i,s,n,o),l}function Zy(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function LE(t,e,r){var i=7+e-r,s=(7+Zy(t,0,i).getUTCDay()-e)%7;return-s+i-1}function eX(t,e,r,i,s){var n=(7+r-i)%7,o=LE(t,i,s),l=1+7*(e-1)+n+o,h,d;return l<=0?(h=t-1,d=ny(h)+l):l>ny(t)?(h=t+1,d=l-ny(t)):(h=t,d=l),{year:h,dayOfYear:d}}function eC(t,e,r){var i=LE(t.year(),e,r),s=Math.floor((t.dayOfYear()-i-1)/7)+1,n,o;return s<1?(o=t.year()-1,n=s+Uh(o,e,r)):s>Uh(t.year(),e,r)?(n=s-Uh(t.year(),e,r),o=t.year()+1):(o=t.year(),n=s),{week:n,year:o}}function Uh(t,e,r){var i=LE(t,e,r),s=LE(t+1,e,r);return(ny(t)-i+s)/7}Rr("w",["ww",2],"wo","week");Rr("W",["WW",2],"Wo","isoWeek");ir("w",Ci,O1);ir("ww",Ci,cl);ir("W",Ci,O1);ir("WW",Ci,cl);YC(["w","ww","W","WW"],function(t,e,r,i){e[i.substr(0,1)]=gn(t)});function Mve(t){return eC(t,this._week.dow,this._week.doy).week}var kve={dow:0,doy:6};function Nve(){return this._week.dow}function Dve(){return this._week.doy}function Lve(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Hve(t){var e=eC(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Rr("d",0,"do","day");Rr("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Rr("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Rr("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Rr("e",0,0,"weekday");Rr("E",0,0,"isoWeekday");ir("d",Ci);ir("e",Ci);ir("E",Ci);ir("dd",function(t,e){return e.weekdaysMinRegex(t)});ir("ddd",function(t,e){return e.weekdaysShortRegex(t)});ir("dddd",function(t,e){return e.weekdaysRegex(t)});YC(["dd","ddd","dddd"],function(t,e,r,i){var s=r._locale.weekdaysParse(t,i,r._strict);s!=null?e.d=s:Kr(r).invalidWeekday=t});YC(["d","e","E"],function(t,e,r,i){e[i]=gn(t)});function $ve(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Bve(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Rk(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Vve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),tX="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Wve="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),jve=GC,Uve=GC,zve=GC;function Gve(t,e){var r=Mc(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Rk(r,this._week.dow):t?r[t.day()]:r}function Yve(t){return t===!0?Rk(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Kve(t){return t===!0?Rk(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Xve(t,e,r){var i,s,n,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)n=Yu([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(n,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(n,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(n,"").toLocaleLowerCase();return r?e==="dddd"?(s=ts.call(this._weekdaysParse,o),s!==-1?s:null):e==="ddd"?(s=ts.call(this._shortWeekdaysParse,o),s!==-1?s:null):(s=ts.call(this._minWeekdaysParse,o),s!==-1?s:null):e==="dddd"?(s=ts.call(this._weekdaysParse,o),s!==-1||(s=ts.call(this._shortWeekdaysParse,o),s!==-1)?s:(s=ts.call(this._minWeekdaysParse,o),s!==-1?s:null)):e==="ddd"?(s=ts.call(this._shortWeekdaysParse,o),s!==-1||(s=ts.call(this._weekdaysParse,o),s!==-1)?s:(s=ts.call(this._minWeekdaysParse,o),s!==-1?s:null)):(s=ts.call(this._minWeekdaysParse,o),s!==-1||(s=ts.call(this._weekdaysParse,o),s!==-1)?s:(s=ts.call(this._shortWeekdaysParse,o),s!==-1?s:null))}function qve(t,e,r){var i,s,n;if(this._weekdaysParseExact)return Xve.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(s=Yu([2e3,1]).day(i),r&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(n="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[i]=new RegExp(n.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(r&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(r&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!r&&this._weekdaysParse[i].test(t))return i}}function Jve(t){if(!this.isValid())return t!=null?this:NaN;var e=Qy(this,"Day");return t!=null?(t=$ve(t,this.localeData()),this.add(t-e,"d")):e}function Qve(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Zve(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Bve(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function ewe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ak.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Rn(this,"_weekdaysRegex")||(this._weekdaysRegex=jve),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function twe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ak.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Rn(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Uve),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function rwe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ak.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Rn(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=zve),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ak(){function t(g,y){return y.length-g.length}var e=[],r=[],i=[],s=[],n,o,l,h,d;for(n=0;n<7;n++)o=Yu([2e3,1]).day(n),l=jh(this.weekdaysMin(o,"")),h=jh(this.weekdaysShort(o,"")),d=jh(this.weekdays(o,"")),e.push(l),r.push(h),i.push(d),s.push(l),s.push(h),s.push(d);e.sort(t),r.sort(t),i.sort(t),s.sort(t),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Ok(){return this.hours()%12||12}function nwe(){return this.hours()||24}Rr("H",["HH",2],0,"hour");Rr("h",["hh",2],0,Ok);Rr("k",["kk",2],0,nwe);Rr("hmm",0,0,function(){return""+Ok.apply(this)+Bu(this.minutes(),2)});Rr("hmmss",0,0,function(){return""+Ok.apply(this)+Bu(this.minutes(),2)+Bu(this.seconds(),2)});Rr("Hmm",0,0,function(){return""+this.hours()+Bu(this.minutes(),2)});Rr("Hmmss",0,0,function(){return""+this.hours()+Bu(this.minutes(),2)+Bu(this.seconds(),2)});function rX(t,e){Rr(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}rX("a",!0);rX("A",!1);function nX(t,e){return e._meridiemParse}ir("a",nX);ir("A",nX);ir("H",Ci,Tk);ir("h",Ci,O1);ir("k",Ci,O1);ir("HH",Ci,cl);ir("hh",Ci,cl);ir("kk",Ci,cl);ir("hmm",zK);ir("hmmss",GK);ir("Hmm",zK);ir("Hmmss",GK);ei(["H","HH"],Ps);ei(["k","kk"],function(t,e,r){var i=gn(t);e[Ps]=i===24?0:i});ei(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});ei(["h","hh"],function(t,e,r){e[Ps]=gn(t),Kr(r).bigHour=!0});ei("hmm",function(t,e,r){var i=t.length-2;e[Ps]=gn(t.substr(0,i)),e[Tc]=gn(t.substr(i)),Kr(r).bigHour=!0});ei("hmmss",function(t,e,r){var i=t.length-4,s=t.length-2;e[Ps]=gn(t.substr(0,i)),e[Tc]=gn(t.substr(i,2)),e[Lh]=gn(t.substr(s)),Kr(r).bigHour=!0});ei("Hmm",function(t,e,r){var i=t.length-2;e[Ps]=gn(t.substr(0,i)),e[Tc]=gn(t.substr(i))});ei("Hmmss",function(t,e,r){var i=t.length-4,s=t.length-2;e[Ps]=gn(t.substr(0,i)),e[Tc]=gn(t.substr(i,2)),e[Lh]=gn(t.substr(s))});function iwe(t){return(t+"").toLowerCase().charAt(0)==="p"}var swe=/[ap]\.?m?\.?/i,owe=I1("Hours",!0);function awe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var iX={calendar:X1e,longDateFormat:Z1e,invalidDate:tve,ordinal:nve,dayOfMonthOrdinalParse:ive,relativeTime:ove,months:bve,monthsShort:XK,week:kve,weekdays:Vve,weekdaysMin:Wve,weekdaysShort:tX,meridiemParse:swe},Ei={},kv={},tC;function lwe(t,e){var r,i=Math.min(t.length,e.length);for(r=0;r<i;r+=1)if(t[r]!==e[r])return r;return i}function L9(t){return t&&t.toLowerCase().replace("_","-")}function cwe(t){for(var e=0,r,i,s,n;e<t.length;){for(n=L9(t[e]).split("-"),r=n.length,i=L9(t[e+1]),i=i?i.split("-"):null;r>0;){if(s=P_(n.slice(0,r).join("-")),s)return s;if(i&&i.length>=r&&lwe(n,i)>=r-1)break;r--}e++}return tC}function uwe(t){return!!(t&&t.match("^[^/\\\\]*$"))}function P_(t){var e=null,r;if(Ei[t]===void 0&&typeof iE<"u"&&iE&&iE.exports&&uwe(t))try{e=tC._abbr,r=require,r("./locale/"+t),Cd(e)}catch{Ei[t]=null}return Ei[t]}function Cd(t,e){var r;return t&&(ya(e)?r=lf(t):r=Ik(t,e),r?tC=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tC._abbr}function Ik(t,e){if(e!==null){var r,i=iX;if(e.abbr=t,Ei[t]!=null)VK("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ei[t]._config;else if(e.parentLocale!=null)if(Ei[e.parentLocale]!=null)i=Ei[e.parentLocale]._config;else if(r=P_(e.parentLocale),r!=null)i=r._config;else return kv[e.parentLocale]||(kv[e.parentLocale]=[]),kv[e.parentLocale].push({name:t,config:e}),null;return Ei[t]=new Ck($P(i,e)),kv[t]&&kv[t].forEach(function(s){Ik(s.name,s.config)}),Cd(t),Ei[t]}else return delete Ei[t],null}function hwe(t,e){if(e!=null){var r,i,s=iX;Ei[t]!=null&&Ei[t].parentLocale!=null?Ei[t].set($P(Ei[t]._config,e)):(i=P_(t),i!=null&&(s=i._config),e=$P(s,e),i==null&&(e.abbr=t),r=new Ck(e),r.parentLocale=Ei[t],Ei[t]=r),Cd(t)}else Ei[t]!=null&&(Ei[t].parentLocale!=null?(Ei[t]=Ei[t].parentLocale,t===Cd()&&Cd(t)):Ei[t]!=null&&delete Ei[t]);return Ei[t]}function lf(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tC;if(!Mc(t)){if(e=P_(t),e)return e;t=[t]}return cwe(t)}function fwe(){return BP(Ei)}function Pk(t){var e,r=t._a;return r&&Kr(t).overflow===-2&&(e=r[Dh]<0||r[Dh]>11?Dh:r[Pu]<1||r[Pu]>_k(r[Mo],r[Dh])?Pu:r[Ps]<0||r[Ps]>24||r[Ps]===24&&(r[Tc]!==0||r[Lh]!==0||r[ng]!==0)?Ps:r[Tc]<0||r[Tc]>59?Tc:r[Lh]<0||r[Lh]>59?Lh:r[ng]<0||r[ng]>999?ng:-1,Kr(t)._overflowDayOfYear&&(e<Mo||e>Pu)&&(e=Pu),Kr(t)._overflowWeeks&&e===-1&&(e=pve),Kr(t)._overflowWeekday&&e===-1&&(e=vve),Kr(t).overflow=e),t}var dwe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gwe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mwe=/Z|[+-]\d\d(?::?\d\d)?/,Ob=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Z4=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pwe=/^\/?Date\((-?\d+)/i,vwe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wwe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function sX(t){var e,r,i=t._i,s=dwe.exec(i)||gwe.exec(i),n,o,l,h,d=Ob.length,g=Z4.length;if(s){for(Kr(t).iso=!0,e=0,r=d;e<r;e++)if(Ob[e][1].exec(s[1])){o=Ob[e][0],n=Ob[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(s[3]){for(e=0,r=g;e<r;e++)if(Z4[e][1].exec(s[3])){l=(s[2]||" ")+Z4[e][0];break}if(l==null){t._isValid=!1;return}}if(!n&&l!=null){t._isValid=!1;return}if(s[4])if(mwe.exec(s[4]))h="Z";else{t._isValid=!1;return}t._f=o+(l||"")+(h||""),Mk(t)}else t._isValid=!1}function ywe(t,e,r,i,s,n){var o=[Cwe(t),XK.indexOf(e),parseInt(r,10),parseInt(i,10),parseInt(s,10)];return n&&o.push(parseInt(n,10)),o}function Cwe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Swe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bwe(t,e,r){if(t){var i=tX.indexOf(t),s=new Date(e[0],e[1],e[2]).getDay();if(i!==s)return Kr(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function xwe(t,e,r){if(t)return wwe[t];if(e)return 0;var i=parseInt(r,10),s=i%100,n=(i-s)/100;return n*60+s}function oX(t){var e=vwe.exec(Swe(t._i)),r;if(e){if(r=ywe(e[4],e[3],e[2],e[5],e[6],e[7]),!bwe(e[1],r,t))return;t._a=r,t._tzm=xwe(e[8],e[9],e[10]),t._d=Zy.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Kr(t).rfc2822=!0}else t._isValid=!1}function Ewe(t){var e=pwe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(sX(t),t._isValid===!1)delete t._isValid;else return;if(oX(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:wt.createFromInputFallback(t)}wt.createFromInputFallback=Gl("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function sp(t,e,r){return t??e??r}function Twe(t){var e=new Date(wt.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Fk(t){var e,r,i=[],s,n,o;if(!t._d){for(s=Twe(t),t._w&&t._a[Pu]==null&&t._a[Dh]==null&&_we(t),t._dayOfYear!=null&&(o=sp(t._a[Mo],s[Mo]),(t._dayOfYear>ny(o)||t._dayOfYear===0)&&(Kr(t)._overflowDayOfYear=!0),r=Zy(o,0,t._dayOfYear),t._a[Dh]=r.getUTCMonth(),t._a[Pu]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=s[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Ps]===24&&t._a[Tc]===0&&t._a[Lh]===0&&t._a[ng]===0&&(t._nextDay=!0,t._a[Ps]=0),t._d=(t._useUTC?Zy:Fve).apply(null,i),n=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Ps]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==n&&(Kr(t).weekdayMismatch=!0)}}function _we(t){var e,r,i,s,n,o,l,h,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(n=1,o=4,r=sp(e.GG,t._a[Mo],eC(wi(),1,4).year),i=sp(e.W,1),s=sp(e.E,1),(s<1||s>7)&&(h=!0)):(n=t._locale._week.dow,o=t._locale._week.doy,d=eC(wi(),n,o),r=sp(e.gg,t._a[Mo],d.year),i=sp(e.w,d.week),e.d!=null?(s=e.d,(s<0||s>6)&&(h=!0)):e.e!=null?(s=e.e+n,(e.e<0||e.e>6)&&(h=!0)):s=n),i<1||i>Uh(r,n,o)?Kr(t)._overflowWeeks=!0:h!=null?Kr(t)._overflowWeekday=!0:(l=eX(r,i,s,n,o),t._a[Mo]=l.year,t._dayOfYear=l.dayOfYear)}wt.ISO_8601=function(){};wt.RFC_2822=function(){};function Mk(t){if(t._f===wt.ISO_8601){sX(t);return}if(t._f===wt.RFC_2822){oX(t);return}t._a=[],Kr(t).empty=!0;var e=""+t._i,r,i,s,n,o,l=e.length,h=0,d,g;for(s=WK(t._f,t._locale).match(Sk)||[],g=s.length,r=0;r<g;r++)n=s[r],i=(e.match(dve(n,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&Kr(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),h+=i.length),Vp[n]?(i?Kr(t).empty=!1:Kr(t).unusedTokens.push(n),mve(n,i,t)):t._strict&&!i&&Kr(t).unusedTokens.push(n);Kr(t).charsLeftOver=l-h,e.length>0&&Kr(t).unusedInput.push(e),t._a[Ps]<=12&&Kr(t).bigHour===!0&&t._a[Ps]>0&&(Kr(t).bigHour=void 0),Kr(t).parsedDateParts=t._a.slice(0),Kr(t).meridiem=t._meridiem,t._a[Ps]=Rwe(t._locale,t._a[Ps],t._meridiem),d=Kr(t).era,d!==null&&(t._a[Mo]=t._locale.erasConvertYear(d,t._a[Mo])),Fk(t),Pk(t)}function Rwe(t,e,r){var i;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(i=t.isPM(r),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Awe(t){var e,r,i,s,n,o,l=!1,h=t._f.length;if(h===0){Kr(t).invalidFormat=!0,t._d=new Date(NaN);return}for(s=0;s<h;s++)n=0,o=!1,e=yk({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[s],Mk(e),wk(e)&&(o=!0),n+=Kr(e).charsLeftOver,n+=Kr(e).unusedTokens.length*10,Kr(e).score=n,l?n<i&&(i=n,r=e):(i==null||n<i||o)&&(i=n,r=e,o&&(l=!0));nd(t,r||e)}function Owe(t){if(!t._d){var e=bk(t._i),r=e.day===void 0?e.date:e.day;t._a=$K([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),Fk(t)}}function Iwe(t){var e=new zC(Pk(aX(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function aX(t){var e=t._i,r=t._f;return t._locale=t._locale||lf(t._l),e===null||r===void 0&&e===""?E_({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),kc(e)?new zC(Pk(e)):(UC(e)?t._d=e:Mc(r)?Awe(t):r?Mk(t):Pwe(t),wk(t)||(t._d=null),t))}function Pwe(t){var e=t._i;ya(e)?t._d=new Date(wt.now()):UC(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Ewe(t):Mc(e)?(t._a=$K(e.slice(0),function(r){return parseInt(r,10)}),Fk(t)):mg(e)?Owe(t):Zh(e)?t._d=new Date(e):wt.createFromInputFallback(t)}function lX(t,e,r,i,s){var n={};return(e===!0||e===!1)&&(i=e,e=void 0),(r===!0||r===!1)&&(i=r,r=void 0),(mg(t)&&vk(t)||Mc(t)&&t.length===0)&&(t=void 0),n._isAMomentObject=!0,n._useUTC=n._isUTC=s,n._l=r,n._i=t,n._f=e,n._strict=i,Iwe(n)}function wi(t,e,r,i){return lX(t,e,r,i,!1)}var Fwe=Gl("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=wi.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:E_()}),Mwe=Gl("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=wi.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:E_()});function cX(t,e){var r,i;if(e.length===1&&Mc(e[0])&&(e=e[0]),!e.length)return wi();for(r=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](r))&&(r=e[i]);return r}function kwe(){var t=[].slice.call(arguments,0);return cX("isBefore",t)}function Nwe(){var t=[].slice.call(arguments,0);return cX("isAfter",t)}var Dwe=function(){return Date.now?Date.now():+new Date},Nv=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Lwe(t){var e,r=!1,i,s=Nv.length;for(e in t)if(Rn(t,e)&&!(ts.call(Nv,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<s;++i)if(t[Nv[i]]){if(r)return!1;parseFloat(t[Nv[i]])!==gn(t[Nv[i]])&&(r=!0)}return!0}function Hwe(){return this._isValid}function $we(){return $c(NaN)}function F_(t){var e=bk(t),r=e.year||0,i=e.quarter||0,s=e.month||0,n=e.week||e.isoWeek||0,o=e.day||0,l=e.hour||0,h=e.minute||0,d=e.second||0,g=e.millisecond||0;this._isValid=Lwe(e),this._milliseconds=+g+d*1e3+h*6e4+l*1e3*60*60,this._days=+o+n*7,this._months=+s+i*3+r*12,this._data={},this._locale=lf(),this._bubble()}function D2(t){return t instanceof F_}function WP(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Bwe(t,e,r){var i=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),n=0,o;for(o=0;o<i;o++)gn(t[o])!==gn(e[o])&&n++;return n+s}function uX(t,e){Rr(t,0,0,function(){var r=this.utcOffset(),i="+";return r<0&&(r=-r,i="-"),i+Bu(~~(r/60),2)+e+Bu(~~r%60,2)})}uX("Z",":");uX("ZZ","");ir("Z",O_);ir("ZZ",O_);ei(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=kk(O_,t)});var Vwe=/([\+\-]|\d\d)/gi;function kk(t,e){var r=(e||"").match(t),i,s,n;return r===null?null:(i=r[r.length-1]||[],s=(i+"").match(Vwe)||["-",0,0],n=+(s[1]*60)+gn(s[2]),n===0?0:s[0]==="+"?n:-n)}function Nk(t,e){var r,i;return e._isUTC?(r=e.clone(),i=(kc(t)||UC(t)?t.valueOf():wi(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),wt.updateOffset(r,!1),r):wi(t).local()}function jP(t){return-Math.round(t._d.getTimezoneOffset())}wt.updateOffset=function(){};function Wwe(t,e,r){var i=this._offset||0,s;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=kk(O_,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(s=jP(this)),this._offset=t,this._isUTC=!0,s!=null&&this.add(s,"m"),i!==t&&(!e||this._changeInProgress?dX(this,$c(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,wt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:jP(this)}function jwe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Uwe(t){return this.utcOffset(0,t)}function zwe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(jP(this),"m")),this}function Gwe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=kk(hve,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Ywe(t){return this.isValid()?(t=t?wi(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Kwe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Xwe(){if(!ya(this._isDSTShifted))return this._isDSTShifted;var t={},e;return yk(t,this),t=aX(t),t._a?(e=t._isUTC?Yu(t._a):wi(t._a),this._isDSTShifted=this.isValid()&&Bwe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function qwe(){return this.isValid()?!this._isUTC:!1}function Jwe(){return this.isValid()?this._isUTC:!1}function hX(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Qwe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Zwe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function $c(t,e){var r=t,i=null,s,n,o;return D2(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:Zh(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(i=Qwe.exec(t))?(s=i[1]==="-"?-1:1,r={y:0,d:gn(i[Pu])*s,h:gn(i[Ps])*s,m:gn(i[Tc])*s,s:gn(i[Lh])*s,ms:gn(WP(i[ng]*1e3))*s}):(i=Zwe.exec(t))?(s=i[1]==="-"?-1:1,r={y:o0(i[2],s),M:o0(i[3],s),w:o0(i[4],s),d:o0(i[5],s),h:o0(i[6],s),m:o0(i[7],s),s:o0(i[8],s)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=eye(wi(r.from),wi(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),n=new F_(r),D2(t)&&Rn(t,"_locale")&&(n._locale=t._locale),D2(t)&&Rn(t,"_isValid")&&(n._isValid=t._isValid),n}$c.fn=F_.prototype;$c.invalid=$we;function o0(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function H9(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function eye(t,e){var r;return t.isValid()&&e.isValid()?(e=Nk(e,t),t.isBefore(e)?r=H9(t,e):(r=H9(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function fX(t,e){return function(r,i){var s,n;return i!==null&&!isNaN(+i)&&(VK(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=r,r=i,i=n),s=$c(r,i),dX(this,s,t),this}}function dX(t,e,r,i){var s=e._milliseconds,n=WP(e._days),o=WP(e._months);t.isValid()&&(i=i??!0,o&&JK(t,Qy(t,"Month")+o*r),n&&KK(t,"Date",Qy(t,"Date")+n*r),s&&t._d.setTime(t._d.valueOf()+s*r),i&&wt.updateOffset(t,n||o))}var tye=fX(1,"add"),rye=fX(-1,"subtract");function gX(t){return typeof t=="string"||t instanceof String}function nye(t){return kc(t)||UC(t)||gX(t)||Zh(t)||sye(t)||iye(t)||t===null||t===void 0}function iye(t){var e=mg(t)&&!vk(t),r=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,n,o=i.length;for(s=0;s<o;s+=1)n=i[s],r=r||Rn(t,n);return e&&r}function sye(t){var e=Mc(t),r=!1;return e&&(r=t.filter(function(i){return!Zh(i)&&gX(t)}).length===0),e&&r}function oye(t){var e=mg(t)&&!vk(t),r=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,n;for(s=0;s<i.length;s+=1)n=i[s],r=r||Rn(t,n);return e&&r}function aye(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function lye(t,e){arguments.length===1&&(arguments[0]?nye(arguments[0])?(t=arguments[0],e=void 0):oye(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||wi(),i=Nk(r,this).startOf("day"),s=wt.calendarFormat(this,i)||"sameElse",n=e&&(Ku(e[s])?e[s].call(this,r):e[s]);return this.format(n||this.localeData().calendar(s,this,wi(r)))}function cye(){return new zC(this)}function uye(t,e){var r=kc(t)?t:wi(t);return this.isValid()&&r.isValid()?(e=Yl(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function hye(t,e){var r=kc(t)?t:wi(t);return this.isValid()&&r.isValid()?(e=Yl(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function fye(t,e,r,i){var s=kc(t)?t:wi(t),n=kc(e)?e:wi(e);return this.isValid()&&s.isValid()&&n.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(s,r):!this.isBefore(s,r))&&(i[1]===")"?this.isBefore(n,r):!this.isAfter(n,r))):!1}function dye(t,e){var r=kc(t)?t:wi(t),i;return this.isValid()&&r.isValid()?(e=Yl(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function gye(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function mye(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function pye(t,e,r){var i,s,n;if(!this.isValid())return NaN;if(i=Nk(t,this),!i.isValid())return NaN;switch(s=(i.utcOffset()-this.utcOffset())*6e4,e=Yl(e),e){case"year":n=L2(this,i)/12;break;case"month":n=L2(this,i);break;case"quarter":n=L2(this,i)/3;break;case"second":n=(this-i)/1e3;break;case"minute":n=(this-i)/6e4;break;case"hour":n=(this-i)/36e5;break;case"day":n=(this-i-s)/864e5;break;case"week":n=(this-i-s)/6048e5;break;default:n=this-i}return r?n:Nl(n)}function L2(t,e){if(t.date()<e.date())return-L2(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(r,"months"),s,n;return e-i<0?(s=t.clone().add(r-1,"months"),n=(e-i)/(i-s)):(s=t.clone().add(r+1,"months"),n=(e-i)/(s-i)),-(r+n)||0}wt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";wt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function vye(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wye(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?N2(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ku(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",N2(r,"Z")):N2(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function yye(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,i,s,n;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",n=e+'[")]',this.format(r+i+s+n)}function Cye(t){t||(t=this.isUtc()?wt.defaultFormatUtc:wt.defaultFormat);var e=N2(this,t);return this.localeData().postformat(e)}function Sye(t,e){return this.isValid()&&(kc(t)&&t.isValid()||wi(t).isValid())?$c({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function bye(t){return this.from(wi(),t)}function xye(t,e){return this.isValid()&&(kc(t)&&t.isValid()||wi(t).isValid())?$c({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Eye(t){return this.to(wi(),t)}function mX(t){var e;return t===void 0?this._locale._abbr:(e=lf(t),e!=null&&(this._locale=e),this)}var pX=Gl("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function vX(){return this._locale}var HE=1e3,Wp=60*HE,$E=60*Wp,wX=(365*400+97)*24*$E;function jp(t,e){return(t%e+e)%e}function yX(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-wX:new Date(t,e,r).valueOf()}function CX(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-wX:Date.UTC(t,e,r)}function Tye(t){var e,r;if(t=Yl(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?CX:yX,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=jp(e+(this._isUTC?0:this.utcOffset()*Wp),$E);break;case"minute":e=this._d.valueOf(),e-=jp(e,Wp);break;case"second":e=this._d.valueOf(),e-=jp(e,HE);break}return this._d.setTime(e),wt.updateOffset(this,!0),this}function _ye(t){var e,r;if(t=Yl(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?CX:yX,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=$E-jp(e+(this._isUTC?0:this.utcOffset()*Wp),$E)-1;break;case"minute":e=this._d.valueOf(),e+=Wp-jp(e,Wp)-1;break;case"second":e=this._d.valueOf(),e+=HE-jp(e,HE)-1;break}return this._d.setTime(e),wt.updateOffset(this,!0),this}function Rye(){return this._d.valueOf()-(this._offset||0)*6e4}function Aye(){return Math.floor(this.valueOf()/1e3)}function Oye(){return new Date(this.valueOf())}function Iye(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Pye(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Fye(){return this.isValid()?this.toISOString():null}function Mye(){return wk(this)}function kye(){return nd({},Kr(this))}function Nye(){return Kr(this).overflow}function Dye(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Rr("N",0,0,"eraAbbr");Rr("NN",0,0,"eraAbbr");Rr("NNN",0,0,"eraAbbr");Rr("NNNN",0,0,"eraName");Rr("NNNNN",0,0,"eraNarrow");Rr("y",["y",1],"yo","eraYear");Rr("y",["yy",2],0,"eraYear");Rr("y",["yyy",3],0,"eraYear");Rr("y",["yyyy",4],0,"eraYear");ir("N",Dk);ir("NN",Dk);ir("NNN",Dk);ir("NNNN",Yye);ir("NNNNN",Kye);ei(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,i){var s=r._locale.erasParse(t,i,r._strict);s?Kr(r).era=s:Kr(r).invalidEra=t});ir("y",A1);ir("yy",A1);ir("yyy",A1);ir("yyyy",A1);ir("yo",Xye);ei(["y","yy","yyy","yyyy"],Mo);ei(["yo"],function(t,e,r,i){var s;r._locale._eraYearOrdinalRegex&&(s=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[Mo]=r._locale.eraYearOrdinalParse(t,s):e[Mo]=parseInt(t,10)});function Lye(t,e){var r,i,s,n=this._eras||lf("en")._eras;for(r=0,i=n.length;r<i;++r){switch(typeof n[r].since){case"string":s=wt(n[r].since).startOf("day"),n[r].since=s.valueOf();break}switch(typeof n[r].until){case"undefined":n[r].until=1/0;break;case"string":s=wt(n[r].until).startOf("day").valueOf(),n[r].until=s.valueOf();break}}return n}function Hye(t,e,r){var i,s,n=this.eras(),o,l,h;for(t=t.toUpperCase(),i=0,s=n.length;i<s;++i)if(o=n[i].name.toUpperCase(),l=n[i].abbr.toUpperCase(),h=n[i].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(l===t)return n[i];break;case"NNNN":if(o===t)return n[i];break;case"NNNNN":if(h===t)return n[i];break}else if([o,l,h].indexOf(t)>=0)return n[i]}function $ye(t,e){var r=t.since<=t.until?1:-1;return e===void 0?wt(t.since).year():wt(t.since).year()+(e-t.offset)*r}function Bye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].name;return""}function Vye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].narrow;return""}function Wye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].abbr;return""}function jye(){var t,e,r,i,s=this.localeData().eras();for(t=0,e=s.length;t<e;++t)if(r=s[t].since<=s[t].until?1:-1,i=this.clone().startOf("day").valueOf(),s[t].since<=i&&i<=s[t].until||s[t].until<=i&&i<=s[t].since)return(this.year()-wt(s[t].since).year())*r+s[t].offset;return this.year()}function Uye(t){return Rn(this,"_erasNameRegex")||Lk.call(this),t?this._erasNameRegex:this._erasRegex}function zye(t){return Rn(this,"_erasAbbrRegex")||Lk.call(this),t?this._erasAbbrRegex:this._erasRegex}function Gye(t){return Rn(this,"_erasNarrowRegex")||Lk.call(this),t?this._erasNarrowRegex:this._erasRegex}function Dk(t,e){return e.erasAbbrRegex(t)}function Yye(t,e){return e.erasNameRegex(t)}function Kye(t,e){return e.erasNarrowRegex(t)}function Xye(t,e){return e._eraYearOrdinalRegex||A1}function Lk(){var t=[],e=[],r=[],i=[],s,n,o,l,h,d=this.eras();for(s=0,n=d.length;s<n;++s)o=jh(d[s].name),l=jh(d[s].abbr),h=jh(d[s].narrow),e.push(o),t.push(l),r.push(h),i.push(o),i.push(l),i.push(h);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Rr(0,["gg",2],0,function(){return this.weekYear()%100});Rr(0,["GG",2],0,function(){return this.isoWeekYear()%100});function M_(t,e){Rr(0,[t,t.length],0,e)}M_("gggg","weekYear");M_("ggggg","weekYear");M_("GGGG","isoWeekYear");M_("GGGGG","isoWeekYear");ir("G",A_);ir("g",A_);ir("GG",Ci,cl);ir("gg",Ci,cl);ir("GGGG",Ek,xk);ir("gggg",Ek,xk);ir("GGGGG",R_,T_);ir("ggggg",R_,T_);YC(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,i){e[i.substr(0,2)]=gn(t)});YC(["gg","GG"],function(t,e,r,i){e[i]=wt.parseTwoDigitYear(t)});function qye(t){return SX.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Jye(t){return SX.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Qye(){return Uh(this.year(),1,4)}function Zye(){return Uh(this.isoWeekYear(),1,4)}function eCe(){var t=this.localeData()._week;return Uh(this.year(),t.dow,t.doy)}function tCe(){var t=this.localeData()._week;return Uh(this.weekYear(),t.dow,t.doy)}function SX(t,e,r,i,s){var n;return t==null?eC(this,i,s).year:(n=Uh(t,i,s),e>n&&(e=n),rCe.call(this,t,e,r,i,s))}function rCe(t,e,r,i,s){var n=eX(t,e,r,i,s),o=Zy(n.year,0,n.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Rr("Q",0,"Qo","quarter");ir("Q",jK);ei("Q",function(t,e){e[Dh]=(gn(t)-1)*3});function nCe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Rr("D",["DD",2],"Do","date");ir("D",Ci,O1);ir("DD",Ci,cl);ir("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ei(["D","DD"],Pu);ei("Do",function(t,e){e[Pu]=gn(t.match(Ci)[0])});var bX=I1("Date",!0);Rr("DDD",["DDDD",3],"DDDo","dayOfYear");ir("DDD",__);ir("DDDD",UK);ei(["DDD","DDDD"],function(t,e,r){r._dayOfYear=gn(t)});function iCe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Rr("m",["mm",2],0,"minute");ir("m",Ci,Tk);ir("mm",Ci,cl);ei(["m","mm"],Tc);var sCe=I1("Minutes",!1);Rr("s",["ss",2],0,"second");ir("s",Ci,Tk);ir("ss",Ci,cl);ei(["s","ss"],Lh);var oCe=I1("Seconds",!1);Rr("S",0,0,function(){return~~(this.millisecond()/100)});Rr(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Rr(0,["SSS",3],0,"millisecond");Rr(0,["SSSS",4],0,function(){return this.millisecond()*10});Rr(0,["SSSSS",5],0,function(){return this.millisecond()*100});Rr(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Rr(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Rr(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Rr(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ir("S",__,jK);ir("SS",__,cl);ir("SSS",__,UK);var id,xX;for(id="SSSS";id.length<=9;id+="S")ir(id,A1);function aCe(t,e){e[ng]=gn(("0."+t)*1e3)}for(id="S";id.length<=9;id+="S")ei(id,aCe);xX=I1("Milliseconds",!1);Rr("z",0,0,"zoneAbbr");Rr("zz",0,0,"zoneName");function lCe(){return this._isUTC?"UTC":""}function cCe(){return this._isUTC?"Coordinated Universal Time":""}var At=zC.prototype;At.add=tye;At.calendar=lye;At.clone=cye;At.diff=pye;At.endOf=_ye;At.format=Cye;At.from=Sye;At.fromNow=bye;At.to=xye;At.toNow=Eye;At.get=yve;At.invalidAt=Nye;At.isAfter=uye;At.isBefore=hye;At.isBetween=fye;At.isSame=dye;At.isSameOrAfter=gye;At.isSameOrBefore=mye;At.isValid=Mye;At.lang=pX;At.locale=mX;At.localeData=vX;At.max=Mwe;At.min=Fwe;At.parsingFlags=kye;At.set=Cve;At.startOf=Tye;At.subtract=rye;At.toArray=Iye;At.toObject=Pye;At.toDate=Oye;At.toISOString=wye;At.inspect=yye;typeof Symbol<"u"&&Symbol.for!=null&&(At[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});At.toJSON=Fye;At.toString=vye;At.unix=Aye;At.valueOf=Rye;At.creationData=Dye;At.eraName=Bye;At.eraNarrow=Vye;At.eraAbbr=Wye;At.eraYear=jye;At.year=YK;At.isLeapYear=wve;At.weekYear=qye;At.isoWeekYear=Jye;At.quarter=At.quarters=nCe;At.month=QK;At.daysInMonth=Ove;At.week=At.weeks=Lve;At.isoWeek=At.isoWeeks=Hve;At.weeksInYear=eCe;At.weeksInWeekYear=tCe;At.isoWeeksInYear=Qye;At.isoWeeksInISOWeekYear=Zye;At.date=bX;At.day=At.days=Jve;At.weekday=Qve;At.isoWeekday=Zve;At.dayOfYear=iCe;At.hour=At.hours=owe;At.minute=At.minutes=sCe;At.second=At.seconds=oCe;At.millisecond=At.milliseconds=xX;At.utcOffset=Wwe;At.utc=Uwe;At.local=zwe;At.parseZone=Gwe;At.hasAlignedHourOffset=Ywe;At.isDST=Kwe;At.isLocal=qwe;At.isUtcOffset=Jwe;At.isUtc=hX;At.isUTC=hX;At.zoneAbbr=lCe;At.zoneName=cCe;At.dates=Gl("dates accessor is deprecated. Use date instead.",bX);At.months=Gl("months accessor is deprecated. Use month instead",QK);At.years=Gl("years accessor is deprecated. Use year instead",YK);At.zone=Gl("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jwe);At.isDSTShifted=Gl("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Xwe);function uCe(t){return wi(t*1e3)}function hCe(){return wi.apply(null,arguments).parseZone()}function EX(t){return t}var An=Ck.prototype;An.calendar=q1e;An.longDateFormat=eve;An.invalidDate=rve;An.ordinal=sve;An.preparse=EX;An.postformat=EX;An.relativeTime=ave;An.pastFuture=lve;An.set=K1e;An.eras=Lye;An.erasParse=Hye;An.erasConvertYear=$ye;An.erasAbbrRegex=zye;An.erasNameRegex=Uye;An.erasNarrowRegex=Gye;An.months=Tve;An.monthsShort=_ve;An.monthsParse=Ave;An.monthsRegex=Pve;An.monthsShortRegex=Ive;An.week=Mve;An.firstDayOfYear=Dve;An.firstDayOfWeek=Nve;An.weekdays=Gve;An.weekdaysMin=Kve;An.weekdaysShort=Yve;An.weekdaysParse=qve;An.weekdaysRegex=ewe;An.weekdaysShortRegex=twe;An.weekdaysMinRegex=rwe;An.isPM=iwe;An.meridiem=awe;function BE(t,e,r,i){var s=lf(),n=Yu().set(i,e);return s[r](n,t)}function TX(t,e,r){if(Zh(t)&&(e=t,t=void 0),t=t||"",e!=null)return BE(t,e,r,"month");var i,s=[];for(i=0;i<12;i++)s[i]=BE(t,i,r,"month");return s}function Hk(t,e,r,i){typeof t=="boolean"?(Zh(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,Zh(e)&&(r=e,e=void 0),e=e||"");var s=lf(),n=t?s._week.dow:0,o,l=[];if(r!=null)return BE(e,(r+n)%7,i,"day");for(o=0;o<7;o++)l[o]=BE(e,(o+n)%7,i,"day");return l}function fCe(t,e){return TX(t,e,"months")}function dCe(t,e){return TX(t,e,"monthsShort")}function gCe(t,e,r){return Hk(t,e,r,"weekdays")}function mCe(t,e,r){return Hk(t,e,r,"weekdaysShort")}function pCe(t,e,r){return Hk(t,e,r,"weekdaysMin")}Cd("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=gn(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});wt.lang=Gl("moment.lang is deprecated. Use moment.locale instead.",Cd);wt.langData=Gl("moment.langData is deprecated. Use moment.localeData instead.",lf);var oh=Math.abs;function vCe(){var t=this._data;return this._milliseconds=oh(this._milliseconds),this._days=oh(this._days),this._months=oh(this._months),t.milliseconds=oh(t.milliseconds),t.seconds=oh(t.seconds),t.minutes=oh(t.minutes),t.hours=oh(t.hours),t.months=oh(t.months),t.years=oh(t.years),this}function _X(t,e,r,i){var s=$c(e,r);return t._milliseconds+=i*s._milliseconds,t._days+=i*s._days,t._months+=i*s._months,t._bubble()}function wCe(t,e){return _X(this,t,e,1)}function yCe(t,e){return _X(this,t,e,-1)}function $9(t){return t<0?Math.floor(t):Math.ceil(t)}function CCe(){var t=this._milliseconds,e=this._days,r=this._months,i=this._data,s,n,o,l,h;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=$9(UP(r)+e)*864e5,e=0,r=0),i.milliseconds=t%1e3,s=Nl(t/1e3),i.seconds=s%60,n=Nl(s/60),i.minutes=n%60,o=Nl(n/60),i.hours=o%24,e+=Nl(o/24),h=Nl(RX(e)),r+=h,e-=$9(UP(h)),l=Nl(r/12),r%=12,i.days=e,i.months=r,i.years=l,this}function RX(t){return t*4800/146097}function UP(t){return t*146097/4800}function SCe(t){if(!this.isValid())return NaN;var e,r,i=this._milliseconds;if(t=Yl(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,r=this._months+RX(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(UP(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function cf(t){return function(){return this.as(t)}}var AX=cf("ms"),bCe=cf("s"),xCe=cf("m"),ECe=cf("h"),TCe=cf("d"),_Ce=cf("w"),RCe=cf("M"),ACe=cf("Q"),OCe=cf("y"),ICe=AX;function PCe(){return $c(this)}function FCe(t){return t=Yl(t),this.isValid()?this[t+"s"]():NaN}function Kg(t){return function(){return this.isValid()?this._data[t]:NaN}}var MCe=Kg("milliseconds"),kCe=Kg("seconds"),NCe=Kg("minutes"),DCe=Kg("hours"),LCe=Kg("days"),HCe=Kg("months"),$Ce=Kg("years");function BCe(){return Nl(this.days()/7)}var _h=Math.round,Ap={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function VCe(t,e,r,i,s){return s.relativeTime(e||1,!!r,t,i)}function WCe(t,e,r,i){var s=$c(t).abs(),n=_h(s.as("s")),o=_h(s.as("m")),l=_h(s.as("h")),h=_h(s.as("d")),d=_h(s.as("M")),g=_h(s.as("w")),y=_h(s.as("y")),C=n<=r.ss&&["s",n]||n<r.s&&["ss",n]||o<=1&&["m"]||o<r.m&&["mm",o]||l<=1&&["h"]||l<r.h&&["hh",l]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(C=C||g<=1&&["w"]||g<r.w&&["ww",g]),C=C||d<=1&&["M"]||d<r.M&&["MM",d]||y<=1&&["y"]||["yy",y],C[2]=e,C[3]=+t>0,C[4]=i,VCe.apply(null,C)}function jCe(t){return t===void 0?_h:typeof t=="function"?(_h=t,!0):!1}function UCe(t,e){return Ap[t]===void 0?!1:e===void 0?Ap[t]:(Ap[t]=e,t==="s"&&(Ap.ss=e-1),!0)}function zCe(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,i=Ap,s,n;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(i=Object.assign({},Ap,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),s=this.localeData(),n=WCe(this,!r,i,s),r&&(n=s.pastFuture(+this,n)),s.postformat(n)}var eO=Math.abs;function Cm(t){return(t>0)-(t<0)||+t}function k_(){if(!this.isValid())return this.localeData().invalidDate();var t=eO(this._milliseconds)/1e3,e=eO(this._days),r=eO(this._months),i,s,n,o,l=this.asSeconds(),h,d,g,y;return l?(i=Nl(t/60),s=Nl(i/60),t%=60,i%=60,n=Nl(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=l<0?"-":"",d=Cm(this._months)!==Cm(l)?"-":"",g=Cm(this._days)!==Cm(l)?"-":"",y=Cm(this._milliseconds)!==Cm(l)?"-":"",h+"P"+(n?d+n+"Y":"")+(r?d+r+"M":"")+(e?g+e+"D":"")+(s||i||t?"T":"")+(s?y+s+"H":"")+(i?y+i+"M":"")+(t?y+o+"S":"")):"P0D"}var Cn=F_.prototype;Cn.isValid=Hwe;Cn.abs=vCe;Cn.add=wCe;Cn.subtract=yCe;Cn.as=SCe;Cn.asMilliseconds=AX;Cn.asSeconds=bCe;Cn.asMinutes=xCe;Cn.asHours=ECe;Cn.asDays=TCe;Cn.asWeeks=_Ce;Cn.asMonths=RCe;Cn.asQuarters=ACe;Cn.asYears=OCe;Cn.valueOf=ICe;Cn._bubble=CCe;Cn.clone=PCe;Cn.get=FCe;Cn.milliseconds=MCe;Cn.seconds=kCe;Cn.minutes=NCe;Cn.hours=DCe;Cn.days=LCe;Cn.weeks=BCe;Cn.months=HCe;Cn.years=$Ce;Cn.humanize=zCe;Cn.toISOString=k_;Cn.toString=k_;Cn.toJSON=k_;Cn.locale=mX;Cn.localeData=vX;Cn.toIsoString=Gl("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",k_);Cn.lang=pX;Rr("X",0,0,"unix");Rr("x",0,0,"valueOf");ir("x",A_);ir("X",fve);ei("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});ei("x",function(t,e,r){r._d=new Date(gn(t))});//! moment.js
wt.version="2.30.1";G1e(wi);wt.fn=At;wt.min=kwe;wt.max=Nwe;wt.now=Dwe;wt.utc=Yu;wt.unix=uCe;wt.months=fCe;wt.isDate=UC;wt.locale=Cd;wt.invalid=E_;wt.duration=$c;wt.isMoment=kc;wt.weekdays=gCe;wt.parseZone=hCe;wt.localeData=lf;wt.isDuration=D2;wt.monthsShort=dCe;wt.weekdaysMin=pCe;wt.defineLocale=Ik;wt.updateLocale=hwe;wt.locales=fwe;wt.weekdaysShort=mCe;wt.normalizeUnits=Yl;wt.relativeTimeRounding=jCe;wt.relativeTimeThreshold=UCe;wt.calendarFormat=aye;wt.prototype=At;wt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function GCe(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function B9(t,e){const r=e.length;let i=0;for(;i<r;)t.push(e[i]),i+=1}function H2(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,i=t[0].length;for(let s=0;s<r;s++)for(let n=0;n<i;n++)e[n]||(e[n]=[]),e[n][s]=t[s][n];return e}function la(t,e,r,i){let s=-1,n=t,o=r;Array.isArray(t)||(n=Array.from(t));const l=n.length;for(s+=1;s<l;)o=e(o,n[s],s,n),s+=1;return o}function Rd(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length,n=[];let o=-1;for(;r<s;){const l=i[r];e(l,r,i)&&(o+=1,n[o]=l),r+=1}return n}function on(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length,n=[];let o=-1;for(;r<s;){const l=i[r];o+=1,n[o]=e(l,r,i),r+=1}return n}function Te(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length;for(;r<s&&e(i[r],r,i)!==!1;)r+=1;return t}function OX(t){const e=[];return Te(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function V9(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...s]=[...e];let n=i;return Te(s,o=>{n=n.filter(l=>!o.includes(l))}),n}function W9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ln(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return la(t,(n,o,l)=>{const h=o.replace(/\r?\n\s*/g,""),d=r[l]?r[l]:"";return n+h+d},"").trim()}function is(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function nr(t){return typeof t<"u"}function _i(t){return typeof t>"u"}function qi(t){return t===null||t===""||_i(t)}function YCe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const $w="length",iy=t=>parseInt(t,16),j9=t=>parseInt(t,10),VE=(t,e,r)=>t.substr(e,r),sy=t=>t.codePointAt(0)-65,zP=t=>`${t}`.replace(/\-/g,""),KCe=t=>iy(VE(zP(t),iy("12"),sy("F")))/(iy(VE(zP(t),sy("B"),~~![][$w]))||9),XCe=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let U9=!1;const z9={invalid:()=>Ln`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ln`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ln`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},G9={invalid:()=>Ln`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ln`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ln`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function qCe(t,e){const r=!qi(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",s="15.0.0";let n,o="invalid",l="invalid";t=zP(t||"");const h=JCe(t);if(r||i||h)if(h){const d=wt("16/12/2024","DD/MM/YYYY"),g=Math.floor(d.toDate().getTime()/864e5),y=KCe(t);n=wt((y+1)*864e5,"x").format("MMMM DD, YYYY"),g>y?(o="expired",l="expired"):(o="valid",l="valid")}else i?(o="non_commercial",l="valid"):(o="invalid",l="invalid");else o="missing",l="missing";if(XCe()&&(o="valid",l="valid"),!U9&&o!=="valid"&&(z9[o]({keyValidityDate:n,hotVersion:s})&&console[o==="non_commercial"?"info":"warn"](z9[o]({keyValidityDate:n,hotVersion:s})),U9=!0),l!=="valid"&&e.parentNode&&G9[l]({keyValidityDate:n,hotVersion:s})){const g=document.createElement("div");g.className="handsontable hot-display-license-info",g.innerHTML=G9[l]({keyValidityDate:n,hotVersion:s}),e.parentNode.insertBefore(g,e.nextSibling)}}function JCe(t){let e=[][$w],r=e;if(t[$w]!==sy("Z"))return!1;for(let i="",s="B<H4P+".split(""),n=sy(s.shift());n;n=sy(s.shift()||"A"))--n<""[$w]?r=r|(j9(`${j9(iy(i)+(iy(VE(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=VE(t,n,n?s[$w]===1?9:8:6);return r===e}function Nc(t){return t[0].toUpperCase()+t.substr(1)}function IX(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function PX(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function FX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,i)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[i]===void 0?"":e[i])}function Y9(t){return $k(`${t}`,{ALLOWED_TAGS:[]})}function $k(t,e){return z1e.sanitize(t,e)}const P1=t=>["tabindex",t],QCe=()=>["role","treegrid"],Nu=()=>["role","presentation"],ZCe=()=>["role","gridcell"],eSe=()=>["role","rowheader"],MX=()=>["role","rowgroup"],tSe=()=>["role","columnheader"],GP=()=>["role","row"],rSe=()=>["role","menu"],nSe=()=>["role","menuitem"],iSe=()=>["role","menuitemcheckbox"],sSe=()=>["role","combobox"],kX=()=>["role","listbox"],oSe=()=>["role","option"],aSe=()=>["role","checkbox"],lSe=()=>["scope","col"],cSe=()=>["scope","row"],uSe=()=>["type","text"],WE=t=>["aria-label",t],Dd=()=>["aria-hidden","true"],hSe=()=>["aria-disabled","true"],fSe=()=>["aria-multiselectable","true"],NX=t=>["aria-haspopup",t],DX=t=>["aria-rowcount",t],N_=t=>["aria-colcount",t],LX=t=>["aria-rowindex",t],Bk=t=>["aria-colindex",t],Bl=t=>["aria-expanded",t],dSe=t=>["aria-sort",t],K9=()=>["aria-readonly","true"],X9=()=>["aria-invalid","true"],HX=t=>["aria-checked",t],Vk=()=>["aria-selected","true"],gSe=()=>["aria-autocomplete","list"],mSe=t=>["aria-controls",t],pSe=t=>["aria-activedescendant",t],vSe=t=>["aria-live",t],wSe=t=>["aria-relevant",t],ySe=t=>["aria-setsize",t],CSe=t=>["aria-posinset",t];function SSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=null,s=t;for(;s!==null;){if(r===e){i=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(r+=1,s=s.parentNode)}return i}function bSe(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function xSe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function a1(t){return xSe(t)&&t.parent}function _g(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:s}=Node;let n=t;for(;n!=null&&n!==r;){const{nodeType:o,nodeName:l}=n;if(o===i&&(e.includes(l)||e.includes(n)))return n;const{host:h}=n;h&&o===s?n=h:n=n.parentNode}return null}function Ib(t,e,r){const i=[];let s=t;for(;s&&(s=_g(s,e,r),!(!s||r&&!r.contains(s)));)i.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const n=i.length;return n?i[n-1]:null}function ESe(t,e){const r={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&i.classList.contains(e))r.element=i,r.classNames.push(e);else if(e instanceof RegExp){const s=Array.from(i.classList).filter(n=>e.test(n));s.length&&(r.element=i,r.classNames.push(...s))}i=i.parentElement}return r}function pg(t,e){let r=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);r!==null;){if(i.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function TSe(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function a0(t,e,r){const i=r.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function $X(t){return!t||!t.length?[]:t.filter(e=>!!e)}function BX(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],i=[];return i.push(...t.filter(s=>{const n=s instanceof RegExp;return n&&e&&r.push(s),!n})),{regexFree:i,regexes:r}}function Ir(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ht(t,e){typeof e=="string"&&(e=e.split(" ")),e=$X(e),e.length>0&&t.classList.add(...e)}function Ar(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:i}=BX(e,!0);r=$X(r),r.length>0&&t.classList.remove(...r),i.forEach(s=>{t.classList.forEach(n=>{s.test(n)&&t.classList.remove(n)})})}function Fr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function F1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:i}=BX(e,!0);r.forEach(s=>{s!==""&&t.removeAttribute(s)}),i.forEach(s=>{t.getAttributeNames().forEach(n=>{s.test(n)&&t.removeAttribute(n)})})}function VX(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)VX(e[r])}}function Vu(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const _Se=/(<(.*)>|&(.*);)/;function M1(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_Se.test(e)?t.innerHTML=r?$k(e):e:Rg(t,e)}function Rg(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Vu(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function l1(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return l1(i.host.impl);if(i.host)return l1(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function Ws(t){const e=t.ownerDocument,r=e.defaultView,i=e.documentElement;let s=t,n,o,l;for(n=s.offsetLeft,o=s.offsetTop,l=s;(s=s.offsetParent)&&!(s===e.body||!("offsetLeft"in s));)n+=s.offsetLeft,o+=s.offsetTop,l=s;return l&&l.style.position==="fixed"&&(n+=r.pageXOffset||i.scrollLeft,o+=r.pageYOffset||i.scrollTop),{left:n,top:o}}function WX(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Wk(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function jk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?WX(e):t.scrollTop}function jX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Wk(e):t.scrollLeft}function jE(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const i=["auto","scroll"];let s=t.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:n,overflowX:o,overflowY:l}=s.style;if([n,o,l].includes("scroll"))return s;if({overflow:n,overflowX:o,overflowY:l}=r.getComputedStyle(s),i.includes(n)||i.includes(o)||i.includes(l)||s.clientHeight<=s.scrollHeight+1&&(i.includes(l)||i.includes(n))||s.clientWidth<=s.scrollWidth+1&&(i.includes(o)||i.includes(n)))return s;s=s.parentNode}return r}function RSe(t){return t.scrollHeight-t.clientHeight}function ASe(t){return t.scrollWidth-t.clientWidth}function c1(t){const e=t.ownerDocument,r=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const s=r.getComputedStyle(i),n=["scroll","hidden","auto"],o=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),h=s.getPropertyValue("overflow-x");if(n.includes(o)||n.includes(l)||n.includes(h))return i;i=i.parentNode}return r}function UE(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const s=r.getComputedStyle(t);if(s[e]!==""&&s[e]!==void 0)return s[e]}function ns(t){return t.offsetWidth}function Ji(t){return t.offsetHeight}function oy(t){return t.clientHeight||t.innerHeight}function UX(t){return t.clientWidth||t.innerWidth}function zX(t){return t.selectionStart?t.selectionStart:0}function OSe(t){return t.selectionEnd?t.selectionEnd:0}function q9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function D_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const s=t.parentNode,n=s.style.display;s.style.display="block",t.setSelectionRange(e,r),s.style.display=n}}}let tO;function ISe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const i=e.offsetWidth;r.style.overflow="scroll";let s=e.offsetWidth;return i===s&&(s=r.clientWidth),(t.body||t.documentElement).removeChild(r),i-s}function so(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return tO===void 0&&(tO=ISe(t)),tO}function PSe(t){return t.offsetWidth!==t.clientWidth}function FSe(t){return t.offsetHeight!==t.clientHeight}function Uk(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function L_(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function $2(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function GX(t){return $2(t)&&t.hasAttribute("data-hot-input")===!1}function YX(t){return!t.parentNode}function MSe(t,e){new IntersectionObserver((i,s)=>{i.forEach(n=>{n.isIntersecting&&t.offsetParent!==null&&(e(),s.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function KX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,s=i.createRange(),n=i.defaultView.getSelection();Fr(t,"contenteditable",!0),r&&Fr(t,...Dd()),e&&ht(t,"invisibleSelection"),s.selectNodeContents(t),n.removeAllRanges(),n.addRange(s)}function XX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&Ar(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function kSe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;KX(t,r),e(),XX(t,r)}function oi(t){return typeof t=="function"}function zk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,i;function s(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(()=>{i=t.apply(this,o)},e),i}return s}function qX(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t.apply(this,r.concat(o))}}function NSe(t){const e=t.length;function r(i){return function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];const h=i.concat(o);let d;return h.length>=e?d=t.apply(this,h):d=r(h),d}}return r([])}function YP(t,e,r,i,s,n,o,l){return nr(l)?t.call(e,r,i,s,n,o,l):nr(o)?t.call(e,r,i,s,n,o):nr(n)?t.call(e,r,i,s,n):nr(s)?t.call(e,r,i,s):nr(i)?t.call(e,r,i):nr(r)?t.call(e,r):t.call(e)}var DSe=ss,J9=YY,LSe=ys,Q9=Wg,HSe=x_,Z9=DSe([].push),$Se=function(t){if(LSe(t))return t;if(J9(t)){for(var e=t.length,r=[],i=0;i<e;i++){var s=t[i];typeof s=="string"?Z9(r,s):(typeof s=="number"||Q9(s)==="Number"||Q9(s)==="String")&&Z9(r,HSe(s))}var n=r.length,o=!0;return function(l,h){if(o)return o=!1,h;if(J9(this))return h;for(var d=0;d<n;d++)if(r[d]===l)return h}}},BSe=ni,JX=b1,QX=b_,VSe=Lo,KC=ss,ZX=co,eB=ys,tB=qM,eq=mk,WSe=$Se,jSe=XM,USe=String,Sd=JX("JSON","stringify"),Pb=KC(/./.exec),rB=KC("".charAt),zSe=KC("".charCodeAt),GSe=KC("".replace),YSe=KC(1 .toString),KSe=/[\uD800-\uDFFF]/g,nB=/^[\uD800-\uDBFF]$/,iB=/^[\uDC00-\uDFFF]$/,sB=!jSe||ZX(function(){var t=JX("Symbol")("stringify detection");return Sd([t])!=="[null]"||Sd({a:t})!=="{}"||Sd(Object(t))!=="{}"}),oB=ZX(function(){return Sd("\uDF06\uD834")!=='"\\udf06\\ud834"'||Sd("\uDEAD")!=='"\\udead"'}),XSe=function(t,e){var r=eq(arguments),i=WSe(e);if(!(!eB(i)&&(t===void 0||tB(t))))return r[1]=function(s,n){if(eB(i)&&(n=VSe(i,this,USe(s),n)),!tB(n))return n},QX(Sd,null,r)},qSe=function(t,e,r){var i=rB(r,e-1),s=rB(r,e+1);return Pb(nB,t)&&!Pb(iB,s)||Pb(iB,t)&&!Pb(nB,i)?"\\u"+YSe(zSe(t,0),16):t};Sd&&BSe({target:"JSON",stat:!0,arity:3,forced:sB||oB},{stringify:function(e,r,i){var s=eq(arguments),n=QX(sB?XSe:Sd,null,s);return oB&&typeof n=="string"?GSe(n,KSe,qSe):n}});function rC(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Zr(t,(r,i)=>{i!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[i]=rC(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[i]=[rC(r[0])]:e[i]=[]:e[i]=null)})),e}function Xu(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function vs(t,e,r){const i=Array.isArray(r);return Zr(e,(s,n)=>{(i===!1||r.includes(n))&&(t[n]=s)}),t}function H_(t,e){Zr(e,(r,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),H_(t[i],e[i])):t[i]=e[i]})}function sa(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Wu(t){const e={};return Zr(t,(r,i)=>{e[i]=r}),e}function Xn(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return Te(r,s=>{t.MIXINS.push(s.MIXIN_NAME),Zr(s,(n,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof n=="function")t.prototype[o]=n;else{const l=function(g,y){const C=`_${g}`,x=_=>{let E=_;return(Array.isArray(E)||Qr(E))&&(E=sa(E)),E};return function(){return this[C]===void 0&&(this[C]=x(y)),this[C]}},h=function(g){const y=`_${g}`;return function(C){this[y]=C}};Object.defineProperty(t.prototype,o,{get:l(o,n),set:h(o),configurable:!0})}})}),t}function Gk(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Qr(t){return Object.prototype.toString.call(t)==="[object Object]"}function uf(t,e,r,i){i.value=r,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Zr(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function JSe(t,e){const r=e.split(".");let i=t;return Zr(r,s=>{if(i=i[s],i===void 0)return i=void 0,!1}),i}function rO(t,e,r){const i=e.split(".");let s=t;i.forEach((n,o)=>{o!==i.length-1?(gs(s,n)||(s[n]={}),s=s[n]):s[n]=r})}function Yk(t){if(!Qr(t))return 0;const e=function(r){let i=0;return Qr(r)?Zr(r,(s,n)=>{n!=="__children"&&(i+=e(s))}):i+=1,i};return e(t)}function tl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,i={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[r]},set(s){this._touched=!0,this[r]=s},enumerable:!0,configurable:!0}),i}function gs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zE(t){return window.requestAnimationFrame(t)}function GE(t){window.cancelAnimationFrame(t)}function tq(){return"ontouchstart"in window}function QSe(){return typeof window<"u"}let Sm;function ZSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Sm||(typeof Intl=="object"?Sm=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Sm=(r,i)=>`${r}`.localeCompare(i):Sm=(r,i)=>r===i?0:r>i?-1:1,Sm)}const Al=t=>{const e={value:!1};return e.test=(r,i)=>{e.value=t(r,i)},e},Ld={chrome:Al((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Al(t=>/CriOS/.test(t)),edge:Al(t=>/Edge/.test(t)),edgeWebKit:Al(t=>/EdgiOS/.test(t)),firefox:Al(t=>/Firefox/.test(t)),firefoxWebKit:Al(t=>/FxiOS/.test(t)),mobile:Al(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Al((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},XC={mac:Al(t=>/^Mac/.test(t)),win:Al(t=>/^Win/.test(t)),linux:Al(t=>/^Linux/.test(t)),ios:Al(t=>/iPhone|iPad|iPod/i.test(t))};function ebe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zr(Ld,r=>{let{test:i}=r;return void i(t,e)})}function tbe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zr(XC,e=>{let{test:r}=e;return void r(t)})}QSe()&&(ebe(),tbe());function rq(){return Ld.chrome.value}function rbe(){return Ld.chromeWebKit.value}function nO(){return Ld.firefox.value}function nbe(){return Ld.firefoxWebKit.value}function nq(){return Ld.safari.value}function ibe(){return Ld.edge.value}function sd(){return Ld.mobile.value}function iq(){return XC.ios.value}function sq(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&XC.mac.value}function aB(){return XC.win.value}function lB(){return XC.mac.value}const Sr={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:nO()?182:174,AUDIO_MUTE:nO()?181:173,AUDIO_UP:nO()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},sbe=[Sr.ALT,Sr.ARROW_DOWN,Sr.ARROW_LEFT,Sr.ARROW_RIGHT,Sr.ARROW_UP,Sr.AUDIO_DOWN,Sr.AUDIO_MUTE,Sr.AUDIO_UP,Sr.BACKSPACE,Sr.CAPS_LOCK,Sr.DELETE,Sr.END,Sr.ENTER,Sr.ESCAPE,Sr.F1,Sr.F2,Sr.F3,Sr.F4,Sr.F5,Sr.F6,Sr.F7,Sr.F8,Sr.F9,Sr.F10,Sr.F11,Sr.F12,Sr.F13,Sr.F14,Sr.F15,Sr.F16,Sr.F17,Sr.F18,Sr.F19,Sr.HOME,Sr.INSERT,Sr.MEDIA_NEXT,Sr.MEDIA_PLAY_PAUSE,Sr.MEDIA_PREV,Sr.MEDIA_STOP,Sr.NULL,Sr.NUM_LOCK,Sr.PAGE_DOWN,Sr.PAGE_UP,Sr.PAUSE,Sr.SCROLL_LOCK,Sr.SHIFT,Sr.TAB];function obe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function oq(t){return sbe.includes(t)}function abe(t){return[Sr.CONTROL,Sr.COMMAND_LEFT,Sr.COMMAND_RIGHT,Sr.COMMAND_FIREFOX].includes(t)}function qC(t,e){const r=e.split("|");let i=!1;return Te(r,s=>{if(t===Sr[s])return i=!0,!1}),i}function Bc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function J0(t){return t.isImmediatePropagationEnabled===!1}function Ag(t){return t.button===2}function Kk(t){return t.button===0}function lbe(t){return t instanceof TouchEvent}function cbe(t,e){const r={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return r;for(;i!==e;)r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;return r}function Nn(){nr(console)&&console.warn(...arguments)}function Xk(){nr(console)&&console.error(...arguments)}const Q0=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],iO=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),sO=new Map([[]]);var ube=T1,hbe=function(t,e,r){for(var i=0,s=arguments.length>2?r:ube(e),n=new t(s);s>i;)n[i]=e[i++];return n},fbe=Fs,dbe=function(t,e){var r=fbe[t],i=r&&r.prototype;return i&&i[e]},gbe=Hc,mbe=uK,pbe=af.f,KP=gbe("unscopables"),XP=Array.prototype;XP[KP]===void 0&&pbe(XP,KP,{configurable:!0,value:mbe(null)});var $_=function(t){XP[KP][t]=!0},vbe=ni,wbe=ss,ybe=ka,Cbe=LC,Sbe=hbe,bbe=dbe,xbe=$_,Ebe=Array,Tbe=wbe(bbe("Array","sort"));vbe({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&ybe(e);var r=Cbe(this),i=Sbe(Ebe,r);return Tbe(i,e)}});xbe("toSorted");var _be=ni,Rbe=R1,Abe=ka,Obe=Cs,Ibe=Gu;_be({target:"Iterator",proto:!0,real:!0},{find:function(e){Obe(this),Abe(e);var r=Ibe(this),i=0;return Rbe(r,function(s,n){if(e(s,i++))return n(s)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function Pbe(t,e){aq(t,e),e.add(t)}function oO(t,e,r){aq(t,e),e.set(t,r)}function aq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cB(t,e,r){return t.set(YE(t,e),r),r}function Qs(t,e){return t.get(YE(t,e))}function YE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Fbe=100;var Ba=new WeakMap,op=new WeakMap,aO=new WeakMap,lO=new WeakSet;class uB{constructor(){Pbe(this,lO),oO(this,Ba,new Map),oO(this,op,new Map),oO(this,aO,new Set),Q0.forEach(e=>YE(lO,this,hB).call(this,e))}getHooks(e){var r;return(r=Qs(Ba,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Qs(Ba,this).has(e)||(YE(lO,this,hB).call(this,e),Q0.push(e));const s=Qs(Ba,this).get(e);if(s.find(d=>d.callback===r))return;const n=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,l=!!i.initialHook;let h=!1;if(l){const d=s.find(g=>g.initialHook);d&&(d.callback=r,h=!0)}if(!h){s.push({callback:r,orderIndex:n,runOnce:o,initialHook:l,skip:!1});let d=Qs(aO,this).has(e);!d&&n!==0&&(d=!0,Qs(aO,this).add(e)),d&&s.length>1&&Qs(Ba,this).set(e,s.toSorted((g,y)=>g.orderIndex-y.orderIndex))}}has(e){return Qs(Ba,this).has(e)&&Qs(Ba,this).get(e).length>0}remove(e,r){if(!Qs(Ba,this).has(e))return!1;const i=Qs(Ba,this).get(e),s=i.find(n=>n.callback===r);if(s){let n=Qs(op,this).get(e);return s.skip=!0,n+=1,n>Fbe&&(Qs(Ba,this).set(e,i.filter(o=>!o.skip)),n=0),Qs(op,this).set(e,n),!0}return!1}destroy(){Qs(Ba,this).clear(),Qs(op,this).clear(),cB(Ba,this,null),cB(op,this,null)}}function hB(t){Qs(Ba,this).set(t,[]),Qs(op,this).set(t,0)}function Mbe(t,e,r){return(e=kbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kbe(t){var e=Nbe(t,"string");return typeof e=="symbol"?e:e+""}function Nbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dbe=Ln`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class qt{constructor(){Mbe(this,"globalBucket",new uB)}static getSingleton(){return Hbe()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new uB),e.pluginHookBucket):this.globalBucket}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Te(r,n=>this.add(e,n,i)):(iO.has(e)&&Nn(FX(Dbe,{hookName:e,removedInVersion:iO.get(e)})),sO.has(e)&&Nn(sO.get(e)),this.getBucket(i).add(e,r,{orderIndex:s,runOnce:!1})),this}once(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?Te(r,n=>this.once(e,n,i)):this.getBucket(i).add(e,r,{orderIndex:s,runOnce:!0}),this}addAsFixed(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?Te(r,s=>this.addAsFixed(e,s,i)):this.getBucket(i).add(e,r,{initialHook:!0}),this}remove(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,i,s,n,o,l,h){{const d=this.getBucket().getHooks(r),g=d?d.length:0;let y=0;if(g)for(;y<g;){if(!d[y]||d[y].skip){y+=1;continue}const C=YP(d[y].callback,e,i,s,n,o,l,h);C!==void 0&&(i=C),d[y]&&d[y].runOnce&&this.remove(r,d[y].callback),y+=1}}{const d=this.getBucket(e).getHooks(r),g=d?d.length:0;let y=0;if(g)for(;y<g;){if(!d[y]||d[y].skip){y+=1;continue}const C=YP(d[y].callback,e,i,s,n,o,l,h);C!==void 0&&(i=C),d[y]&&d[y].runOnce&&this.remove(r,d[y].callback,e),y+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Q0.push(e)}deregister(e){this.isRegistered(e)&&Q0.splice(Q0.indexOf(e),1)}isDeprecated(e){return sO.has(e)||iO.has(e)}isRegistered(e){return Q0.indexOf(e)>=0}getRegistered(){return Q0}}const Lbe=new qt;function Hbe(){return Lbe}const cO=new Map;function Vc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";cO.has(t)||cO.set(t,new Map);const e=cO.get(t);function r(l,h){e.set(l,h)}function i(l){return e.get(l)}function s(l){return e.has(l)}function n(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:i,hasItem:s,getNames:n,getValues:o}}const qP=new WeakMap,{register:$be,getItem:lq,hasItem:cq,getNames:hXe,getValues:fXe}=Vc("editors");function Bbe(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new r(i)),e[i.guid]},qt.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function uq(t,e){let r;if(typeof t=="function")qP.get(t)||Wa(null,t),r=qP.get(t);else if(typeof t=="string")r=lq(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function JP(t){if(typeof t=="function")return t;if(!cq(t))throw Error(`No registered editor found under "${t}" name`);return lq(t).getConstructor()}function Wa(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new Bbe(e);typeof t=="string"&&$be(t,r),qP.set(e,r)}function Vbe(t,e,r){return(e=Wbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wbe(t){var e=jbe(t,"string");return typeof e=="symbol"?e:e+""}function jbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vbe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function n(o){i.call(this,Ube(o))}return this.context.eventListeners.push({element:e,event:r,callback:i,callbackProxy:n,options:s,eventManager:this}),e.addEventListener(r,n,s),()=>{this.removeEventListener(e,r,i)}}removeEventListener(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=this.context.eventListeners.length,o;for(;n;)if(n-=1,o=this.context.eventListeners[n],o.event===r&&o.element===e){if(i&&i!==o.callback||s&&o.eventManager!==this)continue;this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const i=this.context.eventListeners[r];e&&i.eventManager!==this||(this.context.eventListeners.splice(r,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let i=e.document,s=e;i||(i=e.ownerDocument?e.ownerDocument:e,s=i.defaultView);const n={bubbles:!0,cancelable:r!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(r,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function Ube(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Bc(this)},t}function zbe(t,e){Gbe(t,e),e.add(t)}function Gbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l0(t,e,r){return(e=Ybe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ybe(t){var e=Kbe(t,"string");return typeof e=="symbol"?e:e+""}function Kbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var uO=new WeakSet;class QP{constructor(e,r,i){zbe(this,uO),l0(this,"hot",void 0),l0(this,"tableMeta",void 0),l0(this,"selection",void 0),l0(this,"eventManager",void 0),l0(this,"destroyed",!1),l0(this,"activeEditor",void 0),l0(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=i,this.eventManager=new Dc(e),this.hot.addHook("afterDocumentKeyDown",s=>fB(uO,this,Xbe).call(this,s)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",s)}),this.hot.view._wt.update("onCellDblClick",(s,n,o)=>fB(uO,this,qbe).call(this,s,n,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:i,col:s}=r,n=this.hot.runHooks("modifyGetCellCoords",i,s,!1,"meta");let o=i,l=s;if(Array.isArray(n)&&([o,l]=n),this.cellProperties=this.hot.getCellMeta(o,l),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(i,s,!0);if(h){const d=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(l),y=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),l);this.activeEditor=uq(d,this.hot),this.activeEditor.prepare(i,s,g,h,y,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const s=this.hot.getSelectedRangeLast();let n=this.hot.runHooks("beforeBeginEditing",s.highlight.row,s.highlight.col,e,r,i);if(r instanceof MouseEvent&&typeof n!="boolean"&&(n=this.hot.selection.getLayerLevel()===0&&s.isSingle()),n===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,i){this.activeEditor?this.activeEditor.finishEditing(e,r,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:i,col:s}=e.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,l=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!r||l)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Xbe(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||J0(t))return;const{keyCode:r}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!oq(r)&&!abe(r)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function qbe(t,e){e.isCell()&&this.openEditor(null,t,!0)}const dB=new WeakMap;QP.getInstance=function(t,e,r){let i=dB.get(t);return i||(i=new QP(t,e,r),dB.set(t,i)),i};function Jbe(t,e){hq(t,e),e.add(t)}function Dv(t,e,r){hq(t,e),e.set(t,r)}function hq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xi(t,e){return t.get(Fh(t,e))}function Lv(t,e,r){return t.set(Fh(t,e),r),r}function Fh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Up=Object.freeze({CELL:"cell",MIXED:"mixed"});var $s=new WeakMap,Fb=new WeakMap,Mb=new WeakMap,kb=new WeakMap,Nb=new WeakMap,Uf=new WeakSet;class Qbe{constructor(e){var r=this;Jbe(this,Uf),Dv(this,$s,void 0),Dv(this,Fb,void 0),Dv(this,Mb,1),Dv(this,kb,null),Dv(this,Nb,new Map);const i=e.getSettings();Lv($s,this,e),Lv(Fb,this,i.imeFastEdit?Up.MIXED:Up.CELL),xi($s,this).addHook("afterUpdateSettings",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Fh(Uf,r,exe).call(r,...n)}),xi($s,this).addHook("afterSelection",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Fh(Uf,r,gB).call(r,...n)}),xi($s,this).addHook("afterSelectionFocusSet",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Fh(Uf,r,gB).call(r,...n)}),xi($s,this).addHook("afterSelectionEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Fh(Uf,r,Zbe).call(r,...n)})}getFocusMode(){return xi(Fb,this)}setFocusMode(e){Object.values(Up).includes(e)?Lv(Fb,this,e):Nn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return xi(Mb,this)}setRefocusDelay(e){Lv(Mb,this,e)}setRefocusElementGetter(e){Lv(kb,this,e)}getRefocusElement(){var e;return typeof xi(kb,this)=="function"?xi(kb,this).call(this):(e=xi($s,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=i=>{var s,n;const o=(s=xi($s,this).getSelectedRangeLast())===null||s===void 0?void 0:s.highlight;if(!o)return;let l=xi($s,this).runHooks("modifyFocusedElement",o.row,o.col,i);l instanceof HTMLElement||(l=i),l&&!((n=xi($s,this).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&l.focus({preventScroll:!0})};e?r(e):Fh(Uf,this,qk).call(this,i=>r(i))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xi(Mb,this);xi($s,this).getSettings().imeFastEdit&&!((e=xi($s,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(xi(Nb,this).has(r)||xi(Nb,this).set(r,zk(()=>{var i;(i=this.getRefocusElement())===null||i===void 0||i.select()},r)),xi(Nb,this).get(r)())}}function qk(t){var e;const r=(e=xi($s,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!xi($s,this).selection.isCellVisible(r)){t(null);return}const i=xi($s,this).getCell(r.row,r.col,!0);i===null?xi($s,this).addHookOnce("afterScroll",()=>{t(xi($s,this).getCell(r.row,r.col,!0))}):t(i)}function gB(){Fh(Uf,this,qk).call(this,t=>{const{activeElement:e}=xi($s,this).rootDocument;e&&GX(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Zbe(){Fh(Uf,this,qk).call(this,t=>{this.getFocusMode()===Up.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function exe(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Up.MIXED:Up.CELL)}var txe=Lc,rxe=Wg,nxe=Hc,ixe=nxe("match"),sxe=function(t){var e;return txe(t)&&((e=t[ixe])!==void 0?!!e:rxe(t)==="RegExp")},oxe=Cs,axe=function(){var t=oxe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},lxe=Lo,cxe=zl,uxe=HC,hxe=axe,mB=RegExp.prototype,fxe=function(t){var e=t.flags;return e===void 0&&!("flags"in mB)&&!cxe(t,"flags")&&uxe(mB,t)?lxe(hxe,t):e},Jk=ss,dxe=x1,gxe=Math.floor,hO=Jk("".charAt),mxe=Jk("".replace),fO=Jk("".slice),pxe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,vxe=/\$([$&'`]|\d{1,2})/g,wxe=function(t,e,r,i,s,n){var o=r+t.length,l=i.length,h=vxe;return s!==void 0&&(s=dxe(s),h=pxe),mxe(n,h,function(d,g){var y;switch(hO(g,0)){case"$":return"$";case"&":return t;case"`":return fO(e,0,r);case"'":return fO(e,o);case"<":y=s[fO(g,1,-1)];break;default:var C=+g;if(C===0)return d;if(C>l){var x=gxe(C/10);return x===0?d:x<=l?i[x-1]===void 0?hO(g,1):i[x-1]+hO(g,1):d}y=i[C-1]}return y===void 0?"":y})},yxe=ni,Cxe=Lo,Qk=ss,pB=DC,Sxe=ys,bxe=y_,xxe=sxe,Hv=x_,Exe=$C,Txe=fxe,_xe=wxe,Rxe=Hc,Axe=Rxe("replace"),Oxe=TypeError,dO=Qk("".indexOf);Qk("".replace);var vB=Qk("".slice),Ixe=Math.max;yxe({target:"String",proto:!0},{replaceAll:function(e,r){var i=pB(this),s,n,o,l,h,d,g,y,C,x,_=0,E="";if(!bxe(e)){if(s=xxe(e),s&&(n=Hv(pB(Txe(e))),!~dO(n,"g")))throw new Oxe("`.replaceAll` does not allow non-global regexes");if(o=Exe(e,Axe),o)return Cxe(o,e,i,r)}for(l=Hv(i),h=Hv(e),d=Sxe(r),d||(r=Hv(r)),g=h.length,y=Ixe(1,g),C=dO(l,h);C!==-1;)x=d?Hv(r(h,C,l)):_xe(h,l,C,[],void 0,r),E+=vB(l,_,C)+x,_=C+g,C=C+y>l.length?-1:dO(l,h,C+y);return _<l.length&&(E+=vB(l,_)),E}});var Pxe=ni,Fxe=R1,Mxe=ka,kxe=Cs,Nxe=Gu,Dxe=TypeError;Pxe({target:"Iterator",proto:!0,real:!0},{reduce:function(e){kxe(this),Mxe(e);var r=Nxe(this),i=arguments.length<2,s=i?void 0:arguments[1],n=0;if(Fxe(r,function(o){i?(i=!1,s=o):s=e(s,o,n),n++},{IS_RECORD:!0}),i)throw new Dxe("Reduce of empty iterator with no initial value");return s}});const fq={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Lxe=new RegExp(Object.keys(fq).map(t=>`(${t})`).join("|"),"gi");function Hxe(t){return(t&&t.nodeName||"")==="TABLE"}function wB(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),i=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],s=t.getData(...i),n=s.length,o=n>0?s[0].length:0,l=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],g=r?1:0,y=e?1:0;for(let C=0;C<n;C+=1){const x=e&&C===0,_=[];for(let R=0;R<o;R+=1){const I=!x&&r&&R===0;let F="";if(x)F=`<th>${t.getColHeader(R-g)}</th>`;else if(I)F=`<th>${t.getRowHeader(C-y)}</th>`;else{const D=s[C][R],{hidden:U,rowspan:X,colspan:te}=t.getCellMeta(C-y,R-g);if(!U){const Y=[];if(X&&Y.push(`rowspan="${X}"`),te&&Y.push(`colspan="${te}"`),qi(D))F=`<td ${Y.join(" ")}></td>`;else{const oe=D.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");F=`<td ${Y.join(" ")}>${oe}</td>`}}}_.push(F)}const E=["<tr>",..._,"</tr>"].join("");x?h.splice(1,0,E):d.splice(-1,0,E)}return l.splice(1,0,h.join(""),d.join("")),l.join("")}function yB(t){const e=t.length,r=["<table>"];for(let i=0;i<e;i+=1){const s=t[i],n=s.length,o=[];i===0&&r.push("<tbody>");for(let l=0;l<n;l+=1){const h=s[l],d=qi(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,g=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(g.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${d}</td>`)}r.push("<tr>",...o,"</tr>"),i+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function $xe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},i=e.createDocumentFragment(),s=e.createElement("div");i.appendChild(s);let n=t;if(typeof n=="string"){const D=n.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,U=>{const X=U.match(/<td\b[^>]*?>/g)[0],te=/<p.*?>/g,Y=U.substring(X.length,U.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(te,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${X}${Y}</td>`});s.insertAdjacentHTML("afterbegin",`${D}`),n=s.querySelector("table")}if(!n||!Hxe(n))return;const o=s.querySelector('meta[name$="enerator"]'),l=n.querySelector("tbody th")!==null,h=n.querySelector("tr"),d=h?Array.from(h.cells).reduce((D,U)=>D+U.colSpan,0)-(l?1:0):0,g=n.tFoot&&Array.from(n.tFoot.rows)||[],y=[];let C=!1,x=0,_=0;if(n.tHead){const D=Array.from(n.tHead.rows).filter(U=>{const X=U.querySelector("td")!==null;return X&&y.push(U),!X});x=D.length,C=x>0,x>1?r.nestedHeaders=Array.from(D).reduce((U,X)=>{const te=Array.from(X.cells).reduce((Y,oe,me)=>{if(l&&me===0)return Y;const{colSpan:de,innerHTML:ye}=oe,Ee=de>1?{label:ye,colspan:de}:ye;return Y.push(Ee),Y},[]);return U.push(te),U},[]):C&&(r.colHeaders=Array.from(D[0].children).reduce((U,X,te)=>(l&&te===0||U.push(X.innerHTML),U),[]))}y.length&&(r.fixedRowsTop=y.length),g.length&&(r.fixedRowsBottom=g.length);const E=[...y,...Array.from(n.tBodies).reduce((D,U)=>(D.push(...Array.from(U.rows)),D),[]),...g];_=E.length;const R=new Array(_);for(let D=0;D<_;D++)R[D]=new Array(d);const I=[],F=[];for(let D=0;D<_;D++){const U=E[D],X=Array.from(U.cells),te=X.length;for(let Y=0;Y<te;Y++){const oe=X[Y],{nodeName:me,innerHTML:de,rowSpan:ye,colSpan:Ee}=oe,ke=R[D].findIndex(nt=>nt===void 0);if(me==="TD"){if(ye>1||Ee>1){for(let Xe=D;Xe<D+ye;Xe++)if(Xe<_)for(let Pe=ke;Pe<ke+Ee;Pe++)R[Xe][Pe]=null;const at=oe.getAttribute("style");at&&at.includes("mso-ignore:colspan")||I.push({col:ke,row:D,rowspan:ye,colspan:Ee})}let nt="";o&&/excel/gi.test(o.content)?nt=de.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):nt=de.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[D][ke]=nt.replace(Lxe,at=>fq[at])}else F.push(de)}}return I.length&&(r.mergeCells=I),F.length&&(r.rowHeaders=F),R.length&&(r.data=R),r}function ea(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Bxe(t){return ea(t,[","])}function pr(t,e,r){let i=-1;for(typeof e=="function"?(r=e,e=t):i=t-1;++i<=e&&r(i)!==!1;);}function CB(t,e,r){let i=t+1;for(typeof e=="function"&&(r=e,e=0);--i>=e&&r(i)!==!1;);}function dq(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function vn(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const ZP="asc",Vxe="desc",SB=new Map([[ZP,[-1,1]],[Vxe,[1,-1]]]),Wxe=t=>`The priority '${t}' is already declared in a map.`,jxe=t=>`The priority '${t}' is not a number.`;function Uxe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=oi(t)?t:Wxe,e=oi(e)?e:jxe;function i(n,o){if(!ea(n))throw new Error(e(n));if(r.has(n))throw new Error(t(n));r.set(n,o)}function s(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ZP;const[o,l]=SB.get(n)||SB.get(ZP);return[...r].sort((h,d)=>h[0]<d[0]?o:l).map(h=>h[1])}return{addItem:i,getItems:s}}const zxe=t=>`The id '${t}' is already declared in a map.`;function B_(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=oi(t)?t:zxe;function r(d,g){if(h(d))throw new Error(t(d));e.set(d,g)}function i(d){return e.delete(d)}function s(){e.clear()}function n(d){const[g]=l().find(y=>{let[C,x]=y;return d===x?C:!1})||[null];return g}function o(d){return e.get(d)}function l(){return[...e]}function h(d){return e.has(d)}return{addItem:r,clear:s,getId:n,getItem:o,getItems:l,hasItem:h,removeItem:i}}const Gxe=t=>`'${t}' value is already declared in a unique set.`;function Yxe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=oi(t)?t:Gxe;function r(n){if(e.has(n))throw new Error(t(n));e.add(n)}function i(){return[...e]}function s(){e.clear()}return{addItem:r,clear:s,getItems:i}}const Zk=t=>`There is already registered "${t}" plugin.`,Kxe=t=>`There is already registered plugin on priority "${t}".`,Xxe=t=>`The priority "${t}" is not a number.`,gq=Uxe({errorPriorityExists:Kxe,errorPriorityNaN:Xxe}),mq=Yxe({errorItemExists:Zk}),eF=B_({errorIdExists:Zk});function pq(){return[...gq.getItems(),...mq.getItems()]}function eN(t){const e=Nc(t);return eF.getItem(e)}function qxe(t){return!!eN(t)}function wn(t,e,r){[t,e,r]=Qxe(t,e,r),eN(t)===void 0&&Jxe(t,e,r)}function Jxe(t,e,r){const i=Nc(t);if(eF.hasItem(i))throw new Error(Zk(i));r===void 0?mq.addItem(i):gq.addItem(r,i),eF.addItem(i,e)}function Qxe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:Zxe,getItem:e2e,hasItem:vq,getNames:dXe,getValues:gXe}=Vc("renderers");function tF(t){if(typeof t=="function")return t;if(!vq(t))throw Error(`No registered renderer found under "${t}" name`);return e2e(t)}function El(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Zxe(t,e)}const{register:t2e,getItem:r2e,hasItem:wq,getNames:mXe,getValues:pXe}=Vc("validators");function n2e(t){if(typeof t=="function")return t;if(!wq(t))throw Error(`No registered validator found under "${t}" name`);return r2e(t)}function ap(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),t2e(t,e)}var i2e=ni,s2e=x1,o2e=T1,a2e=BC,l2e=$_;i2e({target:"Array",proto:!0},{at:function(e){var r=s2e(this),i=o2e(r),s=a2e(e),n=s>=0?s:i+s;return n<0||n>=i?void 0:r[n]}});l2e("at");var c2e=ni,u2e=ss,h2e=DC,f2e=BC,d2e=x_,g2e=co,m2e=u2e("".charAt),p2e=g2e(function(){return"".at(-2)!=="\uD842"});c2e({target:"String",proto:!0,forced:p2e},{at:function(e){var r=d2e(h2e(this)),i=r.length,s=f2e(e),n=s>=0?s:i+s;return n<0||n>=i?void 0:m2e(r,n)}});function $v(t,e,r){return(e=v2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v2e(t){var e=w2e(t,"string");return typeof e=="symbol"?e:e+""}function w2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y2e{constructor(){$v(this,"count",0),$v(this,"startColumn",null),$v(this,"endColumn",null),$v(this,"startPosition",null),$v(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:s,viewportWidth:n,columnWidth:o}=r,l=s>0?n+1:n;i>=s&&i+o<=s+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:i,viewportWidth:s,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:l,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===l-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const _=d[this.endColumn]+g-d[this.startColumn-1];if(_<=s&&(this.startColumn-=1),_>=s)break}this.startPosition=(r=d[this.startColumn])!==null&&r!==void 0?r:null;const y=o>0?s+1:s,C=i+s-y,x=this.startColumn===null?0:e.getColumnWidth(this.startColumn);C<-1*n||i>d.at(-1)||-1*i-s>-1*x?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Bv(t,e,r){return(e=C2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C2e(t){var e=S2e(t,"string");return typeof e=="symbol"?e:e+""}function S2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b2e{constructor(){Bv(this,"count",0),Bv(this,"startRow",null),Bv(this,"endRow",null),Bv(this,"startPosition",null),Bv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:s,innerViewportHeight:n,rowHeight:o}=r;i>=s&&i+o<=n&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:i,viewportHeight:s,horizontalScrollbarHeight:n,totalRows:o,needReverse:l,startPositions:h,rowHeight:d}=e;if(this.endRow===o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const C=h[this.endRow]+d-h[this.startRow-1];if(C<=s-n&&(this.startRow-=1),C>=s-n)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null;const g=i+s-n,y=this.startRow===null?0:e.getRowHeight(this.startRow);g<y||i>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vv(t,e,r){return(e=x2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x2e(t){var e=E2e(t,"string");return typeof e=="symbol"?e:e+""}function E2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yq{constructor(){Vv(this,"count",0),Vv(this,"startColumn",null),Vv(this,"endColumn",null),Vv(this,"startPosition",null),Vv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:s,viewportWidth:n}=r;i<=s&&(this.startColumn=e);const o=s>0?n+1:n;i>=s&&i<=s+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:i,viewportWidth:s,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:l,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===l-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const x=d[this.endColumn]+g-d[this.startColumn-1];if(this.startColumn-=1,x>s)break}this.startPosition=(r=d[this.startColumn])!==null&&r!==void 0?r:null;const y=o>0?s+1:s;i+s-y<-1*n||i>d.at(-1)+g||-1*i-s>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wv(t,e,r){return(e=T2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T2e(t){var e=_2e(t,"string");return typeof e=="symbol"?e:e+""}function _2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cq{constructor(){Wv(this,"count",0),Wv(this,"startRow",null),Wv(this,"endRow",null),Wv(this,"startPosition",null),Wv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:s,innerViewportHeight:n}=r;i<=s&&(this.startRow=e),i>=s&&i<=n&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:i,viewportHeight:s,horizontalScrollbarHeight:n,totalRows:o,needReverse:l,startPositions:h,rowHeight:d}=e;if(this.endRow===o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const y=h[this.endRow]+d-h[this.startRow-1];if(this.startRow-=1,y>=s-n)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null,i+s-n<0||i>h.at(-1)+d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jv(t,e,r){return(e=R2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R2e(t){var e=A2e(t,"string");return typeof e=="symbol"?e:e+""}function A2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O2e{constructor(){jv(this,"count",0),jv(this,"startColumn",0),jv(this,"endColumn",0),jv(this,"startPosition",0),jv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Uv(t,e,r){return(e=I2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I2e(t){var e=P2e(t,"string");return typeof e=="symbol"?e:e+""}function P2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2e{constructor(){Uv(this,"count",0),Uv(this,"startRow",0),Uv(this,"endRow",0),Uv(this,"startPosition",0),Uv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function bB(t,e,r){return(e=M2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M2e(t){var e=k2e(t,"string");return typeof e=="symbol"?e:e+""}function k2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N2e extends yq{constructor(){super(...arguments),bB(this,"columnStartOffset",0),bB(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalColumns:s,startPositions:n}=e;if(this.startColumn!==null&&typeof i=="function"){const o=this.startColumn,l=this.endColumn;i(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-l}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=n[this.startColumn])!==null&&r!==void 0?r:null,s<this.endColumn&&(this.endColumn=s-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xB(t,e,r){return(e=D2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D2e(t){var e=L2e(t,"string");return typeof e=="symbol"?e:e+""}function L2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H2e extends Cq{constructor(){super(...arguments),xB(this,"rowStartOffset",0),xB(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalRows:s,startPositions:n}=e;if(this.startRow!==null&&typeof i=="function"){const o=this.startRow,l=this.endRow;i(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-l}this.startRow<0&&(this.startRow=0),this.startPosition=(r=n[this.startRow])!==null&&r!==void 0?r:null,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function EB(t,e,r){return(e=$2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $2e(t){var e=B2e(t,"string");return typeof e=="symbol"?e:e+""}function B2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sq{constructor(e){EB(this,"calculationTypes",[]),EB(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[i,s]=r;this.calculationResults.set(i,s),s.initialize(e)})}_process(e,r){this.calculationTypes.forEach(i=>{let[,s]=i;return s.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,i]=r;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Zl(t,e,r){return(e=V2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V2e(t){var e=W2e(t,"string");return typeof e=="symbol"?e:e+""}function W2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u1=50;class j2e extends Sq{constructor(e){let{calculationTypes:r,viewportWidth:i,scrollOffset:s,totalColumns:n,columnWidthFn:o,overrideFn:l,inlineStartOffset:h}=e;super(r),Zl(this,"viewportWidth",0),Zl(this,"scrollOffset",0),Zl(this,"zeroBasedScrollOffset",0),Zl(this,"totalColumns",0),Zl(this,"columnWidthFn",null),Zl(this,"columnWidth",0),Zl(this,"overrideFn",null),Zl(this,"inlineStartOffset",0),Zl(this,"totalCalculatedWidth",0),Zl(this,"startPositions",[]),Zl(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalColumns=n,this.columnWidthFn=o,this.overrideFn=l,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?u1:r}}function wl(t,e,r){return(e=U2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U2e(t){var e=z2e(t,"string");return typeof e=="symbol"?e:e+""}function z2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G2e extends Sq{constructor(e){let{calculationTypes:r,viewportHeight:i,scrollOffset:s,totalRows:n,defaultRowHeight:o,rowHeightFn:l,overrideFn:h,horizontalScrollbarHeight:d}=e;super(r),wl(this,"viewportHeight",0),wl(this,"scrollOffset",0),wl(this,"zeroBasedScrollOffset",0),wl(this,"totalRows",0),wl(this,"rowHeightFn",null),wl(this,"rowHeight",0),wl(this,"overrideFn",null),wl(this,"horizontalScrollbarHeight",0),wl(this,"innerViewportHeight",0),wl(this,"totalCalculatedHeight",0),wl(this,"startPositions",[]),wl(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalRows=n,this.rowHeightFn=l,this.overrideFn=h,this.horizontalScrollbarHeight=d??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Y2e(t,e,r){K2e(t,e),e.set(t,r)}function K2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TB(t,e,r){return(e=X2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X2e(t){var e=q2e(t,"string");return typeof e=="symbol"?e:e+""}function q2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bm(t,e){return t.get(bq(t,e))}function _B(t,e,r){return t.set(bq(t,e),r),r}function bq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ah=new WeakMap;class Og{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;TB(this,"row",null),TB(this,"col",null),Y2e(this,ah,!1),_B(ah,this,i),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:i,countRowHeaders:s,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-n||this.col<-s||this.row>=r||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return bm(ah,this)}isSouthEastOf(e){return this.row>=e.row&&(bm(ah,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(bm(ah,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(bm(ah,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(bm(ah,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Og&&_B(ah,this,e.isRtl()),this}clone(){return new Og(this.row,this.col,bm(ah,this))}toObject(){return{row:this.row,col:this.col}}}function J2e(t,e,r){Q2e(t,e),e.set(t,r)}function Q2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gO(t,e,r){return(e=Z2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z2e(t){var e=eEe(t,"string");return typeof e=="symbol"?e:e+""}function eEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yl(t,e){return t.get(xq(t,e))}function tEe(t,e,r){return t.set(xq(t,e),r),r}function xq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var da=new WeakMap;class JC{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;gO(this,"highlight",null),gO(this,"from",null),gO(this,"to",null),J2e(this,da,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=i.clone(),tEe(da,this,s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:i}=e,s=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return s.row<=r&&n.row>=r&&s.col<=i&&n.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),n=this.getDirection(),o=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),h=Math.min(i.row,o.row),d=Math.min(i.col,o.col),g=Math.max(s.row,l.row),y=Math.max(s.col,l.col),C=this._createCellCoords(h,d),x=this._createCellCoords(g,y);return this.from=C,this.to=x,this.setDirection(n),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return yl(da,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return yl(da,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return yl(da,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return yl(da,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return yl(da,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return yl(da,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return yl(da,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return yl(da,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Og))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return r.top===i.top&&s.push("top"),r.right===i.right&&s.push(yl(da,this)?"left":"right"),r.bottom===i.bottom&&s.push("bottom"),r.left===i.left&&s.push(yl(da,this)?"right":"left"),s}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=r.row;s++)for(let n=e.col;n<=r.col;n++)!(this.from.row===s&&this.from.col===n)&&!(this.to.row===s&&this.to.col===n)&&i.push(this._createCellCoords(s,n));return i}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=r.row;s++)for(let n=e.col;n<=r.col;n++)e.row===s&&e.col===n?i.push(e):r.row===s&&r.col===n?i.push(r):i.push(this._createCellCoords(s,n));return i}forAll(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let s=r.row;s<=i.row;s++)for(let n=r.col;n<=i.col;n++)if(e(s,n)===!1)return}clone(){return new JC(this.highlight,this.from,this.to,yl(da,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Og(e,r,yl(da,this))}}function Zc(t,e,r){rEe(t,e),e.set(t,r)}function rEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yr(t,e){return t.get(Eq(t,e))}function Tf(t,e,r){return t.set(Eq(t,e),r),r}function Eq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cl=new WeakMap,mO=new WeakMap,Ds=new WeakMap,xm=new WeakMap,Db=new WeakMap,ec=new WeakMap,pO=new WeakMap,zv=new WeakMap,c0=new WeakMap,eu=new WeakMap;let Tq=class{constructor(e,r,i,s,n,o){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Zc(this,Cl,void 0),Zc(this,mO,void 0),Zc(this,Ds,void 0),Zc(this,xm,void 0),Zc(this,Db,void 0),Zc(this,ec,void 0),Zc(this,pO,void 0),Zc(this,zv,void 0),Zc(this,c0,[null,null]),Zc(this,eu,[null,null]),Tf(Cl,this,i),Tf(mO,this,r),Tf(Ds,this,n),Tf(xm,this,o),Tf(Db,this,l),Tf(ec,this,s),Tf(pO,this,e),this.registerEvents()}registerEvents(){yr(ec,this).addEventListener(yr(Ds,this).holder,"contextmenu",i=>this.onContextMenu(i)),yr(ec,this).addEventListener(yr(Ds,this).TABLE,"mouseover",i=>this.onMouseOver(i)),yr(ec,this).addEventListener(yr(Ds,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{yr(ec,this).addEventListener(yr(Ds,this).holder,"touchstart",i=>this.onTouchStart(i)),yr(ec,this).addEventListener(yr(Ds,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),yr(ec,this).addEventListener(yr(Ds,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||yr(Cl,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,yr(Cl,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{yr(ec,this).addEventListener(yr(Ds,this).holder,"mouseup",i=>this.onMouseUp(i)),yr(ec,this).addEventListener(yr(Ds,this).holder,"mousedown",i=>this.onMouseDown(i))};sd()?e():(tq()&&e(),r())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(yr(zv,this)&&i){const[s,n]=[i.row,yr(zv,this).from.row],[o,l]=[i.col,yr(zv,this).from.col];return s===n&&o===l}return!1}parentCell(e){const r={},i=yr(Ds,this).TABLE,s=Ib(e,["TD","TH"],i);return s?(r.coords=yr(Ds,this).getCoords(s),r.TD=s):Ir(e,"wtBorder")&&Ir(e,"current")?(r.coords=yr(xm,this).getFocusSelection().cellRange.highlight,r.TD=yr(Ds,this).getCell(r.coords)):Ir(e,"wtBorder")&&Ir(e,"area")&&yr(xm,this).getAreaSelection().cellRange&&(r.coords=yr(xm,this).getAreaSelection().cellRange.to,r.TD=yr(Ds,this).getCell(r.coords)),r}onMouseDown(e){const r=yr(mO,this).rootDocument.activeElement,i=qX(SSe,e.target),s=e.target;if(!["TD","TH"].includes(r.nodeName)&&(s===r||i(0)===r||i(1)===r))return;const n=this.parentCell(s);Ir(s,"corner")?yr(Cl,this).getSetting("onCellCornerMouseDown",e,s):n.TD&&yr(Cl,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,n.coords,n.TD),(e.button===0||this.touchApplied)&&n.TD&&(yr(eu,this)[0]=n.TD,clearTimeout(yr(c0,this)[0]),yr(c0,this)[0]=setTimeout(()=>{yr(eu,this)[0]=null},1e3))}onContextMenu(e){if(yr(Cl,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!yr(Cl,this).has("onCellMouseOver"))return;const r=yr(Ds,this).TABLE,i=Ib(e.target,["TD","TH"],r),s=yr(Db,this)||this;i&&i!==s.lastMouseOver&&pg(i,r)&&(s.lastMouseOver=i,this.callListener("onCellMouseOver",e,yr(Ds,this).getCoords(i),i))}onMouseOut(e){if(!yr(Cl,this).has("onCellMouseOut"))return;const r=yr(Ds,this).TABLE,i=Ib(e.target,["TD","TH"],r),s=Ib(e.relatedTarget,["TD","TH"],r),n=yr(Db,this)||this;i&&i!==s&&pg(i,r)&&(this.callListener("onCellMouseOut",e,yr(Ds,this).getCoords(i),i),s===null&&(n.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&yr(Cl,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===yr(eu,this)[0]&&r.TD===yr(eu,this)[1]?(Ir(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),yr(eu,this)[0]=null,yr(eu,this)[1]=null):r.TD===yr(eu,this)[0]&&(yr(eu,this)[1]=r.TD,clearTimeout(yr(c0,this)[1]),yr(c0,this)[1]=setTimeout(()=>{yr(eu,this)[1]=null},500)))}onTouchStart(e){Tf(zv,this,yr(xm,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const i=e.target,s=(r=this.parentCell(i))===null||r===void 0?void 0:r.coords,n=nr(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&n&&yr(Cl,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];iq()&&(rbe()||nbe())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,i,s){const n=yr(Cl,this).getSettingPure(e);n&&n(r,i,s,yr(pO,this).call(this))}destroy(){clearTimeout(yr(c0,this)[0]),clearTimeout(yr(c0,this)[1]),yr(ec,this).destroy()}};function vO(t,e,r){return(e=nEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nEe(t){var e=iEe(t,"string");return typeof e=="symbol"?e:e+""}function iEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sEe{constructor(e,r,i){vO(this,"offset",void 0),vO(this,"total",void 0),vO(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function wO(t,e,r){return(e=oEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oEe(t){var e=aEe(t,"string");return typeof e=="symbol"?e:e+""}function aEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lEe{constructor(e,r,i){wO(this,"offset",void 0),wO(this,"total",void 0),wO(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cEe=0,KE=1,XE=2;function Lb(t,e,r){return(e=uEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uEe(t){var e=hEe(t,"string");return typeof e=="symbol"?e:e+""}function hEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RB{constructor(){Lb(this,"currentSize",0),Lb(this,"nextSize",0),Lb(this,"currentOffset",0),Lb(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function yO(t,e,r){return(e=fEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fEe(t){var e=dEe(t,"string");return typeof e=="symbol"?e:e+""}function dEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gEe{constructor(){yO(this,"size",new RB),yO(this,"workingSpace",cEe),yO(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof RB}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=KE,e.workingSpace=XE,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=XE,e.workingSpace=KE,this.sharedSize=e.getViewSize()}}function Em(t,e,r){return(e=mEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mEe(t){var e=pEe(t,"string");return typeof e=="symbol"?e:e+""}function pEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _q{constructor(e,r,i){Em(this,"rootNode",void 0),Em(this,"nodesPool",void 0),Em(this,"sizeSet",new gEe),Em(this,"childNodeType",void 0),Em(this,"visualIndex",0),Em(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let i=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)i+=1;else if(r.isPlaceOn(KE))break;s=s.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,i=this.isSharedViewSet(),{nextSize:s}=r.getViewSize();let n=this.getRenderedChildCount();for(;n<s;){const l=this.nodesPool();!i||i&&r.isPlaceOn(XE)?e.appendChild(l):e.insertBefore(l,e.firstChild),n+=1}const o=i&&r.isPlaceOn(KE);for(;n>s;)e.removeChild(o?e.firstChild:e.lastChild),n-=1}render(){const{rootNode:e,sizeSet:r}=this;let i=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(XE)&&(i+=r.sharedSize.nextSize);let s=e.childNodes[i];if(s.tagName!==this.childNodeType){const n=this.nodesPool();e.replaceChild(n,s),s=n}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class Rq extends _q{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function vEe(t,e,r){return(e=wEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wEe(t){var e=yEe(t,"string");return typeof e=="symbol"?e:e+""}function yEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CEe{constructor(e){vEe(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Gv(t,e,r){return(e=SEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SEe(t){var e=bEe(t,"string");return typeof e=="symbol"?e:e+""}function bEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QC{constructor(e,r){Gv(this,"nodesPool",null),Gv(this,"nodeType",void 0),Gv(this,"rootNode",void 0),Gv(this,"table",null),Gv(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new CEe(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function AB(t,e,r){return(e=xEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xEe(t){var e=EEe(t,"string");return typeof e=="symbol"?e:e+""}function EEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TEe extends QC{constructor(){super("TH"),AB(this,"orderViews",new WeakMap),AB(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Rq(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:i,rows:s,cells:n}=this.table;for(let o=0;o<e;o++){const l=this.table.renderedRowToSource(o),h=s.getRenderedNode(o);this.sourceRowIndex=l;const d=this.obtainOrderView(h),g=n.obtainOrderView(h);d.appendView(g).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let y=0;y<i;y++){d.render();const C=d.getCurrentNode();C.className="",C.removeAttribute("style"),F1(C,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Fr(C,[eSe(),cSe(),Bk(y+1),P1(-1)]),r[y](l,C,y)}d.end()}}}class _Ee extends QC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,n=s+r;for(let l=0,h=e;l<h;l++){for(i=this.rootNode.childNodes[l],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let l=e;l<o;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Vu(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Fr(this.rootNode,[MX()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:i,columnsToRender:s,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Fr(o,[GP(),LX(r+1)]);for(let l=-1*n;l<s;l+=1){const h=this.table.renderedColumnToSource(l),d=o.childNodes[l+n];d.className="",d.removeAttribute("style"),F1(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Fr(d,[Bk(l+1+this.table.rowHeadersCount),P1(-1),tSe(),...l>=0?[lSe()]:[GP()]]),i[r](h,d,r)}}}}let OB=!1;class REe extends QC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,i=e+r;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!OB&&e>1e3&&(OB=!0,Nn(Ln`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let s=0;s<r;s++){const n=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getHeaderWidth(n);this.rootNode.childNodes[s].style.width=`${o}px`}for(let s=0;s<e;s++){const n=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getWidth(n);this.rootNode.childNodes[s+r].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&ht(i,"rowHeader")}}function AEe(t,e,r){return(e=OEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OEe(t){var e=IEe(t,"string");return typeof e=="symbol"?e:e+""}function IEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hb={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let IB=!1;class PEe extends QC{constructor(e){super("TR",e),AEe(this,"orderView",void 0),this.orderView=new _q(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!IB&&e>1e3&&(IB=!0,Nn(Ln`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Fr(this.rootNode,[MX()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let s=0;s<e;s++){this.orderView.render();const n=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(s);if(this.table.isAriaEnabled()){var r,i;Fr(n,[GP(),LX(o+((r=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}Ar(n,[Hb.rowEven,Hb.rowOdd]),(o+1)%2===0?ht(n,Hb.rowEven):ht(n,Hb.rowOdd)}this.orderView.end()}}function PB(t,e,r){return(e=FEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FEe(t){var e=MEe(t,"string");return typeof e=="symbol"?e:e+""}function MEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kEe extends QC{constructor(){super("TD"),PB(this,"orderViews",new WeakMap),PB(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Rq(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:i,rowHeaders:s}=this.table;for(let l=0;l<e;l++){const h=this.table.renderedRowToSource(l),d=i.getRenderedNode(l);this.sourceRowIndex=h;const g=this.obtainOrderView(d),y=s.obtainOrderView(d);g.prependView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let C=0;C<r;C++){g.render();const x=g.getCurrentNode(),_=this.table.renderedColumnToSource(C);if(Ir(x,"hide")||(x.className=""),x.removeAttribute("style"),x.removeAttribute("dir"),F1(x,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,_,x),this.table.isAriaEnabled()){var n,o;Fr(x,[...x.hasAttribute("role")?[]:[ZCe()],P1(-1),Bk(_+((n=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&n!==void 0?n:0)+1)])}}g.end()}}}function us(t,e,r){return(e=NEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NEe(t){var e=DEe(t,"string");return typeof e=="symbol"?e:e+""}function DEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LEe{constructor(e){let{cellRenderer:r,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};us(this,"rootNode",void 0),us(this,"rootDocument",void 0),us(this,"rowHeaders",null),us(this,"columnHeaders",null),us(this,"colGroup",null),us(this,"rows",null),us(this,"cells",null),us(this,"rowFilter",null),us(this,"columnFilter",null),us(this,"rowUtils",null),us(this,"columnUtils",null),us(this,"rowsToRender",0),us(this,"columnsToRender",0),us(this,"rowHeaderFunctions",[]),us(this,"rowHeadersCount",0),us(this,"columnHeaderFunctions",[]),us(this,"columnHeadersCount",0),us(this,"cellRenderer",void 0),us(this,"activeOverlayName",void 0),us(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:i,rows:s,cells:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),n.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=i,this.rows=s,this.cells=n}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let i=0;i<e;i++){const s=r.getRenderedNode(i),n=this.rowUtils;if(s.firstChild){const o=this.renderedRowToSource(i),l=n.getHeightByOverlayName(o,this.activeOverlayName),d=this.stylesHandler.areCellsBorderBox()?0:1;l?s.firstChild.style.height=`${l-d}px`:s.firstChild.style.height=""}}}}class HEe{constructor(){let{TABLE:e,THEAD:r,COLGROUP:i,TBODY:s,rowUtils:n,columnUtils:o,cellRenderer:l,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new LEe(e,{cellRenderer:l,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new TEe,columnHeaders:new _Ee(r),colGroup:new REe(i),rows:new PEe(s),cells:new kEe}),this.renderer.setAxisUtils(n,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function CO(t,e,r){return(e=$Ee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Ee(t){var e=BEe(t,"string");return typeof e=="symbol"?e:e+""}function BEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VEe{constructor(e,r){CO(this,"dataAccessObject",void 0),CO(this,"wtSettings",void 0),CO(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(r=r?Math.max(r,i):i),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const i=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let n=0;n<i;n++){let o=Array.isArray(r)?r[n]:r;o=o??s,this.headerWidths.set(n,o)}}}}function FB(t,e,r){return(e=WEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WEe(t){var e=jEe(t,"string");return typeof e=="symbol"?e:e+""}function jEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UEe{constructor(e,r){FB(this,"dataAccessObject",void 0),FB(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}getHeightByOverlayName(e,r){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(i=i===void 0?s:Math.max(i,s)),i}}function tu(t,e,r){return(e=zEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zEe(t){var e=GEe(t,"string");return typeof e=="symbol"?e:e+""}function GEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k1{constructor(e,r,i,s,n){tu(this,"wtSettings",null),tu(this,"domBindings",void 0),tu(this,"TBODY",null),tu(this,"THEAD",null),tu(this,"COLGROUP",null),tu(this,"hasTableHeight",!0),tu(this,"hasTableWidth",!0),tu(this,"isTableVisible",!1),tu(this,"tableOffset",0),tu(this,"holderOffset",0),this.domBindings=i,this.isMaster=n==="master",this.name=n,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,VX(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new UEe(this.dataAccessObject,this.wtSettings),this.columnUtils=new VEe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new HEe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ir(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",r&&r.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Fr(i,[Nu()]),i}createHider(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ir(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",r&&r.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Fr(i,[Nu()]),i}createHolder(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Ir(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",r&&r.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Fr(i.parentNode,[Nu()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Fr(i,[Nu()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:i,wtViewport:s}=this.dataAccessObject,n=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),l=r.getSetting("rowHeaders"),h=l.length,d=r.getSetting("columnHeaders"),g=d.length;let y=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=Ws(this.holder),y=s.createCalculators(y),h&&!r.getSetting("fixedColumnsStart"))){const x=i.inlineStartOverlay.getScrollPosition(),_=this.correctHeaderWidth;this.correctHeaderWidth=x!==0,_!==this.correctHeaderWidth&&(y=!1)}if(y)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=Ws(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const x=n>0?this.getFirstRenderedRow():0,_=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new lEe(x,n,g),this.columnFilter=new sEe(_,o,h);let E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const R={};this.wtSettings.getSetting("beforeDraw",!0,R),E=R.skipRender!==!0}E&&(this.tableRenderer.setHeaderContentRenderers(l,d),(this.is(Fu)||this.is(bd))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Fu))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||s.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Fu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let C=!1;return this.isMaster&&(C=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(C=i.bottomOverlay.resetFixedPosition()||C),C=i.inlineStartOverlay.resetFixedPosition()||C,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(y),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const s=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let n,o,l;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,n=this.getColumnHeaderHeight(i),o=this.getColumnHeader(r,i),o&&(l=oy(o),(!n&&s<l||n<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(h)?h[i]!==null&&h[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(h[i]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let n=0,o=s.length;n<o;n++)if(i[n]){if(!r[n]||r[n].childNodes.length===0)return;r[n].childNodes[0].style.height=`${i[n]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Fu))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let s=0;s<i;s++){const n=this.rowFilter.renderedToSource(s);r.oversizedRows&&r.oversizedRows[n]&&(r.oversizedRows[n]=void 0)}}}getCell(e){let r=e.row,i=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",r,i,!this.isMaster,"render");if(s&&Array.isArray(s)&&([r,i]=s),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const n=this.getRow(r);if(!n&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,i=null;if(e<0){var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var n;r=(n=this.rowFilter)===null||n===void 0?void 0:n.sourceToRendered(e),i=this.TBODY}return r!==void 0&&i!==void 0?i.childNodes.length<r+1?!1:i.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[r];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const n=s.childNodes[i];n&&r.push(n)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(r>=i)return;const s=this.rowFilter.sourceToRendered(e),n=s<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):s,l=(s<0?this.THEAD:this.TBODY).childNodes[n];return l==null?void 0:l.childNodes[r]}getRowHeaders(e){const r=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<i;s++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=n==null?void 0:n.childNodes[s];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=_g(r,["TD","TH"])),r===null)return null;const i=r.parentNode,s=i.parentNode;let n=TSe(i),o=r.cellIndex;a0(Fg,r,this.wtRootElement)||a0(Ig,r,this.wtRootElement)?s.nodeName==="THEAD"&&(n-=s.childNodes.length):a0(bd,r,this.wtRootElement)||a0(Fu,r,this.wtRootElement)?n=this.wtSettings.getSetting("totalRows")-s.childNodes.length+n:s===this.THEAD?n=this.rowFilter.visibleColHeadedRowToSourceRow(n):n=this.rowFilter.renderedToSource(n),a0(Fg,r,this.wtRootElement)||a0(Pg,r,this.wtRootElement)||a0(bd,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o);const l=this.wtSettings.getSetting("onModifyGetCoordsElement",n,o);return l&&Array.isArray(l)&&([n,o]=l),this.wot.createCellCoords(n,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=oy(this.TBODY)-1,s=this.wot.stylesHandler.areCellsBorderBox(),n=s?Ji:oy,o=s?0:1,l=s?1:0;let h,d,g,y,C;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,g=this.rowFilter.renderedToSource(e),h=this.getRowHeight(g),y=this.getTrForRow(g),C=y.querySelector("th");const x=g===0?l:0;C?d=n(C):d=n(y)-o,(!h&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<d-x||h<d)&&(s||(d+=1),this.dataAccessObject.wtViewport.oversizedRows[g]=d)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ns(this.TABLE)}getHeight(){return Ji(this.TABLE)}getTotalWidth(){const e=ns(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ji(this.hider);return e!==0?e:this.getHeight()}isVisible(){return l1(this.TABLE)}_modifyRowHeaderWidth(e){let r=oi(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const YEe="stickyRowsBottom",tN={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};uf(tN,"MIXIN_NAME",YEe,{writable:!1,enumerable:!1});const KEe="stickyColumnsStart",V_={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};uf(V_,"MIXIN_NAME",KEe,{writable:!1,enumerable:!1});class rN extends k1{constructor(e,r,i,s){super(e,r,i,s,bd)}}Xn(rN,tN);Xn(rN,V_);const Ig="top",Fu="bottom",Pg="inline_start",Fg="top_inline_start_corner",bd="bottom_inline_start_corner",Aq=[Ig,Fu,Pg,Fg,bd],XEe=new Map([[Ig,`ht_clone_${Ig}`],[Fu,`ht_clone_${Fu}`],[Pg,`ht_clone_${Pg} ht_clone_left`],[Fg,`ht_clone_${Fg} ht_clone_top_left_corner`],[bd,`ht_clone_${bd} ht_clone_bottom_left_corner`]]);function qEe(t,e){JEe(t,e),e.add(t)}function JEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QEe(t,e,r){return(e=ZEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZEe(t){var e=eTe(t,"string");return typeof e=="symbol"?e:e+""}function eTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $b(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yv=new WeakSet;class tTe{constructor(e){qEe(this,Yv),QEe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,i){if(e.col<0||e.row<0)return!1;const s=this.scrollViewportHorizontally(e.col,r),n=this.scrollViewportVertically(e.row,i);return s||n}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i)return!1;const n=tl(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,n),!Number.isInteger(e)||e<0||e>s)return!1;r=n.value;const{fixedColumnsStart:o,inlineStartOverlay:l}=this.dataAccessObject,h=r==="auto";if(h&&e<o)return!1;const d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();let y=!1;return(h&&(e<d||e>g)||!h)&&(y=l.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():r==="end")),y}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i)return!1;const n=tl(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,n),!Number.isInteger(e)||e<0||e>s)return!1;r=n.value;const{fixedRowsBottom:o,fixedRowsTop:l,topOverlay:h}=this.dataAccessObject,d=r==="auto";if(d&&(e<l||e>s-o-1))return!1;const g=this.getFirstVisibleRow(),y=this.getLastVisibleRow();let C=!1;return(d&&(e<g||e>y)||!d)&&(C=h.scrollTo(e,d?e>=this.getLastPartiallyVisibleRow():r==="bottom")),C}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return $b(Yv,this,kB).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return $b(Yv,this,kB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return $b(Yv,this,MB).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return $b(Yv,this,MB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function MB(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:i,wtViewport:s,totalColumns:n,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const l=e.getSetting("rtlMode");let h=null;if(l){const g=i.TABLE.getBoundingClientRect(),C=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(g.right-C)}else h=Ws(i.wtRootElement).left;const d=Math.abs(jX(o,o));if(h>d){const g=UX(o);let y=s.getRowHeaderWidth();for(let C=1;C<=n;C++)if(y+=r.sumCellSizes(C-1,C),h+y-d>=g){t=C-2;break}}}return t}function kB(t){const{topOverlay:e,wtTable:r,wtViewport:i,totalRows:s,rootWindow:n}=this.dataAccessObject;if(e.mainTableScrollableElement===n){const o=Ws(r.wtRootElement),l=jk(n,n);if(o.top>l){const h=oy(n);let d=i.getColumnHeaderHeight();for(let g=1;g<=s;g++)if(d+=e.sumCellSizes(g-1,g),o.top+d-l>=h){t=g-2;break}}}return t}function Sl(t,e,r){return(e=rTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rTe(t){var e=nTe(t,"string");return typeof e=="symbol"?e:e+""}function nTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nN{get eventManager(){return new Dc(this)}constructor(e,r){Sl(this,"wtTable",void 0),Sl(this,"wtScroll",void 0),Sl(this,"wtViewport",void 0),Sl(this,"wtOverlays",void 0),Sl(this,"selectionManager",void 0),Sl(this,"wtEvent",void 0),Sl(this,"guid",`wt_${IX()}`),Sl(this,"drawInterrupted",!1),Sl(this,"drawn",!1),Sl(this,"activeOverlayName","master"),Sl(this,"domBindings",void 0),Sl(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new tTe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;r<i;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,i){Rg(i,e[r])}])}}createCellCoords(e,r){return new Og(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,i){return new JC(e,r,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,i){return this.wtScroll.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function NB(t,e,r){return(e=iTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iTe(t){var e=sTe(t,"string");return typeof e=="symbol"?e:e+""}function sTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oTe extends nN{constructor(e,r,i){super(e,r),NB(this,"cloneSource",void 0),NB(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new Tq(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function aTe(t,e,r){return(e=lTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lTe(t){var e=cTe(t,"string");return typeof e=="symbol"?e:e+""}function cTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZC{constructor(e,r,i,s,n){aTe(this,"wtSettings",null),uf(this,"wot",e,{writable:!1}),this.domBindings=n,this.facadeGetter=r,this.wtSettings=s;const{TABLE:o,hider:l,spreader:h,holder:d,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=l,this.spreader=h,this.holder=d,this.wtRootElement=g,this.trimmingContainer=c1(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=c1(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=jE(e.TABLE)}getRelativeCellPosition(e,r,i){if(this.clone.wtTable.holder.contains(e)===!1){Nn(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),l=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(h),top:h.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop};let y=null;return s?y=this.getRelativeCellPositionWithinWindow(o,n,g,d):y=this.getRelativeCellPositionWithinHolder(o,l,n,g,d),y}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,i,s){const n=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,l=0;if(!r)o=s.start;else{let h=n.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(n.left+n.width+so())),o=h<=0?-1*h:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-n.top:l=s.top,{start:i.start+o,top:i.top+l}}getRelativeCellPositionWithinHolder(e,r,i,s,n){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,h=0;if(i||(l=o.horizontal-n.start),r){const d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(h=o.vertical-n.top);return{start:s.start-l,top:s.top-h}}makeClone(){if(Aq.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,n=i.createElement("div"),o=i.createElement("table"),l=e.wtRootElement.parentNode;n.className=`${XEe.get(this.type)} handsontable`,n.setAttribute("dir",this.isRtl()?"rtl":"ltr"),n.style.position="absolute",n.style.top=0,n.style.overflow="visible",this.isRtl()?n.style.right=0:n.style.left=0,r.getSetting("ariaTags")&&Fr(n,[Nu()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),n.appendChild(o),l.appendChild(n);const d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===Ig||d==="vertical"&&this.type===Pg?this.mainTableScrollableElement=s:s.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=jE(e.TABLE),new oTe(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,i=e.style,s=r.style,n=e.parentNode.style;[i,s,n].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class uTe extends ZC{constructor(e,r,i,s,n,o){super(e,r,bd,i,s),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new rN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${n}px`,r.style.bottom=`${o}px`}else L_(r),this.repositionOverlay();let i=Ji(this.clone.wtTable.TABLE);const s=ns(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),r.style.height=`${i}px`,r.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let n=0;r.hasVerticalScroll()||(n+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(n+=so(i)),s.style.bottom=`${n}px`}}const hTe="calculatedColumns",W_={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};uf(W_,"MIXIN_NAME",hTe,{writable:!1,enumerable:!1});class iN extends k1{constructor(e,r,i,s){super(e,r,i,s,Fu)}}Xn(iN,tN);Xn(iN,W_);function fTe(t,e,r){return(e=dTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dTe(t){var e=gTe(t,"string");return typeof e=="symbol"?e:e+""}function gTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mTe extends ZC{constructor(e,r,i,s){super(e,r,Fu,i,s),fTe(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new iN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let i=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(i=this.getOverlayOffset(),r.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let n=0;r.hasVerticalScroll()||(n+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(n+=so(i)),s.style.bottom=`${n}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let i=!1;return this.mainTableScrollableElement===r?(r.scrollTo(Wk(r),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:i,stylesHandler:s}=this.wot,n=s.getDefaultRowHeight();let o=e,l=0;for(;o<r;){const h=i.getRowHeight(o);l+=h===void 0?n:h,o+=1}return l}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let d=r.getWorkspaceWidth();r.hasVerticalScroll()&&(d-=so(i)),d=Math.min(d,e.wtRootElement.scrollWidth),o.width=`${d}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let h=Ji(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),o.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let i=this.getTableParentOffset();const n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&n.offsetHeight!==n.clientHeight&&(o=so(this.domBindings.rootDocument)),r?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jk(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight(),o=s-n,l=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+s,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==r,s=this.wtSettings.getSetting("columnHeaders");let n=!1;if((i||r===0)&&s.length>0){const o=this.wot.wtTable.holder.parentNode,l=Ir(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ht(o,"innerBorderBottom"),n=!l):(Ar(o,"innerBorderBottom"),n=l)}return n}}const pTe="calculatedRows",sN={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};uf(sN,"MIXIN_NAME",pTe,{writable:!1,enumerable:!1});class oN extends k1{constructor(e,r,i,s){super(e,r,i,s,Pg)}}Xn(oN,sN);Xn(oN,V_);const vTe="localHooks",uo={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,i,s,n,o){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let h=0;h<l;h++)YP(this._localHooks[t][h],this,e,r,i,s,n,o)}},clearLocalHooks(){return this._localHooks={},this}};uf(uo,"MIXIN_NAME",vTe,{writable:!1,enumerable:!1});let Oq=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Xn(Oq,uo);const Iq="active-header",aN="header",lN="area",qE="focus",wTe="fill",yTe="row",CTe="column",STe="custom-selection",cN=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),s=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:i,borderStyle:"solid",borderColor:s})};var bTe=$_;bTe("flat");function xTe(t,e){Pq(t,e),e.add(t)}function DB(t,e,r){Pq(t,e),e.set(t,r)}function Pq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fi(t,e){return t.get(ay(t,e))}function LB(t,e,r){return t.set(ay(t,e),r),r}function ay(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var cc=new WeakMap,Ro=new WeakMap,Bb=new WeakSet;class ETe{constructor(){xTe(this,Bb),DB(this,cc,void 0),DB(this,Ro,void 0)}setActiveOverlay(e){return LB(Ro,this,e),this}setActiveSelection(e){return LB(cc,this,e),this}scan(){const e=Fi(cc,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="area"?this.scanCellsRange(i=>r.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i)),this.scanCellsRange(i=>r.add(i))):e==="fill"?this.scanCellsRange(i=>r.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>r.add(i)),this.scanRowsInCellsRange(i=>r.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanColumnsInCellsRange(i=>r.add(i))),r}scanColumnsInHeadersRange(e){const[r,i,s,n]=Fi(cc,this).getCorners(),{wtTable:o}=Fi(Ro,this),l=o.getRenderedColumnsCount(),h=o.getColumnHeadersCount();let d=0;for(let g=-o.getRowHeadersCount();g<l;g++){const y=o.columnFilter.renderedToSource(g);if(!(y<i||y>n)){for(let C=-h;C<0;C++){if(C<r||C>s)continue;const x=C+h;let _=o.getColumnHeader(y,x);const E=Fi(Ro,this).getSetting("onBeforeHighlightingColumnHeader",y,x,{selectionType:Fi(cc,this).settings.selectionType,columnCursor:d,selectionWidth:n-i+1});E!==null&&(E!==y&&(_=o.getColumnHeader(E,x)),e(_))}d+=1}}}scanRowsInHeadersRange(e){const[r,i,s,n]=Fi(cc,this).getCorners(),{wtTable:o}=Fi(Ro,this),l=o.getRenderedRowsCount(),h=o.getRowHeadersCount();let d=0;for(let g=-o.getColumnHeadersCount();g<l;g++){const y=o.rowFilter.renderedToSource(g);if(!(y<r||y>s)){for(let C=-h;C<0;C++){if(C<i||C>n)continue;const x=C+h;let _=o.getRowHeader(y,x);const E=Fi(Ro,this).getSetting("onBeforeHighlightingRowHeader",y,x,{selectionType:Fi(cc,this).settings.selectionType,rowCursor:d,selectionHeight:s-r+1});E!==null&&(E!==y&&(_=o.getRowHeader(E,x)),e(_))}d+=1}}}scanCellsRange(e){const{wtTable:r}=Fi(Ro,this);ay(Bb,this,TTe).call(this,(i,s)=>{const n=r.getCell(Fi(Ro,this).createCellCoords(i,s)),o=Fi(Ro,this).getSetting("onAfterDrawSelection",i,s,Fi(cc,this).settings.layerLevel);typeof o=="string"&&ht(n,o),e(n)})}scanRowsInCellsRange(e){const[r,,i]=Fi(cc,this).getCorners(),{wtTable:s}=Fi(Ro,this);ay(Bb,this,HB).call(this,(n,o)=>{if(n>=r&&n<=i){const l=s.getCell(Fi(Ro,this).createCellCoords(n,o));e(l)}})}scanColumnsInCellsRange(e){const[,r,,i]=Fi(cc,this).getCorners(),{wtTable:s}=Fi(Ro,this);ay(Bb,this,HB).call(this,(n,o)=>{if(o>=r&&o<=i){const l=s.getCell(Fi(Ro,this).createCellCoords(n,o));e(l)}})}}function TTe(t){let[e,r,i,s]=Fi(cc,this).getCorners();if(e<0&&i<0||r<0&&s<0)return;const{wtTable:n}=Fi(Ro,this),o=e!==i||r!==s;if(r=Math.max(r,0),s=Math.max(s,0),e=Math.max(e,0),i=Math.max(i,0),o){if(r=Math.max(r,n.getFirstRenderedColumn()),s=Math.min(s,n.getLastRenderedColumn()),e=Math.max(e,n.getFirstRenderedRow()),i=Math.min(i,n.getLastRenderedRow()),s<r||i<e)return}else if(!(n.getCell(Fi(Ro,this).createCellCoords(e,r))instanceof HTMLElement))return;for(let l=e;l<=i;l+=1)for(let h=r;h<=s;h+=1)t(l,h)}function HB(t){const{wtTable:e}=Fi(Ro,this),r=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let s=0;s<r;s+=1){const n=e.rowFilter.renderedToSource(s);for(let o=0;o<i;o+=1)t(n,e.columnFilter.renderedToSource(o))}}class $B{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=cN(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,i=this.main.childNodes.length;r<i;r++){const s=this.main.childNodes[r];this.eventManager.addEventListener(s,"mouseenter",n=>this.onMouseEnter(n,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Bc(e);const i=this,s=this.wot.rootDocument.body,n=r.getBoundingClientRect();r.style.display="none";function o(h){if(h.clientY<Math.floor(n.top)||h.clientY>Math.ceil(n.top+n.height)||h.clientX<Math.floor(n.left)||h.clientX>Math.ceil(n.left+n.width))return!0}function l(h){o(h)&&(i.eventManager.removeEventListener(s,"mousemove",l),r.style.display="block")}this.eventManager.addEventListener(s,"mousemove",l)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const i=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let l=0;l<5;l++){const h=i[l],d=r.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(d.className+=" hidden"),s=d.style,s.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,s.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,s.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),sd()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:n}=this.wot;let o=n.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};Zr(s,(o,l)=>{this.selectionHandles.styles.bottomHitArea[l]=o,this.selectionHandles.styles.topHitArea[l]=o});const n={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Zr(n,(o,l)=>{this.selectionHandles.styles.bottom[l]=o,this.selectionHandles.styles.top[l]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||r!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,i,s,n,o){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:g,bottom:y,bottomHitArea:C}=this.selectionHandles.styles,x=parseInt(d.borderWidth,10),_=parseInt(d.width,10),E=parseInt(g.width,10),R=this.wot.wtTable.getWidth(),I=this.wot.wtTable.getHeight();d.top=`${parseInt(i-_-1,10)}px`,d[h]=`${parseInt(s-_-1,10)}px`,g.top=`${parseInt(i-E/4*3,10)}px`,g[h]=`${parseInt(s-E/4*3,10)}px`;const F=Math.min(parseInt(s+n,10),R-_-x*2),D=Math.min(parseInt(s+n-E/4,10),R-E-x*2);y[h]=`${F}px`,C[h]=`${D}px`;const U=Math.min(parseInt(i+o,10),I-_-x*2),X=Math.min(parseInt(i+o-E/4,10),I-E-x*2);y.top=`${U}px`,C.top=`${X}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",g.display="block",this.isPartRange(e,r)?(y.display="none",C.display="none"):(y.display="block",C.display="block")):(d.display="none",y.display="none",g.display="none",C.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",g.zIndex="9999"):(d.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let[r,i,s,n]=e;if(r<0&&s<0||i<0&&n<0){this.disappear();return}const{wtTable:o,rootDocument:l,rootWindow:h}=this.wot,d=r!==s||i!==n,g=o.getFirstRenderedRow(),y=o.getLastRenderedRow(),C=o.getFirstRenderedColumn(),x=o.getLastRenderedColumn();let _;if(d){if(i=Math.max(i,C),n=Math.min(n,x),r=Math.max(r,g),s=Math.min(s,y),n<i||s<r){this.disappear();return}_=o.getCell(this.wot.createCellCoords(r,i))}else if(_=o.getCell(this.wot.createCellCoords(r,i)),!(_ instanceof HTMLElement)){this.disappear();return}const E=d?o.getCell(this.wot.createCellCoords(s,n)):_,R=Ws(_),I=d?Ws(E):R,F=Ws(o.TABLE),D=R.top,U=R.left,X=this.wot.wtSettings.getSetting("rtlMode");let te=0,Y=0;if(X){const Xe=ns(o.TABLE),Pe=ns(_),Be=h.innerWidth-F.left-Xe;Y=U+Pe-I.left,te=h.innerWidth-U-Pe-Be-1}else Y=I.left+ns(E)-U,te=U-F.left-1;if(this.isEntireColumnSelected(r,s)){const Xe=r,Pe=this.getDimensionsFromHeader("columns",i,n,Xe,F);let Be=null;Pe&&([Be,te,Y]=Pe),Be&&(_=Be)}let oe=D-F.top-1,me=I.top+Ji(E)-D;if(this.isEntireRowSelected(i,n)){const Xe=i,Pe=this.getDimensionsFromHeader("rows",r,s,Xe,F);let Be=null;Pe&&([Be,oe,me]=Pe),Be&&(_=Be)}const de=h.getComputedStyle(_);parseInt(de.borderTopWidth,10)>0&&(oe+=1,me=me>0?me-1:0),parseInt(de[X?"borderRightWidth":"borderLeftWidth"],10)>0&&(te+=1,Y=Y>0?Y-1:0);const ye=X?"right":"left";this.topStyle.top=`${oe}px`,this.topStyle[ye]=`${te}px`,this.topStyle.width=`${Y}px`,this.topStyle.display="block",this.startStyle.top=`${oe}px`,this.startStyle[ye]=`${te}px`,this.startStyle.height=`${me}px`,this.startStyle.display="block";const Ee=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${oe+me-Ee}px`,this.bottomStyle[ye]=`${te}px`,this.bottomStyle.width=`${Y}px`,this.bottomStyle.display="block",this.endStyle.top=`${oe}px`,this.endStyle[ye]=`${te+Y-Ee}px`,this.endStyle.height=`${me+1}px`,this.endStyle.display="block";let ke=this.settings.border.cornerVisible;ke=typeof ke=="function"?ke(this.settings.layerLevel):ke;const nt=this.wot.getSetting("onModifyGetCellCoords",s,n,!1,"render");let[at,Ze]=[s,n];if(nt&&Array.isArray(nt)&&([,,at,Ze]=nt),sd()||!ke||this.isPartRange(at,Ze))this.cornerStyle.display="none";else{this.cornerStyle.top=`${oe+me+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[ye]=`${te+Y+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Xe=c1(o.TABLE);const Pe=Xe===h;Pe&&(Xe=l.documentElement);const Be=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Me=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),A=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(n===this.wot.getSetting("totalColumns")-1){const O=Pe?E.getBoundingClientRect().left:E.offsetLeft;let N=!1,H=0;X?(H=O-parseInt(this.cornerDefaultStyle.width,10)/2,N=H<0):(H=O+ns(E)+parseInt(this.cornerDefaultStyle.width,10)/2,N=H>=UX(Xe)),N&&(this.cornerStyle[ye]=`${Math.floor(te+Y+this.cornerCenterPointOffset-Me-Be)}px`,this.cornerStyle[X?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(Pe?E.getBoundingClientRect().top:E.offsetTop)+Ji(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=oy(Xe)&&(this.cornerStyle.top=`${Math.floor(oe+me+this.cornerCenterPointOffset-A-Be)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}sd()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,n,oe,te,Y,me)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,i,s,n){const{wtTable:o}=this.wot,l=o.wtRootElement.parentNode;let h=null,d=null,g=null,y=null,C=null,x=null,_=null,E=null;switch(e){case"rows":h=function(){return o.getRowHeader(...arguments)},d=function(){return Ji(...arguments)},g="ht__selection--rows",x="top";break;case"columns":h=function(){return o.getColumnHeader(...arguments)},d=function(){return ns(...arguments)},g="ht__selection--columns",x="left";break}if(l.classList.contains(g)){const R=this.wot.getSetting("columnHeaders").length;if(_=h(r,R-s),E=h(i,R-s),!_||!E)return!1;const I=Ws(_),F=Ws(E);return _&&E&&(y=I[x]-n[x]-1,C=F[x]+d(E)-I[x]),[_,y,C]}return!1}changeBorderStyle(e,r){const i=this[e].style,s=r[e];!s||s.hide?ht(this[e],"hidden"):(Ir(this[e],"hidden")&&Ar(this[e],"hidden"),i.backgroundColor=s.color,(e==="top"||e==="bottom")&&(i.height=`${s.width}px`),(e==="start"||e==="end")&&(i.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},i=this[e].style;i.backgroundColor=r.color,i.width=`${r.width}px`,i.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?ht(this[e],"hidden"):Ar(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",sd()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _Te(t,e){Fq(t,e),e.add(t)}function Tm(t,e,r){Fq(t,e),e.set(t,r)}function Fq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(t,e){return t.get(uN(t,e))}function BB(t,e,r){return t.set(uN(t,e),r),r}function uN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ao=new WeakMap,Ca=new WeakMap,SO=new WeakMap,Bw=new WeakMap,bO=new WeakMap,u0=new WeakMap,VB=new WeakSet;class RTe{constructor(e){_Te(this,VB),Tm(this,Ao,void 0),Tm(this,Ca,void 0),Tm(this,SO,new ETe),Tm(this,Bw,new WeakMap),Tm(this,bO,new WeakSet),Tm(this,u0,new Map),BB(Ca,this,e)}setActiveOverlay(e){return BB(Ao,this,e),qr(SO,this).setActiveOverlay(qr(Ao,this)),qr(Bw,this).has(qr(Ao,this))||qr(Bw,this).set(qr(Ao,this),new Set),this}getFocusSelection(){return qr(Ca,this)!==null?qr(Ca,this).getFocus():null}getAreaSelection(){return qr(Ca,this)!==null?qr(Ca,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(qr(u0,this).has(e)){const i=qr(u0,this).get(e);if(i.has(qr(Ao,this)))return i.get(qr(Ao,this));const s=new $B(qr(Ao,this),e.settings);return i.set(qr(Ao,this),s),s}const r=new $B(qr(Ao,this),e.settings);return qr(u0,this).set(e,new Map([[qr(Ao,this),r]])),r}getBorderInstances(e){var r,i;return Array.from((r=(i=qr(u0,this).get(e))===null||i===void 0?void 0:i.values())!==null&&r!==void 0?r:[])}destroyBorders(e){qr(u0,this).get(e).forEach(r=>r.destroy()),qr(u0,this).delete(e)}render(e){if(qr(Ca,this)===null)return;e&&uN(VB,this,ATe).call(this);const r=Array.from(qr(Ca,this)),i=new Map,s=new Map;for(let n=0;n<r.length;n++){const o=r[n],{className:l,headerAttributes:h,createLayers:d,selectionType:g}=o.settings;qr(bO,this).has(o)||(qr(bO,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const y=this.getBorderInstance(o);if(o.isEmpty()){y==null||y.disappear();continue}l&&qr(SO,this).setActiveSelection(o).scan().forEach(_=>{if(i.has(_)){const E=i.get(_);E.has(l)&&d===!0?E.set(l,E.get(l)+1):E.set(l,1)}else i.set(_,new Map([[l,1]]));h&&(s.has(_)||s.set(_,[]),_.nodeName==="TH"&&s.get(_).push(...h))});const C=o.getCorners();qr(Ao,this).getSetting("onBeforeDrawBorders",C,g),y==null||y.appear(C)}i.forEach((n,o)=>{var l;const h=Array.from(n).map(d=>{let[g,y]=d;return y===1?g:[g,...Array.from({length:y-1},(C,x)=>`${g}-${x+1}`)]}).flat();h.forEach(d=>qr(Bw,this).get(qr(Ao,this)).add(d)),ht(o,h),o.nodeName==="TD"&&Array.isArray((l=qr(Ca,this).options)===null||l===void 0?void 0:l.cellAttributes)&&Fr(o,qr(Ca,this).options.cellAttributes)}),Array.from(s.keys()).forEach(n=>{Fr(n,[...s.get(n)])})}}function ATe(){const t=qr(Bw,this).get(qr(Ao,this)),e=qr(Ao,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var i,s;const n=qr(Ao,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((i=qr(Ca,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=qr(Ca,this).options.cellAttributes.map(l=>l[0])),Array.isArray((s=qr(Ca,this).options)===null||s===void 0?void 0:s.headerAttributes)&&(o=[...o,...qr(Ca,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,h=n.length;l<h;l++)Ar(n[l],r),F1(n[l],o)}),t.clear()}class OTe extends ZC{constructor(e,r,i,s){super(e,r,Pg,i,s)}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new oN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let n=0;this.trimmingContainer===r&&(!s||s!=="horizontal")?(n=this.getOverlayOffset()*(this.isRtl()?-1:1),Uk(i,`${n}px`,"0px")):(n=this.getScrollPosition(),L_(i));const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,WX(r)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const i=this.wtSettings.getSetting("defaultColumnWidth");let s=e,n=0;for(;s<r;)n+=this.wot.wtTable.getColumnWidth(s)||i,s+=1;return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="vertical"){let d=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(d-=so(i)),d=Math.min(d,e.wtRootElement.scrollHeight),o.height=`${d}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const h=ns(this.clone.wtTable.TABLE);o.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=cN(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:i}=this,s=i.getSetting("rowHeaders"),n=i.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=n===0&&s.length>0&&!Ir(l.parentNode,"innerBorderInlineStart")?1:0;let d=this.getTableParentOffset(),g=0;if(r){const y=this.wot.wtTable.getColumnWidth(e),C=this.wot.wtViewport.getViewportWidth();y>C&&(r=!1)}return r&&l.offsetWidth!==l.clientWidth&&(g=so(this.domBindings.rootDocument)),r?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=h):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=g,ASe(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(jX(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),n=this.clone.wtTable.getTotalWidth(),o=s-n;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("rowHeaders"),n=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),l=r.getSetting("preventOverflow")==="vertical";o?Ar(i,"emptyRows"):ht(i,"emptyRows");let h=!1;if(!l){if(n&&!s.length)ht(i,"innerBorderLeft innerBorderInlineStart");else if(!n&&s.length){const d=Ir(i,"innerBorderInlineStart");e?(ht(i,"innerBorderLeft innerBorderInlineStart"),h=!d):(Ar(i,"innerBorderLeft innerBorderInlineStart"),h=d)}}return h}}const ITe="stickyRowsTop",hN={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};uf(hN,"MIXIN_NAME",ITe,{writable:!1,enumerable:!1});class fN extends k1{constructor(e,r,i,s){super(e,r,i,s,Fg)}}Xn(fN,hN);Xn(fN,V_);function WB(t,e,r){return(e=PTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PTe(t){var e=FTe(t,"string");return typeof e=="symbol"?e:e+""}function FTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MTe extends ZC{constructor(e,r,i,s,n,o){super(e,r,Fg,i,s),WB(this,"topOverlay",void 0),WB(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new fN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();Uk(e,`${s}px`,`${n}px`)}else L_(e);let r=Ji(this.clone.wtTable.TABLE);const i=ns(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${i}px`,!1}}class dN extends k1{constructor(e,r,i,s){super(e,r,i,s,Ig)}}Xn(dN,hN);Xn(dN,W_);function kTe(t,e,r){return(e=NTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NTe(t){var e=DTe(t,"string");return typeof e=="symbol"?e:e+""}function DTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LTe extends ZC{constructor(e,r,i,s){super(e,r,Ig,i,s),kTe(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new dN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let s=0,n=!1;if(this.trimmingContainer===r&&(!i||i!=="vertical")){const{wtTable:l}=this.wot,h=l.hider.getBoundingClientRect(),d=Math.ceil(h.bottom),g=e.offsetHeight;n=d===g,s=this.getOverlayOffset(),Uk(e,"0px",`${s}px`)}else s=this.getScrollPosition(),L_(e);const o=this.adjustHeaderBordersPosition(s,n);return this.adjustElementsSize(),o}setScrollPosition(e){const r=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(Wk(r),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const i=this.wot.stylesHandler.getDefaultRowHeight();let s=e,n=0;for(;s<r;){const o=this.wot.wtTable.getRowHeight(s);n+=o===void 0?i:o,s+=1}return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let d=r.getWorkspaceWidth();r.hasVerticalScroll()&&(d-=so(i)),d=Math.min(d,e.wtRootElement.scrollWidth),o.width=`${d}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let h=Ji(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),o.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=cN(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:i,wtSettings:s}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,l=s.getSetting("columnHeaders"),d=s.getSetting("fixedRowsTop")===0&&l.length>0&&!Ir(o.parentNode,"innerBorderTop")?1:0;let g=this.getTableParentOffset(),y=0;if(r){const C=this.wot.wtTable.getRowHeight(e),x=this.wot.wtViewport.getViewportHeight();C>x&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(y=so(this.domBindings.rootDocument)),r){const C=s.getSetting("fixedRowsBottom"),x=s.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=i.wtViewport.getViewportHeight()-this.sumCellSizes(x-C,x),g+=1,g+=d}else g+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return g+=y,RSe(this.mainTableScrollableElement)===g-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return jk(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight(),o=s-n;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,s=this.wot.wtTable.holder.parentNode,n=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";n?Ar(s,"emptyColumns"):ht(s,"emptyColumns");let l=!1;if(!r&&!o){const h=i.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==h,g=i.getSetting("columnHeaders");if((d||h===0)&&g.length>0){const y=Ir(s,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(ht(s,"innerBorderTop"),l=!y):(Ar(s,"innerBorderTop"),l=y)}}return l}}function Vb(t,e,r){HTe(t,e),e.set(t,r)}function HTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lh(t,e,r){return(e=$Te(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Te(t){var e=BTe(t,"string");return typeof e=="symbol"?e:e+""}function BTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h0(t,e,r){return t.set(Mq(t,e),r),r}function ch(t,e){return t.get(Mq(t,e))}function Mq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _m=new WeakMap,Wb=new WeakMap,Rm=new WeakMap,jb=new WeakMap;class VTe{constructor(e,r,i,s,n,o){lh(this,"wot",null),Vb(this,_m,[]),lh(this,"topOverlay",null),lh(this,"bottomOverlay",null),lh(this,"inlineStartOverlay",null),lh(this,"topInlineStartCornerOverlay",null),lh(this,"bottomInlineStartCornerOverlay",null),lh(this,"browserLineHeight",void 0),lh(this,"wtSettings",null),Vb(this,Wb,!1),Vb(this,Rm,0),Vb(this,jb,null),lh(this,"resizeObserver",new ResizeObserver(g=>{zE(()=>{!Array.isArray(g)||!g.length||(h0(Rm,this,ch(Rm,this)+1),ch(Rm,this)===100&&(Nn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),ch(jb,this)!==null&&clearTimeout(ch(jb,this)),h0(jb,this,setTimeout(()=>{h0(Rm,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=s,this.domBindings=i,this.facadeGetter=r,this.wtTable=o;const{rootDocument:l,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=n,this.scrollbarSize=so(l);const d=h.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?o.holder:jE(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...ch(_m,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,i=e.getComputedStyle(r.body),s=parseInt(i.lineHeight,10),n=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=s||n}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new LTe(...e),this.bottomOverlay=new mTe(...e),this.inlineStartOverlay=new OTe(...e),this.topInlineStartCornerOverlay=new MTe(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new uTe(...e,this.bottomOverlay,this.inlineStartOverlay),h0(_m,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){h0(Wb,this,ch(_m,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),ch(_m,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),ch(_m,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",y=>this.onKeyDown(y)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",y=>this.onTableScroll(y),{passive:!0}),i!==s&&this.eventManager.addEventListener(s,"scroll",y=>this.onTableScroll(y),{passive:!0});const n=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,l=this.wtSettings.getSetting("preventWheel"),h={passive:o};(l||n||!rq())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",y=>this.onCloneWheel(y,l),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(y=>{if(y&&y.needFullRender){const{holder:C}=y.clone.wtTable;this.eventManager.addEventListener(C,"wheel",x=>this.onCloneWheel(x,l),h)}});let g;this.eventManager.addEventListener(r,"resize",()=>{zE(()=>{clearTimeout(g),this.wtSettings.getSetting("onWindowResize"),g=setTimeout(()=>{h0(Rm,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,n=e.target;this.keyPressed&&(s!==r&&n!==r&&!e.target.contains(s)||i!==r&&n!==r&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:i}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target,l=n!==i&&o!==i&&!o.contains(n),h=s!==i&&o!==i&&!o.contains(s);if(this.keyPressed&&(l||h)||this.scrollableElement===i)return;const d=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==i&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=qC(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,r+=r*this.browserLineHeight);const s=this.scrollVertically(r),n=this.scrollHorizontally(i);return s||n}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[s,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==n||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=s;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=s)}this.verticalScrolling&&(i.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){if(!ch(Wb,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),h0(Wb,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=jE(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,i=e.clientHeight,s=r!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=i),s}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:i}=this.domBindings,s=this.scrollableElement===i,n=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),d=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,g=l+this.inlineStartOverlay.sumCellSizes(0,n),C=r.hider.style,x=()=>s?!1:this.scrollableElement.scrollTop>Math.max(0,d-r.holder.clientHeight),_=()=>s?!1:this.scrollableElement.scrollLeft>Math.max(0,g-r.holder.clientWidth),E=x()?1:0,R=_()?1:0;C.width=`${g+R}px`,C.height=`${d+E}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return Te(r,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(i=s.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Te(r,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function jB(t,e,r){return(e=WTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WTe(t){var e=jTe(t,"string");return typeof e=="symbol"?e:e+""}function jTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let UTe=class{constructor(e){jB(this,"settings",{}),jB(this,"defaults",Object.freeze(this.getDefaults())),Zr(this.defaults,(r,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(r===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,i)=>{const s=this.getSetting("data",e,r);Rg(i,s??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Zr(e,(i,s)=>{this.settings[s]=i}):this.settings[e]=r,this}getSetting(e,r,i,s,n){return typeof this.settings[e]=="function"?this.settings[e](r,i,s,n):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};class gN extends k1{constructor(e,r,i,s){super(e,r,i,s,"master")}alignOverlaysWithTrimmingContainer(){const e=c1(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,s=UE(e,"height",r),n=UE(e,"overflow",r),o=this.holder.style,{scrollWidth:l,scrollHeight:h}=e;let d=e.offsetWidth,g=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(n)){const C=e.cloneNode(!1);C.style.overflow="auto",C.style.position="absolute",e.nextElementSibling?i.insertBefore(C,e.nextElementSibling):i.appendChild(C);const x=parseInt(r.getComputedStyle(C).height,10);i.removeChild(C),x===0&&(g=0)}g=Math.min(g,h),o.height=s==="auto"?"auto":`${g}px`,d=Math.min(d,l),o.width=`${d}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:g>0,this.hasTableWidth=d>0}this.isTableVisible=l1(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,i="master",n=e.getSetting("columnHeaders").length;if(n&&!r.hasOversizedColumnHeadersMarked[i]){const l=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let d=0;d<n;d++)for(let g=-1*l;g<h;g++)this.markIfOversizedColumnHeader(g);r.hasOversizedColumnHeadersMarked[i]=!0}}}Xn(gN,sN);Xn(gN,W_);class zTe{constructor(e,r,i,s,n){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new F2e:new H2e],["fullyVisible",()=>new b2e],["partiallyVisible",()=>new Cq]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new O2e:new N2e],["fullyVisible",()=>new y2e],["partiallyVisible",()=>new yq]]),this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return r===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=Ji(r)>0&&r.clientHeight>0?r.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let s;if(i===r){const n=this.wtSettings.getSetting("totalColumns");s=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,n)>s&&(s=e.documentElement.clientWidth)}else s=i.clientWidth;return s}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let i=0,s=e;for(;s<r;)i+=this.wtTable.getColumnWidth(s),s+=1;return i}getWorkspaceOffset(){return Ws(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ji(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,n=r.length;s<n;s++)i?(this.rowHeaderWidth+=ns(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let s=this.getViewportHeight(),n,o;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=r.getSetting("fixedRowsTop"),d=r.getSetting("fixedRowsBottom"),g=r.getSetting("totalRows");return h&&l>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,h),l+=o,s-=o),d&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(g-d,g),s-=o),i.holder.clientHeight===i.holder.offsetHeight?n=0:n=so(this.domBindings.rootDocument),new G2e({calculationTypes:e.map(y=>[y,this.rowsCalculatorTypes.get(y)()]),viewportHeight:s,scrollOffset:l,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:y=>i.getRowHeight(y),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:n})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let s=this.getViewportWidth(),n=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&n>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);n+=l,s-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(s-=so(this.domBindings.rootDocument)),new j2e({calculationTypes:e.map(l=>[l,this.columnsCalculatorTypes.get(l)()]),viewportWidth:s,scrollOffset:n,totalColumns:r.getSetting("totalColumns"),columnWidthFn:l=>i.getColumnWidth(l),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,i=this.createRowsCalculator(),s=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const n=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(n)}if(e&&!r.getSetting("renderAllColumns")){const n=s.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(n)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=s.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=s.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:s,endRow:n,rowStartOffset:o,rowEndOffset:l}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(o,d)),i=Math.min(h,i+Math.min(l,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(h,i+Math.ceil(l/2))),r<s||r===s&&r>0?!1:!(i>n||i===n&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:s,endColumn:n,columnStartOffset:o,columnEndOffset:l}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(o,d)),i=Math.min(h,i+Math.min(l,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(h,i+Math.ceil(l/2))),r<s||r===s&&r>0?!1:!(i>n||i===n&&i<h)}resetHasOversizedColumnHeadersMarked(){Zr(this.hasOversizedColumnHeadersMarked,(e,r,i)=>{i[r]=void 0})}}function GTe(t,e){kq(t,e),e.add(t)}function f0(t,e,r){kq(t,e),e.set(t,r)}function kq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pi(t,e){return t.get(Cc(t,e))}function yc(t,e,r){return t.set(Cc(t,e),r),r}function Cc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const UB=23;var vu=new WeakMap,Mh=new WeakMap,mN=new WeakMap,rF=new WeakMap,Bf=new WeakMap,Vw=new WeakMap,nC=new WeakMap,xu=new WeakSet;class YTe{constructor(e){GTe(this,xu),f0(this,vu,void 0),f0(this,Mh,void 0),f0(this,mN,void 0),f0(this,rF,void 0),f0(this,Bf,!0),f0(this,Vw,{}),f0(this,nC,{}),yc(Mh,this,e.rootTable.parentElement.parentElement),yc(rF,this,e.rootDocument)}isClassicTheme(){return pi(Bf,this)}getCSSVariableValue(e){var r;if(pi(Bf,this))return null;if(pi(Vw,this)[`--ht-${e}`])return pi(Vw,this)[`--ht-${e}`];const i=(r=Cc(xu,this,JTe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:Cc(xu,this,Nq).call(this,`--ht-${e}`);if(i!==null)return pi(Vw,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var r;return(r=pi(nC,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(pi(Bf,this))return UB;const e=Cc(xu,this,KTe).call(this);return!e&&Ir(pi(Mh,this),"ht-wrapper")?(Nn(`The "${pi(vu,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),yc(Bf,this,!0),this.useTheme(),UB):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Cc(xu,this,zB).call(this),yc(Bf,this,!0),yc(vu,this,e||void 0);return}e&&e!==pi(vu,this)&&(pi(vu,this)&&Cc(xu,this,QTe).call(this),yc(vu,this,e),yc(Bf,this,!1),Cc(xu,this,XTe).call(this),Cc(xu,this,zB).call(this))}getThemeName(){return pi(vu,this)}removeClassNames(){Ir(pi(Mh,this),pi(vu,this))&&Ar(pi(Mh,this),pi(vu,this))}}function KTe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function XTe(){Ar(pi(Mh,this),/ht-theme-.*/g),ht(pi(Mh,this),pi(vu,this))}function zB(){this.isClassicTheme()||yc(mN,this,getComputedStyle(pi(Mh,this)));const t=Cc(xu,this,qTe).call(this,["box-sizing","border-bottom-width"]);pi(nC,this).td={...pi(nC,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function qTe(t){const e=pi(rF,this),r=pi(Mh,this),i=e.createElement("table"),s=e.createElement("tbody"),n=e.createElement("tr"),o=e.createElement("tr"),l=e.createElement("td");o.appendChild(l),s.appendChild(n),s.appendChild(o),i.appendChild(s),r.appendChild(i);const h=getComputedStyle(l),d={};return t.forEach(g=>{d[g]=h.getPropertyValue(g)}),r.removeChild(i),d}function JTe(t){const e=Math.ceil(parseFloat(Cc(xu,this,Nq).call(this,t)));return Number.isNaN(e)?null:e}function Nq(t){const e=pi(mN,this).getPropertyValue(t);return e===""?null:e}function QTe(){yc(nC,this,{}),yc(Vw,this,{}),yc(Bf,this,!0)}class ZTe extends nN{constructor(e,r){super(e,new UTe(r)),this.stylesHandler=new YTe(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new gN(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new zTe(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new RTe(this.wtSettings.getSetting("selections")),this.wtEvent=new Tq(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new VTe(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],i=[];Zr(e,(s,n)=>{this.wtSettings.getSetting(n).length&&i.push(s),r.push(s)}),Ar(this.wtTable.wtRootElement.parentNode,r),ht(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var r;if(!Aq.includes(e))return null;const i=e.replace(/_([a-z])/g,s=>s[1].toUpperCase());return(r=this.wtOverlays[`${i}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class pN{constructor(e){e instanceof nN?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const i=new pN(r);return()=>i},this._wot=new ZTe(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,i){return this._wot.createCellRange(e,r,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,i){return this._wot.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,i,s,n){return this._wot.wtSettings.getSetting(e,r,i,s,n)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function GB(t){let{isShiftKey:e,isLeftClick:r,isRightClick:i,coords:s,selection:n,controller:o,cellCoordsFactory:l}=t;const h=n.isSelected()?n.getSelectedRange().current():null,d=n.isSelectedByCorner(),g=n.isSelectedByRowHeader();if(n.markSource("mouse"),e&&h)s.row>=0&&s.col>=0&&!o.cell?n.setRangeEnd(s):(d||g)&&s.row>=0&&s.col>=0&&!o.cell?n.setRangeEnd(l(s.row,s.col)):d&&s.row<0&&!o.column?n.setRangeEnd(l(h.to.row,s.col)):g&&s.col<0&&!o.row?n.setRangeEnd(l(s.row,h.to.col)):(!d&&!g&&s.col<0||d&&s.col<0)&&!o.row?n.selectRows(Math.max(h.from.row,0),s.row,s.col):(!d&&!g&&s.row<0||g&&s.row<0)&&!o.column&&n.selectColumns(Math.max(h.from.col,0),s.col,s.row);else{const y=!n.inInSelection(s),C=r||i&&y;s.row<0&&s.col>=0&&!o.column?C&&n.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!o.row?C&&n.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!o.cell?C&&n.setRangeStart(s):s.col<0&&s.row<0&&n.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}n.markEndSource()}function e_e(t){let{isLeftClick:e,coords:r,selection:i,controller:s,cellCoordsFactory:n}=t;if(!e)return;const o=i.isSelectedByRowHeader(),l=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),l&&!s.column?i.setRangeEnd(n(d-1,r.col)):o&&!s.row?i.setRangeEnd(n(r.row,h-1)):s.cell||i.setRangeEnd(r),i.markEndSource()}const t_e=new Map([["mousedown",GB],["mouseover",e_e],["touchstart",GB]]);function YB(t,e){let{coords:r,selection:i,controller:s,cellCoordsFactory:n}=e;t_e.get(t.type)({coords:r,selection:i,controller:s,cellCoordsFactory:n,isShiftKey:t.shiftKey,isLeftClick:Kk(t)||t.type==="touchstart",isRightClick:Ag(t)})}const Dq=new WeakMap,vN=Symbol("rootInstance");function r_e(t){Dq.set(t,!0)}function n_e(t){return t===vN}function B2(t){return Dq.has(t)}function i_e(t,e){Lq(t,e),e.add(t)}function d0(t,e,r){Lq(t,e),e.set(t,r)}function Lq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _f(t,e,r){return(e=s_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s_e(t){var e=o_e(t,"string");return typeof e=="symbol"?e:e+""}function o_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ls(t,e){return t.get(zp(t,e))}function bl(t,e,r){return t.set(zp(t,e),r),r}function zp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xO=new WeakMap,Ub=new WeakMap,zb=new WeakMap,uh=new WeakMap,tc=new WeakMap,EO=new WeakMap,TO=new WeakMap,Ww=new WeakSet;class a_e{constructor(e){i_e(this,Ww),_f(this,"hot",void 0),_f(this,"eventManager",void 0),_f(this,"settings",void 0),_f(this,"THEAD",void 0),_f(this,"TBODY",void 0),_f(this,"_wt",void 0),_f(this,"activeWt",void 0),d0(this,xO,0),d0(this,Ub,0),_f(this,"postponedAdjustElementsSize",!1),d0(this,zb,!1),d0(this,uh,void 0),d0(this,tc,void 0),d0(this,EO,0),d0(this,TO,0),this.hot=e,this.eventManager=new Dc(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),zp(Ww,this,c_e).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const i=this._wt.getCell(e,r);return i<0?null:i}scrollViewport(e,r,i){return this._wt.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),ht(e,"handsontable"),bl(tc,this,r.createElement("TABLE")),ht(Ls(tc,this),"htCore"),this.hot.getSettings().tableClassName&&ht(Ls(tc,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Fr(Ls(tc,this),[Nu()]),Fr(e,[QCe(),DX(-1),N_(this.hot.countCols()),fSe()])),this.THEAD=r.createElement("THEAD"),Ls(tc,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Ls(tc,this).appendChild(this.TBODY),this.hot.table=Ls(tc,this),this.hot.container.insertBefore(Ls(tc,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:i,rootWindow:s}=this.hot,n=r.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{bl(zb,this,!0),this.isTextSelectionAllowed(l.target)||(q9(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{bl(zb,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{Ls(zb,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&q9(s),l.preventDefault())}),this.eventManager.addEventListener(n,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(n,"mouseup",l=>{i.isInProgress()&&Kk(l)&&i.finish(),bl(uh,this,!1);const h=GX(r.activeElement);$2(r.activeElement)&&!h||(h||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(l.target)&&!Ag(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(n,"contextmenu",l=>{i.isInProgress()&&Ag(l)&&(i.finish(),bl(uh,this,!1))}),this.eventManager.addEventListener(n,"touchend",()=>{i.isInProgress()&&i.finish(),bl(uh,this,!1)}),this.eventManager.addEventListener(n,"mousedown",l=>{const h=l.target,d=l.x||l.clientX,g=l.y||l.clientY;let y=l.target;if(Ls(uh,this)||!e||!this.hot.view)return;const{holder:C}=this._wt.wtTable;if(y===C){const _=so(r);if(r.elementFromPoint(d+_,g)!==C||r.elementFromPoint(d,g+_)!==C)return}else for(;y!==n;){if(y===null){if(l.isTargetWebComponent)break;return}if(y===e)return;y=y.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=a1(s);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=a1(o);this.eventManager.addEventListener(Ls(tc,this),"selectstart",l=>{this.settings.fragmentSelection||$2(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,i))}translateFromRenderableToVisualIndex(e,r){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return i===null&&(i=e),s===null&&(s=r),[i,s]}countRenderableIndexes(e,r){const i=Math.min(e.getNotTrimmedIndexesLength(),r),s=e.getNearestNotHiddenIndex(i-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,i,s){if(isNaN(e)||e<0)return 0;const n=i.getNearestNotHiddenIndex(e,r),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let l=0;return r<0?l=o+1:r>0&&(l=s-o),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let i=0;for(let s=e;s<=r;s++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(s)!==null&&(i+=1);return i}countRenderableRowsInRange(e,r){let i=0;for(let s=e;s<=r;s++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(s)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&ht(i,e)}removeClassNameFromLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&Ar(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Ls(tc,this),isDataViewInstance:()=>B2(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(n,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(n,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const n=[];return this.hot.hasRowHeaders()&&n.push((o,l)=>{const h=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(h,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",n),bl(Ub,this,n.length),this.hot.getSettings().ariaTags&&zp(Ww,this,Hq).call(this)===this.hot.countCols()&&zp(Ww,this,l_e).call(this,Ls(Ub,this)),n},columnHeaders:()=>{const n=[];return this.hot.hasColHeaders()&&n.push((o,l)=>{const h=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(h,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",n),bl(xO,this,n.length),n},columnWidth:n=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n);return this.hot.getColWidth(o===null?n:o)},rowHeight:n=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(n);return this.hot.getRowHeight(o===null?n:o)},rowHeightByOverlayName:(n,o)=>{const l=this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),h=l===null?n:l;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,o)},cellRenderer:(n,o,l)=>{const[h,d]=this.translateFromRenderableToVisualIndex(n,o),g=this.hot.runHooks("modifyGetCellCoords",h,d,!1,"meta");let y=h,C=d;Array.isArray(g)&&([y,C]=g);const x=this.hot.getCellMeta(y,C),_=this.hot.colToProp(C);let E=this.hot.getDataAtRowProp(y,_);this.hot.hasHook("beforeValueRender")&&(E=this.hot.runHooks("beforeValueRender",E,x)),this.hot.runHooks("beforeRenderer",l,h,d,_,E,x),this.hot.getCellRenderer(x)(this.hot,l,h,d,_,E,x),this.hot.runHooks("afterRenderer",l,h,d,_,E,x)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&l1(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,bl(uh,this,!0),this.hot.runHooks("beforeOnCellMouseDown",n,d,l,g),!J0(n)&&(YB(n,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(y,C)=>this.hot._createCellCoords(y,C)}),this.hot.runHooks("afterOnCellMouseDown",n,d,l),this.activeWt=this._wt)},onCellContextMenu:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,bl(uh,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",n,d,l),!J0(n)&&(this.hot.runHooks("afterOnCellContextMenu",n,d,l),this.activeWt=this._wt)},onCellMouseOut:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",n,d,l),!J0(n)&&(this.hot.runHooks("afterOnCellMouseOut",n,d,l),this.activeWt=this._wt)},onCellMouseOver:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o),g={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",n,d,l,g),!J0(n)&&(Ls(uh,this)&&YB(n,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(y,C)=>this.hot._createCellCoords(y,C)}),this.hot.runHooks("afterOnCellMouseOver",n,d,l),this.activeWt=this._wt)},onCellMouseUp:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",n,d,l),!(J0(n)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",n,d,l),this.activeWt=this._wt)},onCellCornerMouseDown:n=>{n.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",n)},onCellCornerDblClick:n=>{n.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",n)},beforeDraw:(n,o)=>this.beforeRender(n,o),onDraw:n=>this.afterRender(n),onBeforeViewportScrollVertically:(n,o)=>{const l=this.hot.rowIndexMapper,h=n<0;let d=n;return!h&&(d=l.getVisualFromRenderableIndex(n),d===null)?n:(d=this.hot.runHooks("beforeViewportScrollVertically",d,o),this.hot.runHooks("beforeViewportScroll"),h?d:l.getRenderableFromVisualIndex(d))},onBeforeViewportScrollHorizontally:(n,o)=>{const l=this.hot.columnIndexMapper,h=n<0;let d=n;return!h&&(d=l.getVisualFromRenderableIndex(n),d===null)?n:(d=this.hot.runHooks("beforeViewportScrollHorizontally",d,o),this.hot.runHooks("beforeViewportScroll"),h?d:l.getRenderableFromVisualIndex(d))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(n,o,l)=>{const h=this.hot.rowIndexMapper,d=n<0;let g=n;d||(g=h.getVisualFromRenderableIndex(n));const y=this.hot.runHooks("beforeHighlightingRowHeader",g,o,l);return d?y:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:(n,o,l)=>{const h=this.hot.columnIndexMapper,d=n<0;let g=n;d||(g=h.getVisualFromRenderableIndex(n));const y=this.hot.runHooks("beforeHighlightingColumnHeader",g,o,l);return d?y:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:(n,o,l)=>{let h;const[d,g]=this.translateFromRenderableToVisualIndex(n,o),y=this.hot.selection.getSelectedRange();if(y.size()>0){const x=y.peekByIndex(l??0);h=[x.from.row,x.from.col,x.to.row,x.to.col]}return this.hot.runHooks("afterDrawSelection",d,g,h,l)},onBeforeDrawBorders:(n,o)=>{const[l,h,d,g]=n,y=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",y,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:n=>this.hot.runHooks("modifyRowHeaderWidth",n),onModifyGetCellCoords:(n,o,l,h)=>{const d=this.hot.rowIndexMapper,g=this.hot.columnIndexMapper,y=o>=0?g.getVisualFromRenderableIndex(o):o,C=n>=0?d.getVisualFromRenderableIndex(n):n,x=this.hot.runHooks("modifyGetCellCoords",C,y,l,h);if(Array.isArray(x)){const[_,E,R,I]=x;return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,E>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(E,1)):E,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,I>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(I,-1)):I]}},onModifyGetCoordsElement:(n,o)=>{const l=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=o>=0?h.getVisualFromRenderableIndex(o):o,g=n>=0?l.getVisualFromRenderableIndex(n):n,y=this.hot.runHooks("modifyGetCoordsElement",g,d);if(Array.isArray(y)){const[C,x]=y;return[C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,1)):C,x>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(x,1)):x]}},viewportRowCalculatorOverride:n=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const l=this.countRenderableRows(),h=n.startRow,d=n.endRow;if(typeof o=="number")n.startRow=Math.max(h-o,0),n.endRow=Math.min(d+o,l-1);else if(o==="auto"){const g=Math.max(1,Math.ceil(d/l*12));n.startRow=Math.max(h-g,0),n.endRow=Math.min(d+g,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",n)},viewportColumnCalculatorOverride:n=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const l=this.countRenderableColumns(),h=n.startColumn,d=n.endColumn;if(typeof o=="number"&&(n.startColumn=Math.max(h-o,0),n.endColumn=Math.min(d+o,l-1)),o==="auto"){const g=Math.max(1,Math.ceil(d/l*6));n.startColumn=Math.max(h-g,0),n.endColumn=Math.min(d+g,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",n)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const n=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||n}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new pN(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:i,height:s}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,s),this.eventManager.addEventListener(r,"mousedown",n=>{n.target===r&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",n=>{n.target===r&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if($2(e))return!0;const r=pg(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Ls(uh,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const i=r.firstChild;if(!Ir(i,"relative")){Vu(r),this.appendRowHeader(e,r);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:s}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,s),n.appendChild(o),r.appendChild(n)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const n=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Ir(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,s),o.className="",ht(o,["relative",...n()])):(Vu(r),this.appendColHeader(e,r,i,s))}else{const{rootDocument:o}=this.hot,l=o.createElement("div"),h=o.createElement("span"),d=n();l.classList.add("relative",...d),h.className="colHeader",this.settings.ariaTags&&(Fr(l,...Nu()),Fr(h,...Nu())),this.updateCellHeader(h,e,i,s),l.appendChild(h),r.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,r,s)}updateCellHeader(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ir(e,"colHeader")?n=o.wtTable.columnFilter.sourceToRendered(r):Ir(e,"rowHeader")&&(n=o.wtTable.rowFilter.sourceToRendered(r))),n>-1?M1(e,i(r,s)):(Rg(e,""),ht(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,r){bl(EO,this,e),bl(TO,this,r)}getLastSize(){return{width:Ls(EO,this),height:Ls(TO,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Ls(xO,this)}getRowHeadersCount(){return Ls(Ub,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function Hq(){return parseInt(this.hot.rootElement.getAttribute(N_()[0]),10)}function l_e(t){const e=zp(Ww,this,Hq).call(this)+t;Fr(this.hot.rootElement,...N_(e))}function c_e(){const t=this.hot.rootElement;this.hasVerticalScroll()?ht(t,"htHasScrollY"):Ar(t,"htHasScrollY"),this.hasHorizontalScroll()?ht(t,"htHasScrollX"):Ar(t,"htHasScrollX")}var u_e=ni,h_e=R1,f_e=ka,d_e=Cs,g_e=Gu;u_e({target:"Iterator",proto:!0,real:!0},{every:function(e){d_e(this),f_e(e);var r=g_e(this),i=0;return!h_e(r,function(s,n){if(!e(s,i++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const m_e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",KB=m_e.length;function p_e(t){let e=t+1,r="",i;for(;e>0;)i=(e-1)%KB,r=String.fromCharCode(65+i)+r,e=parseInt((e-i)/KB,10);return r}function $q(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((s,n)=>{Array.isArray(s)?s.forEach((o,l)=>{i.push([n+e,l,o])}):Object.keys(s).forEach(o=>{i.push([n+e,o,s[o]])})}),i}function Bq(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Qr(t[0])&&(e=Yk(t[0]))),e}function v_e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function w_e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Kv(t,e,r){return(e=y_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y_e(t){var e=C_e(t,"string");return typeof e=="symbol"?e:e+""}function C_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Kv(this,"hot",void 0),Kv(this,"data",void 0),Kv(this,"dataType","array"),Kv(this,"colToProp",()=>{}),Kv(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return Te(this.data,(i,s)=>{const n=this.getAtCell(s,e);r.push(n)}),r}getAtRow(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const n=r===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let l=null,h=null;if(l=this.modifyRowData(e),Array.isArray(l))h=[],n?l.forEach((d,g)=>{h[g]=this.getAtPhysicalCell(e,g,l)}):pr(r,i,d=>{h[d-r]=this.getAtPhysicalCell(e,d,l)});else if(Qr(l)||oi(l))if(s?h=[]:h={},!n||s){const g=this.countFirstRowKeys()-1;pr(0,g,y=>{const C=this.colToProp(y);if(y>=(r||0)&&y<=(i||g)&&!Number.isInteger(C)){const x=this.getAtPhysicalCell(e,C,l);s?h.push(x):o?rO(h,C,x):h[C]=x}})}else Zr(l,(d,g)=>{const y=this.getAtPhysicalCell(e,g,l);o?rO(h,g,y):h[g]=y});return h}setAtCell(e,r,i){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=tl(i);this.hot.runHooks("modifySourceData",e,r,s,"set"),s.isTouched()&&(i=s.value)}Number.isInteger(r)?this.data[e][r]=i:rO(this.data[e],r,i)}}getAtPhysicalCell(e,r,i){let s=null;if(i)if(typeof r=="string"){const{dataDotNotation:n}=this.hot.getSettings();s=n?JSe(i,r):i[r]}else typeof r=="function"?s=r(i):s=i[r];if(this.hot.hasHook("modifySourceData")){const n=tl(s);this.hot.runHooks("modifySourceData",e,r,n,"get"),n.isTouched()&&(s=n.value)}return s}getAtCell(e,r){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,n=null,o=null,l=null,h=null;e===null||r===null?(s=!0,n=0,l=this.countRows()-1):(n=Math.min(e.row,r.row),o=Math.min(e.col,r.col),l=Math.max(e.row,r.row),h=Math.max(e.col,r.col));const d=[];return pr(n,l,g=>{d.push(s?this.getAtRow(g,void 0,void 0,i):this.getAtRow(g,o,h,i))}),d}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Bq(this.data)}destroy(){this.data=null,this.hot=null}}var b_e=ni,x_e=R1,E_e=ka,T_e=Cs,__e=Gu;b_e({target:"Iterator",proto:!0,real:!0},{some:function(e){T_e(this),E_e(e);var r=__e(this),i=0;return x_e(r,function(s,n){if(e(s,i++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function XB(t,e,r){return(e=R_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R_e(t){var e=A_e(t,"string");return typeof e=="symbol"?e:e+""}function A_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Xg{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;XB(this,"indexedValues",[]),XB(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,oi(this.initValueOrFn)?pr(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):pr(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Xn(Xg,uo);function wN(t,e,r,i){const s=r.length?r[0]:void 0;return[...t.slice(0,s),...r.map((n,o)=>oi(i)?i(n,o):i),...s===void 0?[]:t.slice(s)]}function yN(t,e){return Rd(t,(r,i)=>e.includes(i)===!1)}class Hd extends Xg{insert(e,r){this.indexedValues=wN(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=yN(this.indexedValues,e),super.remove(e)}}class j_ extends Hd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return la(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}function CN(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function iC(t,e){return Rd(t,r=>e.includes(r)===!1)}function SN(t,e){return on(t,r=>r-e.filter(i=>i<r).length)}function bN(t,e){const r=e[0],i=e.length;return on(t,s=>s>=r?s+i:s)}function O_e(t,e,r){return(e=I_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I_e(t){var e=P_e(t,"string");return typeof e=="symbol"?e:e+""}function P_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends Xg{constructor(){super(...arguments),O_e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=iC(this.orderOfIndexes,[e]),oi(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=wN(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=bN(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=yN(this.indexedValues,e),this.orderOfIndexes=iC(this.orderOfIndexes,e),this.orderOfIndexes=SN(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class eS extends Hd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return la(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}const qB=new Map([["indexesSequence",{getListWithInsertedItems:CN,getListWithRemovedItems:iC}],["physicallyIndexed",{getListWithInsertedItems:wN,getListWithRemovedItems:yN}]]),Vq=t=>{if(qB.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return qB.get(t)};class Wq extends Xg{constructor(){super(e=>e)}insert(e,r){const i=bN(this.indexedValues,r);this.indexedValues=CN(i,e,r),super.insert(e,r)}remove(e){const r=iC(this.indexedValues,e);this.indexedValues=SN(r,e),super.remove(e)}}const JB=new Map([["hiding",j_],["index",Xg],["linkedPhysicalIndexToValue",U_],["physicalIndexToValue",Hd],["trimming",eS]]);function F_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!JB.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(JB.get(t))(e)}function M_e(t,e,r){return(e=k_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k_e(t){var e=N_e(t,"string");return typeof e=="symbol"?e:e+""}function N_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xN{constructor(){M_e(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);nr(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return _i(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(i=>{i.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Xn(xN,uo);function _O(t,e,r){return(e=D_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D_e(t){var e=L_e(t,"string");return typeof e=="symbol"?e:e+""}function L_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QB extends xN{constructor(e,r){super(),_O(this,"mergedValuesCache",[]),_O(this,"aggregationFunction",void 0),_O(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=on(this.get(),n=>n.getValues()),i=[],s=nr(r[0])&&r[0].length||0;for(let n=0;n<s;n+=1){const o=[];for(let l=0;l<this.getLength();l+=1)o.push(r[l][n]);i.push(o)}return on(i,this.aggregationFunction)}getMergedValueAtIndex(e,r){const i=this.getMergedValues(r)[e];return nr(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function H_e(t,e,r){$_e(t,e),e.set(t,r)}function $_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B_e(t,e,r){return t.set(jq(t,e),r),r}function V_e(t,e){return t.get(jq(t,e))}function jq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var RO=new WeakMap;class Uq{constructor(){H_e(this,RO,[])}subscribe(e){return this.addLocalHook("change",e),this._write(V_e(RO,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){B_e(RO,this,e)}}Xn(Uq,uo);function ZB(t,e){const r=[];let i=0,s=0;for(;i<t.length&&s<e.length;i++,s++)t[i]!==e[s]&&r.push({op:"replace",index:s,oldValue:t[i],newValue:e[s]});for(;i<e.length;i++)r.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;s<t.length;s++)r.push({op:"remove",index:s,oldValue:t[s],newValue:void 0});return r}function Xv(t,e,r){W_e(t,e),e.set(t,r)}function W_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xl(t,e){return t.get(zq(t,e))}function Gb(t,e,r){return t.set(zq(t,e),r),r}function zq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yb=new WeakMap,qv=new WeakMap,Kb=new WeakMap,Xb=new WeakMap,qb=new WeakMap;class j_e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xv(this,Yb,new Set),Xv(this,qv,[]),Xv(this,Kb,[]),Xv(this,Xb,!1),Xv(this,qb,!1),Gb(qb,this,e??!1)}createObserver(){const e=new Uq;return xl(Yb,this).add(e),e.addLocalHook("unsubscribe",()=>{xl(Yb,this).delete(e)}),e._writeInitialChanges(ZB(xl(qv,this),xl(Kb,this))),e}emit(e){let r=xl(Kb,this);(!xl(Xb,this)||xl(qv,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(xl(qb,this)):Gb(qv,this,new Array(e.length).fill(xl(qb,this))),xl(Xb,this)||(Gb(Xb,this,!0),r=xl(qv,this)));const i=ZB(r,e);xl(Yb,this).forEach(s=>s._write(i)),Gb(Kb,this,e)}}function jo(t,e,r){return(e=U_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U_e(t){var e=z_e(t,"string");return typeof e=="symbol"?e:e+""}function z_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nF{constructor(){jo(this,"indexesSequence",new Wq),jo(this,"trimmingMapsCollection",new QB(e=>e.some(r=>r===!0),!1)),jo(this,"hidingMapsCollection",new QB(e=>e.some(r=>r===!0),!1)),jo(this,"variousMapsCollection",new xN),jo(this,"hidingChangesObservable",new j_e({initialIndexValue:!1})),jo(this,"notTrimmedIndexesCache",[]),jo(this,"notHiddenIndexesCache",[]),jo(this,"isBatched",!1),jo(this,"indexesSequenceChanged",!1),jo(this,"indexesChangeSource",void 0),jo(this,"trimmedIndexesChanged",!1),jo(this,"hiddenIndexesChanged",!1),jo(this,"renderablePhysicalIndexesCache",[]),jo(this,"fromPhysicalToVisualIndexesCache",new Map),jo(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,i){return this.registerMap(e,F_e(r,i))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof eS?this.trimmingMapsCollection.register(e,r):r instanceof j_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const i=this.getNumberOfIndexes();return i>0&&r.init(i),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return nr(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return nr(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return nr(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return nr(r)?r:null}getNearestNotHiddenIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=n.findIndex(l=>l>e):o=n.reverse().findIndex(l=>l<e),o===-1?i?this.getNearestNotHiddenIndex(e,-r,!1):null:n[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(i)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const i=on(e,d=>this.getPhysicalFromVisualIndex(d)),s=this.getNotTrimmedIndexesLength(),n=e.length,o=iC(this.getIndexesSequence(),i),l=o.filter(d=>this.isTrimmed(d)===!1);let h=o.indexOf(l[l.length-1])+1;if(r+n<s){const d=l[r];h=o.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(CN(o,h,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const i=this.getNotTrimmedIndexes()[e],s=nr(i)?i:this.getNumberOfIndexes(),n=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),o=on(new Array(r).fill(s),(l,h)=>l+h);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(n,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(n,o),this.hidingMapsCollection.insertToEvery(n,o),this.variousMapsCollection.insertToEvery(n,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(i,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromRenderableIndex(r),s=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(s,r)}}}Xn(nF,uo);function G_e(t,e){return Zr(e,(r,i)=>{_i(t[i])&&(t[i]=r)}),t}function Gq(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function Yq(t){nr(t)&&Xk(Ln`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Y_e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:K_e,getValues:X_e}=Vc("phraseFormatters");function q_e(t,e){K_e(t,e)}function J_e(){return X_e()}q_e("pluralize",Y_e);const Kq="ContextMenu:items",Br=Kq,EN=`${Br}.noItems`,TN=`${Br}.insertRowAbove`,_N=`${Br}.insertRowBelow`,RN=`${Br}.insertColumnOnTheLeft`,AN=`${Br}.insertColumnOnTheRight`,ON=`${Br}.removeRow`,IN=`${Br}.removeColumn`,PN=`${Br}.undo`,FN=`${Br}.redo`,JE=`${Br}.readOnly`,MN=`${Br}.clearColumn`,kN=`${Br}.copy`,NN=`${Br}.copyWithHeaders`,DN=`${Br}.copyWithGroupHeaders`,LN=`${Br}.copyHeadersOnly`,HN=`${Br}.cut`,$N=`${Br}.freezeColumn`,BN=`${Br}.unfreezeColumn`,VN=`${Br}.mergeCells`,WN=`${Br}.unmergeCells`,jN=`${Br}.addComment`,UN=`${Br}.editComment`,zN=`${Br}.removeComment`,GN=`${Br}.readOnlyComment`,YN=`${Br}.align`,KN=`${Br}.align.left`,XN=`${Br}.align.center`,qN=`${Br}.align.right`,JN=`${Br}.align.justify`,QN=`${Br}.align.top`,ZN=`${Br}.align.middle`,eD=`${Br}.align.bottom`,tD=`${Br}.borders`,rD=`${Br}.borders.top`,nD=`${Br}.borders.right`,iD=`${Br}.borders.bottom`,sD=`${Br}.borders.left`,oD=`${Br}.borders.remove`,aD=`${Br}.nestedHeaders.insertChildRow`,lD=`${Br}.nestedHeaders.detachFromParent`,cD=`${Br}.hideColumn`,uD=`${Br}.showColumn`,hD=`${Br}.hideRow`,fD=`${Br}.showRow`,ca="Filters:",$i=`${ca}conditions`,z_=`${$i}.none`,dD=`${$i}.isEmpty`,gD=`${$i}.isNotEmpty`,mD=`${$i}.isEqualTo`,pD=`${$i}.isNotEqualTo`,vD=`${$i}.beginsWith`,wD=`${$i}.endsWith`,yD=`${$i}.contains`,CD=`${$i}.doesNotContain`,Q_e=`${$i}.byValue`,SD=`${$i}.greaterThan`,bD=`${$i}.greaterThanOrEqualTo`,xD=`${$i}.lessThan`,ED=`${$i}.lessThanOrEqualTo`,TD=`${$i}.isBetween`,_D=`${$i}.isNotBetween`,RD=`${$i}.after`,AD=`${$i}.before`,OD=`${$i}.today`,ID=`${$i}.tomorrow`,PD=`${$i}.yesterday`,FD=`${ca}labels.filterByCondition`,MD=`${ca}labels.filterByValue`,kD=`${ca}labels.conjunction`,G_=`${ca}labels.disjunction`,QE=`${ca}values.blankCells`,ND=`${ca}buttons.selectAll`,DD=`${ca}buttons.clear`,LD=`${ca}buttons.ok`,HD=`${ca}buttons.cancel`,$D=`${ca}buttons.placeholder.search`,BD=`${ca}buttons.placeholder.value`,VD=`${ca}buttons.placeholder.secondValue`,WD="CheckboxRenderer:",jD=`${WD}checked`,UD=`${WD}unchecked`,Z_e=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:jD,CHECKBOX_RENDERER_NAMESPACE:WD,CHECKBOX_UNCHECKED:UD,CONTEXTMENU_ITEMS_ADD_COMMENT:jN,CONTEXTMENU_ITEMS_ALIGNMENT:YN,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:eD,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:XN,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:JN,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:KN,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:ZN,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:qN,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:QN,CONTEXTMENU_ITEMS_BORDERS:tD,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:iD,CONTEXTMENU_ITEMS_BORDERS_LEFT:sD,CONTEXTMENU_ITEMS_BORDERS_RIGHT:nD,CONTEXTMENU_ITEMS_BORDERS_TOP:rD,CONTEXTMENU_ITEMS_CLEAR_COLUMN:MN,CONTEXTMENU_ITEMS_COPY:kN,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:LN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:DN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:NN,CONTEXTMENU_ITEMS_CUT:HN,CONTEXTMENU_ITEMS_EDIT_COMMENT:UN,CONTEXTMENU_ITEMS_FREEZE_COLUMN:$N,CONTEXTMENU_ITEMS_HIDE_COLUMN:cD,CONTEXTMENU_ITEMS_HIDE_ROW:hD,CONTEXTMENU_ITEMS_INSERT_LEFT:RN,CONTEXTMENU_ITEMS_INSERT_RIGHT:AN,CONTEXTMENU_ITEMS_MERGE_CELLS:VN,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:lD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:aD,CONTEXTMENU_ITEMS_NO_ITEMS:EN,CONTEXTMENU_ITEMS_READ_ONLY:JE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:GN,CONTEXTMENU_ITEMS_REDO:FN,CONTEXTMENU_ITEMS_REMOVE_BORDERS:oD,CONTEXTMENU_ITEMS_REMOVE_COLUMN:IN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:zN,CONTEXTMENU_ITEMS_REMOVE_ROW:ON,CONTEXTMENU_ITEMS_ROW_ABOVE:TN,CONTEXTMENU_ITEMS_ROW_BELOW:_N,CONTEXTMENU_ITEMS_SHOW_COLUMN:uD,CONTEXTMENU_ITEMS_SHOW_ROW:fD,CONTEXTMENU_ITEMS_UNDO:PN,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:BN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:WN,CONTEXT_MENU_ITEMS_NAMESPACE:Kq,FILTERS_BUTTONS_CANCEL:HD,FILTERS_BUTTONS_CLEAR:DD,FILTERS_BUTTONS_OK:LD,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:$D,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:VD,FILTERS_BUTTONS_PLACEHOLDER_VALUE:BD,FILTERS_BUTTONS_SELECT_ALL:ND,FILTERS_CONDITIONS_AFTER:RD,FILTERS_CONDITIONS_BEFORE:AD,FILTERS_CONDITIONS_BEGINS_WITH:vD,FILTERS_CONDITIONS_BETWEEN:TD,FILTERS_CONDITIONS_BY_VALUE:Q_e,FILTERS_CONDITIONS_CONTAINS:yD,FILTERS_CONDITIONS_EMPTY:dD,FILTERS_CONDITIONS_ENDS_WITH:wD,FILTERS_CONDITIONS_EQUAL:mD,FILTERS_CONDITIONS_GREATER_THAN:SD,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:bD,FILTERS_CONDITIONS_LESS_THAN:xD,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:ED,FILTERS_CONDITIONS_NAMESPACE:$i,FILTERS_CONDITIONS_NONE:z_,FILTERS_CONDITIONS_NOT_BETWEEN:_D,FILTERS_CONDITIONS_NOT_CONTAIN:CD,FILTERS_CONDITIONS_NOT_EMPTY:gD,FILTERS_CONDITIONS_NOT_EQUAL:pD,FILTERS_CONDITIONS_TODAY:OD,FILTERS_CONDITIONS_TOMORROW:ID,FILTERS_CONDITIONS_YESTERDAY:PD,FILTERS_DIVS_FILTER_BY_CONDITION:FD,FILTERS_DIVS_FILTER_BY_VALUE:MD,FILTERS_LABELS_CONJUNCTION:kD,FILTERS_LABELS_DISJUNCTION:G_,FILTERS_NAMESPACE:ca,FILTERS_VALUES_BLANK_CELLS:QE},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const Xq={languageCode:"en-US",[EN]:"No available options",[TN]:"Insert row above",[_N]:"Insert row below",[RN]:"Insert column left",[AN]:"Insert column right",[ON]:["Remove row","Remove rows"],[IN]:["Remove column","Remove columns"],[PN]:"Undo",[FN]:"Redo",[JE]:"Read only",[MN]:"Clear column",[YN]:"Alignment",[KN]:"Left",[XN]:"Center",[qN]:"Right",[JN]:"Justify",[QN]:"Top",[ZN]:"Middle",[eD]:"Bottom",[$N]:"Freeze column",[BN]:"Unfreeze column",[tD]:"Borders",[rD]:"Top",[nD]:"Right",[iD]:"Bottom",[sD]:"Left",[oD]:"Remove border(s)",[jN]:"Add comment",[UN]:"Edit comment",[zN]:"Delete comment",[GN]:"Read-only comment",[VN]:"Merge cells",[WN]:"Unmerge cells",[kN]:"Copy",[NN]:["Copy with header","Copy with headers"],[DN]:["Copy with group header","Copy with group headers"],[LN]:["Copy header only","Copy headers only"],[HN]:"Cut",[aD]:"Insert child row",[lD]:"Detach from parent",[cD]:["Hide column","Hide columns"],[uD]:["Show column","Show columns"],[hD]:["Hide row","Hide rows"],[fD]:["Show row","Show rows"],[z_]:"None",[dD]:"Is empty",[gD]:"Is not empty",[mD]:"Is equal to",[pD]:"Is not equal to",[vD]:"Begins with",[wD]:"Ends with",[yD]:"Contains",[CD]:"Does not contain",[SD]:"Greater than",[bD]:"Greater than or equal to",[xD]:"Less than",[ED]:"Less than or equal to",[TD]:"Is between",[_D]:"Is not between",[RD]:"After",[AD]:"Before",[OD]:"Today",[ID]:"Tomorrow",[PD]:"Yesterday",[QE]:"Blank cells",[FD]:"Filter by condition",[MD]:"Filter by value",[kD]:"And",[G_]:"Or",[ND]:"Select all",[DD]:"Clear",[LD]:"OK",[HD]:"Cancel",[$D]:"Search",[BD]:"Value",[VD]:"Second value",[jD]:"Checked",[UD]:"Unchecked"},eRe=Z_e,iF=Xq.languageCode,{register:tRe,getItem:qq,hasItem:rRe,getValues:nRe}=Vc("languagesDictionaries");Jq(Xq);function Jq(t,e){let r=t,i=e;return Qr(t)&&(i=t,r=i.languageCode),iRe(r,i),tRe(r,sa(i)),sa(i)}function iRe(t,e){t!==iF&&G_e(e,qq(iF))}function Qq(t){return zD(t)?sa(qq(t)):null}function zD(t){return rRe(t)}function sRe(){return nRe()}function Zq(t,e,r){const i=Qq(t);if(i===null)return null;const s=i[e];if(_i(s))return null;const n=oRe(s,r);return Array.isArray(n)?n[0]:n}function oRe(t,e){let r=t;return Te(J_e(),i=>{r=i(t,e)}),r}function aRe(t){let e=Gq(t);return zD(e)||(e=iF,Yq(t)),e}function lRe(t,e,r){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hf extends Oq{constructor(e,r){super(e,null),lRe(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:i}=e,s=this.getNearestNotHiddenCoords(r,1),n=this.getNearestNotHiddenCoords(i,-1);return s===null||n===null?null:((s.row>n.row||s.col>n.col)&&(s=r,n=i),this.settings.createCellRange(s,s,n))}getNearestNotHiddenCoords(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(s===null)return null;const n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return n===null?null:this.settings.createCellCoords(s,n)}getNearestNotHiddenIndex(e,r,i){return r<0?r:e.getNearestNotHiddenIndex(r,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((n===null||n.col===null||n.row===null)&&(o=this.getNearestNotHiddenCoords(r,i,s)),o!==null&&e.overlaps(o)){const l=e.highlight.clone();if(l.row>=0&&(l.row=o.row),l.col>=0&&(l.col=o.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&n!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const i=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(r);return i.row===null||i.col===null||s.row===null||s.col===null?null:this.settings.createCellRange(i,i,s)}}function AO(t){let{activeHeaderClassName:e,...r}=t;return new hf({className:e,...r,selectionType:Iq})}function hRe(t){let{areaCornerVisible:e,...r}=t;return new hf({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:lN})}function fRe(t){let{...e}=t;return new hf({className:"highlight",...e,selectionType:lN})}function dRe(t){let{columnClassName:e,...r}=t;return new hf({className:e,...r,selectionType:CTe})}function gRe(t){let{cellCornerVisible:e,...r}=t;return new hf({className:"current",headerAttributes:[Vk()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:qE})}function mRe(t){let{border:e,visualCellRange:r,...i}=t;return new hf({...e,...i,selectionType:STe},r)}function pRe(t){let{...e}=t;return new hf({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:wTe})}function eV(t){let{headerClassName:e,...r}=t;return new hf({className:e,...r,selectionType:aN})}function vRe(t){let{rowClassName:e,...r}=t;return new hf({className:e,...r,selectionType:yTe})}function wRe(t,e){yRe(t,e),e.add(t)}function yRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ga(t,e,r){return(e=CRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CRe(t){var e=SRe(t,"string");return typeof e=="symbol"?e:e+""}function SRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ru=new WeakSet;class bRe{constructor(e){wRe(this,ru),ga(this,"options",void 0),ga(this,"layerLevel",0),ga(this,"focus",void 0),ga(this,"fill",void 0),ga(this,"layeredAreas",new Map),ga(this,"areas",new Map),ga(this,"rowHeaders",new Map),ga(this,"columnHeaders",new Map),ga(this,"activeRowHeaders",new Map),ga(this,"activeColumnHeaders",new Map),ga(this,"activeCornerHeaders",new Map),ga(this,"rowHighlights",new Map),ga(this,"columnHighlights",new Map),ga(this,"customSelections",[]),this.options=e,this.focus=gRe(e),this.fill=pRe(e)}isEnabledFor(e,r){let i=e;e===qE&&(i="current");let s=this.options.disabledCellSelection(r.row,r.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return hh(ru,this,fh).call(this,this.layeredAreas,hRe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return hh(ru,this,fh).call(this,this.areas,fRe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return hh(ru,this,fh).call(this,this.rowHeaders,eV)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return hh(ru,this,fh).call(this,this.columnHeaders,eV)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return hh(ru,this,fh).call(this,this.activeRowHeaders,AO)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return hh(ru,this,fh).call(this,this.activeColumnHeaders,AO)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return hh(ru,this,fh).call(this,this.activeCornerHeaders,AO)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return hh(ru,this,fh).call(this,this.rowHighlights,vRe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return hh(ru,this,fh).call(this,this.columnHighlights,dRe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(mRe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Te(this.areas.values(),e=>void e.clear()),Te(this.layeredAreas.values(),e=>void e.clear()),Te(this.rowHeaders.values(),e=>void e.clear()),Te(this.columnHeaders.values(),e=>void e.clear()),Te(this.activeRowHeaders.values(),e=>void e.clear()),Te(this.activeColumnHeaders.values(),e=>void e.clear()),Te(this.activeCornerHeaders.values(),e=>void e.clear()),Te(this.rowHighlights.values(),e=>void e.clear()),Te(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function fh(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const i=e({layerLevel:r,...this.options});return t.set(r,i),i}function tV(t,e,r){return(e=xRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xRe(t){var e=ERe(t,"string");return typeof e=="symbol"?e:e+""}function ERe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TRe{constructor(e){tV(this,"ranges",[]),tV(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _Re(t,e){eJ(t,e),e.add(t)}function OO(t,e,r){eJ(t,e),e.set(t,r)}function eJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(t,e){return t.get(fs(t,e))}function Jb(t,e,r){return t.set(fs(t,e),r),r}function fs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qb=new WeakMap,si=new WeakMap,Oc=new WeakMap,_s=new WeakSet;class sF{constructor(e,r){_Re(this,_s),OO(this,Qb,void 0),OO(this,si,void 0),OO(this,Oc,{x:0,y:0}),Jb(Qb,this,e),Jb(si,this,r)}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=yn(si,this).createCellCoords(e,r);let n=yn(Qb,this).current().highlight;const o=yn(si,this).visualToRenderableCoords(n);let l=0,h=0;if(this.runLocalHooks("beforeTransformStart",s),o.row!==null&&o.col!==null){const{width:d,height:g}=fs(_s,this,tJ).call(this),{row:y,col:C}=fs(_s,this,nV).call(this,n),x=yn(si,this).fixedRowsBottom(),_=yn(si,this).minSpareRows(),E=yn(si,this).minSpareCols(),R=yn(si,this).autoWrapRow(),I=yn(si,this).autoWrapCol(),F=yn(si,this).createCellCoords(y+s.row,C+s.col);if(F.row>=g){const X=tl(i&&_>0&&x===0),te=F.col+1,Y=yn(si,this).createCellCoords(F.row-g,te>=d?te-d:te);this.runLocalHooks("beforeColumnWrap",X,fs(_s,this,Am).call(this,Y),te>=d),X.value?this.runLocalHooks("insertRowRequire",yn(si,this).countRenderableRows()):I&&F.assign(Y)}else if(F.row<0){const X=tl(I),te=F.col-1,Y=yn(si,this).createCellCoords(g+F.row,te<0?d+te:te);this.runLocalHooks("beforeColumnWrap",X,fs(_s,this,Am).call(this,Y),te<0),I&&F.assign(Y)}if(F.col>=d){const X=tl(i&&E>0),te=F.row+1,Y=yn(si,this).createCellCoords(te>=g?te-g:te,F.col-d);this.runLocalHooks("beforeRowWrap",X,fs(_s,this,Am).call(this,Y),te>=g),X.value?this.runLocalHooks("insertColRequire",yn(si,this).countRenderableColumns()):R&&F.assign(Y)}else if(F.col<0){const X=tl(R),te=F.row-1,Y=yn(si,this).createCellCoords(te<0?g+te:te,d+F.col);this.runLocalHooks("beforeRowWrap",X,fs(_s,this,Am).call(this,Y),te<0),R&&F.assign(Y)}const{rowDir:D,colDir:U}=fs(_s,this,rV).call(this,F);l=D,h=U,n=fs(_s,this,Am).call(this,F)}return this.runLocalHooks("afterTransformStart",n,l,h),n}transformEnd(e,r){const i=yn(si,this).createCellCoords(e,r),s=yn(Qb,this).current(),n=yn(si,this).visualToRenderableCoords(s.highlight),o=fs(_s,this,IO).call(this,s.to.row,s.from.row),l=fs(_s,this,PO).call(this,s.to.col,s.from.col),h=s.to.clone();let d=0,g=0;if(this.runLocalHooks("beforeTransformEnd",i),n.row!==null&&n.col!==null&&o!==null&&l!==null){const{row:y,col:C}=fs(_s,this,nV).call(this,s.highlight),x=yn(si,this).createCellCoords(o+i.row,l+i.col),_=s.getTopStartCorner(),E=s.getTopEndCorner(),R=s.getBottomEndCorner();if(i.col<0&&l>=C&&x.col<C){const U=x.col-C;x.col=fs(_s,this,PO).call(this,_.col,E.col)+U}else if(i.col>0&&l<=C&&x.col>C){const U=fs(_s,this,PO).call(this,E.col,_.col),X=Math.max(x.col-U,1);x.col=U+X}if(i.row<0&&o>=y&&x.row<y){const U=x.row-y;x.row=fs(_s,this,IO).call(this,_.row,R.row)+U}else if(i.row>0&&o<=y&&x.row>y){const U=fs(_s,this,IO).call(this,R.row,_.row),X=Math.max(x.row-U,1);x.row=U+X}const{rowDir:I,colDir:F}=fs(_s,this,rV).call(this,x);d=I,g=F;const D=fs(_s,this,Am).call(this,x);i.row===0&&i.col!==0?h.col=D.col:i.row!==0&&i.col===0?h.row=D.row:(h.row=D.row,h.col=D.col)}return this.runLocalHooks("afterTransformEnd",h,d,g),h}setOffsetSize(e){let{x:r,y:i}=e;Jb(Oc,this,{x:r,y:i})}resetOffsetSize(){Jb(Oc,this,{x:0,y:0})}}function rV(t){const{width:e,height:r}=fs(_s,this,tJ).call(this);let i=0,s=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=r&&(i=1,t.row=r-1),t.col<0?(s=-1,t.col=0):t.col>0&&t.col>=e&&(s=1,t.col=e-1),{rowDir:i,colDir:s}}function tJ(){return{width:yn(Oc,this).x+yn(si,this).countRenderableColumns(),height:yn(Oc,this).y+yn(si,this).countRenderableRows()}}function IO(t,e){const r=yn(si,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:yn(Oc,this).y+r}function PO(t,e){const r=yn(si,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:yn(Oc,this).x+r}function nV(t){const{row:e,col:r}=yn(si,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return yn(si,this).createCellCoords(yn(Oc,this).y+e,yn(Oc,this).x+r)}function Am(t){const e=t.clone();return e.col=t.col-yn(Oc,this).x,e.row=t.row-yn(Oc,this).y,yn(si,this).renderableToVisualCoords(e)}Xn(sF,uo);const Y_=0,K_=1,rJ=2,GD=3,RRe=[GD,rJ],ARe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],FO=Symbol("root"),iV=Symbol("child");function h1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FO;if(e!==FO&&e!==iV)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),i=e===FO;let s=Y_;if(r){const n=t[0];t.length===0?s=K_:i&&n instanceof JC?s=GD:i&&Array.isArray(n)?s=h1(n,iV):t.length>=2&&t.length<=4&&!t.some((l,h)=>!ARe[h].includes(typeof l))&&(s=rJ)}return s}function sC(t){let{createCellCoords:e,createCellRange:r,keepDirection:i=!1,propToCol:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!RRe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const o=t===GD;let l=o?n.from.row:n[0],h=o?n.from.col:n[1],d=o?n.to.row:n[2],g=o?n.to.col:n[3];if(typeof s=="function"&&(typeof h=="string"&&(h=s(h)),typeof g=="string"&&(g=s(g))),_i(d)&&(d=l),_i(g)&&(g=h),!i){const x=l,_=h,E=d,R=g;l=Math.min(x,E),h=Math.min(_,R),d=Math.max(x,E),g=Math.max(_,R)}const y=e(l,h),C=e(d,g);return r(y,y,C)}}function ORe(t){const e=h1(t.getSelected());if(e===Y_||e===K_)return[];const r=sC(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;Te(t.getSelected(),o=>{const{from:l,to:h}=r(o),d=Math.max(l.col,0),g=h.col-d+1;Te(Array.from(new Array(g),(y,C)=>d+C),y=>{i.has(y)||i.add(y)})});const s=Array.from(i).sort((o,l)=>o-l);return la(s,(o,l,h,d)=>(h!==0&&l===d[h-1]+1?o[o.length-1][1]+=1:o.push([l,1]),o),[])}function IRe(t){const e=h1(t.getSelected());if(e===Y_||e===K_)return[];const r=sC(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;Te(t.getSelected(),o=>{const{from:l,to:h}=r(o),d=Math.max(l.row,0),g=h.row-d+1;Te(Array.from(new Array(g),(y,C)=>d+C),y=>{i.has(y)||i.add(y)})});const s=Array.from(i).sort((o,l)=>o-l);return la(s,(o,l,h,d)=>(h!==0&&l===d[h-1]+1?o[o.length-1][1]+=1:o.push([l,1]),o),[])}function Om(t,e,r){PRe(t,e),e.set(t,r)}function PRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function g0(t,e,r){return(e=FRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FRe(t){var e=MRe(t,"string");return typeof e=="symbol"?e:e+""}function MRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function di(t,e){return t.get(nJ(t,e))}function nu(t,e,r){return t.set(nJ(t,e),r),r}function nJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Eo=new WeakMap,m0=new WeakMap,Zb=new WeakMap,Jv=new WeakMap,ex=new WeakMap,Qv=new WeakMap;class iJ{constructor(e,r){var i=this;g0(this,"settings",void 0),g0(this,"tableProps",void 0),g0(this,"inProgress",!1),g0(this,"selectedRange",new TRe((s,n,o)=>this.tableProps.createCellRange(s,n,o))),g0(this,"highlight",void 0),Om(this,Eo,void 0),Om(this,m0,void 0),g0(this,"selectedByRowHeader",new Set),g0(this,"selectedByColumnHeader",new Set),Om(this,Zb,!1),Om(this,Jv,!1),Om(this,ex,"unknown"),Om(this,Qv,-1),this.settings=e,this.tableProps=r,this.highlight=new bRe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Vk()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(s,n)=>this.tableProps.isDisabledCellSelection(s,n),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),createCellRange:(s,n,o)=>this.tableProps.createCellRange(s,n,o)}),nu(Eo,this,new sF(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),nu(m0,this,new sF(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),di(Eo,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...n)}),di(Eo,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...n)}),di(Eo,this).addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...n)}),di(Eo,this).addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...n)}),di(Eo,this).addLocalHook("insertRowRequire",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...n)}),di(Eo,this).addLocalHook("insertColRequire",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("insertColRequire",...n)}),di(Eo,this).addLocalHook("beforeRowWrap",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...n)}),di(Eo,this).addLocalHook("beforeColumnWrap",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...n)}),di(m0,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...n)}),di(m0,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...n)})}getSelectedRange(){return this.selectedRange}markSource(e){nu(ex,this,e)}markEndSource(){nu(ex,this,"unknown")}getSelectionSource(){return di(ex,this)}setExpectedLayers(e){nu(Qv,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,nu(Qv,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const n=this.settings.selectionMode==="multiple",o=_i(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,l=e.clone();nu(Zb,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,l),(!n||n&&!o&&_i(r))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(s.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),i=this.tableProps.countRows(),s=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||s>0)&&(i===0&&r.col<0&&!n||s===0&&r.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const h=o.getHorizontalDirection(),d=o.getVerticalDirection(),g=this.isMultiple();o.setTo(r),g&&(h!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),g&&(d!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const l=di(Qv,this)===-1||this.selectedRange.size()===di(Qv,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),s=this.tableProps.countCols();r<this.highlight.layerLevel&&(Te(this.highlight.getAreas(),_=>void _.clear()),Te(this.highlight.getLayeredAreas(),_=>void _.clear()),Te(this.highlight.getRowHeaders(),_=>void _.clear()),Te(this.highlight.getColumnHeaders(),_=>void _.clear()),Te(this.highlight.getActiveRowHeaders(),_=>void _.clear()),Te(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),Te(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),Te(this.highlight.getRowHighlights(),_=>void _.clear()),Te(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(r);const n=this.highlight.createArea(),o=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),x=this.highlight.createColumnHighlight();if(n.clear(),o.clear(),l.clear(),h.clear(),d.clear(),g.clear(),y.clear(),C.clear(),x.clear(),this.highlight.isEnabledFor(lN,e.highlight)&&(this.isMultiple()||r>=1)&&(n.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(aN,e.highlight)){if(!e.isSingleHeader()){const R=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),I=this.tableProps.createCellCoords(e.to.row,-1),F=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),D=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(l.add(R).commit(),h.add(F).commit(),C.add(R).commit(),x.add(F).commit()):(l.add(R).add(I).commit(),h.add(F).add(D).commit(),C.add(R).add(I).commit(),x.add(F).add(D).commit())}const _=!di(Jv,this)&&this.isEntireRowSelected()&&(s>0&&s===e.getWidth()||s===0&&this.isSelectedByRowHeader()),E=!di(Jv,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());_&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),E&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),_&&E&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(qE,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(nu(Zb,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?di(Eo,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):di(Eo,this).resetOffsetSize(),this.setRangeStart(di(Eo,this).transformStart(e,r,i))}transformEnd(e,r){this.settings.navigableHeaders?di(Eo,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):di(Eo,this).resetOffsetSize(),this.setRangeEnd(di(Eo,this).transformEnd(e,r))}transformFocus(e,r){const i=this.selectedRange.current(),{row:s,col:n}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,n-1),l=this.tableProps.countRenderableRowsInRange(0,s-1);i.highlight.isHeader()?di(m0,this).setOffsetSize({x:n<0?Math.abs(n):-o,y:s<0?Math.abs(s):-l}):di(m0,this).setOffsetSize({x:n<0?0:-o,y:s<0?0:-l});const h=di(m0,this).transformStart(e,r);this.setRangeFocus(h.normalize())}shiftRows(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:s,to:n,highlight:o}=i,l=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=d?-1:0,y=d?0:r;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(vn(s.row+y,g,l-1),s.col),x=this.tableProps.createCellCoords(vn(n.row+r,g,l-1),n.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(vn(o.row+r,0,l-1),o.col)):this.setRangeStartOnly(C,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:s,to:n,highlight:o}=i,l=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=h?-1:0,y=h?0:r;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(s.row,vn(s.col+y,g,l-1)),x=this.tableProps.createCellCoords(n.row,vn(n.col+r,g,l-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(o.row,vn(o.col+r,0,l-1))):this.setRangeStartOnly(C,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=tl(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&di(Zb,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=s=>{const{col:n}=s.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(o>0&&n<0||o===0)&&s.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>r(s));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=s=>{const{row:n}=s.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(o>0&&n<0||o===0)&&s.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>r(s));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const n=this.tableProps.countRows(),o=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),d=i?-h:0,g=r?-l:0;if(d===0&&g===0&&(n===0||o===0))return;let y=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:C,disableHeadersHighlight:x}=s;nu(Jv,this,x),C&&Number.isInteger(C==null?void 0:C.row)&&Number.isInteger(C==null?void 0:C.col)&&(y=this.tableProps.createCellCoords(vn(C.row,d,n-1),vn(C.col,g,o-1)));const _=this.tableProps.createCellCoords(d,g),E=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(_,void 0,y),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.finish(),nu(Jv,this,!1)}selectCells(e){var r=this;const i=h1(e);if(i===K_)return!1;if(i===Y_)throw new Error(Ln`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=sC(i,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},l=!e.some(h=>{const d=s(h),g=d.isValid(o);return!(g&&!d.containsHeaders()||g&&d.containsHeaders()&&d.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),Te(e,h=>{const{from:d,to:g}=s(h);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),l}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=typeof e=="string"?this.tableProps.propToCol(e):e,n=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),l=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),d=h===0?0:-h,g=this.tableProps.createCellCoords(d,s),y=this.tableProps.createCellCoords(o-1,n),C=this.tableProps.createCellRange(g,g,y).isValid({countRows:o,countCols:l,countRowHeaders:0,countColHeaders:h});if(C){let x=0,_=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(x=vn(i.row,d,o-1),_=vn(i.col,Math.min(s,n),Math.max(s,n))):(x=vn(i,d,o-1),_=s);const E=this.tableProps.createCellCoords(x,_),R=h===0?0:vn(E.row,d,-1),I=o-1,F=this.tableProps.createCellCoords(R,s),D=this.tableProps.createCellCoords(I,n);this.runLocalHooks("beforeSelectColumns",F,D,E),F.row=R,D.row=I,this.setRangeStartOnly(F,void 0,E),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(D),this.runLocalHooks("afterSelectColumns",F,D,E),this.finish()}return C}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),l=o===0?0:-o,h=this.tableProps.createCellCoords(e,l),d=this.tableProps.createCellCoords(r,n-1),g=this.tableProps.createCellRange(h,h,d).isValid({countRows:s,countCols:n,countRowHeaders:o,countColHeaders:0});if(g){let y=0,C=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(y=vn(i.row,Math.min(e,r),Math.max(e,r)),C=vn(i.col,l,n-1)):(y=e,C=vn(i,l,n-1));const x=this.tableProps.createCellCoords(y,C),_=o===0?0:vn(x.col,l,-1),E=n-1,R=this.tableProps.createCellCoords(e,_),I=this.tableProps.createCellCoords(r,E);this.runLocalHooks("beforeSelectRows",R,I,x),R.col=_,I.col=E,this.setRangeStartOnly(R,void 0,x),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectRows",R,I,x),this.finish()}return g}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:s,to:n,highlight:o}=i;this.clear(),o.assign({row:vn(o.row,-1/0,e-1),col:vn(o.col,-1/0,r-1)}),s.assign({row:vn(s.row,-1/0,e-1),col:vn(s.col,-1/0,r-1)}),n.assign({row:vn(n.row,0,e-1),col:vn(n.col,0,r-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(o).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(qE,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const n=this.highlight.createArea(),o=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),x=this.highlight.createColumnHighlight();n.commit(),o.commit(),l.commit(),h.commit(),d.commit(),g.commit(),y.commit(),C.commit(),x.commit()}this.highlight.useLayerLevel(r)}}Xn(iJ,uo);const sV=/^(\r\n|\n\r|\r|\n)/,kRe=/^[^\t\r\n]+/,oV=/^\t/;function NRe(t){const e=[[""]];if(t.length===0)return e;let r=0,i=0,s;for(;t.length>0&&s!==t.length;)if(s=t.length,t.match(oV))t=t.replace(oV,""),r+=1,e[i][r]="";else if(t.match(sV))t=t.replace(sV,""),r=0,i+=1,e[i]=[""];else{let n="";if(t.startsWith('"')){let o=0,l=!0;for(;l;){const h=t.slice(0,1);h==='"'&&(o+=1),n+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(l=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const o=t.match(kRe);n=o?o[0]:"",t=t.slice(n.length)}e[i][r]=n}return e}function ly(t){let e,r,i,s,n="",o;for(e=0,r=t.length;e<r;e+=1){for(s=t[e].length,i=0;i<s;i+=1)i>0&&(n+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?n+=`"${o.replace(/"/g,'""')}"`:n+=o:o==null?n+="":n+=o;e!==r-1&&(n+=`
`)}return n}function p0(t,e,r){return(e=DRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DRe(t){var e=LRe(t,"string");return typeof e=="symbol"?e:e+""}function LRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Op{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,i){p0(this,"hot",void 0),p0(this,"metaManager",void 0),p0(this,"tableMeta",void 0),p0(this,"dataSource",void 0),p0(this,"duckSchema",void 0),p0(this,"colToPropCache",void 0),p0(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,r){let s=0,n=0,o=!1;if(typeof r=="function"){const l=Yk(e);s=l>0?l:this.countFirstRowKeys(),o=!0}else{const l=this.tableMeta.maxCols;s=Math.min(l,r.length)}for(i=0;i<s;i++){const l=o?r(i):r[i];if(Qr(l)){if(typeof l.data<"u"){const h=o?n:i;this.colToPropCache[h]=l.data,this.propToColCache.set(l.data,h)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Bq(this.dataSource)}recursiveDuckColumns(e,r,i){let s=r,n=i,o;return typeof s>"u"&&(s=0,n=""),typeof e=="object"&&!Array.isArray(e)&&Zr(e,(l,h)=>{l===null?(o=n+h,this.colToPropCache.push(o),this.propToColCache.set(o,s),s+=1):s=this.recursiveDuckColumns(l,s,`${h}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&nr(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(nr(r))return this.hot.toVisualColumn(r);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?rC(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=this.hot.countSourceRows();let o=n,l=0,h=e;if((typeof h!="number"||h>=n)&&(h=n),h<this.hot.countRows()&&(o=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,r,i)===!1||o===null)return{delta:0};const g=this.tableMeta.maxRows,y=this.getSchema().length,C=[];for(;l<r&&n+l<g;){let _=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?_=sa(this.getSchema()):(_=[],pr(y-1,()=>_.push(null))):this.hot.dataType==="function"?_=this.tableMeta.dataSchema(h+l):(_={},H_(_,this.getSchema())),C.push(_),l+=1}this.hot.rowIndexMapper.insertIndexes(h,l),s==="below"&&(o=Math.min(o+1,n)),this.spliceData(o,0,C);const x=this.hot.toVisualRow(o);return this.hot.countSourceRows()===C.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):i!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",x,l,i),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const n=this.dataSource,o=this.tableMeta.maxCols,l=this.hot.countSourceCols();let h=e;if((typeof h!="number"||h>=l)&&(h=l),this.hot.runHooks("beforeCreateCol",h,r,i)===!1)return{delta:0};let g=l;h<this.hot.countCols()&&(g=this.hot.toPhysicalColumn(h));const y=this.hot.countSourceRows();let C=this.hot.countCols(),x=0,_=g;s==="end"&&(_=Math.min(_+1,l));const E=_;for(;x<r&&C<o;){if(typeof h!="number"||h>=C)if(y>0)for(let I=0;I<y;I+=1)typeof n[I]>"u"&&(n[I]=[]),n[I].push(null);else n.push([null]);else for(let I=0;I<y;I++)n[I].splice(_,0,null);x+=1,_+=1,C+=1}this.hot.columnIndexMapper.insertIndexes(h,x),x>0&&(e==null?this.metaManager.createColumn(null,x):i!=="auto"&&this.metaManager.createColumn(E,r));const R=this.hot.toVisualColumn(E);return this.hot.runHooks("afterCreateCol",R,x,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:x,startPhysicalIndex:E}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-r;const n=this.visualRowsToPhysical(s,r),o=this.hot.countSourceRows();if(s=(o+s)%o,this.hot.runHooks("beforeRemoveRow",s,n.length,n,i)===!1)return!1;const h=n.length;if(this.filterData(s,h,n),s<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);const g=nr(this.tableMeta.columns)||nr(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&g===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return n.slice(0).sort((g,y)=>y-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",s,h,n,i),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-r:e;s=(this.hot.countCols()+s)%this.hot.countCols();const n=this.visualColumnsToPhysical(s,r),o=n.slice(0).sort((y,C)=>C-y);if(this.hot.runHooks("beforeRemoveCol",s,r,n,i)===!1)return!1;let h=!0;const d=o.length,g=this.dataSource;for(let y=0;y<d;y++)h&&n[0]!==n[y]-y&&(h=!1);if(h)for(let y=0,C=this.hot.countSourceRows();y<C;y++)g[y].splice(n[0],r),y===0&&this.metaManager.removeColumn(n[0],r);else for(let y=0,C=this.hot.countSourceRows();y<C;y++)for(let x=0;x<d;x++)g[y].splice(o[x],1),y===0&&this.metaManager.removeColumn(o[x],1);return s<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",s,r,n,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,i){const s=this.hot.getDataAtCol(e),n=s.slice(r,r+i),o=s.slice(r+i);for(var l=arguments.length,h=new Array(l>3?l-3:0),d=3;d<l;d++)h[d-3]=arguments[d];B9(h,o);let g=0;for(;g<i;)h.push(null),g+=1;return GCe(h),this.hot.populateFromArray(r,e,h,null,null,"spliceCol"),n}spliceRow(e,r,i){const s=this.hot.getSourceDataAtRow(e),n=s.slice(r,r+i),o=s.slice(r+i);for(var l=arguments.length,h=new Array(l>3?l-3:0),d=3;d<l;d++)h[d-3]=arguments[d];B9(h,o);let g=0;for(;g<i;)h.push(null),g+=1;return this.hot.populateFromArray(e,r,[h],null,null,"spliceRow"),n}spliceData(e,r,i){if(this.hot.runHooks("beforeDataSplice",e,r,i)!==!1){const n=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,n.forEach(o=>this.dataSource.push(o))}}filterData(e,r,i){let s=this.hot.runHooks("filterData",e,r,i);Array.isArray(s)===!1&&(s=this.dataSource.filter((n,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,r){const i=this.hot.toPhysicalRow(e);let s=this.dataSource[i];const n=this.hot.runHooks("modifyRowData",i);s=isNaN(n)?n:s;const{dataDotNotation:o}=this.hot.getSettings();let l=null;if(s&&s.hasOwnProperty&&gs(s,r))l=s[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let h=s;if(!h)return null;const d=r.split(".");for(let g=0,y=d.length;g<y;g++)if(h=h[d[g]],typeof h>"u")return null;l=h}else typeof r=="function"&&(l=r(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const h=tl(l);this.hot.runHooks("modifyData",i,this.propToCol(r),h,"get"),h.isTouched()&&(l=h.value)}return l}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,i){const s=this.hot.toPhysicalRow(e);let n=i,o=this.dataSource[s];const l=this.hot.runHooks("modifyRowData",s);if(o=isNaN(l)?l:o,this.hot.hasHook("modifyData")){const d=tl(n);this.hot.runHooks("modifyData",s,this.propToCol(r),d,"set"),d.isTouched()&&(n=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(o&&o.hasOwnProperty&&gs(o,r))o[r]=n;else if(h&&typeof r=="string"&&r.indexOf(".")>-1){let d=o,g=0,y;const C=r.split(".");for(g=0,y=C.length-1;g<y;g++)typeof d[C[g]]>"u"&&(d[C[g]]={}),d=d[C[g]];d[C[g]]=n}else typeof r=="function"?r(this.dataSource.slice(s,s+1)[0],n):o[r]=n}visualRowsToPhysical(e,r){const i=this.hot.countSourceRows(),s=[];let n=(i+e)%i,o=r,l;for(;n<i&&o;)l=this.hot.toPhysicalRow(n),s.push(l),o-=1,n+=1;return s}visualColumnsToPhysical(e,r){const i=this.hot.countCols(),s=[];let n=(i+e)%i,o=r;for(;n<i&&o;){const l=this.hot.toPhysicalColumn(n);s.push(l),o-=1,n+=1}return s}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Op.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,i){const s=[];let n,o,l;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const g=i===Op.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(h-1,0),Math.max(e.row,r.row)),C=Math.min(Math.max(d-1,0),Math.max(e.col,r.col));for(n=Math.min(e.row,r.row);n<=y;n++){l=[];const x=n>=0?this.hot.toPhysicalRow(n):n;for(o=Math.min(e.col,r.col);o<=C&&x!==null;o++)l.push(g.call(this,n,this.colToProp(o)));x!==null&&s.push(l)}return s}getText(e,r){return ly(this.getRange(e,r,Op.DESTINATION_RENDERER))}getCopyableText(e,r){return ly(this.getRange(e,r,Op.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:HRe,getItem:$Re,hasItem:sJ,getNames:CXe,getValues:SXe}=Vc("cellTypes");function BRe(t){if(!sJ(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return $Re(t)}function uc(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:i,validator:s}=e;r&&Wa(t,r),i&&El(t,i),s&&ap(t,s),HRe(t,e)}function VRe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!gs(e,t)}function X_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?BRe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Zr(e,(n,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Qr(i))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const s={};Zr(i,(n,o)=>{if(VRe(o,r)){var l;s[o]=n,(l=t._automaticallyAssignedMetaProps)===null||l===void 0||l.add(o)}}),vs(t,s)}function WRe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Xu(r,t);for(let i=0;i<e.length;i++)r.prototype[e[i]]=void 0;return r}function V2(t){return Number.isInteger(t)&&t>=0}function W2(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function tx(t){return t==null}const oJ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,i;for(e=0,r=this.countRows();e<r;e++)if(i=this.getDataAtCell(e,t),qi(i)===!1)return!1;return!0},isEmptyRow(t){let e,r,i,s;for(e=0,r=this.countCols();e<r;e++)if(i=this.getDataAtCell(t,e),qi(i)===!1)return typeof i=="object"?(s=this.getCellMeta(t,e),Gk(this.getSchema()[s.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function aV(t,e,r){return(e=jRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jRe(t){var e=URe(t,"string");return typeof e=="symbol"?e:e+""}function URe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zRe(){return class{}}class GRe{constructor(e){aV(this,"metaCtor",zRe()),aV(this,"meta",void 0),this.meta=this.metaCtor.prototype,vs(this.meta,oJ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;vs(this.meta,e),X_(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function YRe(t,e,r){return(e=KRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KRe(t){var e=XRe(t,"string");return typeof e=="symbol"?e:e+""}function XRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qRe{constructor(e){YRe(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){vs(this.meta,e),X_(this.meta,e,e)}}function rx(t,e,r){return(e=JRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JRe(t){var e=QRe(t,"string");return typeof e=="symbol"?e:e+""}function QRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZE{constructor(e){rx(this,"valueFactory",void 0),rx(this,"data",[]),rx(this,"index",[]),rx(this,"holes",new Set),this.valueFactory=e}obtain(e){W2(()=>V2(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let i;if(r>=0)i=this.data[r],i===void 0&&(i=this.valueFactory(e),this.data[r]=i);else if(i=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=i,this.index[e]=s}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;W2(()=>V2(e)||tx(e),"Expecting an unsigned number or null/undefined argument.");const i=[],s=this.data.length;for(let o=0;o<r;o++)i.push(s+o),this.data.push(void 0);const n=tx(e)?this.index.length:e;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;W2(()=>V2(e)||tx(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(tx(e)?this.index.length-r:e,r);for(let s=0;s<i.length;s++){const n=i[s];typeof n=="number"&&this.holes.add(n)}}size(){return this.data.length-this.holes.size}values(){return Rd(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const s=this._getKeyByStorageIndex(i);s!==-1&&e.push([s,this.data[i]])}let r=0;return{next:()=>{if(r<e.length){const i=e[r];return r+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function lV(t,e,r){return(e=ZRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZRe(t){var e=eAe(t,"string");return typeof e=="symbol"?e:e+""}function eAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tAe=["data","width"];class rAe{constructor(e){lV(this,"globalMeta",void 0),lV(this,"metas",new ZE(()=>this._createMeta())),this.globalMeta=e,this.metas=new ZE(()=>this._createMeta())}updateMeta(e,r){const i=this.getMeta(e);vs(i,r),X_(i,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return WRe(this.globalMeta.getMetaConstructor(),tAe).prototype}}function cV(t,e,r){return(e=nAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nAe(t){var e=iAe(t,"string");return typeof e=="symbol"?e:e+""}function iAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sAe{constructor(e){cV(this,"columnMeta",void 0),cV(this,"metas",new ZE(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,i){const s=this.getMeta(e,r);vs(s,i),X_(s,i)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,r)}getMeta(e,r,i){const s=this.metas.obtain(e).obtain(r);return i===void 0?s:s[i]}setMeta(e,r,i,s){var n;const o=this.metas.obtain(e).obtain(r);(n=o._automaticallyAssignedMetaProps)===null||n===void 0||n.delete(i),o[i]=s}removeMeta(e,r,i){const s=this.metas.obtain(e).obtain(r);delete s[i]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let i=0;i<r.length;i++)nr(r[i])&&e.push(...r[i].values());return e}getMetasAtRow(e){W2(()=>V2(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ZE(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class aJ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GRe(e),this.tableMeta=new qRe(this.globalMeta),this.columnMeta=new rAe(this.globalMeta),this.cellMeta=new sAe(this.columnMeta),i.forEach(s=>new s(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,i){let{visualRow:s,visualColumn:n}=i;const o=this.cellMeta.getMeta(e,r);return o.visualRow=s,o.visualCol=n,o.row=e,o.col=r,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,r,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,i)}setCellMeta(e,r,i,s){this.cellMeta.setMeta(e,r,i,s)}updateCellMeta(e,r,i){this.cellMeta.updateMeta(e,r,i)}removeCellMeta(e,r,i){this.cellMeta.removeMeta(e,r,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Xn(aJ,uo);function uV(t,e,r,i){const{hotInstance:s,dataMap:n,dataSource:o,internalSource:l,source:h,metaManager:d,firstRun:g}=i,y=Nc(l),C=s.getSettings();Array.isArray(C.dataSchema)?s.dataType="array":oi(C.dataSchema)?s.dataType="function":s.dataType="object",n&&n.destroy(),t=s.runHooks(`before${y}`,t,g,h);const x=new Op(s,t,d);if(e(x),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const _=x.getSchema();t=[];let E,R=0,I=0;for(R=0,I=C.startRows;R<I;R++)if((s.dataType==="object"||s.dataType==="function")&&C.dataSchema)E=sa(_),t.push(E);else if(s.dataType==="array")E=sa(_[0]),t.push(E);else{E=[];for(let F=0,D=C.startCols;F<D;F++)E.push(null);t.push(E)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(s.dataType="array"),C.data=t,x.dataSource=t,o.data=t,o.dataType=s.dataType,o.colToProp=x.colToProp.bind(x),o.propToCol=x.propToCol.bind(x),o.countCachedColumns=x.countCachedColumns.bind(x),r(x),s.runHooks(`after${y}`,t,g,h),g||(s.runHooks("afterChange",null,l),s.render()),s.getSettings().ariaTags&&Fr(s.rootElement,[DX(-1),N_(s.countCols()+(s.view?s.countRowHeaders():0))])}function hV(t,e,r){return(e=oAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oAe(t){var e=aAe(t,"string");return typeof e=="symbol"?e:e+""}function aAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lAe{constructor(e){hV(this,"metaManager",void 0),hV(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),qt.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:i,col:s}=e;if((r=this.metaSyncMemo.get(i))!==null&&r!==void 0&&r.has(s))return;const{visualRow:n,visualCol:o}=e,l=this.metaManager.hot,h=l.colToProp(o);e.prop=h,l.runHooks("beforeGetCellMeta",n,o,e);const d=gs(e,"type")?e.type:null;let g=oi(e.cells)?e.cells(i,s,h):null;if(d)if(g){var y;g.type=(y=g.type)!==null&&y!==void 0?y:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,s,g),l.runHooks("afterGetCellMeta",n,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(s)}}function cAe(t,e,r){uAe(t,e),e.set(t,r)}function uAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MO(t,e,r){return(e=hAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hAe(t){var e=fAe(t,"string");return typeof e=="symbol"?e:e+""}function fAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dAe(t,e){return t.get(gAe(t,e))}function gAe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fV=new WeakMap;class mAe{constructor(e){MO(this,"metaManager",void 0),MO(this,"usageTracker",new Set),MO(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),cAe(this,fV,(r,i,s)=>{if(!s)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:i,target:s,onChange:n}=e,o=typeof s=="string",l=o?s:r,h=`_${l}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[l],n?(this.installPropWatcher(r,h,n),o&&this.installPropWatcher(s,h,n)):i&&(this.installPropWatcher(r,h,dAe(fV,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,i){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(n){const o=!s.usageTracker.has(e);s.usageTracker.add(e),i.call(s,e,n,o),this[r]=n},enumerable:!0,configurable:!0})}}const lJ="gridDefault",$d="editorManager.handlingEditor",pAe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},vAe="hooksRefRegisterer",cJ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Te(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Zr(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};uf(cJ,"MIXIN_NAME",vAe,{writable:!1,enumerable:!1});function rc(t,e,r){return(e=wAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wAe(t){var e=yAe(t,"string");return typeof e=="symbol"?e:e+""}function yAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const CAe="base",Gi=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class N1{static get EDITOR_TYPE(){return CAe}constructor(e){rc(this,"hot",void 0),rc(this,"state",Gi.VIRGIN),rc(this,"_opened",!1),rc(this,"_fullEditMode",!1),rc(this,"_closeCallback",null),rc(this,"TD",null),rc(this,"row",null),rc(this,"col",null),rc(this,"prop",null),rc(this,"originalValue",null),rc(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,i,s,n,o){this.TD=s,this.row=e,this.col=r,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=this.isOpened()?this.state:Gi.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let i,s,n,o;if(r){const h=this.hot.getSelectedLast();i=Math.max(Math.min(h[0],h[2]),0),s=Math.max(Math.min(h[1],h[3]),0),n=Math.max(h[0],h[2]),o=Math.max(h[1],h[3])}else[i,s,n,o]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",i,s,!1,"meta");Array.isArray(l)&&([i,s]=l),this.hot.populateFromArray(i,s,e,n,o,"edit")}beginEditing(e,r){if(this.state!==Gi.VIRGIN)return;const i=this.hot,s=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),n=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Gi.EDITING,this.isInFullEditMode()){const h=typeof e=="string"?e:is(this.originalValue);this.setValue(h)}this.open(r),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),i.view.scrollViewport(i._createCellCoords(s,n))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,i){let s;if(i){const n=this._closeCallback;this._closeCallback=o=>{n&&n(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Gi.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Gi.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const n=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof n=="string"?String.prototype.trim.call(n||""):n]]:s=[[n]],this.state=Gi.WAITING,this.saveValue(s,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Gi.FINISHED,this.discardEditor(o)}):(this.state=Gi.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Gi.FINISHED,this.discardEditor()}discardEditor(e){this.state===Gi.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Gi.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Gi.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Gi.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:i,wtViewport:s}=this.hot.view._wt,n=this.hot.rootWindow,o=Ws(r),l=ns(r),h=Ws(this.hot.rootElement),d=ns(this.hot.rootElement),g=i.topOverlay.holder,y=i.inlineStartOverlay.holder,C=g!==n?g.scrollTop:0,x=y!==n?y.scrollLeft:0,_=n.innerWidth-h.left-d,{wtTable:E}=(e=i.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,R=E.name,I=["master","inline_start"].includes(R)?C:0,F=["master","top","bottom"].includes(R)?x:0,D=o.top===h.top?0:1;let U=o.top-h.top-D-I,X=0;this.hot.isRtl()?X=n.innerWidth-o.left-l-_-1+F:X=o.left-h.left-1-F,["top","top_inline_start_corner"].includes(R)&&(U+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(R)&&(X+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const te=this.hot.hasColHeaders(),Y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),oe=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),de=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(te&&Y<=0||Y===de)&&(U+=1),oe<=0&&(X+=1);const ye=s.rowsRenderCalculator.startPosition,Ee=s.columnsRenderCalculator.startPosition,ke=Math.abs(i.inlineStartOverlay.getScrollPosition()),nt=i.topOverlay.getScrollPosition(),at=so(this.hot.rootDocument);let Ze=r.offsetTop;if(["inline_start","master"].includes(R)&&(Ze+=ye-nt),["bottom","bottom_inline_start_corner"].includes(R)){const{wtViewport:we,wtTable:Ce}=i.bottomOverlay.clone;Ze+=we.getWorkspaceHeight()-Ce.getHeight()-at}let Xe=r.offsetLeft;this.hot.isRtl()?(Xe>=0?Xe=E.getWidth()-r.offsetLeft:Xe=Math.abs(Xe),Xe+=Ee-ke-l):["top","master","bottom"].includes(R)&&(Xe+=Ee-ke);const Pe=n.getComputedStyle(this.TD),Be=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Me=parseInt(Pe[Be],10)>0?0:1,A=parseInt(Pe.borderTopWidth,10)>0?0:1,O=ns(r)+Me,N=Ji(r)+A,H=PSe(g)?at:0,B=FSe(y)?at:0,K=this.hot.view.maximumVisibleElementWidth(Xe)-H+Me,Z=Math.max(this.hot.view.maximumVisibleElementHeight(Ze)-B+A,this.hot.view.getDefaultRowHeight());return{top:U,start:X,height:N,maxHeight:Z,width:O,maxWidth:K}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Xn(N1,cJ);const SAe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const i=t._getEditorManager(),s=i.getActiveEditor();s.isInFullEditMode()&&s.state===Gi.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},bAe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},xAe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},EAe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},TAe={name:"editorOpen",callback(t,e,r){const i=t._getEditorManager(),s=t.getSelectedRangeLast(),{highlight:n}=s;if(t.selection.isMultiple()&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),l=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-l.row,-l.col):t.selection.transformFocus(l.row,l.col);return}n.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),Bc(e))}};function _Ae(){return[pAe,SAe,bAe,xAe,EAe,TAe]}const RAe={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},AAe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(i!==null){const s=t._createCellCoords(i,e.col),n=e.row-t.getFirstFullyVisibleRow(),o=Math.min(s.row-n,t.countRows()-1);t.selection.setRangeEnd(s),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},OAe={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},IAe={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},PAe={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,i.col,e)}},FAe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(t.countRows()-1,-1),h=s.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,n.col))}}},MAe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),l=s.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(n.row,o))}}},kAe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),l=r.getNearestNotHiddenIndex(o,1),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},NAe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},DAe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},LAe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(0,1),h=s.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,n.col))}}},HAe={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,i.row,e)}},$Ae={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},BAe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(i!==null){const s=t._createCellCoords(i,e.col),n=e.row-t.getFirstFullyVisibleRow(),o=Math.max(s.row-n,0);t.selection.setRangeEnd(s),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function VAe(){return[RAe,AAe,OAe,IAe,PAe,FAe,MAe,kAe,NAe,DAe,LAe,HAe,$Ae,BAe]}const WAe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},jAe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+r;i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),t.selection.transformStart(s,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},UAe={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-s.row,-s.col):t.selection.transformStart(-s.row,-s.col)}},zAe={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(s.row,s.col):t.selection.transformStart(s.row,s.col)}},GAe={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},YAe={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},KAe={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},XAe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,s=parseInt(t.getSettings().fixedRowsBottom,10),n=r.getNearestNotHiddenIndex(t.countRows()-s-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(n,o))}},qAe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},JAe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),s=t.getSelectedRangeLast().highlight.row,n=r.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(s,n))}},QAe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,i=t.getSelectedRangeLast().highlight.row;let s=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);s===null&&(s=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,s))}},ZAe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:i}=t.getSelectedRangeLast().highlight;let s=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);s===null&&(s=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,s))}},e4e={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},t4e={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,s=parseInt(t.getSettings().fixedRowsTop,10),n=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(s,1),l=i.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(o,l))}},r4e={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},n4e={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=-(t.countVisibleRows()+r);i===-r?s=-1:i+s<r&&(s=-(i+r)),t.selection.transformStart(s,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function i4e(){return[WAe,jAe,UAe,zAe,GAe,YAe,KAe,XAe,qAe,JAe,QAe,ZAe,e4e,t4e,r4e,n4e]}const s4e={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},o4e={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,s=t.getLastFullyVisibleRow()+1,n=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,i),l=t._createCellCoords(s,n);if(!t._createCellRange(o,o,l).includes(e)&&(e.row>=0||e.col>=0)){const d={};if(e.col>=0){const g=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-g,0)}if(e.row>=0){const g=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-g,0)}t.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},a4e={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},l4e={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},c4e={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:i}=e[e.length-1].highlight.normalize(),s=t.getDataAtCell(r,i),n=new Map;for(let o=0;o<e.length;o++)e[o].forAll((l,h)=>{if(l>=0&&h>=0&&(l!==r||h!==i)){const{readOnly:d}=t.getCellMeta(l,h);d||n.set(`${l}x${h}`,[l,h,s])}});t.setDataAtCell(Array.from(n.values()))}},u4e=[..._Ae(),...VAe(),...i4e(),s4e,o4e,a4e,l4e,c4e];function uJ(t){const e={};return u4e.forEach(r=>{let{name:i,callback:s}=r;e[i]=function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return s(t,...o)}}),e}function h4e(t){const e=t.getShortcutManager().addContext("editor"),r=uJ(t),i={group:$d};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(s,n)=>r.editorCloseAndSaveByEnter(s,n)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(s,n)=>r.editorCloseAndSaveByEnter(s,n)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(s,n)=>r.editorCloseAndSave(s,n)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(s,n)=>r.editorCloseAndSaveByArrowKeys(s,n)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],i)}function f4e(t){const e=t.getShortcutManager().addContext("grid"),r=uJ(t),i={runOnlyIf:()=>{const{navigableHeaders:s}=t.getSettings();return nr(t.getSelected())&&(s||!s&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:lJ};e.addShortcuts([{keys:[["F2"]],callback:s=>r.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,n)=>r.editorOpen(s,n)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:$d,runOnlyIf:()=>nr(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var s;return!((s=t.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var s,n;return!((s=t.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())&&((n=t.getSelectedRangeLast())===null||n===void 0?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],i)}function d4e(t){[f4e,h4e].forEach(e=>e(t))}function g4e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,i=dV(t),s=dV(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(i),r.lastChild.after(s),{activate(){t._registerTimeout(()=>{i.tabIndex=0,s.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,s.tabIndex=-1},10)}}}function dV(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Fr(r,[Nu(),Dd()]),r}function m4e(t){const e=p4e(t);let r;const{activate:i,deactivate:s}=g4e(t,{onFocusFromTop(){var y;const C=(y=e(r))!==null&&y!==void 0?y:oF(t);C&&(t.runHooks("modifyFocusOnTabNavigation","from_above",C),t.selectCell(C.row,C.col)),t.listen()},onFocusFromBottom(){var y;const C=(y=e(r))!==null&&y!==void 0?y:aF(t);C&&(t.runHooks("modifyFocusOnTabNavigation","from_below",C),t.selectCell(C.row,C.col)),t.listen()}}),n={wrapped:!1,flipped:!1};let o=!0,l=!1,h=!1;t.addHook("afterListen",()=>s()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(y,C,x,_,E)=>{if(l&&(n.wrapped&&n.flipped||h)&&(h=!1,E.value=!0),o){var R;r=(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight}}),t.addHook("beforeRowWrap",(y,C,x)=>{n.wrapped=!0,n.flipped=x});function d(){n.wrapped=!1,n.flipped=!1,t.deselectCell(),t.unlisten()}const g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:lJ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{const{tabNavigation:y}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!y&&(o=!1),y||(h=!0)},position:"before"},{...g,callback:y=>{const{tabNavigation:C,autoWrapRow:x}=t.getSettings();if(l=!1,o=!0,!C||!t.selection.isSelected()||x&&n.wrapped&&n.flipped||!x&&n.wrapped)return x&&n.wrapped&&n.flipped&&(r=y.shiftKey?oF(t):aF(t)),d(),!1;y.preventDefault()},position:"after"}])}function oF(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:i}=t.getSettings();let s=i&&t.countColHeaders()>0?-t.countColHeaders():0,n=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return s===0&&(s=e.getVisualFromRenderableIndex(s)),n===0&&(n=r.getVisualFromRenderableIndex(n)),s===null||n===null?null:t._createCellCoords(s,n)}function aF(t){var e,r;const{rowIndexMapper:i,columnIndexMapper:s}=t,{navigableHeaders:n}=t.getSettings();let o=i.getRenderableIndexesLength()-1,l=s.getRenderableIndexesLength()-1;if(o<0){if(!n||t.countColHeaders()===0)return null;o=-1}if(l<0){if(!n||t.countColHeaders()===0)return null;l=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=s.getVisualFromRenderableIndex(l))!==null&&r!==void 0?r:l)}function p4e(t){return e=>{if(!e)return null;const r=oF(t),i=aF(t);return e.col<r.col&&(e.col=r.col),e.col>i.col&&(e.col=i.col),e.row<r.row&&(e.row=r.row),e.row>i.row&&(e.row=i.row),e}}function v4e(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function w4e(){return()=>{}}function y4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function C4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function S4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function b4e(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function x4e(t){return e=>{const r=t.selection.getSelectionSource(),{row:i,col:s}=e;if(i<0&&s>=0)t.scrollViewportTo({col:s});else if(s<0&&i>=0)t.scrollViewportTo({row:i});else{if(r==="mouse"&&(s===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:s})}}}function E4e(t){const{selection:e}=t;let r=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){r=!0},scrollTo(s){var n;if(r||i){r=!1;return}let o;e.isFocusSelectionChanged()?o=y4e(t):e.isSelectedByCorner()?o=w4e():e.isSelectedByRowHeader()?o=b4e(t):e.isSelectedByColumnHeader()?o=v4e(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=C4e(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=x4e(t):e.getSelectedRange().size()>1&&(o=S4e(t)),(n=o)===null||n===void 0||n(s)}}}const gV=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),nx=t=>t.map(e=>{const r=e.toLowerCase();return gV.has(r)?gV.get(r):r}).sort().join("+"),T4e=t=>t.split("+"),mV=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),kO=t=>{let{which:e,key:r}=t;if(mV.has(e))return mV.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:r.toLowerCase()},hJ=Symbol("shortcut-context");function fJ(t){return Qr(t)&&t.__kindOf===hJ}const _4e=t=>{const e=B_({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:h,callback:d,group:g,runOnlyIf:y=()=>!0,captureCtrl:C=!1,preventDefault:x=!0,stopPropagation:_=!1,relativeToGroup:E,position:R,forwardToContext:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_i(g))throw new Error("You need to define the shortcut's group.");if(oi(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(Ln`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const F={callback:d,group:g,runOnlyIf:y,captureCtrl:C,preventDefault:x,stopPropagation:_};nr(E)&&(F.relativeToGroup=E,F.position=R),fJ(I)&&(F.forwardToContext=I),h.forEach(D=>{const U=nx(D);if(e.hasItem(U)){const te=e.getItem(U);let Y=te.findIndex(oe=>oe.group===E);Y!==-1?R==="before"?Y-=1:Y+=1:Y=te.length,te.splice(Y,0,F)}else e.addItem(U,[F])})},i=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(g=>{Zr(d,(y,C)=>{Object.prototype.hasOwnProperty.call(g,C)===!1&&(g[C]=d[C])}),r(g)})},s=h=>{const d=nx(h);e.removeItem(d)};return{__kindOf:hJ,addShortcut:r,addShortcuts:i,getShortcuts:h=>{const d=nx(h),g=e.getItem(d);return nr(g)?g.slice():[]},hasShortcut:h=>{const d=nx(h);return e.hasItem(d)},removeShortcutsByKeys:s,removeShortcutsByGroup:h=>{e.getItems().forEach(g=>{let[y,C]=g;const x=C.filter(_=>_.group!==h);x.length===0?s(T4e(y)):(C.length=0,C.push(...x))})}}};function R4e(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const A4e=["meta","alt","shift","control"],Zv=R4e(),ew=[];let ix=0;function O4e(t,e,r,i,s){const n=x=>A4e.includes(x),o=function(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const E=[];return x.altKey&&E.push("alt"),_&&(x.ctrlKey||x.metaKey)?E.push("control/meta"):(x.ctrlKey&&E.push("control"),x.metaKey&&E.push("meta")),x.shiftKey&&E.push("shift"),E},l=x=>{if(e(x)===!1||r(x)===!1||x.keyCode===229||typeof x.key!="string"||J0(x))return;const E=kO(x);let R=[];n(E)||(R=o(x));const I=[E].concat(R);!s(x,I)&&(lB()&&R.includes("meta")||!lB()&&R.includes("control"))&&s(x,[E].concat(o(x,!0))),i(x)},h=x=>{if(typeof x.key=="string"){const _=kO(x);n(_)&&Zv.press(_)}},d=x=>{if(typeof x.key=="string"){const _=kO(x);n(_)&&Zv.release(_)}},g=()=>{Zv.releaseAll()};return{mount:()=>{let x=t;for(ix+=1;x;)ix===1&&(x.document.documentElement.addEventListener("keydown",h),ew.push({event:"keydown",listener:h}),x.document.documentElement.addEventListener("keyup",d),ew.push({event:"keyup",listener:d})),x.document.documentElement.addEventListener("keydown",l),x.document.documentElement.addEventListener("blur",g),x=a1(x)},unmount:()=>{let x=t;for(ix-=1;x;){if(ix===0){for(let _=0;_<ew.length;_++){const{event:E,listener:R}=ew[_];x.document.documentElement.removeEventListener(E,R)}ew.length=0}x.document.documentElement.removeEventListener("keydown",l),x.document.documentElement.removeEventListener("blur",g),x=a1(x)}},isPressed:x=>Zv.isPressed(x),releasePressedKeys:()=>Zv.releaseAll()}}const I4e=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:i,afterKeyDown:s}=t;const n=B_({errorIdExists:_=>`The "${_}" context name is already registered.`});let o="grid";const l=_=>{const E=_4e(_);return n.addItem(_,E),E},h=()=>o,d=_=>n.getItem(_),g=_=>{if(!n.hasItem(_))throw new Error(Ln`You've tried to activate the "${_}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=_};let y=!1;const C=function(_,E){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const I=fJ(R)?R:d(R);let F=!1;if(!I.hasShortcut(E))return F;const D=I.getShortcuts(E);for(let U=0;U<D.length;U++){const{callback:X,runOnlyIf:te,preventDefault:Y,stopPropagation:oe,captureCtrl:me,forwardToContext:de}=D[U];if(te(_)===!0){if(y=me,F=X(_,E)===!1,y=!1,Y&&_.preventDefault(),oe&&(Bc(_),_.stopPropagation()),F)break;de&&C(_,E,de)}}return F},x=O4e(e,r,i,s,C);return x.mount(),{addContext:l,getActiveContextName:h,getContext:d,setActiveContextName:g,isCtrlPressed:()=>!y&&(x.isPressed("control")||x.isPressed("meta")),releasePressedKeys:()=>x.releasePressedKeys(),destroy:()=>x.unmount()}};function pV(t){const{classNames:e}=ESe(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let NO=null;const DO=new Map;function dJ(t,e){var r,i=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=this;const o=new Dc(n);let l,h,d,g,y,C,x=!0;n_e(s)&&r_e(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const _=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",E=["rtl","ltr"].includes(_)?_:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!n.isRtl()},this.getDirectionFactor=function(){return n.isLtr()?1:-1},e.language=aRe(e.language);const R=new aJ(n,e,[lAe,mAe]),I=R.getTableMeta(),F=R.getGlobalMeta(),D=B_();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),B2(this)&&(qCe(e.licenseKey,t),ht(t,"ht-wrapper")),this.guid=`ht_${IX()}`,DO.set(this.guid,this),this.columnIndexMapper=new nF,this.rowIndexMapper=new nF,this.columnIndexMapper.addLocalHook("indexesSequenceChange",A=>{n.runHooks("afterColumnSequenceChange",A)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",A=>{n.runHooks("afterRowSequenceChange",A)}),h=new S_e(n),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const U=A=>{const{row:O,col:N}=A;return n._createCellCoords(O>=0?n.rowIndexMapper.getRenderableFromVisualIndex(O):O,N>=0?n.columnIndexMapper.getRenderableFromVisualIndex(N):N)},X=A=>{const{row:O,col:N}=A;return n._createCellCoords(O>=0?n.rowIndexMapper.getVisualFromRenderableIndex(O):O,N>=0?n.columnIndexMapper.getVisualFromRenderableIndex(N):N)},te=(A,O)=>{const N=O>A?1:-1,H=Math.min(A,O),B=Math.max(A,O),K=n.rowIndexMapper.getNearestNotHiddenIndex(A,N);return K===null||N===1&&K>B||N===-1&&K<H?null:K>=0?n.rowIndexMapper.getRenderableFromVisualIndex(K):K},Y=(A,O)=>{const N=O>A?1:-1,H=Math.min(A,O),B=Math.max(A,O),K=n.columnIndexMapper.getNearestNotHiddenIndex(A,N);return K===null||N===1&&K>B||N===-1&&K<H?null:K>=0?n.columnIndexMapper.getRenderableFromVisualIndex(K):K};let oe=new iJ(I,{rowIndexMapper:n.rowIndexMapper,columnIndexMapper:n.columnIndexMapper,countCols:()=>n.countCols(),countRows:()=>n.countRows(),propToCol:A=>l.propToCol(A),isEditorOpened:()=>n.getActiveEditor()?n.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>n.getShortcutManager(),createCellCoords:(A,O)=>n._createCellCoords(A,O),createCellRange:(A,O,N)=>n._createCellRange(A,O,N),visualToRenderableCoords:U,renderableToVisualCoords:X,findFirstNonHiddenRenderableRow:te,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(A,O)=>A<0||O<0?n.getSettings().disableVisualSelection:n.getCellMeta(A,O).disableVisualSelection});this.selection=oe;const me=A=>{let{hiddenIndexesChanged:O}=A;O&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",me),this.rowIndexMapper.addLocalHook("cacheUpdated",me),this.selection.addLocalHook("afterSetRangeEnd",(A,O)=>{const N=tl(!1),H=this.selection.getSelectedRange(),{from:B,to:K}=H.current(),Z=H.size()-1;this.runHooks("afterSelection",B.row,B.col,K.row,K.col,N,Z),this.runHooks("afterSelectionByProp",B.row,n.colToProp(B.col),K.row,n.colToProp(K.col),N,Z),O&&(!N.isTouched()||N.isTouched()&&!N.value)&&C.scrollTo(A);const we=oe.isSelectedByRowHeader(),Ce=oe.isSelectedByColumnHeader();we&&Ce?ht(this.rootElement,["ht__selection--rows","ht__selection--columns"]):we?(Ar(this.rootElement,"ht__selection--columns"),ht(this.rootElement,"ht__selection--rows")):Ce?(Ar(this.rootElement,"ht__selection--rows"),ht(this.rootElement,"ht__selection--columns")):Ar(this.rootElement,["ht__selection--rows","ht__selection--columns"]),oe.getSelectionSource()!=="shift"&&g.closeEditor(null),n.view.render(),g.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",A=>{this.runHooks("beforeSelectionFocusSet",A.row,A.col)}),this.selection.addLocalHook("afterSetFocus",A=>{const O=tl(!1);this.runHooks("afterSelectionFocusSet",A.row,A.col,O),(!O.isTouched()||O.isTouched()&&!O.value)&&C.scrollTo(A),g.closeEditor(),n.view.render(),g.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",A=>{const O=A.length-1,{from:N,to:H}=A[O];this.runHooks("afterSelectionEnd",N.row,N.col,H.row,H.col,O),this.runHooks("afterSelectionEndByProp",N.row,n.colToProp(N.col),H.row,n.colToProp(H.col),O)}),this.selection.addLocalHook("afterIsMultipleSelection",A=>{const O=this.runHooks("afterIsMultipleSelection",A.value);A.value&&(A.value=O)}),this.selection.addLocalHook("afterDeselect",()=>{g.closeEditor(),n.view.render(),Ar(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeSetRangeStart",...O)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeSetRangeStartOnly",...O)}).addLocalHook("beforeSetRangeEnd",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeSetRangeEnd",...O)}).addLocalHook("beforeSelectColumns",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeSelectColumns",...O)}).addLocalHook("afterSelectColumns",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("afterSelectColumns",...O)}).addLocalHook("beforeSelectRows",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeSelectRows",...O)}).addLocalHook("afterSelectRows",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("afterSelectRows",...O)}).addLocalHook("beforeModifyTransformStart",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("modifyTransformStart",...O)}).addLocalHook("afterModifyTransformStart",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("afterModifyTransformStart",...O)}).addLocalHook("beforeModifyTransformFocus",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("modifyTransformFocus",...O)}).addLocalHook("afterModifyTransformFocus",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("afterModifyTransformFocus",...O)}).addLocalHook("beforeModifyTransformEnd",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("modifyTransformEnd",...O)}).addLocalHook("afterModifyTransformEnd",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("afterModifyTransformEnd",...O)}).addLocalHook("beforeRowWrap",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeRowWrap",...O)}).addLocalHook("beforeColumnWrap",function(){for(var A=arguments.length,O=new Array(A),N=0;N<A;N++)O[N]=arguments[N];return i.runHooks("beforeColumnWrap",...O)}).addLocalHook("insertRowRequire",A=>this.alter("insert_row_above",A,1,"auto")).addLocalHook("insertColRequire",A=>this.alter("insert_col_start",A,1,"auto")),d={alter(A,O){var N,H;let B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,K=arguments.length>3?arguments[3]:void 0,Z=arguments.length>4?arguments[4]:void 0;const we=Ce=>{if(Ce.length===0)return[];const z=[...Ce];return z.sort((re,ve)=>{let[ce]=re,[Re]=ve;return ce===Re?0:ce>Re?1:-1}),la(z,(re,ve)=>{let[ce,Re]=ve;const Oe=re[re.length-1],[he,Ie]=Oe,De=he+Ie;if(ce<=De){const $e=Math.max(Re-(De-ce),0);Oe[1]+=$e}else re.push([ce,Re]);return re},[z[0]])};switch(A){case"insert_row_below":case"insert_row_above":const Ce=n.countSourceRows();if(I.maxRows===Ce)return;const z=A==="insert_row_below"?"below":"above";O=(N=O)!==null&&N!==void 0?N:z==="below"?Ce:0;const{delta:q,startPhysicalIndex:re}=l.createRow(O,B,{source:K,mode:z});oe.shiftRows(n.toVisualRow(re),q);break;case"insert_col_start":case"insert_col_end":const ve=A==="insert_col_end"?"end":"start";O=(H=O)!==null&&H!==void 0?H:ve==="end"?n.countSourceCols():0;const{delta:ce,startPhysicalIndex:Re}=l.createCol(O,B,{source:K,mode:ve});if(ce){if(Array.isArray(I.colHeaders)){const Ie=[n.toVisualColumn(Re),0];Ie.length+=ce,Array.prototype.splice.apply(I.colHeaders,Ie)}oe.shiftColumns(n.toVisualColumn(Re),ce)}break;case"remove_row":const Oe=Ie=>{let De=0;Te(Ie,$e=>{let[qe,Ft]=$e;const bt=qi(qe)?n.countRows()-1:Math.max(qe-De,0);if(Number.isInteger(qe)&&(qe=Math.max(qe-De,0)),!l.removeRow(qe,Ft,K))return;if(oe.isSelected()){const{row:er}=n.getSelectedRangeLast().highlight;er>=qe&&er<=qe+Ft-1&&g.closeEditor(!0)}const Lr=n.countRows();Lr===0?oe.deselect():K==="ContextMenu.removeRow"?oe.refresh():oe.shiftRows(qe,-Ft);const Or=I.fixedRowsTop;Or>=bt+1&&(I.fixedRowsTop-=Math.min(Ft,Or-bt));const sr=I.fixedRowsBottom;sr&&bt>=Lr-sr&&(I.fixedRowsBottom-=Math.min(Ft,sr)),De+=Ft})};Array.isArray(O)?Oe(we(O)):Oe([[O,B]]);break;case"remove_col":const he=Ie=>{let De=0;Te(Ie,$e=>{let[qe,Ft]=$e;const bt=qi(qe)?n.countCols()-1:Math.max(qe-De,0);let Gt=n.toPhysicalColumn(bt);if(Number.isInteger(qe)&&(qe=Math.max(qe-De,0)),!l.removeCol(qe,Ft,K))return;if(oe.isSelected()){const{col:er}=n.getSelectedRangeLast().highlight;er>=qe&&er<=qe+Ft-1&&g.closeEditor(!0)}n.countCols()===0?oe.deselect():K==="ContextMenu.removeColumn"?oe.refresh():oe.shiftColumns(qe,-Ft);const sr=I.fixedColumnsStart;sr>=bt+1&&(I.fixedColumnsStart-=Math.min(Ft,sr-bt)),Array.isArray(I.colHeaders)&&(typeof Gt>"u"&&(Gt=-1),I.colHeaders.splice(Gt,Ft)),De+=Ft})};Array.isArray(O)?he(we(O)):he([[O,B]]);break;default:throw new Error(`There is no such action "${A}"`)}n.view.render(),Z||d.adjustRowsAndCols()},adjustRowsAndCols(){const A=I.minRows,O=I.minSpareRows,N=I.minCols,H=I.minSpareCols;if(A){const B=n.countRows();B<A&&l.createRow(B,A-B,{source:"auto"})}if(O){const B=n.countEmptyRows(!0);if(B<O){const K=O-B,Z=Math.min(K,I.maxRows-n.countSourceRows());l.createRow(n.countRows(),Z,{source:"auto"})}}{let B;(N||H)&&(B=n.countEmptyCols(!0));let K=n.countCols();if(N&&!I.columns&&K<N){const Z=N-K;B+=Z,l.createCol(K,Z,{source:"auto"})}if(H&&!I.columns&&n.dataType==="array"&&B<H){K=n.countCols();const Z=H-B,we=Math.min(Z,I.maxCols-K);l.createCol(K,we,{source:"auto"})}}n.view&&n.view.adjustElementsSize()},populateFromArray(A,O,N,H,B){let K,Z,we,Ce;const z=[],q={},re=[],ve=A.row,ce=A.col;if(Z=O.length,Z===0)return!1;let Re=0,Oe=0;switch(Qr(N)&&(Re=N.col-ce+1,Oe=N.row-ve+1),B){case"shift_down":const he=H2(O),Ie=he.length,De=Math.max(Ie,Re),$e=n.getData().slice(ve),qe=H2($e).slice(ce,ce+De);for(we=0;we<De;we+=1)if(we<Ie){for(K=0,Z=he[we].length;K<Oe-Z;K+=1)he[we].push(he[we][K%Z]);we<qe.length?re.push(he[we].concat(qe[we])):re.push(he[we].concat(new Array($e.length).fill(null)))}else re.push(he[we%Ie].concat(qe[we]));n.populateFromArray(ve,ce,H2(re));break;case"shift_right":const Ft=O.length,bt=Math.max(Ft,Oe),Gt=n.getData().slice(ve).map(ot=>ot.slice(ce));for(K=0;K<bt;K+=1)if(K<Ft){for(we=0,Ce=O[K].length;we<Re-Ce;we+=1)O[K].push(O[K][we%Ce]);if(K<Gt.length)for(let ot=0;ot<Gt[K].length;ot+=1)O[K].push(Gt[K][ot]);else O[K].push(...new Array(Gt[0].length).fill(null))}else O.push(O[K%Z].slice(0,bt).concat(Gt[K]));n.populateFromArray(ve,ce,O);break;case"overwrite":default:q.row=A.row,q.col=A.col;let Lr=0,Or=0,sr=!0,er;const Hn=function(ft){let Nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const vr=O[ft%O.length];return Nt!==null?vr[Nt%vr.length]:vr},Si=O.length,et=N?N.row-A.row+1:0;for(N?Z=et:Z=Math.max(Si,et),K=0;K<Z&&!(N&&q.row>N.row&&et>Si||!I.allowInsertRow&&q.row>n.countRows()-1||q.row>=I.maxRows);K++){const ot=K-Lr,ft=Hn(ot).length,Nt=N?N.col-A.col+1:0;if(N?Ce=Nt:Ce=Math.max(ft,Nt),q.col=A.col,er=n.getCellMeta(q.row,q.col),(H==="CopyPaste.paste"||H==="Autofill.fill")&&er.skipRowOnPaste){Lr+=1,q.row+=1,Z+=1;continue}for(Or=0,we=0;we<Ce&&!(N&&q.col>N.col&&Nt>ft||!I.allowInsertColumn&&q.col>n.countCols()-1||q.col>=I.maxCols);we++){if(er=n.getCellMeta(q.row,q.col),(H==="CopyPaste.paste"||H==="Autofill.fill")&&er.skipColumnOnPaste){Or+=1,q.col+=1,Ce+=1;continue}if(er.readOnly&&H!=="UndoRedo.undo"){q.col+=1;continue}const vr=we-Or;let cr=Hn(ot,vr),Tr=n.getDataAtCell(q.row,q.col);if(cr!==null&&typeof cr=="object")if(Array.isArray(cr)&&Tr===null&&(Tr=[]),Tr===null||typeof Tr!="object")sr=!1;else{const li=rC(Array.isArray(Tr)?Tr:Tr[0]||Tr),ho=rC(Array.isArray(cr)?cr:cr[0]||cr);Gk(li,ho)||Array.isArray(li)&&Array.isArray(ho)?cr=sa(cr):sr=!1}else Tr!==null&&typeof Tr=="object"&&(sr=!1);sr&&z.push([q.row,q.col,cr]),sr=!0,q.col+=1}q.row+=1}n.setDataAtCell(z,null,null,H||"populateFromArray");break}}};function de(A){const O=Gq(A);zD(O)?(n.runHooks("beforeLanguageChange",O),F.language=O,n.runHooks("afterLanguageChange",O)):Yq(A)}function ye(A,O){const N=A==="className"?n.rootElement:n.table;if(x)ht(N,O);else{let H=[],B=[];F[A]&&(H=Array.isArray(F[A])?F[A]:W9(F[A])),O&&(B=Array.isArray(O)?O:W9(O));const K=V9(H,B),Z=V9(B,H);K.length&&Ar(N,K),Z.length&&ht(N,Z)}F[A]=O}this.init=function(){h.setData(I.data),n.runHooks("beforeInit"),(sd()||sq())&&ht(n.rootElement,"mobile"),this.updateSettings(I,!0),this.view=new a_e(this);const A=I.themeName||pV(n.rootElement);n.useTheme(A),n.view.addClassNameToLicenseElement(n.getCurrentThemeName()),g=QP.getInstance(n,I,oe),C=E4e(n),y=new Qbe(n),B2(this)&&m4e(n),n.runHooks("init"),this.forceFullRender=!0,this.view.render(),x&&n.rootElement.offsetParent===null&&MSe(n.rootElement,()=>{n.view._wt.wtOverlays.updateLastSpreaderSize(),n.render(),n.view.adjustElementsSize()}),typeof x=="object"&&(n.runHooks("afterChange",x[0],x[1]),x=!1),n.runHooks("afterInit")};function Ee(){let A=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,A=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&A===!1&&(A=!0,this.onQueueEmpty(this.valid))}}}function ke(A){const O=A.replace(",",".");return isNaN(parseFloat(O))===!1?parseFloat(O):A}function nt(A,O,N){if(!A.length){N();return}const H=n.getActiveEditor(),B=new Ee;let K=!0;B.onQueueEmpty=()=>{H&&K&&H.cancelChanges(),N()};for(let Z=A.length-1;Z>=0;Z--){const[we,Ce,,z]=A[Z],q=l.propToCol(Ce);let re;Number.isInteger(q)?re=n.getCellMeta(we,q):re={...Object.getPrototypeOf(I),...I},re.type==="numeric"&&typeof z=="string"&&Bxe(z)&&(A[Z][3]=ke(z)),n.getCellValidator(re)&&(B.addValidatorToQueue(),n.validateCell(A[Z][3],re,function(ve,ce){return function(Re){if(typeof Re!="boolean")throw new Error("Validation error: result is not boolean");Re===!1&&ce.allowInvalid===!1&&(K=!1,A.splice(ve,1),ce.valid=!0),B.removeValidatorFormQueue()}}(Z,re),O))}B.checkIfQueueIsEmpty()}function at(A,O){for(let H=A.length-1;H>=0;H--){let B=!1;if(A[H]===null){A.splice(H,1);continue}if(!((A[H][2]===null||A[H][2]===void 0)&&(A[H][3]===null||A[H][3]===void 0))){if(I.allowInsertRow)for(;A[H][0]>n.countRows()-1;){const{delta:K}=l.createRow(void 0,void 0,{source:O});if(K===0){B=!0;break}}if(n.dataType==="array"&&(!I.columns||I.columns.length===0)&&I.allowInsertColumn)for(;l.propToCol(A[H][1])>n.countCols()-1;){const{delta:K}=l.createCol(void 0,void 0,{source:O});if(K===0){B=!0;break}}B||l.set(A[H][0],A[H][1],A[H][3])}}const N=A.length>0;if(n.forceFullRender=!0,N){d.adjustRowsAndCols(),n.runHooks("beforeChangeRender",A,O),g.closeEditor(),n.view.render(),g.prepareEditor(),n.view.adjustElementsSize(),n.runHooks("afterChange",A,O||"edit");const H=n.getActiveEditor();H&&nr(H.refreshValue)&&H.refreshValue()}else n.view.render()}this._createCellCoords=function(A,O){return n.view._wt.createCellCoords(A,O)},this._createCellRange=function(A,O,N){return n.view._wt.createCellRange(A,O,N)},this.validateCell=function(A,O,N,H){let B=n.getCellValidator(O);function K(Z){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||O.hidden===!0){N(Z);return}const Ce=O.visualCol,z=O.visualRow,q=n.getCell(z,Ce,!0);if(q&&q.nodeName!=="TH"){const re=n.rowIndexMapper.getRenderableFromVisualIndex(z),ve=n.columnIndexMapper.getRenderableFromVisualIndex(Ce);n.view._wt.getSetting("cellRenderer",re,ve,q)}N(Z)}YCe(B)&&(B=function(Z){return function(we,Ce){Ce(Z.test(we))}}(B)),oi(B)?(A=n.runHooks("beforeValidate",A,O.visualRow,O.prop,H),n._registerImmediate(()=>{B.call(O,A,Z=>{n&&(Z=n.runHooks("afterValidate",Z,A,O.visualRow,O.prop,H),O.valid=Z,K(Z),n.runHooks("postAfterValidate",Z,A,O.visualRow,O.prop,H))})})):n._registerImmediate(()=>{O.valid=!0,K(O.valid,!1)})};function Ze(A,O,N){return Array.isArray(A)?A:[[A,O,N]]}function Xe(A,O){const N=n.getActiveEditor(),H=n.runHooks("beforeChange",A,O||"edit"),B=A.filter(K=>K!==null);return H===!1||B.length===0?(N&&N.cancelChanges(),[]):B}this.setDataAtCell=function(A,O,N,H){const B=Ze(A,O,N),K=[];let Z=H,we,Ce,z;for(we=0,Ce=B.length;we<Ce;we++){if(typeof B[we]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof B[we][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");B[we][1]>=this.countCols()?z=B[we][1]:z=l.colToProp(B[we][1]),K.push([B[we][0],z,h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]])}!Z&&typeof A=="object"&&(Z=O);const q=Xe(K,Z);n.runHooks("afterSetDataAtCell",q,Z),nt(q,Z,()=>{at(q,Z)})},this.setDataAtRowProp=function(A,O,N,H){const B=Ze(A,O,N),K=[];let Z=H,we,Ce;for(we=0,Ce=B.length;we<Ce;we++)K.push([B[we][0],B[we][1],h.getAtCell(this.toPhysicalRow(B[we][0]),B[we][1]),B[we][2]]);!Z&&typeof A=="object"&&(Z=O);const z=Xe(K,H);n.runHooks("afterSetDataAtRowProp",z,Z),nt(z,Z,()=>{at(z,Z)})},this.listen=function(){n&&!n.isListening()&&(DO.forEach(A=>{n!==A&&A.unlisten()}),NO=n.guid,n.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(NO=null,n.runHooks("afterUnlisten"))},this.isListening=function(){return NO===n.guid},this.destroyEditor=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.closeEditor(A),n.view.render(),O&&oe.isSelected()&&g.prepareEditor()},this.populateFromArray=function(A,O,N,H,B,K,Z){if(!(typeof N=="object"&&typeof N[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const we=typeof H=="number"?n._createCellCoords(H,B):null;return d.populateFromArray(n._createCellCoords(A,O),N,we,K,Z)},this.spliceCol=function(A,O,N){for(var H=arguments.length,B=new Array(H>3?H-3:0),K=3;K<H;K++)B[K-3]=arguments[K];return l.spliceCol(A,O,N,...B)},this.spliceRow=function(A,O,N){for(var H=arguments.length,B=new Array(H>3?H-3:0),K=3;K<H;K++)B[K-3]=arguments[K];return l.spliceRow(A,O,N,...B)},this.getSelected=function(){if(oe.isSelected())return on(oe.getSelectedRange(),A=>{let{from:O,to:N}=A;return[O.row,O.col,N.row,N.col]})},this.getSelectedLast=function(){const A=this.getSelected();let O;return A&&A.length>0&&(O=A[A.length-1]),O},this.getSelectedRange=function(){if(oe.isSelected())return Array.from(oe.getSelectedRange())},this.getSelectedRangeLast=function(){const A=this.getSelectedRange();let O;return A&&A.length>0&&(O=A[A.length-1]),O},this.emptySelectedCells=function(A){if(!oe.isSelected()||this.countRows()===0||this.countCols()===0)return;const O=[];Te(oe.getSelectedRange(),N=>{if(N.isSingleHeader())return;const H=N.getTopStartCorner(),B=N.getBottomEndCorner();pr(H.row,B.row,K=>{pr(H.col,B.col,Z=>{this.getCellMeta(K,Z).readOnly||O.push([K,Z,null])})})}),O.length>0&&this.setDataAtCell(O,A)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const A=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(A,0),!this.isRenderSuspended()&&A===this.renderSuspendedCounter&&(this.renderCall?this.render():n.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||n.view.render())},this.batchRender=function(A){this.suspendRender();const O=A();return this.resumeRender(),O},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const O=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(O,0),(!this.isExecutionSuspended()&&O===this.executionSuspendedCounter||A)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const N=A();return this.resumeExecution(O),N},this.batch=function(A){this.suspendRender(),this.suspendExecution();const O=A();return this.resumeExecution(),this.resumeRender(),O},this.refreshDimensions=function(){if(!n.view)return;const{width:A,height:O}=n.view.getLastSize(),{width:N,height:H}=n.rootElement.getBoundingClientRect(),B=N!==A||H!==O;n.runHooks("beforeRefreshDimensions",{width:A,height:O},{width:N,height:H},B)!==!1&&((B||n.view._wt.wtOverlays.scrollableElement===n.rootWindow)&&(n.view.setLastSize(N,H),n.render()),n.runHooks("afterRefreshDimensions",{width:A,height:O},{width:N,height:H},B))},this.updateData=function(A,O){uV(A,N=>{l=N},N=>{l=N,n.columnIndexMapper.fitToLength(this.getInitialColumnCount()),n.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),oe.refresh()},{hotInstance:n,dataMap:l,dataSource:h,internalSource:"updateData",source:O,metaManager:R,firstRun:x})},this.loadData=function(A,O){uV(A,N=>{l=N},()=>{R.clearCellsCache(),n.initIndexMappers(),d.adjustRowsAndCols(),oe.refresh(),x&&(x=[null,"loadData"])},{hotInstance:n,dataMap:l,dataSource:h,internalSource:"loadData",source:O,metaManager:R,firstRun:x})},this.getInitialColumnCount=function(){const A=I.columns;let O=0;if(Array.isArray(A))O=A.length;else if(oi(A))if(n.dataType==="array"){const N=this.countSourceCols();for(let H=0;H<N;H+=1)A(H)&&(O+=1)}else(n.dataType==="object"||n.dataType==="function")&&(O=l.colToPropCache.length);else if(nr(I.dataSchema)){const N=l.getSchema();O=Array.isArray(N)?N.length:Yk(N)}else O=this.countSourceCols();return O},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(A,O,N,H){return _i(A)?l.getAll():l.getRange(n._createCellCoords(A,O),n._createCellCoords(N,H),l.DESTINATION_RENDERER)},this.getCopyableText=function(A,O,N,H){return l.getCopyableText(n._createCellCoords(A,O),n._createCellCoords(N,H))},this.getCopyableData=function(A,O){return l.getCopyable(A,l.colToProp(O))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const N=(x?n.loadData:n.updateData).bind(this);let H=!1,B,K;if(nr(A.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(nr(A.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(nr(A.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(B in A)B==="data"||(B==="language"?de(A.language):B==="className"?ye("className",A.className):B==="tableClassName"&&n.table?(ye("tableClassName",A.tableClassName),n.view._wt.wtOverlays.syncOverlayTableClassNames()):qt.getSingleton().isRegistered(B)||qt.getSingleton().isDeprecated(B)?oi(A[B])?qt.getSingleton().addAsFixed(B,A[B],n):Array.isArray(A[B])&&qt.getSingleton().add(B,A[B],n):!O&&gs(A,B)&&(F[B]=A[B]));A.data===void 0&&I.data===void 0?N(null,"updateSettings"):A.data!==void 0?N(A.data,"updateSettings"):A.columns!==void 0&&(l.createMap(),n.initIndexMappers());const Z=n.countCols(),we=I.columns;if(we&&oi(we)&&(H=!0),(A.cell!==void 0||A.cells!==void 0||A.columns!==void 0)&&R.clearCache(),Z>0)for(B=0,K=0;B<Z;B++){if(we){const q=H?we(B):we[K];q&&R.updateColumnMeta(K,q)}K+=1}nr(A.cell)&&Zr(A.cell,q=>{n.setCellMetaObject(q.row,q.col,q)}),n.runHooks("afterCellMetaReset");let Ce=n.rootElement.style.height;Ce!==""&&(Ce=parseInt(n.rootElement.style.height,10));let z=A.height;if(oi(z)&&(z=z()),O&&n.rootElement.getAttribute("style")&&n.rootElement.setAttribute("data-initialstyle",n.rootElement.getAttribute("style")),z===null){const q=n.rootElement.getAttribute("data-initialstyle");q&&(q.indexOf("height")>-1||q.indexOf("overflow")>-1)?n.rootElement.setAttribute("style",q):(n.rootElement.style.height="",n.rootElement.style.overflow="")}else z!==void 0&&(n.rootElement.style.height=isNaN(z)?`${z}`:`${z}px`,n.rootElement.style.overflow="hidden");if(typeof A.width<"u"){let q=A.width;oi(q)&&(q=q()),n.rootElement.style.width=isNaN(q)?`${q}`:`${q}px`}if(!O){if(n.view){n.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),n.view._wt.exportSettingsAsClassNames();const q=n.getCurrentThemeName(),re=gs(A,"themeName");q&&re&&(n.view.getStylesHandler().removeClassNames(),n.view.removeClassNameFromLicenseElement(q));const ve=re&&A.themeName||pV(n.rootElement);n.useTheme(ve),n.view.addClassNameToLicenseElement(n.getCurrentThemeName())}n.runHooks("afterUpdateSettings",A)}d.adjustRowsAndCols(),n.view&&!x&&(n.forceFullRender=!0,n.view.render(),n.view._wt.wtOverlays.adjustElementsSize()),!O&&n.view&&(Ce===""||z===""||z===void 0)&&Ce!==z&&n.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const A=n.getSelectedLast();if(I.getValue){if(oi(I.getValue))return I.getValue.call(n);if(A)return n.getData()[A[0][0]][I.getValue]}else if(A)return n.getDataAtCell(A[0],A[1])},this.getSettings=function(){return I},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(A,O,N,H,B){d.alter(A,O,N,H,B)},this.getCell=function(A,O){let N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,H=O,B=A;if(O>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(O)))return null;H=this.columnIndexMapper.getRenderableFromVisualIndex(O)}if(A>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(A)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(A)}return B===null||H===null||B===void 0||H===void 0?null:n.view.getCellAtCoords(n._createCellCoords(B,H),N)},this.getCoords=function(A){const O=this.view._wt.wtTable.getCoords(A);if(O===null)return null;const{row:N,col:H}=O;let B=N,K=H;return N>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(N)),H>=0&&(K=this.columnIndexMapper.getVisualFromRenderableIndex(H)),n._createCellCoords(B,K)},this.colToProp=function(A){return l.colToProp(A)},this.propToCol=function(A){return l.propToCol(A)},this.toVisualRow=A=>this.rowIndexMapper.getVisualFromPhysicalIndex(A),this.toVisualColumn=A=>this.columnIndexMapper.getVisualFromPhysicalIndex(A),this.toPhysicalRow=A=>this.rowIndexMapper.getPhysicalFromVisualIndex(A),this.toPhysicalColumn=A=>this.columnIndexMapper.getPhysicalFromVisualIndex(A),this.getDataAtCell=function(A,O){return l.get(A,l.colToProp(O))},this.getDataAtRowProp=function(A,O){return l.get(A,O)},this.getDataAtCol=function(A){const O=[],N=l.getRange(n._createCellCoords(0,A),n._createCellCoords(I.data.length-1,A),l.DESTINATION_RENDERER);for(let H=0;H<N.length;H+=1)for(let B=0;B<N[H].length;B+=1)O.push(N[H][B]);return O},this.getDataAtProp=function(A){const O=[],N=l.getRange(n._createCellCoords(0,l.propToCol(A)),n._createCellCoords(I.data.length-1,l.propToCol(A)),l.DESTINATION_RENDERER);for(let H=0;H<N.length;H+=1)for(let B=0;B<N[H].length;B+=1)O.push(N[H][B]);return O},this.getSourceData=function(A,O,N,H){let B;return A===void 0?B=h.getData():B=h.getByRange(n._createCellCoords(A,O),n._createCellCoords(N,H)),B},this.getSourceDataArray=function(A,O,N,H){let B;return A===void 0?B=h.getData(!0):B=h.getByRange(n._createCellCoords(A,O),n._createCellCoords(N,H),!0),B},this.getSourceDataAtCol=function(A){return h.getAtColumn(A)},this.setSourceDataAtCell=function(A,O,N,H){const B=Ze(A,O,N),K=this.hasHook("afterSetSourceDataAtCell"),Z=[];K&&Te(B,Ce=>{let[z,q,re]=Ce;Z.push([z,q,h.getAtCell(z,q),re])}),Te(B,Ce=>{let[z,q,re]=Ce;h.setAtCell(z,q,re)}),K&&this.runHooks("afterSetSourceDataAtCell",Z,H),this.render();const we=n.getActiveEditor();we&&nr(we.refreshValue)&&we.refreshValue()},this.getSourceDataAtRow=function(A){return h.getAtRow(A)},this.getSourceDataAtCell=function(A,O){return h.getAtCell(A,O)},this.getDataAtRow=function(A){return l.getRange(n._createCellCoords(A,0),n._createCellCoords(A,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(A,O,N,H){const B=A===void 0?[0,0,this.countRows(),this.countCols()]:[A,O,N,H],[K,Z]=B;let[,,we,Ce]=B,z=null,q=null;we===void 0&&(we=K),Ce===void 0&&(Ce=Z);let re="mixed";return pr(Math.max(Math.min(K,we),0),Math.max(K,we),ve=>{let ce=!0;return pr(Math.max(Math.min(Z,Ce),0),Math.max(Z,Ce),Re=>(q=this.getCellMeta(ve,Re).type,z?ce=z===q:z=q,ce)),re=ce?q:"mixed",ce}),re},this.removeCellMeta=function(A,O,N){const[H,B]=[this.toPhysicalRow(A),this.toPhysicalColumn(O)];let K=R.getCellMetaKeyValue(H,B,N);n.runHooks("beforeRemoveCellMeta",A,O,N,K)!==!1&&(R.removeCellMeta(H,B,N),n.runHooks("afterRemoveCellMeta",A,O,N,K)),K=null},this.spliceCellsMeta=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var N=arguments.length,H=new Array(N>2?N-2:0),B=2;B<N;B++)H[B-2]=arguments[B];if(H.length>0&&!Array.isArray(H[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");O>0&&R.removeRow(this.toPhysicalRow(A),O),H.length>0&&Te(H.reverse(),K=>{R.createRow(this.toPhysicalRow(A)),Te(K,(Z,we)=>this.setCellMetaObject(A,we,Z))}),n.render()},this.setCellMetaObject=function(A,O,N){typeof N=="object"&&Zr(N,(H,B)=>{this.setCellMeta(A,O,B,H)})},this.setCellMeta=function(A,O,N,H){if(n.runHooks("beforeSetCellMeta",A,O,N,H)===!1)return;let K=A,Z=O;A<this.countRows()&&(K=this.toPhysicalRow(A)),O<this.countCols()&&(Z=this.toPhysicalColumn(O)),R.setCellMeta(K,Z,N,H),n.runHooks("afterSetCellMeta",A,O,N,H)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(A,O){let N=this.toPhysicalRow(A),H=this.toPhysicalColumn(O);return N===null&&(N=A),H===null&&(H=O),R.getCellMeta(N,H,{visualRow:A,visualColumn:O})},this.getColumnMeta=function(A){return R.getColumnMeta(this.toPhysicalColumn(A))},this.getCellMetaAtRow=function(A){return R.getCellsMetaAtRow(A)},this.isColumnModificationAllowed=function(){return!(n.dataType==="object"||I.columns)},this.getCellRenderer=function(A,O){const N=typeof A=="number"?n.getCellMeta(A,O).renderer:A.renderer;return typeof N=="string"?tF(N):_i(N)?tF("text"):N},this.getCellEditor=function(A,O){const N=typeof A=="number"?n.getCellMeta(A,O).editor:A.editor;return typeof N=="string"?JP(N):_i(N)?JP("text"):N},this.getCellValidator=function(A,O){const N=typeof A=="number"?n.getCellMeta(A,O).validator:A.validator;return typeof N=="string"?n2e(N):N},this.validateCells=function(A){this._validateCells(A)},this.validateRows=function(A,O){if(!Array.isArray(A))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(O,A)},this.validateColumns=function(A,O){if(!Array.isArray(A))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(O,void 0,A)},this._validateCells=function(A,O,N){const H=new Ee;A&&(H.onQueueEmpty=A);let B=n.countRows()-1;for(;B>=0;){if(O!==void 0&&O.indexOf(B)===-1){B-=1;continue}let K=n.countCols()-1;for(;K>=0;){if(N!==void 0&&N.indexOf(K)===-1){K-=1;continue}H.addValidatorToQueue(),n.validateCell(n.getDataAtCell(B,K),n.getCellMeta(B,K),Z=>{if(typeof Z!="boolean")throw new Error("Validation error: result is not boolean");Z===!1&&(H.valid=!1),H.removeValidatorFormQueue()},"validateCells"),K-=1}B-=1}H.checkIfQueueIsEmpty()},this.getRowHeader=function(A){let O=I.rowHeaders,N=A;return N!==void 0&&(N=n.runHooks("modifyRowHeader",N)),N===void 0?(O=[],pr(n.countRows()-1,H=>{O.push(n.getRowHeader(H))})):Array.isArray(O)&&O[N]!==void 0?O=O[N]:oi(O)?O=O(N):O&&typeof O!="string"&&typeof O!="number"&&(O=N+1),O},this.hasRowHeaders=function(){return!!I.rowHeaders},this.hasColHeaders=function(){if(I.colHeaders!==void 0&&I.colHeaders!==null)return!!I.colHeaders;for(let A=0,O=n.countCols();A<O;A++)if(n.getColHeader(A))return!0;return!1},this.getColHeader=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const N=n.runHooks("modifyColHeader",A);if(N===void 0){const we=[],Ce=n.countCols();for(let z=0;z<Ce;z++)we.push(n.getColHeader(z));return we}let H=I.colHeaders;const B=function(we){const Ce=[],z=n.countCols();let q=0;for(;q<z;q++)oi(I.columns)&&I.columns(q)&&Ce.push(q);return Ce[we]},K=n.toPhysicalColumn(N),Z=B(K);return I.colHeaders===!1?H=null:I.columns&&oi(I.columns)&&I.columns(Z)&&I.columns(Z).title?H=I.columns(Z).title:I.columns&&I.columns[K]&&I.columns[K].title?H=I.columns[K].title:Array.isArray(I.colHeaders)&&I.colHeaders[K]!==void 0?H=I.colHeaders[K]:oi(I.colHeaders)?H=I.colHeaders(K):I.colHeaders&&typeof I.colHeaders!="string"&&typeof I.colHeaders!="number"&&(H=p_e(N)),H=n.runHooks("modifyColumnHeaderValue",H,A,O),H},this._getColWidthFromSettings=function(A){let O;if(A>=0&&(O=n.getCellMeta(0,A).width),(O===void 0||O===I.width)&&(O=I.colWidths),O!=null){switch(typeof O){case"object":O=O[A];break;case"function":O=O(A);break}typeof O=="string"&&(O=parseInt(O,10))}return O},this.getColWidth=function(A,O){let N=n._getColWidthFromSettings(A);return N=n.runHooks("modifyColWidth",N,A,O),N===void 0&&(N=u1),N},this._getRowHeightFromSettings=function(A){let O=I.rowHeights;if(O!=null){switch(typeof O){case"object":O=O[A];break;case"function":O=O(A);break}typeof O=="string"&&(O=parseInt(O,10))}return O},this.getRowHeight=function(A,O){let N=n._getRowHeightFromSettings(A);return N=n.runHooks("modifyRowHeight",N,A,O),N},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const A=I.maxCols,O=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(A,O)},this.countRenderedRows=function(){return n.view._wt.drawn?n.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return n.view._wt.drawn?n.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return n.view._wt.drawn?n.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return n.view._wt.drawn?n.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=0;return CB(n.countRows()-1,N=>{if(n.isEmptyRow(N))O+=1;else if(A===!0)return!1}),O},this.countEmptyCols=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=0;return CB(n.countCols()-1,N=>{if(n.isEmptyCol(N))O+=1;else if(A===!0)return!1}),O},this.isEmptyRow=function(A){return I.isEmptyRow.call(n,A)},this.isEmptyCol=function(A){return I.isEmptyCol.call(n,A)},this.selectCell=function(A,O,N,H){let B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return _i(A)||_i(O)?!1:this.selectCells([[A,O,N,H]],B,K)},this.selectCells=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;O===!1&&C.suspend();const H=oe.selectCells(A);return H&&N&&n.listen(),C.resume(),H},this.selectColumns=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,N=arguments.length>2?arguments[2]:void 0;return oe.selectColumns(A,O,N)},this.selectRows=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,N=arguments.length>2?arguments[2]:void 0;return oe.selectRows(A,O,N)},this.deselectCell=function(){oe.deselect()},this.selectAll=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,N=arguments.length>2?arguments[2]:void 0;C.skipNextScrollCycle(),oe.selectAll(A,O,N)};const Pe=(A,O)=>A.getNearestNotHiddenIndex(O,1,!0);this.scrollViewportTo=function(A){var O;if(typeof A=="number"){var N;A={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(N=arguments[4])!==null&&N!==void 0?N:!0}}const{row:H,col:B,considerHiddenIndexes:K}=(O=A)!==null&&O!==void 0?O:{};let Z=H,we=B;if(K===void 0||K){const q=Number.isInteger(H)&&H>=0,re=Number.isInteger(B)&&B>=0,ve=q?Pe(this.rowIndexMapper,H):void 0,ce=re?Pe(this.columnIndexMapper,B):void 0;if(ve===null||ce===null)return!1;Z=q?n.rowIndexMapper.getRenderableFromVisualIndex(ve):H,we=re?n.columnIndexMapper.getRenderableFromVisualIndex(ce):B}const Ce=Number.isInteger(Z),z=Number.isInteger(we);return Ce&&Z>=0&&z&&we>=0?n.view.scrollViewport(n._createCellCoords(Z,we),A.horizontalSnap,A.verticalSnap):Ce&&Z>=0&&(z&&we<0||!z)?n.view.scrollViewportVertically(Z,A.verticalSnap):z&&we>=0&&(Ce&&Z<0||!Ce)?n.view.scrollViewportHorizontally(we,A.horizontalSnap):!1},this.scrollToFocusedCell=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",A);const{highlight:O}=this.getSelectedRangeLast();this.scrollViewportTo(O.toObject())?this.view.render():(this.removeHook("afterScroll",A),this._registerImmediate(()=>A()))},this.destroy=function(){if(n._clearTimeouts(),n._clearImmediates(),n.view&&n.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),R.clearCache(),DO.delete(this.guid),B2(n)){const A=this.rootDocument.querySelector(".hot-display-license-info");A&&A.parentNode.removeChild(A)}Vu(n.rootElement),o.destroy(),g&&g.destroy(),n.batchExecution(()=>{n.rowIndexMapper.unregisterAll(),n.columnIndexMapper.unregisterAll(),D.getItems().forEach(A=>{let[,O]=A;O.destroy()}),D.clear(),n.runHooks("afterDestroy")},!0),qt.getSingleton().destroy(n),Zr(n,(A,O,N)=>{oi(A)?N[O]=Be(O):O!=="guid"&&(N[O]=null)}),n.isDestroyed=!0,l&&l.destroy(),l=null,d=null,oe=null,g=null,n=null};function Be(A){return()=>{throw new Error(`The "${A}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return n.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return n.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return n.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return n.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return n.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return n.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return n.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return n.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return n.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return n.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return n.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return n.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(A){const O=Nc(A);return O==="UndoRedo"?this.undoRedo:D.getItem(O)},this.getPluginName=function(A){return A===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:D.getId(A)},this.getInstance=function(){return n},this.addHook=function(A,O,N){qt.getSingleton().add(A,O,n,N)},this.hasHook=function(A){return qt.getSingleton().has(A,n)||qt.getSingleton().has(A)},this.addHookOnce=function(A,O,N){qt.getSingleton().once(A,O,n,N)},this.removeHook=function(A,O){qt.getSingleton().remove(A,O,n)},this.runHooks=function(A,O,N,H,B,K,Z){return qt.getSingleton().run(n,A,O,N,H,B,K,Z)},this.getTranslatedPhrase=function(A,O){return Zq(I.language,A,O)},this.toHTML=()=>wB(this),this.toTableElement=()=>{const A=this.rootDocument.createElement("div");return A.insertAdjacentHTML("afterbegin",wB(this)),A.firstElementChild},this.timeouts=[],this.useTheme=A=>{this.view.getStylesHandler().useTheme(A),this.runHooks("afterSetTheme",A,!!x)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,N=A;typeof N=="function"&&(N=setTimeout(N,O)),this.timeouts.push(N)},this._clearTimeouts=function(){Te(this.timeouts,A=>{clearTimeout(A)})},this.immediates=[],this._registerImmediate=function(A){this.immediates.push(setImmediate(A))},this._clearImmediates=function(){Te(this.immediates,A=>{clearImmediate(A)})},this._getEditorManager=function(){return g},this.isRtl=function(){return n.rootWindow.getComputedStyle(n.rootElement).direction==="rtl"},this.isLtr=function(){return!n.isRtl()},this.getDirectionFactor=function(){return n.isLtr()?1:-1};const Me=I4e({handleEvent(){return n.isListening()},beforeKeyDown:A=>this.runHooks("beforeKeyDown",A),afterKeyDown:A=>{this.isDestroyed||n.runHooks("afterDocumentKeyDown",A)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",A=>{A.ctrlKey===!1&&A.metaKey===!1&&Me.releasePressedKeys()}),this.getShortcutManager=function(){return Me},this.getFocusManager=function(){return y},pq().forEach(A=>{const O=eN(A);D.addItem(A,new O(this))}),d4e(n),Me.setActiveContextName("grid"),qt.getSingleton().run(n,"construct")}function vV(t,e,r){t.addEventListener(e,r,!1)}function wV(t,e,r){t.removeEventListener(e,r,!1)}function sx(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function gJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:y=>y.value,...e},i=t.body,s=t.createTextNode(""),n=t.createElement("span");let o;function l(){var y,C;s.textContent=r.textContent(o),n.style.position="absolute",n.style.fontSize=sx(o).fontSize,n.style.fontFamily=sx(o).fontFamily,n.style.whiteSpace="pre",i.appendChild(n);const x=parseInt(((y=sx(o))===null||y===void 0?void 0:y.paddingInlineStart)||0,10),_=parseInt(((C=sx(o))===null||C===void 0?void 0:C.paddingInlineEnd)||0,10),E=n.clientWidth+2+x+_;i.removeChild(n);const R=o.style;R.height=`${r.minHeight}px`,r.minWidth>E?R.width=`${r.minWidth}px`:E>r.maxWidth?R.width=`${r.maxWidth}px`:R.width=`${E}px`;const I=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>I?R.height=`${r.minHeight}px`:r.maxHeight<I?(R.height=`${r.maxHeight}px`,R.overflowY="visible"):R.height=`${I}px`}function h(){t.defaultView.setTimeout(l,0)}function d(y){if(y&&y.minHeight)if(y.minHeight==="inherit")r.minHeight=o.clientHeight;else{const C=parseInt(y.minHeight,10);isNaN(C)||(r.minHeight=C)}if(y&&y.maxHeight)if(y.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const C=parseInt(y.maxHeight,10);isNaN(C)||(r.maxHeight=C)}if(y&&y.minWidth)if(y.minWidth==="inherit")r.minWidth=o.clientWidth;else{const C=parseInt(y.minWidth,10);isNaN(C)||(r.minWidth=C)}if(y&&y.maxWidth)if(y.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const C=parseInt(y.maxWidth,10);isNaN(C)||(r.maxWidth=C)}n.firstChild||(n.className="autoResize",n.style.display="inline-block",n.appendChild(s))}function g(y,C){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=y,d(C),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),x&&(vV(o,"input",l),vV(o,"keydown",h)),l()}return{init:g,resize:l,unObserve(){wV(o,"input",l),wV(o,"keydown",h)}}}function yV(t,e){const r=zX(e),i=e.value.split(`
`);let s=r,n=0;for(let o=0;o<i.length;o++){const l=i[o];o!==0&&(n+=i[o-1].length+1);const h=n+l.length;if(t==="home"?s=n:t==="end"&&(s=h),r<=h)break}D_(e,s)}function v0(t,e,r){return(e=P4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P4e(t){var e=F4e(t,"string");return typeof e=="symbol"?e:e+""}function F4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const M4e="ht_editor_visible",ox="ht_editor_hidden",CV="textEditor",k4e="text";class qg extends N1{static get EDITOR_TYPE(){return k4e}constructor(e){super(e),v0(this,"eventManager",new Dc(this)),v0(this,"autoResize",gJ(this.hot.rootDocument)),v0(this,"TEXTAREA",void 0),v0(this,"textareaStyle",void 0),v0(this,"TEXTAREA_PARENT",void 0),v0(this,"textareaParentStyle",void 0),v0(this,"layerClass",void 0),this.eventManager=new Dc(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),bSe(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,i,s,n,o){const l=this.state;if(super.prepare(e,r,i,s,n,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=o;h&&!this.isOpened()&&(this.TEXTAREA.value=""),l!==Gi.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Gi.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),D_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Fr(this.TEXTAREA,[["data-hot-input",""],P1(-1)]),ht(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ht(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ir(this.TEXTAREA_PARENT,this.layerClass)&&Ar(this.TEXTAREA_PARENT,this.layerClass),ht(this.TEXTAREA_PARENT,ox),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ibe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ar(this.TEXTAREA_PARENT,this.layerClass),ht(this.TEXTAREA_PARENT,ox)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;pr(e.length-1,i=>{const s=e[i];if(Ir(s,"handsontableEditor"))return r=!0,!1}),Ir(this.TEXTAREA_PARENT,ox)&&Ar(this.TEXTAREA_PARENT,ox),r?(this.layerClass=M4e,ht(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ht(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Gi.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:i,width:s,maxWidth:n,height:o,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(s,n),minHeight:Math.min(o,l),maxWidth:n,maxHeight:l},!0)}bindEvents(){iq()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Gi.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Gi.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>nr(this.hot.getSelected()),group:CV},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:n=>!this.hot.selection.isMultiple()&&!n.altKey},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(s(),!1)},{keys:[["Home"]],callback:(n,o)=>{let[l]=o;yV(l,this.TEXTAREA)}},{keys:[["End"]],callback:(n,o)=>{let[l]=o;yV(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(CV)}}const N4e="base";function tS(t,e,r,i,s,n,o){const l=o.ariaTags,h=[],d=[],g=[],y=[];o.className&&ht(e,o.className),o.readOnly?(h.push(o.readOnlyCellClassName),l&&y.push(K9())):l&&g.push(K9()[0]),o.valid===!1&&o.invalidCellClassName?(h.push(o.invalidCellClassName),l&&y.push(X9())):(d.push(o.invalidCellClassName),l&&g.push(X9()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&h.push(o.noWordWrapClassName),!n&&o.placeholder&&h.push(o.placeholderCellClassName),Ar(e,d),ht(e,h),F1(e,g),Fr(e,y)}tS.RENDERER_TYPE=N4e;const D4e="text";function ff(t,e,r,i,s,n,o){tS.apply(this,[t,e,r,i,s,n,o]);let l=n;if(!l&&o.placeholder&&(l=o.placeholder),l=is(l),o.trimWhitespace&&(l=l.trim()),o.rendererTemplate){Vu(e);const h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(r),e.appendChild(h)}else Rg(e,l)}ff.RENDERER_TYPE=D4e;const L4e="text",mJ={CELL_TYPE:L4e,editor:qg,renderer:ff};uc(mJ);sn.editors={BaseEditor:N1};function sn(t,e){const r=new dJ(t,e||{},vN);return r.init(),r}sn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new dJ(t,e,vN)};sn.DefaultSettings=oJ();sn.hooks=qt.getSingleton();sn.CellCoords=Og;sn.CellRange=JC;sn.packageName="handsontable";sn.buildDate="16/12/2024 13:19:38";sn.version="15.0.0";sn.languages={dictionaryKeys:eRe,getLanguageDictionary:Qq,getLanguagesDictionaries:sRe,registerLanguageDictionary:Jq,getTranslatedPhrase:Zq};function lF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function H4e(t){if(Array.isArray(t))return lF(t)}function $4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oC(t,e,r){return e=eT(e),G4e(t,pJ()?Reflect.construct(e,r||[],eT(t).constructor):e.apply(t,r))}function f1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SV(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,vJ(i.key),i)}}function d1(t,e,r){return e&&SV(t.prototype,e),r&&SV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B4e(t,e,r){return(e=vJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eT(t){return eT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eT(t)}function aC(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cF(t,e)}function pJ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(pJ=function(){return!!t})()}function V4e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function W4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function j4e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bV(Object(r),!0).forEach(function(i){B4e(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bV(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function U4e(t,e){if(t==null)return{};var r,i,s=z4e(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(i=0;i<n.length;i++)r=n[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function z4e(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function G4e(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $4e(t)}function cF(t,e){return cF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},cF(t,e)}function Y4e(t){return H4e(t)||V4e(t)||X4e(t)||W4e()}function K4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function vJ(t){var e=K4e(t,"string");return typeof e=="symbol"?e:e+""}function X4e(t,e){if(t){if(typeof t=="string")return lF(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?lF(t,e):void 0}}var LO=null,q4e="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",J4e="The Handsontable instance bound to this component was destroyed and cannot be used properly.",tT="global",Q4e="hot-wrapper-editor-container";function Z4e(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function uF(t,e){var r=br.Children.toArray(t),i=br.Children.count(t),s=null;return i!==0&&(i===1&&r[0].props[e]?s=r[0]:s=r.find(function(n){return n.props[e]!==void 0})),s||null}function wJ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function yJ(t,e){if(typeof t>"u"||e===null)return null;var r=SJ(e.props,!1);return r.className="".concat(Q4e," ").concat(r.className),UG.createPortal(br.createElement("div",Object.assign({},r),e),t.body)}function CJ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tT,i=uF(t,"hot-editor"),s=wJ(i);return i?br.cloneElement(i,{emitEditorInstance:function(o,l){e.get(s)||e.set(s,new Map);var h=e.get(s);h.set(l??tT,o)},editorColumnScope:r,isEditor:!0}):null}function eOe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;r||(r=document),LO||(LO=r.createDocumentFragment());var n=s??r.createElement("DIV");LO.appendChild(n);var o=br.cloneElement(t,j4e({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:UG.createPortal(o,n,i),portalContainer:n}}function SJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function tOe(){return typeof window<"u"}var bJ=function(){function t(){f1(this,t)}return d1(t,null,[{key:"getSettings",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.prevProps,n=s===void 0?{}:s,o=i.isInit,l=o===void 0?!1:o,h=i.initOnlySettingKeys,d=h===void 0?[]:h,g=function(R){return!l&&d.includes(R)?n[R]===r[R]:!1},y={};if(r.settings){var C=r.settings;for(var x in C)C.hasOwnProperty(x)&&!g(x)&&(y[x]=C[x])}for(var _ in r)_!=="settings"&&_!=="children"&&!g(_)&&r.hasOwnProperty(_)&&(y[_]=r[_]);return y}}])}(),rOe=function(t){function e(){return f1(this,e),oC(this,e,arguments)}return aC(e,t),d1(e,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(s){return!i.internalProps.includes(s)}).reduce(function(s,n){return s[n]=i.props[n],s},{})}},{key:"getLocalEditorElement",value:function(){return CJ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),s=this.getLocalEditorElement();this.columnSettings=bJ.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),s!==null&&(this.columnSettings.editor=this.props._getEditorClass(s,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),s=yJ(i,this.getLocalEditorElement());return br.createElement(br.Fragment,null,s)}}])}(br.Component),nOe=function(t){function e(){var r;return f1(this,e),r=oC(this,e,arguments),r.state={portals:[]},r}return aC(e,t),d1(e,[{key:"render",value:function(){return br.createElement(br.Fragment,null,this.state.portals)}}])}(br.Component),iOe="15.0.0";function sOe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var xJ={exports:{}},HO,xV;function oOe(){if(xV)return HO;xV=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return HO=t,HO}var $O,EV;function aOe(){if(EV)return $O;EV=1;var t=oOe();function e(){}function r(){}return r.resetWarningCache=e,$O=function(){function s(l,h,d,g,y,C){if(C!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}s.isRequired=s;function n(){return s}var o={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:n,element:s,elementType:s,instanceOf:n,node:s,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},$O}xJ.exports=aOe()();var lOe=xJ.exports,BO=sOe(lOe),YD=function(t){function e(){var r;return f1(this,e),r=oC(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return aC(e,t),d1(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(J4e),null)},set:function(i){this.__hotInstance=i}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return tOe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var s=this;return function(o,l,h,d,g,y,C){var x=s.getRenderedCellCache(),_=s.getPortalContainerCache(),E="".concat(h,"-").concat(d),R=o.guid,I="".concat(R,"-").concat(E),F="".concat(E,"-").concat(R);if(x.has(E)&&(l.innerHTML=x.get(E).innerHTML),l&&!l.getAttribute("ghost-table")){for(var D=s.portalCache.get(F),U=_.get(I);l.firstChild;)l.removeChild(l.firstChild);if(D&&U)l.appendChild(U);else{var X=eOe(i,{TD:l,row:h,col:d,prop:g,value:y,cellProperties:C,isRenderer:!0},l.ownerDocument,F,U),te=X.portal,Y=X.portalContainer;_.set(I,Y),l.appendChild(Y),s.portalCache.set(F,te)}}return x.set(E,l),l}}},{key:"getEditorClass",value:function(i){var s,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tT,o=wJ(i),l=(s=this.getEditorCache().get(o))===null||s===void 0?void 0:s.get(n);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var s=function(n){function o(l){var h;return f1(this,o),h=oC(this,o,[l]),i.hotCustomEditorInstance=h,h.editorComponent=i,h}return aC(o,n),d1(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(sn.editors.BaseEditor);return Object.getOwnPropertyNames(sn.editors.BaseEditor.prototype).forEach(function(n){n!=="constructor"&&(s.prototype[n]=function(){for(var o,l=arguments.length,h=new Array(l),d=0;d<l;d++)h[d]=arguments[d];return(o=i[n]).call.apply(o,[i].concat(h))})}),s}},{key:"getGlobalRendererElement",value:function(){return uF(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return CJ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],l=bJ.getSettings(this.props,{prevProps:n,isInit:s,initOnlySettingKeys:o}),h=this.getGlobalRendererElement(),d=this.getGlobalEditorElement();if(l.columns=this.columnSettings.length?this.columnSettings:l.columns,d)l.editor=this.getEditorClass(d,tT);else{var g;this.props.editor||(g=this.props.settings)!==null&&g!==void 0&&g.editor?l.editor=this.props.editor||this.props.settings.editor:l.editor=JP("text")}if(h)l.renderer=this.getRendererWrapper(h),this.componentRendererColumns.set("global",!0);else{var y;this.props.renderer||(y=this.props.settings)!==null&&y!==void 0&&y.renderer?l.renderer=this.props.renderer||this.props.settings.renderer:l.renderer=tF("text")}return l}},{key:"displayAutoSizeWarning",value:function(i){var s,n;this.hotInstance&&((s=this.hotInstance.getPlugin("autoRowSize"))!==null&&s!==void 0&&s.enabled||(n=this.hotInstance.getPlugin("autoColumnSize"))!==null&&n!==void 0&&n.enabled)&&this.componentRendererColumns.size>0&&Z4e(q4e)}},{key:"setHotColumnSettings",value:function(i,s){this.columnSettings[s]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:Y4e(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,s=this.createNewGlobalSettings(!0);this.hotInstance=new sn.Core(this.hotElementRef,s),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(s)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var s=this.createNewGlobalSettings(!1,i);this.updateHot(s),this.displayAutoSizeWarning(s)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,s=function(g){return g.type===rOe},n=br.Children.toArray(this.props.children),o=n.filter(function(d){return s(d)}).map(function(d,g){return br.cloneElement(d,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:g,_getChildElementByType:uF.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:d.props.children})}),l=SJ(this.props),h=yJ(this.getOwnerDocument(),this.getGlobalEditorElement());return br.createElement(br.Fragment,null,br.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},l),o),br.createElement(nOe,{ref:this.setRenderersPortalManagerRef.bind(this)}),h)}}],[{key:"version",get:function(){return iOe}}])}(br.Component);YD.propTypes={style:BO.object,id:BO.string,className:BO.string};var cOe=["children"],EJ=br.forwardRef(function(t,e){var r,i=t.children,s=U4e(t,cOe),n=typeof br.useId=="function"?br.useId():void 0,o=(r=s.id)!==null&&r!==void 0?r:n;return br.createElement(YD,Object.assign({id:o},s,{ref:e}),i)});EJ.version=YD.version;br.Component;const TV="handsontableEditor",uOe="handsontable";class KD extends qg{static get EDITOR_TYPE(){return uOe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),D_(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o);const l=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(d,g){const y=this.getSourceData(g.row,g.col);y!==void 0&&l.setValue(y),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&vs(h,o.handsontable),this.htOptions=h}beginEditing(e,r){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,r,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.htEditor.useTheme(e)})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:TV,relativeToGroup:$d,position:"before"},s=(n,o)=>{const l=this.htEditor;if(n!==void 0&&(n<0||l.flipped&&n>l.countRows()-1?l.deselectCell():l.selectCell(n,0),l.getData().length))return o.preventDefault(),Bc(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:n=>{const o=this.htEditor;let l,h;return!o.getSelectedLast()&&o.flipped?l=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(h=o.getSelectedLast()[0],l=Math.max(0,h-1)):(h=o.getSelectedLast()[0],l=h-1)),s(l,n)},preventDefault:!1},{keys:[["ArrowDown"]],callback:n=>{const o=this.htEditor;let l,h;if(!o.getSelectedLast()&&!o.flipped)l=0;else if(o.getSelectedLast()){if(o.flipped)l=o.getSelectedLast()[0]+1;else if(!o.flipped){const d=o.countRows()-1;h=o.getSelectedLast()[0],l=Math.min(d,h+1)}}return s(l,n)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TV)}}function hOe(t,e,r){fOe(t,e),e.set(t,r)}function fOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ax(t,e,r){return(e=dOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dOe(t){var e=gOe(t,"string");return typeof e=="symbol"?e:e+""}function gOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _V(t,e){return t.get(mOe(t,e))}function mOe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pOe="autocomplete";var VO=new WeakMap;class XD extends KD{constructor(){super(...arguments),ax(this,"query",null),ax(this,"strippedChoices",[]),ax(this,"rawChoices",[]),hOe(this,VO,this.hot.guid.slice(0,9)),ax(this,"sortByRelevance",function(e,r,i){const s=[],n=[],o=e.length;let l=r.length,h,d,g,y;if(o===0){for(g=0;g<l;g++)n.push(g);return n}for(g=0;g<l;g++){if(d=Y9(is(r[g])),i)y=d.indexOf(e);else{const C=this.cellProperties.locale;y=d.toLocaleLowerCase(C).indexOf(e.toLocaleLowerCase(C))}y!==-1&&(h=d.length-y-o,s.push({baseIndex:g,index:y,charsLeft:h,value:d}))}for(s.sort((C,x)=>{if(x.index===-1)return-1;if(C.index===-1)return 1;if(C.index<x.index)return-1;if(x.index<C.index)return 1;if(C.index===x.index){if(C.charsLeft<x.charsLeft)return-1;if(C.charsLeft>x.charsLeft)return 1}return 0}),g=0,l=s.length;g<l;g++)n.push(s[g].baseIndex);return n})}static get EDITOR_TYPE(){return pOe}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return nr(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ht(this.htContainer,"autocompleteEditor"),ht(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Fr(this.TEXTAREA,[uSe(),sSe(),NX("listbox"),gSe()])}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.hot.getSettings().ariaTags&&Fr(this.TEXTAREA,[Bl("false"),mSe(`${_V(VO,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=i==null?void 0:i.length,{row:n,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[ns(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(l,h,d,g,y,C,x)=>{ff(l,h,d,g,y,C,x);const{filteringCaseSensitive:_,allowHtml:E,locale:R}=this.cellProperties,I=this.query;let F=is(C),D,U;F&&!E&&(D=_===!0?F.indexOf(I):F.toLocaleLowerCase(R).indexOf(I.toLocaleLowerCase(R)),D!==-1&&(U=F.substr(D,I.length),F=F.replace(U,`<strong>${U}</strong>`))),r&&Fr(h,[oSe(),...i?[ySe(s)]:[],...i?[CSe(i.indexOf(C)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${g}`]]),h.innerHTML=F},afterSelectionEnd:(l,h)=>{if(r){const d=this.htEditor.getCell(l,h,!0);Fr(d,[Vk()]),Fr(this.TEXTAREA,...pSe(d.id))}}}),r&&(Fr(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Nu()),Fr(this.htEditor.rootElement,[kX(),vSe("polite"),wSe("text"),["id",`${_V(VO,this)}-listbox-${n}-${o}`]]),Fr(this.TEXTAREA,...Bl("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Fr(this.TEXTAREA,[Bl("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=zX(this.TEXTAREA),i=OSe(this.TEXTAREA),s=this.cellProperties.sortByRelevance,n=this.cellProperties.filter;let o=null,l=null,h=e;s&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));const d=Array.isArray(o)?o.length:0;if(n===!1)d&&(l=o[0]);else{const g=[];for(let y=0,C=h.length;y<C&&!(s&&d<=y);y++)d?g.push(h[o[y]]):g.push(h[y]);l=0,h=g}this.strippedChoices=h,h.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(H2([h])),h.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),D_(this.TEXTAREA,r,r===i?void 0:i)}flipDropdownIfNeeded(){const e=c1(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(r||!r&&(i||i==="horizontal"))return!1;const s=Ws(this.TEXTAREA),n=Ji(this.TEXTAREA),o=this.getHeight(),l=e.scrollTop,h=Ji(this.hot.view._wt.wtTable.THEAD),d=Ws(e),g=s.top-d.top-h+l,y=e.scrollHeight-g-h-n,C=o>y&&g>y;return C?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(C?g:y,o),C}limitDropdownIfNeeded(e,r){if(r>e){let i=0,s=0,n=0,o=null;do n=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),i+=n,s+=1;while(i<e);o=i-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-o}px`),this.setDropdownHeight(i-n)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+so(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(n,o)=>o).reduce((n,o)=>n+this.htEditor.getRowHeight(o),0)+r+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+r}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,i=on(e,n=>is(n));return on(i,n=>r?n:Y9(n))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),i={row:r?r.from.row:-1};let s=!1;return e===Sr.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(s=!0),e===Sr.ARROW_UP&&i.row>-1&&(s=!0),s}onBeforeKeyDown(e){if(obe(e.keyCode)||e.keyCode===Sr.BACKSPACE||e.keyCode===Sr.DELETE||e.keyCode===Sr.INSERT){let r=10;if(e.keyCode===Sr.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}const vOe="checkbox";class TJ extends N1{static get EDITOR_TYPE(){return vOe}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Ir(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const od=()=>window,Fl=()=>window.document,hF=(t,e)=>window.setTimeout(t,e),wu=function(t,e,r,i){t.addEventListener(e,r,!!i)},dh=function(t,e,r,i){t.removeEventListener(e,r,!!i)},wOe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Va=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},WO=function(t,e){Va(t,e)||(t.className=t.className===""?e:t.className+" "+e)},jO=function(t,e){t.className=wOe((" "+t.className+" ").replace(" "+e+" "," "))},qD=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ua=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},yOe=function(t){let e=t.getDay();return e===0||e===6},COe=function(t){return t%4===0&&t%100!==0||t%400===0},RV=function(t,e){return[31,COe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},lx=function(t){Ua(t)&&t.setHours(0,0,0,0)},cx=function(t,e){return t.getTime()===e.getTime()},rT=function(t,e,r){let i,s;for(i in e)s=t[i]!==void 0,s&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Ua(e[i])?r&&(t[i]=new Date(e[i].getTime())):qD(e[i])?r&&(t[i]=e[i].slice(0)):t[i]=rT({},e[i],r):(r||!s)&&(t[i]=e[i]);return t},AV=function(t,e,r){let i=Fl().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=rT(i,r),t.dispatchEvent(i)},OV=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},iu={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},IV=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},SOe=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},bOe=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),i=t.getDay(),s=e,n=s-1,o=7,l=function(C){return(C+o-1)%o};t.setDate(r+n-l(i));let h=new Date(t.getFullYear(),0,s),d=24*60*60*1e3,g=(t.getTime()-h.getTime())/d;return 1+Math.round((g-n+l(h.getDay()))/o)},xOe=function(t,e,r,i,s){let n=new Date(i,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(n).isoWeek():bOe(n,s))+"</td>"},EOe=function(t,e,r,i){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},TOe=function(t){return"<tbody>"+t.join("")+"</tbody>"},_Oe=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+IV(t,e)+'">'+IV(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},ROe=function(t,e,r,i,s,n){let o,l,h,d=t._o,g=r===d.minYear,y=r===d.maxYear,C='<div id="'+n+'" class="pika-title" role="heading" aria-live="polite">',x,_,E=!0,R=!0;for(h=[],o=0;o<12;o++)h.push('<option value="'+(r===s?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(g&&o<d.minMonth||y&&o>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[o]+"</option>");for(x='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",qD(d.yearRange)?(o=d.yearRange[0],l=d.yearRange[1]+1):(o=r-d.yearRange,l=1+r+d.yearRange),h=[];o<l&&o<=d.maxYear;o++)o>=d.minYear&&h.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return _='<div class="pika-label">'+r+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?C+=_+x:C+=x+_,g&&(i===0||d.minMonth>=i)&&(E=!1),y&&(i===11||d.maxMonth<=i)&&(R=!1),e===0&&(C+='<button class="pika-prev'+(E?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(C+='<button class="pika-next'+(R?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),C+="</div>"},AOe=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+_Oe(t)+TOe(e)+"</table>"};function fF(t){let e=this,r=e.config(t);e._onMouseDown=function(s){if(!e._v)return;s=s||od().event;let n=s.target||s.srcElement;if(n)if(Va(n,"is-disabled")||(Va(n,"pika-button")&&!Va(n,"is-empty")&&!Va(n.parentNode,"is-disabled")?(e.setDate(new Date(n.getAttribute("data-pika-year"),n.getAttribute("data-pika-month"),n.getAttribute("data-pika-day"))),r.bound&&hF(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Va(n,"pika-prev")?e.prevMonth():Va(n,"pika-next")&&e.nextMonth()),Va(n,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||od().event;let n=s.target||s.srcElement;n&&(Va(n,"pika-select-month")?e.gotoMonth(n.value):Va(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(s){if(s=s||od().event,e.isVisible())switch(s.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let s=this.moment(r.field.value,r.format,r.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(s){let n;s.firedBy!==e&&(n=e._parseFieldValue(),Ua(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=Fl().activeElement;do if(Va(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=hF(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||od().event;let n=s.target||s.srcElement,o=n;if(n){!hasEventListeners&&Va(n,"pika-select")&&(n.onchange||(n.setAttribute("onchange","return;"),wu(n,"change",e._onChange)));do if(Va(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&n!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Fl().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),wu(e.el,"mousedown",e._onMouseDown,!0),wu(e.el,"touchend",e._onMouseDown,!0),wu(e.el,"change",e._onChange),r.keyboardInput&&wu(Fl(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Fl().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),wu(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let i=r.defaultDate;Ua(i)?r.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",wu(r.trigger,"click",e._onInputClick),wu(r.trigger,"focus",e._onInputFocus),wu(r.trigger,"blur",e._onInputBlur)):this.show()}fF.prototype={config:function(t){this._o||(this._o=rT({},iu,!0));let e=rT(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,Ua(e.minDate)||(e.minDate=!1),Ua(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),qD(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||iu.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ua(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ua(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",AV(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ua(t))return;let r=this._o.minDate,i=this._o.maxDate;Ua(r)&&t<r?t=r:Ua(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),lx(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),AV(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ua(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=s<r.getTime()||i.getTime()<s}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,s;t==="add"?s=new Date(r.valueOf()+i):t==="subtract"&&(s=new Date(r.valueOf()-i)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=OV(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=OV({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(lx(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=iu.minDate,this._o.minYear=iu.minYear,this._o.minMonth=iu.minMonth,this._o.startRange=iu.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(lx(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=iu.maxDate,this._o.maxYear=iu.maxYear,this._o.maxMonth=iu.maxMonth,this._o.endRange=iu.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,i=e.maxYear,s=e.minMonth,n=e.maxMonth,o="",l;this._y<=r&&(this._y=r,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=i&&(this._y=i,!isNaN(n)&&this._m>n&&(this._m=n));for(let h=0;h<e.numberOfMonths;h++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+ROe(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,l)+this.render(this.calendars[h].year,this.calendars[h].month,l)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&hF(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,i,s,n,o,l,h,d,g;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,i=od().innerWidth||Fl().documentElement.clientWidth,s=od().innerHeight||Fl().documentElement.clientHeight,n=Fl().body.scrollTop||Fl().documentElement.scrollTop,d=!0,g=!0,h=t.getBoundingClientRect(),o=h.left+od().pageXOffset,l=h.bottom+od().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,d=!1),(this._o.reposition&&l+r>s+n||this._o.position.indexOf("top")>-1&&l-r-t.offsetHeight>0)&&(l=l-r-t.offsetHeight,g=!1),o<0&&(o=0),l<0&&(l=0),this.el.style.left=o+"px",this.el.style.top=l+"px",WO(this.el,d?"left-aligned":"right-aligned"),WO(this.el,g?"bottom-aligned":"top-aligned"),jO(this.el,d?"right-aligned":"left-aligned"),jO(this.el,g?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let i=this._o,s=new Date,n=RV(t,e),o=new Date(t,e,1).getDay(),l=[],h=[];lx(s),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let d=e===0?11:e-1,g=e===11?0:e+1,y=e===0?t-1:t,C=e===11?t+1:t,x=RV(y,d),_=n+o,E=_;for(;E>7;)E-=7;_+=7-E;let R=!1;for(let I=0,F=0;I<_;I++){let D=new Date(t,e,1+(I-o)),U=Ua(this._d)?cx(D,this._d):!1,X=cx(D,s),te=i.events.indexOf(D.toDateString())!==-1,Y=I<o||I>=n+o,oe=1+(I-o),me=e,de=t,ye=i.startRange&&cx(i.startRange,D),Ee=i.endRange&&cx(i.endRange,D),ke=i.startRange&&i.endRange&&i.startRange<D&&D<i.endRange,nt=i.minDate&&D<i.minDate||i.maxDate&&D>i.maxDate||i.disableWeekends&&yOe(D)||i.disableDayFn&&i.disableDayFn(D);Y&&(I<o?(oe=x+oe,me=d,de=y):(oe=oe-n,me=g,de=C));let at={day:oe,month:me,year:de,hasEvent:te,isSelected:U,isToday:X,isDisabled:nt,isEmpty:Y,isStartRange:ye,isEndRange:Ee,isInRange:ke,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&U&&(R=!0),h.push(SOe(at)),++F===7&&(i.showWeekNumber&&h.unshift(xOe(this,I-o,e,t,i.firstWeekOfYearMinDays)),l.push(EOe(h,i.isRTL,i.pickWholeWeek,R)),h=[],F=0,R=!1)}return AOe(i,l,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),jO(this.el,"is-hidden"),this._o.bound&&(wu(Fl(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&dh(Fl(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),WO(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),dh(this.el,"mousedown",this._onMouseDown,!0),dh(this.el,"touchend",this._onMouseDown,!0),dh(this.el,"change",this._onChange),t.keyboardInput&&dh(Fl(),"keydown",this._onKeyChange),t.field&&(dh(t.field,"change",this._onInputChange),t.bound&&(dh(t.trigger,"click",this._onInputClick),dh(t.trigger,"focus",this._onInputFocus),dh(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function UO(t,e,r){return(e=OOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OOe(t){var e=IOe(t,"string");return typeof e=="symbol"?e:e+""}function IOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _J="date",PV="dateEditor";class RJ extends qg{constructor(){super(...arguments),UO(this,"defaultDateFormat","DD/MM/YYYY"),UO(this,"parentDestroyed",!1),UO(this,"$datePicker",null)}static get EDITOR_TYPE(){return _J}init(){if(typeof wt!="function")throw new Error("You need to include moment.js to your project.");if(typeof fF!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||(Ar(this.datePicker,/ht-theme-.*/g),ht(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ht(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();Ar(this.datePicker,/ht-theme-.*/g),ht(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",r=>{Ir(r.target,"pika-day")&&this.hideDatepicker(),r.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:PV})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(PV),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),s=e?oq(e.keyCode):!1;let n;this.datePicker.style.display="block",this.$datePicker=new fF(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(wt),this.$datePicker._onInputFocus=function(){},this.originalValue?(n=this.originalValue,wt(n,r,!0).isValid()&&this.$datePicker.setMoment(wt(n,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!i&&this.setValue("")):this.cellProperties.defaultDate?(n=this.cellProperties.defaultDate,wt(n,r,!0).isValid()&&this.$datePicker.setMoment(wt(n,r),!0),!s&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&H_(r,this.cellProperties.datePickerConfig);const i=r.onSelect,s=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=n=>{let o=n;isNaN(o.getTime())||(o=wt(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),i&&i()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},r}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Gi.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{wtOverlays:n}=this.hot.view._wt,{wtTable:o}=(r=n.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,l=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),d=s.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),g=s.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=l&&this.row<=h&&this.col>=d&&this.col<=g){const y=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+y.top+Ji(this.TD)}px`;let C=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?C+=y.right-ns(this.datePicker):C+=y.left,this.datePickerStyle.left=`${C}px`}else this.hideDatepicker()}}const POe="dropdown";class JD extends XD{static get EDITOR_TYPE(){return POe}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}qt.getSingleton().add("beforeValidate",function(t,e,r){const i=this.propToCol(r);if(Number.isInteger(i)){const s=this.getCellMeta(e,i);s.editor===JD&&s.strict===void 0&&(s.filter=!1,s.strict=!0)}});const FOe="numeric";class AJ extends qg{static get EDITOR_TYPE(){return FOe}}function MOe(t,e,r){return(e=kOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kOe(t){var e=NOe(t,"string");return typeof e=="symbol"?e:e+""}function NOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DOe="password";class OJ extends qg{constructor(){super(...arguments),MOe(this,"autoResize",gJ(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return DOe}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Vu(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const zO="ht_editor_visible",FV="selectEditor",LOe="select";class IJ extends N1{static get EDITOR_TYPE(){return LOe}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...Dd()),e.appendChild(this.hot.rootDocument.createTextNode("")),ht(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ir(this.selectWrapper,zO)&&Ar(this.selectWrapper,zO),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o);const l=this.cellProperties.selectOptions;let h;typeof l=="function"?h=this.prepareOptions(l(this.row,this.col,this.prop)):h=this.prepareOptions(l),Vu(this.select),Zr(h,(d,g)=>{const y=this.hot.rootDocument.createElement("OPTION");y.value=g,M1(y,d),this.select.appendChild(y)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let i=0,s=e.length;i<s;i++)r[e[i]]=e[i];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Gi.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:i,height:s}=this.getEditedCellRect(),n=this.selectWrapper.style;n.height=`${s}px`,n.width=`${i}px`,n.top=`${e}px`,n[this.hot.isRtl()?"right":"left"]=`${r}px`,n.margin="0px",ht(this.selectWrapper,zO)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={group:FV};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FV)}}const HOe="time";class PJ extends qg{static get EDITOR_TYPE(){return HOe}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.TEXTAREA.dir="ltr"}}function $Oe(){Wa(N1),Wa(XD),Wa(TJ),Wa(RJ),Wa(JD),Wa(KD),Wa(AJ),Wa(OJ),Wa(IJ),Wa(qg),Wa(PJ)}const BOe="html";function QD(t,e,r,i,s,n,o){tS.apply(this,[t,e,r,i,s,n,o]),M1(e,n??"",!1)}QD.RENDERER_TYPE=BOe;const VOe="autocomplete";function D1(t,e,r,i,s,n,o){const{rootDocument:l}=t,h=o.allowHtml?QD:ff,d=l.createElement("DIV"),g=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",g&&d.setAttribute(...Dd()),d.appendChild(l.createTextNode("")),h.apply(this,[t,e,r,i,s,n,o]),e.firstChild||e.appendChild(l.createTextNode("")),e.insertBefore(d,e.firstChild),ht(e,"htAutocomplete"),!t.acArrowListener){const y=new Dc(t);t.acArrowListener=function(C){Ir(C.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,i),e)},y.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{y.destroy()})}}D1.RENDERER_TYPE=VOe;const WOe="dropdown";function ZD(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}ZD.RENDERER_TYPE=WOe;const MV=new WeakMap,kV=new WeakMap,jOe="htBadValue",g1="data-row",m1="data-col",UOe="checkboxRenderer",FJ="checkbox";qt.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:i,type:s,row:n,column:o,prop:l}=e;if(s===FJ){if(i){const{value:h,property:d}=i;let g=r;if(h)g=typeof h=="function"?h(n,o,l,r):h;else if(d){const y=this.getDataAtRowProp(n,d);g=y!==null?y:r}t=g}return t}});function e6(t,e,r,i,s,n,o){const{rootDocument:l}=t,h=t.getSettings().ariaTags;tS.apply(this,[t,e,r,i,s,n,o]),zOe(t);let d=GOe(l);const g=o.label;let y=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Vu(e),n===o.checkedTemplate||is(n).toLocaleLowerCase(o.locale)===is(o.checkedTemplate).toLocaleLowerCase(o.locale)?d.checked=!0:n===o.uncheckedTemplate||is(n).toLocaleLowerCase(o.locale)===is(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?d.checked=!1:qi(n)?ht(d,"noValue"):(d.style.display="none",ht(d,jOe),y=!0),Fr(d,[[g1,r],[m1,i]]),h&&Fr(d,[WE(d.checked?t.getTranslatedPhrase(jD):t.getTranslatedPhrase(UD)),HX(d.checked),aSe()]),!y&&g){let E="";if(g.value)E=typeof g.value=="function"?g.value.call(this,r,i,s,n):g.value;else if(g.property){const I=t.getDataAtRowProp(r,g.property);E=I!==null?I:""}const R=YOe(l,E,g.separated!==!0);g.position==="before"?g.separated?(e.appendChild(R),e.appendChild(d)):(R.appendChild(d),d=R):(!g.position||g.position==="after")&&(g.separated?(e.appendChild(d),e.appendChild(R)):(R.insertBefore(d,R.firstChild),d=R))}(!g||g&&!g.separated)&&e.appendChild(d),y&&e.appendChild(l.createTextNode("#bad-value#")),MV.has(t)||(MV.set(t,!0),C());function C(){const R=t.getShortcutManager().getContext("grid"),I={group:UOe,relativeToGroup:$d,position:"before"};R.addShortcuts([{keys:[["space"]],callback:()=>(x(),!_()),runOnlyIf:()=>{var F;return(F=t.getSelectedRangeLast())===null||F===void 0?void 0:F.highlight.isCell()}},{keys:[["enter"]],callback:()=>(x(),!_()),runOnlyIf:()=>{const F=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(F==null?void 0:F.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(x(!0),!_()),runOnlyIf:()=>{var F;return(F=t.getSelectedRangeLast())===null||F===void 0?void 0:F.highlight.isCell()}}],I)}function x(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=t.getSelectedRange(),I=[],F=new Map;let D=[],U=0;if(R){for(let X=0;X<R.length;X++){const{row:te,col:Y}=R[X].getTopStartCorner(),{row:oe,col:me}=R[X].getBottomEndCorner();for(let de=te;de<=oe;de+=1)for(let ye=Y;ye<=me;ye+=1){const Ee=t.getCellMeta(de,ye);if(Ee.hidden)continue;const ke={checkedTemplate:Ee.checkedTemplate,uncheckedTemplate:Ee.uncheckedTemplate};if(Ee.type!=="checkbox"){E===!0&&!Ee.readOnly&&(F.has(I.length)?F.set(I.length,[...F.get(I.length),[de,ye,null]]):F.set(I.length,[[de,ye,null]]));continue}if(Ee.readOnly===!0)continue;typeof Ee.checkedTemplate>"u"&&(Ee.checkedTemplate=!0),typeof Ee.uncheckedTemplate>"u"&&(Ee.uncheckedTemplate=!1);const nt=t.getDataAtCell(de,ye);E===!1?[Ee.checkedTemplate,Ee.checkedTemplate.toString()].includes(nt)?D.push([de,ye,Ee.uncheckedTemplate,ke]):[Ee.uncheckedTemplate,Ee.uncheckedTemplate.toString(),null,void 0].includes(nt)&&D.push([de,ye,Ee.checkedTemplate,ke]):D.push([de,ye,Ee.uncheckedTemplate,ke]),U+=1}I.push(U),U=0}D.every(X=>{let[,,te]=X;return te===D[0][2]})?D=D.map(X=>{let[te,Y,oe]=X;return[te,Y,oe]}):D=D.map(X=>{let[te,Y,,oe]=X;return[te,Y,oe.checkedTemplate]}),D.length>0&&I.forEach((X,te)=>{let Y=D.splice(0,X);F.size&&F.has(te)&&(Y=[...Y,...F.get(te)]),t.setDataAtCell(Y)})}}function _(){const E=t.getSelectedRange();if(E){for(let R=0;R<E.length;R++){const I=E[R].getTopStartCorner(),F=E[R].getBottomEndCorner();for(let D=I.row;D<=F.row;D++)for(let U=I.col;U<=F.col;U++){if(t.getCellMeta(D,U).readOnly)continue;const te=t.getCell(D,U);if(te instanceof HTMLElement&&te.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}e6.RENDERER_TYPE=FJ;function zOe(t){let e=kV.get(t);if(!e){const{rootElement:r}=t;e=new Dc(t),e.addEventListener(r,"click",i=>XOe(i,t)),e.addEventListener(r,"mouseup",i=>KOe(i,t)),e.addEventListener(r,"change",i=>qOe(i,t)),kV.set(t,e)}return e}function GOe(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function YOe(t,e,r){const i=t.createElement("label");return i.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}function KOe(t,e){const{target:r}=t;t6(r)&&(!r.hasAttribute(g1)||!r.hasAttribute(m1)||setTimeout(e.listen,10))}function XOe(t,e){const{target:r}=t;if(!t6(r)||!r.hasAttribute(g1)||!r.hasAttribute(m1))return;const i=parseInt(r.getAttribute(g1),10),s=parseInt(r.getAttribute(m1),10);e.getCellMeta(i,s).readOnly&&t.preventDefault()}function qOe(t,e){const{target:r}=t;if(!t6(r)||!r.hasAttribute(g1)||!r.hasAttribute(m1))return;const i=parseInt(r.getAttribute(g1),10),s=parseInt(r.getAttribute(m1),10),n=e.getCellMeta(i,s);if(!n.readOnly){let o=null;t.target.checked?o=n.uncheckedTemplate===void 0?!0:n.checkedTemplate:o=n.uncheckedTemplate===void 0?!1:n.uncheckedTemplate,e.setDataAtCell(i,s,o)}}function t6(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const JOe="handsontable";function r6(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}r6.RENDERER_TYPE=JOe;var QOe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZOe(t){return t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var GO,NV;function eIe(){return NV||(NV=1,GO={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),GO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var YO,DV;function MJ(){if(DV)return YO;DV=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(h,d,g,y,C,x,_){if(!isNaN(+h))return+h;let E="",R=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(R!==h)return-1*r(R,d,g,y,C,x);for(let te=0;te<t.length;te++){let Y=t[te];if(E=h.replace(RegExp(`([0-9 ])(${Y.key})$`),"$1"),E!==h)return r(E,d,g,y,C,x)*Y.factor}if(E=h.replace("%",""),E!==h)return r(E,d,g,y,C,x)/100;let I=parseFloat(h);if(isNaN(I))return;let F=y(I);if(F&&F!=="."&&(E=h.replace(new RegExp(`${e(F)}$`),""),E!==h))return r(E,d,g,y,C,x);let D={};Object.keys(x).forEach(te=>{D[x[te]]=te});let U=Object.keys(D).sort().reverse(),X=U.length;for(let te=0;te<X;te++){let Y=U[te],oe=D[Y];if(E=h.replace(Y,""),E!==h){let me;switch(oe){case"thousand":me=Math.pow(10,3);break;case"million":me=Math.pow(10,6);break;case"billion":me=Math.pow(10,9);break;case"trillion":me=Math.pow(10,12);break}return r(E,d,g,y,C,x)*me}}}function i(h,d,g){let y=h.replace(g,"");return y=y.replace(new RegExp(`([0-9])${e(d.thousands)}([0-9])`,"g"),"$1$2"),y=y.replace(d.decimal,"."),y}function s(h,d,g="",y,C,x,_){if(h==="")return;if(h===C)return 0;let E=i(h,d,g);return r(E,d,g,y,C,x)}function n(h,d){if(!(h.indexOf(":")&&d.thousands!==":"))return!1;let y=h.split(":");if(y.length!==3)return!1;let C=+y[0],x=+y[1],_=+y[2];return!isNaN(C)&&!isNaN(x)&&!isNaN(_)}function o(h){let d=h.split(":"),g=+d[0],y=+d[1];return+d[2]+60*y+3600*g}function l(h,d){const g=s6();let y=g.currentDelimiters(),C=g.currentCurrency().symbol,x=g.currentOrdinal(),_=g.getZeroFormat(),E=g.currentAbbreviations(),R;if(typeof h=="string")n(h,y)?R=o(h):R=s(h,y,C,x,_,E);else if(typeof h=="number")R=h;else return;if(R!==void 0)return R}return YO={unformat:l},YO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var KO,LV;function n6(){if(LV)return KO;LV=1;let t=MJ();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],n=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},d={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(R,I)=>I.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:R=>R.output==="byte"},characteristic:{type:"number",restriction:R=>R>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(R,I)=>I.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:R=>R>=0,message:"value must be positive"},{restriction:(R,I)=>!I.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:R=>R>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:n},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(R,I)=>I.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:R=>R.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function y(R,I){let F=C(R),D=_(I);return F&&D}function C(R){return t.unformat(R)!==void 0}function x(R,I,F,D=!1){let U=Object.keys(R).map(X=>{if(!I[X])return console.error(`${F} Invalid key: ${X}`),!1;let te=R[X],Y=I[X];if(typeof Y=="string"&&(Y={type:Y}),Y.type==="format"){if(!x(te,d,`[Validate ${X}]`,!0))return!1}else if(typeof te!==Y.type)return console.error(`${F} ${X} type mismatched: "${Y.type}" expected, "${typeof te}" provided`),!1;if(Y.restrictions&&Y.restrictions.length){let oe=Y.restrictions.length;for(let me=0;me<oe;me++){let{restriction:de,message:ye}=Y.restrictions[me];if(!de(te,R))return console.error(`${F} ${X} invalid value: ${ye}`),!1}}return Y.restriction&&!Y.restriction(te,R)?(console.error(`${F} ${X} invalid value: ${Y.message}`),!1):Y.validValues&&Y.validValues.indexOf(te)===-1?(console.error(`${F} ${X} invalid value: must be among ${JSON.stringify(Y.validValues)}, "${te}" provided`),!1):!(Y.children&&!x(te,Y.children,`[Validate ${X}]`))});return D||U.push(...Object.keys(I).map(X=>{let te=I[X];if(typeof te=="string"&&(te={type:te}),te.mandatory){let Y=te.mandatory;if(typeof Y=="function"&&(Y=Y(R)),Y&&R[X]===void 0)return console.error(`${F} Missing mandatory key "${X}"`),!1}return!0})),U.reduce((X,te)=>X&&te,!0)}function _(R){return x(R,d,"[Validate format]")}function E(R){return x(R,g,"[Validate language]")}return KO={validate:y,validateFormat:_,validateInput:C,validateLanguage:E},KO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function tIe(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function rIe(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function nIe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function iIe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function sIe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function oIe(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function aIe(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function lIe(t,e){let r=t.split(".")[1];if(r){let i=r.match(/0+/);i&&(e.mantissa=i[0].length)}}function cIe(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function uIe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function hIe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function fIe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function dIe(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function gIe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function mIe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function pIe(t,e={}){return typeof t!="string"?t:(t=tIe(t,e),t=rIe(t,e),nIe(t,e),oIe(t,e),aIe(t,e),dIe(t,e),uIe(t,e),hIe(t,e),lIe(t,e),fIe(t,e),cIe(t,e),iIe(t,e),sIe(t,e),gIe(t,e),mIe(t,e),e)}var i6={parseFormat:pIe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var XO,HV;function s6(){if(HV)return XO;HV=1;const t=eIe(),e=n6(),r=i6;let i={},s,n={},o=null,l={};function h(g){s=g}function d(){return n[s]}return i.languages=()=>Object.assign({},n),i.currentLanguage=()=>s,i.currentBytes=()=>d().bytes||{},i.currentCurrency=()=>d().currency,i.currentAbbreviations=()=>d().abbreviations,i.currentDelimiters=()=>d().delimiters,i.currentOrdinal=()=>d().ordinal,i.currentDefaults=()=>Object.assign({},d().defaults,l),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().timeFormat),i.setDefaults=g=>{g=r.parseFormat(g),e.validateFormat(g)&&(l=g)},i.getZeroFormat=()=>o,i.setZeroFormat=g=>o=typeof g=="string"?g:null,i.hasZeroFormat=()=>o!==null,i.languageData=g=>{if(g){if(n[g])return n[g];throw new Error(`Unknown tag "${g}"`)}return d()},i.registerLanguage=(g,y=!1)=>{if(!e.validateLanguage(g))throw new Error("Invalid language data");n[g.languageTag]=g,y&&h(g.languageTag)},i.setLanguage=(g,y=t.languageTag)=>{if(!n[g]){let C=g.split("-")[0],x=Object.keys(n).find(_=>_.split("-")[0]===C);if(!n[x]){h(y);return}h(x);return}h(g)},i.registerLanguage(t),s=t.languageTag,XO=i,XO}function vIe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function wIe(t,e){t.forEach(r=>{let i;try{i=vIe(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}i&&e.registerLanguage(i)})}var yIe=t=>({loadLanguagesInNode:e=>wIe(e,t)}),kJ={exports:{}};(function(t){(function(e){var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,n=Math.floor,o="[BigNumber Error] ",l=o+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,g=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],C=1e7,x=1e9;function _(te){var Y,oe,me,de=H.prototype={constructor:H,toString:null,valueOf:null},ye=new H(1),Ee=20,ke=4,nt=-7,at=21,Ze=-1e7,Xe=1e7,Pe=!1,Be=1,Me=0,A={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},O="0123456789abcdefghijklmnopqrstuvwxyz",N=!0;function H(z,q){var re,ve,ce,Re,Oe,he,Ie,De,$e=this;if(!($e instanceof H))return new H(z,q);if(q==null){if(z&&z._isBigNumber===!0){$e.s=z.s,!z.c||z.e>Xe?$e.c=$e.e=null:z.e<Ze?$e.c=[$e.e=0]:($e.e=z.e,$e.c=z.c.slice());return}if((he=typeof z=="number")&&z*0==0){if($e.s=1/z<0?(z=-z,-1):1,z===~~z){for(Re=0,Oe=z;Oe>=10;Oe/=10,Re++);Re>Xe?$e.c=$e.e=null:($e.e=Re,$e.c=[z]);return}De=String(z)}else{if(!i.test(De=String(z)))return me($e,De,he);$e.s=De.charCodeAt(0)==45?(De=De.slice(1),-1):1}(Re=De.indexOf("."))>-1&&(De=De.replace(".","")),(Oe=De.search(/e/i))>0?(Re<0&&(Re=Oe),Re+=+De.slice(Oe+1),De=De.substring(0,Oe)):Re<0&&(Re=De.length)}else{if(F(q,2,O.length,"Base"),q==10&&N)return $e=new H(z),we($e,Ee+$e.e+1,ke);if(De=String(z),he=typeof z=="number"){if(z*0!=0)return me($e,De,he,q);if($e.s=1/z<0?(De=De.slice(1),-1):1,H.DEBUG&&De.replace(/^0\.0*|\./,"").length>15)throw Error(l+z)}else $e.s=De.charCodeAt(0)===45?(De=De.slice(1),-1):1;for(re=O.slice(0,q),Re=Oe=0,Ie=De.length;Oe<Ie;Oe++)if(re.indexOf(ve=De.charAt(Oe))<0){if(ve=="."){if(Oe>Re){Re=Ie;continue}}else if(!ce&&(De==De.toUpperCase()&&(De=De.toLowerCase())||De==De.toLowerCase()&&(De=De.toUpperCase()))){ce=!0,Oe=-1,Re=0;continue}return me($e,String(z),he,q)}he=!1,De=oe(De,q,10,$e.s),(Re=De.indexOf("."))>-1?De=De.replace(".",""):Re=De.length}for(Oe=0;De.charCodeAt(Oe)===48;Oe++);for(Ie=De.length;De.charCodeAt(--Ie)===48;);if(De=De.slice(Oe,++Ie)){if(Ie-=Oe,he&&H.DEBUG&&Ie>15&&(z>g||z!==n(z)))throw Error(l+$e.s*z);if((Re=Re-Oe-1)>Xe)$e.c=$e.e=null;else if(Re<Ze)$e.c=[$e.e=0];else{if($e.e=Re,$e.c=[],Oe=(Re+1)%d,Re<0&&(Oe+=d),Oe<Ie){for(Oe&&$e.c.push(+De.slice(0,Oe)),Ie-=d;Oe<Ie;)$e.c.push(+De.slice(Oe,Oe+=d));Oe=d-(De=De.slice(Oe)).length}else Oe-=Ie;for(;Oe--;De+="0");$e.c.push(+De)}}else $e.c=[$e.e=0]}H.clone=_,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(z){var q,re;if(z!=null)if(typeof z=="object"){if(z.hasOwnProperty(q="DECIMAL_PLACES")&&(re=z[q],F(re,0,x,q),Ee=re),z.hasOwnProperty(q="ROUNDING_MODE")&&(re=z[q],F(re,0,8,q),ke=re),z.hasOwnProperty(q="EXPONENTIAL_AT")&&(re=z[q],re&&re.pop?(F(re[0],-x,0,q),F(re[1],0,x,q),nt=re[0],at=re[1]):(F(re,-x,x,q),nt=-(at=re<0?-re:re))),z.hasOwnProperty(q="RANGE"))if(re=z[q],re&&re.pop)F(re[0],-x,-1,q),F(re[1],1,x,q),Ze=re[0],Xe=re[1];else if(F(re,-x,x,q),re)Ze=-(Xe=re<0?-re:re);else throw Error(o+q+" cannot be zero: "+re);if(z.hasOwnProperty(q="CRYPTO"))if(re=z[q],re===!!re)if(re)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Pe=re;else throw Pe=!re,Error(o+"crypto unavailable");else Pe=re;else throw Error(o+q+" not true or false: "+re);if(z.hasOwnProperty(q="MODULO_MODE")&&(re=z[q],F(re,0,9,q),Be=re),z.hasOwnProperty(q="POW_PRECISION")&&(re=z[q],F(re,0,x,q),Me=re),z.hasOwnProperty(q="FORMAT"))if(re=z[q],typeof re=="object")A=re;else throw Error(o+q+" not an object: "+re);if(z.hasOwnProperty(q="ALPHABET"))if(re=z[q],typeof re=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(re))N=re.slice(0,10)=="0123456789",O=re;else throw Error(o+q+" invalid: "+re)}else throw Error(o+"Object expected: "+z);return{DECIMAL_PLACES:Ee,ROUNDING_MODE:ke,EXPONENTIAL_AT:[nt,at],RANGE:[Ze,Xe],CRYPTO:Pe,MODULO_MODE:Be,POW_PRECISION:Me,FORMAT:A,ALPHABET:O}},H.isBigNumber=function(z){if(!z||z._isBigNumber!==!0)return!1;if(!H.DEBUG)return!0;var q,re,ve=z.c,ce=z.e,Re=z.s;e:if({}.toString.call(ve)=="[object Array]"){if((Re===1||Re===-1)&&ce>=-x&&ce<=x&&ce===n(ce)){if(ve[0]===0){if(ce===0&&ve.length===1)return!0;break e}if(q=(ce+1)%d,q<1&&(q+=d),String(ve[0]).length==q){for(q=0;q<ve.length;q++)if(re=ve[q],re<0||re>=h||re!==n(re))break e;if(re!==0)return!0}}}else if(ve===null&&ce===null&&(Re===null||Re===1||Re===-1))return!0;throw Error(o+"Invalid BigNumber: "+z)},H.maximum=H.max=function(){return K(arguments,-1)},H.minimum=H.min=function(){return K(arguments,1)},H.random=function(){var z=9007199254740992,q=Math.random()*z&2097151?function(){return n(Math.random()*z)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(re){var ve,ce,Re,Oe,he,Ie=0,De=[],$e=new H(ye);if(re==null?re=Ee:F(re,0,x),Oe=s(re/d),Pe)if(crypto.getRandomValues){for(ve=crypto.getRandomValues(new Uint32Array(Oe*=2));Ie<Oe;)he=ve[Ie]*131072+(ve[Ie+1]>>>11),he>=9e15?(ce=crypto.getRandomValues(new Uint32Array(2)),ve[Ie]=ce[0],ve[Ie+1]=ce[1]):(De.push(he%1e14),Ie+=2);Ie=Oe/2}else if(crypto.randomBytes){for(ve=crypto.randomBytes(Oe*=7);Ie<Oe;)he=(ve[Ie]&31)*281474976710656+ve[Ie+1]*1099511627776+ve[Ie+2]*4294967296+ve[Ie+3]*16777216+(ve[Ie+4]<<16)+(ve[Ie+5]<<8)+ve[Ie+6],he>=9e15?crypto.randomBytes(7).copy(ve,Ie):(De.push(he%1e14),Ie+=7);Ie=Oe/7}else throw Pe=!1,Error(o+"crypto unavailable");if(!Pe)for(;Ie<Oe;)he=q(),he<9e15&&(De[Ie++]=he%1e14);for(Oe=De[--Ie],re%=d,Oe&&re&&(he=y[d-re],De[Ie]=n(Oe/he)*he);De[Ie]===0;De.pop(),Ie--);if(Ie<0)De=[Re=0];else{for(Re=-1;De[0]===0;De.splice(0,1),Re-=d);for(Ie=1,he=De[0];he>=10;he/=10,Ie++);Ie<d&&(Re-=d-Ie)}return $e.e=Re,$e.c=De,$e}}(),H.sum=function(){for(var z=1,q=arguments,re=new H(q[0]);z<q.length;)re=re.plus(q[z++]);return re},oe=function(){var z="0123456789";function q(re,ve,ce,Re){for(var Oe,he=[0],Ie,De=0,$e=re.length;De<$e;){for(Ie=he.length;Ie--;he[Ie]*=ve);for(he[0]+=Re.indexOf(re.charAt(De++)),Oe=0;Oe<he.length;Oe++)he[Oe]>ce-1&&(he[Oe+1]==null&&(he[Oe+1]=0),he[Oe+1]+=he[Oe]/ce|0,he[Oe]%=ce)}return he.reverse()}return function(re,ve,ce,Re,Oe){var he,Ie,De,$e,qe,Ft,bt,Gt,Lr=re.indexOf("."),Or=Ee,sr=ke;for(Lr>=0&&($e=Me,Me=0,re=re.replace(".",""),Gt=new H(ve),Ft=Gt.pow(re.length-Lr),Me=$e,Gt.c=q(X(R(Ft.c),Ft.e,"0"),10,ce,z),Gt.e=Gt.c.length),bt=q(re,ve,ce,Oe?(he=O,z):(he=z,O)),De=$e=bt.length;bt[--$e]==0;bt.pop());if(!bt[0])return he.charAt(0);if(Lr<0?--De:(Ft.c=bt,Ft.e=De,Ft.s=Re,Ft=Y(Ft,Gt,Or,sr,ce),bt=Ft.c,qe=Ft.r,De=Ft.e),Ie=De+Or+1,Lr=bt[Ie],$e=ce/2,qe=qe||Ie<0||bt[Ie+1]!=null,qe=sr<4?(Lr!=null||qe)&&(sr==0||sr==(Ft.s<0?3:2)):Lr>$e||Lr==$e&&(sr==4||qe||sr==6&&bt[Ie-1]&1||sr==(Ft.s<0?8:7)),Ie<1||!bt[0])re=qe?X(he.charAt(1),-Or,he.charAt(0)):he.charAt(0);else{if(bt.length=Ie,qe)for(--ce;++bt[--Ie]>ce;)bt[Ie]=0,Ie||(++De,bt=[1].concat(bt));for($e=bt.length;!bt[--$e];);for(Lr=0,re="";Lr<=$e;re+=he.charAt(bt[Lr++]));re=X(re,De,he.charAt(0))}return re}}(),Y=function(){function z(ve,ce,Re){var Oe,he,Ie,De,$e=0,qe=ve.length,Ft=ce%C,bt=ce/C|0;for(ve=ve.slice();qe--;)Ie=ve[qe]%C,De=ve[qe]/C|0,Oe=bt*Ie+De*Ft,he=Ft*Ie+Oe%C*C+$e,$e=(he/Re|0)+(Oe/C|0)+bt*De,ve[qe]=he%Re;return $e&&(ve=[$e].concat(ve)),ve}function q(ve,ce,Re,Oe){var he,Ie;if(Re!=Oe)Ie=Re>Oe?1:-1;else for(he=Ie=0;he<Re;he++)if(ve[he]!=ce[he]){Ie=ve[he]>ce[he]?1:-1;break}return Ie}function re(ve,ce,Re,Oe){for(var he=0;Re--;)ve[Re]-=he,he=ve[Re]<ce[Re]?1:0,ve[Re]=he*Oe+ve[Re]-ce[Re];for(;!ve[0]&&ve.length>1;ve.splice(0,1));}return function(ve,ce,Re,Oe,he){var Ie,De,$e,qe,Ft,bt,Gt,Lr,Or,sr,er,Hn,Si,et,ot,ft,Nt,vr=ve.s==ce.s?1:-1,cr=ve.c,Tr=ce.c;if(!cr||!cr[0]||!Tr||!Tr[0])return new H(!ve.s||!ce.s||(cr?Tr&&cr[0]==Tr[0]:!Tr)?NaN:cr&&cr[0]==0||!Tr?vr*0:vr/0);for(Lr=new H(vr),Or=Lr.c=[],De=ve.e-ce.e,vr=Re+De+1,he||(he=h,De=E(ve.e/d)-E(ce.e/d),vr=vr/d|0),$e=0;Tr[$e]==(cr[$e]||0);$e++);if(Tr[$e]>(cr[$e]||0)&&De--,vr<0)Or.push(1),qe=!0;else{for(et=cr.length,ft=Tr.length,$e=0,vr+=2,Ft=n(he/(Tr[0]+1)),Ft>1&&(Tr=z(Tr,Ft,he),cr=z(cr,Ft,he),ft=Tr.length,et=cr.length),Si=ft,sr=cr.slice(0,ft),er=sr.length;er<ft;sr[er++]=0);Nt=Tr.slice(),Nt=[0].concat(Nt),ot=Tr[0],Tr[1]>=he/2&&ot++;do{if(Ft=0,Ie=q(Tr,sr,ft,er),Ie<0){if(Hn=sr[0],ft!=er&&(Hn=Hn*he+(sr[1]||0)),Ft=n(Hn/ot),Ft>1)for(Ft>=he&&(Ft=he-1),bt=z(Tr,Ft,he),Gt=bt.length,er=sr.length;q(bt,sr,Gt,er)==1;)Ft--,re(bt,ft<Gt?Nt:Tr,Gt,he),Gt=bt.length,Ie=1;else Ft==0&&(Ie=Ft=1),bt=Tr.slice(),Gt=bt.length;if(Gt<er&&(bt=[0].concat(bt)),re(sr,bt,er,he),er=sr.length,Ie==-1)for(;q(Tr,sr,ft,er)<1;)Ft++,re(sr,ft<er?Nt:Tr,er,he),er=sr.length}else Ie===0&&(Ft++,sr=[0]);Or[$e++]=Ft,sr[0]?sr[er++]=cr[Si]||0:(sr=[cr[Si]],er=1)}while((Si++<et||sr[0]!=null)&&vr--);qe=sr[0]!=null,Or[0]||Or.splice(0,1)}if(he==h){for($e=1,vr=Or[0];vr>=10;vr/=10,$e++);we(Lr,Re+(Lr.e=$e+De*d-1)+1,Oe,qe)}else Lr.e=De,Lr.r=+qe;return Lr}}();function B(z,q,re,ve){var ce,Re,Oe,he,Ie;if(re==null?re=ke:F(re,0,8),!z.c)return z.toString();if(ce=z.c[0],Oe=z.e,q==null)Ie=R(z.c),Ie=ve==1||ve==2&&(Oe<=nt||Oe>=at)?U(Ie,Oe):X(Ie,Oe,"0");else if(z=we(new H(z),q,re),Re=z.e,Ie=R(z.c),he=Ie.length,ve==1||ve==2&&(q<=Re||Re<=nt)){for(;he<q;Ie+="0",he++);Ie=U(Ie,Re)}else if(q-=Oe,Ie=X(Ie,Re,"0"),Re+1>he){if(--q>0)for(Ie+=".";q--;Ie+="0");}else if(q+=Re-he,q>0)for(Re+1==he&&(Ie+=".");q--;Ie+="0");return z.s<0&&ce?"-"+Ie:Ie}function K(z,q){for(var re,ve,ce=1,Re=new H(z[0]);ce<z.length;ce++)ve=new H(z[ce]),(!ve.s||(re=I(Re,ve))===q||re===0&&Re.s===q)&&(Re=ve);return Re}function Z(z,q,re){for(var ve=1,ce=q.length;!q[--ce];q.pop());for(ce=q[0];ce>=10;ce/=10,ve++);return(re=ve+re*d-1)>Xe?z.c=z.e=null:re<Ze?z.c=[z.e=0]:(z.e=re,z.c=q),z}me=function(){var z=/^(-?)0([xbo])(?=\w[\w.]*$)/i,q=/^([^.]+)\.$/,re=/^\.([^.]+)$/,ve=/^-?(Infinity|NaN)$/,ce=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(Re,Oe,he,Ie){var De,$e=he?Oe:Oe.replace(ce,"");if(ve.test($e))Re.s=isNaN($e)?null:$e<0?-1:1;else{if(!he&&($e=$e.replace(z,function(qe,Ft,bt){return De=(bt=bt.toLowerCase())=="x"?16:bt=="b"?2:8,!Ie||Ie==De?Ft:qe}),Ie&&(De=Ie,$e=$e.replace(q,"$1").replace(re,"0.$1")),Oe!=$e))return new H($e,De);if(H.DEBUG)throw Error(o+"Not a"+(Ie?" base "+Ie:"")+" number: "+Oe);Re.s=null}Re.c=Re.e=null}}();function we(z,q,re,ve){var ce,Re,Oe,he,Ie,De,$e,qe=z.c,Ft=y;if(qe){e:{for(ce=1,he=qe[0];he>=10;he/=10,ce++);if(Re=q-ce,Re<0)Re+=d,Oe=q,Ie=qe[De=0],$e=n(Ie/Ft[ce-Oe-1]%10);else if(De=s((Re+1)/d),De>=qe.length)if(ve){for(;qe.length<=De;qe.push(0));Ie=$e=0,ce=1,Re%=d,Oe=Re-d+1}else break e;else{for(Ie=he=qe[De],ce=1;he>=10;he/=10,ce++);Re%=d,Oe=Re-d+ce,$e=Oe<0?0:n(Ie/Ft[ce-Oe-1]%10)}if(ve=ve||q<0||qe[De+1]!=null||(Oe<0?Ie:Ie%Ft[ce-Oe-1]),ve=re<4?($e||ve)&&(re==0||re==(z.s<0?3:2)):$e>5||$e==5&&(re==4||ve||re==6&&(Re>0?Oe>0?Ie/Ft[ce-Oe]:0:qe[De-1])%10&1||re==(z.s<0?8:7)),q<1||!qe[0])return qe.length=0,ve?(q-=z.e+1,qe[0]=Ft[(d-q%d)%d],z.e=-q||0):qe[0]=z.e=0,z;if(Re==0?(qe.length=De,he=1,De--):(qe.length=De+1,he=Ft[d-Re],qe[De]=Oe>0?n(Ie/Ft[ce-Oe]%Ft[Oe])*he:0),ve)for(;;)if(De==0){for(Re=1,Oe=qe[0];Oe>=10;Oe/=10,Re++);for(Oe=qe[0]+=he,he=1;Oe>=10;Oe/=10,he++);Re!=he&&(z.e++,qe[0]==h&&(qe[0]=1));break}else{if(qe[De]+=he,qe[De]!=h)break;qe[De--]=0,he=1}for(Re=qe.length;qe[--Re]===0;qe.pop());}z.e>Xe?z.c=z.e=null:z.e<Ze&&(z.c=[z.e=0])}return z}function Ce(z){var q,re=z.e;return re===null?z.toString():(q=R(z.c),q=re<=nt||re>=at?U(q,re):X(q,re,"0"),z.s<0?"-"+q:q)}return de.absoluteValue=de.abs=function(){var z=new H(this);return z.s<0&&(z.s=1),z},de.comparedTo=function(z,q){return I(this,new H(z,q))},de.decimalPlaces=de.dp=function(z,q){var re,ve,ce,Re=this;if(z!=null)return F(z,0,x),q==null?q=ke:F(q,0,8),we(new H(Re),z+Re.e+1,q);if(!(re=Re.c))return null;if(ve=((ce=re.length-1)-E(this.e/d))*d,ce=re[ce])for(;ce%10==0;ce/=10,ve--);return ve<0&&(ve=0),ve},de.dividedBy=de.div=function(z,q){return Y(this,new H(z,q),Ee,ke)},de.dividedToIntegerBy=de.idiv=function(z,q){return Y(this,new H(z,q),0,1)},de.exponentiatedBy=de.pow=function(z,q){var re,ve,ce,Re,Oe,he,Ie,De,$e,qe=this;if(z=new H(z),z.c&&!z.isInteger())throw Error(o+"Exponent not an integer: "+Ce(z));if(q!=null&&(q=new H(q)),he=z.e>14,!qe.c||!qe.c[0]||qe.c[0]==1&&!qe.e&&qe.c.length==1||!z.c||!z.c[0])return $e=new H(Math.pow(+Ce(qe),he?z.s*(2-D(z)):+Ce(z))),q?$e.mod(q):$e;if(Ie=z.s<0,q){if(q.c?!q.c[0]:!q.s)return new H(NaN);ve=!Ie&&qe.isInteger()&&q.isInteger(),ve&&(qe=qe.mod(q))}else{if(z.e>9&&(qe.e>0||qe.e<-1||(qe.e==0?qe.c[0]>1||he&&qe.c[1]>=24e7:qe.c[0]<8e13||he&&qe.c[0]<=9999975e7)))return Re=qe.s<0&&D(z)?-0:0,qe.e>-1&&(Re=1/Re),new H(Ie?1/Re:Re);Me&&(Re=s(Me/d+2))}for(he?(re=new H(.5),Ie&&(z.s=1),De=D(z)):(ce=Math.abs(+Ce(z)),De=ce%2),$e=new H(ye);;){if(De){if($e=$e.times(qe),!$e.c)break;Re?$e.c.length>Re&&($e.c.length=Re):ve&&($e=$e.mod(q))}if(ce){if(ce=n(ce/2),ce===0)break;De=ce%2}else if(z=z.times(re),we(z,z.e+1,1),z.e>14)De=D(z);else{if(ce=+Ce(z),ce===0)break;De=ce%2}qe=qe.times(qe),Re?qe.c&&qe.c.length>Re&&(qe.c.length=Re):ve&&(qe=qe.mod(q))}return ve?$e:(Ie&&($e=ye.div($e)),q?$e.mod(q):Re?we($e,Me,ke,Oe):$e)},de.integerValue=function(z){var q=new H(this);return z==null?z=ke:F(z,0,8),we(q,q.e+1,z)},de.isEqualTo=de.eq=function(z,q){return I(this,new H(z,q))===0},de.isFinite=function(){return!!this.c},de.isGreaterThan=de.gt=function(z,q){return I(this,new H(z,q))>0},de.isGreaterThanOrEqualTo=de.gte=function(z,q){return(q=I(this,new H(z,q)))===1||q===0},de.isInteger=function(){return!!this.c&&E(this.e/d)>this.c.length-2},de.isLessThan=de.lt=function(z,q){return I(this,new H(z,q))<0},de.isLessThanOrEqualTo=de.lte=function(z,q){return(q=I(this,new H(z,q)))===-1||q===0},de.isNaN=function(){return!this.s},de.isNegative=function(){return this.s<0},de.isPositive=function(){return this.s>0},de.isZero=function(){return!!this.c&&this.c[0]==0},de.minus=function(z,q){var re,ve,ce,Re,Oe=this,he=Oe.s;if(z=new H(z,q),q=z.s,!he||!q)return new H(NaN);if(he!=q)return z.s=-q,Oe.plus(z);var Ie=Oe.e/d,De=z.e/d,$e=Oe.c,qe=z.c;if(!Ie||!De){if(!$e||!qe)return $e?(z.s=-q,z):new H(qe?Oe:NaN);if(!$e[0]||!qe[0])return qe[0]?(z.s=-q,z):new H($e[0]?Oe:ke==3?-0:0)}if(Ie=E(Ie),De=E(De),$e=$e.slice(),he=Ie-De){for((Re=he<0)?(he=-he,ce=$e):(De=Ie,ce=qe),ce.reverse(),q=he;q--;ce.push(0));ce.reverse()}else for(ve=(Re=(he=$e.length)<(q=qe.length))?he:q,he=q=0;q<ve;q++)if($e[q]!=qe[q]){Re=$e[q]<qe[q];break}if(Re&&(ce=$e,$e=qe,qe=ce,z.s=-z.s),q=(ve=qe.length)-(re=$e.length),q>0)for(;q--;$e[re++]=0);for(q=h-1;ve>he;){if($e[--ve]<qe[ve]){for(re=ve;re&&!$e[--re];$e[re]=q);--$e[re],$e[ve]+=h}$e[ve]-=qe[ve]}for(;$e[0]==0;$e.splice(0,1),--De);return $e[0]?Z(z,$e,De):(z.s=ke==3?-1:1,z.c=[z.e=0],z)},de.modulo=de.mod=function(z,q){var re,ve,ce=this;return z=new H(z,q),!ce.c||!z.s||z.c&&!z.c[0]?new H(NaN):!z.c||ce.c&&!ce.c[0]?new H(ce):(Be==9?(ve=z.s,z.s=1,re=Y(ce,z,0,3),z.s=ve,re.s*=ve):re=Y(ce,z,0,Be),z=ce.minus(re.times(z)),!z.c[0]&&Be==1&&(z.s=ce.s),z)},de.multipliedBy=de.times=function(z,q){var re,ve,ce,Re,Oe,he,Ie,De,$e,qe,Ft,bt,Gt,Lr,Or,sr=this,er=sr.c,Hn=(z=new H(z,q)).c;if(!er||!Hn||!er[0]||!Hn[0])return!sr.s||!z.s||er&&!er[0]&&!Hn||Hn&&!Hn[0]&&!er?z.c=z.e=z.s=null:(z.s*=sr.s,!er||!Hn?z.c=z.e=null:(z.c=[0],z.e=0)),z;for(ve=E(sr.e/d)+E(z.e/d),z.s*=sr.s,Ie=er.length,qe=Hn.length,Ie<qe&&(Gt=er,er=Hn,Hn=Gt,ce=Ie,Ie=qe,qe=ce),ce=Ie+qe,Gt=[];ce--;Gt.push(0));for(Lr=h,Or=C,ce=qe;--ce>=0;){for(re=0,Ft=Hn[ce]%Or,bt=Hn[ce]/Or|0,Oe=Ie,Re=ce+Oe;Re>ce;)De=er[--Oe]%Or,$e=er[Oe]/Or|0,he=bt*De+$e*Ft,De=Ft*De+he%Or*Or+Gt[Re]+re,re=(De/Lr|0)+(he/Or|0)+bt*$e,Gt[Re--]=De%Lr;Gt[Re]=re}return re?++ve:Gt.splice(0,1),Z(z,Gt,ve)},de.negated=function(){var z=new H(this);return z.s=-z.s||null,z},de.plus=function(z,q){var re,ve=this,ce=ve.s;if(z=new H(z,q),q=z.s,!ce||!q)return new H(NaN);if(ce!=q)return z.s=-q,ve.minus(z);var Re=ve.e/d,Oe=z.e/d,he=ve.c,Ie=z.c;if(!Re||!Oe){if(!he||!Ie)return new H(ce/0);if(!he[0]||!Ie[0])return Ie[0]?z:new H(he[0]?ve:ce*0)}if(Re=E(Re),Oe=E(Oe),he=he.slice(),ce=Re-Oe){for(ce>0?(Oe=Re,re=Ie):(ce=-ce,re=he),re.reverse();ce--;re.push(0));re.reverse()}for(ce=he.length,q=Ie.length,ce-q<0&&(re=Ie,Ie=he,he=re,q=ce),ce=0;q;)ce=(he[--q]=he[q]+Ie[q]+ce)/h|0,he[q]=h===he[q]?0:he[q]%h;return ce&&(he=[ce].concat(he),++Oe),Z(z,he,Oe)},de.precision=de.sd=function(z,q){var re,ve,ce,Re=this;if(z!=null&&z!==!!z)return F(z,1,x),q==null?q=ke:F(q,0,8),we(new H(Re),z,q);if(!(re=Re.c))return null;if(ce=re.length-1,ve=ce*d+1,ce=re[ce]){for(;ce%10==0;ce/=10,ve--);for(ce=re[0];ce>=10;ce/=10,ve++);}return z&&Re.e+1>ve&&(ve=Re.e+1),ve},de.shiftedBy=function(z){return F(z,-g,g),this.times("1e"+z)},de.squareRoot=de.sqrt=function(){var z,q,re,ve,ce,Re=this,Oe=Re.c,he=Re.s,Ie=Re.e,De=Ee+4,$e=new H("0.5");if(he!==1||!Oe||!Oe[0])return new H(!he||he<0&&(!Oe||Oe[0])?NaN:Oe?Re:1/0);if(he=Math.sqrt(+Ce(Re)),he==0||he==1/0?(q=R(Oe),(q.length+Ie)%2==0&&(q+="0"),he=Math.sqrt(+q),Ie=E((Ie+1)/2)-(Ie<0||Ie%2),he==1/0?q="5e"+Ie:(q=he.toExponential(),q=q.slice(0,q.indexOf("e")+1)+Ie),re=new H(q)):re=new H(he+""),re.c[0]){for(Ie=re.e,he=Ie+De,he<3&&(he=0);;)if(ce=re,re=$e.times(ce.plus(Y(Re,ce,De,1))),R(ce.c).slice(0,he)===(q=R(re.c)).slice(0,he))if(re.e<Ie&&--he,q=q.slice(he-3,he+1),q=="9999"||!ve&&q=="4999"){if(!ve&&(we(ce,ce.e+Ee+2,0),ce.times(ce).eq(Re))){re=ce;break}De+=4,he+=4,ve=1}else{(!+q||!+q.slice(1)&&q.charAt(0)=="5")&&(we(re,re.e+Ee+2,1),z=!re.times(re).eq(Re));break}}return we(re,re.e+Ee+1,ke,z)},de.toExponential=function(z,q){return z!=null&&(F(z,0,x),z++),B(this,z,q,1)},de.toFixed=function(z,q){return z!=null&&(F(z,0,x),z=z+this.e+1),B(this,z,q)},de.toFormat=function(z,q,re){var ve,ce=this;if(re==null)z!=null&&q&&typeof q=="object"?(re=q,q=null):z&&typeof z=="object"?(re=z,z=q=null):re=A;else if(typeof re!="object")throw Error(o+"Argument not an object: "+re);if(ve=ce.toFixed(z,q),ce.c){var Re,Oe=ve.split("."),he=+re.groupSize,Ie=+re.secondaryGroupSize,De=re.groupSeparator||"",$e=Oe[0],qe=Oe[1],Ft=ce.s<0,bt=Ft?$e.slice(1):$e,Gt=bt.length;if(Ie&&(Re=he,he=Ie,Ie=Re,Gt-=Re),he>0&&Gt>0){for(Re=Gt%he||he,$e=bt.substr(0,Re);Re<Gt;Re+=he)$e+=De+bt.substr(Re,he);Ie>0&&($e+=De+bt.slice(Re)),Ft&&($e="-"+$e)}ve=qe?$e+(re.decimalSeparator||"")+((Ie=+re.fractionGroupSize)?qe.replace(new RegExp("\\d{"+Ie+"}\\B","g"),"$&"+(re.fractionGroupSeparator||"")):qe):$e}return(re.prefix||"")+ve+(re.suffix||"")},de.toFraction=function(z){var q,re,ve,ce,Re,Oe,he,Ie,De,$e,qe,Ft,bt=this,Gt=bt.c;if(z!=null&&(he=new H(z),!he.isInteger()&&(he.c||he.s!==1)||he.lt(ye)))throw Error(o+"Argument "+(he.isInteger()?"out of range: ":"not an integer: ")+Ce(he));if(!Gt)return new H(bt);for(q=new H(ye),De=re=new H(ye),ve=Ie=new H(ye),Ft=R(Gt),Re=q.e=Ft.length-bt.e-1,q.c[0]=y[(Oe=Re%d)<0?d+Oe:Oe],z=!z||he.comparedTo(q)>0?Re>0?q:De:he,Oe=Xe,Xe=1/0,he=new H(Ft),Ie.c[0]=0;$e=Y(he,q,0,1),ce=re.plus($e.times(ve)),ce.comparedTo(z)!=1;)re=ve,ve=ce,De=Ie.plus($e.times(ce=De)),Ie=ce,q=he.minus($e.times(ce=q)),he=ce;return ce=Y(z.minus(re),ve,0,1),Ie=Ie.plus(ce.times(De)),re=re.plus(ce.times(ve)),Ie.s=De.s=bt.s,Re=Re*2,qe=Y(De,ve,Re,ke).minus(bt).abs().comparedTo(Y(Ie,re,Re,ke).minus(bt).abs())<1?[De,ve]:[Ie,re],Xe=Oe,qe},de.toNumber=function(){return+Ce(this)},de.toPrecision=function(z,q){return z!=null&&F(z,1,x),B(this,z,q,2)},de.toString=function(z){var q,re=this,ve=re.s,ce=re.e;return ce===null?ve?(q="Infinity",ve<0&&(q="-"+q)):q="NaN":(z==null?q=ce<=nt||ce>=at?U(R(re.c),ce):X(R(re.c),ce,"0"):z===10&&N?(re=we(new H(re),Ee+ce+1,ke),q=X(R(re.c),re.e,"0")):(F(z,2,O.length,"Base"),q=oe(X(R(re.c),ce,"0"),10,z,ve,!0)),ve<0&&re.c[0]&&(q="-"+q)),q},de.valueOf=de.toJSON=function(){return Ce(this)},de._isBigNumber=!0,te!=null&&H.set(te),H}function E(te){var Y=te|0;return te>0||te===Y?Y:Y-1}function R(te){for(var Y,oe,me=1,de=te.length,ye=te[0]+"";me<de;){for(Y=te[me++]+"",oe=d-Y.length;oe--;Y="0"+Y);ye+=Y}for(de=ye.length;ye.charCodeAt(--de)===48;);return ye.slice(0,de+1||1)}function I(te,Y){var oe,me,de=te.c,ye=Y.c,Ee=te.s,ke=Y.s,nt=te.e,at=Y.e;if(!Ee||!ke)return null;if(oe=de&&!de[0],me=ye&&!ye[0],oe||me)return oe?me?0:-ke:Ee;if(Ee!=ke)return Ee;if(oe=Ee<0,me=nt==at,!de||!ye)return me?0:!de^oe?1:-1;if(!me)return nt>at^oe?1:-1;for(ke=(nt=de.length)<(at=ye.length)?nt:at,Ee=0;Ee<ke;Ee++)if(de[Ee]!=ye[Ee])return de[Ee]>ye[Ee]^oe?1:-1;return nt==at?0:nt>at^oe?1:-1}function F(te,Y,oe,me){if(te<Y||te>oe||te!==n(te))throw Error(o+(me||"Argument")+(typeof te=="number"?te<Y||te>oe?" out of range: ":" not an integer: ":" not a primitive number: ")+String(te))}function D(te){var Y=te.c.length-1;return E(te.e/d)==Y&&te.c[Y]%2!=0}function U(te,Y){return(te.length>1?te.charAt(0)+"."+te.slice(1):te)+(Y<0?"e":"e+")+Y}function X(te,Y,oe){var me,de;if(Y<0){for(de=oe+".";++Y;de+=oe);te=de+te}else if(me=te.length,++Y>me){for(de=oe,Y-=me;--Y;de+=oe);te+=de}else Y<me&&(te=te.slice(0,Y)+"."+te.slice(Y));return te}r=_(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(QOe)})(kJ);var NJ=kJ.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const dc=s6(),CIe=n6(),SIe=i6,bIe=NJ,Js={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},rS={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:DJ,decimalSuffixes:nT}=dc.currentBytes(),o6={general:{scale:1024,suffixes:nT,marker:"bd"},binary:{scale:1024,suffixes:DJ,marker:"b"},decimal:{scale:1e3,suffixes:nT,marker:"d"}};function xIe(t,e={},r){if(typeof e=="string"&&(e=SIe.parseFormat(e)),!CIe.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",n=e.postfix||"",o=EIe(t,e,r);return o=jIe(o,s),o=UIe(o,n),o}function EIe(t,e,r){switch(e.output){case"currency":return e=lp(e,dc.currentCurrencyDefaultFormat()),FIe(t,e,dc);case"percent":return e=lp(e,dc.currentPercentageDefaultFormat()),PIe(t,e,dc,r);case"byte":return e=lp(e,dc.currentByteDefaultFormat()),AIe(t,e,dc,r);case"time":return e=lp(e,dc.currentTimeDefaultFormat()),IIe(t);case"ordinal":return e=lp(e,dc.currentOrdinalDefaultFormat()),OIe(t,e,dc);case"number":default:return nS({instance:t,providedFormat:e,numbro:r})}}function TIe(t){let e=o6.decimal;return q_(t._value,e.suffixes,e.scale).suffix}function _Ie(t){let e=o6.binary;return q_(t._value,e.suffixes,e.scale).suffix}function RIe(t){let e=o6.general;return q_(t._value,e.suffixes,e.scale).suffix}function q_(t,e,r){let i=e[0],s=Math.abs(t);if(s>=r){for(let n=1;n<e.length;++n){let o=Math.pow(r,n),l=Math.pow(r,n+1);if(s>=o&&s<l){i=e[n],t=t/o;break}}i===e[0]&&(t=t/Math.pow(r,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function AIe(t,e,r,i){let s=e.base||"binary",n=Object.assign({},rS,e);const{binarySuffixes:o,decimalSuffixes:l}=r.currentBytes();let d={general:{scale:1024,suffixes:l||nT,marker:"bd"},binary:{scale:1024,suffixes:o||DJ,marker:"b"},decimal:{scale:1e3,suffixes:l||nT,marker:"d"}}[s],{value:g,suffix:y}=q_(t._value,d.suffixes,d.scale);return`${nS({instance:i(g),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${n.spaceSeparated?" ":""}${y}`}function OIe(t,e,r){let i=r.currentOrdinal(),s=Object.assign({},rS,e),n=nS({instance:t,providedFormat:e,state:r}),o=i(t._value);return`${n}${s.spaceSeparated?" ":""}${o}`}function IIe(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${i<10?"0":""}${i}`}function PIe(t,e,r,i){let s=e.prefixSymbol,n=nS({instance:i(t._value*100),providedFormat:e,state:r}),o=Object.assign({},rS,e);return s?`%${o.spaceSeparated?" ":""}${n}`:`${n}${o.spaceSeparated?" ":""}%`}function FIe(t,e,r){const i=r.currentCurrency();let s=Object.assign({},e),n=Object.assign({},rS,s),o,l="",h=!!n.totalLength||!!n.forceAverage||n.average,d=s.currencyPosition||i.position,g=s.currencySymbol||i.symbol;const y=n.spaceSeparatedCurrency!==void 0?n.spaceSeparatedCurrency:n.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),y&&(l=" "),d==="infix"&&(o=l+g+l);let C=nS({instance:t,providedFormat:s,state:r,decimalSeparator:o});return d==="prefix"&&(t._value<0&&n.negative==="sign"?C=`-${l}${g}${C.slice(1)}`:t._value>0&&n.forceSign?C=`+${l}${g}${C.slice(1)}`:C=g+l+C),(!d||d==="postfix")&&(l=!n.spaceSeparatedAbbreviation&&h?"":l,C=C+l+g),C}function MIe({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:i,spaceSeparated:s=!1,totalLength:n=0,roundingFunction:o=Math.round}){let l="",h=Math.abs(t),d=-1;if(e&&i[e]&&Js[e]?(l=i[e],t=t/Js[e]):h>=Js.trillion||r&&o(h/Js.trillion)===1?(l=i.trillion,t=t/Js.trillion):h<Js.trillion&&h>=Js.billion||r&&o(h/Js.billion)===1?(l=i.billion,t=t/Js.billion):h<Js.billion&&h>=Js.million||r&&o(h/Js.million)===1?(l=i.million,t=t/Js.million):(h<Js.million&&h>=Js.thousand||r&&o(h/Js.thousand)===1)&&(l=i.thousand,t=t/Js.thousand),l&&(l=(s?" ":"")+l),n){let y=t<0,C=t.toString().split(".")[0],x=y?C.length-1:C.length;d=Math.max(n-x,0)}return{value:t,abbreviation:l,mantissaPrecision:d}}function kIe({value:t,characteristicPrecision:e}){let[r,i]=t.toExponential().split("e"),s=+r;if(!e)return{value:s,abbreviation:`e${i}`};let n=1;return n<e&&(s=s*Math.pow(10,e-n),i=+i-(e-n),i=i>=0?`+${i}`:i),{value:s,abbreviation:`e${i}`}}function ux(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function NIe(t,e){let r=t.toString(),[i,s]=r.split("e"),[n,o=""]=i.split(".");if(+s>0)r=n+o+ux(s-o.length);else{let l=".";+n<0?l=`-0${l}`:l=`0${l}`;let h=(ux(-s-1)+Math.abs(n)+o).substr(0,e);h.length<e&&(h+=ux(e-h.length)),r=l+h}return+s>0&&e>0&&(r+=`.${ux(e)}`),r}function DIe(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?NIe(t,e):new bIe(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function LIe(t,e,r,i,s,n){if(i===-1)return t;let o=DIe(e,i,n),[l,h=""]=o.toString().split(".");if(h.match(/^0+$/)&&(r||s))return l;let d=h.match(/0+$/);return s&&d?`${l}.${h.toString().slice(0,d.index)}`:o.toString()}function HIe(t,e,r,i){let s=t,[n,o]=s.toString().split(".");if(n.match(/^-?0$/)&&r)return o?`${n.replace("0","")}.${o}`:n.replace("0","");const l=e<0&&n.indexOf("-")===0;if(l&&(n=n.slice(1),s=s.slice(1)),n.length<i){let h=i-n.length;for(let d=0;d<h;d++)s=`0${s}`}return l&&(s=`-${s}`),s.toString()}function $Ie(t,e){let r=[],i=0;for(let s=t;s>0;s--)i===e&&(r.unshift(s),i=0),i++;return r}function BIe(t,e,r,i,s){let n=i.currentDelimiters(),o=n.thousands;s=s||n.decimal;let l=n.thousandsSize||3,h=t.toString(),d=h.split(".")[0],g=h.split(".")[1];const y=e<0&&d.indexOf("-")===0;return r&&(y&&(d=d.slice(1)),$Ie(d.length,l).forEach((x,_)=>{d=d.slice(0,x+_)+o+d.slice(x+_)}),y&&(d=`-${d}`)),g?h=d+s+g:h=d,h}function VIe(t,e){return t+e}function WIe(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function jIe(t,e){return e+t}function UIe(t,e){return t+e}function nS({instance:t,providedFormat:e,state:r=dc,decimalSeparator:i,defaults:s=r.currentDefaults()}){let n=t._value;if(n===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(n))return n.toString();let o=Object.assign({},rS,s,e),l=o.totalLength,h=l?0:o.characteristic,d=o.optionalCharacteristic,g=o.forceAverage,y=o.lowPrecision,C=!!l||!!g||o.average,x=l?-1:C&&e.mantissa===void 0?0:o.mantissa,_=l?!1:e.optionalMantissa===void 0?x===-1:o.optionalMantissa,E=o.trimMantissa,R=o.thousandSeparated,I=o.spaceSeparated,F=o.negative,D=o.forceSign,U=o.exponential,X=o.roundingFunction,te="";if(C){let oe=MIe({value:n,forceAverage:g,lowPrecision:y,abbreviations:r.currentAbbreviations(),spaceSeparated:I,roundingFunction:X,totalLength:l});n=oe.value,te+=oe.abbreviation,l&&(x=oe.mantissaPrecision)}if(U){let oe=kIe({value:n,characteristicPrecision:h});n=oe.value,te=oe.abbreviation+te}let Y=LIe(n.toString(),n,_,x,E,X);return Y=HIe(Y,n,d,h),Y=BIe(Y,n,R,r,i),(C||U)&&(Y=VIe(Y,te)),(D||n<0)&&(Y=WIe(Y,n,F)),Y}function lp(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var zIe=t=>({format:(...e)=>xIe(...e,t),getByteUnit:(...e)=>RIe(...e,t),getBinaryByteUnit:(...e)=>_Ie(...e,t),getDecimalByteUnit:(...e)=>TIe(...e,t),formatOrDefault:lp});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const ef=NJ;function GIe(t,e,r){let i=new ef(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new ef(s),t._value=i.plus(s).toNumber(),t}function LJ(t,e,r){let i=new ef(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new ef(s),t._value=i.minus(s).toNumber(),t}function YIe(t,e,r){let i=new ef(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new ef(s),t._value=i.times(s).toNumber(),t}function KIe(t,e,r){let i=new ef(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new ef(s),t._value=i.dividedBy(s).toNumber(),t}function XIe(t,e,r){let i=e;return r.isNumbro(e)&&(i=e._value),t._value=i,t}function qIe(t,e,r){let i=r(t._value);return LJ(i,e,r),Math.abs(i._value)}var JIe=t=>({add:(e,r)=>GIe(e,r,t),subtract:(e,r)=>LJ(e,r,t),multiply:(e,r)=>YIe(e,r,t),divide:(e,r)=>KIe(e,r,t),set:(e,r)=>XIe(e,r,t),difference:(e,r)=>qIe(e,r,t),BigNumber:ef});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const QIe="2.5.0",qu=s6(),ZIe=n6(),e3e=yIe(Zi),t3e=MJ();let w0=zIe(Zi),K0=JIe(Zi);const r3e=i6;class HJ{constructor(e){this._value=e}clone(){return Zi(this._value)}format(e={}){return w0.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=r3e.parseFormat(e)),e=w0.formatOrDefault(e,qu.currentCurrencyDefaultFormat()),e.output="currency",w0.format(this,e)}formatTime(e={}){return e.output="time",w0.format(this,e)}binaryByteUnits(){return w0.getBinaryByteUnit(this)}decimalByteUnits(){return w0.getDecimalByteUnit(this)}byteUnits(){return w0.getByteUnit(this)}difference(e){return K0.difference(this,e)}add(e){return K0.add(this,e)}subtract(e){return K0.subtract(this,e)}multiply(e){return K0.multiply(this,e)}divide(e){return K0.divide(this,e)}set(e){return K0.set(this,$J(e))}value(){return this._value}valueOf(){return this._value}}function $J(t){let e=t;return Zi.isNumbro(t)?e=t._value:typeof t=="string"?e=Zi.unformat(t):isNaN(t)&&(e=NaN),e}function Zi(t){return new HJ($J(t))}Zi.version=QIe;Zi.isNumbro=function(t){return t instanceof HJ};Zi.language=qu.currentLanguage;Zi.registerLanguage=qu.registerLanguage;Zi.setLanguage=qu.setLanguage;Zi.languages=qu.languages;Zi.languageData=qu.languageData;Zi.zeroFormat=qu.setZeroFormat;Zi.defaultFormat=qu.currentDefaults;Zi.setDefaults=qu.setDefaults;Zi.defaultCurrencyFormat=qu.currentCurrencyDefaultFormat;Zi.validate=ZIe.validate;Zi.loadLanguagesInNode=e3e.loadLanguagesInNode;Zi.unformat=t3e.unformat;Zi.BigNumber=K0.BigNumber;var n3e=Zi,y0=ZOe(n3e);const i3e="numeric";function BJ(t,e){if(ea(t)){const r=e.numericFormat,i=r&&r.culture||"-",s=r&&r.pattern;if(typeof i<"u"&&!y0.languages()[i]){const n=i.replace("-",""),o=y0.allLanguages?y0.allLanguages[i]:y0[n];o&&y0.registerLanguage(o)}y0.setLanguage(i),t=y0(t).format(s||"0")}return t}function a6(t,e,r,i,s,n,o){let l=n;if(ea(l)){const h=o.className||"",d=h.length?h.split(" "):[];l=BJ(l,o),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),o.className=d.join(" "),e.dir="ltr"}ff(t,e,r,i,s,l,o)}a6.RENDERER_TYPE=i3e;const s3e="password";function l6(t,e,r,i,s,n,o){ff.apply(this,[t,e,r,i,s,n,o]);const l=o.hashLength||e.innerHTML.length,h=o.hashSymbol||"*";let d="";pr(l-1,()=>{d+=h}),M1(e,d)}l6.RENDERER_TYPE=s3e;const o3e="select";function c6(t,e,r,i,s,n,o){ff.apply(this,[t,e,r,i,s,n,o])}c6.RENDERER_TYPE=o3e;const a3e="time";function u6(t,e,r,i,s,n,o){ff.apply(this,[t,e,r,i,s,n,o]),e.dir="ltr"}u6.RENDERER_TYPE=a3e;function l3e(){El(D1),El(tS),El(e6),El(ZD),El(r6),El(QD),El(a6),El(l6),El(c6),El(ff),El(u6)}const c3e="autocomplete";function J_(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,$V(r,e)):$V(r,e)(this.source):e(!0)}J_.VALIDATOR_TYPE=c3e;function $V(t,e){const r=t;return function(i){let s=!1;for(let n=0,o=i.length;n<o;n++)if(r===i[n]){s=!0;break}e(s)}}function u3e(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const h3e="date";function h6(t,e){const r=uq(_J,this.instance);let i=t,s=!0;i==null&&(i="");let n=wt(i,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=wt(new Date(i)).isValid()||n;if(this.allowEmpty&&i===""&&(o=!0,n=!0),o||(s=!1),!o&&n&&(s=!0),o&&!n)if(this.correctFormat===!0){const l=f3e(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,l,"dateValidator"),s=!0}else s=!1;e(s)}h6.VALIDATOR_TYPE=h3e;function f3e(t,e){const r=wt(u3e(t)),i=wt(t,e),s=t.search(/[A-z]/g)>-1;let n;return r.isValid()&&r.format("x")===i.format("x")||!i.isValid()||s?n=r:n=i,n.format(e)}const d3e="dropdown";function f6(t,e){J_.apply(this,[t,e])}f6.VALIDATOR_TYPE=d3e;const g3e="numeric";function d6(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:ea(t))}d6.VALIDATOR_TYPE=g3e;const m3e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],p3e="time";function g6(t,e){const r=this.timeFormat||"h:mm:ss a";let i=!0,s=t;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const n=/^\d{1,2}$/.test(s);n&&(s+=":00");const o=wt(s,m3e,!0).isValid()?wt(s):wt(s,r);let l=o.isValid(),h=wt(s,r,!0).isValid()&&!n;if(this.allowEmpty&&s===""&&(l=!0,h=!0),l||(i=!1),!l&&h&&(i=!0),l&&!h)if(this.correctFormat===!0){const d=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;e(i)}g6.VALIDATOR_TYPE=p3e;function v3e(){ap(J_),ap(f6),ap(h6),ap(d6),ap(g6)}const w3e="autocomplete",y3e={CELL_TYPE:w3e,editor:XD,renderer:D1,validator:J_},C3e="checkbox",S3e={CELL_TYPE:C3e,editor:TJ,renderer:e6},b3e="date";function VJ(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}VJ.RENDERER_TYPE=b3e;const x3e="date",E3e={CELL_TYPE:x3e,editor:RJ,renderer:VJ,validator:h6},T3e="dropdown",_3e={CELL_TYPE:T3e,editor:JD,renderer:ZD,validator:f6},R3e="handsontable",A3e={CELL_TYPE:R3e,editor:KD,renderer:r6},O3e="numeric",I3e={CELL_TYPE:O3e,editor:AJ,renderer:a6,validator:d6,dataType:"number"},P3e="password",F3e={CELL_TYPE:P3e,editor:OJ,renderer:l6,copyable:!1},M3e="select",k3e={CELL_TYPE:M3e,editor:IJ,renderer:c6},N3e="time",D3e={CELL_TYPE:N3e,editor:PJ,renderer:u6,validator:g6};function L3e(){uc(y3e),uc(S3e),uc(E3e),uc(_3e),uc(A3e),uc(I3e),uc(F3e),uc(k3e),uc(mJ),uc(D3e)}function H3e(t,e){WJ(t,e),e.add(t)}function $3e(t,e,r){WJ(t,e),e.set(t,r)}function WJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Im(t,e,r){return(e=B3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B3e(t){var e=V3e(t,"string");return typeof e=="symbol"?e:e+""}function V3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pm(t,e){return t.get(jJ(t,e))}function jJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const BV=new Map([["plugin",qxe],["cell-type",sJ],["editor",cq],["renderer",vq],["validator",wq]]),UJ=Symbol("mainSetting"),W3e="base",hx=[];let su=null;var C0=new WeakMap,VV=new WeakSet;class On{static get PLUGIN_KEY(){return W3e}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){H3e(this,VV),Im(this,"eventManager",new Dc(this)),Im(this,"pluginName",null),Im(this,"pluginsInitializedCallbacks",[]),Im(this,"isPluginsReady",!1),Im(this,"enabled",!1),Im(this,"initialized",!1),$3e(this,C0,{}),uf(this,"hot",e,{writable:!1}),su=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const s=[];if(r.forEach(n=>{const[o,l]=n.split(":");if(!BV.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);BV.get(o)(l)||s.push(` - ${l} (${o})`)}),s.length>0){const n=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");hx.push(n)}}if(su||(su=pq()),su.indexOf("UndoRedo")>=0&&su.splice(su.indexOf("UndoRedo"),1),su.indexOf(this.pluginName)>=0&&su.splice(su.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),su.length===0){if(hx.length>0){const s=[`${hx.join(`
`)}
`,"You have to import and register them manually."].join("");throw hx.length=0,new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Qr(r))&&i[UJ]===e){var s;return Array.isArray(r)?r:(s=r[e])!==null&&s!==void 0?s:i[e]}if(Qr(r)){var n;return(n=r[e])!==null&&n!==void 0?n:i[e]}return i[e]}addHook(e,r,i){Pm(C0,this)[e]=Pm(C0,this)[e]||[];const s=Pm(C0,this)[e];this.hot.addHook(e,r,i),s.push(r),Pm(C0,this)[e]=s}removeHooks(e){Te(Pm(C0,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Pm(C0,this);Zr(e,(r,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Te(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=jJ(VV,this,j3e).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Zr(this,(r,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function j3e(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function S0(t,e,r){return(e=U3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U3e(t){var e=z3e(t,"string");return typeof e=="symbol"?e:e+""}function z3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let zJ=class{constructor(e){S0(this,"hot",null),S0(this,"container",null),S0(this,"injected",!1),S0(this,"rows",[]),S0(this,"columns",[]),S0(this,"samples",null),S0(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Te(this.rows,r=>{const{height:i}=r.table.getBoundingClientRect();e(r.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),Te(this.columns,r=>{const{width:i}=r.table.getBoundingClientRect();e(r.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{Te(i.strings,s=>{r.appendChild(this.createColElement(s.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),i.appendChild(s)),this.samples.forEach(n=>{Te(n.strings,o=>{const l=o.col,h=this.hot.getCellMeta(e,l),d=this.hot.getCellRenderer(h),g=r.createElement("td");g.setAttribute("ghost-table",1),d(this.hot,g,e,l,this.hot.colToProp(l),o.value,h),i.appendChild(g)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");i.push([-1,s]),r.appendChild(s)}this.samples.forEach(s=>{Te(s.strings,n=>{const o=n.col,l=e.createElement("th");i.push([o,l]),r.appendChild(l)})}),this.table.tHead.appendChild(r),Te(i,s=>{const[n,o]=s;this.hot.view.appendColHeader(n,o)})}createCol(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment();return this.samples.forEach(s=>{Te(s.strings,n=>{const o=n.row,l=this.hot.getCellMeta(o,e),h=this.hot.getCellRenderer(l),d=r.createElement("td"),g=r.createElement("tr");d.setAttribute("ghost-table",1),h(this.hot,d,o,e,this.hot.colToProp(e),n.value,l),g.appendChild(d),i.appendChild(g)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const i=this.hot.rootDocument.createElement("col");let s=0;r>=0&&e>=0&&(s=this.hot.getCellMeta(r,e).colspan);let n=this.hot.getColWidth(e);if(s>1)for(let o=e+1;o<e+s;o++)n+=this.hot.getColWidth(o);return i.style.width=`${n}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),n=r.createElement("thead"),o=r.createElement("tbody"),l=r.createElement("colgroup"),h=r.createElement("tr"),d=r.createElement("th");return this.isVertical()&&s.appendChild(l),this.isHorizontal()&&(h.appendChild(d),n.appendChild(h),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(n),this.isVertical()&&o.appendChild(h),s.appendChild(o),ht(s,e),i.appendChild(s),{fragment:i,table:s,tHead:n,tBody:o,colGroup:l,tr:h,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("div"),n=`htGhostTable htAutoSize ${e.trim()}`;return ht(s,n),i.appendChild(s),{fragment:i,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function fx(t,e,r){return(e=G3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G3e(t){var e=Y3e(t,"string");return typeof e=="symbol"?e:e+""}function Y3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q_{static get SAMPLE_COUNT(){return 3}constructor(e){fx(this,"samples",null),fx(this,"dataFactory",null),fx(this,"customSampleCount",null),fx(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Q_.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,i){const s=new Map,{from:n,to:o}=typeof i=="number"?{from:i,to:i}:i;return pr(n,o,l=>{const h=this.generateSample(e,r,l);s.set(l,h)}),s}generateSample(e,r,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,n=e==="row"?"col":"row",o=[];return pr(r.from,r.to,l=>{const h=e==="row"?this.dataFactory(i,l):this.dataFactory(l,i);if(h===!1)return;const{value:d,bundleSeed:g}=h,y=typeof g=="string"&&g.length>0;let C;y?C=g:Qr(d)?C=`${Object.keys(d).length}`:Array.isArray(d)?C=`${d.length}`:C=`${is(d).length}`,s.has(C)||s.set(C,{needed:this.getSampleCount(),strings:[]});const x=s.get(C);x.needed&&(!(o.indexOf(d)>-1)||this.allowDuplicates||y)&&(x.strings.push({value:d,[n]:l}),o.push(d),x.needed-=1)}),s}}function K3e(t,e){GJ(t,e),e.add(t)}function WV(t,e,r){GJ(t,e),e.set(t,r)}function GJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tw(t,e,r){return(e=X3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X3e(t){var e=q3e(t,"string");return typeof e=="symbol"?e:e+""}function q3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ig(t,e){return t.get(Ru(t,e))}function m6(t,e,r){return t.set(Ru(t,e),r),r}function Ru(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("modifyAutoColumnSizeSeed");const qO="autoColumnSize",J3e=10,Q3e="autoColumnSize";var cp=new WeakMap,p1=new WeakMap,Ch=new WeakSet;class cy extends On{static get PLUGIN_KEY(){return qO}static get PLUGIN_PRIORITY(){return J3e}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),K3e(this,Ch),tw(this,"ghostTable",new zJ(this.hot)),tw(this,"samplesGenerator",new Q_((r,i)=>{const s=this.hot.toPhysicalRow(r),n=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(n))return!1;const o=this.hot.getCellMeta(r,i);let l="";o.spanned||(l=this.hot.getDataAtCell(r,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,o,l)),{value:l,bundleSeed:h}})),tw(this,"inProgress",!1),tw(this,"measuredColumns",0),tw(this,"columnWidthsMap",new Hd),WV(this,cp,[]),WV(this,p1,[]),this.hot.columnIndexMapper.registerMap(Q3e,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,i,s)=>Ru(Ch,this,jV).call(this,r,i,s))}isEnabled(){return this.hot.getSettings()[qO]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ru(Ch,e,tPe).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ru(Ch,e,rPe).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ru(Ch,e,iPe).call(e,...s)}),this.addHook("beforeRender",()=>Ru(Ch,this,ePe).call(this)),this.addHook("modifyColWidth",(i,s)=>this.getColumnWidth(s,i)),this.addHook("init",()=>Ru(Ch,this,nPe).call(this)),super.enablePlugin()}updatePlugin(){m6(p1,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,i)=>Ru(Ch,this,jV).call(this,e,r,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:r},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,n=typeof r=="number"?{from:r,to:r}:r;pr(s.from,s.to,o=>{let l=this.hot.toPhysicalColumn(o);l===null&&(l=o),(i||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l))&&this.samplesGenerator.generateColumnSamples(o,n).forEach((d,g)=>this.ghostTable.addColumn(g,d))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,l)=>{const h=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(h,l)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countCols()-1;let n=null;this.inProgress=!0;const o=()=>{if(!this.hot){GE(n),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+cy.CALCULATION_STEP,s)},e,r),i=i+cy.CALCULATION_STEP+1,i<s?n=zE(o):(GE(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateColumnsWidth({from:0,to:l},e,r),i=l+1),i<s?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[qO];let r=cy.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Qr(e)&&(r=e.syncLimit,PX(r)?r=dq(i,r):r>>=0),Math.min(r,i)}getColumnWidth(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=r;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof s=="number"&&(s=Math.max(s,u1))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,s,n)=>{const o=ig(cp,this).length;return(o-1<n||ig(cp,this)[n]!==s)&&i.push(this.hot.toVisualColumn(n)),o-1<n?ig(cp,this).push(s):ig(cp,this)[n]=s,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Z3e(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const i=this.hot.toPhysicalColumn(r);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(r,e).forEach((n,o)=>this.ghostTable.addColumn(o,n)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,i)=>{const s=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function ePe(){this.calculateVisibleColumnsWidth(),this.inProgress||(Ru(Ch,this,Z3e).call(this,ig(p1,this)),m6(p1,this,[]))}function tPe(t,e){e||this.recalculateAllColumnsWidth()}function rPe(t){const e=t.reduce((r,i)=>{let[,s]=i;const n=this.hot.propToCol(s);return Number.isInteger(n)&&r.indexOf(n)===-1&&r.push(n),r},[]);ig(p1,this).push(...e)}function jV(t,e,r){let i=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function nPe(){m6(cp,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function iPe(t){const e=t.reduce((r,i)=>{var s;const n=(s=i.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(n)){const o=this.hot.toVisualColumn(n);r.indexOf(o)===-1&&r.push(o)}return r},[]);ig(p1,this).push(...e)}const sg={horizontal:"horizontal",vertical:"vertical"};function sPe(t,e,r){let i,s,n;return e[0]===t[0]&&e[1]<t[1]?(n="left",i=r(e[0],e[1]),s=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(n="right",i=r(e[0],t[3]+1),s=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(n="up",i=r(e[0],e[1]),s=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(n="down",i=r(t[2]+1,e[1]),s=r(e[2],e[3])),i&&i.normalize(),s&&s.normalize(),{directionOfDrag:n,startOfDragCoords:i,endOfDragCoords:s}}function oPe(t){const e={};return t===!0?(e.directions=Object.keys(sg),e.autoInsertRow=!0):Qr(t)?(nr(t.autoInsertRow)?t.direction===sg.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,nr(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(sg)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function aPe(t,e){lPe(t,e),e.add(t)}function lPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fm(t,e,r){return(e=cPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cPe(t){var e=uPe(t,"string");return typeof e=="symbol"?e:e+""}function uPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("modifyAutofillRange");qt.getSingleton().register("beforeAutofill");qt.getSingleton().register("afterAutofill");const UV="autofill",hPe=20,fPe=["fillHandle"],dPe="insert_row_below",gPe=200;var Mm=new WeakSet;class mPe extends On{constructor(){super(...arguments),aPe(this,Mm),Fm(this,"addingStarted",!1),Fm(this,"mouseDownOnCellCorner",!1),Fm(this,"mouseDragOutside",!1),Fm(this,"handleDraggedCells",0),Fm(this,"directions",[]),Fm(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return UV}static get PLUGIN_PRIORITY(){return hPe}static get SETTING_KEYS(){return[UV,...fPe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>rw(Mm,this,vPe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>rw(Mm,this,pPe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>rw(Mm,this,wPe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:i}=e.getTopStartCorner(),{row:s,col:n}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:s,endCol:n}]),l=[],h=[],d=[];return Te(o,g=>{for(let y=g.startRow;y<=g.endRow;y+=1)l.indexOf(y)===-1&&l.push(y);for(let y=g.startCol;y<=g.endCol;y+=1)h.indexOf(y)===-1&&h.push(y)}),Te(l,g=>{const y=[];Te(h,C=>{y.push(this.hot.getCopyableData(g,C))}),d.push(y)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,i,s]=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.getSelectedRangeLast(),o=n.getTopStartCorner(),l=n.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[o.row,o.col,l.row,l.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(l.row,i),Math.max(l.col,s)],h),{directionOfDrag:g,startOfDragCoords:y,endOfDragCoords:C}=sPe(h,d,(x,_)=>this.hot._createCellCoords(x,_));if(y&&y.row>-1&&y.col>-1){const x=this.getSelectionData(),_=n.clone(),E=this.hot._createCellRange(y,y,C),R=this.hot.runHooks("beforeAutofill",x,_,E,g);if(R===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let I=R;const F=R;if(["up","left"].indexOf(g)>-1&&!(F.length===1&&F[0].length===0))if(I=[],g==="up"){const D=C.row-y.row+1,U=D%F.length;for(let X=0;X<D;X++)I.push(F[(X+(F.length-U))%F.length])}else{const D=C.col-y.col+1,U=D%F[0].length;for(let X=0;X<F.length;X++){I.push([]);for(let te=0;te<D;te++)I[X].push(F[X][(te+(F[X].length-U))%F[X].length])}}this.hot.populateFromArray(y.row,y.col,I,C.row,C.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",I,_,E,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),i=r.getBottomEndCorner();let s=e;if(this.directions.includes(sg.vertical)&&this.directions.includes(sg.horizontal)){const n=r.getTopStartCorner();(i.col<=e.col||n.col>=e.col)&&(s=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||n.row>e.row)&&(s=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(sg.vertical))s=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(sg.horizontal))s=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(dPe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},gPe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&r[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),i=this.hot.countRows();let s;for(let n=e[2]+1;n<i;n++){for(let h=e[1];h<=e[3];h++){const d=r[n][h];if(!qi(d))return-1}const o=r[n][e[1]-1],l=r[n][e[3]+1];(!qi(o)||!qi(l))&&(s=n)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...on(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,i=Ws(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+Ji(this.hot.table),s=Ws(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+ns(this.hot.table);return e.clientY>i&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>rw(Mm,this,yPe).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>rw(Mm,this,CPe).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=oPe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function pPe(){this.selectAdjacent()&&this.fillIn()}function vPe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function wPe(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function yPe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function CPe(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function SPe(t,e){YJ(t,e),e.add(t)}function bPe(t,e,r){YJ(t,e),e.set(t,r)}function YJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function km(t,e,r){return(e=xPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xPe(t){var e=EPe(t,"string");return typeof e=="symbol"?e:e+""}function EPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TPe(t,e,r){return t.set(Au(t,e),r),r}function p6(t,e){return t.get(Au(t,e))}function Au(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const JO="autoRowSize",_Pe=40,RPe="autoRowSize";var lC=new WeakMap,Sh=new WeakSet;class uy extends On{static get PLUGIN_KEY(){return JO}static get PLUGIN_PRIORITY(){return _Pe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),SPe(this,Sh),km(this,"headerHeight",null),km(this,"ghostTable",new zJ(this.hot)),km(this,"samplesGenerator",new Q_((r,i)=>{const s=this.hot.toPhysicalRow(r),n=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(n)||r>=0&&i>=0&&this.hot.getCellMeta(r,i).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,i):r===-1&&(o=this.hot.getColHeader(i)),{value:o}})),km(this,"inProgress",!1),km(this,"measuredRows",0),km(this,"rowHeightsMap",new Hd),bPe(this,lC,[]),this.hot.rowIndexMapper.registerMap(RPe,this.rowHeightsMap),this.addHook("beforeRowResize",(r,i,s)=>Au(Sh,this,zV).call(this,r,i,s))}isEnabled(){const e=this.hot.getSettings()[JO];return e===!0||Qr(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Au(Sh,e,IPe).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Au(Sh,e,PPe).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Au(Sh,e,MPe).call(e,...s)}),this.addHook("beforeRender",()=>Au(Sh,this,OPe).call(this)),this.addHook("modifyRowHeight",(i,s)=>this.getRowHeight(s,i)),this.addHook("init",()=>Au(Sh,this,FPe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,i)=>Au(Sh,this,zV).call(this,e,r,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:r},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,n=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,n);this.ghostTable.addColumnHeadersRow(o.get(-1))}pr(s.from,s.to,o=>{let l=this.hot.toPhysicalRow(o);l===null&&(l=o),(i||this.rowHeightsMap.getValueAtIndex(l)===null)&&this.samplesGenerator.generateRowSamples(o,n).forEach((d,g)=>this.ghostTable.addRow(g,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,l)=>{o<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),l)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countRows()-1;let n=null;this.inProgress=!0;const o=()=>{if(!this.hot){GE(n),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+uy.CALCULATION_STEP,s)},e,r),i=i+uy.CALCULATION_STEP+1,i<s?n=zE(o):(GE(n),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateRowsHeight({from:0,to:l},e,r),i=l+1),i<s?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[JO];let r=uy.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Qr(e)&&(r=e.syncLimit,PX(r)?r=dq(i,r):r>>=0),Math.min(r,i)}getRowHeight(e,r){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=r;return i!==null&&i>(r||0)&&(s=i),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pr(Math.min(r,i),Math.max(r,i),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function APe(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((s,n)=>this.ghostTable.addRow(n,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,i)=>{const s=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function OPe(){this.calculateVisibleRowsHeight(),this.inProgress||(Au(Sh,this,APe).call(this,p6(lC,this)),TPe(lC,this,[]))}function zV(t,e,r){let i=t;return r&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function IPe(t,e){e||this.recalculateAllRowsHeight()}function PPe(t){const e=t.reduce((r,i)=>{let[s]=i;return r.indexOf(s)===-1&&r.push(s),r},[]);p6(lC,this).push(...e)}function FPe(){this.recalculateAllRowsHeight()}function MPe(t){const e=t.reduce((r,i)=>{var s;const n=(s=i.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(n)){const o=this.hot.toVisualRow(n);r.indexOf(o)===-1&&r.push(o)}return r},[]);p6(lC,this).push(...e)}const{getListWithInsertedItems:kPe,getListWithRemovedItems:NPe}=Vq("physicallyIndexed");class DPe extends Xg{constructor(){super(e=>e)}insert(e,r){const i=bN(this.indexedValues,r);this.indexedValues=kPe(i,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=NPe(this.indexedValues,e);this.indexedValues=SN(r,e),super.remove(e)}}const{getListWithInsertedItems:LPe,getListWithRemovedItems:HPe}=Vq("physicallyIndexed");class $Pe extends Xg{constructor(){super(e=>e)}insert(e,r){this.indexedValues=LPe(this.indexedValues,e,r,(i,s)=>this.getNextValue(s)),super.insert(e,r)}remove(e){this.indexedValues=HPe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function BPe(t,e){VPe(t,e),e.add(t)}function VPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WPe(t,e,r){return(e=jPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jPe(t){var e=UPe(t,"string");return typeof e=="symbol"?e:e+""}function UPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zPe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const GV="bindRowsWithHeaders",GPe=210,YPe="loose",YV=new Map([["loose",DPe],["strict",$Pe]]);var KV=new WeakSet;class KPe extends On{constructor(){super(...arguments),BPe(this,KV),WPe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return GV}static get PLUGIN_PRIORITY(){return GPe}isEnabled(){return!!this.hot.getSettings()[GV]}enablePlugin(){var e;if(this.enabled)return;const r=(e=YV.get(this.getSetting()))!==null&&e!==void 0?e:YV.get(YPe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",i=>zPe(KV,this,XPe).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function XPe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function qPe(t,e){KJ(t,e),e.add(t)}function JPe(t,e,r){KJ(t,e),e.set(t,r)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XV(t,e,r){return(e=QPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QPe(t){var e=ZPe(t,"string");return typeof e=="symbol"?e:e+""}function ZPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qV(t,e){return t.get(Ip(t,e))}function QO(t,e,r){return t.set(Ip(t,e),r),r}function Ip(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const j2="collapsibleColumns",eFe=290,tFe=["nestedHeaders"],Gp="collapsibleIndicator",JV=j2,QV=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Nm=new WeakMap,nw=new WeakSet;class rFe extends On{constructor(){super(...arguments),qPe(this,nw),XV(this,"nestedHeadersPlugin",null),XV(this,"headerStateManager",null),JPe(this,Nm,null)}static get PLUGIN_KEY(){return j2}static get PLUGIN_PRIORITY(){return eFe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[j2,...tFe]}isEnabled(){return!!this.hot.getSettings()[j2]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||Nn("You need to configure the Nested Headers plugin in order to use collapsible headers."),QO(Nm,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ip(nw,this,sFe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ip(nw,e,oFe).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ip(nw,e,nFe).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(i,s,n)=>Ip(nw,this,iFe).call(this,i,s,n)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),QO(Nm,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:n,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,i))!==null&&e!==void 0?e:{};if(s)return n?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:JV,relativeToGroup:$d,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JV)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,n=function(o){o&&o.parentNode.removeChild(o)};pr(0,e-1,o=>{const l=r.childNodes[o],h=i.childNodes[o],d=s?s.childNodes[o]:null;pr(0,l.childNodes.length-1,g=>{let y=l.childNodes[g].querySelector(`.${Gp}`);n(y),h&&h.childNodes[g]&&(y=h.childNodes[g].querySelector(`.${Gp}`),n(y)),s&&d&&d.childNodes[g]&&(y=d.childNodes[g].querySelector(`.${Gp}`),n(y))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(i=>{const{collapsible:s,origColspan:n,headerLevel:o,columnIndex:l,isCollapsed:h}=i;if(s===!0&&n>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:l}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!QV.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const i=Rd(e,x=>{let{row:_}=x;return _<0});let s=i.length>0;Te(i,x=>{var _;let{row:E,col:R}=x;const{collapsible:I,isCollapsed:F}=(_=this.headerStateManager.getHeaderSettings(E,R))!==null&&_!==void 0?_:{};if(!I||F&&r==="collapse"||!F&&r==="expand")return s=!1,!1});const n=[],o=[];s&&Te(i,x=>{let{row:_,col:E}=x;const{colspanCompensation:R,affectedColumns:I,rollbackModification:F}=this.headerStateManager.triggerNodeModification(r,_,E);R>0&&(o.push(...I),n.push(F))});const l=this.getCollapsedColumns();let h=[];r==="collapse"?h=OX([...l,...o]):r==="expand"&&(h=Rd(l,x=>!o.includes(x)));const d=QV.get(r);if(this.hot.runHooks(d.beforeHook,l,h,s)===!1){Te(n,x=>{x()});return}this.hot.batchExecution(()=>{Te(o,x=>{qV(Nm,this).setValueAtIndex(this.hot.toPhysicalColumn(x),d.hideColumn)})},!0);const y=this.getCollapsedColumns().length!==l.length,C=this.hot.getSelectedRangeLast();if(r==="collapse"&&y&&C){const{row:x,col:_}=C.highlight;if((this.hot.rowIndexMapper.isHidden(x)||this.hot.columnIndexMapper.isHidden(_))&&o.includes(_)){const R=x>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(x,1,!0):x,I=_>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(_,1,!0):_;R!==null&&I!==null&&this.hot.selectCell(R,I)}}this.hot.runHooks(d.afterHook,l,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return qV(Nm,this).getHiddenIndexes()}destroy(){QO(Nm,this,null),super.destroy()}}function nFe(t,e,r){var i;const{collapsible:s,origColspan:n,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(r,t))!==null&&i!==void 0?i:{},l=s&&n>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=e.querySelector(`.${Gp}`);if(F1(e,[Bl("")[0]]),l)d||(d=this.hot.rootDocument.createElement("div"),ht(d,Gp),e.querySelector("div:first-child").appendChild(d)),Ar(d,["collapsed","expanded"]),o?(ht(d,"collapsed"),Rg(d,"+"),h&&Fr(e,...Bl(!1))):(ht(d,"expanded"),Rg(d,"-"),h&&Fr(e,...Bl(!0))),h&&Fr(d,...Dd());else{var g;(g=d)===null||g===void 0||g.remove()}}function iFe(t,e){Ir(t.target,Gp)&&(Ir(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ir(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Bc(t))}function sFe(){this.updatePlugin()}function oFe(t,e){e||this.updatePlugin()}function b0(t,e,r){return(e=aFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aFe(t){var e=lFe(t,"string");return typeof e=="symbol"?e:e+""}function lFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cFe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],uFe=!1,hFe=!0,fFe=!0;class dFe{constructor(e,r){b0(this,"hot",void 0),b0(this,"sortingStates",new U_),b0(this,"sortEmptyCells",uFe),b0(this,"indicator",hFe),b0(this,"headerAction",fFe),b0(this,"compareFunctionFactory",void 0),b0(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){Qr(e)&&Zr(e,(r,i)=>{cFe.includes(i)&&(this[i]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[i]=r;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Qr(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[i,s]=r;return{column:this.hot.toVisualColumn(i),...s}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(nr(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function XJ(t,e,r){const i=e.locale;return function(s,n){const{sortEmptyCells:o}=r;return typeof s=="string"&&(s=s.toLocaleLowerCase(i)),typeof n=="string"&&(n=n.toLocaleLowerCase(i)),s===n?$u:qi(s)?qi(n)?$u:o&&t==="asc"?Ni:Di:qi(n)?o&&t==="asc"?Di:Ni:isNaN(s)&&!isNaN(n)?t==="asc"?Di:Ni:!isNaN(s)&&isNaN(n)||(isNaN(s)||isNaN(n)||(s=parseFloat(s),n=parseFloat(n)),s<n)?t==="asc"?Ni:Di:s>n?t==="asc"?Di:Ni:$u}}const qJ="default";function gFe(t,e,r){return function(i,s){const n=parseFloat(i),o=parseFloat(s),{sortEmptyCells:l}=r;if(n===o||isNaN(n)&&isNaN(o))return $u;if(l){if(qi(i))return t==="asc"?Ni:Di;if(qi(s))return t==="asc"?Di:Ni}return isNaN(n)?Di:isNaN(o)?Ni:n<o?t==="asc"?Ni:Di:n>o?t==="asc"?Di:Ni:$u}}const mFe="numeric";function pFe(t,e,r){const i=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:n}=r;return function(o,l){const h=qi(o),d=qi(l),g=h?s:o,y=d?s:l,C=g===s||g===i,x=y===s||y===i;if(n===!1){if(h&&d===!1)return Di;if(h===!1&&d)return Ni}return C===!1&&x?t==="asc"?Ni:Di:C&&x===!1?t==="asc"?Di:Ni:C===!1&&x===!1?XJ(t,e,r)(o,l):g===s&&y===i?t==="asc"?Ni:Di:g===i&&y===s?t==="asc"?Di:Ni:$u}}const vFe="checkbox";function wFe(t,e,r){return rQ(t,e.dateFormat,r)}const yFe="date";function CFe(t,e,r){return rQ(t,e.timeFormat,r)}const SFe="time",{register:iS,getItem:ZV,hasItem:bFe}=Vc("sorting.compareFunctionFactory"),{register:JJ,getItem:xFe}=Vc("sorting.mainSortComparator");function QJ(t){return bFe(t)?ZV(t):ZV(qJ)}iS(vFe,pFe);iS(yFe,wFe);iS(qJ,XJ);iS(mFe,gFe);iS(SFe,CFe);const $u=0,Ni=-1,Di=1;function EFe(t,e){const r=xFe(e);for(var i=arguments.length,s=new Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];t.sort(r(...s))}const iT="asc",sT="desc",ZJ="colHeader";function TFe(t){if(Qr(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[iT,sT].includes(r)}function _Fe(t){if(t.some(r=>TFe(r)===!1))return!1;const e=t.map(r=>{let{column:i}=r;return i});return new Set(e).size===e.length}function eW(t){if(t!==sT)return t===iT?sT:iT}function eQ(t){return t.querySelector(`.${ZJ}`)}function tQ(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function v6(t,e,r){return t===-1&&e>=0&&Ag(r)===!1}function rQ(t,e,r){return function(i,s){const{sortEmptyCells:n}=r;if(i===s)return $u;if(qi(i))return qi(s)?$u:n&&t==="asc"?Ni:Di;if(qi(s))return n&&t==="asc"?Di:Ni;const o=wt(i,e),l=wt(s,e);return o.isValid()?l.isValid()?l.isAfter(o)?t==="asc"?Ni:Di:l.isBefore(o)?t==="asc"?Di:Ni:$u:Ni:Di}}const RFe="ascending",AFe="descending",nQ="indicatorDisabled",iQ="columnSorting",sQ="sortAction",oQ=new Map([[iT,RFe],[sT,AFe]]);function OFe(t,e,r,i){const s=[iQ];if(i&&s.push(sQ),r===!1)return s.push(nQ),s;const n=t.getSortOrderOfColumn(e);return nr(n)&&s.push(oQ.get(n)),s}function IFe(){return Array.from(oQ.values()).concat(sQ,nQ,iQ)}function PFe(t,e){return function(r,i){const[,...s]=r,[,...n]=i;return function(l){const h=t[l],d=e[l],g=s[l],y=n[l],C=d.columnSorting;return(C.compareFunctionFactory?C.compareFunctionFactory:QJ(d.type))(h,d,C)(g,y)}(0)}}function FFe(t,e){MFe(t,e),e.add(t)}function MFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e,r){return(e=kFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kFe(t){var e=NFe(t,"string");return typeof e=="symbol"?e:e+""}function NFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function up(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oT="columnSorting",DFe=50,aT="append",LFe="replace",tW=oT;JJ(oT,PFe);qt.getSingleton().register("beforeColumnSort");qt.getSingleton().register("afterColumnSort");var X0=new WeakSet;class aQ extends On{constructor(){super(...arguments),FFe(this,X0),dx(this,"columnStatesManager",null),dx(this,"columnMetaCache",null),dx(this,"pluginKey",oT),dx(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return oT}static get PLUGIN_PRIORITY(){return DFe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new dFe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Hd(r=>{let i=this.hot.toVisualColumn(r);return i===null&&(i=r),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,i)=>up(X0,this,HFe).call(this,r,i)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return up(X0,e,BFe).call(e,...i)}),this.addHook("afterOnCellMouseDown",(r,i)=>this.onAfterOnCellMouseDown(r,i)),this.addHook("afterInit",()=>up(X0,this,dF).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return up(X0,e,$Fe).call(e,...i)}),this.hot.view&&up(X0,this,dF).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,i)=>{const s=eQ(i);tQ(r,i)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:$d,position:"before",group:tW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tW)}sort(e){const r=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",r,i,s)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Wq),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",r,s?i:r,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return nr(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return _Fe(e)&&e.every(i=>{let{column:s}=i;return s<=r&&s>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),i=s=>{let{column:n,...o}=s;return{column:this.hot.toPhysicalColumn(n),...o}};r.initialConfig=on(e,i),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,i=s=>{let{column:n,...o}=s;return{column:this.hot.toVisualColumn(n),...o}};return nr(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=on(r.initialConfig,i)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(nr(r)){const s=eW(r);return nr(s)?{column:e,sortOrder:s}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:eW()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aT;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=i!==-1,n=this.getSortConfig(),o=this.getColumnNextConfig(e);if(s){if(_i(o))return[...n.slice(0,i),...n.slice(i+1)];if(r===aT)return[...n.slice(0,i),...n.slice(i+1),o];if(r===LFe)return[...n.slice(0,i),o,...n.slice(i+1)]}return nr(o)?n.concat(o):n}getPluginColumnConfig(e){if(Qr(e)){const r=e[this.pluginKey];if(Qr(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),n=Object.getPrototypeOf(s);return Array.isArray(n.columns)?Object.assign(i,r,this.getPluginColumnConfig(n.columns[e])):oi(n.columns)?Object.assign(i,r,this.getPluginColumnConfig(n.columns(e))):Object.assign(i,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),i=Object.create(r);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],i=this.hot.countRows(),s=d=>on(e,g=>this.hot.getDataAtCell(d,g.column));for(let d=0;d<this.getNumberOfRowsToSort(i);d+=1)r.push([this.hot.toPhysicalRow(d)].concat(s(d)));const n=on(r,d=>d[0]);EFe(r,this.pluginKey,on(e,d=>d.sortOrder),on(e,d=>this.getFirstCellSettings(d.column)));for(let d=r.length;d<i;d+=1)r.push([d].concat(s(d)));const o=on(r,d=>d[0]),l=new Map(on(n,(d,g)=>[d,o[g]])),h=on(this.hot.rowIndexMapper.getIndexesSequence(),d=>l.has(d)?l.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(Qr(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||Qr(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(Ar(e,IFe()),this.enabled!==!1){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];ht(e,OFe(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),nr(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Ir(e.target,ZJ)}onAfterOnCellMouseDown(e,r){if(v6(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const i=this.hot.getActiveEditor(),s=this.getColumnNextConfig(r.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function dF(){const t=this.getAllSavedSortSettings();if(Qr(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function HFe(t,e){const r=eQ(e);if(tQ(t,e)===!1||r===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],s=i.indicator,n=i.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,s,n),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Fr(e,...dSe(o?`${o}ending`:"none"))}}function $Fe(t){t===!0&&this.hot.view&&up(X0,this,dF).call(this)}function BFe(t,e,r,i){v6(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function x0(t,e,r){return(e=VFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VFe(t){var e=WFe(t,"string");return typeof e=="symbol"?e:e+""}function WFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jFe{constructor(e,r){x0(this,"plugin",void 0),x0(this,"hot",void 0),x0(this,"endpoints",[]),x0(this,"settings",void 0),x0(this,"settingsType","array"),x0(this,"currentEndpoint",null),x0(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),Te(i,s=>{const n={};this.assignSetting(s,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,n,"reversedRowCoords",!1),this.assignSetting(s,n,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,n,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,n,"sourceColumn",s.destinationColumn),this.assignSetting(s,n,"type","sum"),this.assignSetting(s,n,"forceNumeric",!1),this.assignSetting(s,n,"suppressDataTypeErrors",!0),this.assignSetting(s,n,"customFunction",null),this.assignSetting(s,n,"readOnly",!0),this.assignSetting(s,n,"roundFloat",!1),r.push(n)}),r}assignSetting(e,r,i,s){if(i==="ranges"&&e[i]===void 0){r[i]=s;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(s instanceof Error)throw s;r[i]=s}else i==="destinationRow"&&r.reversedRowCoords?r[i]=this.hot.countRows()-e[i]-1:r[i]=e[i]}resetSetupBeforeStructureAlteration(e,r,i){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",n=this.getAllEndpoints();Te(n,o=>{s==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),s==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(n,!1)}resetSetupAfterStructureAlteration(e,r,i,s,n){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const C=()=>(this.hot.removeHook("beforeViewRender",C),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",C);return}const l=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),g=e.indexOf("move_row")===0,y=r;Te(d,C=>{l==="row"&&C.destinationRow>=y&&(C.alterRowOffset=h*i),l==="col"&&C.destinationColumn>=y&&(C.alterColumnOffset=h*i)}),this.resetAllEndpoints(d,!g),g?Te(d,C=>{this.extendEndpointRanges(C,y,s[0],s.length),this.recreatePhysicalRanges(C),this.clearOffsetInformation(C)}):Te(d,C=>{this.shiftEndpointCoordinates(C,y)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,i,s){Te(e.ranges,n=>{n[1]&&(r>=n[0]&&r<=n[1]?i>n[1]?n[1]+=s:i<n[0]&&(n[0]-=s):i>=n[0]&&i<=n[1]&&(n[1]-=s,r<=n[0]&&(n[0]+=1,n[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,i=[],s=[];Te(r,n=>{const o=[];if(n[1])for(let l=n[0];l<=n[1];l++)o.push(this.hot.toPhysicalRow(l));else o.push(this.hot.toPhysicalRow(n[0]));s.push(o)}),Te(s,n=>{let o=[];Te(n,(l,h)=>{h===0?o.push(l):n[h]!==n[h-1]+1&&(o.push(n[h-1]),i.push(o),o=[],o.push(l)),h===n.length-1&&(o.push(l),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,Te(e.ranges,i=>{Te(i,(s,n)=>{s>=r&&(i[n]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const n=s.alterRowOffset||0,o=s.alterColumnOffset||0;return s.destinationRow+n>=this.hot.countRows()||s.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],Te(e,s=>{this.resetEndpointValue(s,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Te(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],Te(e,(i,s,n)=>{`${i[2]||""}`!=`${i[3]}`&&Te(this.getAllEndpoints(),(o,l)=>{this.hot.propToCol(n[s][1])===o.sourceColumn&&r.indexOf(l)===-1&&r.push(l)})}),Te(r,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const i=this.hot.getCellMeta(r,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?i:0)),this.hot.toVisualColumn(e.destinationColumn+(r?s:0)),""])}setEndpointValue(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const o=this.hot.getCellMeta(n,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let l=0;Number.isInteger(o)&&(l=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(l)}i?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Nn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function ZO(t){return t==null||isNaN(t)}function UFe(t,e){zFe(t,e),e.add(t)}function zFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GFe(t,e,r){return(e=YFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YFe(t){var e=KFe(t,"string");return typeof e=="symbol"?e:e+""}function KFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const eI="columnSummary",XFe=220;var iw=new WeakSet;class qFe extends On{constructor(){super(...arguments),UFe(this,iw),GFe(this,"endpoints",null)}static get PLUGIN_KEY(){return eI}static get PLUGIN_PRIORITY(){return XFe}isEnabled(){return!!this.hot.getSettings()[eI]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[eI],this.endpoints=new jFe(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,JFe).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,ZFe).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,QFe).call(e,...i)}),this.addHook("beforeCreateRow",(r,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,i,null,s)),this.addHook("beforeCreateCol",(r,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,i,null,s)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(r,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,i,null,s)),this.addHook("afterCreateCol",(r,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,i,null,s)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,eMe).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return Zr(e.ranges,i=>{r+=this.getPartialSum(i,e.sourceColumn)}),r}getPartialSum(e,r){let i=0,s=e[1]||e[0],n=null,o=0;do{if(n=this.getCellValue(s,r),n=ZO(n)?null:n,n!==null){const l=(`${n}`.split(".")[1]||[]).length||1;l>o&&(o=l)}i+=n||0,s-=1}while(s>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,r){let i=null;return Zr(e.ranges,s=>{const n=this.getPartialMinMax(s,e.sourceColumn,r);if(i===null&&n!==null&&(i=n),n!==null)switch(r){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n);break}}),i===null?"Not enough data":i}getPartialMinMax(e,r,i){let s=null,n=e[1]||e[0],o;do{if(o=this.getCellValue(n,r),o=ZO(o)?null:o,s===null)s=o;else if(o!==null)switch(i){case"min":s=Math.min(s,o);break;case"max":s=Math.max(s,o);break}n-=1}while(n>=e[0]);return s}countEmpty(e,r){let i,s=0,n=e[1]||e[0];do i=this.getCellValue(n,r),i=ZO(i)?null:i,i===null&&(s+=1),n-=1;while(n>=e[0]);return s}countEntries(e){let r=0;const i=e.ranges;return Zr(i,s=>{const n=s[1]===void 0?1:s[1]-s[0]+1,o=this.countEmpty(s,e.sourceColumn);r+=n,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),i=this.countEntries(e);return r/i}getCellValue(e,r){const i=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(r);let n=this.hot.getSourceDataAtCell(e,r),o="";if(i!==null&&s!==null&&(o=this.hot.getCellMeta(i,s).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof n=="string"&&(n=n.replace(/,/,".")),n=parseFloat(n)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ln`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return n}}function JFe(){this.endpoints.initEndpoints()}function QFe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function ZFe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function eMe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function tMe(t,e){lQ(t,e),e.add(t)}function tI(t,e,r){lQ(t,e),e.set(t,r)}function lQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hp(t,e){return t.get(w6(t,e))}function gF(t,e,r){return t.set(w6(t,e),r),r}function w6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var lT=new WeakMap,mx=new WeakMap,px=new WeakMap,rW=new WeakSet;class cQ{constructor(){tMe(this,rW),tI(this,lT,!0),tI(this,mx,null),tI(this,px,new ResizeObserver(e=>w6(rW,this,rMe).call(this,e)))}setObservedElement(e){gF(mx,this,e)}unobserve(){hp(px,this).unobserve(hp(mx,this))}observe(){gF(lT,this,!0),hp(px,this).observe(hp(mx,this))}destroy(){hp(px,this).disconnect()}}function rMe(t){if(hp(lT,this)||!Array.isArray(t)||!t.length){gF(lT,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:i,blockSize:s}=r[0];this.runLocalHooks("resize",i,s)})}Xn(cQ,uo);function E0(t,e,r){nMe(t,e),e.set(t,r)}function nMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vn(t,e){return t.get(uQ(t,e))}function gh(t,e,r){return t.set(uQ(t,e),r),r}function uQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var T0=new WeakMap,rI=new WeakMap,mh=new WeakMap,Rf=new WeakMap,Af=new WeakMap,vx=new WeakMap,Dm=new WeakMap;class og{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){var i=this;E0(this,T0,void 0),E0(this,rI,!1),E0(this,mh,null),E0(this,Rf,void 0),E0(this,Af,void 0),E0(this,vx,!0),E0(this,Dm,new cQ),gh(T0,this,e),gh(rI,this,r),gh(Rf,this,this.createEditor()),gh(Af,this,Vn(Rf,this).style),Vn(Dm,this).setObservedElement(this.getInputElement()),Vn(Dm,this).addLocalHook("resize",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("resize",...n)}),this.hide()}setPosition(e,r){Vn(Af,this).left=`${e}px`,Vn(Af,this).top=`${r}px`}setSize(e,r){if(e&&r){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${r}px`}}getSize(){return{width:ns(this.getInputElement()),height:Ji(this.getInputElement())}}observeSize(){Vn(Dm,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Vn(Af,this).display="block",gh(vx,this,!1)}hide(){Vn(Dm,this).unobserve(),Vn(vx,this)||(Vn(Af,this).display="none"),gh(vx,this,!0)}isVisible(){return Vn(Af,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Vn(T0,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Vn(T0,this).createElement("div"),r=Vn(T0,this).createElement("textarea");return e.style.display="none",gh(mh,this,Vn(T0,this).createElement("div")),Vn(mh,this).setAttribute("dir",Vn(rI,this)?"rtl":"ltr"),ht(Vn(mh,this),og.CLASS_EDITOR_CONTAINER),Vn(T0,this).body.appendChild(Vn(mh,this)),ht(e,og.CLASS_EDITOR),ht(r,og.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Vn(mh,this).appendChild(e),e}getInputElement(){return Vn(Rf,this).querySelector(`.${og.CLASS_INPUT}`)}getEditorElement(){return Vn(Rf,this)}destroy(){const e=Vn(mh,this)?Vn(mh,this).parentNode:null;Vn(Rf,this).parentNode.removeChild(Vn(Rf,this)),gh(Rf,this,null),gh(Af,this,null),Vn(Dm,this).destroy(),e&&e.removeChild(Vn(mh,this))}}Xn(og,uo);function nI(t,e,r){return(e=iMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iMe(t){var e=sMe(t,"string");return typeof e=="symbol"?e:e+""}function sMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oMe=250,aMe=250;class hQ{constructor(e){nI(this,"wasLastActionShow",!0),nI(this,"showDebounced",null),nI(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},aMe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oMe;this.showDebounced=zk(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}Xn(hQ,uo);function lMe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function cMe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function _0(t,e){const r={};return Te(t,i=>{i.forAll((s,n)=>{s>=0&&n>=0&&(r[s]||(r[s]=[]),r[s][n]=e(s,n))})}),r}function Vf(t,e,r,i,s){Te(t,n=>{n.forAll((o,l)=>{o>=0&&l>=0&&uMe(o,l,e,r,i,s)})})}function uMe(t,e,r,i,s,n){const o=s(t,e);let l=i;o.className&&(r==="vertical"?l=lMe(o.className,i):l=cMe(o.className,i)),n(t,e,"className",l)}function fQ(t){return`<span class="selected"></span>${t}`}function U2(t,e){let r=!1;return Array.isArray(t)&&Te(t,i=>(i.forAll((s,n)=>{if(s>=0&&n>=0&&e(s,n))return r=!0,!1}),r)),r}function Z_(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:s,left:n}=i.getBoundingClientRect();r.top=s,r.left=n}return r}const Xr="---------";function hMe(){return{name:Xr}}const Ol="alignment";function fMe(){return{key:Ol,name(){return this.getTranslatedPhrase(YN)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Ol}:left`,name(){return this.getTranslatedPhrase(KN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Ol}:center`,name(){return this.getTranslatedPhrase(XN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Ol}:right`,name(){return this.getTranslatedPhrase(qN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Ol}:justify`,name(){return this.getTranslatedPhrase(JN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{name:Xr},{key:`${Ol}:top`,name(){return this.getTranslatedPhrase(QN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Ol}:middle`,name(){return this.getTranslatedPhrase(ZN)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Ol}:bottom`,name(){return this.getTranslatedPhrase(eD)},callback(){const t=this.getSelectedRange(),e=_0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,r,i),Vf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1}]}}}const eR="clear_column";function dMe(){return{key:eR,name(){return this.getTranslatedPhrase(MN)},callback(t,e){const r=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const sS="col_left";function gMe(){return{key:sS,name(){return this.getTranslatedPhrase(RN)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const oS="col_right";function mMe(){return{key:oS,name(){return this.getTranslatedPhrase(AN)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const aS="make_read_only";function pMe(){return{key:aS,checkable:!0,ariaChecked(){return U2(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(JE)},name(){let t=this.getTranslatedPhrase(JE);return U2(this.getSelectedRange(),(r,i)=>this.getCellMeta(r,i).readOnly)&&(t=fQ(t)),t},callback(){const t=this.getSelectedRange(),e=U2(t,(r,i)=>this.getCellMeta(r,i).readOnly);Te(t,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&this.setCellMeta(i,s,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const tR="redo";function vMe(){return{key:tR,name(){return this.getTranslatedPhrase(FN)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const lS="remove_col";function wMe(){return{key:lS,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(IN,e)},callback(){this.alter("remove_col",ORe(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const rR="remove_row";function yMe(){return{key:rR,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(ON,e)},callback(){this.alter("remove_row",IRe(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const nR="row_above";function CMe(){return{key:nR,name(){return this.getTranslatedPhrase(TN)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const iR="row_below";function SMe(){return{key:iR,name(){return this.getTranslatedPhrase(_N)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cC="no_items";function bMe(){return{key:cC,name(){return this.getTranslatedPhrase(EN)},disabled:!0,isCommand:!1}}const sR="undo";function xMe(){return{key:sR,name(){return this.getTranslatedPhrase(PN)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const EMe=[nR,iR,sS,oS,eR,rR,lS,sR,tR,aS,Ol,Xr,cC],TMe={[Xr]:hMe,[cC]:bMe,[nR]:CMe,[iR]:SMe,[sS]:gMe,[oS]:mMe,[eR]:dMe,[rR]:yMe,[lS]:wMe,[sR]:xMe,[tR]:vMe,[aS]:pMe,[Ol]:fMe};function dQ(){const t={};return Zr(TMe,(e,r)=>{t[r]=e()}),t}function _Me(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(UN):this.getTranslatedPhrase(jN)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function RMe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(zN)},callback(){this.getSelectedRangeLast().forAll((r,i)=>{r>=0&&i>=0&&t.removeCommentAtCell(r,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function AMe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(GN);return U2(this.getSelectedRange(),(i,s)=>t.getCommentMeta(i,s,z2))?fQ(e):e},callback(){this.getSelectedRangeLast().forAll((r,i)=>{if(r>=0&&i>=0){const s=!!t.getCommentMeta(r,i,z2);t.updateCommentMeta(r,i,{[z2]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function OMe(t,e){gQ(t,e),e.add(t)}function Lm(t,e,r){gQ(t,e),e.set(t,r)}function gQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IMe(t,e,r){return(e=PMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PMe(t){var e=FMe(t,"string");return typeof e=="symbol"?e:e+""}function FMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ad(t,e,r){return t.set(_l(t,e),r),r}function tn(t,e){return t.get(_l(t,e))}function _l(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cT="comments",MMe=60,Rh="comment",jw="value",mQ="style",z2="readOnly",wx=cT,mF=`plugin:${cT}`;var Qn=new WeakMap,Eu=new WeakMap,oR=new WeakMap,G2=new WeakMap,pF=new WeakMap,uT=new WeakMap,nc=new WeakSet;class kMe extends On{constructor(){super(...arguments),OMe(this,nc),IMe(this,"range",{}),Lm(this,Qn,null),Lm(this,Eu,null),Lm(this,oR,!1),Lm(this,G2,!1),Lm(this,pF,null),Lm(this,uT,"")}static get PLUGIN_KEY(){return cT}static get PLUGIN_PRIORITY(){return MMe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[cT]}enablePlugin(){var e=this;this.enabled||(tn(Qn,this)||(ad(Qn,this,new og(this.hot.rootDocument,this.hot.isRtl())),tn(Qn,this).addLocalHook("resize",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return _l(nc,e,VMe).call(e,...i)})),tn(Eu,this)||ad(Eu,this,new hQ(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,i,s,n,o,l)=>_l(nc,this,HMe).call(this,r,l)),this.addHook("afterScroll",()=>_l(nc,this,jMe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>_l(nc,this,WMe).call(this,r)),this.addHook("afterSetTheme",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return _l(nc,e,UMe).call(e,...i)}),tn(Eu,this).addLocalHook("hide",()=>this.hide()),tn(Eu,this).addLocalHook("show",(r,i)=>this.showAtCell(r,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){tn(Eu,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),i=e.addContext(mF);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();ad(G2,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(mF),this.hot._registerTimeout(()=>{ad(G2,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:wx}),i.addShortcut({keys:[["Escape"]],callback:()=>{tn(Qn,this).setValue(tn(uT,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tn(Qn,this).isVisible()&&tn(Qn,this).isFocused(),group:wx}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tn(Qn,this).isVisible()&&tn(Qn,this).isFocused(),group:wx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wx)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>_l(nc,this,DMe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>_l(nc,this,NMe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>_l(nc,this,LMe).call(this)),this.eventManager.addEventListener(r,"focus",()=>_l(nc,this,BMe).call(this)),this.eventManager.addEventListener(r,"blur",()=>_l(nc,this,$Me).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=_g(e.target,"TD","TBODY");return!!(r&&Ir(r,"htCommentCell")&&_g(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=tn(Qn,this).getValue();let i="";e!=null?i=e:r!=null&&(i=r);const s=this.range.from.row,n=this.range.from.col;this.updateCommentMeta(s,n,{[jw]:i}),this.hot.render()}setCommentAtCell(e,r,i){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Rh),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(i)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,jw)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,jw)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:i}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return tn(Eu,this).cancelHiding(),tn(Qn,this).setValue((e=s[Rh]?s[Rh][jw]:null)!==null&&e!==void 0?e:""),tn(Qn,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){tn(Qn,this).hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!tn(Qn,this).isVisible()))return;const{rowIndexMapper:s,columnIndexMapper:n}=this.hot,{row:o,col:l}=this.range.from;let h=s.getRenderableFromVisualIndex(o),d=n.getRenderableFromVisualIndex(l);const g=h===null;tn(Qn,this).setPosition(0,0),h===null&&(h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(o,-1))),d===null&&(d=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1)));const y=h===null,C=d===null;h=(e=h)!==null&&e!==void 0?e:0,d=(r=d)!==null&&r!==void 0?r:0;const{rootWindow:x,view:{_wt:_}}=this.hot,{wtTable:E}=_,R=_.getCell({row:h,col:d},!0),I=this.getCommentMeta(o,l,mQ);I?tn(Qn,this).setSize(I.width,I.height):tn(Qn,this).resetSize();const F=C?0:E.getColumnWidth(d),D=g&&!y?Ji(R):0,{left:U,top:X,width:te,height:Y}=R.getBoundingClientRect(),{width:oe,height:me}=tn(Qn,this).getSize(),{innerWidth:de,innerHeight:ye}=this.hot.rootWindow,Ee=this.hot.rootDocument.documentElement;let ke=U+x.scrollX+F,nt=X+x.scrollY+D;this.hot.isRtl()&&(ke-=oe+F),this.hot.isLtr()&&U+te+oe>de?ke=U+x.scrollX-oe-1:this.hot.isRtl()&&ke<-(Ee.scrollWidth-Ee.clientWidth)&&(ke=U+x.scrollX+F+1),X+me>ye&&(nt-=me-Y+1),tn(Qn,this).setPosition(ke,nt),tn(Qn,this).setReadOnlyState(this.getCommentMeta(o,l,z2)),tn(Qn,this).observeSize()}focusEditor(){tn(Qn,this).focus()}updateCommentMeta(e,r,i){const s=this.hot.getCellMeta(e,r)[Rh];let n;s?(n=sa(s),H_(n,i)):n=i,this.hot.setCellMeta(e,r,Rh,n)}getCommentMeta(e,r,i){const s=this.hot.getCellMeta(e,r);if(s[Rh])return s[Rh][i]}addToContextMenu(e){e.items.push({name:Xr},_Me(this),RMe(this),AMe(this))}getEditorInputElement(){return tn(Qn,this).getInputElement()}destroy(){var e,r;(e=tn(Qn,this))===null||e===void 0||e.destroy(),(r=tn(Eu,this))===null||r===void 0||r.destroy(),super.destroy()}}function NMe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!tn(oR,this)&&!this.targetIsCommentTextArea(t)){const e=_g(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function DMe(t){const{rootDocument:e}=this.hot;if(!(tn(oR,this)||tn(Qn,this).isFocused()||Ir(t.target,"wtBorder")||tn(pF,this)===t.target||!tn(Qn,this)))if(ad(pF,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));tn(Eu,this).show(r)}else pg(t.target,e)&&!this.targetIsCommentTextArea(t)&&tn(Eu,this).hide()}function LMe(){ad(oR,this,!1)}function HMe(t,e){e[Rh]&&e[Rh][jw]&&ht(t,e.commentedCellClassName)}function $Me(){ad(uT,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function BMe(){ad(uT,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(mF)}function VMe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[mQ]:{width:t,height:e}})}function WMe(t){tn(Qn,this).isFocused()&&Bc(t)}function jMe(){tn(G2,this)||this.hide()}function UMe(){const t=tn(Qn,this).getEditorElement();Ar(t,/ht-theme-.*/g),ht(t,this.hot.getCurrentThemeName())}var nW=S_,zMe=TypeError,GMe=function(t,e){if(!delete t[e])throw new zMe("Cannot delete property "+nW(e)+" of "+nW(t))},YMe=ni,KMe=x1,XMe=T1,qMe=KY,JMe=GMe,QMe=XY,ZMe=[].unshift(0)!==1,eke=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},tke=ZMe||!eke();YMe({target:"Array",proto:!0,arity:1,forced:tke},{unshift:function(e){var r=KMe(this),i=XMe(r),s=arguments.length;if(s){QMe(i+s);for(var n=i;n--;){var o=n+s;n in r?r[o]=r[n]:JMe(r,o)}for(var l=0;l<s;l++)r[l]=arguments[l]}return qMe(r,i+s)}});function iI(t,e,r){return(e=rke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rke(t){var e=nke(t,"string");return typeof e=="symbol"?e:e+""}function nke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pQ{constructor(e){iI(this,"hot",void 0),iI(this,"commands",{}),iI(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const n=e.split(":"),o=n[0],l=n.length===2?n[1]:null;let h=this.commands[o];if(!h)throw new Error(`Menu command '${o}' not exists.`);if(l&&h.submenu&&(h=ike(l,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||gs(h,"submenu"))return;const d=[];typeof h.callback=="function"&&d.push(h.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),i.unshift(n.join(":")),Te(d,g=>g.apply(this.hot,i))}}function ike(t,e){let r;return Te(e,i=>{const s=i.key?i.key.split(":"):null;if(Array.isArray(s)&&s[1]===t)return r=i,!1}),r}function sI(t,e,r){return(e=ske(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ske(t){var e=oke(t,"string");return typeof e=="symbol"?e:e+""}function oke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vQ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;sI(this,"hot",void 0),sI(this,"predefinedItems",dQ()),sI(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Zr(e,(i,s)=>{let n="";i.name===Xr?(r[Xr]=i,n=Xr):isNaN(parseInt(s,10))?(i.key=i.key===void 0?s:i.key,r[s]=i,n=i.key):(r[i.key]=i,n=i.key),this.defaultOrderPattern.push(n)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ake(e,this.defaultOrderPattern,this.predefinedItems)}}function ake(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let s=t;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),Qr(s)?Zr(s,(n,o)=>{let l=r[typeof n=="string"?n:o];l||(l=n),Qr(n)?vs(l,n):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=o),i.push(l)}):Te(s,(n,o)=>{let l=r[n];!l&&EMe.indexOf(n)>=0||(l||(l={name:n,key:`${o}`}),Qr(n)&&vs(l,n),l.key===void 0&&(l.key=o),i.push(l))}),i}function Of(t,e,r){return(e=lke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lke(t){var e=cke(t,"string");return typeof e=="symbol"?e:e+""}function cke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uke{constructor(e,r){Of(this,"top",void 0),Of(this,"topRelative",void 0),Of(this,"left",void 0),Of(this,"leftRelative",void 0),Of(this,"scrollTop",void 0),Of(this,"scrollLeft",void 0),Of(this,"cellHeight",void 0),Of(this,"cellWidth",void 0);const i=r.scrollY,s=r.scrollX;let n,o,l,h,d,g;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(n=parseInt(e.top,10),l=parseInt(e.left,10),d=e.height||0,g=e.width||0,o=n,h=l,n+=i,l+=s):this.type==="event"&&(n=parseInt(e.pageY,10),l=parseInt(e.pageX,10),d=e.target.clientHeight,g=e.target.clientWidth,o=n-i,h=l-s),this.top=n,this.topRelative=o,this.left=l,this.leftRelative=h,this.scrollTop=i,this.scrollLeft=s,this.cellHeight=d,this.cellWidth=g}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function sw(t,e,r){hke(t,e),e.set(t,r)}function hke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function en(t,e){return t.get(wQ(t,e))}function yx(t,e,r){return t.set(wQ(t,e),r),r}function wQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Uo=new WeakMap,ou=new WeakMap,ma=new WeakMap,oI=new WeakMap,Hm=new WeakMap;class fke{constructor(e){sw(this,Uo,void 0),sw(this,ou,void 0),sw(this,ma,void 0),sw(this,oI,!1),sw(this,Hm,{above:0,below:0,left:0,right:0}),yx(oI,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return en(Hm,this)[e]=r,this}setElement(e){return yx(Uo,this,e),this}setParentElement(e){return yx(ou,this,e),this}updatePosition(e){yx(ma,this,new uke(e,en(Uo,this).ownerDocument.defaultView)),en(oI,this)?(en(ma,this).fitsBelow(en(Uo,this))?this.setPositionBelowCursor():en(ma,this).fitsAbove(en(Uo,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){en(Uo,this).dir==="rtl"?en(ma,this).fitsOnLeft(en(Uo,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():en(ma,this).fitsOnRight(en(Uo,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=en(Hm,this).above+en(ma,this).top-en(Uo,this).offsetHeight;en(ou,this)&&(e=en(ma,this).top+en(ma,this).cellHeight-en(Uo,this).offsetHeight+3),en(Uo,this).style.top=`${e}px`}setPositionBelowCursor(){let e=en(Hm,this).below+en(ma,this).top+1;en(ou,this)&&(e=en(ma,this).top-1),en(Uo,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=en(ma,this).left;if(en(ou,this)){const r=en(ou,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(en(ou,this).querySelector(".htCore")).borderRightWidth,10);e+=en(ma,this).cellWidth+i}else e+=en(Hm,this).right;en(Uo,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=en(Hm,this).left+en(ma,this).left-en(Uo,this).offsetWidth;if(en(ou,this)){const r=en(ou,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(en(ou,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}en(Uo,this).style.left=`${e}px`}}function yQ(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:i=()=>{},onClear:s=()=>{}}=t;const n=new Set;let o=vn(e,-1,_()-1);function l(R,I){const F=_()-1;return R<0&&(R=F),R>F&&(R=0),n.has(R)?-1:(n.add(R),i(R,!1)===!1&&(R=l(I===1?++R:--R,I)),R)}function h(R){R>-1&&R<_()&&i(R,!0)!==!1&&(o=R)}function d(){return o}function g(){_()>0&&(n.clear(),o=l(0,1))}function y(){_()>0&&(n.clear(),o=l(_()-1,-1))}function C(){_()>0&&(n.clear(),o=l(++o,1))}function x(){_()>0&&(n.clear(),o=l(--o,-1))}function _(){return Math.max(r(),0)}function E(){n.clear(),o=e,s()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:g,toLastItem:y,toNextItem:C,toPreviousItem:x,getSize:_,clear:E}}function dke(t){return on(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function vF(t){return gs(t,"submenu")}function wF(t){return new RegExp(Xr,"i").test(t.name)}function Y2(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function iW(t){return gs(t,"disableSelection")}function gke(t){return Ir(t,"htSeparator")}function mke(t){return Ir(t,"htSubmenu")}function pke(t){return Ir(t,"htDisabled")}function vke(t){return Ir(t,"htSelectionDisabled")}function wke(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function CQ(t,e){const r=t.slice(0);for(let i=0;i<r.length&&r[i].name===e;)r.shift();return r}function yke(t,e){let r=t.slice(0);return r.reverse(),r=CQ(r,e),r.reverse(),r}function Cke(t){const e=[];return Te(t,(r,i)=>{i>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Ske(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xr,r=t.slice(0);return r=CQ(r,e),r=yke(r,e),r=Cke(r),r}function bke(t){return t.checkable===!0}function xke(t){return yQ({size:()=>t.countRows(),onItemSelect(e,r){const i=t.getCell(e,0);if(!i||gke(i)||pke(i)||vke(i))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Eke(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,s)=>{const n=e.getSettings(),o=typeof n.tabMoves=="function"?n.tabMoves(i):n.tabMoves;s.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=r.getSelectedLast();if(i){const s=t.openSubMenu(i[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const s=r.getSelectedLast();s&&(r.getSourceDataAtRow(s[0]).submenu?t.openSubMenu(s[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const SQ="menu",sW=SQ;function Tke(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];i(Eke(t)),e.forEach(d=>{let{shortcuts:g,contextName:y}=d;s(g,y)});function i(d,g){l(g).addShortcuts(d,{group:SQ})}function s(d,g){const y=l(g);d.forEach(C=>{let{keys:x}=C;x.forEach(_=>y.removeShortcutsByKeys(_))}),r.push({shortcuts:d,contextName:g}),i(d,g)}function n(){return[...r]}function o(d){return d?`${sW}:${d}`:sW}function l(d){var g;const y=t.hotMenu.getShortcutManager(),C=o(d);return(g=y.getContext(C))!==null&&g!==void 0?g:y.addContext(C)}function h(d){t.hotMenu.getShortcutManager().setActiveContextName(o(d))}return{addCustomShortcuts:s,getCustomShortcuts:n,getContext:l,listen:h}}function _ke(t){return(e,r,i,s,n,o)=>{const l=e.getSourceDataAtRow(i),h=t.rootDocument.createElement("div"),d=typeof o=="function"?o.call(t):o,g=typeof l.ariaLabel=="function"?l.ariaLabel.call(t):l.ariaLabel,y=typeof l.ariaChecked=="function"?l.ariaChecked.call(t):l.ariaChecked;if(Vu(r),ht(h,"htItemWrapper"),t.getSettings().ariaTags){const C=!Y2(l,t)&&!iW(l)&&!wF(l);Fr(r,[...bke(l)?[iSe(),WE(g),HX(y)]:[nSe(),WE(d)],...C?[P1(-1)]:[],...Y2(l,t)?[hSe()]:[],...vF(l)?[Bl(!1)]:[]])}r.className="",r.appendChild(h),wF(l)?ht(r,"htSeparator"):typeof l.renderer=="function"?(ht(r,"htCustomMenuRenderer"),r.appendChild(l.renderer(e,h,i,s,n,d))):M1(h,d),Y2(l,t)?ht(r,"htDisabled"):iW(l)?ht(r,"htSelectionDisabled"):vF(l)&&ht(r,"htSubmenu")}}function aI(t,e,r){Rke(t,e),e.set(t,r)}function Rke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function au(t,e,r){return(e=Ake(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ake(t){var e=Oke(t,"string");return typeof e=="symbol"?e:e+""}function Oke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lI(t,e,r){return t.set(bQ(t,e),r),r}function R0(t,e){return t.get(bQ(t,e))}function bQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oW=215;var ow=new WeakMap,Cx=new WeakMap,Sx=new WeakMap;class L1{get tableBorderWidth(){return R0(Sx,this)===void 0&&this.hotMenu&&lI(Sx,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),R0(Sx,this)}constructor(e,r){var i=this;au(this,"hot",void 0),au(this,"options",void 0),au(this,"eventManager",new Dc(this)),au(this,"container",void 0),au(this,"positioner",void 0),au(this,"hotMenu",null),au(this,"hotSubMenus",{}),au(this,"parentMenu",void 0),au(this,"menuItems",null),au(this,"origOutsideClickDeselects",null),aI(this,ow,void 0),aI(this,Cx,void 0),aI(this,Sx,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:oW,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new fke(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...n)}),this.hot.addHook("afterSetTheme",(s,n)=>{if(!n){var o;(o=this.hotMenu)===null||o===void 0||o.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=a1(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return R0(ow,this)}getKeyboardShortcutsCtrl(){return R0(Cx,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=zk(l=>this.openSubMenu(l),300),r=this.options.minWidth||oW;let i=!1,s=Rd(this.menuItems,l=>(l.key===cC&&(i=!0),wke(l,this.hot)));if(s.length<1&&!i)s.push(dQ()[cC]);else if(s.length===0)return;s=Ske(s,Xr);let n=!1;const o={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(l){return nr(l)&&l<r?r:l},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:_ke(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(l,h)=>{R0(ow,this).setCurrentPage(h.row)},afterOnCellMouseOver:(l,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},rowHeights:l=>s[l].name===Xr?1:void 0,afterOnCellContextMenu:l=>{l.preventDefault(),aB()&&n&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(l,h,d,g,y)=>{this.hotMenu.view.isMouseDown()&&(y.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:l=>{this.hasSelectedItem()&&(n=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(l))},afterOnCellMouseUp:l=>{(!aB()||!Ag(l))&&n&&this.hasSelectedItem()&&(sd()||sq()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),lI(ow,this,xke(this.hotMenu)),lI(Cx,this,Tke(this)),R0(Cx,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(R0(ow,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const i=this.parentMenu.hotMenu.getCell(r[0],0);Fr(i,[Bl(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!mke(r))return!1;const i=this.hotMenu.getSourceDataAtRow(e),s=new L1(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(i.submenu.items),s.open(),s.setPosition(r.getBoundingClientRect()),this.hotSubMenus[i.key]=s,this.hot.getSettings().ariaTags&&Fr(r,[Bl(!0)]),s}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[r.key];if(i){i.destroy(),delete this.hotSubMenus[r.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Fr(s,[Bl(!1)])}}closeAllSubMenus(){Te(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const i=this.hot.getSelectedRange(),s=i?dke(i):[];this.runLocalHooks("executeCommand",r.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,s,e)}isCommandPassive(e){return e.isCommand===!1||wF(e)||Y2(e,this.hot)||vF(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=e.hider.style,s=e.holder.style,n=parseInt(i.width,10),o=la(r,(l,h,d)=>{const y=this.hotMenu.getCell(d,0)?Ji(this.hotMenu.getCell(d,0)):0;return l+(h.name===Xr?1:y)},0);s.width=`${n}px`,s.height=`${o}px`,i.height=s.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let i=e,s;return i&&(oi(i)&&(i=i.call(this.hot),i===null||_i(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,s=r.querySelector(`.${this.options.className}.${i}`)),s||(s=r.createElement("div"),ht(s,`htMenu ${this.options.className}`),i&&ht(s,i),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Fr(this.hotMenu.rootElement,[rSe(),P1(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!pg(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!pg(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ir(e.target,"htCore")&&pg(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Xn(L1,uo);function Ike(t,e){Pke(t,e),e.add(t)}function Pke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cI(t,e,r){return(e=Fke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fke(t){var e=Mke(t,"string");return typeof e=="symbol"?e:e+""}function Mke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Uw="contextMenu",kke=70,aW=Uw;qt.getSingleton().register("afterContextMenuDefaultOptions");qt.getSingleton().register("beforeContextMenuShow");qt.getSingleton().register("afterContextMenuShow");qt.getSingleton().register("afterContextMenuHide");qt.getSingleton().register("afterContextMenuExecute");var aw=new WeakSet;class aR extends On{constructor(){super(...arguments),Ike(this,aw),cI(this,"commandExecutor",new pQ(this.hot)),cI(this,"itemsFactory",null),cI(this,"menu",null)}static get PLUGIN_KEY(){return Uw}static get PLUGIN_PRIORITY(){return kke}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nR,iR,Xr,sS,oS,Xr,rR,lS,Xr,sR,tR,Xr,aS,Xr,Ol]}isEnabled(){return!!this.hot.getSettings()[Uw]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Uw];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new L1(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>bx(aw,this,Dke).call(this)),this.menu.addLocalHook("afterOpen",()=>bx(aw,this,Lke).call(this)),this.menu.addLocalHook("afterClose",()=>bx(aw,this,Hke).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",i=>bx(aw,this,Nke).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=Z_(this.menu.container,this.hot.rootDocument);this.open({left:r.left+i.left,top:r.top+i.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:aW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aW)}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),Zr(i,(n,o)=>{this.menu.setOffset(o,n)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new vQ(this.hot,aR.DEFAULT_ITEMS);const e=this.hot.getSettings()[Uw],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),Te(i,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Nke(t){const e=this.hot.getSettings(),r=e.rowHeaders,i=e.colHeaders;function s(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const n=t.target;if(this.close(),Ir(n,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||i)&&!s(n)&&!(Ir(n,"current")&&Ir(n,"wtBorder"))))return;const o=Z_(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Dke(){this.hot.runHooks("beforeContextMenuShow",this)}function Lke(){this.hot.runHooks("afterContextMenuShow",this)}function Hke(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}aR.SEPARATOR={name:Xr};function $ke(t){return{key:"copy",name(){return this.getTranslatedPhrase(kN)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Bke(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LN,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Vke(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DN,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Wke(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(NN,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function jke(t){return{key:"cut",name(){return this.getTranslatedPhrase(HN)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Uke{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class zke{constructor(){this.clipboardData=new Uke}preventDefault(){}}function Gke(t,e){xQ(t,e),e.add(t)}function $m(t,e,r){xQ(t,e),e.set(t,r)}function xQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yo(t,e){return t.get(Pp(t,e))}function Bm(t,e,r){return t.set(Pp(t,e),r),r}function Pp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var If=new WeakMap,uI=new WeakMap,lw=new WeakMap,yF=new WeakMap,CF=new WeakMap,cw=new WeakMap,uw=new WeakSet;class Yke{constructor(e){let{countRows:r,countColumns:i,rowsLimit:s,columnsLimit:n,countColumnHeaders:o}=e;Gke(this,uw),$m(this,If,void 0),$m(this,uI,void 0),$m(this,lw,void 0),$m(this,yF,void 0),$m(this,CF,void 0),$m(this,cw,void 0),Bm(uI,this,r),Bm(lw,this,i),Bm(yF,this,s),Bm(CF,this,n),Bm(cw,this,o)}setSelectedRange(e){Bm(If,this,e)}getCellsRange(){if(Yo(uI,this).call(this)===0||Yo(lw,this).call(this)===0)return null;const{row:e,col:r}=Yo(If,this).getTopStartCorner(),{row:i,col:s}=Yo(If,this).getBottomEndCorner(),n=Pp(uw,this,Kke).call(this,e,i),o=Pp(uw,this,hI).call(this,r,s);return{isRangeTrimmed:i!==n||s!==o,startRow:e,startCol:r,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(Yo(lw,this).call(this)===0||Yo(cw,this).call(this)===0)return null;const{col:e}=Yo(If,this).getTopStartCorner(),{col:r}=Yo(If,this).getBottomEndCorner(),i=Pp(uw,this,hI).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Yo(lw,this).call(this)===0||Yo(cw,this).call(this)===0)return null;const{col:e}=Yo(If,this).getTopStartCorner(),{col:r}=Yo(If,this).getBottomEndCorner(),i=Pp(uw,this,hI).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-Yo(cw,this).call(this),startCol:e,endRow:-1,endCol:i}}}function hI(t,e){return Math.min(e,Math.max(t+Yo(CF,this).call(this)-1,t))}function Kke(t,e){return Math.min(e,Math.max(t+Yo(yF,this).call(this)-1,t))}function EQ(t){const e=[],r=[];return Te(t,i=>{const s=Math.min(i.startRow,i.endRow),n=Math.max(i.startRow,i.endRow);pr(s,n,h=>{e.indexOf(h)===-1&&e.push(h)});const o=Math.min(i.startCol,i.endCol),l=Math.max(i.startCol,i.endCol);pr(o,l,h=>{r.indexOf(h)===-1&&r.push(h)})}),{rows:e,columns:r}}function Xke(t,e){TQ(t,e),e.add(t)}function Pf(t,e,r){TQ(t,e),e.set(t,r)}function TQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hw(t,e,r){return(e=qke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qke(t){var e=Jke(t,"string");return typeof e=="symbol"?e:e+""}function Jke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Sa(t,e){return t.get(ba(t,e))}function hc(t,e,r){return t.set(ba(t,e),r),r}function ba(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("afterCopyLimit");qt.getSingleton().register("modifyCopyableRange");qt.getSingleton().register("beforeCut");qt.getSingleton().register("afterCut");qt.getSingleton().register("beforePaste");qt.getSingleton().register("afterPaste");qt.getSingleton().register("beforeCopy");qt.getSingleton().register("afterCopy");const fI="copyPaste",Qke=80,Zke=["fragmentSelection"],lW=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var SF=new WeakMap,bF=new WeakMap,xF=new WeakMap,Vm=new WeakMap,xx=new WeakMap,Ex=new WeakMap,Wm=new WeakMap,hT=new WeakMap,ja=new WeakSet;class eNe extends On{constructor(){super(...arguments),Xke(this,ja),hw(this,"columnsLimit",1/0),hw(this,"rowsLimit",1/0),hw(this,"pasteMode","overwrite"),hw(this,"uiContainer",this.hot.rootDocument.body),Pf(this,SF,!1),Pf(this,bF,!1),Pf(this,xF,!1),Pf(this,Vm,"cells-only"),Pf(this,xx,!1),Pf(this,Ex,!1),Pf(this,Wm,new Yke({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Pf(this,hT,!1),hw(this,"copyableRanges",[])}static get PLUGIN_KEY(){return fI}static get SETTING_KEYS(){return[fI,...Zke]}static get PLUGIN_PRIORITY(){return Qke}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[fI]}enablePlugin(){var e,r,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),hc(SF,this,this.getSetting("copyColumnHeaders")),hc(bF,this,this.getSetting("copyColumnGroupHeaders")),hc(xF,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>ba(ja,this,nNe).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return ba(ja,i,iNe).call(i,...n)}),this.addHook("afterSelectionEnd",()=>ba(ja,this,sNe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),nq()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return ba(ja,i,oNe).call(i,...n)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return ba(ja,i,aNe).call(i,...n)}),this.addHook("afterSelection",()=>ba(ja,this,lNe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";hc(Vm,this,e),hc(xx,this,!0),ba(ja,this,cW).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){hc(Ex,this,!0),ba(ja,this,cW).call(this,"cut")}getRangedCopyableData(e){return ly(this.getRangedData(e))}getRangedData(e){const r=[],{rows:i,columns:s}=EQ(e);return Te(i,n=>{const o=[];Te(s,l=>{n<0?o.push(this.hot.getColHeader(l,n)):o.push(this.hot.getCopyableData(n,l))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const i=new zke;e&&i.clipboardData.setData("text/plain",e),r&&i.clipboardData.setData("text/html",r),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Sa(Wm,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Sa(Vm,this)==="column-headers-only"?r.set("headers",Sa(Wm,this).getMostBottomColumnHeadersRange()):(Sa(Vm,this)==="with-column-headers"?r.set("headers",Sa(Wm,this).getMostBottomColumnHeadersRange()):Sa(Vm,this)==="with-column-group-headers"&&r.set("headers",Sa(Wm,this).getAllColumnHeadersRange()),r.set("cells",Sa(Wm,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(s=>s!==null).map(s=>{let{startRow:n,startCol:o,endRow:l,endCol:h}=s;return{startRow:n,startCol:o,endRow:l,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=r.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:s,startCol:n,endRow:o,endCol:l}=i;this.hot.runHooks("afterCopyLimit",o-s+1,l-n+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,s=e[0].length,n=[],{row:o,col:l}=r.getTopStartCorner(),{row:h,col:d}=r.getBottomEndCorner();let g=o,y=l,C=o,x=l;for(;n.length<i||g<=h;){const{skipRowOnPaste:_,visualRow:E}=this.hot.getCellMeta(g,l);if(g=E+1,_===!0)continue;C=E,y=l;const R=[],I=n.length%i;for(;R.length<s||y<=d;){const{skipColumnOnPaste:F,visualCol:D}=this.hot.getCellMeta(o,y);if(y=D+1,F===!0)continue;x=D;const U=R.length%s;R.push(e[I][U])}n.push(R)}return hc(hT,this,!0),this.hot.populateFromArray(o,l,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,l,C,x]}onCopy(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Sa(xx,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),hc(xx,this,!1);const n=this.getRangedData(this.copyableRanges),o=ba(ja,this,tNe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,o)){const h=ly(n);if(e&&e.clipboardData){const d=yB(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[lW,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",n,this.copyableRanges,o)}hc(Vm,this,"cells-only")}onCut(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Sa(Ex,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),hc(Ex,this,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const l=ly(n);if(e&&e.clipboardData){const h=yB(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[lW,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}}onPaste(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const g=$k(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});g&&/(<table)|(<TABLE)/g.test(g)?n=$xe(g,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=NRe(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[o,l,h,d]=this.populateValues(n);this.hot.selectCell(o,l,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function cW(t){if(nq()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:i}=e.highlight,s=this.hot.getCell(r,i,!0);s&&kSe(s,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function tNe(t){const{rows:e}=EQ(t);let r=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)r+=1;return{columnHeadersCount:r}}function rNe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i&&KX(i)}}}function _Q(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i!=null&&i.hasAttribute("contenteditable")&&XX(i)}}}function nNe(t){t.items.push({name:"---------"},$ke(this)),Sa(SF,this)&&t.items.push(Wke(this)),Sa(bF,this)&&t.items.push(Vke(this)),Sa(xF,this)&&t.items.push(Bke(this)),t.items.push(jke(this))}function iNe(t,e,r,i,s){Sa(hT,this)&&(s.value=!0),hc(hT,this,!1)}function sNe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function oNe(){ba(ja,this,_Q).call(this)}function aNe(){ba(ja,this,rNe).call(this)}function lNe(){ba(ja,this,_Q).call(this)}function RQ(t,e){return`border_row${t}col${e}`}function zw(){return{width:1,color:"#000"}}function Hh(){return{hide:!0}}function cNe(){return{width:1,color:"#000",cornerVisible:!1}}function dI(t){if(nr(t.start)||nr(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(nr(t.end)||nr(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function fw(t){return nr(t.start)&&(t.left=t.start),nr(t.end)&&(t.right=t.end),t}function gI(t,e){return{id:RQ(t,e),border:cNe(),row:t,col:e,top:Hh(),bottom:Hh(),start:Hh(),end:Hh()}}function uNe(t,e){return gs(e,"border")&&e.border&&(t.border=e.border),gs(e,"top")&&nr(e.top)&&(e.top?(Qr(e.top)||(e.top=zw()),t.top=e.top):(e.top=Hh(),t.top=e.top)),gs(e,"bottom")&&nr(e.bottom)&&(e.bottom?(Qr(e.bottom)||(e.bottom=zw()),t.bottom=e.bottom):(e.bottom=Hh(),t.bottom=e.bottom)),gs(e,"start")&&nr(e.start)&&(e.start?(Qr(e.start)||(e.start=zw()),t.start=e.start):(e.start=Hh(),t.start=e.start)),gs(e,"end")&&nr(e.end)&&(e.end?(Qr(e.end)||(e.end=zw()),t.end=e.end):(e.end=Hh(),t.end=e.end)),t}function tf(t,e){let r=!1;return Te(t.getSelectedRange(),i=>{i.forAll((s,n)=>{if(s<0||n<0)return;const o=t.getCellMeta(s,n).borders;if(o)if(e){if(!gs(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function lR(t){return`<span class="selected"></span>${t}`}function hNe(t){return t.some(e=>nr(e.left)||nr(e.right))}function fNe(t){return t.some(e=>nr(e.start)||nr(e.end))}const dNe=new Map([["left","start"],["right","end"]]);function gNe(t){var e;return(e=dNe.get(t))!==null&&e!==void 0?e:t}function mNe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(iD);return tf(this,"bottom")&&(e=lR(e)),e},callback(e,r){const i=tf(this,"bottom");t.prepareBorder(r,"bottom",i)}}}function pNe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(sD);return tf(this,e)&&(r=lR(r)),r},callback(r,i){const s=tf(this,e);t.prepareBorder(i,e,s)}}}function vNe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(oD)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!tf(this)}}}function wNe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(nD);return tf(this,e)&&(r=lR(r)),r},callback(r,i){const s=tf(this,e);t.prepareBorder(i,e,s)}}}function yNe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(rD);return tf(this,"top")&&(e=lR(e)),e},callback(e,r){const i=tf(this,"top");t.prepareBorder(r,"top",i)}}}function CNe(t,e){SNe(t,e),e.add(t)}function SNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bNe(t,e,r){return(e=xNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xNe(t){var e=ENe(t,"string");return typeof e=="symbol"?e:e+""}function ENe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const K2="customBorders",TNe=90;var mI=new WeakSet;class _Ne extends On{constructor(){super(...arguments),CNe(this,mI),bNe(this,"savedBorders",[])}static get PLUGIN_KEY(){return K2}static get PLUGIN_PRIORITY(){return TNe}isEnabled(){return!!this.hot.getSettings()[K2]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>uW(mI,this,RNe).call(this,e)),this.addHook("init",()=>uW(mI,this,ANe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let i=["top","bottom","start","end"],s=null;r&&(this.checkSettingsCohesion([r]),i=Object.keys(r),s=dI(r));const n=h1(e),o=sC(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Te(e,l=>{o(l).forAll((h,d)=>{Te(i,g=>{this.prepareBorderFromCustomAdded(h,d,s,gNe(g))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=h1(e),i=sC(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return Te(e,n=>{i(n).forAll((o,l)=>{Te(this.savedBorders,h=>{h.row===o&&h.col===l&&s.push(fw(h))})})}),s}clearBorders(e){e?this.setBorders(e):(Te(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,r,i,s){const n=this.hot.countRows(),o=this.hot.countCols();if(e>=n||r>=o)return;let l=gI(e,r);i&&(l=uNe(l,i),Te(this.hot.selection.highlight.customSelections,h=>{if(l.id===h.settings.id)return Object.assign(h.settings,i),l.id=h.settings.id,l.top=h.settings.top,l.bottom=h.settings.bottom,l.start=h.settings.start,l.end=h.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",fw(l)),this.insertBorderIntoSettings(l,s)}prepareBorderFromCustomAddedRange(e,r){const i=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);pr(e.from.row,i,n=>{pr(e.from.col,s,o=>{const l=gI(n,o);let h=0;n===e.from.row&&gs(r,"top")&&(h+=1,l.top=r.top),n===e.to.row&&gs(r,"bottom")&&(h+=1,l.bottom=r.bottom),o===e.from.col&&gs(r,"start")&&(h+=1,l.start=r.start),o===e.to.col&&gs(r,"end")&&(h+=1,l.end=r.end),h>0&&(this.hot.setCellMeta(n,o,"borders",fw(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,r){const i=RQ(e,r);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,i,s){let n=this.hot.getCellMeta(e,r).borders;!n||n.border===void 0?n=gI(e,r):n=dI(n),s?(n[i]=Hh(),this.countHide(n)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(n,i,s)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,r,"borders",fw(n)))):(n[i]=zw(),this.checkCustomSelectionsFromContextMenu(n,i,s)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,r,"borders",fw(n)))}prepareBorder(e,r,i){Te(e,s=>{let{start:n,end:o}=s;if(n.row===o.row&&n.col===o.col)r==="noBorders"?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,r,i);else switch(r){case"noBorders":pr(n.col,o.col,l=>{pr(n.row,o.row,h=>{this.removeAllBorders(h,l)})});break;case"top":pr(n.col,o.col,l=>{this.setBorder(n.row,l,r,i)});break;case"bottom":pr(n.col,o.col,l=>{this.setBorder(o.row,l,r,i)});break;case"start":pr(n.row,o.row,l=>{this.setBorder(l,n.col,r,i)});break;case"end":pr(n.row,o.row,l=>{this.setBorder(l,o.col,r,i)});break}})}createCustomBorders(e){Te(e,r=>{const i=dI(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,i):this.prepareBorderFromCustomAdded(r.row,r.col,i)})}countHide(e){const{top:r,bottom:i,start:s,end:n}=e;return la([r,i,s,n],(l,h)=>{let d=l;return h&&h.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){const r=on(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){Te(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){Te(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=on(this.savedBorders,i=>i.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):Te(this.savedBorders,(s,n)=>{if(e.id===s.id)return this.savedBorders[n]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,i){let s=!1;return Te(this.hot.selection.highlight.customSelections,n=>{if(e.id===n.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(n);return Te(o,l=>{l.toggleHiddenClass(r,i)}),s=!0,!1}}),s}checkCustomSelections(e,r,i){const s=this.countHide(e);let n=!1;return s===4?(this.removeAllBorders(e.row,e.col),n=!0):Te(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),i){const l=this.hot.view._wt.selectionManager.getBorderInstances(o);Te(l,h=>{h.changeBorderStyle(i,e)})}return n=!0,!1}}),n}changeBorderSettings(){const e=this.hot.getSettings()[K2];if(Array.isArray(e)){const r=sa(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=hNe(e),i=fNe(e);if(r&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function RNe(t){this.hot.getSettings()[K2]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tD)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[yNe(this),wNe(this),mNe(this),pNe(this),vNe(this)]}})}function ANe(){this.changeBorderSettings()}function ONe(t,e){INe(t,e),e.add(t)}function INe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pI(t,e,r){return(e=PNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PNe(t){var e=FNe(t,"string");return typeof e=="symbol"?e:e+""}function FNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fW="dragToScroll",MNe=100;var vI=new WeakSet;class kNe extends On{constructor(){super(...arguments),ONe(this,vI),pI(this,"boundaries",null),pI(this,"callback",null),pI(this,"listening",!1)}static get PLUGIN_KEY(){return fW}static get PLUGIN_PRIORITY(){return MNe}isEnabled(){return!!this.hot.getSettings()[fW]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>hW(vI,this,dW).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>hW(vI,this,dW).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let i=0,s=0;r<this.boundaries.top?s=r-this.boundaries.top:r>this.boundaries.bottom&&(s=r-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",i=>this.onMouseMove(i)),r=a1(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function dW(t){if(Ag(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,i)=>{var s,n;const o=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,l=(n=e.scrollTop)!==null&&n!==void 0?n:e.scrollY;e.scroll(o+Math.sign(r)*50,l+Math.sign(i)*20)}),this.listen()}function NNe(t,e){AQ(t,e),e.add(t)}function DNe(t,e,r){AQ(t,e),e.set(t,r)}function AQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wI(t,e,r){return(e=LNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LNe(t){var e=HNe(t,"string");return typeof e=="symbol"?e:e+""}function HNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Ne(t,e){return t.get(Il(t,e))}function OQ(t,e,r){return t.set(Il(t,e),r),r}function Il(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("afterDropdownMenuDefaultOptions");qt.getSingleton().register("beforeDropdownMenuShow");qt.getSingleton().register("afterDropdownMenuShow");qt.getSingleton().register("afterDropdownMenuHide");qt.getSingleton().register("afterDropdownMenuExecute");const X2="dropdownMenu",BNe=230,uC="changeType",yI=X2;var cR=new WeakMap,gc=new WeakSet;class uR extends On{static get PLUGIN_KEY(){return X2}static get PLUGIN_PRIORITY(){return BNe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sS,oS,Xr,lS,Xr,eR,Xr,aS,Xr,Ol]}constructor(e){super(e),NNe(this,gc),wI(this,"commandExecutor",new pQ(this.hot)),wI(this,"itemsFactory",null),wI(this,"menu",null),DNe(this,cR,!1),this.hot.addHook("afterGetColHeader",(r,i)=>Il(gc,this,WNe).call(this,r,i))}isEnabled(){return this.hot.getSettings()[X2]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new vQ(this.hot,uR.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Il(gc,e,KNe).call(e,...n)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Il(gc,e,YNe).call(e,...n)});const r=this.hot.getSettings()[X2],i={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const s=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new L1(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>Il(gc,this,jNe).call(this)),this.menu.addLocalHook("afterOpen",()=>Il(gc,this,UNe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",n=>Il(gc,this,zNe).call(this,n)),this.menu.addLocalHook("afterClose",()=>Il(gc,this,GNe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e.executeCommand.call(e,...o)}),Te(s,n=>this.commandExecutor.registerCommand(n.key,n))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),n=Z_(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,s.col,!0).querySelector(`.${uC}`),l=o.getBoundingClientRect();this.open({left:l.left+n.left,top:l.top+o.offsetHeight+n.top},{left:l.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:yI},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:yI}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yI)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Il(gc,this,VNe).call(this,e))}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),Zr(i,(s,n)=>{this.menu.setOffset(n,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function IQ(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function VNe(t){if(Ir(t.target,uC)){const e=Z_(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),OQ(cR,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function WNe(t,e){const r=e.parentNode;if(!r)return;const i=r.parentNode.childNodes,s=Array.prototype.indexOf.call(i,r);if(t<0||s!==i.length-1)return;const n=e.querySelector(`.${uC}`);if(this.enabled&&n)return;if(!this.enabled){n&&n.parentNode.removeChild(n);return}const o=this.hot.rootDocument.createElement("button");o.className=uC,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Fr(o,[Dd(),WE(" ")]),Fr(e,[NX("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function jNe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function UNe(){this.hot.runHooks("afterDropdownMenuShow",this),Il(gc,this,IQ).call(this,this.menu)}function zNe(t){Il(gc,this,IQ).call(this,t)}function GNe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function YNe(t){return $Ne(cR,this)?null:t}function KNe(t){Ir(t.target,uC)&&OQ(cR,this,!0)}uR.SEPARATOR={name:Xr};function gW(t,e,r){return(e=XNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XNe(t){var e=qNe(t,"string");return typeof e=="symbol"?e:e+""}function qNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JNe{constructor(e){gW(this,"hot",void 0),gW(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:i,endCol:s}=this._getDataRange(),n=this.options,o=[];return pr(e,i,l=>{const h=[];!n.exportHiddenRows&&this._isHiddenRow(l)||(pr(r,s,d=>{!n.exportHiddenColumns&&this._isHiddenColumn(d)||h.push(this.hot.getDataAtCell(l,d))}),o.push(h))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:i}=this._getDataRange(),s=this.hot.getRowHeader();pr(r,i,n=>{!this.options.exportHiddenRows&&this._isHiddenRow(n)||e.push(s[n])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:i}=this._getDataRange(),s=this.hot.getColHeader();pr(r,i,n=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(n)||e.push(s[n])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[i=0,s=0,n=r,o=e]=this.options.range;return i=Math.max(i,0),s=Math.max(s,0),n=Math.min(n,r),o=Math.min(o,e),{startRow:i,startCol:s,endRow:n,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function mW(t,e,r){return(e=QNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QNe(t){var e=ZNe(t,"string");return typeof e=="symbol"?e:e+""}function ZNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y6{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){mW(this,"dataProvider",void 0),mW(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Wu(this.constructor.DEFAULT_OPTIONS);const i=new Date;return r=vs(Wu(y6.DEFAULT_OPTIONS),r),r=vs(r,e),r.filename=FX(r.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),r}}const eDe="\r",tDe='"',rDe=`
`;class nDe extends y6{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const s=i.length>0,n=this.dataProvider.getRowHeaders(),o=n.length>0;let l=e.bom?"\uFEFF":"";return s&&(i=on(i,h=>this._escapeCell(h,!0)),o&&(l+=e.columnDelimiter),l+=i.join(e.columnDelimiter),l+=e.rowDelimiter),Te(r,(h,d)=>{d>0&&(l+=e.rowDelimiter),o&&(l+=this._escapeCell(n[d])+e.columnDelimiter),l+=h.map(g=>this._escapeCell(g)).join(e.columnDelimiter)}),l}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=is(e);return i!==""&&(r||i.indexOf(eDe)>=0||i.indexOf(tDe)>=0||i.indexOf(rDe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const iDe="csv",EF={[iDe]:nDe};function sDe(t,e,r){return typeof EF[t]=="function"?new EF[t](e,r):null}const oDe="exportFile",aDe=240;class lDe extends On{static get PLUGIN_KEY(){return oDe}static get PLUGIN_PRIORITY(){return aDe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:s}=this.hot,n=this._createTypeFormatter(e,r),o=this._createBlob(n),l=s.URL||s.webkitURL,h=i.createElement("a"),d=`${n.options.filename}.${n.options.fileExtension}`;if(h.download!==void 0){const g=l.createObjectURL(o);h.style.display="none",h.setAttribute("href",g),h.setAttribute("download",d),i.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),i.body.removeChild(h),setTimeout(()=>{l.revokeObjectURL(g)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,d)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EF[e])throw new Error(`Export format type "${e}" is not supported.`);return sDe(e,new JNe(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function jm(t,e,r){return(e=cDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cDe(t){var e=uDe(t,"string");return typeof e=="symbol"?e:e+""}function uDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cS{constructor(e,r){let{id:i,stateless:s=!0}=r;jm(this,"hot",void 0),jm(this,"id",void 0),jm(this,"elements",[]),jm(this,"hidden",!1),jm(this,"stateId",""),jm(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new U_)}getElements(){return this.elements}reset(){Te(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Te(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Xn(cS,uo);const hC={};function Ad(t,e){if(!hC[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:i}=hC[t];let s=e;return i.inputValuesDecorator&&(s=i.inputValuesDecorator(s)),function(n){return r.apply(n.meta.instance,[].concat([n],[s]))}}function ag(t){if(!hC[t])throw Error(`Filter condition "${t}" does not exist.`);return hC[t].descriptor}function os(t,e,r){r.key=t,hC[t]={condition:e,descriptor:r}}const Vs="none";function hDe(){return!0}os(Vs,hDe,{name:z_,inputsCount:0,showOperators:!1});const hy="empty";function fDe(t){return qi(t.value)}os(hy,fDe,{name:dD,inputsCount:0,showOperators:!0});const q2="not_empty";function dDe(t,e){return!Ad(hy,e)(t)}os(q2,dDe,{name:gD,inputsCount:0,showOperators:!0});const fy="eq";function gDe(t,e){let[r]=e;return is(t.value).toLocaleLowerCase(t.meta.locale)===is(r)}os(fy,gDe,{name:mD,inputsCount:1,showOperators:!0});const J2="neq";function mDe(t,e){return!Ad(fy,e)(t)}os(J2,mDe,{name:pD,inputsCount:1,showOperators:!0});const PQ="gt";function pDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}os(PQ,pDe,{name:SD,inputsCount:1,showOperators:!0});const FQ="gte";function vDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}os(FQ,vDe,{name:bD,inputsCount:1,showOperators:!0});const MQ="lt";function wDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}os(MQ,wDe,{name:xD,inputsCount:1,showOperators:!0});const kQ="lte";function yDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}os(kQ,yDe,{name:ED,inputsCount:1,showOperators:!0});const C6="date_after";function CDe(t,e){let[r]=e;const i=wt(t.value,t.meta.dateFormat),s=wt(r,t.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)>=0}os(C6,CDe,{name:RD,inputsCount:1,showOperators:!0});const S6="date_before";function SDe(t,e){let[r]=e;const i=wt(t.value,t.meta.dateFormat),s=wt(r,t.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)<=0}os(S6,SDe,{name:AD,inputsCount:1,showOperators:!0});const fT="between";function bDe(t,e){let[r,i]=e,s=r,n=i;if(t.meta.type==="numeric"){const o=parseFloat(s,10),l=parseFloat(n,10);s=Math.min(o,l),n=Math.max(o,l)}else if(t.meta.type==="date"){const o=Ad(S6,[n]),l=Ad(C6,[s]);return o(t)&&l(t)}return t.value>=s&&t.value<=n}os(fT,bDe,{name:TD,inputsCount:2,showOperators:!0});const NQ="not_between";function xDe(t,e){return!Ad(fT,e)(t)}os(NQ,xDe,{name:_D,inputsCount:2,showOperators:!0});const DQ="begins_with";function EDe(t,e){let[r]=e;return is(t.value).toLocaleLowerCase(t.meta.locale).startsWith(is(r))}os(DQ,EDe,{name:vD,inputsCount:1,showOperators:!0});const LQ="ends_with";function TDe(t,e){let[r]=e;return is(t.value).toLocaleLowerCase(t.meta.locale).endsWith(is(r))}os(LQ,TDe,{name:wD,inputsCount:1,showOperators:!0});const b6="contains";function _De(t,e){let[r]=e;return is(t.value).toLocaleLowerCase(t.meta.locale).indexOf(is(r))>=0}os(b6,_De,{name:yD,inputsCount:1,showOperators:!0});const HQ="not_contains";function RDe(t,e){return!Ad(b6,e)(t)}os(HQ,RDe,{name:CD,inputsCount:1,showOperators:!0});const $Q="date_tomorrow";function ADe(t){const e=wt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(wt().subtract(-1,"days").startOf("day"),"d"):!1}os($Q,ADe,{name:ID,inputsCount:0});const BQ="date_today";function ODe(t){const e=wt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(wt().startOf("day"),"d"):!1}os(BQ,ODe,{name:OD,inputsCount:0});const VQ="date_yesterday";function IDe(t){const e=wt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(wt().subtract(1,"days").startOf("day"),"d"):!1}os(VQ,IDe,{name:PD,inputsCount:0});ZSe();function PDe(t,e){let r=t;return r===""&&(r=`(${e})`),r}const TF=new Set([1]).has(1),FDe=TF&&typeof Array.from=="function";function uS(t){let e=t;return TF&&(e=new Set(e)),function(r){let i;return TF?i=e.has(r):i=!!~e.indexOf(r),i}}function WQ(t){return t??""}function _F(t){let e=t;return FDe?e=Array.from(new Set(e)):e=OX(e),e=e.sort((r,i)=>typeof r=="number"&&typeof i=="number"?r-i:r===i?0:r>i?1:-1),e}function pW(t,e,r,i){const s=[],n=t===e;let o;return n||(o=uS(e)),Te(t,l=>{let h=!1;(n||o(l))&&(h=!0);const d={checked:h,value:l,visualValue:PDe(l,r)};i&&i(d),s.push(d)}),s}const lg="by_value";function MDe(t,e){let[r]=e;return r(t.value)}os(lg,MDe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[uS(e)]},showOperators:!1});const fC={};function kDe(t){if(!fC[t])throw Error(`Operation with id "${t}" does not exist.`);const e=fC[t].func;return function(r,i){return e(r,i)}}function NDe(t){return fC[t].name}function x6(t,e,r){fC[t]={name:e,func:r}}const xd="conjunction",DDe=kD;function LDe(t,e){return t.every(r=>r.func(e))}x6(xd,DDe,LDe);const dT="disjunction",HDe=G_;function $De(t,e){return t.some(r=>r.func(e))}x6(dT,HDe,$De);const E6="disjunctionWithExtraCondition",BDe=G_;function VDe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}x6(E6,BDe,VDe);const WDe="numeric",jQ="text",jDe="date",vW={[WDe]:[Vs,Xr,hy,q2,Xr,fy,J2,Xr,PQ,FQ,MQ,kQ,fT,NQ],[jQ]:[Vs,Xr,hy,q2,Xr,fy,J2,Xr,DQ,LQ,Xr,b6,HQ],[jDe]:[Vs,Xr,hy,q2,Xr,fy,J2,Xr,S6,C6,fT,Xr,$Q,BQ,VQ]};function UDe(t){const e=[];let r=t;return vW[r]||(r=jQ),Te(vW[r],i=>{let s;i===Xr?s={name:Xr}:s=Wu(ag(i)),e.push(s)}),e}function dw(t,e,r){return(e=zDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zDe(t){var e=GDe(t,"string");return typeof e=="symbol"?e:e+""}function GDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const CI="built",SI="building",wW=["click","input","keydown","keypress","keyup","focus","blur","change"];let Ic=class UQ{static get DEFAULTS(){return Wu({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){dw(this,"hot",void 0),dw(this,"eventManager",new Dc(this)),dw(this,"options",void 0),dw(this,"_element",void 0),dw(this,"buildState",void 0),this.hot=e,this.options=vs(UQ.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===SI?this._element:this.buildState===CI?(this.update(),this._element):(this.buildState=SI,this.build(),this.buildState=CI,this._element)}isBuilt(){return this.buildState===CI}translateIfPossible(e){return typeof e=="string"&&e.startsWith(ca)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,i)=>{this.eventManager.addEventListener(r,i,s=>this.runLocalHooks(i,s,this))};if(this.buildState||(this.buildState=SI),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ht(this._element,this.options.className),this.options.children.length)Te(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),Zr(this.options,(i,s)=>{r[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(r[s]=this.translateIfPossible(i))}),this._element.appendChild(r),Te(wW,i=>e(r,i))}else Te(wW,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Xn(Ic,uo);function YDe(t,e){zQ(t,e),e.add(t)}function KDe(t,e,r){zQ(t,e),e.set(t,r)}function zQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tx(t,e){return t.get(T6(t,e))}function XDe(t,e,r){return t.set(T6(t,e),r),r}function T6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Um=new WeakMap,yW=new WeakSet;class Ed extends Ic{static get DEFAULTS(){return Wu({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,vs(Ed.DEFAULTS,r)),YDe(this,yW),KDe(this,Um,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>T6(yW,this,qDe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");XDe(Um,this,this._element.firstChild),ht(this._element,"htUIInput"),ht(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Tx(Um,this).type=this.options.type,Tx(Um,this).placeholder=this.translateIfPossible(this.options.placeholder),Tx(Um,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Tx(Um,this).focus()}}function qDe(t){this.options.value=t.target.value}function JDe(t,e){GQ(t,e),e.add(t)}function gw(t,e,r){GQ(t,e),e.set(t,r)}function GQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zm(t,e,r){return t.set(dy(t,e),r),r}function Oi(t,e){return t.get(dy(t,e))}function dy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ts=new WeakMap,_x=new WeakMap,Rx=new WeakMap,bI=new WeakMap,Ax=new WeakMap,Ox=new WeakSet;class dC extends Ic{static get DEFAULTS(){return Wu({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,vs(dC.DEFAULTS,r)),JDe(this,Ox),gw(this,Ts,null),gw(this,_x,[]),gw(this,Rx,void 0),gw(this,bI,void 0),gw(this,Ax,void 0),this.registerHooks()}getMenu(){return Oi(Ts,this)}registerHooks(){this.addLocalHook("click",()=>dy(Ox,this,e6e).call(this))}setItems(e){zm(_x,this,this.translateNames(e)),Oi(Ts,this)&&Oi(Ts,this).setMenuItems(Oi(_x,this))}translateNames(e){return Te(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),zm(Ts,this,new L1(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Oi(Ts,this).setMenuItems(Oi(_x,this));const e=new Ic(this.hot,{className:"htUISelectCaption"}),r=new Ic(this.hot,{className:"htUISelectDropdown"});zm(Rx,this,e),zm(bI,this,e.element),zm(Ax,this,r),this.hot.getSettings().ariaTags&&(Fr(r.element,[Dd()]),Fr(this._element,[kX()])),Te([e,r],i=>this._element.appendChild(i.element)),Oi(Ts,this).addLocalHook("select",i=>dy(Ox,this,QDe).call(this,i)),Oi(Ts,this).addLocalHook("afterClose",()=>dy(Ox,this,ZDe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Oi(Ts,this).hot.getTranslatedPhrase(z_),Oi(bI,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Oi(Ts,this)&&(Oi(Ts,this).open(),Oi(Ts,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Oi(Ts,this).getNavigator().toFirstItem(),Oi(Ts,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Oi(Ts,this)&&Oi(Ts,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Oi(Ts,this)&&(Oi(Ts,this).destroy(),zm(Ts,this,null)),Oi(Rx,this)&&Oi(Rx,this).destroy(),Oi(Ax,this)&&Oi(Ax,this).destroy(),super.destroy()}}function QDe(t){t.name!==Xr&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ZDe(){this.runLocalHooks("afterClose")}function e6e(){this.openOptions()}function t6e(t,e){r6e(t,e),e.add(t)}function r6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CW(t,e,r){return(e=n6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n6e(t){var e=i6e(t,"string");return typeof e=="symbol"?e:e+""}function i6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xI=new WeakSet;class RF extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),t6e(this,xI),CW(this,"name",""),CW(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new dC(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new Ed(this.hot,{placeholder:BD})),this.elements.push(new Ed(this.hot,{placeholder:VD})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>SW(xI,this,s6e).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Te(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>SW(xI,this,o6e).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Wu(e.command);r.name.startsWith($i)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),Te(e.args,(i,s)=>{if(s>r.inputsCount-1)return!1;const n=this.getInputElement(s);n.setValue(i),n[r.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>n.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||ag(Vs),r=[];return Te(this.getInputElements(),(i,s)=>{e.inputsCount>s&&r.push(i.getValue())}),{command:e,args:r}}updateState(e,r){const i=ag(e?e.name:Vs);this.state.setValueAtIndex(r,{command:i,args:e?e.args:[]}),e||Te(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof dC)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Ed)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,s,n,o)=>{ht(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ht(r.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return ht(l,"htFiltersMenuLabel"),l.textContent=o,r.appendChild(l),r.parentElement.hasAttribute("ghost-table")||Te(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[ag(Vs)];if(e!==null){const{visualIndex:i}=e;r=UDe(this.hot.getDataType(0,i,this.hot.countRows(),i))}Te(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function s6e(t){Te(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function o6e(t){qC(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Bc(t))}function bW(t,e,r){a6e(t,e),e.set(t,r)}function a6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mw(t,e){return t.get(YQ(t,e))}function xW(t,e,r){return t.set(YQ(t,e),r),r}function YQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gm=new WeakMap,EI=new WeakMap;class gT extends Ic{static get DEFAULTS(){return Wu({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,vs(gT.DEFAULTS,r)),bW(this,Gm,void 0),bW(this,EI,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),xW(EI,this,e),xW(Gm,this,this._element.firstChild),mw(Gm,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(mw(EI,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?mw(Gm,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(mw(Gm,this).checked=e)}focus(){this.isBuilt()&&mw(Gm,this).focus()}}function l6e(t,e){c6e(t,e),e.add(t)}function c6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u6e(t,e,r){return(e=h6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h6e(t){var e=f6e(t,"string");return typeof e=="symbol"?e:e+""}function f6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d6e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EW=0;var TW=new WeakSet;class g6e extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),l6e(this,TW),u6e(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ht(r.parentNode,"htFiltersMenuOperators"),Te(this.elements,i=>r.appendChild(i.element)),r)}}buildOperatorsElement(){const e=[xd,dT];Te(e,r=>{const i=new gT(this.hot,{name:"operator",label:{htmlFor:r,textContent:NDe(r)},value:r,checked:r===e[EW],id:r});i.addLocalHook("change",s=>d6e(TW,this,m6e).call(this,s)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(Ln`Radio button with index ${e} doesn't exist.`);Te(this.elements,(r,i)=>{r.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof gT&&r.isChecked());return e?e.getValue():xd}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Te(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xd,r=arguments.length>1?arguments[1]:void 0,i=e;i===E6&&(i=dT),this.state.setValueAtIndex(r,i)}reset(){this.setChecked(EW)}}function m6e(t){this.setState(t.target.value)}function p6e(t,e,r){v6e(t,e),e.set(t,r)}function v6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TI(t,e){return t.get(KQ(t,e))}function w6e(t,e,r){return t.set(KQ(t,e),r),r}function KQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pw=new WeakMap;class gC extends Ic{static get DEFAULTS(){return Wu({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,vs(gC.DEFAULTS,r)),p6e(this,pw,void 0)}build(){super.build(),w6e(pw,this,this._element.firstChild)}update(){this.isBuilt()&&(TI(pw,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&TI(pw,this).focus()}activate(){TI(pw,this).click()}}function y6e(t,e){XQ(t,e),e.add(t)}function Ym(t,e,r){XQ(t,e),e.set(t,r)}function XQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $r(t,e){return t.get(Fp(t,e))}function ic(t,e,r){return t.set(Fp(t,e),r),r}function Fp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _W="multipleSelect.itemBox";var mc=new WeakMap,zi=new WeakMap,_I=new WeakMap,ph=new WeakMap,Ff=new WeakMap,Mf=new WeakMap,vw=new WeakSet;class mC extends Ic{static get DEFAULTS(){return Wu({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,vs(mC.DEFAULTS,r)),y6e(this,vw),Ym(this,mc,[]),Ym(this,zi,void 0),Ym(this,_I,void 0),Ym(this,ph,void 0),Ym(this,Ff,void 0),Ym(this,Mf,void 0),ic(ph,this,new Ed(this.hot,{placeholder:$D,className:"htUIMultipleSelectSearch"})),ic(Ff,this,new gC(this.hot,{textContent:ND,className:"htUISelectAll"})),ic(Mf,this,new gC(this.hot,{textContent:DD,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return $r(zi,this)}registerHooks(){$r(ph,this).addLocalHook("keydown",e=>Fp(vw,this,S6e).call(this,e)),$r(ph,this).addLocalHook("input",e=>Fp(vw,this,C6e).call(this,e)),$r(Ff,this).addLocalHook("click",e=>Fp(vw,this,b6e).call(this,e)),$r(Mf,this).addLocalHook("click",e=>Fp(vw,this,x6e).call(this,e))}setItems(e){var r;ic(mc,this,e),(r=$r(zi,this))===null||r===void 0||r.loadData($r(mc,this))}setLocale(e){ic(_I,this,e)}getLocale(){return $r(_I,this)}getItems(){return[...$r(mc,this)]}getValue(){return T6e($r(mc,this))}getSearchInputElement(){return $r(ph,this)}getSelectAllElement(){return $r(Ff,this)}getClearAllElement(){return $r(Mf,this)}isSelectedAllValues(){return $r(mc,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),i=new Ic(this.hot,{className:"htUISelectionControls",children:[$r(Ff,this),$r(Mf,this)]});this._element.appendChild($r(ph,this).element),this._element.appendChild(i.element),this._element.appendChild(r);const s=n=>{var o;if(!this._element)return;(o=$r(zi,this))===null||o===void 0||o.destroy(),ht(n,"htUIMultipleSelectHot"),ic(zi,this,new this.hot.constructor(n,{data:$r(mc,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,g,y,C,x,_)=>{d.title=_.instance.getDataAtRowProp(g,_.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{$r(zi,this).listen()},colWidths:()=>$r(zi,this).container.scrollWidth-so(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),$r(zi,this).init(),this.hot.addHook("afterSetTheme",(d,g)=>{g||$r(zi,this).useTheme(d)});const h=$r(zi,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:_W}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{$r(zi,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:_W})};s(r),this.hot._registerTimeout(()=>s(r),100)}focus(){this.isBuilt()&&$r(zi,this).listen()}reset(){$r(ph,this).reset(),$r(Ff,this).reset(),$r(Mf,this).reset()}update(){this.isBuilt()&&($r(zi,this).loadData(E6e($r(mc,this),this.options.value)),super.update())}destroy(){var e;(e=$r(zi,this))===null||e===void 0||e.destroy(),$r(ph,this).destroy(),$r(Mf,this).destroy(),$r(Ff,this).destroy(),ic(ph,this,null),ic(Mf,this,null),ic(Ff,this,null),ic(zi,this,null),ic(mc,this,null),super.destroy()}}function C6e(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...$r(mc,this)]:r=$r(mc,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),$r(zi,this).loadData(r)}function S6e(t){this.runLocalHooks("keydown",t,this),qX(qC,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Bc(t),$r(zi,this).listen(),$r(zi,this).selectCell(0,0))}function b6e(t){const e=[];t.preventDefault(),$r(zi,this).getSourceData().forEach((r,i)=>{r.checked=!0,e.push($q(r,i)[0])}),$r(zi,this).setSourceDataAtCell(e)}function x6e(t){const e=[];t.preventDefault(),$r(zi,this).getSourceData().forEach((r,i)=>{r.checked=!1,e.push($q(r,i)[0])}),$r(zi,this).setSourceDataAtCell(e)}function E6e(t,e){const r=uS(e);return t.map(i=>(i.checked=r(i.value),i))}function T6e(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function _6e(t,e){R6e(t,e),e.add(t)}function R6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A6e(t,e,r){return(e=O6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O6e(t){var e=I6e(t,"string");return typeof e=="symbol"?e:e+""}function I6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ix(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ww=new WeakSet;class P6e extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),_6e(this,ww),A6e(this,"name",""),this.name=r.name,this.elements.push(new mC(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ix(ww,this,F6e).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>Ix(ww,this,M6e).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===lg){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Vs:lg},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(i,s,n,o,l)=>{const[h]=Rd(s,y=>y.name===lg),d={},g=this.hot.getTranslatedPhrase(QE);if(h){const y=o(i,l),C=on(y,F=>F.value),x=new Map(y.map(F=>[F.value,this.hot.getCellMeta(F.meta.visualRow,F.meta.visualCol)])),_=_F(C);n&&(h.args[0]=n);const E=[],R=pW(_,h.args[0],g,F=>{F.checked&&E.push(F.value),Ix(ww,this,RW).call(this,F,x)}),I=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,I).locale,d.args=[E],d.command=ag(lg),d.itemsSnapshot=R}else d.args=[],d.command=ag(Vs);this.state.setValueAtIndex(i,d)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof mC)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,s,n,o)=>{ht(r.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return ht(l,"htFiltersMenuLabel"),l.textContent=o,r.appendChild(l),r.parentElement.hasAttribute("ghost-table")||Te(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(QE),r=this._getColumnVisibleValues(),i=r.map(h=>h.value),s=new Map(r.map(h=>[h.value,h.meta])),n=_F(i),o=pW(n,n,e,h=>{Ix(ww,this,RW).call(this,h,s)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(n);const l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:on(this.hot.getDataAtCol(e.visualIndex),(r,i)=>({value:WQ(r),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function F6e(t){qC(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Bc(t))}function RW(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function M6e(t,e){switch(e.type){case"numeric":return BJ(t,e);default:return t}}var qQ;function k6e(t,e){N6e(t,e),e.add(t)}function N6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D6e(t,e,r){return(e=L6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L6e(t){var e=H6e(t,"string");return typeof e=="symbol"?e:e+""}function H6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $6e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var AW=new WeakSet;class pC extends cS{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),k6e(this,AW),D6e(this,"name",""),this.name=r.name,this.elements.push(new Ed(this.hot,{type:"button",value:LD,className:"htUIButton htUIButtonOK",identifier:pC.BUTTON_OK})),this.elements.push(new Ed(this.hot,{type:"button",value:HD,className:"htUIButton htUIButtonCancel",identifier:pC.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Te(this.elements,e=>{e.addLocalHook("click",(r,i)=>$6e(AW,this,B6e).call(this,r,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ht(r.parentNode,"htFiltersMenuActionBar"),Te(this.elements,i=>r.appendChild(i.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}qQ=pC;function B6e(t,e){e.options.identifier===qQ.BUTTON_OK?this.accept():this.cancel()}function Px(t,e,r){return(e=V6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V6e(t){var e=W6e(t,"string");return typeof e=="symbol"?e:e+""}function W6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OW="ConditionCollection.filteringStates";class _6{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Px(this,"hot",void 0),Px(this,"isMapRegistrable",void 0),Px(this,"filteringStates",new U_),Px(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(OW,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var i;const s=this.filteringStates.getValueAtIndex(r),n=(i=s==null?void 0:s.conditions)!==null&&i!==void 0?i:[],o=s==null?void 0:s.operation;return this.isMatchInConditions(n,e,o)}isMatchInConditions(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xd;return e.length?kDe(i)(e,r):!0}addCondition(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xd,s=arguments.length>3?arguments[3]:void 0;const n=this.hot.getCellMeta(0,e).locale,o=on(r.args,g=>typeof g=="string"?g.toLocaleLowerCase(n):g),l=r.name||r.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==i)throw Error(Ln`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(_i(fC[i]))throw new Error(Ln`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:l,args:o,func:Ad(l,o)}]},s):d.push({name:l,args:o,func:Ad(l,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,i;return(r=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return la(this.filteringStates.getEntries(),(e,r)=>{let[i,{operation:s,conditions:n}]=r;return e.push({column:i,operation:s,conditions:on(n,o=>{let{name:l,args:h}=o;return{name:l,args:h}})}),e},[])}importAllConditions(e){this.clean(),Te(e,r=>{Te(r.conditions,i=>this.addCondition(r.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const i=this.getConditions(e);return r?i.some(s=>s.name===r):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(OW),this.filteringStates=null,this.clearLocalHooks()}}Xn(_6,uo);function IW(t,e,r){return(e=j6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j6e(t){var e=U6e(t,"string");return typeof e=="symbol"?e:e+""}function U6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JQ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];IW(this,"conditionCollection",void 0),IW(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return Te(this.conditionCollection.getFilteredColumns(),(r,i)=>{let s=this.columnDataFactory(r);i&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(r,s)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return Te(r,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&i.push(s)}),i}_getIntersectData(e,r){const i=[];return Te(r,s=>{const n=s.meta.visualRow;e[n]!==void 0&&(i[n]=e[n])}),i}}function z6e(t,e){G6e(t,e),e.add(t)}function G6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A0(t,e,r){return(e=Y6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y6e(t){var e=K6e(t,"string");return typeof e=="symbol"?e:e+""}function K6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fx=new WeakSet;class QQ{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];z6e(this,Fx),A0(this,"hot",void 0),A0(this,"conditionCollection",void 0),A0(this,"columnDataFactory",void 0),A0(this,"changes",[]),A0(this,"grouping",!1),A0(this,"latestEditedColumnPosition",-1),A0(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",s=>RI(Fx,this,X6e).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>RI(Fx,this,q6e).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>RI(Fx,this,J6e).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Te(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let n=this.conditionCollection.getColumnStackPosition(e);n===-1&&(n=this.latestEditedColumnPosition);const o=s.slice(0,n),l=s.slice(n);l.length&&l[0].column===e&&l.shift();const h=NSe(function(g,y){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const x=new _6(i.hot,!1),_=[].concat(g,C);x.importAllConditions(_);const E=i.columnDataFactory(y);let R;x.isEmpty()?R=E:R=new JQ(x,F=>i.columnDataFactory(F)).filter(),R=on(R,F=>F.meta.visualRow);const I=uS(R);return x.destroy(),Rd(E,F=>I(F.meta.visualRow))})(o),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:l,filteredRowsFactory:h,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),Zr(this,(e,r)=>{this[r]=null})}}function X6e(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function q6e(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function J6e(){Te(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Xn(QQ,uo);function Q6e(t){return yQ({initialPage:0,size:()=>t.length,onItemSelect:(r,i)=>{const s=t[r];if(s instanceof mC)return i;if(s.element&&!l1(s.element))return!1;s.focus()}})}const yw="filters";function Z6e(t,e){let r=-1,i;const s=Q6e(e),n=y=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(yw),s.setCurrentPage(e.indexOf(y))};e.forEach(y=>{y instanceof Ic&&(y.addLocalHook("click",n(y)),y.addLocalHook("focus",n(y)),y.addLocalHook("afterClose",n(y)))}),h(t);function o(y){const C=i.getKeyboardShortcutsCtrl(),x=y.getKeyboardShortcutsCtrl();s.clear(),x.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:C.getContext(yw),callback:()=>{y.isSubMenu()&&y.close(),C.listen(yw)}}]),!y.isSubMenu()&&C.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:_=>{const E=i.getNavigator();E.getCurrentPage()>-1&&(r=E.getCurrentPage()),E.clear(),_.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:_=>{const E=e[s.getCurrentPage()];E instanceof dC&&(E.openOptions(),_.preventDefault()),E instanceof gC&&(E.activate(),_.preventDefault()),E instanceof Ic||_.preventDefault()}}],yw)}function l(){i.focus(),i.getKeyboardShortcutsCtrl().listen(yw)}function h(y){y.addLocalHook("afterSelectionChange",C=>{C.key.startsWith("filter_")||s.clear()}),y.addLocalHook("afterSubmenuOpen",o),y.addLocalHook("afterOpen",o),i=y}function d(){return i}function g(){return r}return{...s,listen:l,setMenu:h,getMenu:d,getLastMenuPage:g}}function e5e(t,e){ZQ(t,e),e.add(t)}function PW(t,e,r){ZQ(t,e),e.set(t,r)}function ZQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cw(t,e,r){return(e=t5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t5e(t){var e=r5e(t,"string");return typeof e=="symbol"?e:e+""}function r5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n5e(t,e,r){return t.set(wa(t,e),r),r}function Ph(t,e){return t.get(wa(t,e))}function wa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const AF="filters",i5e=250,FW=AF;var bh=new WeakMap,OF=new WeakMap,La=new WeakSet;class s5e extends On{static get PLUGIN_KEY(){return AF}static get PLUGIN_PRIORITY(){return i5e}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),e5e(this,La),Cw(this,"dropdownMenuPlugin",null),Cw(this,"conditionCollection",null),Cw(this,"conditionUpdateObserver",null),Cw(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Cw(this,"filtersRowsMap",null),PW(this,bh,void 0),PW(this,OF,new WeakSet),this.hot.addHook("afterGetColHeader",(r,i)=>wa(La,this,f5e).call(this,r,i))}isEnabled(){return!!this.hot.getSettings()[AF]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new eS),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,i=r&&r.uiContainer||this.hot.rootDocument.body,s=l=>(l.addLocalHook("accept",()=>wa(La,this,MW).call(this,"accept")),l.addLocalHook("cancel",()=>wa(La,this,MW).call(this,"cancel")),l.addLocalHook("change",h=>wa(La,this,h5e).call(this,l,h)),l),n=()=>`${this.hot.getTranslatedPhrase(FD)}:`,o=()=>`${this.hot.getTranslatedPhrase(MD)}:`;if(!this.components.get("filter_by_condition")){const l=new RF(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:i});l.addLocalHook("afterClose",()=>wa(La,this,kW).call(this)),this.components.set("filter_by_condition",s(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new g6e(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const l=new RF(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});l.addLocalHook("afterClose",()=>wa(La,this,kW).call(this)),this.components.set("filter_by_condition2",s(l))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new P6e(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new pC(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _6(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new QQ(this.hot,this.conditionCollection,l=>this.getDataMapAtColumn(l)),this.conditionUpdateObserver.addLocalHook("update",l=>wa(La,this,d5e).call(this,l))),this.components.forEach(l=>l.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var l=arguments.length,h=new Array(l),d=0;d<l;d++)h[d]=arguments[d];return wa(La,e,u5e).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>wa(La,this,c5e).call(this)),this.addHook("afterDropdownMenuShow",()=>wa(La,this,a5e).call(this)),this.addHook("afterDropdownMenuHide",()=>wa(La,this,l5e).call(this)),this.addHook("afterChange",l=>wa(La,this,o5e).call(this,l)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ph(bh,this)&&this.dropdownMenuPlugin.enabled){const l=[{focus:()=>{const d=Ph(bh,this).getMenu(),g=d.getNavigator(),y=Ph(bh,this).getLastMenuPage();d.focus(),y>0?g.setCurrentPage(y):g.toFirstItem()}},...Array.from(this.components).map(d=>{let[,g]=d;return g.getElements()}).flat()];n5e(bh,this,Z6e(this.dropdownMenuPlugin.menu,l));const h=d=>{Ph(bh,this).listen(),d.preventDefault(),qC(d.keyCode,"TAB")&&(d.shiftKey?Ph(bh,this).toPreviousItem():Ph(bh,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,i)=>{r.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:FW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FW)}addCondition(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:xd;const n=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(n,{command:{key:r},args:i},s)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let s=[];const n=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",n,this.conditionCollection.previousConditionStack)!==!1)if(i){const l=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=on(r.filter(),d=>d.meta.visualRow);const h=uS(s);pr(this.hot.countSourceRows()-1,d=>{h(d)||l.push(d)}),Te(l,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!s.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",n),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),i=[];return Te(this.hot.getSourceDataAtCol(r),(s,n)=>{var o;const{row:l,col:h,visualCol:d,visualRow:g,type:y,instance:C,dateFormat:x,locale:_}=this.hot.getCellMeta(n,r),E=(o=this.hot.getDataAtCell(this.hot.toVisualRow(n),r))!==null&&o!==void 0?o:s;i.push({meta:{row:l,col:h,visualCol:d,visualRow:g,type:y,instance:C,dateFormat:x,locale:_},value:WQ(E)})}),i}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),i=_F(r);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var r;const i=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,i,s){let n=e;return n===dT&&r.command.key!==Vs&&i.command.key!==Vs&&s.command.key!==Vs?n=E6:s.command.key!==Vs&&(r.command.key===Vs||i.command.key===Vs)&&(n=xd),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new JQ(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Te(s,o=>{Te(r.menuItems,(l,h)=>{l.key===o.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,s=i.getPlugin("hiddenRows");for(var n=arguments.length,o=new Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];const h=this.getIndexesOfComponents(...o);e?s.showRows(h):s.hideRows(h),i.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function o5e(t){t&&Te(t,e=>{const[,r]=e,i=this.hot.propToCol(r);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function a5e(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function l5e(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function c5e(){const t=this.dropdownMenuPlugin.menu;Ph(OF,this).has(t)||Ph(bh,this).setMenu(t),Ph(OF,this).add(t)}function u5e(t){t.items.push({name:Xr}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function MW(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:s}=i,n=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,o,l);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),n.command.key!==Vs&&(this.conditionCollection.addCondition(s,n,h,d),o.command.key!==Vs&&this.conditionCollection.addCondition(s,o,h,d)),l.command.key!==Vs&&this.conditionCollection.addCondition(s,l,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function h5e(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===RF&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function kW(){this.setListeningDropdownMenu()}function f5e(t,e){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?ht(e,"htFiltersActive"):Ar(e,"htFiltersActive")}function d5e(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:i}}=t,s=r.filter(o=>o.name===lg),n=r.filter(o=>o.name!==lg);if(s.length>=2||n.length>=3)Nn(Ln`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(n[0],i),this.components.get("filter_by_condition2").updateState(n[1],i),this.components.get("filter_operators").updateState(o,i),this.components.get("filter_by_value").updateState(t)}}const eZ="internal-use-in-handsontable",IF={licenseKey:eZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function tZ(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Po])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function rZ(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function g5e(t){var e;const r=t[Po],i=rZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),s=tZ(t);return{...IF,...i,...s}}function m5e(t){var e;const r=t[Po],i=rZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),s=tZ(t);return{...i,...s}}function p5e(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function hR(){const t="engine_relationship",e=Vc(Po);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function R6(){const t="shared_engine_usage",e=Vc(Po);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function v5e(t){const e=t.getSettings(),r=e[Po],i=r==null?void 0:r.engine;if(r===!0||_i(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var s;return w5e((s=i.hyperformula)!==null&&s!==void 0?s:i,e,t)}else if(typeof i=="object"&&_i(i.hyperformula)){const n=hR(),o=R6().get(i);return n.has(i)||n.set(i,[]),n.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:eZ}),(i.getConfig().leapYear1900!==IF.leapYear1900||Gk(i.getConfig().nullDate,IF.nullDate)===!1)&&Nn(Ln`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function w5e(t,e,r){const i=e[Po],s=g5e(e),n=hR(),o=R6();y5e(t,i.functions),C5e(t,i.language);const l=t.buildEmpty(s);return n.set(l,[r]),o.set(l,[r.guid]),S5e(l,i.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function NW(t){var e;const r=hR(),i=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(s=>[s.getPlugin("formulas").sheetId,s]))}function DW(t,e){if(t){const r=hR(),i=r.get(t),s=R6(),n=s.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&r.delete(t)),n&&n.includes(e.guid)&&(n.splice(n.indexOf(e.guid),1),n.length===0&&(s.delete(t),t.destroy()))}}function y5e(t,e){e&&e.forEach(r=>{const{name:i,plugin:s,translations:n}=r;try{t.registerFunction(i,s,n)}catch(o){Nn(o.message)}})}function C5e(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(i){Nn(i.message)}}}function S5e(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:i,expression:s,scope:n,options:o}=r;try{t.addNamedExpression(i,s,n,o)}catch(l){Nn(l.message)}}),t.resumeEvaluation())}function b5e(t,e){return(_i(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const nZ="DD/MM/YYYY";function iZ(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function x5e(t){return iZ(t)?t.substr(1):t}function E5e(t){return typeof t=="string"&&t.startsWith("=")}function A6(t,e){return typeof t=="string"&&e==="date"}function sZ(t,e){return wt(t,e,!0).isValid()}function oZ(t,e){return wt(t,e,!0).format(nZ)}function T5e(t,e){return wt(t,nZ,!0).format(e)}function aZ(t,e){const i=new Date(Date.UTC(0,0,t+-1));return wt(i).format(e)}function _5e(t,e,r){const i=Array.from(Array(r).keys()).filter(n=>t.includes(n)===!1);if(e===0){var s;return(s=i[e])!==null&&s!==void 0?s:0}return i[e-1]+1}function R5e(t,e){const r=[];return t.forEach(i=>{const s={from:i,to:e};r.forEach(n=>{const o=n.from>n.to,l=n.to<=s.from;n.from>s.from&&l&&o&&(s.from+=1)}),s.from>=e&&(e+=1),r.push(s)}),r}function A5e(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(s=>{const n=s.from<s.to;s.from>e.from&&n&&(s.from-=1)})}),t}function O6(t,e,r){const i=R5e(t,_5e(t,e,r));return A5e(i)}function O0(t,e,r){O5e(t,e),e.set(t,r)}function O5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gi(t,e){return t.get(lZ(t,e))}function kf(t,e,r){return t.set(lZ(t,e),r),r}function lZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Sw=new WeakMap,Nf=new WeakMap,Ha=new WeakMap,Mx=new WeakMap,AI=new WeakMap,OI=new WeakMap,kx=new WeakMap;class LW{constructor(e,r,i){O0(this,Sw,void 0),O0(this,Nf,void 0),O0(this,Ha,void 0),O0(this,Mx,[]),O0(this,AI,[]),O0(this,OI,void 0),O0(this,kx,[]),kf(Sw,this,e),kf(Nf,this,r),kf(Ha,this,i)}setRemovedHfIndexes(e){return kf(kx,this,e.map(r=>{const i=gi(Nf,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(i)})),gi(kx,this)}getRemovedHfIndexes(){return gi(kx,this)}getHfIndexFromVisualIndex(e){const r=gi(Nf,this).getIndexesSequence(),i=gi(Nf,this).getNotTrimmedIndexes();return r.indexOf(i[e])}syncMoves(e){const i=`move${Nc(gi(Sw,this))}s`;gi(Ha,this).getEngine().batch(()=>{e.forEach(s=>{const n=s.from!==s.to,o=s.from+1!==s.to;n&&o&&gi(Ha,this).getEngine()[i](gi(Ha,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,r,i){i!==!1&&(kf(AI,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),kf(OI,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(gi(Ha,this).isPerformingUndoRedo()||e===!1||r===!1)return;const i=O6(gi(AI,this),gi(OI,this),gi(Nf,this).getNumberOfIndexes());gi(Ha,this).getSheetId()===null?gi(Ha,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Nc(gi(Sw,this))}Order`;return r=>{if(gi(Ha,this).isPerformingUndoRedo())return;const i=gi(Nf,this).getIndexesSequence();if(r==="update"&&i.length>0){const s=gi(Mx,this).map(h=>i.indexOf(h)),n=gi(Ha,this).getEngine().getSheetDimensions(gi(Ha,this).getSheetId());let o;gi(Sw,this)==="row"?o=n.height:o=n.width;const l=s.length;for(let h=l;h<o;h+=1)s.push(h);gi(Ha,this).getEngine()[e](gi(Ha,this).getSheetId(),s)}kf(Mx,this,i)}}init(){kf(Mx,this,gi(Nf,this).getIndexesSequence())}}function I0(t,e,r){I5e(t,e),e.set(t,r)}function I5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vh(t,e){return t.get(cZ(t,e))}function P0(t,e,r){return t.set(cZ(t,e),r),r}function cZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nx=new WeakMap,Dx=new WeakMap,II=new WeakMap,PI=new WeakMap,FI=new WeakMap,MI=new WeakMap,kI=new WeakMap;class P5e{constructor(e,r,i){I0(this,Nx,void 0),I0(this,Dx,void 0),I0(this,II,void 0),I0(this,PI,!1),I0(this,FI,!1),I0(this,MI,null),I0(this,kI,null),P0(Nx,this,new LW("row",e,this)),P0(Dx,this,new LW("column",r,this)),P0(II,this,i)}getForAxis(e){return e==="row"?vh(Nx,this):vh(Dx,this)}setPerformUndo(e){P0(PI,this,e)}setPerformRedo(e){P0(FI,this,e)}isPerformingUndoRedo(){return vh(PI,this)||vh(FI,this)}getSheetId(){return vh(kI,this)}getEngine(){return vh(MI,this)}getPostponeAction(){return vh(II,this)}setupSyncEndpoint(e,r){P0(MI,this,e),P0(kI,this,r),vh(Nx,this).init(),vh(Dx,this).init()}}function F5e(t,e){uZ(t,e),e.add(t)}function Km(t,e,r){return(e=M5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M5e(t){var e=k5e(t,"string");return typeof e=="symbol"?e:e+""}function k5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NI(t,e,r){uZ(t,e),e.set(t,r)}function uZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Od(t,e,r){return t.set(Wn(t,e),r),r}function Yp(t,e){return t.get(Wn(t,e))}function Wn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Po="formulas",N5e=["maxRows","maxColumns","language"],D5e=260;qt.getSingleton().register("afterNamedExpressionAdded");qt.getSingleton().register("afterNamedExpressionRemoved");qt.getSingleton().register("afterSheetAdded");qt.getSingleton().register("afterSheetRemoved");qt.getSingleton().register("afterSheetRenamed");qt.getSingleton().register("afterFormulasValuesUpdate");const H1=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var rf=new WeakMap,I6=new WeakMap,bw=new WeakMap,Jn=new WeakSet;class L5e extends On{constructor(){var e;super(...arguments),e=this,F5e(this,Jn),NI(this,rf,!1),NI(this,I6,!1),NI(this,bw,[["valuesUpdated",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,Z5e).call(e,...i)}],["namedExpressionAdded",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,eLe).call(e,...i)}],["namedExpressionRemoved",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,tLe).call(e,...i)}],["sheetAdded",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,rLe).call(e,...i)}],["sheetRenamed",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,nLe).call(e,...i)}],["sheetRemoved",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Wn(Jn,e,iLe).call(e,...i)}]]),Km(this,"staticRegister",Vc("formulas")),Km(this,"engine",null),Km(this,"sheetName",null),Km(this,"indexSyncer",null),Km(this,"rowAxisSyncer",null),Km(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Po}static get PLUGIN_PRIORITY(){return D5e}static get SETTING_KEYS(){return[Po,...N5e]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Po]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=v5e(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Nn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,HW).call(r,...s)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,$W).call(r,...s)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,HW).call(r,...s)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,$W).call(r,...s)}),this.addHook("modifyData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,V5e).call(r,...s)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,W5e).call(r,...s)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,H5e).call(r,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,j5e).call(r,...s)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,BW).call(r,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,BW).call(r,...s)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,U5e).call(r,...s)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,z5e).call(r,...s)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,K5e).call(r,...s)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,X5e).call(r,...s)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,G5e).call(r,...s)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,Y5e).call(r,...s)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,q5e).call(r,...s)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,J5e).call(r,...s)}),this.indexSyncer=new P5e(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,s,n,o)=>{this.rowAxisSyncer.storeMovesInformation(i,s,o)}),this.hot.addHook("beforeColumnMove",(i,s,n,o)=>{this.columnAxisSyncer.storeMovesInformation(i,s,o)}),this.hot.addHook("afterRowMove",(i,s,n,o,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,l)}),this.hot.addHook("afterColumnMove",(i,s,n,o,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,l)}),this.hot.addHook("beforeColumnFreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,B5e).call(r,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,Q5e).call(r,...s)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Wn(Jn,r,$5e).call(r,...s)}),Yp(bw,this).forEach(i=>{let[s,n]=i;return this.engine.on(s,n)}),super.enablePlugin()}}disablePlugin(){Yp(bw,this).forEach(e=>{let[r,i]=e;return this.engine.off(r,i)}),DW(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=m5e(this.hot.getSettings());p5e(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const i=this.hot.getSettings()[Po];if(nr(i)&&nr(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[Po].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Yp(bw,this).forEach(e=>{var r;let[i,s]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(i,s)}),Od(bw,this,null),DW(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(nr(r)&&!v_e(r))return Nn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Nn("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(i),r),i}catch(i){return Nn(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){Xk(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${Nc(Po)}.switchSheet`)}getCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(r);return s!==null&&n!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(s=>{var n;const o=s==null||(n=s.address)===null||n===void 0?void 0:n.sheet;o!==void 0&&(i.has(o)||i.add(o))}),NW(this.engine).forEach((s,n)=>{if((r||n!==this.sheetId)&&i.has(n)){var o;s.render(),(o=s.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=n=>{var o;const{row:l,col:h,sheet:d}=(o=n==null?void 0:n.address)!==null&&o!==void 0?o:{};return nr(d)?`${d}:${l}x${h}`:""},s=new Set(r.map(n=>i(n)));e.forEach(n=>{var o,l;const{row:h,col:d}=(o=n.address)!==null&&o!==void 0?o:{};if(nr(h)===!1||nr(d)===!1||h>=this.hot.countRows()||d>=this.hot.countCols())return;const g=n==null||(l=n.address)===null||l===void 0?void 0:l.sheet,y=i(n);if(g!==void 0&&!s.has(y)){const C=NW(this.engine).get(g);if(!C)return;C.validateCell(C.getDataAtCell(h,d),C.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(e,r,i){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Nn(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const n=this.hot.getCellMeta(e,r);return A6(i,n.type)&&(sZ(i,n.dateFormat)?i=oZ(i,n.dateFormat):E5e(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(s,i)}}function H5e(t,e,r){const i=this.hot.propToCol(r);if(this.isFormulaCellType(e,i)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},n=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(s);return n.type==="date"&&ea(o)&&(o=aZ(o,n.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function $5e(t,e,r){const{row:i,col:s}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),{row:l,col:h}=r.getTopStartCorner(),{row:d,col:g}=r.getBottomEndCorner(),y={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(C)===!1)return!1;const x=this.engine.getFillRangeData(y,C),{row:_,col:E}=y.start,{row:R,col:I}=y.end,F=R-_+1,D=I-E+1;for(let U=0;U<x.length;U+=1)for(let X=0;X<x[U].length;X+=1){const te=x[U][X],Y=_+U%F,oe=E+X%D,me=this.hot.getCellMeta(Y,oe);A6(te,me.type)&&(te.startsWith("'")?x[U][X]=te.slice(1):this.isFormulaCellType(Y,oe,this.sheetId)===!1&&(x[U][X]=T5e(te,me.dateFormat)))}return x}function HW(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Nc(Po))||Od(I6,this,_i(this.hot.getSettings().data))}function B5e(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((r,i)=>{r.forEach((s,n)=>{const o=this.hot.getCellMeta(i,n),l=o.dateFormat;A6(s,o.type)&&(e=!0,sZ(s,l)?t[i][n]=oZ(s,l):this.isFormulaCellType(i,n)===!1&&(t[i][n]=`'${s}`))})}),e===!0&&(Od(rf,this,!0),this.engine.setSheetContent(this.sheetId,t),Od(rf,this,!1))}function $W(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Nc(Po)))if(this.sheetName=b5e(this.engine,this.hot.getSettings()[Po].sheetName),Yp(I6,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Od(rf,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Od(rf,this,!1)}}}function V5e(t,e,r,i){if(i!=="get"||Yp(rf,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t);if(s===null||e===null)return;if(!this.isFormulaCellType(s,e)&&this.getCellType(s,e)!=="ARRAY"){iZ(r.value)&&(r.value=x5e(r.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(o),h=this.hot.getCellsMeta().find(g=>g.visualRow===s&&g.visualCol===e);h===void 0&&(h={}),h.type==="date"&&ea(l)&&(l=aZ(l,h.dateFormat));const d=typeof l=="object"&&l!==null?l.value:l;r.value=d}function W5e(t,e,r,i){if(i!=="get"||Yp(rf,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t),n=this.hot.propToCol(e);if(s===null||n===null||!this.isFormulaCellType(s,n)&&this.getCellType(s,n)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};r.value=this.engine.getCellSerialized(h)}function BW(t,e){if(H1(e))return;const r=[],i=[],s=this.engine.batch(()=>{t.forEach(n=>{let[o,l,,h]=n;const d=this.hot.propToCol(l),g=this.hot.toPhysicalRow(o),y=this.hot.toPhysicalColumn(d),C={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};g!==null&&y!==null?this.syncChangeWithEngine(o,d,h):r.push([o,d,h]),i.push({address:C})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const n=this.engine.batch(()=>{r.forEach(o=>{let[l,h,d]=o;this.syncChangeWithEngine(l,h,d)})});this.renderDependentSheets(n,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,i)}function j5e(t,e){if(H1(e))return;const r=[],i=[];t.forEach(s=>{let[n,o,,l]=s;const h=this.hot.propToCol(o);if(!ea(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){Nn(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),r.push(...this.engine.setCellContents(d,l))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function U5e(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function z5e(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function G5e(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(n=>this.engine.isItPossibleToRemoveRows(this.sheetId,[n,1]))===!1?!1:void 0}function Y5e(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(n=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[n,1]))===!1?!1:void 0}function K5e(t,e,r){if(H1(r))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function X5e(t,e,r){if(H1(r))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function q5e(t,e,r,i){if(H1(i))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,l)=>l-o),n=this.engine.batch(()=>{s.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(n)}function J5e(t,e,r,i){if(H1(i))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,l)=>l-o),n=this.engine.batch(()=>{s.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(n)}function Q5e(t,e,r){var i;Od(rf,this,!0);const s=this.hot.getSourceDataArray(r,0,r+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Od(rf,this,!1),s.forEach((n,o)=>{n.forEach((l,h)=>{this.engine.setCellContents({col:h,row:r+o,sheet:this.sheetId},[[l]])})})}function Z5e(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function eLe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function tLe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rLe(t){this.hot.runHooks("afterSheetAdded",t)}function nLe(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function iLe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function sLe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,i,,s]=e;i-s!==0&&(r=1)}return this.getTranslatedPhrase(cD,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,r.col),0),s=Math.max(e.col,r.col),n=[];for(let h=i;h<=s;h+=1)n.push(h);t.hideColumns(n);const o=n[n.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function oLe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(uD,r)},callback(){var r,i;if(e.length===0)return;let s=e[0],n=e[e.length-1];s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&r!==void 0?r:0,n=(i=this.columnIndexMapper.getNearestNotHiddenIndex(n+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),n-s+1===this.countCols()||this.selectColumns(s,n)},disabled:!1,hidden(){const r=on(t.getHiddenColumns(),y=>this.toPhysicalColumn(y));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().col,n=i.getBottomEndCorner().col,o=this.columnIndexMapper,l=o.getRenderableFromVisualIndex(s),h=o.getRenderableFromVisualIndex(n),d=o.getNotTrimmedIndexes(),g=[];if(s!==n){const y=n-s+1,C=h-l+1;if(y>C){const x=d.slice(s,n+1);g.push(...x.filter(_=>r.includes(_)))}}else if(l===0&&l<s)g.push(...d.slice(0,s));else if(l===null)g.push(...d.slice(0,this.countCols()));else{const y=this.countCols()-1,C=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,-1));h===C&&y>n&&g.push(...d.slice(n+1))}return Te(g,y=>{e.push(this.toVisualColumn(y))}),e.length===0}}}function aLe(t,e){hZ(t,e),e.add(t)}function lLe(t,e,r){hZ(t,e),e.set(t,r)}function hZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F0(t,e){return t.get(zf(t,e))}function VW(t,e,r){return t.set(zf(t,e),r),r}function zf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeHideColumns");qt.getSingleton().register("afterHideColumns");qt.getSingleton().register("beforeUnhideColumns");qt.getSingleton().register("afterUnhideColumns");const WW="hiddenColumns",cLe=310;var lu=new WeakMap,M0=new WeakSet;class uLe extends On{constructor(){super(...arguments),aLe(this,M0),lLe(this,lu,null)}static get PLUGIN_KEY(){return WW}static get PLUGIN_PRIORITY(){return cLe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[WW]}enablePlugin(){var e=this;this.enabled||(VW(lu,this,new j_),F0(lu,this).addLocalHook("init",()=>zf(M0,this,pLe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,F0(lu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return zf(M0,e,mLe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>zf(M0,this,fLe).call(this,r,i,s)),this.addHook("modifyColWidth",(r,i)=>zf(M0,this,hLe).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return zf(M0,e,gLe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>zf(M0,this,dLe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let s=r;const n=F0(lu,this).getValues().slice(),o=e.length>0;if(i&&o){const h=e.map(d=>this.hot.toPhysicalColumn(d));Te(h,d=>{n[d]=!1}),s=la(n,(d,g,y)=>(g&&d.push(this.hot.toVisualColumn(y)),d),[])}this.hot.runHooks("beforeUnhideColumns",r,s,i&&o)!==!1&&(i&&o&&F0(lu,this).setValues(n),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,s,i&&o,i&&s.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{Te(e,o=>{F0(lu,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,s,i,i&&s.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideColumns(r)}getHiddenColumns(){return on(F0(lu,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return F0(lu,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){Te(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){VW(lu,this,null),super.destroy()}}function hLe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function fLe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenColumn");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}function dLe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,s,n,o)=>{e.push({startRow:i,endRow:s,startCol:n,endCol:o})};return Te(t,i=>{let s=!0,n=0;pr(i.startCol,i.endCol,o=>{this.isHidden(o)?(s||r(i.startRow,i.endRow,n,o-1),s=!0):(s&&(n=o),o===i.endCol&&r(i.startRow,i.endRow,n,o),s=!1)})}),e}function gLe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),ht(e,r)}function mLe(t){t.items.push({name:Xr},sLe(this),oLe(this))}function pLe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function vLe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[i,,s]=e;i-s!==0&&(r=1)}return this.getTranslatedPhrase(hD,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,r.row),0),s=Math.max(e.row,r.row),n=[];for(let h=i;h<=s;h+=1)n.push(h);t.hideRows(n);const o=n[n.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wLe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(fD,r)},callback(){var r,i;if(e.length===0)return;let s=e[0],n=e[e.length-1];s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&r!==void 0?r:0,n=(i=this.rowIndexMapper.getNearestNotHiddenIndex(n+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),n-s+1===this.countRows()||this.selectRows(s,n)},disabled:!1,hidden(){const r=on(t.getHiddenRows(),y=>this.toPhysicalRow(y));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().row,n=i.getBottomEndCorner().row,o=this.rowIndexMapper,l=o.getRenderableFromVisualIndex(s),h=o.getRenderableFromVisualIndex(n),d=o.getNotTrimmedIndexes(),g=[];if(s!==n){const y=n-s+1,C=h-l+1;if(y>C){const x=d.slice(s,n+1);g.push(...x.filter(_=>r.includes(_)))}}else if(l===0&&l<s)g.push(...d.slice(0,s));else if(l===null)g.push(...d.slice(0,this.countRows()));else{const y=this.countRows()-1,C=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,-1));h===C&&y>n&&g.push(...d.slice(n+1))}return Te(g,y=>{e.push(this.toVisualRow(y))}),e.length===0}}}function yLe(t,e){fZ(t,e),e.add(t)}function CLe(t,e,r){fZ(t,e),e.set(t,r)}function fZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k0(t,e){return t.get(Gf(t,e))}function jW(t,e,r){return t.set(Gf(t,e),r),r}function Gf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeHideRows");qt.getSingleton().register("afterHideRows");qt.getSingleton().register("beforeUnhideRows");qt.getSingleton().register("afterUnhideRows");const UW="hiddenRows",SLe=320;var cu=new WeakMap,N0=new WeakSet;class bLe extends On{constructor(){super(...arguments),yLe(this,N0),CLe(this,cu,null)}static get PLUGIN_KEY(){return UW}static get PLUGIN_PRIORITY(){return SLe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[UW]}enablePlugin(){var e=this;this.enabled||(jW(cu,this,new j_),k0(cu,this).addLocalHook("init",()=>Gf(N0,this,ALe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,k0(cu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gf(N0,e,RLe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Gf(N0,this,ELe).call(this,r,i,s)),this.addHook("modifyRowHeight",(r,i)=>Gf(N0,this,xLe).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gf(N0,e,_Le).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Gf(N0,this,TLe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let s=r;const n=k0(cu,this).getValues().slice(),o=e.length>0;if(i&&o){const h=e.map(d=>this.hot.toPhysicalRow(d));Te(h,d=>{n[d]=!1}),s=la(n,(d,g,y)=>(g&&d.push(this.hot.toVisualRow(y)),d),[])}this.hot.runHooks("beforeUnhideRows",r,s,i&&o)!==!1&&(i&&o&&k0(cu,this).setValues(n),this.hot.runHooks("afterUnhideRows",r,s,i&&o,i&&s.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{Te(e,o=>{k0(cu,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,s,i,i&&s.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideRows(r)}getHiddenRows(){return on(k0(cu,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return k0(cu,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){Te(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){jW(cu,this,null),super.destroy()}}function xLe(t,e){return this.isHidden(e)?0:t}function ELe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenRow");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}function TLe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,s,n,o)=>{e.push({startRow:i,endRow:s,startCol:n,endCol:o})};return Te(t,i=>{let s=!0,n=0;pr(i.startRow,i.endRow,o=>{this.isHidden(o)?(s||r(n,o-1,i.startCol,i.endCol),s=!0):(s&&(n=o),o===i.endRow&&r(n,o,i.startCol,i.endCol),s=!1)})}),e}function _Le(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),ht(e,r)}function RLe(t){t.items.push({name:Xr},vLe(this),wLe(this))}function ALe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function OLe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase($N)},callback(e,r){const[{start:{col:i}}]=r;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function ILe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(BN)},callback(e,r){const[{start:{col:i}}]=r;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function PLe(t,e){dZ(t,e),e.add(t)}function FLe(t,e,r){dZ(t,e),e.set(t,r)}function dZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PF(t,e){return t.get(mT(t,e))}function DI(t,e,r){return t.set(mT(t,e),r),r}function mT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeColumnFreeze");qt.getSingleton().register("afterColumnFreeze");qt.getSingleton().register("beforeColumnUnfreeze");qt.getSingleton().register("afterColumnUnfreeze");const zW="manualColumnFreeze",MLe=110;var q0=new WeakMap,LI=new WeakSet;class kLe extends On{constructor(){super(...arguments),PLe(this,LI),FLe(this,q0,!1)}static get PLUGIN_KEY(){return zW}static get PLUGIN_PRIORITY(){return MLe}isEnabled(){return!!this.hot.getSettings()[zW]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>mT(LI,this,NLe).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>mT(LI,this,DLe).call(this,e,r)),super.enablePlugin())}disablePlugin(){DI(q0,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;PF(q0,this)||DI(q0,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;PF(q0,this)||DI(q0,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function NLe(t){t.items.push({name:"---------"},OLe(this),ILe(this))}function DLe(t,e){if(PF(q0,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(i=>i<r))return!1}}function Lx(t,e,r){return(e=LLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LLe(t){var e=HLe(t,"string");return typeof e=="symbol"?e:e+""}function HLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const HI=0,GW=1,YW=2,Xm="px";let gZ=class{constructor(e){Lx(this,"hot",void 0),Lx(this,"_element",null),Lx(this,"state",HI),Lx(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=YW}build(){this.state===HI&&(this._element=this.hot.rootDocument.createElement("div"),this.state=GW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=HI}isAppended(){return this.state===YW}isBuilt(){return this.state>=GW}setPosition(e,r){ea(e)&&(this._element.style.top=e+Xm),ea(r)&&(this._element.style[this.inlineProperty]=r+Xm)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){ea(e)&&(this._element.style.width=e+Xm),ea(r)&&(this._element.style.height=r+Xm)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){ea(e)&&(this._element.style.marginTop=e+Xm),ea(r)&&(this._element.style[`margin${Nc(this.inlineProperty)}`]=r+Xm)}getOffset(){const e=this._element.style,r=`margin${Nc(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const $Le="ht__manualColumnMove--backlight";let BLe=class extends gZ{build(){super.build(),ht(this._element,$Le)}};const VLe="ht__manualColumnMove--guideline";let WLe=class extends gZ{build(){super.build(),ht(this._element,VLe)}};function jLe(t,e){mZ(t,e),e.add(t)}function sc(t,e,r){mZ(t,e),e.set(t,r)}function mZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xa(t,e,r){return t.set(Yf(t,e),r),r}function lr(t,e){return t.get(Yf(t,e))}function Yf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeColumnMove");qt.getSingleton().register("afterColumnMove");const $I="manualColumnMove",ULe=120,KW="ht__manualColumnMove",pT="show-ui",FF="on-moving--columns",MF="after-selection--columns";var Qo=new WeakMap,Jf=new WeakMap,$h=new WeakMap,Q2=new WeakMap,ld=new WeakMap,Xo=new WeakMap,Hx=new WeakMap,Rl=new WeakMap,fp=new WeakMap,vT=new WeakMap,gy=new WeakMap,D0=new WeakSet;class zLe extends On{constructor(){super(...arguments),jLe(this,D0),sc(this,Qo,new BLe(this.hot)),sc(this,Jf,new WLe(this.hot)),sc(this,$h,[]),sc(this,Q2,0),sc(this,ld,!1),sc(this,Xo,{}),sc(this,Hx,void 0),sc(this,Rl,void 0),sc(this,fp,void 0),sc(this,vT,void 0),sc(this,gy,void 0)}static get PLUGIN_KEY(){return $I}static get PLUGIN_PRIORITY(){return ULe}isEnabled(){return!!this.hot.getSettings()[$I]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Yf(D0,e,GLe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Yf(D0,e,KLe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Yf(D0,this,qLe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Yf(D0,e,JLe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),ht(this.hot.rootElement,KW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ar(this.hot.rootElement,KW),this.unregisterEvents(),lr(Qo,this).destroy(),lr(Jf,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const i=lr(Hx,this),s=this.isMovePossible(e,r),n=this.hot.runHooks("beforeColumnMove",e,r,i,s);if(xa(Hx,this,void 0),n===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=s&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,i,s,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const i=this.countFinalIndex(e,r);return xa(Hx,this,r),this.moveColumns(e,i)}isMovePossible(e,r){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+r>i,n=r<0,o=e.some(h=>h<0),l=e.some(h=>h>=i);return!(s||n||o||l)}isColumnOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}countFinalIndex(e,r){const i=la(e,(s,n)=>(n<r&&(s+=1),s),0);return r-i}getColumnsWidth(e,r){const i=this.hot.columnIndexMapper;let s=0;for(let n=e;n<=r;n+=1){const o=i.getRenderableFromVisualIndex(n);n<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[$I];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const i=[];return pr(e,r,s=>{i.push(s)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(lr(Rl,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let n=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,lr(Rl,this)-1);const o=r.hider.offsetWidth,l=r.TBODY.offsetLeft,h=lr(Qo,this).getOffset().start,d=lr(Qo,this).getSize().width;let g=0,y=0;if(this.hot.isRtl()){const _=this.hot.rootWindow,E=ns(this.hot.rootElement),R=_.innerWidth-lr(fp,this)-E;y=_.innerWidth-lr(Xo,this).eventPageX-R-(i.scrollX===void 0?s:0)}else y=lr(Xo,this).eventPageX-(lr(fp,this)-(i.scrollX===void 0?s:0));if(lr(vT,this)&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(lr(Rl,this))&&(n+=s),n+=g,lr(Rl,this)<0)lr(gy,this)>0?lr(Xo,this).col=0:lr(Xo,this).col=e>0?e-1:e;else if(lr(Xo,this).TD.offsetWidth/2+n<=y){const _=lr(Rl,this)>=lr(Q2,this)?lr(Q2,this)-1:lr(Rl,this);lr(Xo,this).col=_+1,n+=lr(Xo,this).TD.offsetWidth}else lr(Xo,this).col=lr(Rl,this);let C=y,x=n;y+d+h>=o?C=o-d-h:y+h<l+g&&(C=l+g+Math.abs(h)),n>=o-1?x=o-1:x===0?x=1:i.scrollX!==void 0&&lr(Rl,this)<lr(gy,this)&&(x-=lr(fp,this)<=i.scrollX?lr(fp,this):0),lr(Qo,this).setPosition(null,C),lr(Jf,this).setPosition(null,x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Yf(D0,this,YLe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Yf(D0,this,XLe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){lr(Qo,this).build(),lr(Jf,this).build()}destroy(){lr(Qo,this).destroy(),lr(Jf,this).destroy(),super.destroy()}}function GLe(t,e,r,i){const s=this.hot.view._wt.wtTable,n=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),l=Ir(t.target,"sortAction");if(!o||!n||lr(ld,this)||t.button!==0||l){xa(ld,this,!1),lr($h,this).length=0,Ar(this.hot.rootElement,[FF,pT]);return}const h=lr(Jf,this).isBuilt()&&!lr(Jf,this).isAppended(),d=lr(Qo,this).isBuilt()&&!lr(Qo,this).isAppended();h&&d&&(lr(Jf,this).appendTo(s.hider),lr(Qo,this).appendTo(s.hider));const{from:g,to:y}=o,C=Math.min(g.col,y.col),x=Math.max(g.col,y.col);if(e.row<0&&e.col>=C&&e.col<=x){i.column=!0,xa(ld,this,!0);const _=r.firstChild?cbe(t,r.firstChild).x:t.offsetX;lr(Xo,this).eventPageX=t.pageX,xa(Rl,this,e.col),lr(Xo,this).TD=r,lr(Xo,this).col=e.col,xa($h,this,this.prepareColumnsToMoving(C,x)),xa(vT,this,!!this.hot.getSettings().rowHeaders),xa(Q2,this,this.hot.countCols()),xa(gy,this,this.hot.getSettings().fixedColumnsStart),xa(fp,this,Ws(this.hot.rootElement).left);const E=lr(vT,this)?-1:0,R=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,I=e.col<lr(gy,this),F=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),D=Math.abs(_-(this.hot.isRtl()?r.offsetWidth:0)),U=this.getColumnsWidth(C,e.col-1)+D,X=this.getColumnsWidth(E,C-1)+(I?F:0)+U;lr(Qo,this).setPosition(R,X),lr(Qo,this).setSize(this.getColumnsWidth(C,x),s.hider.offsetHeight-R),lr(Qo,this).setOffset(null,-U),ht(this.hot.rootElement,FF)}else Ar(this.hot.rootElement,MF),xa(ld,this,!1),lr($h,this).length=0}function YLe(t){lr(ld,this)&&(lr(Xo,this).eventPageX=t.pageX,this.refreshPositions())}function KLe(t,e,r,i){!this.hot.getSelectedRangeLast()||!lr(ld,this)||(lr($h,this).indexOf(e.col)>-1?Ar(this.hot.rootElement,pT):ht(this.hot.rootElement,pT),i.row=!0,i.column=!0,i.cell=!0,xa(Rl,this,e.col),lr(Xo,this).TD=r)}function XLe(){const t=lr(Xo,this).col,e=lr($h,this).length;if(xa(Rl,this,void 0),xa(ld,this,!1),Ar(this.hot.rootElement,[FF,pT,MF]),this.hot.selection.isSelectedByColumnHeader()&&ht(this.hot.rootElement,MF),e<1||t===void 0)return;const r=lr($h,this)[0],i=this.hot.toPhysicalColumn(r),s=this.dragColumns(lr($h,this),t);if(lr($h,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const n=this.hot.toVisualColumn(i),o=n+e-1;this.hot.selectColumns(n,o)}}function qLe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,i=e+r;lr(Qo,this).setPosition(i),lr(Qo,this).setSize(null,t.hider.offsetHeight-i)}function JLe(){this.moveBySettingsOrLoad()}function QLe(t,e){pZ(t,e),e.add(t)}function To(t,e,r){pZ(t,e),e.set(t,r)}function pZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e,r){return t.set(pc(t,e),r),r}function Yt(t,e){return t.get(pc(t,e))}function pc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wT="manualColumnResize",ZLe=130,XW="manualColumnWidths";var Ah=new WeakMap,$x=new WeakMap,za=new WeakMap,yT=new WeakMap,Mu=new WeakMap,e8e=new WeakMap,Kp=new WeakMap,Bx=new WeakMap,va=new WeakMap,xh=new WeakMap,Mg=new WeakMap,CT=new WeakMap,my=new WeakMap,py=new WeakMap,Xa=new WeakMap,vy=new WeakMap,uu=new WeakSet;class t8e extends On{static get PLUGIN_KEY(){return wT}static get PLUGIN_PRIORITY(){return ZLe}constructor(e){super(e),QLe(this,uu),To(this,Ah,null),To(this,$x,null),To(this,za,[]),To(this,yT,null),To(this,Mu,null),To(this,e8e,null),To(this,Kp,null),To(this,Bx,null),To(this,va,this.hot.rootDocument.createElement("DIV")),To(this,xh,this.hot.rootDocument.createElement("DIV")),To(this,Mg,null),To(this,CT,!1),To(this,my,0),To(this,py,null),To(this,Xa,void 0),To(this,vy,void 0),ht(Yt(va,this),"manualColumnResizer"),ht(Yt(xh,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[wT]}enablePlugin(){var e=this;this.enabled||(Yi(Xa,this,new Hd),Yt(Xa,this).addLocalHook("init",()=>pc(uu,this,r8e).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Yt(Xa,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return pc(uu,e,l8e).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return pc(uu,e,c8e).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return pc(uu,e,u8e).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Yi(vy,this,Yt(Xa,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",XW,Yt(Xa,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",XW,e),e.value}setManualSize(e,r){const i=Math.max(r,20),s=this.hot.toPhysicalColumn(e);return Yt(Xa,this).setValueAtIndex(s,i),i}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);Yt(Xa,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;Yi(Ah,this,e);const{_wt:r}=this.hot.view,i=r.wtTable.getCoords(Yt(Ah,this)),s=i.col;if(s<0)return;const n=Ji(Yt(Ah,this)),o=Yt(Ah,this).getBoundingClientRect(),l=s<r.getSetting("fixedColumnsStart");let h;l&&(h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Yt(Ah,this),i.row,i.col)),h||(h=r.wtOverlays.topOverlay.getRelativeCellPosition(Yt(Ah,this),i.row,i.col)),Yi($x,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),Yi(za,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();Te(g,y=>{const C=y.getTopStartCorner().col,x=y.getBottomEndCorner().col;pr(C,x,_=>{Yt(za,this).includes(_)||Yt(za,this).push(_)})})}Yt(za,this).includes(Yt($x,this))||Yi(za,this,[Yt($x,this)]),Yi(Bx,this,h.start-6),Yi(Kp,this,parseInt(o.width,10)),Yt(va,this).style.top=`${h.top}px`,Yt(va,this).style[this.inlineDir]=`${Yt(Bx,this)+Yt(Kp,this)}px`,Yt(va,this).style.height=`${n}px`,this.hot.rootElement.appendChild(Yt(va,this))}refreshHandlePosition(){Yt(va,this).style[this.inlineDir]=`${Yt(Bx,this)+Yt(yT,this)}px`}setupGuidePosition(){const e=parseInt(Ji(Yt(va,this)),10),r=parseInt(Yt(va,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ht(Yt(va,this),"active"),ht(Yt(xh,this),"active"),Yt(xh,this).style.top=`${r}px`,this.refreshGuidePosition(),Yt(xh,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(Yt(xh,this))}refreshGuidePosition(){Yt(xh,this).style[this.inlineDir]=Yt(va,this).style[this.inlineDir]}hideHandleAndGuide(){Ar(Yt(va,this),"active"),Ar(Yt(xh,this),"active")}checkIfColumnHeader(e){const r=_g(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(i,s)=>{const n=this.hot.runHooks("beforeColumnResize",Yt(Mu,this),i,!0);n!==void 0&&Yi(Mu,this,n),this.setManualSize(i,Yt(Mu,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Yt(Mu,this),i,!0),s&&e()};Yt(my,this)>=2&&(Yt(za,this).length>1?(Te(Yt(za,this),s=>{r(s)}),e()):Te(Yt(za,this),s=>{r(s,!0)})),Yi(my,this,0),Yi(py,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",i=>pc(uu,this,n8e).call(this,i)),this.eventManager.addEventListener(r,"mousedown",i=>pc(uu,this,i8e).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>pc(uu,this,s8e).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>pc(uu,this,o8e).call(this)),this.eventManager.addEventListener(Yt(va,this),"contextmenu",()=>pc(uu,this,a8e).call(this))}destroy(){super.destroy()}}function r8e(){const t=this.hot.getSettings()[wT],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,i)=>{Yt(Xa,this).setValueAtIndex(i,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,i)=>{Yt(Xa,this).setValueAtIndex(i,r)})},!0),Yi(vy,this,t)):t===!0&&Array.isArray(Yt(vy,this))&&this.hot.batchExecution(()=>{Yt(vy,this).forEach((r,i)=>{Yt(Xa,this).setValueAtIndex(i,r)})},!0)}function n8e(t){if(!YX(t.target)&&Yt(CT,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(Yt(Mg,this)||this.setupHandlePosition(e))}}function i8e(t){t.target.parentNode===this.hot.rootElement&&Ir(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Yt(Ah,this)),this.setupGuidePosition(),Yi(Mg,this,!0),Yt(py,this)===null&&(Yi(py,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Yt(py,this))),Yi(my,this,Yt(my,this)+1),this.startX=t.pageX,Yi(Mu,this,Yt(Kp,this)))}function s8e(t){if(Yt(Mg,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Yi(yT,this,Yt(Kp,this)+e),Te(Yt(za,this),r=>{Yi(Mu,this,this.setManualSize(r,Yt(yT,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function o8e(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeColumnResize",Yt(Mu,this),r,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Yt(Mu,this),r,!1)};Yt(Mg,this)&&(this.hideHandleAndGuide(),Yi(Mg,this,!1),Yt(Mu,this)!==Yt(Kp,this)&&(Yt(za,this).length>1?(Te(Yt(za,this),i=>{e(i)}),t()):Te(Yt(za,this),i=>{e(i,!0)})),this.setupHandlePosition(Yt(Ah,this)))}function a8e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Yt(va,this)),this.hot.rootElement.removeChild(Yt(xh,this)),Yi(Mg,this,!1),Yi(CT,this,!0),this.hot._registerImmediate(()=>{Yi(CT,this,!1)})}function l8e(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),s=Yt(Xa,this).getValueAtIndex(i);this.hot.getSettings()[wT]&&s&&(r=s)}return r}function c8e(t,e){const r=Yt(Xa,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function u8e(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function BI(t,e,r){return(e=h8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h8e(t){var e=f8e(t,"string");return typeof e=="symbol"?e:e+""}function f8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const VI=0,qW=1,JW=2,qm="px";let vZ=class{constructor(e){BI(this,"hot",void 0),BI(this,"_element",null),BI(this,"state",VI),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=JW}build(){this.state===VI&&(this._element=this.hot.rootDocument.createElement("div"),this.state=qW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=VI}isAppended(){return this.state===JW}isBuilt(){return this.state>=qW}setPosition(e,r){e!==void 0&&(this._element.style.top=e+qm),r!==void 0&&(this._element.style.left=r+qm)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+qm),r&&(this._element.style.height=r+qm)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+qm),r&&(this._element.style.marginLeft=r+qm)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const d8e="ht__manualRowMove--backlight";class g8e extends vZ{build(){super.build(),ht(this._element,d8e)}}const m8e="ht__manualRowMove--guideline";class p8e extends vZ{build(){super.build(),ht(this._element,m8e)}}function v8e(t,e){wZ(t,e),e.add(t)}function Jm(t,e,r){wZ(t,e),e.set(t,r)}function wZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,r){return t.set(Kf(t,e),r),r}function Hr(t,e){return t.get(Kf(t,e))}function Kf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeRowMove");qt.getSingleton().register("afterRowMove");const WI="manualRowMove",w8e=140,QW="ht__manualRowMove",ST="show-ui",kF="on-moving--rows",NF="after-selection--rows";var Zo=new WeakMap,Qf=new WeakMap,Bh=new WeakMap,cd=new WeakMap,Ea=new WeakMap,Vx=new WeakMap,L0=new WeakSet;class y8e extends On{constructor(){super(...arguments),v8e(this,L0),Jm(this,Zo,new g8e(this.hot)),Jm(this,Qf,new p8e(this.hot)),Jm(this,Bh,[]),Jm(this,cd,void 0),Jm(this,Ea,{}),Jm(this,Vx,void 0)}static get PLUGIN_KEY(){return WI}static get PLUGIN_PRIORITY(){return w8e}isEnabled(){return!!this.hot.getSettings()[WI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,C8e).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,b8e).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Kf(L0,this,E8e).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,T8e).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),ht(this.hot.rootElement,QW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ar(this.hot.rootElement,QW),this.unregisterEvents(),Hr(Zo,this).destroy(),Hr(Qf,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const i=Hr(Vx,this),s=this.isMovePossible(e,r),n=this.hot.runHooks("beforeRowMove",e,r,i,s);if(cg(Vx,this,void 0),n===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=s&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,i,s,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const i=this.countFinalIndex(e,r);return cg(Vx,this,r),this.moveRows(e,i)}isMovePossible(e,r){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+r>i,n=r<0,o=e.some(h=>h<0),l=e.some(h=>h>=i);return!(s||n||o||l)}isRowOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}countFinalIndex(e,r){const i=la(e,(s,n)=>(n<r&&(s+=1),s),0);return r-i}getRowsHeight(e,r){const i=this.hot.rowIndexMapper;let s=0;for(let n=e;n<=r;n++){const o=i.getRenderableFromVisualIndex(n);o!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[WI];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:i,to:s}=e,n=Math.min(i.row,s.row),o=Math.max(i.row,s.row);return pr(n,o,l=>{r.push(l)}),r}refreshPositions(){const e=Hr(Ea,this).coords,r=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&i<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const n=this.hot.view._wt.wtTable,o=Hr(Ea,this).TD,l=this.hot.rootElement,h=Ws(l),d=c1(l),g=n.holder.scrollTop,y=this.hot.rootWindow!==d?d.scrollTop:0,C=h.top-y,x=Hr(Ea,this).eventPageY-C+g,_=n.hider.offsetHeight,E=n.TBODY.offsetTop,R=Hr(Zo,this).getOffset().top,I=Hr(Zo,this).getSize().height,F=o.offsetHeight/2,D=o.offsetHeight;let U=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const X=x>=U+F;this.isFixedRowTop(e.row)&&(U+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Hr(Ea,this).row=r>0?r-1:r:X?(Hr(Ea,this).row=e.row+1,U+=e.row===0?D-1:D):Hr(Ea,this).row=e.row;let te=x,Y=U;x+I+R>=_?te=_-I-R:x+R<E&&(te=E+Math.abs(R)),U>=_-1&&(Y=_-1),Hr(Zo,this).setPosition(te),Hr(Qf,this).setPosition(Y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Kf(L0,this,S8e).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Kf(L0,this,x8e).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Hr(Zo,this).build(),Hr(Qf,this).build()}destroy(){Hr(Zo,this).destroy(),Hr(Qf,this).destroy(),super.destroy()}}function C8e(t,e,r,i){const{wtTable:s,wtViewport:n}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!o||Hr(cd,this)||t.button!==0){cg(cd,this,!1),Hr(Bh,this).length=0,Ar(this.hot.rootElement,[kF,ST]);return}const h=Hr(Qf,this).isBuilt()&&!Hr(Qf,this).isAppended(),d=Hr(Zo,this).isBuilt()&&!Hr(Zo,this).isAppended();h&&d&&(Hr(Qf,this).appendTo(s.hider),Hr(Zo,this).appendTo(s.hider));const{from:g,to:y}=l,C=Math.min(g.row,y.row),x=Math.max(g.row,y.row);if(e.col<0&&e.row>=C&&e.row<=x){i.row=!0,cg(cd,this,!0),Hr(Ea,this).eventPageY=t.pageY,Hr(Ea,this).coords=e,Hr(Ea,this).TD=r,cg(Bh,this,this.prepareRowsToMoving());const _=s.holder.scrollLeft+n.getRowHeaderWidth(),E=this.getRowsHeight(C,e.row-1)+t.offsetY;Hr(Zo,this).setPosition(null,_),Hr(Zo,this).setSize(s.hider.offsetWidth-_,this.getRowsHeight(C,x)),Hr(Zo,this).setOffset(-E,null),ht(this.hot.rootElement,kF),this.refreshPositions()}else Ar(this.hot.rootElement,NF),cg(cd,this,!1),Hr(Bh,this).length=0}function S8e(t){Hr(cd,this)&&(Hr(Ea,this).eventPageY=t.pageY,this.refreshPositions())}function b8e(t,e,r,i){!this.hot.getSelectedRangeLast()||!Hr(cd,this)||(Hr(Bh,this).indexOf(e.row)>-1?Ar(this.hot.rootElement,ST):ht(this.hot.rootElement,ST),i.row=!0,i.column=!0,i.cell=!0,Hr(Ea,this).coords=e,Hr(Ea,this).TD=r)}function x8e(){const t=Hr(Ea,this).row,e=Hr(Bh,this).length;if(cg(cd,this,!1),Ar(this.hot.rootElement,[kF,ST,NF]),this.hot.selection.isSelectedByRowHeader()&&ht(this.hot.rootElement,NF),e<1||t===void 0)return;const r=Hr(Bh,this)[0],i=this.hot.toPhysicalRow(r),s=this.dragRows(Hr(Bh,this),t);if(Hr(Bh,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const n=this.hot.toVisualRow(i),o=n+e-1;this.hot.selectRows(n,o)}}function E8e(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,i=e+r;Hr(Zo,this).setPosition(null,i),Hr(Zo,this).setSize(t.hider.offsetWidth-i)}function T8e(){this.moveBySettingsOrLoad()}function _8e(t,e){yZ(t,e),e.add(t)}function _o(t,e,r){yZ(t,e),e.set(t,r)}function yZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Mi(t,e,r){return t.set(Oh(t,e),r),r}function Ut(t,e){return t.get(Oh(t,e))}function Oh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bT="manualRowResize",R8e=30,ZW="manualRowHeights";var Tu=new WeakMap,Wx=new WeakMap,Ga=new WeakMap,wy=new WeakMap,Zf=new WeakMap,P6=new WeakMap,Xp=new WeakMap,jx=new WeakMap,Go=new WeakMap,yu=new WeakMap,kg=new WeakMap,xT=new WeakMap,yy=new WeakMap,Cy=new WeakMap,Sc=new WeakMap,Sy=new WeakMap,Df=new WeakSet;class A8e extends On{static get PLUGIN_KEY(){return bT}static get PLUGIN_PRIORITY(){return R8e}constructor(e){super(e),_8e(this,Df),_o(this,Tu,null),_o(this,Wx,null),_o(this,Ga,[]),_o(this,wy,null),_o(this,Zf,null),_o(this,P6,null),_o(this,Xp,null),_o(this,jx,null),_o(this,Go,this.hot.rootDocument.createElement("DIV")),_o(this,yu,this.hot.rootDocument.createElement("DIV")),_o(this,kg,!1),_o(this,xT,!1),_o(this,yy,0),_o(this,Cy,null),_o(this,Sc,void 0),_o(this,Sy,void 0),ht(Ut(Go,this),"manualRowResizer"),ht(Ut(yu,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[bT]}enablePlugin(){this.enabled||(Mi(Sc,this,new Hd),Ut(Sc,this).addLocalHook("init",()=>Oh(Df,this,N8e).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ut(Sc,this)),this.addHook("modifyRowHeight",(e,r)=>Oh(Df,this,k8e).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Mi(Sy,this,Ut(Sc,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",ZW,Ut(Sc,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",ZW,e),e.value}setManualSize(e,r){const i=this.hot.toPhysicalRow(e),s=Math.max(r,this.hot.view.getDefaultRowHeight());return Ut(Sc,this).setValueAtIndex(i,s),s}getLastDesiredRowHeight(){return Ut(wy,this)}setupHandlePosition(e){Mi(Tu,this,e);const{view:r}=this.hot,{_wt:i}=r,s=i.wtTable.getCoords(Ut(Tu,this)),n=s.row;if(n<0)return;const o=ns(Ut(Tu,this)),l=Ut(Tu,this).getBoundingClientRect(),h=n<i.getSetting("fixedRowsTop"),d=n>=r.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let g;h?g=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ut(Tu,this),s.row,s.col):d&&(g=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Ut(Tu,this),s.row,s.col)),g||(g=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Ut(Tu,this),s.row,s.col)),Mi(Wx,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(n)),Mi(Ga,this,[]);const y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){const C=this.hot.getSelectedRange();Te(C,x=>{const _=x.getTopStartCorner().row,E=x.getBottomStartCorner().row;pr(_,E,R=>{Ut(Ga,this).includes(R)||Ut(Ga,this).push(R)})})}Ut(Ga,this).includes(Ut(Wx,this))||Mi(Ga,this,[Ut(Wx,this)]),Mi(jx,this,g.top-6),Mi(Xp,this,parseInt(l.height,10)),Ut(Go,this).style.top=`${Ut(jx,this)+Ut(Xp,this)}px`,Ut(Go,this).style[this.inlineDir]=`${g.start}px`,Ut(Go,this).style.width=`${o}px`,this.hot.rootElement.appendChild(Ut(Go,this))}refreshHandlePosition(){Ut(Go,this).style.top=`${Ut(jx,this)+Ut(wy,this)}px`}setupGuidePosition(){const e=parseInt(ns(Ut(Go,this)),10),r=parseInt(Ut(Go,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ht(Ut(Go,this),"active"),ht(Ut(yu,this),"active"),Ut(yu,this).style.top=Ut(Go,this).style.top,Ut(yu,this).style[this.inlineDir]=`${r}px`,Ut(yu,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Ut(yu,this))}refreshGuidePosition(){Ut(yu,this).style.top=Ut(Go,this).style.top}hideHandleAndGuide(){Ar(Ut(Go,this),"active"),Ar(Ut(yu,this),"active")}checkIfRowHeader(e){const r=_g(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,s.clone.wtTable.TBODY,n.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&Ut(Zf,this)<r?r:Ut(Zf,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(i,s)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);n!==void 0&&Mi(Zf,this,n),this.setManualSize(i,Ut(Zf,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),s&&e()};Ut(yy,this)>=2&&(Ut(Ga,this).length>1?(Te(Ut(Ga,this),s=>{r(s)}),e()):Te(Ut(Ga,this),s=>{r(s,!0)})),Mi(yy,this,0),Mi(Cy,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Oh(Df,this,O8e).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Oh(Df,this,I8e).call(this,i)),this.eventManager.addEventListener(r,"mousemove",i=>Oh(Df,this,P8e).call(this,i)),this.eventManager.addEventListener(r,"mouseup",()=>Oh(Df,this,F8e).call(this)),this.eventManager.addEventListener(Ut(Go,this),"contextmenu",()=>Oh(Df,this,M8e).call(this))}destroy(){super.destroy()}}function O8e(t){if(!YX(t.target)&&Ut(xT,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Ut(kg,this)||this.setupHandlePosition(e))}}function I8e(t){Ir(t.target,"manualRowResizer")&&(this.setupHandlePosition(Ut(Tu,this)),this.setupGuidePosition(),Mi(kg,this,!0),Ut(Cy,this)===null&&(Mi(Cy,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ut(Cy,this))),Mi(yy,this,Ut(yy,this)+1),Mi(P6,this,t.pageY),Mi(Zf,this,Ut(Xp,this)))}function P8e(t){Ut(kg,this)&&(Mi(wy,this,Ut(Xp,this)+(t.pageY-Ut(P6,this))),Te(Ut(Ga,this),e=>{Mi(Zf,this,this.setManualSize(e,Ut(wy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function F8e(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};Ut(kg,this)&&(this.hideHandleAndGuide(),Mi(kg,this,!1),Ut(Zf,this)!==Ut(Xp,this)&&(Ut(Ga,this).length>1?(Te(Ut(Ga,this),i=>{e(i)}),t()):Te(Ut(Ga,this),i=>{e(i,!0)})),this.setupHandlePosition(Ut(Tu,this)))}function M8e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ut(Go,this)),this.hot.rootElement.removeChild(Ut(yu,this)),Mi(kg,this,!1),Mi(xT,this,!0),this.hot._registerImmediate(()=>{Mi(xT,this,!1)})}function k8e(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),s=Ut(Sc,this).getValueAtIndex(i);this.hot.getSettings()[bT]&&s&&(r=s)}return r}function N8e(){const t=this.hot.getSettings()[bT],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,i)=>{Ut(Sc,this).setValueAtIndex(i,r)}):Array.isArray(t)?(t.forEach((r,i)=>{Ut(Sc,this).setValueAtIndex(i,r)}),Mi(Sy,this,t)):t===!0&&Array.isArray(Ut(Sy,this))&&Ut(Sy,this).forEach((r,i)=>{Ut(Sc,this).setValueAtIndex(i,r)})},!0)}var D8e=$_;D8e("flatMap");var L8e=Lo,ej=Cs,H8e=Gu,$8e=gk,B8e=function(t,e){(!e||typeof t!="string")&&ej(t);var r=$8e(t);return H8e(ej(r!==void 0?L8e(r,t):t))},V8e=ni,tj=Lo,W8e=ka,DF=Cs,j8e=Gu,U8e=B8e,z8e=dk,rj=_1,G8e=JM,Y8e=z8e(function(){for(var t=this.iterator,e=this.mapper,r,i;;){if(i=this.inner)try{if(r=DF(tj(i.next,i.iterator)),!r.done)return r.value;this.inner=null}catch(s){rj(t,"throw",s)}if(r=DF(tj(this.next,t)),this.done=!!r.done)return;try{this.inner=U8e(e(r.value,this.counter++),!1)}catch(s){rj(t,"throw",s)}}});V8e({target:"Iterator",proto:!0,real:!0,forced:G8e},{flatMap:function(e){return DF(this),W8e(e),new Y8e(j8e(this),{mapper:e,inner:null})}});function K8e(t,e,r){X8e(t,e),e.set(t,r)}function X8e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function H0(t,e,r){return(e=q8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q8e(t){var e=J8e(t,"string");return typeof e=="symbol"?e:e+""}function J8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nj(t,e){return t.get(CZ(t,e))}function Ux(t,e,r){return t.set(CZ(t,e),r),r}function CZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $0=new WeakMap;class _u{constructor(e,r,i,s,n,o){H0(this,"row",void 0),H0(this,"col",void 0),H0(this,"rowspan",void 0),H0(this,"colspan",void 0),H0(this,"removed",!1),H0(this,"cellCoordsFactory",void 0),H0(this,"cellRangeFactory",void 0),K8e(this,$0,null),this.row=e,this.col=r,this.rowspan=i,this.colspan=s,this.cellCoordsFactory=n,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:i,rowspan:s,colspan:n}=e;return Ln`The merged cell declared with {row: ${r}, col: ${i},\x20
      rowspan: ${s}, colspan: ${n}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:i,rowspan:s,colspan:n}=e;return r<0||i<0||s<0||n<0}static isSingleCell(e){let{rowspan:r,colspan:i}=e;return i===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:i}=e;return i===0||r===0}static isOutOfBounds(e,r,i){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const r=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Ux($0,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const i=e[0]||e[1],s=r+Math.abs(e[0]||e[1])-1,n=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",l=Math.min(r,s),h=Math.max(r,s),d=this[o],g=this[o]+this[n]-1;if(d>=r&&(this[o]+=i),i>0)r<=g&&r>d&&(this[n]+=i);else if(i<0){if(l<=d&&h>=g)return this.removed=!0,Ux($0,this,null),!1;if(d>=l&&d<=h){const y=h-d+1,C=Math.abs(i)-y;this[o]-=C+i,this[n]-=y}else if(d<=l&&g>=h)this[n]+=i;else if(d<=l&&g>=l&&g<h){const y=g-l+1;this[n]-=y}}return Ux($0,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return nj($0,this)||Ux($0,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),nj($0,this)}}function Q8e(t,e){Z8e(t,e),e.add(t)}function Z8e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zx(t,e,r){return(e=eHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eHe(t){var e=tHe(t,"string");return typeof e=="symbol"?e:e+""}function tHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function B0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Lf=new WeakSet;class ET{constructor(e){Q8e(this,Lf),zx(this,"plugin",void 0),zx(this,"mergedCells",[]),zx(this,"mergedCellsMatrix",new Map),zx(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(r))!==null&&i!==void 0?i:!1}getByRange(e){let r=!1;return Te(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(s=>{const{row:n,col:o,colspan:l,rowspan:h}=s;for(let d=n;d<n+h;d++)for(let g=o;g<o+l;g++)r.add(`r${d},c${g}`)}),e.filter(s=>{const{row:n,col:o,colspan:l,rowspan:h}=s,d=new Set;let g=!1;for(let y=n;y<n+h;y++){for(let C=o;C<o+l;C++){const x=`r${y},c${C}`;if(r.has(x)){Nn(ET.IS_OVERLAPPING_WARNING(s)),g=!0;break}d.add(x)}if(g)break}return g||r.add(...d),!g})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:s}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),l=[];for(let h=i;h<=n;h++)for(let d=s;d<=o;d++){const g=this.get(h,d);g&&(r||!r&&g.row===h&&g.col===d)&&l.push(g)}return l}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,s=e.col,n=e.rowspan,o=e.colspan,l=new _u(i,s,n,o,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,s),d=r?!1:this.isOverlapping(l);return!h&&!d?(this.hot&&l.normalize(this.hot),this.mergedCells.push(l),B0(Lf,this,ij).call(this,l),l):(Nn(ET.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,r){const i=this.get(e,r),s=i?this.mergedCells.indexOf(i):-1;return i&&s!==-1?(this.mergedCells.splice(s,1),B0(Lf,this,rHe).call(this,i),i):!1}clear(){Te(this.mergedCells,e=>{let{row:r,col:i,rowspan:s,colspan:n}=e;pr(r,r+s,o=>{pr(i,i+n,l=>{const h=this.hot.getCell(o,l);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const i=this.get(e,r);if(!i)return!1;const{row:s,col:n,rowspan:o,colspan:l}=i,h=this.hot.view.getActiveOverlayName(),d=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),y=vn(d,s,s+o-1),C=vn(g,n,n+l-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(C,1)===r}getFirstRenderableCoords(e,r){const i=this.get(e,r);if(!i||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(s,n)}getStartMostColumnIndex(e,r){const i=B0(Lf,this,Gx).call(this,e,"col",-1);let s=r;for(let n=0;n<i.length;n++)if(i[n]<=r){s=i[n];break}return s}getEndMostColumnIndex(e,r){const i=B0(Lf,this,Gx).call(this,e,"col",1);let s=r;for(let n=0;n<i.length;n++)if(i[n]>=r){s=i[n];break}return s}getTopMostRowIndex(e,r){const i=B0(Lf,this,Gx).call(this,e,"row",-1);let s=r;for(let n=0;n<i.length;n++)if(i[n]<=r){s=i[n];break}return s}getBottomMostRowIndex(e,r){const i=B0(Lf,this,Gx).call(this,e,"row",1);let s=r;for(let n=0;n<i.length;n++)if(i[n]>=r){s=i[n];break}return s}shiftCollections(e,r,i){const s=[0,0];switch(e){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break}const n=[];this.mergedCells.forEach(o=>{o.shift(s,r),o.removed&&n.push(o)}),n.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{B0(Lf,this,ij).call(this,o)})}}function Gx(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,s=r===1?t.getTopStartCorner():t.getBottomEndCorner(),n=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=s.row;r===1?o<=n.row:o>=n.row;o+=r)for(let l=s.col;r===1?l<=n.col:l>=n.col;l+=r){const h=e==="row"?o:l,d=this.get(o,l);let g=h;d&&(g=r===1?d[e]+d[`${e}span`]-1:d[e]),i.has(h)||i.set(h,new Set),i.get(h).add(g)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,l]=o;return l.size===1}).flatMap(o=>{let[,l]=o;return Array.from(l)})))}function ij(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function rHe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function jI(t,e,r){return(e=nHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nHe(t){var e=iHe(t,"string");return typeof e=="symbol"?e:e+""}function iHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sHe{constructor(e){jI(this,"plugin",void 0),jI(this,"mergedCellsCollection",void 0),jI(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let i=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?i="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?i="up":r[1]===e[1]&&r[2]===e[2]?i="right":i="left",i}snapDragArea(e,r,i,s){const n=r.slice(0),o=this.getAutofillSize(e,r,i),[l,h,d,g]=e,C=["up","down"].indexOf(i)>-1?d-l+1:g-h+1,x=Math.floor(o/C)*C,_=o-x,E=this.getFarthestCollection(e,r,i,s);if(E){if(i==="down"){const R=E.row+E.rowspan-l-_;n[2]+R>=this.plugin.hot.countRows()?n[2]-=_:n[2]+=_?R:0}else if(i==="right"){const R=E.col+E.colspan-h-_;n[3]+R>=this.plugin.hot.countCols()?n[3]-=_:n[3]+=_?R:0}else if(i==="up"){const R=d-_-E.row+1;n[0]+R<0?n[0]+=_:n[0]-=_?R:0}else if(i==="left"){const R=g-_-E.col+1;n[1]+R<0?n[1]+=_:n[1]-=_?R:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:s,fillSize:o,dragArea:n,cycleLength:C}),n}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),vs(this.currentFillData,e)}getAutofillSize(e,r,i){const[s,n,o,l]=e,[h,d,g,y]=r;switch(i){case"up":return s-h;case"down":return g-o;case"left":return n-d;case"right":return y-l;default:return null}}getDragArea(e,r,i){const[s,n,o,l]=e,[h,d,g,y]=r;switch(i){case"up":return[h,d,s-1,l];case"down":return[o+1,n,g,l];case"left":return[h,d,o,n-1];case"right":return[s,l+1,g,y];default:return null}}getFarthestCollection(e,r,i,s){const[n,o,l,h]=e,d=["up","down"].indexOf(i)>-1,g=d?l:h,y=d?n:o,C=this.getAutofillSize(e,r,i),x=d?l-n+1:h-o+1,_=Math.floor(C/x)*x,E=C-_;let R=null,I=null,F=null;switch(i){case"up":R="includesVertically",F=g-E+1;break;case"left":R="includesHorizontally",F=g-E+1;break;case"down":R="includesVertically",F=y+E-1;break;case"right":R="includesHorizontally",F=y+E-1;break}return Te(s,D=>{D[R](F)&&D.isFarther(I,i)&&(I=D)}),I}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,n=(d,g)=>{switch(s){case"up":return d.row-g>=r.from.row;case"down":return d.row+d.rowspan-1+g<=r.to.row;case"left":return d.col-g>=r.from.column;case"right":return d.col+d.colspan-1+g<=r.to.column;default:return null}};let o=0,l=null,h=1;do for(let d=0;d<i.length;d+=1){if(l=i[d],o=h*this.currentFillData.cycleLength,n(l,o))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:l.row-o,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+o,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-o,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+o,colspan:l.colspan});break}d===i.length-1&&(h+=1)}while(n(l,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},i={min:null,max:null};return Te(e,s=>{const n=s[0],o=this.plugin.hot.propToCol(s[1]);(r.min===null||n<r.min)&&(r.min=n),(r.max===null||n>r.max)&&(r.max=n),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:r.min,column:i.min},to:{row:r.max,column:i.max}}}dragAreaOverlapsCollections(e,r,i){const s=this.getDragArea(e,r,i),[n,o,l,h]=s,d=this.plugin.hot._createCellCoords(n,o),g=this.plugin.hot._createCellCoords(l,h),y=this.plugin.hot._createCellRange(d,d,g);return this.mergedCellsCollection.getWithinRange(y,!0).length>0}}function UI(t,e,r){return(e=oHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oHe(t){var e=aHe(t,"string");return typeof e=="symbol"?e:e+""}function aHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lHe{constructor(e){UI(this,"plugin",void 0),UI(this,"hot",void 0),UI(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,i,s){const n=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const g=this.plugin.mergedCellsCollection.get(e,r);if(!g)return;const y=g.getLastRow(),C=g.getLastColumn();if(n<=g.row&&o<=g.col&&l>=y&&h>=C)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const i=[];if(!r||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let n=0;n<e.colspan;n+=1)i.push(this.hot._createCellCoords(e.row+s,e.col+n));for(let s=0;s<i.length;s+=1){const n=[];for(let o=0;o<r.length;o+=1)n[o]=r[o].includes(i[s]);if(!n.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function cHe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(WN)}return this.getTranslatedPhrase(VN)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?_u.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function by(t,e,r){return(e=uHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uHe(t){var e=hHe(t,"string");return typeof e=="symbol"?e:e+""}function hHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sj{constructor(e){by(this,"data",void 0),by(this,"next",null),by(this,"prev",null),this.data=e}}class Yx{constructor(){by(this,"first",null),by(this,"last",null)}push(e){const r=new sj(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.last;this.last=r,r.prev=i,i.next=r}return r}unshift(e){const r=new sj(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.first;this.first=r,r.next=i,i.prev=r}}inorder(e){let r=this.first;for(;r;){const i=e(r);if(r===this.last||i===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,i,s;for(;r;){if(r.data===e)return i=r.next,s=r.prev,i&&(i.prev=s),s&&(s.next=i),r===this.first&&(this.first=i),r===this.last&&(this.last=s),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,s){s&&(e(s,s.next),s.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,i;for(;e;)i=e.next,e.next=r,r.prev=e,r=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=r,this.last=i}}function fHe(t,e){SZ(t,e),e.add(t)}function V0(t,e,r){SZ(t,e),e.set(t,r)}function SZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fn(t,e){return t.get(TT(t,e))}function $a(t,e,r){return t.set(TT(t,e),r),r}function TT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hu=new WeakMap,fu=new WeakMap,du=new WeakMap,gu=new WeakMap,LF=new WeakMap,Kx=new WeakMap,Xx=new WeakMap,zI=new WeakSet;class dHe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:i,columnIndexMapper:s}=e;fHe(this,zI),V0(this,hu,new Yx),V0(this,fu,new Yx),V0(this,du,null),V0(this,gu,null),V0(this,LF,null),V0(this,Kx,null),V0(this,Xx,null),$a(LF,this,r),$a(Kx,this,i),$a(Xx,this,s)}getCurrentVerticalNode(){return Fn(gu,this).data}getFirstVerticalNode(){return Fn(fu,this).first.data}getNextVerticalNode(){return Fn(gu,this).next.data}getPrevVerticalNode(){return Fn(gu,this).prev.data}getCurrentHorizontalNode(){return Fn(du,this).data}getFirstHorizontalNode(){return Fn(hu,this).first.data}getNextHorizontalNode(){return Fn(du,this).next.data}getPrevHorizontalNode(){return Fn(du,this).prev.data}setPrevNodeAsActive(){$a(gu,this,Fn(gu,this).prev),$a(du,this,Fn(du,this).prev)}setNextNodeAsActive(){$a(gu,this,Fn(gu,this).next),$a(du,this,Fn(du,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),s=new WeakSet;$a(hu,this,new Yx);for(let o=r.row;o<=i.row;o++)if(!Fn(Kx,this).isHidden(o))for(let l=r.col;l<=i.col;l++){if(Fn(Xx,this).isHidden(l))continue;const h=TT(zI,this,oj).call(this,e,Fn(hu,this),s,o,l);h&&$a(du,this,h)}Fn(hu,this).first&&(Fn(hu,this).first.prev=Fn(hu,this).last,Fn(hu,this).last.next=Fn(hu,this).first);const n=new WeakSet;$a(fu,this,new Yx);for(let o=r.col;o<=i.col;o++)if(!Fn(Xx,this).isHidden(o))for(let l=r.row;l<=i.row;l++){if(Fn(Kx,this).isHidden(l))continue;const h=TT(zI,this,oj).call(this,e,Fn(fu,this),n,l,o);h&&$a(gu,this,h)}Fn(fu,this).first&&(Fn(fu,this).first.prev=Fn(fu,this).last,Fn(fu,this).last.next=Fn(fu,this).first)}setActiveNode(e,r){return Fn(hu,this).inorder(i=>{const{rowStart:s,rowEnd:n,colStart:o,colEnd:l}=i.data;if(e>=s&&e<=n&&r>=o&&r<=l)return $a(du,this,i),!1}),Fn(fu,this).inorder(i=>{const{rowStart:s,rowEnd:n,colStart:o,colEnd:l}=i.data;if(e>=s&&e<=n&&r>=o&&r<=l)return $a(gu,this,i),!1}),this}}function oj(t,e,r,i,s){const n=t.getTopStartCorner(),o=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),h=Fn(LF,this).call(this,i,s);if(h&&r.has(h))return null;const d={colStart:s,colEnd:s,rowStart:i,rowEnd:i};if(h){if(r.add(h),h.row<n.row||h.row+h.rowspan-1>o.row||h.col<n.col||h.col+h.colspan-1>o.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const g=e.push(d);return i===l.row&&s===l.col||h&&l.row>=h.row&&l.row<=h.row+h.rowspan-1&&l.col>=h.col&&l.col<=h.col+h.colspan-1?g:null}function gHe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:i}=e;function s(){}function n(o,l,h){const d=t.mergedCellsCollection.get(l,h);if(!Qr(d)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:g,col:y,colspan:C,rowspan:x}=d,[_,E]=t.translateMergedCellToRenderable(g,x,y,C),R=t.getSetting("virtualized"),I=r.getRenderableFromVisualIndex(l),F=i.getRenderableFromVisualIndex(h),D=_-I+1,U=E-F+1;let X=r.getNearestNotHiddenIndex(g,1),te=i.getNearestNotHiddenIndex(y,1);if(R){const me=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(me)||(X=Math.max(X,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(me)||(te=Math.max(te,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(x,D),oe=Math.min(C,U);X===l&&te===h?(o.setAttribute("rowspan",Y),o.setAttribute("colspan",oe)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:s,after:n}}function mHe(t,e){bZ(t,e),e.add(t)}function qx(t,e,r){bZ(t,e),e.set(t,r)}function bZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GI(t,e,r){return(e=pHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pHe(t){var e=vHe(t,"string");return typeof e=="symbol"?e:e+""}function vHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vC(t,e,r){return t.set(Mn(t,e),r),r}function ri(t,e){return t.get(Mn(t,e))}function Mn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}qt.getSingleton().register("beforeMergeCells");qt.getSingleton().register("afterMergeCells");qt.getSingleton().register("beforeUnmergeCells");qt.getSingleton().register("afterUnmergeCells");const HF="mergeCells",wHe=150,aj=HF;var Dl=new WeakMap,Ll=new WeakMap,ku=new WeakMap,lj=new WeakMap,Dn=new WeakSet;class yHe extends On{constructor(){super(...arguments),mHe(this,Dn),GI(this,"mergedCellsCollection",null),GI(this,"autofillCalculations",null),GI(this,"selectionCalculations",null),qx(this,Dl,null),qx(this,Ll,{row:0,col:0}),qx(this,ku,new dHe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),qx(this,lj,gHe(this))}static get PLUGIN_KEY(){return HF}static get PLUGIN_PRIORITY(){return wHe}static get DEFAULT_SETTINGS(){return{[UJ]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[HF]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new ET(this),this.autofillCalculations=new sHe(this),this.selectionCalculations=new lHe(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,CHe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,bHe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,xHe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,EHe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,THe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,uj).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,uj).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,RHe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,AHe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,OHe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,cj).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,cj).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,SHe).call(e,...i)}),this.addHook("afterRenderer",function(){return ri(lj,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,_He).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,IHe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,PHe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,FHe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,MHe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,kHe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,NHe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,DHe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,LHe).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,HHe).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,$He).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,BHe).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,VHe).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,WHe).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,jHe).call(e,...i)}),this.addHook("beforeUndoStackChange",(r,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!rq())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:s,rowspan:n}=i;for(let o=s+1;o<s+n;o++)r.push(o)}),r=[...new Set(r)],r.forEach(i=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(n=>(n==null?void 0:n.name)==="master"?n:n.clone.wtTable).forEach(n=>{const o=n.getRow(s);o&&(o.style.background=UE(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=UE(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?_u.containsNegativeValues(e)?(Nn(_u.NEGATIVE_VALUES_WARNING(e)),!1):_u.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Nn(_u.IS_OUT_OF_BOUNDS_WARNING(e)),!1):_u.isSingleCell(e)?(Nn(_u.IS_SINGLE_CELL(e)),!1):_u.containsZeroSpan(e)?(Nn(_u.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];r.forEach(s=>{const{row:n,col:o,rowspan:l,colspan:h}=s,d=this.hot._createCellCoords(n,o),g=this.hot._createCellCoords(n+l-1,o+h-1),y=this.hot._createCellRange(d,d,g);this.mergeRange(y,!0,!0);for(let C=n;C<n+l;C++)for(let x=o;x<o+h;x++)(C!==n||x!==o)&&i.push([C,x,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),n=e.getBottomEndCorner(),o={row:s.row,col:s.col,rowspan:n.row-s.row+1,colspan:n.col-s.col+1},l=[];let h=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),pr(0,o.rowspan-1,g=>{pr(0,o.colspan-1,y=>{let C=null;l[g]||(l[g]=[]),g===0&&y===0?C=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+g,o.col+y,"hidden",!0),l[g][y]=C})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(i?h=[o.row,o.col,l]:this.hot.populateFromArray(o.row,o.col,l,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),h):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),Te(i,s=>{this.mergedCellsCollection.remove(s.row,s.col),pr(0,s.rowspan-1,n=>{pr(0,s.colspan-1,o=>{this.hot.removeCellMeta(s.row+n,s.col+o,"hidden"),this.hot.removeCellMeta(s.row+n,s.col+o,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,i,s){const n=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,s);this.mergeRange(this.hot._createCellRange(n,n,o))}unmerge(e,r,i,s){const n=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,s);this.unmergeRange(this.hot._createCellRange(n,n,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:aj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aj)}modifyViewportRowStart(e,r){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.startRow);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(s,n);if(Qr(o)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.endRow);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(s,n);if(Qr(o)){const l=o.row+o.rowspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.startColumn);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(n,s);if(Qr(o)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.endColumn);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(n,s);if(Qr(o)){const l=o.col+o.colspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,i,s){const{rowIndexMapper:n,columnIndexMapper:o}=this.hot;let l,h;r===0?l=n.getNearestNotHiddenIndex(e,1):l=n.getNearestNotHiddenIndex(e+r-1,-1),s===0?h=o.getNearestNotHiddenIndex(i,1):h=o.getNearestNotHiddenIndex(i+s-1,-1);const d=e>=0?n.getRenderableFromVisualIndex(l):e,g=i>=0?o.getRenderableFromVisualIndex(h):i;return[d,g]}}function CHe(){this.generateFromSettings(),this.hot.render()}function SHe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),i=r.getTopStartCorner(),s=r.getBottomEndCorner();for(let n=0;n<e.length;n+=1)if(i.row===e[n].row&&i.col===e[n].col&&s.row===e[n].row+e[n].rowspan-1&&s.col===e[n].col+e[n].colspan-1)return!1}return t}function bHe(t){ri(Ll,this).row=t.row,ri(Ll,this).col=t.col}function xHe(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot;ri(Dl,this)&&(s.getRenderableFromVisualIndex(ri(Dl,this).row)!==null&&(r.row=ri(Dl,this).row),i.getRenderableFromVisualIndex(ri(Dl,this).col)!==null&&(r.col=ri(Dl,this).col),vC(Dl,this,null));const n=this.mergedCellsCollection.get(r.row,r.col);if(!n)return;const o=n.col,l=n.col+n.colspan-1;if(t.col<0){const g=r.col>=o&&r.col<=l?o-1:l,y=i.getNearestNotHiddenIndex(g,-1);y===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(y,r.col)-1,1)}else if(t.col>0){const g=r.col>=o&&r.col<=l?l+1:o,y=i.getNearestNotHiddenIndex(g,1);y===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,y)-1,1)}const h=n.row,d=n.row+n.rowspan-1;if(t.row<0){const g=r.row>=h&&r.row<=d?h-1:d,y=s.getNearestNotHiddenIndex(g,-1);y===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(y,r.row)-1,1)}else if(t.row>0){const g=r.row>=h&&r.row<=d?d+1:h,y=s.getNearestNotHiddenIndex(g,1);y===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,y)-1,1)}}function EHe(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:i}=e,{columnIndexMapper:s,rowIndexMapper:n}=this.hot,o=(l,h)=>{r.expand(this.hot._createCellCoords(l,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let l=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,l),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(l=r.getTopStartCorner().col);const h=s.getNearestNotHiddenIndex(l,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(t.col>0){let l=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,l),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(l=r.getBottomEndCorner().col);const h=s.getNearestNotHiddenIndex(l,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(t.row<0){let l=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(l,i.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(l=r.getTopStartCorner().row);const h=n.getNearestNotHiddenIndex(l,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(t.row>0){let l=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(l,i.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(l=r.getBottomStartCorner().row);const h=n.getNearestNotHiddenIndex(l,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function THe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){vC(Dl,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);vC(Dl,this,e.clone()),r&&e.assign(r)}function cj(t,e,r,i){if(t<0||e<0)return;const s=this.mergedCellsCollection.get(t,e);if(!s)return;const{row:n,col:o,colspan:l,rowspan:h}=s,d=n,g=o,y=n+h-1,C=o+l-1;if(i==="render"&&this.getSetting("virtualized")){const x=this.hot.view.getActiveOverlayName(),_=["top","top_inline_start_corner"].includes(x)?0:this.hot.getFirstRenderedVisibleRow(),E=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(x)?0:this.hot.getFirstRenderedVisibleColumn();return[vn(_,d,y),vn(E,g,C),vn(this.hot.getLastRenderedVisibleRow(),d,y),vn(this.hot.getLastRenderedVisibleColumn(),g,C)]}return[d,g,y,C]}function _He(t){t.items.push({name:"---------"},cHe(this))}function uj(){vC(Dl,this,null)}function RHe(){if(ri(Dl,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),i=ri(Dl,this).clone().normalize();ri(ku,this).setActiveNode(i.row,i.col),ri(Ll,this).row>0||ri(Ll,this).col>0?ri(ku,this).setPrevNodeAsActive():(r==="E-W"&&ri(Ll,this).col<0||e==="S-N"&&ri(Ll,this).row<0)&&ri(ku,this).setNextNodeAsActive()}function AHe(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:s}=this.hot;let n=null,o=null;if(ri(Ll,this).col<0){const{rowEnd:l,colEnd:h}=ri(ku,this).getPrevHorizontalNode();o=i.getNearestNotHiddenIndex(h,-1),n=s.getNearestNotHiddenIndex(l,-1)}else if(ri(Ll,this).col>0){const{rowStart:l,colStart:h}=ri(ku,this).getNextHorizontalNode();o=i.getNearestNotHiddenIndex(h,1),n=s.getNearestNotHiddenIndex(l,1)}else if(ri(Ll,this).row<0){const{rowEnd:l,colEnd:h}=ri(ku,this).getPrevVerticalNode();o=i.getNearestNotHiddenIndex(h,-1),n=s.getNearestNotHiddenIndex(l,-1)}else if(ri(Ll,this).row>0){const{rowStart:l,colStart:h}=ri(ku,this).getNextVerticalNode();o=i.getNearestNotHiddenIndex(h,1),n=s.getNearestNotHiddenIndex(l,1)}if(n!==null||o!==null){const l=this.hot._createCellCoords(n,o),h=this.mergedCellsCollection.get(l.row,l.col),d=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,h?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):r.highlight.assign(l),d.clear(),d.add(l).commit()}ri(ku,this).setActiveNode(t,e),vC(Ll,this,{row:0,col:0})}function OHe(){this.hot.getSelectedRangeLast().isHeader()||ri(ku,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function IHe(t,e,r){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?r.copyable=!1:(r.rowspan=i.rowspan,r.colspan=i.colspan))}function PHe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function FHe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function MHe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const r=this.autofillCalculations.getDirection(e,t);let i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,r))return i=e,i;const s=this.hot._createCellCoords(e[0],e[1]),n=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(s,s,n),l=this.mergedCellsCollection.getWithinRange(o);return l.length===0||(i=this.autofillCalculations.snapDragArea(e,i,r,l)),i}function kHe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function NHe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function DHe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function LHe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function HHe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function $He(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(r);Te(i,s=>{r.getBottomEndCorner().row===s.getLastRow()&&r.getBottomEndCorner().col===s.getLastColumn()&&(t[2]=s.row,t[3]=s.col)})}}function BHe(t,e,r,i){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,i)}function VHe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function WHe(t,e,r,i){if(!(i instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getByRange(s);if(!n)return;const o=this.hot._createCellCoords(n.row,n.col),l=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(o,o,l))}function jHe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let i,s;if(r==="master")i=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const C=this.hot.view.getOverlayByName(r);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),l=this.hot._createCellCoords(e,s),h=this.hot._createCellRange(o,o,l),d=this.mergedCellsCollection.getWithinRange(h,!0),g=d.reduce((C,x)=>{let{rowspan:_}=x;return Math.max(C,_)},1);let y=0;return d.length>1&&d[0].rowspan<g&&(y=g-d[0].rowspan),d.forEach(C=>{var x;let{rowspan:_}=C,E=0;r==="top"||r==="top_inline_start_corner"?E=Math.min(g,this.hot.view.countNotHiddenFixedRowsTop()-e):E=_-y,t=Math.max((x=t)!==null&&x!==void 0?x:0,Mn(Dn,this,UHe).call(this,e,E))}),t}function UHe(t,e){const r=this.hot.view.getDefaultRowHeight(),i=this.hot.getPlugin("autoRowSize");let s=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var n;s+=(n=i==null?void 0:i.getRowHeight(o))!==null&&n!==void 0?n:r}return s}function zHe(t,e){return function(r,i){const[,...s]=r,[,...n]=i;return function o(l){const h=t[l],d=e[l],g=s[l],y=n[l],C=d.multiColumnSorting,_=(C.compareFunctionFactory?C.compareFunctionFactory:QJ(d.type))(h,d,C)(g,y);if(_===$u){const E=l+1;if(typeof e[E]<"u")return o(E)}return _}(0)}}function hj(){Nn(Ln`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const xZ="sort";function GHe(t,e,r){const i=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${xZ}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function YHe(t){const e=t.className.split(" "),r=new RegExp(`^${xZ}-[0-9]{1,2}$`);return e.filter(i=>r.test(i))}function KHe(t,e,r){return(e=XHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XHe(t){var e=qHe(t,"string");return typeof e=="symbol"?e:e+""}function qHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _T="multiColumnSorting",JHe=170,YI="columnSorting",fj=_T;JJ(_T,zHe);class QHe extends aQ{constructor(){super(...arguments),KHe(this,"pluginKey",_T)}static get PLUGIN_KEY(){return _T}static get PLUGIN_PRIORITY(){return JHe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[YI]&&(hj(),this.hot.getPlugin(YI).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,aT)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:$d,position:"before",group:fj})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fj)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];super.updateHeaderClasses(e,...i),Ar(e,YHe(e)),this.enabled!==!1&&ht(e,GHe(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[YI]&&hj(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){v6(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,aT))):this.sort(this.getColumnNextConfig(r.col)))}}function dj(t,e,r){return(e=ZHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZHe(t){var e=e7e(t,"string");return typeof e=="symbol"?e:e+""}function e7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t7e="multipleSelectionHandles",r7e=160;class n7e extends On{constructor(){super(...arguments),dj(this,"dragged",[]),dj(this,"lastSetCell",null)}static get PLUGIN_KEY(){return t7e}static get PLUGIN_PRIORITY(){return r7e}isEnabled(){return sd()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function i(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(s);if(n===-1)return!1;n===0?e.dragged=e.dragged.slice(0,1):n===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",s=>{let n;if(Ir(s.target,"topSelectionHandle-HitArea"))return n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},s.preventDefault(),!1;if(Ir(s.target,"bottomSelectionHandle-HitArea"))return n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",s=>{if(Ir(s.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(Ir(s.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",s=>{const{rootDocument:n}=this.hot;let o,l,h,d,g,y;if(e.dragged.length===0)return;const C=n.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!C||C===e.lastSetCell||((C.nodeName==="TD"||C.nodeName==="TH")&&(o=e.hot.getCoords(C),o.col===-1&&(o.col=0),l=e.hot.getSelectedRangeLast(),h=l.getWidth(),d=l.getHeight(),g=l.getDirection(),h===1&&d===1&&e.hot.selection.setRangeEnd(o),y=e.getCurrentRangeCoords(l,o,e.touchStartRange.direction,g,e.dragged[0]),y.start!==null&&e.hot.selection.setRangeStart(y.start),e.hot.selection.setRangeEnd(y.end),e.lastSetCell=C),s.preventDefault())})}getCurrentRangeCoords(e,r,i,s,n){const o=e.getTopStartCorner(),l=e.getBottomEndCorner(),h=e.getBottomStartCorner(),d=e.getTopEndCorner();let g={start:null,end:null};switch(i){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":n==="top"?g={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(h.row,r.col)}:g={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":n==="bottom"&&(g={start:this.hot._createCellCoords(l.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(s){case"NE-SW":n==="top"?g={start:r,end:h}:g.end=r;break;case"NW-SE":n==="top"?g={start:r,end:l}:g.end=r;break;case"SE-NW":n==="top"?g={start:r,end:o}:g.end=r;break;case"SW-NE":n==="top"?g={start:r,end:d}:g.end=r;break}break;case"SW-NE":switch(s){case"NW-SE":n==="bottom"?g={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(h.row,r.col)}:g={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,l.col)};break;case"SW-NE":n==="top"?g={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,l.col)}:g={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":n==="bottom"?g={start:this.hot._createCellCoords(r.row,d.col),end:this.hot._createCellCoords(o.row,r.col)}:n==="top"&&(g={start:h,end:r});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":n==="top"&&(g.end=r);break;case"SE-NW":n==="top"?g.end=r:g={start:r,end:o};break}break}return g}isDragged(){return this.dragged.length>0}}function $F(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:i=!1,crossHiddenColumns:s=[],isCollapsed:n=!1,isHidden:o=!1,isRoot:l=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:i,isCollapsed:n,crossHiddenColumns:s,isHidden:o,isRoot:l,isPlaceholder:h,headerClassNames:d}}function EZ(){return{label:"",isPlaceholder:!0}}function i7e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;Te(t,s=>{const n=[];let o=0;r.push(n),Te(s,l=>{const h=$F();if(Qr(l)){const{label:g,colspan:y,headerClassName:C}=l;h.label=is(g),typeof y=="number"&&y>1&&(h.colspan=y,h.origColspan=y),typeof C=="string"&&(h.headerClassNames=[...C.split(" ")])}else h.label=is(l);o+=h.origColspan;let d=!1;if(o>=e&&(h.colspan=h.origColspan-(o-e),h.origColspan=h.colspan,d=!0),n.push(h),h.colspan>1)for(let g=0;g<h.colspan-1;g++)n.push(EZ());return!d})});const i=Math.max(...on(r,s=>s.length));return Te(r,s=>{if(s.length<i){const n=on(new Array(i-s.length),()=>$F());s.splice(s.length,0,...n)}}),r}function KI(t,e,r){s7e(t,e),e.set(t,r)}function s7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oc(t,e){return t.get(TZ(t,e))}function xw(t,e,r){return t.set(TZ(t,e),r),r}function TZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gj=["label","collapsible"];var wh=new WeakMap,W0=new WeakMap,XI=new WeakMap;class o7e{constructor(){KI(this,wh,[]),KI(this,W0,0),KI(this,XI,1/0)}setColumnsLimit(e){xw(XI,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];xw(wh,this,i7e(e,oc(XI,this))),xw(W0,this,oc(wh,this).length)}getData(){return oc(wh,this)}mergeWith(e){Te(e,r=>{let{row:i,col:s,...n}=r;const o=this.getHeaderSettings(i,s);o!==null&&vs(o,n,gj)})}map(e){Te(oc(wh,this),r=>{Te(r,i=>{const s=e({...i});Qr(s)&&vs(i,s,gj)})})}getHeaderSettings(e,r){var i;if(e>=oc(W0,this)||e<0)return null;const s=oc(wh,this)[e];return Array.isArray(s)===!1||r>=s.length?null:(i=s[r])!==null&&i!==void 0?i:null}getHeadersSettings(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=oc(W0,this)||e<0)return s;const n=oc(wh,this)[e];let o=0;for(let l=r;l<n.length;l++){const h=n[l];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=h.colspan,s.push(h),h.colspan>1&&(l+=h.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return oc(W0,this)}getColumnsCount(){return oc(W0,this)>0?oc(wh,this)[0].length:0}clear(){xw(wh,this,[]),xw(W0,this,0)}}function qI(t,e,r){return(e=a7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a7e(t){var e=l7e(t,"string");return typeof e=="symbol"?e:e+""}function l7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _Z="DF-pre-order";function RZ(t,e){let r=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(r===!1)return!1;r=RZ.call(this.childs[i],t,e)}return r}const c7e="DF-post-order";function AZ(t,e){for(let r=0;r<this.childs.length;r++)if(AZ.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const OZ="BF";function u7e(t,e){const r=[this];function i(){if(r.length===0)return;const s=r.shift();r.push(...s.childs),t.call(e,s)!==!1&&i()}i()}const h7e=OZ,mj=new Map([[_Z,RZ],[c7e,AZ],[OZ,u7e]]);class RT{constructor(e){qI(this,"data",{}),qI(this,"parent",null),qI(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new RT({...e.data});for(let i=0;i<e.childs.length;i++)r.addChild(this.cloneTree(e.childs[i]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h7e;if(!mj.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);mj.get(r).call(this,e,this)}walkUp(e){const r=this,i=s=>{e.call(r,s)!==!1&&s.parent!==null&&i(s.parent)};i(this)}}function JI(t,e,r){f7e(t,e),e.set(t,r)}function f7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zo(t,e){return t.get(IZ(t,e))}function d7e(t,e,r){return t.set(IZ(t,e),r),r}function IZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qm=new WeakMap,j0=new WeakMap,Zm=new WeakMap;class g7e{constructor(e){JI(this,Qm,new Map),JI(this,j0,new Map),JI(this,Zm,null),d7e(Zm,this,e)}getRoots(){return Array.from(zo(Qm,this).values())}getRootByColumn(e){let r;return zo(j0,this).has(e)&&(r=zo(Qm,this).get(zo(j0,this).get(e))),r}getNode(e,r){const i=this.getRootByColumn(r);if(!i)return;const s=r-zo(j0,this).get(r);let n=0,o;return i.walkDown(l=>{const{data:{origColspan:h,headerLevel:d}}=l;if(e===d){if(s>=n&&s<=n+h-1)return o=l,o.data.isRoot=r===o.data.columnIndex,!1;n+=h}}),o}rebuildTreeIndex(){let e=0;zo(j0,this).clear(),Te(zo(Qm,this),r=>{let[,{data:{colspan:i}}]=r;for(let s=e;s<e+i;s++)zo(j0,this).set(s,e);e+=i})}buildTree(){this.clear();const e=zo(Zm,this).getColumnsCount();let r=0;for(;r<e;){const i=zo(Zm,this).getHeaderSettings(0,r),s=new RT;zo(Qm,this).set(r,s),this.buildLeaves(s,r,0,i.origColspan),r+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const n=zo(Zm,this).getHeadersSettings(i,r,s);i+=1,Te(n,o=>{const l={...o,headerLevel:i-1,columnIndex:r};let h;i===1?(e.data=l,h=e):(h=new RT(l),e.addChild(h)),i<zo(Zm,this).getLayersCount()&&this.buildLeaves(h,r,i,o.origColspan),r+=o.origColspan})}clear(){zo(Qm,this).clear(),zo(j0,this).clear()}}function PZ(t,e){t.walkDown(r=>{let{data:i,childs:s}=r;if(!i.isHidden&&(e(i.columnIndex),s.length===0))for(let n=1;n<i.colspan;n++)e(i.columnIndex+n)})}function AT(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function OT(t){return AT(t,"origColspan")===t.data.origColspan}function F6(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(OT(t))return F6(r[0]);e.isCollapsed=!1;const s=r.slice(1),n=new Set;let o=0;if(s.length>0)Te(s,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const h=l.data;o+=h.colspan,PZ(l,d=>{n.add(d)})});else{const{colspan:l,origColspan:h,columnIndex:d}=e;o=h-l;for(let g=1;g<h;g++)n.add(d+g)}return t.walkUp(l=>{const{data:h}=l;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):OT(l)&&(h.isCollapsed=AT(l,"isCollapsed"))}),{rollbackModification:()=>M6(t),affectedColumns:Array.from(n),colspanCompensation:o}}function M6(t){var e;const{data:r,childs:i}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(OT(t))return M6(i[0]);r.isCollapsed=!0;const n=i.slice(1),o=new Set;if(n.length>0)Te(n,h=>{PZ(h,d=>{o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:g}=d;g.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=r;for(let g=1;g<h;g++){const y=d+g;o.add(y)}}const l=r.colspan-((e=AT(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:d}=h;d.colspan-=l,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):OT(h)&&(d.isCollapsed=AT(h,"isCollapsed"))}),{rollbackModification:()=>F6(t),affectedColumns:Array.from(o),colspanCompensation:l}}function m7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ln`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let i=!1;t.walkUp(s=>{const{data:{collapsible:n}}=s;if(n)return i=!0,!1}),!i&&t.walkUp(s=>{const{data:n}=s;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0})}function p7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ln`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let i=!1;t.walkUp(s=>{const{data:{collapsible:n}}=s;if(n)return i=!0,!1}),!i&&t.walkUp(s=>{const{data:n}=s;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1})}const pj=new Map([["collapse",M6],["expand",F6],["hide-column",m7e],["show-column",p7e]]);function v7e(t,e,r){if(!pj.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return pj.get(t)(e,r)}function Jx(t){const e=[];return Te(t,r=>{r.walkDown(i=>{const s=i.data,{origColspan:n,columnIndex:o,headerLevel:l,crossHiddenColumns:h}=s,d=y7e(e,l);let g=!1;for(let y=o;y<o+n;y++)if(h.includes(y)||g)d.push(EZ());else{const x=w7e(s);x.isRoot=!0,d.push(x),g=!0}})}),e}function w7e(t){const{crossHiddenColumns:e,...r}=$F(t);return r}function y7e(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function QI(t,e,r){C7e(t,e),e.set(t,r)}function C7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ew(t,e,r){return t.set(FZ(t,e),r),r}function Ii(t,e){return t.get(FZ(t,e))}function FZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var mu=new WeakMap,pa=new WeakMap,U0=new WeakMap;class S7e{constructor(){QI(this,mu,new o7e),QI(this,pa,new g7e(Ii(mu,this))),QI(this,U0,[[]])}setState(e){Ii(mu,this).setData(e);let r=!1;try{Ii(pa,this).buildTree()}catch{Ii(pa,this).clear(),Ii(mu,this).clear(),r=!0}return Ew(U0,this,Jx(Ii(pa,this).getRoots())),r}setColumnsLimit(e){Ii(mu,this).setColumnsLimit(e)}mergeStateWith(e){const r=on(e,i=>{let{row:s,...n}=i;return{row:s<0?this.rowCoordsToLevel(s):s,...n}});Ii(mu,this).mergeWith(r),Ii(pa,this).buildTree(),Ew(U0,this,Jx(Ii(pa,this).getRoots()))}mapState(e){Ii(mu,this).map(e),Ii(pa,this).buildTree(),Ew(U0,this,Jx(Ii(pa,this).getRoots()))}mapNodes(e){return la(Ii(pa,this).getRoots(),(r,i)=>(i.walkDown(s=>{const n=e(s.data);n!==void 0&&r.push(n)}),r),[])}triggerNodeModification(e,r,i){r<0&&(r=this.rowCoordsToLevel(r));const s=Ii(pa,this).getNode(r,i);let n;return s&&(n=v7e(e,s,i),Ew(U0,this,Jx(Ii(pa,this).getRoots()))),n}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var i,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(s=Ii(U0,this)[e])===null||s===void 0?void 0:s[r])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,r){const i=this.getHeaderTreeNode(e,r);return i?{...i.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Ii(pa,this).getNode(e,r);return i||null}findTopMostEntireHeaderLevel(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const s=i-e+1;let n=!1,o=null;for(let l=e;l<=i;l++){const h=Ii(pa,this).getRootByColumn(l);if(!h)break;n=!0,h.walkDown(d=>{const{columnIndex:g,headerLevel:y,origColspan:C,isHidden:x}=d.data;x||C<=s&&g>=e&&g+C-1<=i&&(o===null||y<o)&&(o=y)},_Z)}return n&&o===null?-1:this.levelToRowCoords((r=o)!==null&&r!==void 0?r:0)}findLeftMostColumnIndex(e,r){var i;const{isRoot:s}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0};if(s)return r;let n=r-1;for(;n>=0;){var o;const{isRoot:l}=(o=this.getHeaderSettings(e,n))!==null&&o!==void 0?o:{isRoot:!0};if(l)break;n-=1}return n}findRightMostColumnIndex(e,r){var i;const{isRoot:s,origColspan:n}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(s)return r+n-1;let o=r+1;for(;o<this.getColumnsCount();){var l;const{isRoot:h}=(l=this.getHeaderSettings(e,o))!==null&&l!==void 0?l:{isRoot:!0};if(h)break;o+=1}return o-1}getLayersCount(){return Ii(mu,this).getLayersCount()}getColumnsCount(){return Ii(mu,this).getColumnsCount()}clear(){Ew(U0,this,[]),Ii(mu,this).clear(),Ii(pa,this).clear()}}function Tw(t,e,r){return(e=b7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b7e(t){var e=x7e(t,"string");return typeof e=="symbol"?e:e+""}function x7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E7e{constructor(e,r){Tw(this,"hot",void 0),Tw(this,"nestedHeaderSettingsGetter",void 0),Tw(this,"layersCount",0),Tw(this,"container",void 0),Tw(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let i=0;i<r;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),n=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(n,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:i}=this.hot,s=r.createDocumentFragment(),n=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,l=i.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const d=r.createElement("tr");for(let g=0;g<l;g++){let y=i.getVisualFromRenderableIndex(g);y===null&&(y=g);const C=r.createElement("th"),x=this.nestedHeaderSettingsGetter(h,y);if(x&&(!x.isPlaceholder||x.isHidden)){let _=x.label;o&&(_+='<button class="changeType"></button>'),M1(C,_),C.colSpan=x.colspan,d.appendChild(C)}}n.appendChild(d)}s.appendChild(n),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function T7e(t,e){MZ(t,e),e.add(t)}function vj(t,e,r){return(e=_7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _7e(t){var e=R7e(t,"string");return typeof e=="symbol"?e:e+""}function R7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _w(t,e,r){MZ(t,e),e.set(t,r)}function MZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vh(t,e,r){return t.set(Pi(t,e),r),r}function dn(t,e){return t.get(Pi(t,e))}function Pi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wj="nestedHeaders",A7e=280;var Un=new WeakMap,Hf=new WeakMap,xy=new WeakMap,fR=new WeakMap,IT=new WeakMap,ji=new WeakSet;class O7e extends On{constructor(){super(...arguments),T7e(this,ji),_w(this,Un,new S7e),_w(this,Hf,null),_w(this,xy,null),_w(this,fR,!1),_w(this,IT,null),vj(this,"ghostTable",new E7e(this.hot,(e,r)=>this.getHeaderSettings(e,r))),vj(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return wj}static get PLUGIN_PRIORITY(){return A7e}isEnabled(){return!!this.hot.getSettings()[wj]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&Nn(Ln`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Pi(ji,this,z7e).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,G7e).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,M7e).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,k7e).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,N7e).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,D7e).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,L7e).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,H7e).call(e,...s)}),this.addHook("afterSelection",()=>Pi(ji,this,Qx).call(this)),this.addHook("afterSelectionFocusSet",()=>Pi(ji,this,Qx).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,I7e).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",i=>Pi(ji,this,B7e).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,W7e).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,j7e).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,P7e).call(e,...s)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,F7e).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,$7e).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,V7e).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pi(ji,e,U7e).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Pi(ji,this,Qx).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Pi(ji,this,Qx).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();dn(Un,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=dn(Un,this).setState(e)),this.detectedOverlappedHeaders&&Nn(Ln`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,i)=>{const s=r===!0?"hide-column":"show-column";dn(Un,this).triggerColumnModification(s,i)}),!dn(Hf,this)&&this.enabled&&Vh(Hf,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(i=>{let{op:s,index:n,newValue:o}=i;if(s==="replace"){const l=o===!0?"hide-column":"show-column";dn(Un,this).triggerColumnModification(l,n)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),dn(Un,this).clear(),dn(Hf,this).unsubscribe(),Vh(Hf,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return dn(Un,this)}getLayersCount(){return dn(Un,this).getLayersCount()}getHeaderSettings(e,r){return dn(Un,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,n=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const l=i.childNodes[o];if(!l)break;const h=s.childNodes[o],d=n?n.childNodes[o]:null;for(let g=0,y=l.childNodes.length;g<y;g++)l.childNodes[g].removeAttribute("colspan"),Ar(l.childNodes[g],"hiddenHeader"),h&&h.childNodes[g]&&(h.childNodes[g].removeAttribute("colspan"),Ar(h.childNodes[g],"hiddenHeader")),n&&d&&d.childNodes[g]&&(d.childNodes[g].removeAttribute("colspan"),Ar(d.childNodes[g],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,n)=>{var o;const{columnIndexMapper:l,view:h}=this.hot;let d=l.getVisualFromRenderableIndex(s);d===null&&(d=s),n.removeAttribute("colspan"),Ar(n,"hiddenHeader");const{colspan:g,isHidden:y,isPlaceholder:C,headerClassNames:x}=(o=dn(Un,this).getHeaderSettings(e,d))!==null&&o!==void 0?o:{label:""};if(C||y)ht(n,"hiddenHeader");else if(g>1){var _,E;const{wtOverlays:R}=h._wt,I=(_=R.topInlineStartCornerOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(n),F=(E=R.inlineStartOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(n),D=I||F?Math.min(g,i-s):g;D>1&&n.setAttribute("colspan",D)}if(this.hot.view.appendColHeader(d,n,function(){return r.getColumnHeaderValue(...arguments)},e),!C&&!y){const R=n.querySelector("div.relative");R&&x&&x.length>0&&(Ar(R,this.hot.getColumnMeta(d).headerClassName),ht(R,x))}}}getColumnHeaderValue(e,r){var i;const{isHidden:s,isPlaceholder:n}=(i=dn(Un,this).getHeaderSettings(r,e))!==null&&i!==void 0?i:{};return n||s?"":this.hot.getColHeader(e,r)}destroy(){Vh(Un,this,null),dn(Hf,this)!==null&&(dn(Hf,this).unsubscribe(),Vh(Hf,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return dn(Un,this).getHeaderTreeNodeData(e.row,e.col)}}function Qx(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const s=dn(Un,this).findLeftMostColumnIndex(r.row,r.col),n=this.hot.selection.highlight.getFocus();n.visualCellRange.highlight.col=s,n.visualCellRange.from.col=s,n.visualCellRange.to.col=s,n.commit()}}function I7e(t,e){var r;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:s}=i,{navigableHeaders:n}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),l=n?s.row:(r=dn(IT,this))===null||r===void 0?void 0:r.row,h=o?t:s.col,d=l<0&&h>=0;if(Vh(IT,this,null),!d)return t;const g=this.hot.getFirstFullyVisibleColumn(),y=this.hot.getLastFullyVisibleColumn(),C=y-g+1,x=dn(Un,this).findLeftMostColumnIndex(l,h),_=dn(Un,this).findRightMostColumnIndex(l,h),E=_-x+1;if(x<g&&_>y)return x;if(o){let R=null;return x>=g&&_>y?E>C?(e.value="start",R=x):(e.value="end",R=_):x<g&&_<=y&&(E>C?(e.value="end",R=_):(e.value="start",R=x)),R}return x<=g?x:_}function P7e(t,e,r){const i=dn(Un,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:s,selectionType:n,selectionWidth:o}=r,{isRoot:l,colspan:h}=dn(Un,this).getHeaderSettings(e,t);if(n===aN){if(!l)return i.columnIndex}else if(n===Iq&&(h>o-s||!l))return null;return t}function F7e(t,e,r){let{columnHeadersCount:i}=r;if(i!==0)for(let n=0;n<e.length;n++){const{startRow:o,startCol:l,endRow:h,endCol:d}=e[n],g=h-o+1,y=l-d+1;if(o>=0||y===1)break;for(let C=l;C<=d;C++)for(let x=o;x<=h;x++){var s;const _=g+x,E=C-l;if(E===0)continue;((s=dn(Un,this).getHeaderTreeNodeData(x,C))===null||s===void 0?void 0:s.isRoot)===!1&&(t[_][E]="")}}}function M7e(t,e,r,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function k7e(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;Vh(xy,this,e.clone()),Vh(fR,this,!0);const{selection:i}=this.hot,s=i.isSelected()?i.getSelectedRange().current():null,n=[],{columnIndex:o,origColspan:l}=r,h=!i.inInSelection(e);t.shiftKey&&s?e.col<s.from.col?n.push(s.getTopEndCorner().col,o,e.row):e.col>s.from.col?n.push(s.getTopStartCorner().col,o+l-1,e.row):n.push(o,o+l-1,e.row):(Kk(t)||Ag(t)&&h||lbe(t))&&n.push(o,o+l-1,e.row),i.selectColumns(...n)}function N7e(t,e,r,i){if(!this.hot.view.isMouseDown()||i.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:n,origColspan:o}=s,l=this.hot.getSelectedRangeLast(),h=l.getTopStartCorner(),d=l.getBottomEndCorner(),{from:g}=l;i.column=!0,i.cell=!0;const y=[],C=vn(e.row,-1/0,-1);e.col<g.col?y.push(d.col,n,C):e.col>g.col?y.push(h.col,n+o-1,C):y.push(n,n+o-1,C),this.hot.selection.selectColumns(...y)}function D7e(){Vh(fR,this,!1)}function L7e(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!dn(fR,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:s,origColspan:n}=dn(Un,this).getHeaderTreeNodeData(dn(xy,this).row,dn(xy,this).col);if(e.setHighlight(dn(xy,this)),n>e.getWidth()||s<r||s+n-1>i){const o=dn(Un,this).findTopMostEntireHeaderLevel(vn(r,s,s+n-1),vn(i,s,s+n-1));e.highlight.row=o,e.highlight.col=e.from.col}}function H7e(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const s=dn(Un,this).findLeftMostColumnIndex(r.row,r.col),n=dn(Un,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=s&&e.col<=n?s-1:n,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);l===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,e.col)-1,1)}else if(t.col>0){const o=e.col>=s&&e.col<=n?n+1:s,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);l===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,l)-1,1)}}function $7e(t,e,r){const i=t.row,s=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),n=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});Vh(IT,this,r.clone()),e.col<t.col?(s&&(t.col=s.columnIndex+s.origColspan-1),n&&(e.col=n.columnIndex)):e.col>=t.col&&(s&&(t.col=s.columnIndex),n&&(e.col=n.columnIndex+n.origColspan-1))}function B7e(t){t.length=0;for(let e=0;e<dn(Un,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function V7e(t){const e=dn(Un,this).getLayersCount();let r=t.startColumn,i=!!e;for(let s=0;s<e;s++){const n=dn(Un,this).findLeftMostColumnIndex(s,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(n);if(n>=0&&(i=!1),ea(o)&&o<t.startColumn){r=o;break}}t.startColumn=i?dn(Un,this).getHeaderTreeNodeData(0,r).columnIndex:r}function W7e(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function j7e(t,e,r){var i;const{label:s}=(i=dn(Un,this).getHeaderTreeNodeData(r,e))!==null&&i!==void 0?i:{label:""};return s}function U7e(t,e){if(t<0)return this.hot.getCell(t,dn(Un,this).findLeftMostColumnIndex(t,e),!0)}function z7e(){this.updatePlugin()}function G7e(t,e){e||this.updatePlugin()}function Rw(t,e,r){return(e=Y7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y7e(t){var e=K7e(t,"string");return typeof e=="symbol"?e:e+""}function K7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X7e{constructor(e,r){Rw(this,"hot",void 0),Rw(this,"data",null),Rw(this,"plugin",void 0),Rw(this,"parentReference",new WeakMap),Rw(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pr(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,i){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&Te(e.__children,s=>{this.cacheNode(s,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,i,s){let n=!1,o=r;if(isNaN(o)&&o.end)return o;let l=e;return l||(l={__children:this.data},n=!0,o-=1),i!=null&&o===i?{result:l,end:!0}:s!=null&&l===s?{result:o,end:!0}:(o+=1,l.__children&&Te(l.__children,h=>{if(this.parentReference.set(h,n?null:l),o=this.readTreeNodes(h,o,i,s),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Zr(this.data[0],(r,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(r):i.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(Te(i.__children,s=>{r+=1,s.__children&&(r+=this.countChildren(s))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var i;return((i=e.__children)===null||i===void 0?void 0:i[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((r=i.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let i=r;this.hot.runHooks("beforeAddChild",e,i);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let n=e;e||(n=this.mockParent()),n.__children||(n.__children=[]),i||(i=this.mockNode()),n.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,r,i){let s=i,n;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,r),e){const l=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(r,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),n=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[r]);s=this.getDataObject(n),this.hot.runHooks("afterAddChild",e,s,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),s=this.getRowParent(i),n=this.getRowIndexWithinParent(i);switch(r){case"below":this.addChildAtIndex(s,n+1,null);break;case"above":this.addChildAtIndex(s,n,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const s=[];Array.isArray(e)?(pr(e[0],e[2],C=>{const x=this.translateTrimmedRow(C);s.push(this.getDataObject(x))}),pr(0,s.length-2,C=>{this.detachFromParent(s[C],!1)}),i=s[s.length-1]):i=e;const n=this.getRowIndex(i),o=this.countChildren(i),l=this.getRowIndexWithinParent(i),h=this.getRowParent(i),d=this.getRowParent(h),g=this.getRowIndex(d);let y=null;if(this.hot.runHooks("beforeDetachChild",h,i),l!=null){const C=Array.from(new Array(n+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",n,o+1,C,this.plugin.pluginName),h.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",n,o+1,C,this.plugin.pluginName),d){y=g+this.countChildren(d);const x=this.getChild(d,this.countChildren(d)-1),_=this.getRowIndex(x);this.hot.runHooks("beforeCreateRow",_+1,o+1,this.plugin.pluginName),d.__children.push(i)}else y=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",y-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",y-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,i,this.getRowIndex(i)),r&&this.hot.render()}filterData(e,r,i){const s=[];Te(i,n=>{s.push(this.getDataObject(n))}),Te(s,n=>{const o=this.getRowIndexWithinParent(n),l=this.getRowParent(n);l===null?this.data.splice(o,1):l.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,i){const s=this.getDataObject(e-1);let n=null,o=e;s&&s.__children&&s.__children.length===0?(n=s,o=0):e<this.countAllRows()&&(n=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),n?i?n.__children.splice(o,r,...i):n.__children.splice(o,r):i?this.data.splice(o,r,...i):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,i=null;do i=this.getRowParent(i),i!==null&&(r=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,i,s){const n=r===this.hot.countRows(),o=this.getRowParent(e),l=this.getRowIndexWithinParent(e),h=o.__children.slice(l,l+1),d=e>r;let g=n?this.getRowParent(r-1):this.getRowParent(r);g==null&&(g=this.getRowParent(r-1)),g==null&&(g=this.getDataObject(r-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(r),g.__children=[]);const y=n||i||s?g.__children.length:this.getRowIndexWithinParent(r),C=o===g;g.__children.splice(y,0,h[0]),o.__children.splice(l+(d&&C?1:0),1),this.syncRowWithRawSource(o),C||this.syncRowWithRawSource(g)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function yj(t,e,r){return(e=q7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q7e(t){var e=J7e(t,"string");return typeof e=="symbol"?e:e+""}function J7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k6{constructor(e,r){yj(this,"hot",void 0),yj(this,"plugin",void 0),this.hot=r,this.plugin=e}}class Ou extends k6{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const i=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(i),n=this.dataManager.getDataObject(i),o=r.getElementsByTagName("DIV")[0],l=o.querySelector("span.rowHeader"),h=o.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(Te(h,g=>{g&&o.removeChild(g)}),ht(r,Ou.CSS_CLASSES.indicatorContainer),s){const{rootDocument:g}=this.hot,y=l.cloneNode(!0);o.innerHTML="",pr(0,s-1,()=>{const C=g.createElement("SPAN");ht(C,Ou.CSS_CLASSES.emptyIndicator),o.appendChild(C)}),o.appendChild(y)}if(this.dataManager.hasChildren(n)){const g=this.hot.rootDocument.createElement("DIV");d&&Fr(g,[Dd()]),ht(r,Ou.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(ht(g,`${Ou.CSS_CLASSES.button} ${Ou.CSS_CLASSES.expandButton}`),d&&Fr(r,[Bl(!1)])):(ht(g,`${Ou.CSS_CLASSES.button} ${Ou.CSS_CLASSES.collapseButton}`),d&&Fr(r,[Bl(!0)])),o.appendChild(g)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let s=11;i.isClassicTheme()||(s=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*r+25),this.hot.render()}}class Q7e extends k6{constructor(e,r){var i;super(e,r),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,n){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;n==null&&(n=1/0),Te(i.lastCollapsedRows,(l,h)=>{l>=s&&l<n&&(i.lastCollapsedRows[h]=l+o)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:(s,n)=>{pr(s,s+n-1,o=>{const l=this.lastCollapsedRows.indexOf(o);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let n=null,o=null,l=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(n)):(n=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(n)&&Te(n.__children,h=>{s.push(this.dataManager.getRowIndex(h))}),l=this.collapseRows(s,!0,!1),i&&this.trimRows(l),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),l}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];Te(e,n=>{s.push(...this.collapseChildren(n,!1,!1))}),i&&this.trimRows(s),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return Te(e,n=>{s.push(n),r&&this.collapseChildRows(n,s)}),i&&this.trimRows(s),s}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);Te(s.__children,n=>{const o=this.dataManager.getRowIndex(n);r.push(o),this.collapseChildRows(o,r)})}i&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return Te(e,n=>{s.push(n),r&&this.expandChildRows(n,s)}),i&&this.untrimRows(s),s}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);Te(s.__children,n=>{if(!this.isAnyParentCollapsed(n)){const o=this.dataManager.getRowIndex(n);r.push(o),this.expandChildRows(o,r)}})}i&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let n=null,o=null,l=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(e)):(n=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(n)&&Te(n.__children,h=>{const d=this.dataManager.getRowIndex(h);s.push(d)}),l=this.expandRows(s,!0,!1),i&&this.untrimRows(l),r&&this.renderAndAdjust(),l}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];Te(e,n=>{s.push(...this.expandChildren(n,!1,!1))}),i&&this.untrimRows(s),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];Te(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];Te(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Te(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Te(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&Te(r.__children,s=>{const n=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(n))return i=!1,!1}),i}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const i=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const i=this.translateTrimmedRow(r.row);Ir(e.target,Ou.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),Bc(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Z7e(t,e,r){e$e(t,e),e.set(t,r)}function e$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t$e(t,e,r){return(e=r$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r$e(t){var e=n$e(t,"string");return typeof e=="symbol"?e:e+""}function n$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i$e(t,e){return t.get(s$e(t,e))}function s$e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cj=new WeakMap;class o$e extends k6{constructor(){super(...arguments),t$e(this,"dataManager",this.plugin.dataManager),Z7e(this,Cj,{row_above:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(aD)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(i);this.dataManager.addChild(s)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(lD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(s)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pr(0,e.items.length-1,i=>{if(i===0)return Te(r,(s,n)=>{e.items.splice(i+n,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pr(0,e.items.length-1,r=>{const i=i$e(Cj,this)[e.items[r].key];i!=null&&(e.items[r].callback=i)}),e}}function Zx(t,e,r){return(e=a$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$e(t){var e=l$e(t,"string");return typeof e=="symbol"?e:e+""}function l$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c$e{constructor(e){Zx(this,"plugin",void 0),Zx(this,"hot",void 0),Zx(this,"dataManager",void 0),Zx(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,i,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:i,movePossible:s}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),l=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let h=!0;const d=e.map(_=>{if(!h)return!1;const E=this.dataManager.translateTrimmedRow(_);return h=this.shouldAllowMoving(E,l),E}),g=d.indexOf(l)===-1;if(!h||!g)return!1;const y=this.getBaseParent(d),C=this.getTargetParent(o,l),x=y===C;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(C),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,l,x),this.moveRows(d,l,C),this.dataManager.rewriteCache(),this.moveCellsMeta(d,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,i,s,s&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:i,dropIndex:s,movePossible:n}=e;let o=!1;return _i(s)&&(Nn(Ln`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,i,s,n,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let i=this.dataManager.getRowParent(e?r-1:r);return i==null&&(i=this.dataManager.getRowParent(r-1)),i}shiftCollapsibleParentsLocations(e,r,i){i||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,i){const s=r===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(n=>{this.dataManager.moveRow(n,r,this.movedToCollapsed,s)})})}moveCellsMeta(e,r){const i=[],s=Math.max(...e)<r;e.forEach(n=>{i.push(this.hot.getCellMetaAtRow(n))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(s?i.length:0),0,...i)}selectCells(e,r){const i=e.length;let s=0,n=0,o=null,l=null;if(this.movedToCollapsed){let h=null;e[i-1]<r?h=this.dataManager.translateTrimmedRow(r-i):h=this.dataManager.translateTrimmedRow(r);const d=this.dataManager.getRowParent(h===null?this.hot.countSourceRows()-1:h-1),g=this.dataManager.getRowIndex(d);s=this.dataManager.untranslateTrimmedRow(g),n=s}else e[i-1]<r?(n=r-1,s=n-i+1):(s=r,n=s+i-1);o=this.hot.selection,l=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(s,0)),o.setRangeEnd(this.hot._createCellCoords(n,l),!0)}isRowOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}}function u$e(t,e){kZ(t,e),e.add(t)}function Sj(t,e,r){kZ(t,e),e.set(t,r)}function kZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZI(t,e,r){return(e=h$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h$e(t){var e=f$e(t,"string");return typeof e=="symbol"?e:e+""}function f$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z2(t,e){return t.get(Rs(t,e))}function PT(t,e,r){return t.set(Rs(t,e),r),r}function Rs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FT="nestedRows",d$e=300,bj=FT,g$e="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var dR=new WeakMap,ep=new WeakMap,Hs=new WeakSet;class m$e extends On{constructor(){super(...arguments),u$e(this,Hs),ZI(this,"dataManager",null),ZI(this,"headersUI",null),ZI(this,"collapsedRowsMap",null),Sj(this,dR,!1),Sj(this,ep,!1)}static get PLUGIN_KEY(){return FT}static get PLUGIN_PRIORITY(){return d$e}isEnabled(){return!!this.hot.getSettings()[FT]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new eS),this.dataManager=new X7e(this,this.hot),this.collapsingUI=new Q7e(this,this.hot),this.headersUI=new Ou(this,this.hot),this.contextMenuUI=new o$e(this,this.hot),this.rowMoveController=new c$e(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,O$e).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,I$e).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,w$e).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,y$e).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,C$e).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,v$e).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,x$e).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,b$e).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,E$e).call(e,...i)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,T$e).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,_$e).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,R$e).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,S$e).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,A$e).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Rs(Hs,e,p$e).call(e,...i)}),this.addHook("beforeLoadData",r=>Rs(Hs,this,xj).call(this,r)),this.addHook("beforeUpdateData",r=>Rs(Hs,this,xj).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:bj,relativeToGroup:$d,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bj)}disableCoreAPIModifiers(){PT(ep,this,!0)}enableCoreAPIModifiers(){PT(ep,this,!1)}onModifyRowData(e){if(!Z2(ep,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Z2(ep,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,i){return Z2(ep,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,i),!1)}destroy(){super.destroy()}}function p$e(t,e,r,i){return this.rowMoveController.onBeforeRowMove(t,e,r,i)}function v$e(t,e,r){this.collapsingUI.toggleState(t,e,r)}function w$e(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),PT(dR,this,!0),this.dataManager.getData().slice()}function y$e(t){return this.contextMenuUI.appendOptions(t)}function C$e(t,e){this.headersUI.appendLevelIndicators(t,e)}function S$e(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function b$e(t,e,r,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{PT(dR,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function x$e(t,e,r){const i=Array.from(r.reduce((s,n)=>{if(this.dataManager.isParent(n)){const o=this.dataManager.getDataObject(n).__children;return s.add(n),Array.isArray(o)&&o.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(n)},new Set));r.length=0,r.push(...i)}function E$e(){this.collapsingUI.collapsedRowsStash.stash()}function T$e(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _$e(){this.collapsingUI.collapsedRowsStash.stash()}function R$e(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function A$e(){this.dataManager.rewriteCache()}function O$e(){this.headersUI.updateRowHeaderWidth()}function I$e(t,e){Z2(dR,this)&&(e.skipRender=!0)}function xj(t){if(!w_e(t)){Xk(g$e),this.hot.getSettings()[FT]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function e3(t,e,r){return(e=P$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P$e(t){var e=F$e(t,"string");return typeof e=="symbol"?e:e+""}function F$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M$e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;e3(this,"rootWindow",void 0),e3(this,"prefix",void 0),e3(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const i=typeof e>"u"?r:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Te(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function k$e(t,e,r){return(e=N$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N$e(t){var e=D$e(t,"string");return typeof e=="symbol"?e:e+""}function D$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}qt.getSingleton().register("persistentStateSave");qt.getSingleton().register("persistentStateLoad");qt.getSingleton().register("persistentStateReset");const Ej="persistentState",L$e=0;class H$e extends On{constructor(){super(...arguments),k$e(this,"storage",void 0)}static get PLUGIN_KEY(){return Ej}static get PLUGIN_PRIORITY(){return L$e}isEnabled(){return!!this.hot.getSettings()[Ej]}enablePlugin(){this.enabled||(this.storage||(this.storage=new M$e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function $$e(t,e){B$e(t,e),e.add(t)}function B$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t3(t,e,r){return(e=V$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V$e(t){var e=W$e(t,"string");return typeof e=="symbol"?e:e+""}function W$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tj(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const r3="search",j$e=190,U$e="htSearchResult",z$e=function(t,e,r,i,s){t.getCellMeta(e,r).isSearchResult=s},G$e=function(t,e,r){return _i(t)||t===null||!t.toLocaleLowerCase||t.length===0||_i(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var n3=new WeakSet;class Y$e extends On{constructor(){super(...arguments),$$e(this,n3),t3(this,"callback",z$e),t3(this,"queryMethod",G$e),t3(this,"searchResultClass",U$e)}static get PLUGIN_KEY(){return r3}static get PLUGIN_PRIORITY(){return j$e}isEnabled(){return this.hot.getSettings()[r3]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[r3];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Tj(n3,e,_j).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Tj(n3,e,_j).call(e,...s)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),n=this.hot.countCols(),o=[],l=this.hot;return pr(0,s-1,h=>{pr(0,n-1,d=>{const g=this.hot.getDataAtCell(h,d),y=this.hot.getCellMeta(h,d),C=y.search.callback||r,_=(y.search.queryMethod||i)(e,g,y);if(_){const E={row:h,col:d,data:g};o.push(E)}C&&C(l,h,d,g,_)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Qr(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _j(t,e,r,i,s,n){const o=n.className||[];let l=[];typeof o=="string"?l=o.split(" "):l.push(...o),this.isEnabled()&&n.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),n.className=l.join(" ")}function e2(t,e,r){return(e=K$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K$e(t){var e=X$e(t,"string");return typeof e=="symbol"?e:e+""}function X$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NZ{constructor(e){e2(this,"viewportWidth",void 0),e2(this,"overwriteColumnWidthFn",void 0),e2(this,"baseWidths",new Map),e2(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class q$e extends NZ{calculate(){const e=Array.from(this.baseWidths).reduce((y,C)=>{let[,x]=C;return y+x},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,s=[],n=[];let o=this.viewportWidth,l=0;if(this.baseWidths.forEach((y,C)=>{const x=Math.round(y*i),_=this.overwriteColumnWidthFn(x,C);x===_&&x>=u1?(s.push([C,_]),l+=_):x!==_&&(s.push([C,_]),n.push(C),o-=_)}),o<=u1){this.stretchedWidths.clear();return}const h=o/l;let d=-1,g=0;s.forEach((y,C)=>{let[x,_]=y,E=_;n.includes(x)||(E=Math.round(_*h)),this.stretchedWidths.set(x,E),d=x,C<s.length-1&&(g+=E)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(d,Math.round(this.viewportWidth-g))}}function Rj(t,e,r){J$e(t,e),e.set(t,r)}function J$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function i3(t,e){return t.get(DZ(t,e))}function t2(t,e,r){return t.set(DZ(t,e),r),r}function DZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var r2=new WeakMap,Aw=new WeakMap;class Q$e extends NZ{constructor(){super(...arguments),Rj(this,r2,0),Rj(this,Aw,-1)}prepare(e){super.prepare(e),t2(r2,this,0),t2(Aw,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),t2(Aw,this,e),t2(r2,this,r)}calculate(){if(i3(Aw,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,s)=>{let[,n]=s;return i+n},0),r=Math.max(this.viewportWidth-e+i3(r2,this),0);this.stretchedWidths.set(i3(Aw,this),r)}}function Z$e(t,e){LZ(t,e),e.add(t)}function n2(t,e,r){LZ(t,e),e.set(t,r)}function LZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ui(t,e){return t.get(Mp(t,e))}function s3(t,e,r){return t.set(Mp(t,e),r),r}function Mp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const e9e="stretchColumns";var Oo=new WeakMap,tp=new WeakMap,o3=new WeakMap,i2=new WeakMap,Ow=new WeakSet;class t9e{constructor(e){Z$e(this,Ow),n2(this,Oo,void 0),n2(this,tp,void 0),n2(this,o3,new Map([["all",new q$e(Mp(Ow,this,Aj).bind(this))],["last",new Q$e(Mp(Ow,this,Aj).bind(this))]])),n2(this,i2,"none"),s3(Oo,this,e),s3(tp,this,Ui(Oo,this).columnIndexMapper.createAndRegisterIndexMap(e9e,"physicalIndexToValue"))}useStrategy(e){s3(i2,this,Ui(o3,this).has(e)?e:"none")}refreshStretching(){if(Ui(i2,this)==="none"){Ui(tp,this).clear();return}Ui(Oo,this).batchExecution(()=>{Ui(tp,this).clear();const e=Ui(o3,this).get(Ui(i2,this));let i=Ui(Oo,this).view.getViewportWidth();Mp(Ow,this,r9e).call(this)&&(i-=so(Ui(Oo,this).rootDocument)),e.prepare({viewportWidth:i});for(let s=0;s<Ui(Oo,this).countCols();s++)Ui(Oo,this).columnIndexMapper.isHidden(Ui(Oo,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,Mp(Ow,this,n9e).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[n,o]=s;Ui(tp,this).setValueAtIndex(Ui(Oo,this).toPhysicalColumn(n),o)})},!0)}getStretchedWidth(e){return Ui(tp,this).getValueAtIndex(Ui(Oo,this).toPhysicalColumn(e))}}function r9e(){const{view:t}=Ui(Oo,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),r=Ui(Oo,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let s=0,n=!1;for(let l=0;l<r;l++){var o;if(s+=((o=Ui(Oo,this).getRowHeight(l))!==null&&o!==void 0?o:i)+(l===0?1:0),s>e){n=!0;break}}return n}function n9e(t){var e;return(e=Ui(Oo,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:u1}function Aj(t,e){return Ui(Oo,this).runHooks("beforeStretchingColumnWidth",t,e)}function i9e(t,e){HZ(t,e),e.add(t)}function a3(t,e,r){HZ(t,e),e.set(t,r)}function HZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l3(t,e,r){return t.set(MT(t,e),r),r}function Eh(t,e){return t.get(MT(t,e))}function MT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const s9e="stretchColumns",o9e=155;var dp=new WeakMap,s2=new WeakMap,Iw=new WeakMap,c3=new WeakSet;class a9e extends On{constructor(){super(...arguments),i9e(this,c3),a3(this,dp,new t9e(this.hot)),a3(this,s2,null),a3(this,Iw,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:s}=i;Eh(s2,this)!==null&&Eh(s2,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),l3(s2,this,s.width)})})}))}static get PLUGIN_KEY(){return s9e}static get PLUGIN_PRIORITY(){return o9e}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Eh(dp,this).useStrategy(this.hot.getSettings().stretchH),Eh(Iw,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return MT(c3,e,c9e).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return MT(c3,e,l9e).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Eh(dp,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Eh(Iw,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Eh(dp,this).getStretchedWidth(e)}destroy(){Eh(Iw,this).disconnect(),l3(Iw,this,null),l3(dp,this,null),super.destroy()}}function l9e(t,e,r){if(r===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function c9e(t){t&&Eh(dp,this).refreshStretching()}function u9e(t,e){h9e(t,e),e.add(t)}function h9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o2(t,e,r){return(e=f9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f9e(t){var e=d9e(t,"string");return typeof e=="symbol"?e:e+""}function d9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function u3(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const g9e="touchScroll",m9e=200;var a2=new WeakSet;class p9e extends On{constructor(){super(...arguments),u9e(this,a2),o2(this,"scrollbars",[]),o2(this,"clones",[]),o2(this,"lockedCollection",!1),o2(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return g9e}static get PLUGIN_PRIORITY(){return m9e}static get SETTING_KEYS(){return!0}isEnabled(){return tq()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>u3(a2,this,v9e).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>u3(a2,this,w9e).call(this)),this.addHook("afterMomentumScroll",()=>u3(a2,this,y9e).call(this))}}function v9e(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),i&&this.scrollbars.push(i),s&&s.clone&&this.scrollbars.push(s),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function w9e(){this.freezeOverlays=!0,Te(this.clones,t=>{ht(t,"hide-tween")})}function y9e(){this.freezeOverlays=!1,Te(this.clones,t=>{Ar(t,"hide-tween"),ht(t,"show-tween")}),this.hot._registerTimeout(()=>{Te(this.clones,t=>{Ar(t,"show-tween")})},400),Te(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function C9e(t,e){S9e(t,e),e.add(t)}function S9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b9e(t,e,r){return(e=x9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x9e(t){var e=E9e(t,"string");return typeof e=="symbol"?e:e+""}function E9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T9e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const eE="trimRows",_9e=330;var Oj=new WeakSet;class R9e extends On{constructor(){super(...arguments),C9e(this,Oj),b9e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return eE}static get PLUGIN_PRIORITY(){return _9e}isEnabled(){return!!this.hot.getSettings()[eE]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new eS),this.trimmedRowsMap.addLocalHook("init",()=>T9e(Oj,this,A9e).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[eE];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Te(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{Te(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,s,i,i&&s.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let s=r;const n=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(Te(e,h=>{n[h]=!1}),s=la(n,(h,d,g)=>(d&&h.push(g),h),[])),this.hot.runHooks("beforeUntrimRow",r,s,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(n),this.hot.runHooks("afterUntrimRow",r,s,i&&o,i&&s.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<r)}destroy(){super.destroy()}}function A9e(){const t=this.hot.getSettings()[eE];Array.isArray(t)&&this.hot.batchExecution(()=>{Te(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var O9e=ni,I9e=R1,P9e=sK;O9e({target:"Object",stat:!0},{fromEntries:function(e){var r={};return I9e(e,function(i,s){P9e(r,i,s)},{AS_ENTRIES:!0}),r}});const $Z="undoRedo",F9e="undoRedo";function Vt(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,s){const n=i&&i.length;if(!n||!i.find(h=>{const[,,d,g]=h;return d!==g}))return;const l=()=>{const h=i.reduce((g,y)=>(g.push([...y]),g),[]);Te(h,g=>{g[1]=t.propToCol(g[1])});const d=n>1?this.getSelected():[[h[0][0],h[0][1]]];return new Vt.ChangeAction(h,d)};e.done(l,s)}),t.addHook("afterCreateRow",(i,s,n)=>{e.done(()=>new Vt.CreateRowAction(i,s),n)});const r=(i,s,n,o)=>{const l=["visualRow","visualCol","row","col","prop"],h=l.length,d=[];return pr(n,o,g=>{pr(i,s,y=>{const C=t.getCellMeta(y,g);if(Object.keys(C).length!==h){const x=Object.fromEntries(Object.entries(C).filter(_=>{let[E]=_;return l.includes(E)===!1}));d.push([C.visualRow,C.visualCol,x])}})}),d};t.addHook("beforeRemoveRow",(i,s,n,o)=>{const l=()=>{const h=t.toPhysicalRow(i),d=h+s-1,g=sa(e.instance.getSourceData(h,0,h+s-1,e.instance.countSourceCols()-1));return new Vt.RemoveRowAction(h,g,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),r(h,d,0,t.countCols()-1))};e.done(l,o)}),t.addHook("afterCreateCol",(i,s,n)=>{e.done(()=>new Vt.CreateColumnAction(i,s),n)}),t.addHook("beforeRemoveCol",(i,s,n,o)=>{const l=()=>{const h=e.instance.getSourceDataArray(),d=(e.instance.countCols()+i)%e.instance.countCols(),g=d+s-1,y=[],C=[],x=[];pr(h.length-1,R=>{const I=[],F=h[R];pr(d,g,D=>{I.push(F[t.toPhysicalColumn(D)])}),y.push(I)}),pr(s-1,R=>{x.push(t.toPhysicalColumn(d+R))}),Array.isArray(t.getSettings().colHeaders)&&pr(s-1,R=>{C.push(t.getSettings().colHeaders[t.toPhysicalColumn(d+R)]||null)});const _=t.columnIndexMapper.getIndexesSequence(),E=t.rowIndexMapper.getIndexesSequence();return new Vt.RemoveColumnAction(d,x,y,C,_,E,t.getSettings().fixedColumnsStart,r(0,t.countRows(),d,g))};e.done(l,o)}),t.addHook("beforeCellAlignment",(i,s,n,o)=>{e.done(()=>new Vt.CellAlignmentAction(i,s,n,o))}),t.addHook("beforeFilter",(i,s)=>{e.done(()=>new Vt.FiltersAction(i,s))}),t.addHook("beforeRowMove",(i,s)=>{i!==!1&&e.done(()=>new Vt.RowMoveAction(i,s))}),t.addHook("beforeColumnMove",(i,s)=>{i!==!1&&e.done(()=>new Vt.ColumnMoveAction(i,s))}),t.addHook("beforeMergeCells",(i,s)=>{s||e.done(()=>new Vt.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,s)=>{s||e.done(()=>new Vt.UnmergeCellsAction(t,i))}),t.addHook("beforeColumnSort",(i,s,n)=>{n&&e.done(()=>new Vt.ColumnSortAction(i,s))}),t.addHook("afterInit",()=>{e.init()})}Vt.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const n=t(),o=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};Vt.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=sa(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const s=this,n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Vt.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=sa(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const s=this,n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Vt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Vt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Vt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Vt.prototype.isEnabled=function(){return this.enabled};Vt.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,N9e(t),this.registerShortcuts(),t.addHook("afterChange",BZ)};Vt.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,D9e(t),this.unregisterShortcuts(),t.removeHook("afterChange",BZ)};Vt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Vt.Action=function(){};Vt.Action.prototype.undo=function(){};Vt.Action.prototype.redo=function(){};Vt.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Xu(Vt.ChangeAction,Vt.Action);Vt.ChangeAction.prototype.undo=function(t,e){const r=sa(this.changes),i=t.countEmptyRows(!0),s=t.countEmptyCols(!0);for(let o=0,l=r.length;o<l;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let o=0,l=r.length;o<l;o++){const[h,d]=r[o];t.getSettings().minSpareRows&&h+1+t.getSettings().minSpareRows===t.countRows()&&i===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(h+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&d+1+t.getSettings().minSpareCols===t.countCols()&&s===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(d+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const n=t.getSelectedLast();if(n!==void 0){const[o,l]=r[0],[h,d]=n,g=t.getFirstFullyVisibleRow(),y=t.getFirstFullyVisibleColumn(),C=o>=g,x=l>=y;if((C&&x)===!1&&(h!==o||d!==l)===!0){const R={row:o,col:l};C===!1&&(R.verticalSnap="top"),x===!1&&(R.horizontalSnap="start"),t.scrollViewportTo(R)}}t.selectCells(this.selected,!1,!1)};Vt.ChangeAction.prototype.redo=function(t,e){const r=sa(this.changes);for(let i=0,s=r.length;i<s;i++)r[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Vt.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Xu(Vt.CreateRowAction,Vt.Action);Vt.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),i=t.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Vt.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Vt.RemoveRowAction=function(t,e,r,i,s,n){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=s,this.removedCellMetas=n};Xu(Vt.RemoveRowAction,Vt.Action);Vt.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,n)=>{Object.keys(s).forEach(o=>{const l=parseInt(o,10);i.push([this.index+n,isNaN(l)?o:l,s[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(s=>{let[n,o,l]=s;t.setCellMetaObject(n,o,l)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Vt.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Vt.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Xu(Vt.CreateColumnAction,Vt.Action);Vt.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Vt.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Vt.RemoveColumnAction=function(t,e,r,i,s,n,o,l){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=i,this.columnPositions=s.slice(0),this.rowPositions=n.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=l};Xu(Vt.RemoveColumnAction,Vt.Action);Vt.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(d,g,y)=>y[this.indexes.indexOf(i[g])],n=this.data.length,o=[];for(let d=0;d<n;d++)o.push(on(this.data[d],s));const l=on(this.headers,s),h=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Te(t.getSourceDataArray(),(d,g)=>{Te(i,(y,C)=>{d[y]=o[g][C],h.push([g,y,d[y]])})}),t.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&Te(l,(d,g)=>{t.getSettings().colHeaders[i[g]]=d}),this.removedCellMetas.forEach(d=>{let[g,y,C]=d;t.setCellMetaObject(g,y,C)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Vt.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Vt.CellAlignmentAction=function(t,e,r,i){this.stateBefore=t,this.range=e,this.type=r,this.alignment=i};Vt.CellAlignmentAction.prototype.undo=function(t,e){Te(this.range,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&t.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Vt.CellAlignmentAction.prototype.redo=function(t,e){Vf(this.range,this.type,this.alignment,(r,i)=>t.getCellMeta(r,i),(r,i,s,n)=>t.setCellMeta(r,i,s,n)),t.addHookOnce("afterViewRender",e),t.render()};Vt.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Xu(Vt.FiltersAction,Vt.Action);Vt.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()};Vt.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class M9e extends Vt.Action{constructor(e,r){super(),this.cellRange=r;const i=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,s.row,s.col)}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange)}}Vt.MergeCellsAction=M9e;class k9e extends Vt.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange,!0)}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0),e.render()}}Vt.UnmergeCellsAction=k9e;Vt.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Xu(Vt.RowMoveAction,Vt.Action);Vt.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),O6(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:n,to:o}=s;n<o&&(o-=1),r.moveRow(o,n)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Vt.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};Vt.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Xu(Vt.ColumnMoveAction,Vt.Action);Vt.ColumnMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),O6(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:n,to:o}=s;n<o&&(o-=1),r.moveColumn(o,n)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};Vt.ColumnMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),r.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};Vt.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Xu(Vt.ColumnSortAction,Vt.Action);Vt.ColumnSortAction.prototype.undo=function(t,e){const r=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:r;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),e()};Vt.ColumnSortAction.prototype.redo=function(t,e){const r=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),e()};Vt.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Vt.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:$Z};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};Vt.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup($Z)};function BZ(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function N9e(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function D9e(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const hS=qt.getSingleton();hS.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});hS.register("beforeUndo");hS.register("afterUndo");hS.register("beforeRedo");hS.register("afterRedo");Vt.PLUGIN_KEY=F9e;Vt.SETTING_KEYS=!0;function L9e(){wn(cy),wn(mPe),wn(uy),wn(KPe),wn(rFe),wn(aQ),wn(qFe),wn(kMe),wn(aR),wn(eNe),wn(_Ne),wn(kNe),wn(uR),wn(lDe),wn(s5e),wn(L5e),wn(uLe),wn(bLe),wn(kLe),wn(zLe),wn(t8e),wn(y8e),wn(A8e),wn(yHe),wn(QHe),wn(n7e),wn(O7e),wn(m$e),wn(H$e),wn(Y$e),wn(a9e),wn(p9e),wn(R9e),wn(Vt)}function H9e(){$Oe(),l3e(),v3e(),L3e(),L9e()}H9e();const $9e=()=>{const t=MC(),[e,r]=We.useState("convert");We.useEffect(()=>{var ye;(ye=t.state)!=null&&ye.activeTab&&r(t.state.activeTab)},[t]);const[i,s]=We.useState(null),[n,o]=We.useState([]),[l,h]=We.useState(!1),d=We.useRef(null),[g,y]=We.useState(null),[C,x]=We.useState(!1);We.useState([]);const[_,E]=We.useState(!1),[R,I]=We.useState(0),[F,D]=We.useState(null),U=ye=>{const Ee=ye.target.files[0];if(!Ee)return;const ke=new FileReader;ke.onload=nt=>{try{const at=new Uint8Array(nt.target.result),Ze=Ef.read(at,{type:"array"}),Xe=Ze.SheetNames[0],Pe=Ze.Sheets[Xe],Be=Ef.utils.sheet_to_json(Pe,{header:1,raw:!1,defval:""});if(Be.length>0){const Me=Be[0],A=Be.slice(1);o(Me),s(A),h(!0)}else zt.error("File Excel khng c d liu")}catch(at){console.error("Error reading Excel:",at),zt.error("Li khi c file Excel")}},ke.readAsArrayBuffer(Ee)},X=()=>{try{if(!d.current)return;const ye=d.current.hotInstance,Ee=ye.getData(),ke=ye.getColHeader(),nt=Ef.utils.aoa_to_sheet([ke,...Ee]),at=Ef.utils.book_new();Ef.utils.book_append_sheet(at,nt,"Sheet1"),Ef.writeFile(at,"edited_spreadsheet.xlsx"),zt.success(" lu thnh cng!")}catch(ye){console.error("Error saving Excel:",ye),zt.error("Li khi lu file")}},te=async ye=>{const Ee=Array.from(ye.target.files);if(Ee.length!==0)try{const ke=[];for(const nt of Ee){const at=await nt.arrayBuffer(),Ze=new Uint8Array(at),Xe=Ef.read(Ze,{type:"array"}),Pe=Xe.SheetNames[0],Be=Xe.Sheets[Pe],Me=Ef.utils.sheet_to_json(Be,{header:1,raw:!1,defval:""}),A=Me.find(K=>K.some(Z=>Z==="Tn"||Z==="n gi"||Z==="n v"));if(!A){zt.error(`File "${nt.name}": Khng tm thy ct "Tn", "n gi" hoc "n v"`);continue}const O=A.findIndex(K=>K==="Tn"),N=A.findIndex(K=>K==="n gi"),H=A.findIndex(K=>K==="n v"),B=Me.slice(Me.indexOf(A)+1).filter(K=>K[O]&&K[N]).map(K=>{var Z;return{name:K[O].trim(),price:parseFloat(K[N].replace(/[,.]/g,""))||0,unit:((Z=K[H])==null?void 0:Z.trim())||"",sourceFile:nt.name}});ke.push(...B)}y(ke),x(!0),zt.success(` chuyn i ${Ee.length} file thnh cng`)}catch(ke){console.error("Error converting files:",ke),zt.error("Li khi chuyn i file")}},Y=()=>{if(!g)return;const ye=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),Ee=URL.createObjectURL(ye),ke=document.createElement("a");ke.href=Ee,ke.download="converted_data.json",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),URL.revokeObjectURL(Ee),zt.success(" ti xung file JSON")},oe=async()=>{if(!g||g.length===0){zt.error("Khng c d liu  import");return}try{E(!0),I(0);const ye=g.filter(at=>at.name&&at.price).map((at,Ze)=>({...at,originalIndex:Ze+1,unit:at.unit||"Ci"}));if(ye.length===0){zt.error("Khng c sn phm no  thng tin bt buc (name v price)");return}const Ee=localStorage.getItem("token"),ke=ye.length,nt={successCount:0,failedCount:0,failedProducts:[]};for(let at=0;at<ye.length;at++){const Ze=ye[at];D(Ze),I(Math.round(at/ke*100));try{const Xe=await fetch("https://backend-giahung.onrender.com/api/products/bulk",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ee}`},body:JSON.stringify({products:[Ze]})}),Pe=await Xe.json();Xe.ok?nt.successCount++:(nt.failedCount++,nt.failedProducts.push({...Ze,error:Pe.message||"Li khng xc nh"}))}catch(Xe){nt.failedCount++,nt.failedProducts.push({...Ze,error:Xe.message})}}if(I(100),nt.failedProducts.length>0){console.error("=== Failed Products ==="),console.table(nt.failedProducts);const at=`
          Import tht bi:
          - S sn phm li: ${nt.failedProducts.length}
          - Chi tit li:
          ${nt.failedProducts.map(Ze=>`
  + Dng ${Ze.originalIndex}: ${Ze.name} - ${Ze.error}`).join("")}
        `;zt.error(at,{autoClose:!1,closeOnClick:!1})}zt.success(`Import hon tt:
Thnh cng: ${nt.successCount} sn phm
Tht bi: ${nt.failedCount} sn phm`),E(!1),D(null),x(!1),y(null)}catch(ye){console.error("=== Import Error ==="),console.error(ye),zt.error(`Li: ${ye.message}`),E(!1),D(null)}},me=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-auto",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsx("h3",{className:"text-xl font-semibold",children:"Kt qu chuyn i JSON"}),V.jsxs("div",{className:"space-x-2",children:[V.jsx("button",{onClick:oe,disabled:_,className:`px-4 py-2 ${_?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white rounded`,children:_?"ang Import...":"Import vo DB"}),V.jsx("button",{onClick:Y,disabled:_,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Ti JSON"}),V.jsx("button",{onClick:()=>x(!1),disabled:_,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"ng"})]})]}),_&&V.jsxs("div",{className:"mb-4",children:[V.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-2",children:V.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${R}%`}})}),V.jsxs("div",{className:"text-sm text-gray-600",children:[V.jsxs("p",{children:["ang import: ",F==null?void 0:F.name]}),V.jsxs("p",{children:["Tin trnh: ",R,"%"]})]})]}),V.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:V.jsx("pre",{className:"text-sm overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(g,null,2)})}),V.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[V.jsxs("div",{children:["Tng s sn phm: ",(g==null?void 0:g.length)||0]}),V.jsxs("div",{children:["S file  x l: ",[...new Set((g==null?void 0:g.map(ye=>ye.sourceFile))||[])].length]})]})]})}),de={data:i||[],colHeaders:n,rowHeaders:!0,width:"100%",height:"70vh",licenseKey:"non-commercial-and-evaluation",stretchH:"all",minRows:100,maxRows:500,minCols:20,maxCols:50,autoInsertRow:!0,manualRowMove:!0,manualColumnMove:!0,manualRowResize:!0,manualColumnResize:!0,fillHandle:{autoInsertRow:!0,direction:"vertical"},contextMenu:{items:{row_above:{name:"Thm hng pha trn"},row_below:{name:"Thm hng pha di"},col_left:{name:"Thm ct bn tri"},col_right:{name:"Thm ct bn phi"},remove_row:{name:"Xa hng"},remove_col:{name:"Xa ct"},undo:{name:"Hon tc"},redo:{name:"Lm li"},copy:{name:"Sao chp"},cut:{name:"Ct"},paste:{name:"Dn"}}},dropdownMenu:!0,filters:!0,multiColumnSorting:!0,viewportRowRenderingOffset:100,viewportColumnRenderingOffset:20,afterScrollVertically:function(){const ye=this,Ee=ye.countRows()-1;ye.getLastVisibleRow()>=Ee-20&&ye.alter("insert_row",Ee+1,50)},afterChange:function(ye,Ee){if(ye){const ke=this,nt=ke.countRows()-1,at=ke.countCols()-1;ye.forEach(([Ze,Xe,Pe,Be])=>{Ze===nt-5&&ke.alter("insert_row",nt+1,20),Xe===at-2&&ke.alter("insert_col",at+1,5)})}}};return V.jsxs("div",{className:"p-6",children:[V.jsxs("div",{className:"mb-8",children:[V.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cng c Excel"}),V.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[V.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 ${e==="convert"?"ring-2 ring-blue-500":""}`,children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chuyn Excel sang JSON"}),V.jsxs("div",{className:"mb-6",children:[V.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Chn file Excel  chuyn i thnh JSON"}),V.jsx("div",{className:"flex items-center space-x-4",children:V.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:[V.jsx(d$,{className:"mr-2"}),V.jsx("span",{children:"Chn File Excel"}),V.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:te,multiple:!0,className:"hidden"})]})})]})]}),V.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 ${e==="edit"?"ring-2 ring-blue-500":""}`,children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chnh sa Spreadsheet"}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Chn file Excel  chnh sa"}),V.jsxs("div",{className:"flex items-center space-x-4",children:[V.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:[V.jsx(d$,{className:"mr-2"}),V.jsx("span",{children:"Chn File Excel"}),V.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:U,className:"hidden"})]}),l&&V.jsxs("button",{onClick:X,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[V.jsx(ace,{className:"mr-2"}),"Lu Excel"]})]})]}),l&&V.jsx("div",{className:"border rounded-lg overflow-hidden mt-4",style:{height:"70vh",maxWidth:"100%",overflow:"auto"},children:V.jsx(EJ,{ref:d,settings:de})})]})]})]}),C&&V.jsx(me,{})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kT={};kT.version="0.18.5";var VZ=1252,B9e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],WZ=function(t){B9e.indexOf(t)!=-1&&(VZ=t)};function V9e(){WZ(1252)}var wC=function(t){WZ(t)};function W9e(){wC(1200),V9e()}var l2=function(e){return String.fromCharCode(e)},Ij=function(e){return String.fromCharCode(e)},NT,ud="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yC(t){for(var e="",r=0,i=0,s=0,n=0,o=0,l=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),n=r>>2,i=t.charCodeAt(d++),o=(r&3)<<4|i>>4,s=t.charCodeAt(d++),l=(i&15)<<2|s>>6,h=s&63,isNaN(i)?l=h=64:isNaN(s)&&(h=64),e+=ud.charAt(n)+ud.charAt(o)+ud.charAt(l)+ud.charAt(h);return e}function nf(t){var e="",r=0,i=0,s=0,n=0,o=0,l=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)n=ud.indexOf(t.charAt(d++)),o=ud.indexOf(t.charAt(d++)),r=n<<2|o>>4,e+=String.fromCharCode(r),l=ud.indexOf(t.charAt(d++)),i=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(i)),h=ud.indexOf(t.charAt(d++)),s=(l&3)<<6|h,h!==64&&(e+=String.fromCharCode(s));return e}var kn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),df=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ng(t){return kn?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Pj(t){return kn?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ec=function(e){return kn?df(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function gR(t){if(typeof ArrayBuffer>"u")return Ec(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),i=0;i!=t.length;++i)r[i]=t.charCodeAt(i)&255;return e}function fS(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function j9e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ro=kn?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:df(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var i=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)i.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";i.set(new Uint8Array(t[e]),r)}return i}return[].concat.apply([],t.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function U9e(t){for(var e=[],r=0,i=t.length+250,s=Ng(t.length+255),n=0;n<t.length;++n){var o=t.charCodeAt(n);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++n)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>i&&(e.push(s.slice(0,r)),r=0,s=Ng(65535),i=65530)}return e.push(s.slice(0,r)),ro(e)}var Ey=/\u0000/g,c2=/[\u0001-\u0006]/g;function qp(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _c(t,e){var r=""+t;return r.length>=e?r:Xi("0",e-r.length)+r}function N6(t,e){var r=""+t;return r.length>=e?r:Xi(" ",e-r.length)+r}function DT(t,e){var r=""+t;return r.length>=e?r:r+Xi(" ",e-r.length)}function z9e(t,e){var r=""+Math.round(t);return r.length>=e?r:Xi("0",e-r.length)+r}function G9e(t,e){var r=""+t;return r.length>=e?r:Xi("0",e-r.length)+r}var Fj=Math.pow(2,32);function rp(t,e){if(t>Fj||t<-Fj)return z9e(t,e);var r=Math.round(t);return G9e(r,e)}function LT(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Mj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h3=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Y9e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Qi={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K9e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function HT(t,e,r){for(var i=t<0?-1:1,s=t*i,n=0,o=1,l=0,h=1,d=0,g=0,y=Math.floor(s);d<e&&(y=Math.floor(s),l=y*o+n,g=y*d+h,!(s-y<5e-8));)s=1/(s-y),n=o,o=l,h=d,d=g;if(g>e&&(d>e?(g=h,l=n):(g=d,l=o)),!r)return[0,i*l,g];var C=Math.floor(i*l/g);return[C,i*l-C*g,g]}function u2(t,e,r){if(t>2958465||t<0)return null;var i=t|0,s=Math.floor(86400*(t-i)),n=0,o=[],l={D:i,T:s,u:86400*(t-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++i,++l.D)),i===60)o=r?[1317,10,29]:[1900,2,29],n=3;else if(i===0)o=r?[1317,8,29]:[1900,1,0],n=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],n=h.getDay(),i<60&&(n=(n+6)%7),r&&(n=tBe(h,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=n,l}var jZ=new Date(1899,11,31,0,0,0),X9e=jZ.getTime(),q9e=new Date(1900,2,1,0,0,0);function UZ(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=q9e&&(r+=24*60*60*1e3),(r-(X9e+(t.getTimezoneOffset()-jZ.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function D6(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J9e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Q9e(t){var e=t<0?12:11,r=D6(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Z9e(t){var e=D6(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function eBe(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Q9e(t):e===10?r=t.toFixed(10).substr(0,12):r=Z9e(t),D6(J9e(r.toUpperCase()))}function BF(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):eBe(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Id(14,UZ(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tBe(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rBe(t,e,r,i){var s="",n=0,o=0,l=r.y,h,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:h=l%100,d=2;break;default:h=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return h3[r.m-1][1];case 5:return h3[r.m-1][0];default:return h3[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return Mj[r.q][0];default:return Mj[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_c(r.S,e.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,n=Math.round(o*(r.S+r.u)),n>=60*o&&(n=0),e==="s"?n===0?"0":""+n/o:(s=_c(n,2+i),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=l,d=1;break}var g=d>0?_c(h,d):"";return g}function hd(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,i=t.substr(0,r);r!=t.length;r+=e)i+=(i.length>0?",":"")+t.substr(r,e);return i}var zZ=/%/g;function nBe(t,e,r){var i=e.replace(zZ,""),s=e.length-i.length;return zh(t,i,r*Math.pow(10,2*s))+Xi("%",s)}function iBe(t,e,r){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return zh(t,e.substr(0,i),r/Math.pow(10,3*(e.length-i)))}function GZ(t,e){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+GZ(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var n=Math.floor(Math.log(e)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(e/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,d,g){return h+d+g.substr(0,(s+n)%s)+"."+g.substr(n)+"E"})}else r=e.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var YZ=/# (\?+)( ?)\/( ?)(\d+)/;function sBe(t,e,r){var i=parseInt(t[4],10),s=Math.round(e*i),n=Math.floor(s/i),o=s-n*i,l=i;return r+(n===0?"":""+n)+" "+(o===0?Xi(" ",t[1].length+1+t[4].length):N6(o,t[1].length)+t[2]+"/"+t[3]+_c(l,t[4].length))}function oBe(t,e,r){return r+(e===0?"":""+e)+Xi(" ",t[1].length+2+t[4].length)}var KZ=/^#*0*\.([0#]+)/,XZ=/\).*[0#]/,qZ=/\(###\) ###\\?-####/;function qo(t){for(var e="",r,i=0;i!=t.length;++i)switch(r=t.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Nj(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Dj(t,e){var r=t-Math.floor(t),i=Math.pow(10,e);return e<(""+Math.round(r*i)).length?0:Math.round(r*i)}function aBe(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function lBe(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Tl(t,e,r){if(t.charCodeAt(0)===40&&!e.match(XZ)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tl("n",i,r):"("+Tl("n",i,-r)+")"}if(e.charCodeAt(e.length-1)===44)return iBe(t,e,r);if(e.indexOf("%")!==-1)return nBe(t,e,r);if(e.indexOf("E")!==-1)return GZ(e,r);if(e.charCodeAt(0)===36)return"$"+Tl(t,e.substr(e.charAt(1)==" "?2:1),r);var s,n,o,l,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+rp(h,e.length);if(e.match(/^[#?]+$/))return s=rp(r,0),s==="0"&&(s=""),s.length>e.length?s:qo(e.substr(0,e.length-s.length))+s;if(n=e.match(YZ))return sBe(n,h,d);if(e.match(/^#+0+$/))return d+rp(h,e.length-e.indexOf("0"));if(n=e.match(KZ))return s=Nj(r,n[1].length).replace(/^([^\.]+)$/,"$1."+qo(n[1])).replace(/\.$/,"."+qo(n[1])).replace(/\.(\d*)$/,function(_,E){return"."+E+Xi("0",qo(n[1]).length-E.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),n=e.match(/^(0*)\.(#*)$/))return d+Nj(h,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=e.match(/^#{1,3},##0(\.?)$/))return d+hd(rp(h,0));if(n=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tl(t,e,-r):hd(""+(Math.floor(r)+aBe(r,n[1].length)))+"."+_c(Dj(r,n[1].length),n[1].length);if(n=e.match(/^#,#*,#0/))return Tl(t,e.replace(/^#,#*,/,""),r);if(n=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qp(Tl(t,e.replace(/[\\-]/g,""),r)),o=0,qp(qp(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<s.length?s.charAt(o++):_==="0"?"0":""}));if(e.match(qZ))return s=Tl(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(n=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),l=HT(h,Math.pow(10,o)-1,!1),s=""+d,g=zh("n",n[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+n[2]+"/"+n[3],g=DT(l[2],o),g.length<n[4].length&&(g=qo(n[4].substr(n[4].length-g.length))+g),s+=g,s;if(n=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),l=HT(h,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?N6(l[1],o)+n[2]+"/"+n[3]+DT(l[2],o):Xi(" ",2*o+1+n[2].length+n[3].length));if(n=e.match(/^[#0?]+$/))return s=rp(r,0),e.length<=s.length?s:qo(e.substr(0,e.length-s.length))+s;if(n=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var y=e.indexOf(".")-o,C=e.length-s.length-y;return qo(e.substr(0,y)+s+e.substr(e.length-C))}if(n=e.match(/^00,000\.([#0]*0)$/))return o=Dj(r,n[1].length),r<0?"-"+Tl(t,e,-r):hd(lBe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?_c(0,3-_.length):"")+_})+"."+_c(o,n[1].length);switch(e){case"###,##0.00":return Tl(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=hd(rp(h,0));return x!=="0"?d+x:"";case"###,###.00":return Tl(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tl(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cBe(t,e,r){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return zh(t,e.substr(0,i),r/Math.pow(10,3*(e.length-i)))}function uBe(t,e,r){var i=e.replace(zZ,""),s=e.length-i.length;return zh(t,i,r*Math.pow(10,2*s))+Xi("%",s)}function JZ(t,e){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+JZ(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var n=Math.floor(Math.log(e)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(e/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,d,g){return h+d+g.substr(0,(s+n)%s)+"."+g.substr(n)+"E"})}else r=e.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Cu(t,e,r){if(t.charCodeAt(0)===40&&!e.match(XZ)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cu("n",i,r):"("+Cu("n",i,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cBe(t,e,r);if(e.indexOf("%")!==-1)return uBe(t,e,r);if(e.indexOf("E")!==-1)return JZ(e,r);if(e.charCodeAt(0)===36)return"$"+Cu(t,e.substr(e.charAt(1)==" "?2:1),r);var s,n,o,l,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+_c(h,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:qo(e.substr(0,e.length-s.length))+s;if(n=e.match(YZ))return oBe(n,h,d);if(e.match(/^#+0+$/))return d+_c(h,e.length-e.indexOf("0"));if(n=e.match(KZ))return s=(""+r).replace(/^([^\.]+)$/,"$1."+qo(n[1])).replace(/\.$/,"."+qo(n[1])),s=s.replace(/\.(\d*)$/,function(_,E){return"."+E+Xi("0",qo(n[1]).length-E.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),n=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=e.match(/^#{1,3},##0(\.?)$/))return d+hd(""+h);if(n=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cu(t,e,-r):hd(""+r)+"."+Xi("0",n[1].length);if(n=e.match(/^#,#*,#0/))return Cu(t,e.replace(/^#,#*,/,""),r);if(n=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qp(Cu(t,e.replace(/[\\-]/g,""),r)),o=0,qp(qp(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<s.length?s.charAt(o++):_==="0"?"0":""}));if(e.match(qZ))return s=Cu(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(n=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),l=HT(h,Math.pow(10,o)-1,!1),s=""+d,g=zh("n",n[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+n[2]+"/"+n[3],g=DT(l[2],o),g.length<n[4].length&&(g=qo(n[4].substr(n[4].length-g.length))+g),s+=g,s;if(n=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),l=HT(h,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?N6(l[1],o)+n[2]+"/"+n[3]+DT(l[2],o):Xi(" ",2*o+1+n[2].length+n[3].length));if(n=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:qo(e.substr(0,e.length-s.length))+s;if(n=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var y=e.indexOf(".")-o,C=e.length-s.length-y;return qo(e.substr(0,y)+s+e.substr(e.length-C))}if(n=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Cu(t,e,-r):hd(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?_c(0,3-_.length):"")+_})+"."+_c(0,n[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=hd(""+h);return x!=="0"?d+x:"";default:if(e.match(/\.[0#?]*$/))return Cu(t,e.slice(0,e.lastIndexOf(".")),r)+qo(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function zh(t,e,r){return(r|0)===r?Cu(t,e,r):Tl(t,e,r)}function hBe(t){for(var e=[],r=!1,i=0,s=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=t.substr(s,i-s),s=i+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var QZ=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ZZ(t){for(var e=0,r="",i="";e<t.length;)switch(r=t.charAt(e)){case"G":LT(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=r;t.charAt(e++)!=="]"&&e<t.length;)i+=t.charAt(e);if(i.match(QZ))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function fBe(t,e,r,i){for(var s=[],n="",o=0,l="",h="t",d,g,y,C="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!LT(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";(y=t.charCodeAt(++o))!==34&&o<t.length;)n+=String.fromCharCode(y);s[s.length]={t:"t",v:n},++o;break;case"\\":var x=t.charAt(++o),_=x==="("||x===")"?x:"t";s[s.length]={t:_,v:x},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=u2(e,r,t.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},h=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=u2(e,r),d==null))return"";for(n=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)n+=l;l==="m"&&h.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=C),s[s.length]={t:l,v:n},h=l;break;case"A":case"a":case"":var E={t:l,v:l};if(d==null&&(d=u2(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",C="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",o+=5,C="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",o+=5,C="h"):(E.t="t",++o),d==null&&E.t==="T")return"";s[s.length]=E,h=l;break;case"[":for(n=l;t.charAt(o++)!=="]"&&o<t.length;)n+=t.charAt(o);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(QZ)){if(d==null&&(d=u2(e,r),d==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},h=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",ZZ(t)||(s[s.length]={t:"t",v:n}));break;case".":if(d!=null){for(n=l;++o<t.length&&(l=t.charAt(o))==="0";)n+=l;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)n+=l;s[s.length]={t:"n",v:n};break;case"?":for(n=l;t.charAt(++o)===l;)n+=l;s[s.length]={t:l,v:n},h=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:i===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)n+=t.charAt(o);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var R=0,I=0,F;for(o=s.length-1,h="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=C,h="h",R<1&&(R=1);break;case"s":(F=s[o].v.match(/\.0+$/))&&(I=Math.max(I,F[0].length-1)),R<3&&(R=3);case"d":case"y":case"M":case"e":h=s[o].t;break;case"m":h==="s"&&(s[o].t="M",R<2&&(R=2));break;case"X":break;case"Z":R<1&&s[o].v.match(/[Hh]/)&&(R=1),R<2&&s[o].v.match(/[Mm]/)&&(R=2),R<3&&s[o].v.match(/[Ss]/)&&(R=3)}switch(R){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var D="",U;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=rBe(s[o].t.charCodeAt(0),s[o].v,d,I),s[o].t="t";break;case"n":case"?":for(U=o+1;s[U]!=null&&((l=s[U].t)==="?"||l==="D"||(l===" "||l==="t")&&s[U+1]!=null&&(s[U+1].t==="?"||s[U+1].t==="t"&&s[U+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[U].v==="/"||s[U].v===" "&&s[U+1]!=null&&s[U+1].t=="?"));)s[o].v+=s[U].v,s[U]={v:"",t:";"},++U;D+=s[o].v,o=U-1;break;case"G":s[o].t="t",s[o].v=BF(e,r);break}var X="",te,Y;if(D.length>0){D.charCodeAt(0)==40?(te=e<0&&D.charCodeAt(0)===45?-e:e,Y=zh("n",D,te)):(te=e<0&&i>1?-e:e,Y=zh("n",D,te),te<0&&s[0]&&s[0].t=="t"&&(Y=Y.substr(1),s[0].v="-"+s[0].v)),U=Y.length-1;var oe=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){oe=o;break}var me=s.length;if(oe===s.length&&Y.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(U>=s[o].v.length-1?(U-=s[o].v.length,s[o].v=Y.substr(U+1,s[o].v.length)):U<0?s[o].v="":(s[o].v=Y.substr(0,U+1),U=-1),s[o].t="t",me=o);U>=0&&me<s.length&&(s[me].v=Y.substr(0,U+1)+s[me].v)}else if(oe!==s.length&&Y.indexOf("E")===-1){for(U=Y.indexOf(".")-1,o=oe;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(g=s[o].v.indexOf(".")>-1&&o===oe?s[o].v.indexOf(".")-1:s[o].v.length-1,X=s[o].v.substr(g+1);g>=0;--g)U>=0&&(s[o].v.charAt(g)==="0"||s[o].v.charAt(g)==="#")&&(X=Y.charAt(U--)+X);s[o].v=X,s[o].t="t",me=o}for(U>=0&&me<s.length&&(s[me].v=Y.substr(0,U+1)+s[me].v),U=Y.indexOf(".")+1,o=oe;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==oe)){for(g=s[o].v.indexOf(".")>-1&&o===oe?s[o].v.indexOf(".")+1:0,X=s[o].v.substr(0,g);g<s[o].v.length;++g)U<Y.length&&(X+=Y.charAt(U++));s[o].v=X,s[o].t="t",me=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(te=i>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=zh(s[o].t,s[o].v,te),s[o].t="t");var de="";for(o=0;o!==s.length;++o)s[o]!=null&&(de+=s[o].v);return de}var Lj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hj(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function dBe(t,e){var r=hBe(t),i=r.length,s=r[i-1].indexOf("@");if(i<4&&s>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[i,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Lj),l=r[1].match(Lj);return Hj(e,o)?[i,r[0]]:Hj(e,l)?[i,r[1]]:[i,r[o!=null&&l!=null?2:1]]}return[i,n]}function Id(t,e,r){r==null&&(r={});var i="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?i=r.dateNF:i=t;break;case"number":t==14&&r.dateNF?i=r.dateNF:i=(r.table!=null?r.table:Qi)[t],i==null&&(i=r.table&&r.table[kj[t]]||Qi[kj[t]]),i==null&&(i=K9e[t]||"General");break}if(LT(i,0))return BF(e,r);e instanceof Date&&(e=UZ(e,r.date1904));var s=dBe(i,e);if(LT(s[1]))return BF(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return fBe(s[1],e,r,s[0])}function eee(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Qi[r]==null){e<0&&(e=r);continue}if(Qi[r]==t){e=r;break}}e<0&&(e=391)}return Qi[e]=t,e}function mR(t){for(var e=0;e!=392;++e)t[e]!==void 0&&eee(t[e],e)}function pR(){Qi=Y9e()}var tee=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gBe(t){var e=typeof t=="number"?Qi[t]:t;return e=e.replace(tee,"(\\d+)"),new RegExp("^"+e+"$")}function mBe(t,e,r){var i=-1,s=-1,n=-1,o=-1,l=-1,h=-1;(e.match(tee)||[]).forEach(function(y,C){var x=parseInt(r[C+1],10);switch(y.toLowerCase().charAt(0)){case"y":i=x;break;case"d":n=x;break;case"h":o=x;break;case"s":h=x;break;case"m":o>=0?l=x:s=x;break}}),h>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&l==-1&&h==-1?d:i==-1&&s==-1&&n==-1?g:d+"T"+g}var pBe=function(){var t={};t.version="1.2.0";function e(){for(var Y=0,oe=new Array(256),me=0;me!=256;++me)Y=me,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,oe[me]=Y;return typeof Int32Array<"u"?new Int32Array(oe):oe}var r=e();function i(Y){var oe=0,me=0,de=0,ye=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(de=0;de!=256;++de)ye[de]=Y[de];for(de=0;de!=256;++de)for(me=Y[de],oe=256+de;oe<4096;oe+=256)me=ye[oe]=me>>>8^Y[me&255];var Ee=[];for(de=1;de!=16;++de)Ee[de-1]=typeof Int32Array<"u"?ye.subarray(de*256,de*256+256):ye.slice(de*256,de*256+256);return Ee}var s=i(r),n=s[0],o=s[1],l=s[2],h=s[3],d=s[4],g=s[5],y=s[6],C=s[7],x=s[8],_=s[9],E=s[10],R=s[11],I=s[12],F=s[13],D=s[14];function U(Y,oe){for(var me=oe^-1,de=0,ye=Y.length;de<ye;)me=me>>>8^r[(me^Y.charCodeAt(de++))&255];return~me}function X(Y,oe){for(var me=oe^-1,de=Y.length-15,ye=0;ye<de;)me=D[Y[ye++]^me&255]^F[Y[ye++]^me>>8&255]^I[Y[ye++]^me>>16&255]^R[Y[ye++]^me>>>24]^E[Y[ye++]]^_[Y[ye++]]^x[Y[ye++]]^C[Y[ye++]]^y[Y[ye++]]^g[Y[ye++]]^d[Y[ye++]]^h[Y[ye++]]^l[Y[ye++]]^o[Y[ye++]]^n[Y[ye++]]^r[Y[ye++]];for(de+=15;ye<de;)me=me>>>8^r[(me^Y[ye++])&255];return~me}function te(Y,oe){for(var me=oe^-1,de=0,ye=Y.length,Ee=0,ke=0;de<ye;)Ee=Y.charCodeAt(de++),Ee<128?me=me>>>8^r[(me^Ee)&255]:Ee<2048?(me=me>>>8^r[(me^(192|Ee>>6&31))&255],me=me>>>8^r[(me^(128|Ee&63))&255]):Ee>=55296&&Ee<57344?(Ee=(Ee&1023)+64,ke=Y.charCodeAt(de++)&1023,me=me>>>8^r[(me^(240|Ee>>8&7))&255],me=me>>>8^r[(me^(128|Ee>>2&63))&255],me=me>>>8^r[(me^(128|ke>>6&15|(Ee&3)<<4))&255],me=me>>>8^r[(me^(128|ke&63))&255]):(me=me>>>8^r[(me^(224|Ee>>12&15))&255],me=me>>>8^r[(me^(128|Ee>>6&63))&255],me=me>>>8^r[(me^(128|Ee&63))&255]);return~me}return t.table=r,t.bstr=U,t.buf=X,t.str=te,t}(),Zn=function(){var e={};e.version="1.2.1";function r(ee,ge){for(var ae=ee.split("/"),le=ge.split("/"),ue=0,pe=0,Le=Math.min(ae.length,le.length);ue<Le;++ue){if(pe=ae[ue].length-le[ue].length)return pe;if(ae[ue]!=le[ue])return ae[ue]<le[ue]?-1:1}return ae.length-le.length}function i(ee){if(ee.charAt(ee.length-1)=="/")return ee.slice(0,-1).indexOf("/")===-1?ee:i(ee.slice(0,-1));var ge=ee.lastIndexOf("/");return ge===-1?ee:ee.slice(0,ge+1)}function s(ee){if(ee.charAt(ee.length-1)=="/")return s(ee.slice(0,-1));var ge=ee.lastIndexOf("/");return ge===-1?ee:ee.slice(ge+1)}function n(ee,ge){typeof ge=="string"&&(ge=new Date(ge));var ae=ge.getHours();ae=ae<<6|ge.getMinutes(),ae=ae<<5|ge.getSeconds()>>>1,ee.write_shift(2,ae);var le=ge.getFullYear()-1980;le=le<<4|ge.getMonth()+1,le=le<<5|ge.getDate(),ee.write_shift(2,le)}function o(ee){var ge=ee.read_shift(2)&65535,ae=ee.read_shift(2)&65535,le=new Date,ue=ae&31;ae>>>=5;var pe=ae&15;ae>>>=4,le.setMilliseconds(0),le.setFullYear(ae+1980),le.setMonth(pe-1),le.setDate(ue);var Le=ge&31;ge>>>=5;var Ye=ge&63;return ge>>>=6,le.setHours(ge),le.setMinutes(Ye),le.setSeconds(Le<<1),le}function l(ee){qa(ee,0);for(var ge={},ae=0;ee.l<=ee.length-4;){var le=ee.read_shift(2),ue=ee.read_shift(2),pe=ee.l+ue,Le={};switch(le){case 21589:ae=ee.read_shift(1),ae&1&&(Le.mtime=ee.read_shift(4)),ue>5&&(ae&2&&(Le.atime=ee.read_shift(4)),ae&4&&(Le.ctime=ee.read_shift(4))),Le.mtime&&(Le.mt=new Date(Le.mtime*1e3));break}ee.l=pe,ge[le]=Le}return ge}var h;function d(){return h||(h={})}function g(ee,ge){if(ee[0]==80&&ee[1]==75)return Ju(ee,ge);if((ee[0]|32)==109&&(ee[1]|32)==105)return jc(ee,ge);if(ee.length<512)throw new Error("CFB file size "+ee.length+" < 512");var ae=3,le=512,ue=0,pe=0,Le=0,Ye=0,Ve=0,Ae=[],ie=ee.slice(0,512);qa(ie,0);var Ne=y(ie);switch(ae=Ne[0],ae){case 3:le=512;break;case 4:le=4096;break;case 0:if(Ne[1]==0)return Ju(ee,ge);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}le!==512&&(ie=ee.slice(0,le),qa(ie,28));var Qe=ee.slice(0,le);C(ie,ae);var xt=ie.read_shift(4,"i");if(ae===3&&xt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xt);ie.l+=4,Le=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),Ye=ie.read_shift(4,"i"),ue=ie.read_shift(4,"i"),Ve=ie.read_shift(4,"i"),pe=ie.read_shift(4,"i");for(var dt=-1,yt=0;yt<109&&(dt=ie.read_shift(4,"i"),!(dt<0));++yt)Ae[yt]=dt;var gr=x(ee,le);R(Ve,pe,gr,le,Ae);var _r=F(gr,Le,Ae,le);_r[Le].name="!Directory",ue>0&&Ye!==ke&&(_r[Ye].name="!MiniFAT"),_r[Ae[0]].name="!FAT",_r.fat_addrs=Ae,_r.ssz=le;var Vr={},mn=[],Mr=[],ul=[];D(Le,_r,gr,mn,ue,Vr,Mr,Ye),_(Mr,ul,mn),mn.shift();var pf={FileIndex:Mr,FullPaths:ul};return ge&&ge.raw&&(pf.raw={header:Qe,sectors:gr}),pf}function y(ee){if(ee[ee.l]==80&&ee[ee.l+1]==75)return[0,0];ee.chk(nt,"Header Signature: "),ee.l+=16;var ge=ee.read_shift(2,"u");return[ee.read_shift(2,"u"),ge]}function C(ee,ge){var ae=9;switch(ee.l+=2,ae=ee.read_shift(2)){case 9:if(ge!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(ge!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}ee.chk("0600","Mini Sector Shift: "),ee.chk("000000000000","Reserved: ")}function x(ee,ge){for(var ae=Math.ceil(ee.length/ge)-1,le=[],ue=1;ue<ae;++ue)le[ue-1]=ee.slice(ue*ge,(ue+1)*ge);return le[ae-1]=ee.slice(ae*ge),le}function _(ee,ge,ae){for(var le=0,ue=0,pe=0,Le=0,Ye=0,Ve=ae.length,Ae=[],ie=[];le<Ve;++le)Ae[le]=ie[le]=le,ge[le]=ae[le];for(;Ye<ie.length;++Ye)le=ie[Ye],ue=ee[le].L,pe=ee[le].R,Le=ee[le].C,Ae[le]===le&&(ue!==-1&&Ae[ue]!==ue&&(Ae[le]=Ae[ue]),pe!==-1&&Ae[pe]!==pe&&(Ae[le]=Ae[pe])),Le!==-1&&(Ae[Le]=le),ue!==-1&&le!=Ae[le]&&(Ae[ue]=Ae[le],ie.lastIndexOf(ue)<Ye&&ie.push(ue)),pe!==-1&&le!=Ae[le]&&(Ae[pe]=Ae[le],ie.lastIndexOf(pe)<Ye&&ie.push(pe));for(le=1;le<Ve;++le)Ae[le]===le&&(pe!==-1&&Ae[pe]!==pe?Ae[le]=Ae[pe]:ue!==-1&&Ae[ue]!==ue&&(Ae[le]=Ae[ue]));for(le=1;le<Ve;++le)if(ee[le].type!==0){if(Ye=le,Ye!=Ae[Ye])do Ye=Ae[Ye],ge[le]=ge[Ye]+"/"+ge[le];while(Ye!==0&&Ae[Ye]!==-1&&Ye!=Ae[Ye]);Ae[le]=-1}for(ge[0]+="/",le=1;le<Ve;++le)ee[le].type!==2&&(ge[le]+="/")}function E(ee,ge,ae){for(var le=ee.start,ue=ee.size,pe=[],Le=le;ae&&ue>0&&Le>=0;)pe.push(ge.slice(Le*Ee,Le*Ee+Ee)),ue-=Ee,Le=Z0(ae,Le*4);return pe.length===0?st(0):ro(pe).slice(0,ee.size)}function R(ee,ge,ae,le,ue){var pe=ke;if(ee===ke){if(ge!==0)throw new Error("DIFAT chain shorter than expected")}else if(ee!==-1){var Le=ae[ee],Ye=(le>>>2)-1;if(!Le)return;for(var Ve=0;Ve<Ye&&(pe=Z0(Le,Ve*4))!==ke;++Ve)ue.push(pe);R(Z0(Le,le-4),ge-1,ae,le,ue)}}function I(ee,ge,ae,le,ue){var pe=[],Le=[];ue||(ue=[]);var Ye=le-1,Ve=0,Ae=0;for(Ve=ge;Ve>=0;){ue[Ve]=!0,pe[pe.length]=Ve,Le.push(ee[Ve]);var ie=ae[Math.floor(Ve*4/le)];if(Ae=Ve*4&Ye,le<4+Ae)throw new Error("FAT boundary crossed: "+Ve+" 4 "+le);if(!ee[ie])break;Ve=Z0(ee[ie],Ae)}return{nodes:pe,data:Gj([Le])}}function F(ee,ge,ae,le){var ue=ee.length,pe=[],Le=[],Ye=[],Ve=[],Ae=le-1,ie=0,Ne=0,Qe=0,xt=0;for(ie=0;ie<ue;++ie)if(Ye=[],Qe=ie+ge,Qe>=ue&&(Qe-=ue),!Le[Qe]){Ve=[];var dt=[];for(Ne=Qe;Ne>=0;){dt[Ne]=!0,Le[Ne]=!0,Ye[Ye.length]=Ne,Ve.push(ee[Ne]);var yt=ae[Math.floor(Ne*4/le)];if(xt=Ne*4&Ae,le<4+xt)throw new Error("FAT boundary crossed: "+Ne+" 4 "+le);if(!ee[yt]||(Ne=Z0(ee[yt],xt),dt[Ne]))break}pe[Qe]={nodes:Ye,data:Gj([Ve])}}return pe}function D(ee,ge,ae,le,ue,pe,Le,Ye){for(var Ve=0,Ae=le.length?2:0,ie=ge[ee].data,Ne=0,Qe=0,xt;Ne<ie.length;Ne+=128){var dt=ie.slice(Ne,Ne+128);qa(dt,64),Qe=dt.read_shift(2),xt=V6(dt,0,Qe-Ae),le.push(xt);var yt={name:xt,type:dt.read_shift(1),color:dt.read_shift(1),L:dt.read_shift(4,"i"),R:dt.read_shift(4,"i"),C:dt.read_shift(4,"i"),clsid:dt.read_shift(16),state:dt.read_shift(4,"i"),start:0,size:0},gr=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);gr!==0&&(yt.ct=U(dt,dt.l-8));var _r=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);_r!==0&&(yt.mt=U(dt,dt.l-8)),yt.start=dt.read_shift(4,"i"),yt.size=dt.read_shift(4,"i"),yt.size<0&&yt.start<0&&(yt.size=yt.type=0,yt.start=ke,yt.name=""),yt.type===5?(Ve=yt.start,ue>0&&Ve!==ke&&(ge[Ve].name="!StreamData")):yt.size>=4096?(yt.storage="fat",ge[yt.start]===void 0&&(ge[yt.start]=I(ae,yt.start,ge.fat_addrs,ge.ssz)),ge[yt.start].name=yt.name,yt.content=ge[yt.start].data.slice(0,yt.size)):(yt.storage="minifat",yt.size<0?yt.size=0:Ve!==ke&&yt.start!==ke&&ge[Ve]&&(yt.content=E(yt,ge[Ve].data,(ge[Ye]||{}).data))),yt.content&&qa(yt.content,0),pe[xt]=yt,Le.push(yt)}}function U(ee,ge){return new Date((Qa(ee,ge+4)/1e7*Math.pow(2,32)+Qa(ee,ge)/1e7-11644473600)*1e3)}function X(ee,ge){return d(),g(h.readFileSync(ee),ge)}function te(ee,ge){var ae=ge&&ge.type;switch(ae||kn&&Buffer.isBuffer(ee)&&(ae="buffer"),ae||"base64"){case"file":return X(ee,ge);case"base64":return g(Ec(nf(ee)),ge);case"binary":return g(Ec(ee),ge)}return g(ee,ge)}function Y(ee,ge){var ae=ge||{},le=ae.root||"Root Entry";if(ee.FullPaths||(ee.FullPaths=[]),ee.FileIndex||(ee.FileIndex=[]),ee.FullPaths.length!==ee.FileIndex.length)throw new Error("inconsistent CFB structure");ee.FullPaths.length===0&&(ee.FullPaths[0]=le+"/",ee.FileIndex[0]={name:le,type:5}),ae.CLSID&&(ee.FileIndex[0].clsid=ae.CLSID),oe(ee)}function oe(ee){var ge="Sh33tJ5";if(!Zn.find(ee,"/"+ge)){var ae=st(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,ee.FileIndex.push({name:ge,type:2,content:ae,size:4,L:69,R:69,C:69}),ee.FullPaths.push(ee.FullPaths[0]+ge),me(ee)}}function me(ee,ge){Y(ee);for(var ae=!1,le=!1,ue=ee.FullPaths.length-1;ue>=0;--ue){var pe=ee.FileIndex[ue];switch(pe.type){case 0:le?ae=!0:(ee.FileIndex.pop(),ee.FullPaths.pop());break;case 1:case 2:case 5:le=!0,isNaN(pe.R*pe.L*pe.C)&&(ae=!0),pe.R>-1&&pe.L>-1&&pe.R==pe.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!ge)){var Le=new Date(1987,1,19),Ye=0,Ve=Object.create?Object.create(null):{},Ae=[];for(ue=0;ue<ee.FullPaths.length;++ue)Ve[ee.FullPaths[ue]]=!0,ee.FileIndex[ue].type!==0&&Ae.push([ee.FullPaths[ue],ee.FileIndex[ue]]);for(ue=0;ue<Ae.length;++ue){var ie=i(Ae[ue][0]);le=Ve[ie],le||(Ae.push([ie,{name:s(ie).replace("/",""),type:1,clsid:Ze,ct:Le,mt:Le,content:null}]),Ve[ie]=!0)}for(Ae.sort(function(xt,dt){return r(xt[0],dt[0])}),ee.FullPaths=[],ee.FileIndex=[],ue=0;ue<Ae.length;++ue)ee.FullPaths[ue]=Ae[ue][0],ee.FileIndex[ue]=Ae[ue][1];for(ue=0;ue<Ae.length;++ue){var Ne=ee.FileIndex[ue],Qe=ee.FullPaths[ue];if(Ne.name=s(Qe).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||Ze,ue===0)Ne.C=Ae.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Qe.slice(-1)=="/"){for(Ye=ue+1;Ye<Ae.length&&i(ee.FullPaths[Ye])!=Qe;++Ye);for(Ne.C=Ye>=Ae.length?-1:Ye,Ye=ue+1;Ye<Ae.length&&i(ee.FullPaths[Ye])!=i(Qe);++Ye);Ne.R=Ye>=Ae.length?-1:Ye,Ne.type=1}else i(ee.FullPaths[ue+1]||"")==i(Qe)&&(Ne.R=ue+1),Ne.type=2}}}function de(ee,ge){var ae=ge||{};if(ae.fileType=="mad")return Qu(ee,ae);switch(me(ee),ae.fileType){case"zip":return fo(ee,ae)}var le=function(xt){for(var dt=0,yt=0,gr=0;gr<xt.FileIndex.length;++gr){var _r=xt.FileIndex[gr];if(_r.content){var Vr=_r.content.length;Vr>0&&(Vr<4096?dt+=Vr+63>>6:yt+=Vr+511>>9)}}for(var mn=xt.FullPaths.length+3>>2,Mr=dt+7>>3,ul=dt+127>>7,pf=Mr+yt+mn+ul,Na=pf+127>>7,ui=Na<=109?0:Math.ceil((Na-109)/127);pf+Na+ui+127>>7>Na;)ui=++Na<=109?0:Math.ceil((Na-109)/127);var Xl=[1,ui,Na,ul,mn,yt,dt,0];return xt.FileIndex[0].size=dt<<6,Xl[7]=(xt.FileIndex[0].start=Xl[0]+Xl[1]+Xl[2]+Xl[3]+Xl[4]+Xl[5])+(Xl[6]+7>>3),Xl}(ee),ue=st(le[7]<<9),pe=0,Le=0;{for(pe=0;pe<8;++pe)ue.write_shift(1,at[pe]);for(pe=0;pe<8;++pe)ue.write_shift(2,0);for(ue.write_shift(2,62),ue.write_shift(2,3),ue.write_shift(2,65534),ue.write_shift(2,9),ue.write_shift(2,6),pe=0;pe<3;++pe)ue.write_shift(2,0);for(ue.write_shift(4,0),ue.write_shift(4,le[2]),ue.write_shift(4,le[0]+le[1]+le[2]+le[3]-1),ue.write_shift(4,0),ue.write_shift(4,4096),ue.write_shift(4,le[3]?le[0]+le[1]+le[2]-1:ke),ue.write_shift(4,le[3]),ue.write_shift(-4,le[1]?le[0]-1:ke),ue.write_shift(4,le[1]),pe=0;pe<109;++pe)ue.write_shift(-4,pe<le[2]?le[1]+pe:-1)}if(le[1])for(Le=0;Le<le[1];++Le){for(;pe<236+Le*127;++pe)ue.write_shift(-4,pe<le[2]?le[1]+pe:-1);ue.write_shift(-4,Le===le[1]-1?ke:Le+1)}var Ye=function(xt){for(Le+=xt;pe<Le-1;++pe)ue.write_shift(-4,pe+1);xt&&(++pe,ue.write_shift(-4,ke))};for(Le=pe=0,Le+=le[1];pe<Le;++pe)ue.write_shift(-4,Xe.DIFSECT);for(Le+=le[2];pe<Le;++pe)ue.write_shift(-4,Xe.FATSECT);Ye(le[3]),Ye(le[4]);for(var Ve=0,Ae=0,ie=ee.FileIndex[0];Ve<ee.FileIndex.length;++Ve)ie=ee.FileIndex[Ve],ie.content&&(Ae=ie.content.length,!(Ae<4096)&&(ie.start=Le,Ye(Ae+511>>9)));for(Ye(le[6]+7>>3);ue.l&511;)ue.write_shift(-4,Xe.ENDOFCHAIN);for(Le=pe=0,Ve=0;Ve<ee.FileIndex.length;++Ve)ie=ee.FileIndex[Ve],ie.content&&(Ae=ie.content.length,!(!Ae||Ae>=4096)&&(ie.start=Le,Ye(Ae+63>>6)));for(;ue.l&511;)ue.write_shift(-4,Xe.ENDOFCHAIN);for(pe=0;pe<le[4]<<2;++pe){var Ne=ee.FullPaths[pe];if(!Ne||Ne.length===0){for(Ve=0;Ve<17;++Ve)ue.write_shift(4,0);for(Ve=0;Ve<3;++Ve)ue.write_shift(4,-1);for(Ve=0;Ve<12;++Ve)ue.write_shift(4,0);continue}ie=ee.FileIndex[pe],pe===0&&(ie.start=ie.size?ie.start-1:ke);var Qe=pe===0&&ae.root||ie.name;if(Ae=2*(Qe.length+1),ue.write_shift(64,Qe,"utf16le"),ue.write_shift(2,Ae),ue.write_shift(1,ie.type),ue.write_shift(1,ie.color),ue.write_shift(-4,ie.L),ue.write_shift(-4,ie.R),ue.write_shift(-4,ie.C),ie.clsid)ue.write_shift(16,ie.clsid,"hex");else for(Ve=0;Ve<4;++Ve)ue.write_shift(4,0);ue.write_shift(4,ie.state||0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,ie.start),ue.write_shift(4,ie.size),ue.write_shift(4,0)}for(pe=1;pe<ee.FileIndex.length;++pe)if(ie=ee.FileIndex[pe],ie.size>=4096)if(ue.l=ie.start+1<<9,kn&&Buffer.isBuffer(ie.content))ie.content.copy(ue,ue.l,0,ie.size),ue.l+=ie.size+511&-512;else{for(Ve=0;Ve<ie.size;++Ve)ue.write_shift(1,ie.content[Ve]);for(;Ve&511;++Ve)ue.write_shift(1,0)}for(pe=1;pe<ee.FileIndex.length;++pe)if(ie=ee.FileIndex[pe],ie.size>0&&ie.size<4096)if(kn&&Buffer.isBuffer(ie.content))ie.content.copy(ue,ue.l,0,ie.size),ue.l+=ie.size+63&-64;else{for(Ve=0;Ve<ie.size;++Ve)ue.write_shift(1,ie.content[Ve]);for(;Ve&63;++Ve)ue.write_shift(1,0)}if(kn)ue.l=ue.length;else for(;ue.l<ue.length;)ue.write_shift(1,0);return ue}function ye(ee,ge){var ae=ee.FullPaths.map(function(Ve){return Ve.toUpperCase()}),le=ae.map(function(Ve){var Ae=Ve.split("/");return Ae[Ae.length-(Ve.slice(-1)=="/"?2:1)]}),ue=!1;ge.charCodeAt(0)===47?(ue=!0,ge=ae[0].slice(0,-1)+ge):ue=ge.indexOf("/")!==-1;var pe=ge.toUpperCase(),Le=ue===!0?ae.indexOf(pe):le.indexOf(pe);if(Le!==-1)return ee.FileIndex[Le];var Ye=!pe.match(c2);for(pe=pe.replace(Ey,""),Ye&&(pe=pe.replace(c2,"!")),Le=0;Le<ae.length;++Le)if((Ye?ae[Le].replace(c2,"!"):ae[Le]).replace(Ey,"")==pe||(Ye?le[Le].replace(c2,"!"):le[Le]).replace(Ey,"")==pe)return ee.FileIndex[Le];return null}var Ee=64,ke=-2,nt="d0cf11e0a1b11ae1",at=[208,207,17,224,161,177,26,225],Ze="00000000000000000000000000000000",Xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ke,FREESECT:-1,HEADER_SIGNATURE:nt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ze,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(ee,ge,ae){d();var le=de(ee,ae);h.writeFileSync(ge,le)}function Be(ee){for(var ge=new Array(ee.length),ae=0;ae<ee.length;++ae)ge[ae]=String.fromCharCode(ee[ae]);return ge.join("")}function Me(ee,ge){var ae=de(ee,ge);switch(ge&&ge.type||"buffer"){case"file":return d(),h.writeFileSync(ge.filename,ae),ae;case"binary":return typeof ae=="string"?ae:Be(ae);case"base64":return yC(typeof ae=="string"?ae:Be(ae));case"buffer":if(kn)return Buffer.isBuffer(ae)?ae:df(ae);case"array":return typeof ae=="string"?Ec(ae):ae}return ae}var A;function O(ee){try{var ge=ee.InflateRaw,ae=new ge;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)A=ee;else throw new Error("zlib does not expose bytesRead")}catch(le){console.error("cannot use native zlib: "+(le.message||le))}}function N(ee,ge){if(!A)return li(ee,ge);var ae=A.InflateRaw,le=new ae,ue=le._processChunk(ee.slice(ee.l),le._finishFlushFlag);return ee.l+=le.bytesRead,ue}function H(ee){return A?A.deflateRawSync(ee):Si(ee)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(ee){var ge=(ee<<1|ee<<11)&139536|(ee<<5|ee<<15)&558144;return(ge>>16|ge>>8|ge)&255}for(var Ce=typeof Uint8Array<"u",z=Ce?new Uint8Array(256):[],q=0;q<256;++q)z[q]=we(q);function re(ee,ge){var ae=z[ee&255];return ge<=8?ae>>>8-ge:(ae=ae<<8|z[ee>>8&255],ge<=16?ae>>>16-ge:(ae=ae<<8|z[ee>>16&255],ae>>>24-ge))}function ve(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=6?0:ee[le+1]<<8))>>>ae&3}function ce(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=5?0:ee[le+1]<<8))>>>ae&7}function Re(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=4?0:ee[le+1]<<8))>>>ae&15}function Oe(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=3?0:ee[le+1]<<8))>>>ae&31}function he(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=1?0:ee[le+1]<<8))>>>ae&127}function Ie(ee,ge,ae){var le=ge&7,ue=ge>>>3,pe=(1<<ae)-1,Le=ee[ue]>>>le;return ae<8-le||(Le|=ee[ue+1]<<8-le,ae<16-le)||(Le|=ee[ue+2]<<16-le,ae<24-le)||(Le|=ee[ue+3]<<24-le),Le&pe}function De(ee,ge,ae){var le=ge&7,ue=ge>>>3;return le<=5?ee[ue]|=(ae&7)<<le:(ee[ue]|=ae<<le&255,ee[ue+1]=(ae&7)>>8-le),ge+3}function $e(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae=(ae&1)<<le,ee[ue]|=ae,ge+1}function qe(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae<<=le,ee[ue]|=ae&255,ae>>>=8,ee[ue+1]=ae,ge+8}function Ft(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae<<=le,ee[ue]|=ae&255,ae>>>=8,ee[ue+1]=ae&255,ee[ue+2]=ae>>>8,ge+16}function bt(ee,ge){var ae=ee.length,le=2*ae>ge?2*ae:ge+5,ue=0;if(ae>=ge)return ee;if(kn){var pe=Pj(le);if(ee.copy)ee.copy(pe);else for(;ue<ee.length;++ue)pe[ue]=ee[ue];return pe}else if(Ce){var Le=new Uint8Array(le);if(Le.set)Le.set(ee);else for(;ue<ae;++ue)Le[ue]=ee[ue];return Le}return ee.length=le,ee}function Gt(ee){for(var ge=new Array(ee),ae=0;ae<ee;++ae)ge[ae]=0;return ge}function Lr(ee,ge,ae){var le=1,ue=0,pe=0,Le=0,Ye=0,Ve=ee.length,Ae=Ce?new Uint16Array(32):Gt(32);for(pe=0;pe<32;++pe)Ae[pe]=0;for(pe=Ve;pe<ae;++pe)ee[pe]=0;Ve=ee.length;var ie=Ce?new Uint16Array(Ve):Gt(Ve);for(pe=0;pe<Ve;++pe)Ae[ue=ee[pe]]++,le<ue&&(le=ue),ie[pe]=0;for(Ae[0]=0,pe=1;pe<=le;++pe)Ae[pe+16]=Ye=Ye+Ae[pe-1]<<1;for(pe=0;pe<Ve;++pe)Ye=ee[pe],Ye!=0&&(ie[pe]=Ae[Ye+16]++);var Ne=0;for(pe=0;pe<Ve;++pe)if(Ne=ee[pe],Ne!=0)for(Ye=re(ie[pe],le)>>le-Ne,Le=(1<<le+4-Ne)-1;Le>=0;--Le)ge[Ye|Le<<Ne]=Ne&15|pe<<4;return le}var Or=Ce?new Uint16Array(512):Gt(512),sr=Ce?new Uint16Array(32):Gt(32);if(!Ce){for(var er=0;er<512;++er)Or[er]=0;for(er=0;er<32;++er)sr[er]=0}(function(){for(var ee=[],ge=0;ge<32;ge++)ee.push(5);Lr(ee,sr,32);var ae=[];for(ge=0;ge<=143;ge++)ae.push(8);for(;ge<=255;ge++)ae.push(9);for(;ge<=279;ge++)ae.push(7);for(;ge<=287;ge++)ae.push(8);Lr(ae,Or,288)})();var Hn=function(){for(var ge=Ce?new Uint8Array(32768):[],ae=0,le=0;ae<Z.length-1;++ae)for(;le<Z[ae+1];++le)ge[le]=ae;for(;le<32768;++le)ge[le]=29;var ue=Ce?new Uint8Array(259):[];for(ae=0,le=0;ae<K.length-1;++ae)for(;le<K[ae+1];++le)ue[le]=ae;function pe(Ye,Ve){for(var Ae=0;Ae<Ye.length;){var ie=Math.min(65535,Ye.length-Ae),Ne=Ae+ie==Ye.length;for(Ve.write_shift(1,+Ne),Ve.write_shift(2,ie),Ve.write_shift(2,~ie&65535);ie-- >0;)Ve[Ve.l++]=Ye[Ae++]}return Ve.l}function Le(Ye,Ve){for(var Ae=0,ie=0,Ne=Ce?new Uint16Array(32768):[];ie<Ye.length;){var Qe=Math.min(65535,Ye.length-ie);if(Qe<10){for(Ae=De(Ve,Ae,+(ie+Qe==Ye.length)),Ae&7&&(Ae+=8-(Ae&7)),Ve.l=Ae/8|0,Ve.write_shift(2,Qe),Ve.write_shift(2,~Qe&65535);Qe-- >0;)Ve[Ve.l++]=Ye[ie++];Ae=Ve.l*8;continue}Ae=De(Ve,Ae,+(ie+Qe==Ye.length)+2);for(var xt=0;Qe-- >0;){var dt=Ye[ie];xt=(xt<<5^dt)&32767;var yt=-1,gr=0;if((yt=Ne[xt])&&(yt|=ie&-32768,yt>ie&&(yt-=32768),yt<ie))for(;Ye[yt+gr]==Ye[ie+gr]&&gr<250;)++gr;if(gr>2){dt=ue[gr],dt<=22?Ae=qe(Ve,Ae,z[dt+1]>>1)-1:(qe(Ve,Ae,3),Ae+=5,qe(Ve,Ae,z[dt-23]>>5),Ae+=3);var _r=dt<8?0:dt-4>>2;_r>0&&(Ft(Ve,Ae,gr-K[dt]),Ae+=_r),dt=ge[ie-yt],Ae=qe(Ve,Ae,z[dt]>>3),Ae-=3;var Vr=dt<4?0:dt-2>>1;Vr>0&&(Ft(Ve,Ae,ie-yt-Z[dt]),Ae+=Vr);for(var mn=0;mn<gr;++mn)Ne[xt]=ie&32767,xt=(xt<<5^Ye[ie])&32767,++ie;Qe-=gr-1}else dt<=143?dt=dt+48:Ae=$e(Ve,Ae,1),Ae=qe(Ve,Ae,z[dt]),Ne[xt]=ie&32767,++ie}Ae=qe(Ve,Ae,0)-1}return Ve.l=(Ae+7)/8|0,Ve.l}return function(Ve,Ae){return Ve.length<8?pe(Ve,Ae):Le(Ve,Ae)}}();function Si(ee){var ge=st(50+Math.floor(ee.length*1.1)),ae=Hn(ee,ge);return ge.slice(0,ae)}var et=Ce?new Uint16Array(32768):Gt(32768),ot=Ce?new Uint16Array(32768):Gt(32768),ft=Ce?new Uint16Array(128):Gt(128),Nt=1,vr=1;function cr(ee,ge){var ae=Oe(ee,ge)+257;ge+=5;var le=Oe(ee,ge)+1;ge+=5;var ue=Re(ee,ge)+4;ge+=4;for(var pe=0,Le=Ce?new Uint8Array(19):Gt(19),Ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ve=1,Ae=Ce?new Uint8Array(8):Gt(8),ie=Ce?new Uint8Array(8):Gt(8),Ne=Le.length,Qe=0;Qe<ue;++Qe)Le[B[Qe]]=pe=ce(ee,ge),Ve<pe&&(Ve=pe),Ae[pe]++,ge+=3;var xt=0;for(Ae[0]=0,Qe=1;Qe<=Ve;++Qe)ie[Qe]=xt=xt+Ae[Qe-1]<<1;for(Qe=0;Qe<Ne;++Qe)(xt=Le[Qe])!=0&&(Ye[Qe]=ie[xt]++);var dt=0;for(Qe=0;Qe<Ne;++Qe)if(dt=Le[Qe],dt!=0){xt=z[Ye[Qe]]>>8-dt;for(var yt=(1<<7-dt)-1;yt>=0;--yt)ft[xt|yt<<dt]=dt&7|Qe<<3}var gr=[];for(Ve=1;gr.length<ae+le;)switch(xt=ft[he(ee,ge)],ge+=xt&7,xt>>>=3){case 16:for(pe=3+ve(ee,ge),ge+=2,xt=gr[gr.length-1];pe-- >0;)gr.push(xt);break;case 17:for(pe=3+ce(ee,ge),ge+=3;pe-- >0;)gr.push(0);break;case 18:for(pe=11+he(ee,ge),ge+=7;pe-- >0;)gr.push(0);break;default:gr.push(xt),Ve<xt&&(Ve=xt);break}var _r=gr.slice(0,ae),Vr=gr.slice(ae);for(Qe=ae;Qe<286;++Qe)_r[Qe]=0;for(Qe=le;Qe<30;++Qe)Vr[Qe]=0;return Nt=Lr(_r,et,286),vr=Lr(Vr,ot,30),ge}function Tr(ee,ge){if(ee[0]==3&&!(ee[1]&3))return[Ng(ge),2];for(var ae=0,le=0,ue=Pj(ge||1<<18),pe=0,Le=ue.length>>>0,Ye=0,Ve=0;!(le&1);){if(le=ce(ee,ae),ae+=3,le>>>1)le>>1==1?(Ye=9,Ve=5):(ae=cr(ee,ae),Ye=Nt,Ve=vr);else{ae&7&&(ae+=8-(ae&7));var Ae=ee[ae>>>3]|ee[(ae>>>3)+1]<<8;if(ae+=32,Ae>0)for(!ge&&Le<pe+Ae&&(ue=bt(ue,pe+Ae),Le=ue.length);Ae-- >0;)ue[pe++]=ee[ae>>>3],ae+=8;continue}for(;;){!ge&&Le<pe+32767&&(ue=bt(ue,pe+32767),Le=ue.length);var ie=Ie(ee,ae,Ye),Ne=le>>>1==1?Or[ie]:et[ie];if(ae+=Ne&15,Ne>>>=4,!(Ne>>>8&255))ue[pe++]=Ne;else{if(Ne==256)break;Ne-=257;var Qe=Ne<8?0:Ne-4>>2;Qe>5&&(Qe=0);var xt=pe+K[Ne];Qe>0&&(xt+=Ie(ee,ae,Qe),ae+=Qe),ie=Ie(ee,ae,Ve),Ne=le>>>1==1?sr[ie]:ot[ie],ae+=Ne&15,Ne>>>=4;var dt=Ne<4?0:Ne-2>>1,yt=Z[Ne];for(dt>0&&(yt+=Ie(ee,ae,dt),ae+=dt),!ge&&Le<xt&&(ue=bt(ue,xt+100),Le=ue.length);pe<xt;)ue[pe]=ue[pe-yt],++pe}}}return ge?[ue,ae+7>>>3]:[ue.slice(0,pe),ae+7>>>3]}function li(ee,ge){var ae=ee.slice(ee.l||0),le=Tr(ae,ge);return ee.l+=le[1],le[0]}function ho(ee,ge){if(ee)typeof console<"u"&&console.error(ge);else throw new Error(ge)}function Ju(ee,ge){var ae=ee;qa(ae,0);var le=[],ue=[],pe={FileIndex:le,FullPaths:ue};Y(pe,{root:ge.root});for(var Le=ae.length-4;(ae[Le]!=80||ae[Le+1]!=75||ae[Le+2]!=5||ae[Le+3]!=6)&&Le>=0;)--Le;ae.l=Le+4,ae.l+=4;var Ye=ae.read_shift(2);ae.l+=6;var Ve=ae.read_shift(4);for(ae.l=Ve,Le=0;Le<Ye;++Le){ae.l+=20;var Ae=ae.read_shift(4),ie=ae.read_shift(4),Ne=ae.read_shift(2),Qe=ae.read_shift(2),xt=ae.read_shift(2);ae.l+=8;var dt=ae.read_shift(4),yt=l(ae.slice(ae.l+Ne,ae.l+Ne+Qe));ae.l+=Ne+Qe+xt;var gr=ae.l;ae.l=dt+4,rm(ae,Ae,ie,pe,yt),ae.l=gr}return pe}function rm(ee,ge,ae,le,ue){ee.l+=2;var pe=ee.read_shift(2),Le=ee.read_shift(2),Ye=o(ee);if(pe&8257)throw new Error("Unsupported ZIP encryption");for(var Ve=ee.read_shift(4),Ae=ee.read_shift(4),ie=ee.read_shift(4),Ne=ee.read_shift(2),Qe=ee.read_shift(2),xt="",dt=0;dt<Ne;++dt)xt+=String.fromCharCode(ee[ee.l++]);if(Qe){var yt=l(ee.slice(ee.l,ee.l+Qe));(yt[21589]||{}).mt&&(Ye=yt[21589].mt),((ue||{})[21589]||{}).mt&&(Ye=ue[21589].mt)}ee.l+=Qe;var gr=ee.slice(ee.l,ee.l+Ae);switch(Le){case 8:gr=N(ee,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Le)}var _r=!1;pe&8&&(Ve=ee.read_shift(4),Ve==134695760&&(Ve=ee.read_shift(4),_r=!0),Ae=ee.read_shift(4),ie=ee.read_shift(4)),Ae!=ge&&ho(_r,"Bad compressed size: "+ge+" != "+Ae),ie!=ae&&ho(_r,"Bad uncompressed size: "+ae+" != "+ie),ci(le,xt,gr,{unsafe:!0,mt:Ye})}function fo(ee,ge){var ae=ge||{},le=[],ue=[],pe=st(1),Le=ae.compression?8:0,Ye=0,Ve=0,Ae=0,ie=0,Ne=0,Qe=ee.FullPaths[0],xt=Qe,dt=ee.FileIndex[0],yt=[],gr=0;for(Ve=1;Ve<ee.FullPaths.length;++Ve)if(xt=ee.FullPaths[Ve].slice(Qe.length),dt=ee.FileIndex[Ve],!(!dt.size||!dt.content||xt=="Sh33tJ5")){var _r=ie,Vr=st(xt.length);for(Ae=0;Ae<xt.length;++Ae)Vr.write_shift(1,xt.charCodeAt(Ae)&127);Vr=Vr.slice(0,Vr.l),yt[Ne]=pBe.buf(dt.content,0);var mn=dt.content;Le==8&&(mn=H(mn)),pe=st(30),pe.write_shift(4,67324752),pe.write_shift(2,20),pe.write_shift(2,Ye),pe.write_shift(2,Le),dt.mt?n(pe,dt.mt):pe.write_shift(4,0),pe.write_shift(-4,yt[Ne]),pe.write_shift(4,mn.length),pe.write_shift(4,dt.content.length),pe.write_shift(2,Vr.length),pe.write_shift(2,0),ie+=pe.length,le.push(pe),ie+=Vr.length,le.push(Vr),ie+=mn.length,le.push(mn),pe=st(46),pe.write_shift(4,33639248),pe.write_shift(2,0),pe.write_shift(2,20),pe.write_shift(2,Ye),pe.write_shift(2,Le),pe.write_shift(4,0),pe.write_shift(-4,yt[Ne]),pe.write_shift(4,mn.length),pe.write_shift(4,dt.content.length),pe.write_shift(2,Vr.length),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(4,0),pe.write_shift(4,_r),gr+=pe.l,ue.push(pe),gr+=Vr.length,ue.push(Vr),++Ne}return pe=st(22),pe.write_shift(4,101010256),pe.write_shift(2,0),pe.write_shift(2,0),pe.write_shift(2,Ne),pe.write_shift(2,Ne),pe.write_shift(4,gr),pe.write_shift(4,ie),pe.write_shift(2,0),ro([ro(le),ro(ue),pe])}var gf={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function wr(ee,ge){if(ee.ctype)return ee.ctype;var ae=ee.name||"",le=ae.match(/\.([^\.]+)$/);return le&&gf[le[1]]||ge&&(le=(ae=ge).match(/[\.\\]([^\.\\])+$/),le&&gf[le[1]])?gf[le[1]]:"application/octet-stream"}function Bi(ee){for(var ge=yC(ee),ae=[],le=0;le<ge.length;le+=76)ae.push(ge.slice(le,le+76));return ae.join(`\r
`)+`\r
`}function ua(ee){var ge=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var ie=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});ge=ge.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ge.charAt(0)==`
`&&(ge="=0D"+ge.slice(1)),ge=ge.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],le=ge.split(`\r
`),ue=0;ue<le.length;++ue){var pe=le[ue];if(pe.length==0){ae.push("");continue}for(var Le=0;Le<pe.length;){var Ye=76,Ve=pe.slice(Le,Le+Ye);Ve.charAt(Ye-1)=="="?Ye--:Ve.charAt(Ye-2)=="="?Ye-=2:Ve.charAt(Ye-3)=="="&&(Ye-=3),Ve=pe.slice(Le,Le+Ye),Le+=Ye,Le<pe.length&&(Ve+="="),ae.push(Ve)}}return ae.join(`\r
`)}function ii(ee){for(var ge=[],ae=0;ae<ee.length;++ae){for(var le=ee[ae];ae<=ee.length&&le.charAt(le.length-1)=="=";)le=le.slice(0,le.length-1)+ee[++ae];ge.push(le)}for(var ue=0;ue<ge.length;++ue)ge[ue]=ge[ue].replace(/[=][0-9A-Fa-f]{2}/g,function(pe){return String.fromCharCode(parseInt(pe.slice(1),16))});return Ec(ge.join(`\r
`))}function Vd(ee,ge,ae){for(var le="",ue="",pe="",Le,Ye=0;Ye<10;++Ye){var Ve=ge[Ye];if(!Ve||Ve.match(/^\s*$/))break;var Ae=Ve.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":le=Ae[2].trim();break;case"content-type":pe=Ae[2].trim();break;case"content-transfer-encoding":ue=Ae[2].trim();break}}switch(++Ye,ue.toLowerCase()){case"base64":Le=Ec(nf(ge.slice(Ye).join("")));break;case"quoted-printable":Le=ii(ge.slice(Ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ue)}var ie=ci(ee,le.slice(ae.length),Le,{unsafe:!0});pe&&(ie.ctype=pe)}function jc(ee,ge){if(Be(ee.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=ge&&ge.root||"",le=(kn&&Buffer.isBuffer(ee)?ee.toString("binary"):Be(ee)).split(`\r
`),ue=0,pe="";for(ue=0;ue<le.length;++ue)if(pe=le[ue],!!/^Content-Location:/i.test(pe)&&(pe=pe.slice(pe.indexOf("file")),ae||(ae=pe.slice(0,pe.lastIndexOf("/")+1)),pe.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),pe.slice(0,ae.length)!=ae););var Le=(le[1]||"").match(/boundary="(.*?)"/);if(!Le)throw new Error("MAD cannot find boundary");var Ye="--"+(Le[1]||""),Ve=[],Ae=[],ie={FileIndex:Ve,FullPaths:Ae};Y(ie);var Ne,Qe=0;for(ue=0;ue<le.length;++ue){var xt=le[ue];xt!==Ye&&xt!==Ye+"--"||(Qe++&&Vd(ie,le.slice(Ne,ue),ae),Ne=ue)}return ie}function Qu(ee,ge){var ae=ge||{},le=ae.boundary||"SheetJS";le="------="+le;for(var ue=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+le.slice(2)+'"',"","",""],pe=ee.FullPaths[0],Le=pe,Ye=ee.FileIndex[0],Ve=1;Ve<ee.FullPaths.length;++Ve)if(Le=ee.FullPaths[Ve].slice(pe.length),Ye=ee.FileIndex[Ve],!(!Ye.size||!Ye.content||Le=="Sh33tJ5")){Le=Le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gr){return"_x"+gr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gr){return"_u"+gr.charCodeAt(0).toString(16)+"_"});for(var Ae=Ye.content,ie=kn&&Buffer.isBuffer(Ae)?Ae.toString("binary"):Be(Ae),Ne=0,Qe=Math.min(1024,ie.length),xt=0,dt=0;dt<=Qe;++dt)(xt=ie.charCodeAt(dt))>=32&&xt<128&&++Ne;var yt=Ne>=Qe*4/5;ue.push(le),ue.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+Le),ue.push("Content-Transfer-Encoding: "+(yt?"quoted-printable":"base64")),ue.push("Content-Type: "+wr(Ye,Le)),ue.push(""),ue.push(yt?ua(ie):Bi(ie))}return ue.push(le+`--\r
`),ue.join(`\r
`)}function Zu(ee){var ge={};return Y(ge,ee),ge}function ci(ee,ge,ae,le){var ue=le&&le.unsafe;ue||Y(ee);var pe=!ue&&Zn.find(ee,ge);if(!pe){var Le=ee.FullPaths[0];ge.slice(0,Le.length)==Le?Le=ge:(Le.slice(-1)!="/"&&(Le+="/"),Le=(Le+ge).replace("//","/")),pe={name:s(ge),type:2},ee.FileIndex.push(pe),ee.FullPaths.push(Le),ue||Zn.utils.cfb_gc(ee)}return pe.content=ae,pe.size=ae?ae.length:0,le&&(le.CLSID&&(pe.clsid=le.CLSID),le.mt&&(pe.mt=le.mt),le.ct&&(pe.ct=le.ct)),pe}function Ys(ee,ge){Y(ee);var ae=Zn.find(ee,ge);if(ae){for(var le=0;le<ee.FileIndex.length;++le)if(ee.FileIndex[le]==ae)return ee.FileIndex.splice(le,1),ee.FullPaths.splice(le,1),!0}return!1}function mf(ee,ge,ae){Y(ee);var le=Zn.find(ee,ge);if(le){for(var ue=0;ue<ee.FileIndex.length;++ue)if(ee.FileIndex[ue]==le)return ee.FileIndex[ue].name=s(ae),ee.FullPaths[ue]=ae,!0}return!1}function Wd(ee){me(ee,!0)}return e.find=ye,e.read=te,e.parse=g,e.write=Me,e.writeFile=Pe,e.utils={cfb_new:Zu,cfb_add:ci,cfb_del:Ys,cfb_mov:mf,cfb_gc:Wd,ReadShift:_y,CheckField:yee,prep_blob:qa,bconcat:ro,use_zlib:O,_deflateRaw:Si,_inflateRaw:li,consts:Xe},e}();function vBe(t){return typeof t=="string"?gR(t):Array.isArray(t)?j9e(t):t}function dS(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=gR(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var i=r=="utf8"?SC(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,t);if(typeof Blob<"u"){var s=new Blob([vBe(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=fS(e)),l.write(e),l.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function lo(t){for(var e=Object.keys(t),r=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(t,e[i])&&r.push(e[i]);return r}function $j(t,e){for(var r=[],i=lo(t),s=0;s!==i.length;++s)r[t[i[s]][e]]==null&&(r[t[i[s]][e]]=i[s]);return r}function L6(t){for(var e=[],r=lo(t),i=0;i!==r.length;++i)e[t[r[i]]]=r[i];return e}function vR(t){for(var e=[],r=lo(t),i=0;i!==r.length;++i)e[t[r[i]]]=parseInt(r[i],10);return e}function wBe(t){for(var e=[],r=lo(t),i=0;i!==r.length;++i)e[t[r[i]]]==null&&(e[t[r[i]]]=[]),e[t[r[i]]].push(r[i]);return e}var $T=new Date(1899,11,30,0,0,0);function Fa(t,e){var r=t.getTime(),i=$T.getTime()+(t.getTimezoneOffset()-$T.getTimezoneOffset())*6e4;return(r-i)/(24*60*60*1e3)}var ree=new Date,yBe=$T.getTime()+(ree.getTimezoneOffset()-$T.getTimezoneOffset())*6e4,Bj=ree.getTimezoneOffset();function nee(t){var e=new Date;return e.setTime(t*24*60*60*1e3+yBe),e.getTimezoneOffset()!==Bj&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Bj)*6e4),e}var Vj=new Date("2017-02-19T19:06:09.000Z"),iee=isNaN(Vj.getFullYear())?new Date("2/19/17"):Vj,CBe=iee.getFullYear()==2017;function na(t,e){var r=new Date(t);if(CBe)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(iee.getFullYear()==1917&&!isNaN(r.getFullYear())){var i=r.getFullYear();return t.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function wR(t,e){if(kn&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(n){return r[n]||n})}catch{}for(var i=[],s=0;s!=t.length;++s)i.push(String.fromCharCode(t[s]));return i.join("")}function Ma(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ma(t[r]));return e}function Xi(t,e){for(var r="";r.length<e;)r+=t;return r}function Gh(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(e=Number(i)))?e/r:e}var SBe=["january","february","march","april","may","june","july","august","september","october","november","december"];function CC(t){var e=new Date(t),r=new Date(NaN),i=e.getYear(),s=e.getMonth(),n=e.getDate();if(isNaN(n))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&SBe.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return i<0||i>8099?r:(s>0||n>1)&&i!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Jr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var i;return kn?i=df(r):i=U9e(r),Zn.utils.cfb_add(t,e,i)}Zn.utils.cfb_add(t,e,r)}else t.file(e,r)}function H6(){return Zn.utils.cfb_new()}var Ss=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bBe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$6=L6(bBe),B6=/[&<>'"]/g,xBe=/[\u0000-\u0008\u000b-\u001f]/g;function Gn(t){var e=t+"";return e.replace(B6,function(r){return $6[r]}).replace(xBe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Wj(t){return Gn(t).replace(/ /g,"_x0020_")}var see=/[\u0000-\u001f]/g;function EBe(t){var e=t+"";return e.replace(B6,function(r){return $6[r]}).replace(/\n/g,"<br/>").replace(see,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function TBe(t){var e=t+"";return e.replace(B6,function(r){return $6[r]}).replace(see,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function _Be(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function RBe(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function f3(t){for(var e="",r=0,i=0,s=0,n=0,o=0,l=0;r<t.length;){if(i=t.charCodeAt(r++),i<128){e+=String.fromCharCode(i);continue}if(s=t.charCodeAt(r++),i>191&&i<224){o=(i&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(n=t.charCodeAt(r++),i<240){e+=String.fromCharCode((i&15)<<12|(s&63)<<6|n&63);continue}o=t.charCodeAt(r++),l=((i&7)<<18|(s&63)<<12|(n&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function jj(t){var e=Ng(2*t.length),r,i,s=1,n=0,o=0,l;for(i=0;i<t.length;i+=s)s=1,(l=t.charCodeAt(i))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(i+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[n++]=o&255,e[n++]=o>>>8,o=0),e[n++]=r%256,e[n++]=r>>>8;return e.slice(0,n).toString("ucs2")}function Uj(t){return df(t,"binary").toString("utf8")}var h2="foo bar baz",Ty=kn&&(Uj(h2)==f3(h2)&&Uj||jj(h2)==f3(h2)&&jj)||f3,SC=kn?function(t){return df(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,i=0,s=0;r<t.length;)switch(i=t.charCodeAt(r++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=t.charCodeAt(r++)-56320+(i<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},ABe=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)i=i.replace(t[s][0],t[s][1]);return i}}(),oee=/(^\s|\s$|\n)/;function no(t,e){return"<"+t+(e.match(oee)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function bC(t){return lo(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function kt(t,e,r){return"<"+t+(r!=null?bC(r):"")+(e!=null?(e.match(oee)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function VF(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function OBe(t,e){switch(typeof t){case"string":var r=kt("vt:lpwstr",Gn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return kt((t|0)==t?"vt:i4":"vt:r8",Gn(String(t)));case"boolean":return kt("vt:bool",t?"true":"false")}if(t instanceof Date)return kt("vt:filetime",VF(t));throw new Error("Unable to serialize "+t)}var js={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$1=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ja={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IBe(t,e){for(var r=1-2*(t[e+7]>>>7),i=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,n=5;n>=0;--n)s=s*256+t[e+n];return i==2047?s==0?r*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),r*Math.pow(2,i-52)*s)}function PBe(t,e,r){var i=(e<0||1/e==-1/0?1:0)<<7,s=0,n=0,o=i?-e:e;isFinite(o)?o==0?s=n=0:(s=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(e)?26985:0);for(var l=0;l<=5;++l,n/=256)t[r+l]=n&255;t[r+6]=(s&15)<<4|n&15,t[r+7]=s>>4|i}var zj=function(t){for(var e=[],r=10240,i=0;i<t[0].length;++i)if(t[0][i])for(var s=0,n=t[0][i].length;s<n;s+=r)e.push.apply(e,t[0][i].slice(s,s+r));return e},Gj=kn?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:df(e)})):zj(t)}:zj,Yj=function(t,e,r){for(var i=[],s=e;s<r;s+=2)i.push(String.fromCharCode(Gw(t,s)));return i.join("").replace(Ey,"")},V6=kn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ey,""):Yj(t,e,r)}:Yj,Kj=function(t,e,r){for(var i=[],s=e;s<e+r;++s)i.push(("0"+t[s].toString(16)).slice(-2));return i.join("")},aee=kn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Kj(t,e,r)}:Kj,Xj=function(t,e,r){for(var i=[],s=e;s<r;s++)i.push(String.fromCharCode(gp(t,s)));return i.join("")},gS=kn?function(e,r,i){return Buffer.isBuffer(e)?e.toString("utf8",r,i):Xj(e,r,i)}:Xj,lee=function(t,e){var r=Qa(t,e);return r>0?gS(t,e+4,e+4+r-1):""},cee=lee,uee=function(t,e){var r=Qa(t,e);return r>0?gS(t,e+4,e+4+r-1):""},hee=uee,fee=function(t,e){var r=2*Qa(t,e);return r>0?gS(t,e+4,e+4+r-1):""},dee=fee,gee=function(e,r){var i=Qa(e,r);return i>0?V6(e,r+4,r+4+i):""},mee=gee,pee=function(t,e){var r=Qa(t,e);return r>0?gS(t,e+4,e+4+r):""},vee=pee,wee=function(t,e){return IBe(t,e)},BT=wee,W6=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kn&&(cee=function(e,r){if(!Buffer.isBuffer(e))return lee(e,r);var i=e.readUInt32LE(r);return i>0?e.toString("utf8",r+4,r+4+i-1):""},hee=function(e,r){if(!Buffer.isBuffer(e))return uee(e,r);var i=e.readUInt32LE(r);return i>0?e.toString("utf8",r+4,r+4+i-1):""},dee=function(e,r){if(!Buffer.isBuffer(e))return fee(e,r);var i=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+i-1)},mee=function(e,r){if(!Buffer.isBuffer(e))return gee(e,r);var i=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+i)},vee=function(e,r){if(!Buffer.isBuffer(e))return pee(e,r);var i=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+i)},BT=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):wee(e,r)},W6=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var gp=function(t,e){return t[e]},Gw=function(t,e){return t[e+1]*256+t[e]},FBe=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Qa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Z0=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},MBe=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function _y(t,e){var r="",i,s,n=[],o,l,h,d;switch(e){case"dbcs":if(d=this.l,kn&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Gw(this,d)),d+=2;t*=2;break;case"utf8":r=gS(this,this.l,this.l+t);break;case"utf16le":t*=2,r=V6(this,this.l,this.l+t);break;case"wstr":return _y.call(this,t,"dbcs");case"lpstr-ansi":r=cee(this,this.l),t=4+Qa(this,this.l);break;case"lpstr-cp":r=hee(this,this.l),t=4+Qa(this,this.l);break;case"lpwstr":r=dee(this,this.l),t=4+2*Qa(this,this.l);break;case"lpp4":t=4+Qa(this,this.l),r=mee(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Qa(this,this.l),r=vee(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=gp(this,this.l+t++))!==0;)n.push(l2(o));r=n.join("");break;case"_wstr":for(t=0,r="";(o=Gw(this,this.l+t))!==0;)n.push(l2(o)),t+=2;t+=2,r=n.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=gp(this,d),this.l=d+1,l=_y.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),n.join("")+l;n.push(l2(Gw(this,d))),d+=2}r=n.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=gp(this,d),this.l=d+1,l=_y.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),n.join("")+l;n.push(l2(gp(this,d))),d+=1}r=n.join("");break;default:switch(t){case 1:return i=gp(this,this.l),this.l++,i;case 2:return i=(e==="i"?FBe:Gw)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(i=(t>0?Z0:MBe)(this,this.l),this.l+=4,i):(s=Qa(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=BT(this,this.l):s=BT([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=aee(this,this.l,t);break}}return this.l+=t,r}var kBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},NBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},DBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function LBe(t,e,r){var i=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)DBe(this,e.charCodeAt(s),this.l+2*s);i=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;i=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(t){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,kBe(this,e,this.l);break;case 8:if(i=8,r==="f"){PBe(this,e,this.l);break}case 16:break;case-4:i=4,NBe(this,e,this.l);break}return this.l+=i,this}function yee(t,e){var r=aee(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function qa(t,e){t.l=e,t.read_shift=_y,t.chk=yee,t.write_shift=LBe}function ju(t,e){t.l+=e}function st(t){var e=Ng(t);return qa(e,0),e}function Ia(){var t=[],e=kn?256:2048,r=function(d){var g=st(d);return qa(g,0),g},i=r(e),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i),i=null)},n=function(d){return i&&d<i.length-i.l?i:(s(),i=r(Math.max(d+1,e)))},o=function(){return s(),ro(t)},l=function(d){s(),i=d,i.l==null&&(i.l=i.length),n(e)};return{next:n,push:l,end:o,_bufs:t}}function pt(t,e,r,i){var s=+e,n;if(!isNaN(s)){i||(i=IGe[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,i>=128&&++n,i>=16384&&++n,i>=2097152&&++n;var o=t.next(n);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(i>=128)o.write_shift(1,(i&127)+128),i>>=7;else{o.write_shift(1,i);break}i>0&&W6(r)&&t.push(r)}}function Ry(t,e,r){var i=Ma(t);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function qj(t,e,r){var i=Ma(t);return i.s=Ry(i.s,e.s,r),i.e=Ry(i.e,e.s,r),i}function Ay(t,e){if(t.cRel&&t.c<0)for(t=Ma(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ma(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Kn(t);return!t.cRel&&t.cRel!=null&&(r=BBe(r)),!t.rRel&&t.rRel!=null&&(r=HBe(r)),r}function d3(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ko(t.s.c)+":"+(t.e.cRel?"":"$")+ko(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+oo(t.s.r)+":"+(t.e.rRel?"":"$")+oo(t.e.r):Ay(t.s,e.biff)+":"+Ay(t.e,e.biff)}function j6(t){return parseInt($Be(t),10)-1}function oo(t){return""+(t+1)}function HBe(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $Be(t){return t.replace(/\$(\d+)$/,"$1")}function U6(t){for(var e=VBe(t),r=0,i=0;i!==e.length;++i)r=26*r+e.charCodeAt(i)-64;return r-1}function ko(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function BBe(t){return t.replace(/^([A-Z])/,"$$$1")}function VBe(t){return t.replace(/^\$([A-Z])/,"$1")}function WBe(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Us(t){for(var e=0,r=0,i=0;i<t.length;++i){var s=t.charCodeAt(i);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Kn(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ol(t){var e=t.indexOf(":");return e==-1?{s:Us(t),e:Us(t)}:{s:Us(t.slice(0,e)),e:Us(t.slice(e+1))}}function ps(t,e){return typeof e>"u"||typeof e=="number"?ps(t.s,t.e):(typeof t!="string"&&(t=Kn(t)),typeof e!="string"&&(e=Kn(e)),t==e?t:t+":"+e)}function yi(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,s=0,n=t.length;for(r=0;i<n&&!((s=t.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(e.s.c=--r,r=0;i<n&&!((s=t.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;if(e.s.r=--r,i===n||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,r=0;i!=n&&!((s=t.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(e.e.c=--r,r=0;i!=n&&!((s=t.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;return e.e.r=--r,e}function Jj(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Id(t.z,r?Fa(e):e)}catch{}try{return t.w=Id((t.XF||{}).numFmtId||(r?14:0),r?Fa(e):e)}catch{return""+e}}function sf(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mS[t.v]||t.v:e==null?Jj(t,t.v):Jj(t,e))}function Jg(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",i={};return i[r]=t,{SheetNames:[r],Sheets:i}}function Cee(t,e,r){var i=r||{},s=t?Array.isArray(t):i.dense,n=t||(s?[]:{}),o=0,l=0;if(n&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?Us(i.origin):i.origin;o=h.r,l=h.c}n["!ref"]||(n["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var g=yi(n["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(d.e.r=o=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var C=0;C!=e[y].length;++C)if(!(typeof e[y][C]>"u")){var x={v:e[y][C]},_=o+y,E=l+C;if(d.s.r>_&&(d.s.r=_),d.s.c>E&&(d.s.c=E),d.e.r<_&&(d.e.r=_),d.e.c<E&&(d.e.c=E),e[y][C]&&typeof e[y][C]=="object"&&!Array.isArray(e[y][C])&&!(e[y][C]instanceof Date))x=e[y][C];else if(Array.isArray(x.v)&&(x.f=e[y][C][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(i.nullError)x.t="e",x.v=0;else if(i.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=i.dateNF||Qi[14],i.cellDates?(x.t="d",x.w=Id(x.z,Fa(x.v))):(x.t="n",x.v=Fa(x.v),x.w=Id(x.z,x.v))):x.t="s";if(s)n[_]||(n[_]=[]),n[_][E]&&n[_][E].z&&(x.z=n[_][E].z),n[_][E]=x;else{var R=Kn({c:E,r:_});n[R]&&n[R].z&&(x.z=n[R].z),n[R]=x}}}return d.s.c<1e7&&(n["!ref"]=ps(d)),n}function B1(t,e){return Cee(null,t,e)}function jBe(t){return t.read_shift(4,"i")}function Pc(t,e){return e||(e=st(4)),e.write_shift(4,t),e}function No(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function zs(t,e){var r=!1;return e==null&&(r=!0,e=st(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function UBe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zBe(t,e){return e||(e=st(4)),e.write_shift(2,0),e.write_shift(2,0),e}function z6(t,e){var r=t.l,i=t.read_shift(1),s=No(t),n=[],o={t:s,h:s};if(i&1){for(var l=t.read_shift(4),h=0;h!=l;++h)n.push(UBe(t));o.r=n}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function GBe(t,e){var r=!1;return e==null&&(r=!0,e=st(15+4*t.t.length)),e.write_shift(1,0),zs(t.t,e),r?e.slice(0,e.l):e}var YBe=z6;function KBe(t,e){var r=!1;return e==null&&(r=!0,e=st(23+4*t.t.length)),e.write_shift(1,1),zs(t.t,e),e.write_shift(4,1),zBe({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function Kl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qg(t,e){return e==null&&(e=st(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Zg(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function em(t,e){return e==null&&(e=st(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var XBe=No,See=zs;function G6(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function VT(t,e){var r=!1;return e==null&&(r=!0,e=st(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qBe=No,WF=G6,Y6=VT;function bee(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,i=e[0]&2;t.l+=4;var s=i===0?BT([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Z0(e,0)>>2;return r?s/100:s}function xee(t,e){e==null&&(e=st(4));var r=0,i=0,s=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?i=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(i=1,r=1),i)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Eee(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function JBe(t,e){return e||(e=st(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var tm=Eee,V1=JBe;function W1(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Dg(t,e){return(e||st(8)).write_shift(8,t,"f")}function QBe(t){var e={},r=t.read_shift(1),i=r>>>1,s=t.read_shift(1),n=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),h=t.read_shift(1);switch(t.l++,i){case 0:e.auto=1;break;case 1:e.index=s;var d=aVe[s];d&&(e.rgb=lU(d));break;case 2:e.rgb=lU([o,l,h]);break;case 3:e.theme=s;break}return n!=0&&(e.tint=n>0?n/32767:n/32768),e}function WT(t,e){if(e||(e=st(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=t.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function ZBe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eVe(t,e){e||(e=st(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var Tee=2,Ya=3,f2=11,jT=19,d2=64,tVe=65,rVe=71,nVe=4108,iVe=4126,to=80,Qj={1:{n:"CodePage",t:Tee},2:{n:"Category",t:to},3:{n:"PresentationFormat",t:to},4:{n:"ByteCount",t:Ya},5:{n:"LineCount",t:Ya},6:{n:"ParagraphCount",t:Ya},7:{n:"SlideCount",t:Ya},8:{n:"NoteCount",t:Ya},9:{n:"HiddenCount",t:Ya},10:{n:"MultimediaClipCount",t:Ya},11:{n:"ScaleCrop",t:f2},12:{n:"HeadingPairs",t:nVe},13:{n:"TitlesOfParts",t:iVe},14:{n:"Manager",t:to},15:{n:"Company",t:to},16:{n:"LinksUpToDate",t:f2},17:{n:"CharacterCount",t:Ya},19:{n:"SharedDoc",t:f2},22:{n:"HyperlinksChanged",t:f2},23:{n:"AppVersion",t:Ya,p:"version"},24:{n:"DigSig",t:tVe},26:{n:"ContentType",t:to},27:{n:"ContentStatus",t:to},28:{n:"Language",t:to},29:{n:"Version",t:to},255:{},2147483648:{n:"Locale",t:jT},2147483651:{n:"Behavior",t:jT},1919054434:{}},Zj={1:{n:"CodePage",t:Tee},2:{n:"Title",t:to},3:{n:"Subject",t:to},4:{n:"Author",t:to},5:{n:"Keywords",t:to},6:{n:"Comments",t:to},7:{n:"Template",t:to},8:{n:"LastAuthor",t:to},9:{n:"RevNumber",t:to},10:{n:"EditTime",t:d2},11:{n:"LastPrinted",t:d2},12:{n:"CreatedDate",t:d2},13:{n:"ModifiedDate",t:d2},14:{n:"PageCount",t:Ya},15:{n:"WordCount",t:Ya},16:{n:"CharCount",t:Ya},17:{n:"Thumbnail",t:rVe},18:{n:"Application",t:to},19:{n:"DocSecurity",t:Ya},255:{},2147483648:{n:"Locale",t:jT},2147483651:{n:"Behavior",t:jT},1919054434:{}};function sVe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oVe=sVe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),aVe=Ma(oVe),mS={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lVe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},g2={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function _ee(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ree(t,e){var r=wBe(lVe),i=[],s;i[i.length]=Ss,i[i.length]=kt("Types",null,{xmlns:js.CT,"xmlns:xsd":js.xsd,"xmlns:xsi":js.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return kt("Default",null,{Extension:h[0],ContentType:h[1]})}));var n=function(h){t[h]&&t[h].length>0&&(s=t[h][0],i[i.length]=kt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:g2[h][e.bookType]||g2[h].xlsx}))},o=function(h){(t[h]||[]).forEach(function(d){i[i.length]=kt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:g2[h][e.bookType]||g2[h].xlsx})})},l=function(h){(t[h]||[]).forEach(function(d){i[i.length]=kt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return n("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var _n={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Aee(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Jp(t){var e=[Ss,kt("Relationships",null,{xmlns:js.RELS})];return lo(t["!id"]).forEach(function(r){e[e.length]=kt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function zn(t,e,r,i,s,n){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=i,s.Target=r,[_n.HLINK,_n.XPATH,_n.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}function cVe(t){var e=[Ss];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function eU(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function uVe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function hVe(t){var e=[Ss];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(eU(t[r][0],t[r][1])),e.push(uVe("",t[r][0]));return e.push(eU("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Oee(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kT.version+"</meta:generator></office:meta></office:document-meta>"}var vg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function g3(t,e,r,i,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Gn(e),i[i.length]=r?kt(t,e,r):no(t,e))}function Iee(t,e){var r=e||{},i=[Ss,kt("cp:coreProperties",null,{"xmlns:cp":js.CORE_PROPS,"xmlns:dc":js.dc,"xmlns:dcterms":js.dcterms,"xmlns:dcmitype":js.dcmitype,"xmlns:xsi":js.xsi})],s={};if(!t&&!r.Props)return i.join("");t&&(t.CreatedDate!=null&&g3("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:VF(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),t.ModifiedDate!=null&&g3("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:VF(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var n=0;n!=vg.length;++n){var o=vg[n],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&g3(o[0],l,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Qp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Pee=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Fee(t){var e=[],r=kt;return t||(t={}),t.Application="SheetJS",e[e.length]=Ss,e[e.length]=kt("Properties",null,{xmlns:js.EXT_PROPS,"xmlns:vt":js.vt}),Qp.forEach(function(i){if(t[i[1]]!==void 0){var s;switch(i[2]){case"string":s=Gn(String(t[i[1]]));break;case"bool":s=t[i[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(i[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(i){return"<vt:lpstr>"+Gn(i)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function Mee(t){var e=[Ss,kt("Properties",null,{xmlns:js.CUST_PROPS,"xmlns:vt":js.vt})];if(!t)return e.join("");var r=1;return lo(t).forEach(function(s){++r,e[e.length]=kt("property",OBe(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Gn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var tU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function fVe(t,e){var r=[];return lo(tU).map(function(i){for(var s=0;s<vg.length;++s)if(vg[s][1]==i)return vg[s];for(s=0;s<Qp.length;++s)if(Qp[s][1]==i)return Qp[s];throw i}).forEach(function(i){if(t[i[1]]!=null){var s=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:t[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(no(tU[i[1]]||i[1],s))}}),kt("DocumentProperties",r.join(""),{xmlns:Ja.o})}function dVe(t,e){var r=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return t&&lo(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)){for(var o=0;o<vg.length;++o)if(n==vg[o][1])return;for(o=0;o<Qp.length;++o)if(n==Qp[o][1])return;for(o=0;o<r.length;++o)if(n==r[o])return;var l=t[n],h="string";typeof l=="number"?(h="float",l=String(l)):l===!0||l===!1?(h="boolean",l=l?"1":"0"):l=String(l),s.push(kt(Wj(n),l,{"dt:dt":h}))}}),e&&lo(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)&&!(t&&Object.prototype.hasOwnProperty.call(t,n))){var o=e[n],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(kt(Wj(n),o,{"dt:dt":l}))}}),"<"+i+' xmlns="'+Ja.o+'">'+s.join("")+"</"+i+">"}function gVe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,i=r%Math.pow(2,32),s=(r-i)/Math.pow(2,32);i*=1e7,s*=1e7;var n=i/Math.pow(2,32)|0;n>0&&(i=i%Math.pow(2,32),s+=n);var o=st(8);return o.write_shift(4,i),o.write_shift(4,s),o}function rU(t,e){var r=st(4),i=st(4);switch(r.write_shift(4,t==80?31:t),t){case 3:i.write_shift(-4,e);break;case 5:i=st(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=gVe(e);break;case 31:case 80:for(i=st(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return ro([r,i])}var kee=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mVe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function nU(t,e,r){var i=st(8),s=[],n=[],o=8,l=0,h=st(8),d=st(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),n.push(h),s.push(d),o+=8+h.length,!e){d=st(8),d.write_shift(4,0),s.unshift(d);var g=[st(4)];for(g[0].write_shift(4,t.length),l=0;l<t.length;++l){var y=t[l][0];for(h=st(8+2*(y.length+1)+(y.length%2?0:2)),h.write_shift(4,l+2),h.write_shift(4,y.length+1),h.write_shift(0,y,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=ro(g),n.unshift(h),o+=8+h.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(kee.indexOf(t[l][0])>-1||Pee.indexOf(t[l][0])>-1)&&t[l][1]!=null){var C=t[l][1],x=0;if(e){x=+e[t[l][0]];var _=r[x];if(_.p=="version"&&typeof C=="string"){var E=C.split(".");C=(+E[0]<<16)+(+E[1]||0)}h=rU(_.t,C)}else{var R=mVe(C);R==-1&&(R=31,C=String(C)),h=rU(R,C)}n.push(h),d=st(8),d.write_shift(4,e?x:2+l),s.push(d),o+=8+h.length}var I=8*(n.length+1);for(l=0;l<n.length;++l)s[l].write_shift(4,I),I+=n[l].length;return i.write_shift(4,o),i.write_shift(4,n.length),ro([i].concat(s).concat(n))}function iU(t,e,r,i,s,n){var o=st(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Zn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var h=nU(t,r,i);if(l.push(h),s){var d=nU(s,null,null);o.write_shift(16,n,"hex"),o.write_shift(4,68+h.length),l.push(d)}return ro(l)}function pVe(t,e){e||(e=st(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function vVe(t,e){return t.read_shift(e)===1}function Jo(t,e){return e||(e=st(2)),e.write_shift(2,+!!t),e}function Nee(t){return t.read_shift(2,"u")}function Pl(t,e){return e||(e=st(2)),e.write_shift(2,t),e}function Dee(t,e,r){return r||(r=st(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Lee(t,e,r){var i=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=t.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=i?t.read_shift(i,s):"";return o}function wVe(t){var e=t.t||"",r=st(3);r.write_shift(2,e.length),r.write_shift(1,1);var i=st(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[r,i];return ro(s)}function yVe(t,e,r){var i;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?i=t.read_shift(e,"sbcs-cont"):i=t.read_shift(e,"dbcs-cont"),i}function CVe(t,e,r){var i=t.read_shift(r&&r.biff==2?1:2);return i===0?(t.l++,""):yVe(t,i,r)}function SVe(t,e,r){if(r.biff>5)return CVe(t,e,r);var i=t.read_shift(1);return i===0?(t.l++,""):t.read_shift(i,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Hee(t,e,r){return r||(r=st(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function sU(t,e){e||(e=st(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function bVe(t){var e=st(512),r=0,i=t.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),n=s>-1?31:23;switch(i.charAt(0)){case"#":n=28;break;case".":n&=-3;break}e.write_shift(4,2),e.write_shift(4,n);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(n==28)i=i.slice(1),sU(i,e);else if(n&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?i.slice(0,s):i;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),n&8&&sU(s>-1?i.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var h=0;i.slice(h*3,h*3+3)=="../"||i.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,i.length-3*h+1),r=0;r<i.length-3*h;++r)e.write_shift(1,i.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Lg(t,e,r,i){return i||(i=st(6)),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,r||0),i}function xVe(t,e,r){var i=r.biff>8?4:2,s=t.read_shift(i),n=t.read_shift(i,"i"),o=t.read_shift(i,"i");return[s,n,o]}function EVe(t){var e=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);return{s:{c:i,r:e},e:{c:s,r}}}function $ee(t,e){return e||(e=st(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function K6(t,e,r){var i=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=st(s);return n.write_shift(2,i),n.write_shift(2,e),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function TVe(t,e){var r=!e||e.biff==8,i=st(r?112:54);for(i.write_shift(e.biff==8?2:1,7),r&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(r?0:536870912));i.l<i.length;)i.write_shift(1,r?0:32);return i}function _Ve(t,e){var r=!e||e.biff>=8?2:1,i=st(8+r*t.name.length);i.write_shift(4,t.pos),i.write_shift(1,t.hs||0),i.write_shift(1,t.dt),i.write_shift(1,t.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function RVe(t,e){var r=st(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var i=[],s=0;s<t.length;++s)i[s]=wVe(t[s]);var n=ro([r].concat(i));return n.parts=[r.length].concat(i.map(function(o){return o.length})),n}function AVe(){var t=st(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function OVe(t){var e=st(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function IVe(t,e){var r=t.name||"Arial",i=e.biff==5,s=i?15+r.length:16+2*r.length,n=st(s);return n.write_shift(2,(t.sz||12)*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le"),n}function PVe(t,e,r,i){var s=st(10);return Lg(t,e,i,s),s.write_shift(4,r),s}function FVe(t,e,r,i,s){var n=!s||s.biff==8,o=st(8+ +n+(1+n)*r.length);return Lg(t,e,i,o),o.write_shift(2,r.length),n&&o.write_shift(1,1),o.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),o}function MVe(t,e,r,i){var s=r.biff==5;i||(i=st(s?3+e.length:5+2*e.length)),i.write_shift(2,t),i.write_shift(s?1:2,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var n=i.length>i.l?i.slice(0,i.l):i;return n.l==null&&(n.l=n.length),n}function kVe(t,e){var r=e.biff==8||!e.biff?4:2,i=st(2*r+6);return i.write_shift(r,t.s.r),i.write_shift(r,t.e.r+1),i.write_shift(2,t.s.c),i.write_shift(2,t.e.c+1),i.write_shift(2,0),i}function oU(t,e,r,i){var s=r.biff==5;i||(i=st(s?16:20)),i.write_shift(2,0),t.style?(i.write_shift(2,t.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,t.numFmtId||0),i.write_shift(2,e<<4));var n=0;return t.numFmtId>0&&s&&(n|=1024),i.write_shift(4,n),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function NVe(t){var e=st(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function DVe(t,e,r,i,s,n){var o=st(8);return Lg(t,e,i,o),Dee(r,n,o),o}function LVe(t,e,r,i){var s=st(14);return Lg(t,e,i,s),Dg(r,s),s}function HVe(t,e,r){if(r.biff<8)return $Ve(t,e,r);for(var i=[],s=t.l+e,n=t.read_shift(r.biff>8?4:2);n--!==0;)i.push(xVe(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return i}function $Ve(t,e,r){t[t.l+1]==3&&t[t.l]++;var i=Lee(t,e,r);return i.charCodeAt(0)==3?i.slice(1):i}function BVe(t){var e=st(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)$ee(t[r],e);return e}function VVe(t){var e=st(24),r=Us(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(i[s],16));return ro([e,bVe(t[1])])}function WVe(t){var e=t[1].Tooltip,r=st(10+2*(e.length+1));r.write_shift(2,2048);var i=Us(t[0]);r.write_shift(2,i.r),r.write_shift(2,i.r),r.write_shift(2,i.c),r.write_shift(2,i.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function jVe(t){return t||(t=st(4)),t.write_shift(2,1),t.write_shift(2,1),t}function UVe(t,e,r){if(!r.cellStyles)return ju(t,e);var i=r&&r.biff>=12?4:2,s=t.read_shift(i),n=t.read_shift(i),o=t.read_shift(i),l=t.read_shift(i),h=t.read_shift(2);i==2&&(t.l+=2);var d={s,e:n,w:o,ixfe:l,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function zVe(t,e){var r=st(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var i=0;return t.hidden&&(i|=1),r.write_shift(1,i),i=t.level||0,r.write_shift(1,i),r.write_shift(2,0),r}function GVe(t){for(var e=st(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function YVe(t,e,r){var i=st(15);return vS(i,t,e),i.write_shift(8,r,"f"),i}function KVe(t,e,r){var i=st(9);return vS(i,t,e),i.write_shift(2,r),i}var XVe=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=L6({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,h){var d=[],g=Ng(1);switch(h.type){case"base64":g=Ec(nf(l));break;case"binary":g=Ec(l);break;case"buffer":case"array":g=l;break}qa(g,0);var y=g.read_shift(1),C=!!(y&136),x=!1,_=!1;switch(y){case 2:break;case 3:break;case 48:x=!0,C=!0;break;case 49:x=!0,C=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var E=0,R=521;y==2&&(E=g.read_shift(2)),g.l+=3,y!=2&&(E=g.read_shift(4)),E>1048576&&(E=1e6),y!=2&&(R=g.read_shift(2));var I=g.read_shift(2),F=h.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(F=t[g[g.l]]),g.l+=1,g.l+=2),_&&(g.l+=36);for(var D=[],U={},X=Math.min(g.length,y==2?521:R-10-(x?264:0)),te=_?32:11;g.l<X&&g[g.l]!=13;)switch(U={},U.name=NT.utils.decode(F,g.slice(g.l,g.l+te)).replace(/[\u0000\r\n].*$/g,""),g.l+=te,U.type=String.fromCharCode(g.read_shift(1)),y!=2&&!_&&(U.offset=g.read_shift(4)),U.len=g.read_shift(1),y==2&&(U.offset=g.read_shift(2)),U.dec=g.read_shift(1),U.name.length&&D.push(U),y!=2&&(g.l+=_?13:14),U.type){case"B":(!x||U.len!=8)&&h.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(g[g.l]!==13&&(g.l=R-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=R;var Y=0,oe=0;for(d[0]=[],oe=0;oe!=D.length;++oe)d[0][oe]=D[oe].name;for(;E-- >0;){if(g[g.l]===42){g.l+=I;continue}for(++g.l,d[++Y]=[],oe=0,oe=0;oe!=D.length;++oe){var me=g.slice(g.l,g.l+D[oe].len);g.l+=D[oe].len,qa(me,0);var de=NT.utils.decode(F,me);switch(D[oe].type){case"C":de.trim().length&&(d[Y][oe]=de.replace(/\s+$/,""));break;case"D":de.length===8?d[Y][oe]=new Date(+de.slice(0,4),+de.slice(4,6)-1,+de.slice(6,8)):d[Y][oe]=de;break;case"F":d[Y][oe]=parseFloat(de.trim());break;case"+":case"I":d[Y][oe]=_?me.read_shift(-4,"i")^2147483648:me.read_shift(4,"i");break;case"L":switch(de.trim().toUpperCase()){case"Y":case"T":d[Y][oe]=!0;break;case"N":case"F":d[Y][oe]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+de+"|")}break;case"M":if(!C)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));d[Y][oe]="##MEMO##"+(_?parseInt(de.trim(),10):me.read_shift(4));break;case"N":de=de.replace(/\u0000/g,"").trim(),de&&de!="."&&(d[Y][oe]=+de||0);break;case"@":d[Y][oe]=new Date(me.read_shift(-8,"f")-621356832e5);break;case"T":d[Y][oe]=new Date((me.read_shift(4)-2440588)*864e5+me.read_shift(4));break;case"Y":d[Y][oe]=me.read_shift(4,"i")/1e4+me.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[Y][oe]=-me.read_shift(-8,"f");break;case"B":if(x&&D[oe].len==8){d[Y][oe]=me.read_shift(8,"f");break}case"G":case"P":me.l+=D[oe].len;break;case"0":if(D[oe].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[oe].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=D,d}function i(l,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=B1(r(l,d),d);return g["!cols"]=d.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete d.DBF,g}function s(l,h){try{return Jg(i(l,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,h){var d=h||{};if(+d.codepage>=0&&wC(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ia(),y=KT(l,{header:1,raw:!0,cellDates:!0}),C=y[0],x=y.slice(1),_=l["!cols"]||[],E=0,R=0,I=0,F=1;for(E=0;E<C.length;++E){if(((_[E]||{}).DBF||{}).name){C[E]=_[E].DBF.name,++I;continue}if(C[E]!=null){if(++I,typeof C[E]=="number"&&(C[E]=C[E].toString(10)),typeof C[E]!="string")throw new Error("DBF Invalid column name "+C[E]+" |"+typeof C[E]+"|");if(C.indexOf(C[E])!==E){for(R=0;R<1024;++R)if(C.indexOf(C[E]+"_"+R)==-1){C[E]+="_"+R;break}}}}var D=yi(l["!ref"]),U=[],X=[],te=[];for(E=0;E<=D.e.c-D.s.c;++E){var Y="",oe="",me=0,de=[];for(R=0;R<x.length;++R)x[R][E]!=null&&de.push(x[R][E]);if(de.length==0||C[E]==null){U[E]="?";continue}for(R=0;R<de.length;++R){switch(typeof de[R]){case"number":oe="B";break;case"string":oe="C";break;case"boolean":oe="L";break;case"object":oe=de[R]instanceof Date?"D":"C";break;default:oe="C"}me=Math.max(me,String(de[R]).length),Y=Y&&Y!=oe?"C":oe}me>250&&(me=250),oe=((_[E]||{}).DBF||{}).type,oe=="C"&&_[E].DBF.len>me&&(me=_[E].DBF.len),Y=="B"&&oe=="N"&&(Y="N",te[E]=_[E].DBF.dec,me=_[E].DBF.len),X[E]=Y=="C"||oe=="N"?me:n[Y]||0,F+=X[E],U[E]=Y}var ye=g.next(32);for(ye.write_shift(4,318902576),ye.write_shift(4,x.length),ye.write_shift(2,296+32*I),ye.write_shift(2,F),E=0;E<4;++E)ye.write_shift(4,0);for(ye.write_shift(4,0|(+e[VZ]||3)<<8),E=0,R=0;E<C.length;++E)if(C[E]!=null){var Ee=g.next(32),ke=(C[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ee.write_shift(1,ke,"sbcs"),Ee.write_shift(1,U[E]=="?"?"C":U[E],"sbcs"),Ee.write_shift(4,R),Ee.write_shift(1,X[E]||n[U[E]]||0),Ee.write_shift(1,te[E]||0),Ee.write_shift(1,2),Ee.write_shift(4,0),Ee.write_shift(1,0),Ee.write_shift(4,0),Ee.write_shift(4,0),R+=X[E]||n[U[E]]||0}var nt=g.next(264);for(nt.write_shift(4,13),E=0;E<65;++E)nt.write_shift(4,0);for(E=0;E<x.length;++E){var at=g.next(F);for(at.write_shift(1,0),R=0;R<C.length;++R)if(C[R]!=null)switch(U[R]){case"L":at.write_shift(1,x[E][R]==null?63:x[E][R]?84:70);break;case"B":at.write_shift(8,x[E][R]||0,"f");break;case"N":var Ze="0";for(typeof x[E][R]=="number"&&(Ze=x[E][R].toFixed(te[R]||0)),I=0;I<X[R]-Ze.length;++I)at.write_shift(1,32);at.write_shift(1,Ze,"sbcs");break;case"D":x[E][R]?(at.write_shift(4,("0000"+x[E][R].getFullYear()).slice(-4),"sbcs"),at.write_shift(2,("00"+(x[E][R].getMonth()+1)).slice(-2),"sbcs"),at.write_shift(2,("00"+x[E][R].getDate()).slice(-2),"sbcs")):at.write_shift(8,"00000000","sbcs");break;case"C":var Xe=String(x[E][R]!=null?x[E][R]:"").slice(0,X[R]);for(at.write_shift(1,Xe,"sbcs"),I=0;I<X[R]-Xe.length;++I)at.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:s,to_sheet:i,from_sheet:o}}(),qVe=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+lo(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(C,x){var _=t[x];return typeof _=="number"?Ij(_):_},i=function(C,x,_){var E=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return E==59?C:Ij(E)};t["|"]=254;function s(C,x){switch(x.type){case"base64":return n(nf(C),x);case"binary":return n(C,x);case"buffer":return n(kn&&Buffer.isBuffer(C)?C.toString("binary"):fS(C),x);case"array":return n(wR(C),x)}throw new Error("Unrecognized type "+x.type)}function n(C,x){var _=C.split(/[\n\r]+/),E=-1,R=-1,I=0,F=0,D=[],U=[],X=null,te={},Y=[],oe=[],me=[],de=0,ye;for(+x.codepage>=0&&wC(+x.codepage);I!==_.length;++I){de=0;var Ee=_[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,r),ke=Ee.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),nt=ke[0],at;if(Ee.length>0)switch(nt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ke[1].charAt(0)=="P"&&U.push(Ee.slice(3).replace(/;;/g,";"));break;case"C":var Ze=!1,Xe=!1,Pe=!1,Be=!1,Me=-1,A=-1;for(F=1;F<ke.length;++F)switch(ke[F].charAt(0)){case"A":break;case"X":R=parseInt(ke[F].slice(1))-1,Xe=!0;break;case"Y":for(E=parseInt(ke[F].slice(1))-1,Xe||(R=0),ye=D.length;ye<=E;++ye)D[ye]=[];break;case"K":at=ke[F].slice(1),at.charAt(0)==='"'?at=at.slice(1,at.length-1):at==="TRUE"?at=!0:at==="FALSE"?at=!1:isNaN(Gh(at))?isNaN(CC(at).getDate())||(at=na(at)):(at=Gh(at),X!==null&&ZZ(X)&&(at=nee(at))),Ze=!0;break;case"E":Be=!0;var O=KWe(ke[F].slice(1),{r:E,c:R});D[E][R]=[D[E][R],O];break;case"S":Pe=!0,D[E][R]=[D[E][R],"S5S"];break;case"G":break;case"R":Me=parseInt(ke[F].slice(1))-1;break;case"C":A=parseInt(ke[F].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ee)}if(Ze&&(D[E][R]&&D[E][R].length==2?D[E][R][0]=at:D[E][R]=at,X=null),Pe){if(Be)throw new Error("SYLK shared formula cannot have own formula");var N=Me>-1&&D[Me][A];if(!N||!N[1])throw new Error("SYLK shared formula cannot find base");D[E][R][1]=XWe(N[1],{r:E-Me,c:R-A})}break;case"F":var H=0;for(F=1;F<ke.length;++F)switch(ke[F].charAt(0)){case"X":R=parseInt(ke[F].slice(1))-1,++H;break;case"Y":for(E=parseInt(ke[F].slice(1))-1,ye=D.length;ye<=E;++ye)D[ye]=[];break;case"M":de=parseInt(ke[F].slice(1))/20;break;case"F":break;case"G":break;case"P":X=U[parseInt(ke[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(me=ke[F].slice(1).split(" "),ye=parseInt(me[0],10);ye<=parseInt(me[1],10);++ye)de=parseInt(me[2],10),oe[ye-1]=de===0?{hidden:!0}:{wch:de},X6(oe[ye-1]);break;case"C":R=parseInt(ke[F].slice(1))-1,oe[R]||(oe[R]={});break;case"R":E=parseInt(ke[F].slice(1))-1,Y[E]||(Y[E]={}),de>0?(Y[E].hpt=de,Y[E].hpx=Uee(de)):de===0&&(Y[E].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ee)}H<1&&(X=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ee)}}return Y.length>0&&(te["!rows"]=Y),oe.length>0&&(te["!cols"]=oe),x&&x.sheetRows&&(D=D.slice(0,x.sheetRows)),[D,te]}function o(C,x){var _=s(C,x),E=_[0],R=_[1],I=B1(E,x);return lo(R).forEach(function(F){I[F]=R[F]}),I}function l(C,x){return Jg(o(C,x),x)}function h(C,x,_,E){var R="C;Y"+(_+1)+";X"+(E+1)+";K";switch(C.t){case"n":R+=C.v||0,C.f&&!C.F&&(R+=";E"+J6(C.f,{r:_,c:E}));break;case"b":R+=C.v?"TRUE":"FALSE";break;case"e":R+=C.w||C.v;break;case"d":R+='"'+(C.w||C.v)+'"';break;case"s":R+='"'+C.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return R}function d(C,x){x.forEach(function(_,E){var R="F;W"+(E+1)+" "+(E+1)+" ";_.hidden?R+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=UT(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=zT(_.wpx)),typeof _.wch=="number"&&(R+=Math.round(_.wch))),R.charAt(R.length-1)!=" "&&C.push(R)})}function g(C,x){x.forEach(function(_,E){var R="F;";_.hidden?R+="M0;":_.hpt?R+="M"+20*_.hpt+";":_.hpx&&(R+="M"+20*GT(_.hpx)+";"),R.length>2&&C.push(R+"R"+(E+1))})}function y(C,x){var _=["ID;PWXL;N;E"],E=[],R=yi(C["!ref"]),I,F=Array.isArray(C),D=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),C["!cols"]&&d(_,C["!cols"]),C["!rows"]&&g(_,C["!rows"]),_.push("B;Y"+(R.e.r-R.s.r+1)+";X"+(R.e.c-R.s.c+1)+";D"+[R.s.c,R.s.r,R.e.c,R.e.r].join(" "));for(var U=R.s.r;U<=R.e.r;++U)for(var X=R.s.c;X<=R.e.c;++X){var te=Kn({r:U,c:X});I=F?(C[U]||[])[X]:C[te],!(!I||I.v==null&&(!I.f||I.F))&&E.push(h(I,C,U,X))}return _.join(D)+D+E.join(D)+D+"E"+D}return{to_workbook:l,to_sheet:o,from_sheet:y}}(),JVe=function(){function t(n,o){switch(o.type){case"base64":return e(nf(n),o);case"binary":return e(n,o);case"buffer":return e(kn&&Buffer.isBuffer(n)?n.toString("binary"):fS(n),o);case"array":return e(wR(n),o)}throw new Error("Unrecognized type "+o.type)}function e(n,o){for(var l=n.split(`
`),h=-1,d=-1,g=0,y=[];g!==l.length;++g){if(l[g].trim()==="BOT"){y[++h]=[],d=0;continue}if(!(h<0)){var C=l[g].trim().split(","),x=C[0],_=C[1];++g;for(var E=l[g]||"";(E.match(/["]/g)||[]).length&1&&g<l.length-1;)E+=`
`+l[++g];switch(E=E.trim(),+x){case-1:if(E==="BOT"){y[++h]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?y[h][d]=!0:E==="FALSE"?y[h][d]=!1:isNaN(Gh(_))?isNaN(CC(_).getDate())?y[h][d]=_:y[h][d]=na(_):y[h][d]=Gh(_),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),y[h][d++]=E!==""?E:null;break}if(E==="EOD")break}}return o&&o.sheetRows&&(y=y.slice(0,o.sheetRows)),y}function r(n,o){return B1(t(n,o),o)}function i(n,o){return Jg(r(n,o),o)}var s=function(){var n=function(h,d,g,y,C){h.push(d),h.push(g+","+y),h.push('"'+C.replace(/"/g,'""')+'"')},o=function(h,d,g,y){h.push(d+","+g),h.push(d==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(h){var d=[],g=yi(h["!ref"]),y,C=Array.isArray(h);n(d,"TABLE",0,1,"sheetjs"),n(d,"VECTORS",0,g.e.r-g.s.r+1,""),n(d,"TUPLES",0,g.e.c-g.s.c+1,""),n(d,"DATA",0,0,"");for(var x=g.s.r;x<=g.e.r;++x){o(d,-1,0,"BOT");for(var _=g.s.c;_<=g.e.c;++_){var E=Kn({r:x,c:_});if(y=C?(h[x]||[])[_]:h[E],!y){o(d,1,0,"");continue}switch(y.t){case"n":var R=y.w;!R&&y.v!=null&&(R=y.v),R==null?y.f&&!y.F?o(d,1,0,"="+y.f):o(d,1,0,""):o(d,0,R,"V");break;case"b":o(d,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Id(y.z||Qi[14],Fa(na(y.v)))),o(d,0,y.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var I=`\r
`,F=d.join(I);return F}}();return{to_workbook:i,to_sheet:r,from_sheet:s}}(),Bee=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,C){for(var x=y.split(`
`),_=-1,E=-1,R=0,I=[];R!==x.length;++R){var F=x[R].trim().split(":");if(F[0]==="cell"){var D=Us(F[1]);if(I.length<=D.r)for(_=I.length;_<=D.r;++_)I[_]||(I[_]=[]);switch(_=D.r,E=D.c,F[2]){case"t":I[_][E]=t(F[3]);break;case"v":I[_][E]=+F[3];break;case"vtf":var U=F[F.length-1];case"vtc":switch(F[3]){case"nl":I[_][E]=!!+F[4];break;default:I[_][E]=+F[4];break}F[2]=="vtf"&&(I[_][E]=[I[_][E],U])}}}return C&&C.sheetRows&&(I=I.slice(0,C.sheetRows)),I}function i(y,C){return B1(r(y,C),C)}function s(y,C){return Jg(i(y,C),C)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(y){if(!y||!y["!ref"])return"";for(var C=[],x=[],_,E="",R=ol(y["!ref"]),I=Array.isArray(y),F=R.s.r;F<=R.e.r;++F)for(var D=R.s.c;D<=R.e.c;++D)if(E=Kn({r:F,c:D}),_=I?(y[F]||[])[D]:y[E],!(!_||_.v==null||_.t==="z")){switch(x=["cell",E,"t"],_.t){case"s":case"str":x.push(e(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=e(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var U=Fa(na(_.v));x[2]="vtc",x[3]="nd",x[4]=""+U,x[5]=_.w||Id(_.z||Qi[14],U);break;case"e":continue}C.push(x.join(":"))}return C.push("sheet:c:"+(R.e.c-R.s.c+1)+":r:"+(R.e.r-R.s.r+1)+":tvf:1"),C.push("valueformat:1:text-wiki"),C.join(`
`)}function g(y){return[n,o,l,o,d(y),h].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:g}}(),QVe=function(){function t(g,y,C,x,_){_.raw?y[C][x]=g:g===""||(g==="TRUE"?y[C][x]=!0:g==="FALSE"?y[C][x]=!1:isNaN(Gh(g))?isNaN(CC(g).getDate())?y[C][x]=g:y[C][x]=na(g):y[C][x]=Gh(g))}function e(g,y){var C=y||{},x=[];if(!g||g.length===0)return x;for(var _=g.split(/[\r\n]/),E=_.length-1;E>=0&&_[E].length===0;)--E;for(var R=10,I=0,F=0;F<=E;++F)I=_[F].indexOf(" "),I==-1?I=_[F].length:I++,R=Math.max(R,I);for(F=0;F<=E;++F){x[F]=[];var D=0;for(t(_[F].slice(0,R).trim(),x,F,D,C),D=1;D<=(_[F].length-R)/10+1;++D)t(_[F].slice(R+(D-1)*10,R+D*10).trim(),x,F,D,C)}return C.sheetRows&&(x=x.slice(0,C.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(g){for(var y={},C=!1,x=0,_=0;x<g.length;++x)(_=g.charCodeAt(x))==34?C=!C:!C&&_ in r&&(y[_]=(y[_]||0)+1);_=[];for(x in y)Object.prototype.hasOwnProperty.call(y,x)&&_.push([y[x],x]);if(!_.length){y=i;for(x in y)Object.prototype.hasOwnProperty.call(y,x)&&_.push([y[x],x])}return _.sort(function(E,R){return E[0]-R[0]||i[E[1]]-i[R[1]]}),r[_.pop()[1]]||44}function n(g,y){var C=y||{},x="",_=C.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(x=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(x=g.charAt(4),g=g.slice(6)):x=s(g.slice(0,1024)):C.FS?x=C.FS:x=s(g.slice(0,1024));var R=0,I=0,F=0,D=0,U=0,X=x.charCodeAt(0),te=!1,Y=0,oe=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var me=C.dateNF!=null?gBe(C.dateNF):null;function de(){var ye=g.slice(D,U),Ee={};if(ye.charAt(0)=='"'&&ye.charAt(ye.length-1)=='"'&&(ye=ye.slice(1,-1).replace(/""/g,'"')),ye.length===0)Ee.t="z";else if(C.raw)Ee.t="s",Ee.v=ye;else if(ye.trim().length===0)Ee.t="s",Ee.v=ye;else if(ye.charCodeAt(0)==61)ye.charCodeAt(1)==34&&ye.charCodeAt(ye.length-1)==34?(Ee.t="s",Ee.v=ye.slice(2,-1).replace(/""/g,'"')):qWe(ye)?(Ee.t="n",Ee.f=ye.slice(1)):(Ee.t="s",Ee.v=ye);else if(ye=="TRUE")Ee.t="b",Ee.v=!0;else if(ye=="FALSE")Ee.t="b",Ee.v=!1;else if(!isNaN(F=Gh(ye)))Ee.t="n",C.cellText!==!1&&(Ee.w=ye),Ee.v=F;else if(!isNaN(CC(ye).getDate())||me&&ye.match(me)){Ee.z=C.dateNF||Qi[14];var ke=0;me&&ye.match(me)&&(ye=mBe(ye,C.dateNF,ye.match(me)||[]),ke=1),C.cellDates?(Ee.t="d",Ee.v=na(ye,ke)):(Ee.t="n",Ee.v=Fa(na(ye,ke))),C.cellText!==!1&&(Ee.w=Id(Ee.z,Ee.v instanceof Date?Fa(Ee.v):Ee.v)),C.cellNF||delete Ee.z}else Ee.t="s",Ee.v=ye;if(Ee.t=="z"||(C.dense?(_[R]||(_[R]=[]),_[R][I]=Ee):_[Kn({c:I,r:R})]=Ee),D=U+1,oe=g.charCodeAt(D),E.e.c<I&&(E.e.c=I),E.e.r<R&&(E.e.r=R),Y==X)++I;else if(I=0,++R,C.sheetRows&&C.sheetRows<=R)return!0}e:for(;U<g.length;++U)switch(Y=g.charCodeAt(U)){case 34:oe===34&&(te=!te);break;case X:case 10:case 13:if(!te&&de())break e;break}return U-D>0&&de(),_["!ref"]=ps(E),_}function o(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?n(g,y):B1(e(g,y),y)}function l(g,y){var C="",x=y.type=="string"?[0,0,0,0]:uYe(g,y);switch(y.type){case"base64":C=nf(g);break;case"binary":C=g;break;case"buffer":y.codepage==65001?C=g.toString("utf8"):y.codepage&&typeof NT<"u"||(C=kn&&Buffer.isBuffer(g)?g.toString("binary"):fS(g));break;case"array":C=wR(g);break;case"string":C=g;break;default:throw new Error("Unrecognized type "+y.type)}return x[0]==239&&x[1]==187&&x[2]==191?C=Ty(C.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?C=Ty(C):y.type=="binary"&&typeof NT<"u",C.slice(0,19)=="socialcalc:version:"?Bee.to_sheet(y.type=="string"?C:Ty(C),y):o(C,y)}function h(g,y){return Jg(l(g,y),y)}function d(g){for(var y=[],C=yi(g["!ref"]),x,_=Array.isArray(g),E=C.s.r;E<=C.e.r;++E){for(var R=[],I=C.s.c;I<=C.e.c;++I){var F=Kn({r:E,c:I});if(x=_?(g[E]||[])[I]:g[F],!x||x.v==null){R.push("          ");continue}for(var D=(x.w||(sf(x),x.w)||"").slice(0,10);D.length<10;)D+=" ";R.push(D+(I===0?" ":""))}y.push(R.join(""))}return y.join(`
`)}return{to_workbook:h,to_sheet:l,from_sheet:d}}(),aU=function(){function t(O,N,H){if(O){qa(O,O.l||0);for(var B=H.Enum||Me;O.l<O.length;){var K=O.read_shift(2),Z=B[K]||B[65535],we=O.read_shift(2),Ce=O.l+we,z=Z.f&&Z.f(O,we,H);if(O.l=Ce,N(z,Z,K))return}}}function e(O,N){switch(N.type){case"base64":return r(Ec(nf(O)),N);case"binary":return r(Ec(O),N);case"buffer":case"array":return r(O,N)}throw"Unsupported type "+N.type}function r(O,N){if(!O)return O;var H=N||{},B=H.dense?[]:{},K="Sheet1",Z="",we=0,Ce={},z=[],q=[],re={s:{r:0,c:0},e:{r:0,c:0}},ve=H.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)H.Enum=Me,t(O,function(he,Ie,De){switch(De){case 0:H.vers=he,he>=4096&&(H.qpro=!0);break;case 6:re=he;break;case 204:he&&(Z=he);break;case 222:Z=he;break;case 15:case 51:H.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:De==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=H.dateNF||Qi[14],H.cellDates&&(he[1].t="d",he[1].v=nee(he[1].v))),H.qpro&&he[3]>we&&(B["!ref"]=ps(re),Ce[K]=B,z.push(K),B=H.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},we=he[3],K=Z||"Sheet"+(we+1),Z="");var $e=H.dense?(B[he[0].r]||[])[he[0].c]:B[Kn(he[0])];if($e){$e.t=he[1].t,$e.v=he[1].v,he[1].z!=null&&($e.z=he[1].z),he[1].f!=null&&($e.f=he[1].f);break}H.dense?(B[he[0].r]||(B[he[0].r]=[]),B[he[0].r][he[0].c]=he[1]):B[Kn(he[0])]=he[1];break}},H);else if(O[2]==26||O[2]==14)H.Enum=A,O[2]==14&&(H.qpro=!0,O.l=0),t(O,function(he,Ie,De){switch(De){case 204:K=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>we&&(B["!ref"]=ps(re),Ce[K]=B,z.push(K),B=H.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},we=he[3],K="Sheet"+(we+1)),ve>0&&he[0].r>=ve)break;H.dense?(B[he[0].r]||(B[he[0].r]=[]),B[he[0].r][he[0].c]=he[1]):B[Kn(he[0])]=he[1],re.e.c<he[0].c&&(re.e.c=he[0].c),re.e.r<he[0].r&&(re.e.r=he[0].r);break;case 27:he[14e3]&&(q[he[14e3][0]]=he[14e3][1]);break;case 1537:q[he[0]]=he[1],he[0]==we&&(K=he[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(B["!ref"]=ps(re),Ce[Z||K]=B,z.push(Z||K),!q.length)return{SheetNames:z,Sheets:Ce};for(var ce={},Re=[],Oe=0;Oe<q.length;++Oe)Ce[z[Oe]]?(Re.push(q[Oe]||z[Oe]),ce[q[Oe]]=Ce[q[Oe]]||Ce[z[Oe]]):(Re.push(q[Oe]),ce[q[Oe]]={"!ref":"A1"});return{SheetNames:Re,Sheets:ce}}function i(O,N){var H=N||{};if(+H.codepage>=0&&wC(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Ia(),K=yi(O["!ref"]),Z=Array.isArray(O),we=[];Ht(B,0,n(1030)),Ht(B,6,h(K));for(var Ce=Math.min(K.e.r,8191),z=K.s.r;z<=Ce;++z)for(var q=oo(z),re=K.s.c;re<=K.e.c;++re){z===K.s.r&&(we[re]=ko(re));var ve=we[re]+q,ce=Z?(O[z]||[])[re]:O[ve];if(!(!ce||ce.t=="z"))if(ce.t=="n")(ce.v|0)==ce.v&&ce.v>=-32768&&ce.v<=32767?Ht(B,13,x(z,re,ce.v)):Ht(B,14,E(z,re,ce.v));else{var Re=sf(ce);Ht(B,15,y(z,re,Re.slice(0,239)))}}return Ht(B,1),B.end()}function s(O,N){var H=N||{};if(+H.codepage>=0&&wC(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Ia();Ht(B,0,o(O));for(var K=0,Z=0;K<O.SheetNames.length;++K)(O.Sheets[O.SheetNames[K]]||{})["!ref"]&&Ht(B,27,Be(O.SheetNames[K],Z++));var we=0;for(K=0;K<O.SheetNames.length;++K){var Ce=O.Sheets[O.SheetNames[K]];if(!(!Ce||!Ce["!ref"])){for(var z=yi(Ce["!ref"]),q=Array.isArray(Ce),re=[],ve=Math.min(z.e.r,8191),ce=z.s.r;ce<=ve;++ce)for(var Re=oo(ce),Oe=z.s.c;Oe<=z.e.c;++Oe){ce===z.s.r&&(re[Oe]=ko(Oe));var he=re[Oe]+Re,Ie=q?(Ce[ce]||[])[Oe]:Ce[he];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")Ht(B,23,de(ce,Oe,we,Ie.v));else{var De=sf(Ie);Ht(B,22,Y(ce,Oe,we,De.slice(0,239)))}}++we}}return Ht(B,1),B.end()}function n(O){var N=st(2);return N.write_shift(2,O),N}function o(O){var N=st(26);N.write_shift(2,4096),N.write_shift(2,4),N.write_shift(4,0);for(var H=0,B=0,K=0,Z=0;Z<O.SheetNames.length;++Z){var we=O.SheetNames[Z],Ce=O.Sheets[we];if(!(!Ce||!Ce["!ref"])){++K;var z=ol(Ce["!ref"]);H<z.e.r&&(H=z.e.r),B<z.e.c&&(B=z.e.c)}}return H>8191&&(H=8191),N.write_shift(2,H),N.write_shift(1,K),N.write_shift(1,B),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(1,1),N.write_shift(1,2),N.write_shift(4,0),N.write_shift(4,0),N}function l(O,N,H){var B={s:{c:0,r:0},e:{c:0,r:0}};return N==8&&H.qpro?(B.s.c=O.read_shift(1),O.l++,B.s.r=O.read_shift(2),B.e.c=O.read_shift(1),O.l++,B.e.r=O.read_shift(2),B):(B.s.c=O.read_shift(2),B.s.r=O.read_shift(2),N==12&&H.qpro&&(O.l+=2),B.e.c=O.read_shift(2),B.e.r=O.read_shift(2),N==12&&H.qpro&&(O.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function h(O){var N=st(8);return N.write_shift(2,O.s.c),N.write_shift(2,O.s.r),N.write_shift(2,O.e.c),N.write_shift(2,O.e.r),N}function d(O,N,H){var B=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(B[0].c=O.read_shift(1),B[3]=O.read_shift(1),B[0].r=O.read_shift(2),O.l+=2):(B[2]=O.read_shift(1),B[0].c=O.read_shift(2),B[0].r=O.read_shift(2)),B}function g(O,N,H){var B=O.l+N,K=d(O,N,H);if(K[1].t="s",H.vers==20768){O.l++;var Z=O.read_shift(1);return K[1].v=O.read_shift(Z,"utf8"),K}return H.qpro&&O.l++,K[1].v=O.read_shift(B-O.l,"cstr"),K}function y(O,N,H){var B=st(7+H.length);B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,O),B.write_shift(1,39);for(var K=0;K<B.length;++K){var Z=H.charCodeAt(K);B.write_shift(1,Z>=128?95:Z)}return B.write_shift(1,0),B}function C(O,N,H){var B=d(O,N,H);return B[1].v=O.read_shift(2,"i"),B}function x(O,N,H){var B=st(7);return B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,O),B.write_shift(2,H,"i"),B}function _(O,N,H){var B=d(O,N,H);return B[1].v=O.read_shift(8,"f"),B}function E(O,N,H){var B=st(13);return B.write_shift(1,255),B.write_shift(2,N),B.write_shift(2,O),B.write_shift(8,H,"f"),B}function R(O,N,H){var B=O.l+N,K=d(O,N,H);if(K[1].v=O.read_shift(8,"f"),H.qpro)O.l=B;else{var Z=O.read_shift(2);U(O.slice(O.l,O.l+Z),K),O.l+=Z}return K}function I(O,N,H){var B=N&32768;return N&=-32769,N=(B?O:0)+(N>=8192?N-16384:N),(B?"":"$")+(H?ko(N):oo(N))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(O,N){qa(O,0);for(var H=[],B=0,K="",Z="",we="",Ce="";O.l<O.length;){var z=O[O.l++];switch(z){case 0:H.push(O.read_shift(8,"f"));break;case 1:Z=I(N[0].c,O.read_shift(2),!0),K=I(N[0].r,O.read_shift(2),!1),H.push(Z+K);break;case 2:{var q=I(N[0].c,O.read_shift(2),!0),re=I(N[0].r,O.read_shift(2),!1);Z=I(N[0].c,O.read_shift(2),!0),K=I(N[0].r,O.read_shift(2),!1),H.push(q+re+":"+Z+K)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(O.read_shift(2));break;case 6:{for(var ve="";z=O[O.l++];)ve+=String.fromCharCode(z);H.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:Ce=H.pop(),we=H.pop(),H.push(["AND","OR"][z-20]+"("+we+","+Ce+")");break;default:if(z<32&&D[z])Ce=H.pop(),we=H.pop(),H.push(we+D[z]+Ce);else if(F[z]){if(B=F[z][1],B==69&&(B=O[O.l++]),B>H.length){console.error("WK1 bad formula parse 0x"+z.toString(16)+":|"+H.join("|")+"|");return}var ce=H.slice(-B);H.length-=B,H.push(F[z][0]+"("+ce.join(",")+")")}else return z<=7?console.error("WK1 invalid opcode "+z.toString(16)):z<=24?console.error("WK1 unsupported op "+z.toString(16)):z<=30?console.error("WK1 invalid opcode "+z.toString(16)):z<=115?console.error("WK1 unsupported function opcode "+z.toString(16)):console.error("WK1 unrecognized opcode "+z.toString(16))}}H.length==1?N[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function X(O){var N=[{c:0,r:0},{t:"n",v:0},0];return N[0].r=O.read_shift(2),N[3]=O[O.l++],N[0].c=O[O.l++],N}function te(O,N){var H=X(O);return H[1].t="s",H[1].v=O.read_shift(N-4,"cstr"),H}function Y(O,N,H,B){var K=st(6+B.length);K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,N),K.write_shift(1,39);for(var Z=0;Z<B.length;++Z){var we=B.charCodeAt(Z);K.write_shift(1,we>=128?95:we)}return K.write_shift(1,0),K}function oe(O,N){var H=X(O);H[1].v=O.read_shift(2);var B=H[1].v>>1;if(H[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return H[1].v=B,H}function me(O,N){var H=X(O),B=O.read_shift(4),K=O.read_shift(4),Z=O.read_shift(2);if(Z==65535)return B===0&&K===3221225472?(H[1].t="e",H[1].v=15):B===0&&K===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var we=Z&32768;return Z=(Z&32767)-16446,H[1].v=(1-we*2)*(K*Math.pow(2,Z+32)+B*Math.pow(2,Z)),H}function de(O,N,H,B){var K=st(14);if(K.write_shift(2,O),K.write_shift(1,H),K.write_shift(1,N),B==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var Z=0,we=0,Ce=0,z=0;return B<0&&(Z=1,B=-B),we=Math.log2(B)|0,B/=Math.pow(2,we-31),z=B>>>0,z&2147483648||(B/=2,++we,z=B>>>0),B-=z,z|=2147483648,z>>>=0,B*=Math.pow(2,32),Ce=B>>>0,K.write_shift(4,Ce),K.write_shift(4,z),we+=16383+(Z?32768:0),K.write_shift(2,we),K}function ye(O,N){var H=me(O);return O.l+=N-14,H}function Ee(O,N){var H=X(O),B=O.read_shift(4);return H[1].v=B>>6,H}function ke(O,N){var H=X(O),B=O.read_shift(8,"f");return H[1].v=B,H}function nt(O,N){var H=ke(O);return O.l+=N-10,H}function at(O,N){return O[O.l+N-1]==0?O.read_shift(N,"cstr"):""}function Ze(O,N){var H=O[O.l++];H>N-1&&(H=N-1);for(var B="";B.length<H;)B+=String.fromCharCode(O[O.l++]);return B}function Xe(O,N,H){if(!(!H.qpro||N<21)){var B=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var K=O.read_shift(N-21,"cstr");return[B,K]}}function Pe(O,N){for(var H={},B=O.l+N;O.l<B;){var K=O.read_shift(2);if(K==14e3){for(H[K]=[0,""],H[K][0]=O.read_shift(2);O[O.l];)H[K][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return H}function Be(O,N){var H=st(5+O.length);H.write_shift(2,14e3),H.write_shift(2,N);for(var B=0;B<O.length;++B){var K=O.charCodeAt(B);H[H.l++]=K>127?95:K}return H[H.l++]=0,H}var Me={0:{n:"BOF",f:Nee},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:C},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:R},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:at},222:{n:"SHEETNAMELP",f:Ze},65535:{n:""}},A={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:te},23:{n:"NUMBER17",f:me},24:{n:"NUMBER18",f:oe},25:{n:"FORMULA19",f:ye},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Ee},38:{n:"??"},39:{n:"NUMBER27",f:ke},40:{n:"FORMULA28",f:nt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:at},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:e}}(),ZVe=/^\s|\s$|[\t\n\r]/;function Vee(t,e){if(!e.bookSST)return"";var r=[Ss];r[r.length]=kt("sst",null,{xmlns:$1[0],count:t.Count,uniqueCount:t.Unique});for(var i=0;i!=t.length;++i)if(t[i]!=null){var s=t[i],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(ZVe)&&(n+=' xml:space="preserve"'),n+=">"+Gn(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function eWe(t){return[t.read_shift(4),t.read_shift(4)]}function tWe(t,e){return e||(e=st(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var rWe=GBe;function nWe(t){var e=Ia();pt(e,159,tWe(t));for(var r=0;r<t.length;++r)pt(e,19,rWe(t[r]));return pt(e,160),e.end()}function iWe(t){for(var e=[],r=t.split(""),i=0;i<r.length;++i)e[i]=r[i].charCodeAt(0);return e}function Wee(t){var e=0,r,i=iWe(t),s=i.length+1,n,o,l,h,d;for(r=Ng(s),r[0]=i.length,n=1;n!=s;++n)r[n]=i[n-1];for(n=s-1;n>=0;--n)o=r[n],l=e&16384?1:0,h=e<<1&32767,d=l|h,e=d^o;return e^52811}var sWe=function(){function t(s,n){switch(n.type){case"base64":return e(nf(s),n);case"binary":return e(s,n);case"buffer":return e(kn&&Buffer.isBuffer(s)?s.toString("binary"):fS(s),n);case"array":return e(wR(s),n)}throw new Error("Unrecognized type "+n.type)}function e(s,n){var o=n||{},l=o.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,y){Array.isArray(l)&&(l[y]=[]);for(var C=/\\\w+\b/g,x=0,_,E=-1;_=C.exec(g);){switch(_[0]){case"\\cell":var R=g.slice(x,C.lastIndex-_[0].length);if(R[0]==" "&&(R=R.slice(1)),++E,R.length){var I={v:R,t:"s"};Array.isArray(l)?l[y][E]=I:l[Kn({r:y,c:E})]=I}break}x=C.lastIndex}E>d.e.c&&(d.e.c=E)}),l["!ref"]=ps(d),l}function r(s,n){return Jg(t(s,n),n)}function i(s){for(var n=["{\\rtf1\\ansi"],o=yi(s["!ref"]),l,h=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){n.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)n.push("\\cellx"+(g+1));for(n.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var y=Kn({r:d,c:g});l=h?(s[d]||[])[g]:s[y],!(!l||l.v==null&&(!l.f||l.F))&&(n.push(" "+(l.w||(sf(l),l.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:i}}();function lU(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var oWe=6,Yh=oWe;function UT(t){return Math.floor((t+Math.round(128/Yh)/256)*Yh)}function zT(t){return Math.floor((t-5)/Yh*100+.5)/100}function jF(t){return Math.round((t*Yh+5)/Yh*256)/256}function X6(t){t.width?(t.wpx=UT(t.width),t.wch=zT(t.wpx),t.MDW=Yh):t.wpx?(t.wch=zT(t.wpx),t.width=jF(t.wch),t.MDW=Yh):typeof t.wch=="number"&&(t.width=jF(t.wch),t.wpx=UT(t.width),t.MDW=Yh),t.customWidth&&delete t.customWidth}var aWe=96,jee=aWe;function GT(t){return t*96/jee}function Uee(t){return t*jee/96}function lWe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&(e[e.length]=kt("numFmt",null,{numFmtId:i,formatCode:Gn(t[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=kt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function cWe(t){var e=[];return e[e.length]=kt("cellXfs",null),t.forEach(function(r){e[e.length]=kt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=kt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function zee(t,e){var r=[Ss,kt("styleSheet",null,{xmlns:$1[0],"xmlns:vt":js.vt})],i;return t.SSF&&(i=lWe(t.SSF))!=null&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=cWe(e.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uWe(t,e){var r=t.read_shift(2),i=No(t);return[r,i]}function hWe(t,e,r){r||(r=st(6+4*e.length)),r.write_shift(2,t),zs(e,r);var i=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),i}function fWe(t,e,r){var i={};i.sz=t.read_shift(2)/20;var s=ZBe(t);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var n=t.read_shift(2);switch(n===700&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(i.underline=o);var l=t.read_shift(1);l>0&&(i.family=l);var h=t.read_shift(1);switch(h>0&&(i.charset=h),t.l++,i.color=QBe(t),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=No(t),i}function dWe(t,e){e||(e=st(25+4*32)),e.write_shift(2,t.sz*20),eVe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),WT(t.color,e);var i=0;return t.scheme=="major"&&(i=1),t.scheme=="minor"&&(i=2),e.write_shift(1,i),zs(t.name,e),e.length>e.l?e.slice(0,e.l):e}var gWe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],m3,mWe=ju;function cU(t,e){e||(e=st(4*3+8*7+16*1)),m3||(m3=L6(gWe));var r=m3[t.patternType];r==null&&(r=40),e.write_shift(4,r);var i=0;if(r!=40)for(WT({auto:1},e),WT({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function pWe(t,e){var r=t.l+e,i=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:i,numFmtId:s}}function Gee(t,e,r){r||(r=st(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var i=0;return r.write_shift(1,i),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Pw(t,e){return e||(e=st(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var vWe=ju;function wWe(t,e){return e||(e=st(51)),e.write_shift(1,0),Pw(null,e),Pw(null,e),Pw(null,e),Pw(null,e),Pw(null,e),e.length>e.l?e.slice(0,e.l):e}function yWe(t,e){return e||(e=st(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),VT(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CWe(t,e,r){var i=st(2052);return i.write_shift(4,t),VT(e,i),VT(r,i),i.length>i.l?i.slice(0,i.l):i}function SWe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&++r}),r!=0&&(pt(t,615,Pc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&pt(t,44,hWe(s,e[s]))}),pt(t,616))}}function bWe(t){var e=1;pt(t,611,Pc(e)),pt(t,43,dWe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),pt(t,612)}function xWe(t){var e=2;pt(t,603,Pc(e)),pt(t,45,cU({patternType:"none"})),pt(t,45,cU({patternType:"gray125"})),pt(t,604)}function EWe(t){var e=1;pt(t,613,Pc(e)),pt(t,46,wWe()),pt(t,614)}function TWe(t){var e=1;pt(t,626,Pc(e)),pt(t,47,Gee({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),pt(t,627)}function _We(t,e){pt(t,617,Pc(e.length)),e.forEach(function(r){pt(t,47,Gee(r,0))}),pt(t,618)}function RWe(t){var e=1;pt(t,619,Pc(e)),pt(t,48,yWe({xfId:0,builtinId:0,name:"Normal"})),pt(t,620)}function AWe(t){var e=0;pt(t,505,Pc(e)),pt(t,506)}function OWe(t){var e=0;pt(t,508,CWe(e,"TableStyleMedium9","PivotStyleMedium4")),pt(t,509)}function IWe(t,e){var r=Ia();return pt(r,278),SWe(r,t.SSF),bWe(r),xWe(r),EWe(r),TWe(r),_We(r,e.cellXfs),RWe(r),AWe(r),OWe(r),pt(r,279),r.end()}function Yee(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ss];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function PWe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:No(t)}}function FWe(t){var e=st(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),zs(t.name,e),e.slice(0,e.l)}function MWe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function kWe(t){var e=st(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function NWe(t,e){var r=st(8+2*e.length);return r.write_shift(4,t),zs(e,r),r.slice(0,r.l)}function DWe(t){return t.l+=4,t.read_shift(4)!=0}function LWe(t,e){var r=st(8);return r.write_shift(4,t),r.write_shift(4,1),r}function HWe(){var t=Ia();return pt(t,332),pt(t,334,Pc(1)),pt(t,335,FWe({name:"XLDAPR",version:12e4,flags:3496657072})),pt(t,336),pt(t,339,NWe(1,"XLDAPR")),pt(t,52),pt(t,35,Pc(514)),pt(t,4096,Pc(0)),pt(t,4097,Pl(1)),pt(t,36),pt(t,53),pt(t,340),pt(t,337,LWe(1)),pt(t,51,kWe([[1,0]])),pt(t,338),pt(t,333),t.end()}function Kee(){var t=[Ss];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function $We(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Kn(r);var i=t.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var kp=1024;function Xee(t,e){for(var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[kt("xml",null,{"xmlns:v":Ja.v,"xmlns:o":Ja.o,"xmlns:x":Ja.x,"xmlns:mv":Ja.mv}).replace(/\/>/,">"),kt("o:shapelayout",kt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),kt("v:shapetype",[kt("v:stroke",null,{joinstyle:"miter"}),kt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:i})];kp<t*1e3;)kp+=1e3;return e.forEach(function(n){var o=Us(n[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var h=l.type=="gradient"?kt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=kt("v:fill",h,l),g={on:"t",obscured:"t"};++kp,s=s.concat(["<v:shape"+bC({id:"_x0000_s"+kp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,kt("v:shadow",null,g),kt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",no("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),no("x:AutoFill","False"),no("x:Row",String(o.r)),no("x:Column",String(o.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function qee(t){var e=[Ss,kt("comments",null,{xmlns:$1[0]})],r=[];return e.push("<authors>"),t.forEach(function(i){i[1].forEach(function(s){var n=Gn(s.a);r.indexOf(n)==-1&&(r.push(n),e.push("<author>"+n+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(i){var s=0,n=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=r.indexOf("tc="+i[1][0].ID):i[1].forEach(function(h){h.a&&(s=r.indexOf(Gn(h.a))),n.push(h.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),n.length<=1)e.push(no("t",Gn(n[0]||"")));else{for(var o=`Comment:
    `+n[0]+`
`,l=1;l<n.length;++l)o+=`Reply:
    `+n[l]+`
`;e.push(no("t",Gn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function BWe(t,e,r){var i=[Ss,kt("ThreadedComments",null,{xmlns:js.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var n="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?n=h.id:h.parentId=n,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),i.push(kt("threadedComment",no("text",o.t||""),h))})}),i.push("</ThreadedComments>"),i.join("")}function VWe(t){var e=[Ss,kt("personList",null,{xmlns:js.TCMNT,"xmlns:x":$1[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,i){e.push(kt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function WWe(t){var e={};e.iauthor=t.read_shift(4);var r=tm(t);return e.rfx=r.s,e.ref=Kn(r.s),t.l+=16,e}function jWe(t,e){return e==null&&(e=st(36)),e.write_shift(4,t[1].iauthor),V1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var UWe=No;function zWe(t){return zs(t.slice(0,54))}function GWe(t){var e=Ia(),r=[];return pt(e,628),pt(e,630),t.forEach(function(i){i[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),pt(e,632,zWe(s.a)))})}),pt(e,631),pt(e,633),t.forEach(function(i){i[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var n={s:Us(i[0]),e:Us(i[0])};pt(e,635,jWe([n,s])),s.t&&s.t.length>0&&pt(e,637,KBe(s)),pt(e,636),delete s.iauthor})}),pt(e,634),pt(e,629),e.end()}function YWe(t,e){e.FullPaths.forEach(function(r,i){if(i!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Zn.utils.cfb_add(t,s,e.FileIndex[i].content)}})}var Jee=["xlsb","xlsm","xlam","biff8","xla"],KWe=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(i,s,n,o){var l=!1,h=!1;n.length==0?h=!0:n.charAt(0)=="["&&(h=!0,n=n.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=n.length>0?parseInt(n,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return l?g+=e.c:--g,h?d+=e.r:--d,s+(l?"":"$")+ko(g)+(h?"":"$")+oo(d)}return function(s,n){return e=n,s.replace(t,r)}}(),q6=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,J6=function(){return function(e,r){return e.replace(q6,function(i,s,n,o,l,h){var d=U6(o)-(n?0:r.c),g=j6(h)-(l?0:r.r),y=g==0?"":l?g+1:"["+g+"]",C=d==0?"":n?d+1:"["+d+"]";return s+"R"+y+"C"+C})}}();function XWe(t,e){return t.replace(q6,function(r,i,s,n,o,l){return i+(s=="$"?s+n:ko(U6(n)+e.c))+(o=="$"?o+l:oo(j6(l)+e.r))})}function qWe(t){return t.length!=1}function hs(t){t.l+=1}function Pd(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Qee(t,e,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return Zee(t);r.biff==12&&(i=4)}var s=t.read_shift(i),n=t.read_shift(i),o=Pd(t),l=Pd(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function Zee(t){var e=Pd(t),r=Pd(t),i=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function JWe(t,e,r){if(r.biff<8)return Zee(t);var i=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),n=Pd(t),o=Pd(t);return{s:{r:i,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ete(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return QWe(t);var i=t.read_shift(r&&r.biff==12?4:2),s=Pd(t);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function QWe(t){var e=Pd(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function ZWe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function eje(t,e,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return tje(t);var s=t.read_shift(i>=12?4:2),n=t.read_shift(2),o=(n&16384)>>14,l=(n&32768)>>15;if(n&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:o,rRel:l}}function tje(t){var e=t.read_shift(2),r=t.read_shift(1),i=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:i}}function rje(t,e,r){var i=(t[t.l++]&96)>>5,s=Qee(t,r.biff>=2&&r.biff<=5?6:8,r);return[i,s]}function nje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}var o=Qee(t,n,r);return[i,s,o]}function ije(t,e,r){var i=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}function sje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2),n=8;if(r)switch(r.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}return t.l+=n,[i,s]}function oje(t,e,r){var i=(t[t.l++]&96)>>5,s=JWe(t,e-1,r);return[i,s]}function aje(t,e,r){var i=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[i]}function uU(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function lje(t,e,r){t.l+=2;for(var i=t.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=i;++n)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function cje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function uje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function hje(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function fje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[i]}function tte(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function dje(t){return t.read_shift(2),tte(t)}function gje(t){return t.read_shift(2),tte(t)}function mje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=ete(t,0,r);return[i,s]}function pje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=eje(t,0,r);return[i,s]}function vje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var n=ete(t,0,r);return[i,s,n]}function wje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[wUe[s],ite[s],i]}function yje(t,e,r){var i=t[t.l++],s=t.read_shift(1),n=r&&r.biff<=3?[i==88?-1:0,t.read_shift(1)]:Cje(t);return[s,(n[0]===0?ite:vUe)[n[1]]]}function Cje(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Sje(t,e,r){t.l+=r&&r.biff==2?3:4}function bje(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var i=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function xje(t){return t.l++,mS[t.read_shift(1)]}function Eje(t){return t.l++,t.read_shift(2)}function Tje(t){return t.l++,t.read_shift(1)!==0}function _je(t){return t.l++,W1(t)}function Rje(t,e,r){return t.l++,Lee(t,e-1,r)}function Aje(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vVe(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mS[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=W1(t);break;case 2:r[1]=SVe(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Oje(t,e,r){for(var i=t.read_shift(r.biff==12?4:2),s=[],n=0;n!=i;++n)s.push((r.biff==12?tm:EVe)(t));return s}function Ije(t,e,r){var i=0,s=0;r.biff==12?(i=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),i=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,--s==0&&(s=256));for(var n=0,o=[];n!=i&&(o[n]=[]);++n)for(var l=0;l!=s;++l)o[n][l]=Aje(t,r.biff);return o}function Pje(t,e,r){var i=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[i,0,n]}function Fje(t,e,r){if(r.biff==5)return Mje(t);var i=t.read_shift(1)>>>5&3,s=t.read_shift(2),n=t.read_shift(4);return[i,s,n]}function Mje(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[e,r,i]}function kje(t,e,r){var i=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function Nje(t,e,r){var i=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function Dje(t,e,r){var i=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[i]}function Lje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return t.l+=n,[i,s]}var Hje=ju,$je=ju,Bje=ju;function pS(t,e,r){return t.l+=2,[ZWe(t)]}function Q6(t){return t.l+=6,[]}var Vje=pS,Wje=Q6,jje=Q6,Uje=pS;function rte(t){return t.l+=2,[Nee(t),t.read_shift(2)&1]}var zje=pS,Gje=rte,Yje=Q6,Kje=pS,Xje=pS,qje=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Jje(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(4),s=t.read_shift(2),n=t.read_shift(2),o=qje[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:i,c:s,C:n}}function Qje(t){return t.l+=2,[t.read_shift(4)]}function Zje(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function eUe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function tUe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function rUe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function nUe(t){return t.l+=4,[0,0]}var hU={1:{n:"PtgExp",f:bje},2:{n:"PtgTbl",f:Bje},3:{n:"PtgAdd",f:hs},4:{n:"PtgSub",f:hs},5:{n:"PtgMul",f:hs},6:{n:"PtgDiv",f:hs},7:{n:"PtgPower",f:hs},8:{n:"PtgConcat",f:hs},9:{n:"PtgLt",f:hs},10:{n:"PtgLe",f:hs},11:{n:"PtgEq",f:hs},12:{n:"PtgGe",f:hs},13:{n:"PtgGt",f:hs},14:{n:"PtgNe",f:hs},15:{n:"PtgIsect",f:hs},16:{n:"PtgUnion",f:hs},17:{n:"PtgRange",f:hs},18:{n:"PtgUplus",f:hs},19:{n:"PtgUminus",f:hs},20:{n:"PtgPercent",f:hs},21:{n:"PtgParen",f:hs},22:{n:"PtgMissArg",f:hs},23:{n:"PtgStr",f:Rje},26:{n:"PtgSheet",f:Zje},27:{n:"PtgEndSheet",f:eUe},28:{n:"PtgErr",f:xje},29:{n:"PtgBool",f:Tje},30:{n:"PtgInt",f:Eje},31:{n:"PtgNum",f:_je},32:{n:"PtgArray",f:aje},33:{n:"PtgFunc",f:wje},34:{n:"PtgFuncVar",f:yje},35:{n:"PtgName",f:Pje},36:{n:"PtgRef",f:mje},37:{n:"PtgArea",f:rje},38:{n:"PtgMemArea",f:kje},39:{n:"PtgMemErr",f:Hje},40:{n:"PtgMemNoMem",f:$je},41:{n:"PtgMemFunc",f:Nje},42:{n:"PtgRefErr",f:Dje},43:{n:"PtgAreaErr",f:ije},44:{n:"PtgRefN",f:pje},45:{n:"PtgAreaN",f:oje},46:{n:"PtgMemAreaN",f:tUe},47:{n:"PtgMemNoMemN",f:rUe},57:{n:"PtgNameX",f:Fje},58:{n:"PtgRef3d",f:vje},59:{n:"PtgArea3d",f:nje},60:{n:"PtgRefErr3d",f:Lje},61:{n:"PtgAreaErr3d",f:sje},255:{}},iUe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sUe={1:{n:"PtgElfLel",f:rte},2:{n:"PtgElfRw",f:Kje},3:{n:"PtgElfCol",f:Vje},6:{n:"PtgElfRwV",f:Xje},7:{n:"PtgElfColV",f:Uje},10:{n:"PtgElfRadical",f:zje},11:{n:"PtgElfRadicalS",f:Yje},13:{n:"PtgElfColS",f:Wje},15:{n:"PtgElfColSV",f:jje},16:{n:"PtgElfRadicalLel",f:Gje},25:{n:"PtgList",f:Jje},29:{n:"PtgSxName",f:Qje},255:{}},oUe={0:{n:"PtgAttrNoop",f:nUe},1:{n:"PtgAttrSemi",f:fje},2:{n:"PtgAttrIf",f:uje},4:{n:"PtgAttrChoose",f:lje},8:{n:"PtgAttrGoto",f:cje},16:{n:"PtgAttrSum",f:Sje},32:{n:"PtgAttrBaxcel",f:uU},33:{n:"PtgAttrBaxcel",f:uU},64:{n:"PtgAttrSpace",f:dje},65:{n:"PtgAttrSpaceSemi",f:gje},128:{n:"PtgAttrIfError",f:hje},255:{}};function aUe(t,e,r,i){if(i.biff<8)return ju(t,e);for(var s=t.l+e,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Ije(t,0,i),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Oje(t,r[o][1],i),n.push(r[o][2]);break;case"PtgExp":i&&i.biff==12&&(r[o][1][1]=t.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&n.push(ju(t,e)),n}function lUe(t,e,r){for(var i=t.l+e,s,n,o=[];i!=t.l;)e=i-t.l,n=t[t.l],s=hU[n]||hU[iUe[n]],(n===24||n===25)&&(s=(n===24?sUe:oUe)[t[t.l+1]]),!s||!s.f?ju(t,e):o.push([s.n,s.f(t,e,r)]);return o}function cUe(t){for(var e=[],r=0;r<t.length;++r){for(var i=t[r],s=[],n=0;n<i.length;++n){var o=i[n];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var uUe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hUe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function nte(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!i)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[i[0]][0]){case 357:return s=i[1]==-1?"#REF":t.SheetNames[i[1]],i[1]==i[2]?s:s+":"+t.SheetNames[i[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[i[0]][0];case 355:default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return t[i[0]][0][3]?(s=i[1]==-1?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function fU(t,e,r){var i=nte(t,e,r);return i=="#REF"?i:hUe(i,r)}function v1(t,e,r,i,s){var n=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],h,d,g,y=0,C=0,x,_="";if(!t[0]||!t[0][0])return"";for(var E=-1,R="",I=0,F=t[0].length;I<F;++I){var D=t[0][I];switch(D[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=l.pop(),d=l.pop(),E>=0){switch(t[0][E][1][0]){case 0:R=Xi(" ",t[0][E][1][1]);break;case 1:R=Xi("\r",t[0][E][1][1]);break;default:if(R="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}d=d+R,E=-1}l.push(d+uUe[D[0]]+h);break;case"PtgIsect":h=l.pop(),d=l.pop(),l.push(d+" "+h);break;case"PtgUnion":h=l.pop(),d=l.pop(),l.push(d+","+h);break;case"PtgRange":h=l.pop(),d=l.pop(),l.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Ry(D[1][1],o,s),l.push(Ay(g,n));break;case"PtgRefN":g=r?Ry(D[1][1],r,s):D[1][1],l.push(Ay(g,n));break;case"PtgRef3d":y=D[1][1],g=Ry(D[1][2],o,s),_=fU(i,y,s),l.push(_+"!"+Ay(g,n));break;case"PtgFunc":case"PtgFuncVar":var U=D[1][0],X=D[1][1];U||(U=0),U&=127;var te=U==0?[]:l.slice(-U);l.length-=U,X==="User"&&(X=te.shift()),l.push(X+"("+te.join(",")+")");break;case"PtgBool":l.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(D[1]);break;case"PtgNum":l.push(String(D[1]));break;case"PtgStr":l.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(D[1]);break;case"PtgAreaN":x=qj(D[1][1],r?{s:r}:o,s),l.push(d3(x,s));break;case"PtgArea":x=qj(D[1][1],o,s),l.push(d3(x,s));break;case"PtgArea3d":y=D[1][1],x=D[1][2],_=fU(i,y,s),l.push(_+"!"+d3(x,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":C=D[1][2];var Y=(i.names||[])[C-1]||(i[0]||[])[C],oe=Y?Y.Name:"SH33TJSNAME"+String(C);oe&&oe.slice(0,6)=="_xlfn."&&!s.xlfn&&(oe=oe.slice(6)),l.push(oe);break;case"PtgNameX":var me=D[1][1];C=D[1][2];var de;if(s.biff<=5)me<0&&(me=-me),i[me]&&(de=i[me][C]);else{var ye="";if(((i[me]||[])[0]||[])[0]==14849||(((i[me]||[])[0]||[])[0]==1025?i[me][C]&&i[me][C].itab>0&&(ye=i.SheetNames[i[me][C].itab-1]+"!"):ye=i.SheetNames[C-1]+"!"),i[me]&&i[me][C])ye+=i[me][C].Name;else if(i[0]&&i[0][C])ye+=i[0][C].Name;else{var Ee=(nte(i,me,s)||"").split(";;");Ee[C-1]?ye=Ee[C-1]:ye+="SH33TJSERRX"}l.push(ye);break}de||(de={Name:"SH33TJSERRY"}),l.push(de.Name);break;case"PtgParen":var ke="(",nt=")";if(E>=0){switch(R="",t[0][E][1][0]){case 2:ke=Xi(" ",t[0][E][1][1])+ke;break;case 3:ke=Xi("\r",t[0][E][1][1])+ke;break;case 4:nt=Xi(" ",t[0][E][1][1])+nt;break;case 5:nt=Xi("\r",t[0][E][1][1])+nt;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}l.push(ke+l.pop()+nt);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":g={c:D[1][1],r:D[1][0]};var at={c:r.c,r:r.r};if(i.sharedf[Kn(g)]){var Ze=i.sharedf[Kn(g)];l.push(v1(Ze,o,at,i,s))}else{var Xe=!1;for(h=0;h!=i.arrayf.length;++h)if(d=i.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){l.push(v1(d[1],o,at,i,s)),Xe=!0;break}Xe||l.push(D[1])}break;case"PtgArray":l.push("{"+cUe(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var Pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&E>=0&&Pe.indexOf(t[0][I][0])==-1){D=t[0][E];var Be=!0;switch(D[1][0]){case 4:Be=!1;case 0:R=Xi(" ",D[1][1]);break;case 5:Be=!1;case 1:R=Xi("\r",D[1][1]);break;default:if(R="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}l.push((Be?R:"")+l.pop()+(Be?"":R)),E=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function fUe(t){if(t==null){var e=st(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Dg(t);return Dg(0)}function dUe(t,e,r,i,s){var n=Lg(e,r,s),o=fUe(t.v),l=st(6),h=33;l.write_shift(2,h),l.write_shift(4,0);for(var d=st(t.bf.length),g=0;g<t.bf.length;++g)d[g]=t.bf[g];var y=ro([n,o,l,d]);return y}function yR(t,e,r){var i=t.read_shift(4),s=lUe(t,i,r),n=t.read_shift(4),o=n>0?aUe(t,n,s,r):null;return[s,o]}var gUe=yR,CR=yR,mUe=yR,pUe=yR,vUe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ite={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wUe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yUe(t){var e="of:="+t.replace(q6,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function CUe(t){return t.replace(/\./,"!")}var Oy=typeof Map<"u";function Z6(t,e,r){var i=0,s=t.length;if(r){if(Oy?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var n=Oy?r.get(e):r[e];i<n.length;++i)if(t[n[i]].t===e)return t.Count++,n[i]}}else for(;i<s;++i)if(t[i].t===e)return t.Count++,i;return t[s]={t:e},t.Count++,t.Unique++,r&&(Oy?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function SR(t,e){var r={min:t+1,max:t+1},i=-1;return e.MDW&&(Yh=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?i=zT(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(r.width=jF(i),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function ste(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Bd(t,e,r){var i=r.revssf[e.z!=null?e.z:"General"],s=60,n=t.length;if(i==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){eee(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=i=s;break}}for(s=0;s!=n;++s)if(t[s].numFmtId===i)return s;return t[n]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function SUe(t,e,r){if(t&&t["!ref"]){var i=yi(t["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bUe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ps(t[r])+'"/>';return e+"</mergeCells>"}function xUe(t,e,r,i,s){var n=!1,o={},l=null;if(i.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}n=!0,o.codeName=SC(Gn(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+kt("outlinePr",null,d)}!n&&!l||(s[s.length]=kt("sheetPr",l,o))}var EUe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],TUe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _Ue(t){var e={sheet:1};return EUe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),TUe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Wee(t.password).toString(16).toUpperCase()),kt("sheetProtection",null,e)}function RUe(t){return ste(t),kt("pageMargins",null,t)}function AUe(t,e){for(var r=["<cols>"],i,s=0;s!=e.length;++s)(i=e[s])&&(r[r.length]=kt("col",null,SR(s,i)));return r[r.length]="</cols>",r.join("")}function OUe(t,e,r,i){var s=typeof t.ref=="string"?t.ref:ps(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,o=ol(s);o.s.r==o.e.r&&(o.e.r=ol(e["!ref"]).e.r,s=ps(o));for(var l=0;l<n.length;++l){var h=n[l];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+r.SheetNames[i]+"'!"+s;break}}return l==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+s}),kt("autoFilter",null,{ref:s})}function IUe(t,e,r,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),kt("sheetViews",kt("sheetView",null,s),{})}function PUe(t,e,r,i){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",n=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=mS[t.v];break;case"d":i&&i.cellDates?s=na(t.v,-1).toISOString():(t=Ma(t),t.t="n",s=""+(t.v=Fa(na(t.v)))),typeof t.z>"u"&&(t.z=Qi[14]);break;default:s=t.v;break}var l=no("v",Gn(s)),h={r:e},d=Bd(i.cellXfs,t,i);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){l=no("v",""+Z6(i.Strings,t.v,i.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=n&&(t.t=n,t.v=o),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=kt("f",Gn(t.f),g)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),kt("c",l,h)}function FUe(t,e,r,i){var s=[],n=[],o=yi(t["!ref"]),l="",h,d="",g=[],y=0,C=0,x=t["!rows"],_=Array.isArray(t),E={r:d},R,I=-1;for(C=o.s.c;C<=o.e.c;++C)g[C]=ko(C);for(y=o.s.r;y<=o.e.r;++y){for(n=[],d=oo(y),C=o.s.c;C<=o.e.c;++C){h=g[C]+d;var F=_?(t[y]||[])[C]:t[h];F!==void 0&&(l=PUe(F,h,t,e))!=null&&n.push(l)}(n.length>0||x&&x[y])&&(E={r:d},x&&x[y]&&(R=x[y],R.hidden&&(E.hidden=1),I=-1,R.hpx?I=GT(R.hpx):R.hpt&&(I=R.hpt),I>-1&&(E.ht=I,E.customHeight=1),R.level&&(E.outlineLevel=R.level)),s[s.length]=kt("row",n.join(""),E))}if(x)for(;y<x.length;++y)x&&x[y]&&(E={r:y+1},R=x[y],R.hidden&&(E.hidden=1),I=-1,R.hpx?I=GT(R.hpx):R.hpt&&(I=R.hpt),I>-1&&(E.ht=I,E.customHeight=1),R.level&&(E.outlineLevel=R.level),s[s.length]=kt("row","",E));return s.join("")}function ote(t,e,r,i){var s=[Ss,kt("worksheet",null,{xmlns:$1[0],"xmlns:r":js.r})],n=r.SheetNames[t],o=0,l="",h=r.Sheets[n];h==null&&(h={});var d=h["!ref"]||"A1",g=yi(d);if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=ps(g)}i||(i={}),h["!comments"]=[];var y=[];xUe(h,r,t,e,s),s[s.length]=kt("dimension",null,{ref:d}),s[s.length]=IUe(h,e,t,r),e.sheetFormat&&(s[s.length]=kt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=AUe(h,h["!cols"])),s[o=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(l=FUe(h,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),h["!protect"]&&(s[s.length]=_Ue(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=OUe(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=bUe(h["!merges"]));var C=-1,x,_=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(E){E[1].Target&&(x={ref:E[0]},E[1].Target.charAt(0)!="#"&&(_=zn(i,-1,Gn(E[1].Target).replace(/#.*$/,""),_n.HLINK),x["r:id"]="rId"+_),(C=E[1].Target.indexOf("#"))>-1&&(x.location=Gn(E[1].Target.slice(C+1))),E[1].Tooltip&&(x.tooltip=Gn(E[1].Tooltip)),s[s.length]=kt("hyperlink",null,x))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=RUe(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=no("ignoredErrors",kt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),y.length>0&&(_=zn(i,-1,"../drawings/drawing"+(t+1)+".xml",_n.DRAW),s[s.length]=kt("drawing",null,{"r:id":"rId"+_}),h["!drawing"]=y),h["!comments"].length>0&&(_=zn(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_n.VML),s[s.length]=kt("legacyDrawing",null,{"r:id":"rId"+_}),h["!legacy"]=_),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function MUe(t,e){var r={},i=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var n=t.read_shift(1);return t.l=i,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}function kUe(t,e,r){var i=st(145),s=(r["!rows"]||[])[t]||{};i.write_shift(4,t),i.write_shift(4,0);var n=320;s.hpx?n=GT(s.hpx)*20:s.hpt&&(n=s.hpt*20),i.write_shift(2,n),i.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var l=0,h=i.l;i.l+=4;for(var d={r:t,c:0},g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var y=-1,C=-1,x=g<<10;x<g+1<<10;++x){d.c=x;var _=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Kn(d)];_&&(y<0&&(y=x),C=x)}y<0||(++l,i.write_shift(4,y),i.write_shift(4,C))}var E=i.l;return i.l=h,i.write_shift(4,l),i.l=E,i.length>i.l?i.slice(0,i.l):i}function NUe(t,e,r,i){var s=kUe(i,r,e);(s.length>17||(e["!rows"]||[])[i])&&pt(t,0,s)}var DUe=tm,LUe=V1;function HUe(){}function $Ue(t,e){var r={},i=t[t.l];return++t.l,r.above=!(i&64),r.left=!(i&128),t.l+=18,r.name=XBe(t),r}function BUe(t,e,r){r==null&&(r=st(84+4*t.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),r.write_shift(1,i);for(var s=1;s<3;++s)r.write_shift(1,0);return WT({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),See(t,r),r.slice(0,r.l)}function VUe(t){var e=Kl(t);return[e]}function WUe(t,e,r){return r==null&&(r=st(8)),Qg(e,r)}function jUe(t){var e=Zg(t);return[e]}function UUe(t,e,r){return r==null&&(r=st(4)),em(e,r)}function zUe(t){var e=Kl(t),r=t.read_shift(1);return[e,r,"b"]}function GUe(t,e,r){return r==null&&(r=st(9)),Qg(e,r),r.write_shift(1,t.v?1:0),r}function YUe(t){var e=Zg(t),r=t.read_shift(1);return[e,r,"b"]}function KUe(t,e,r){return r==null&&(r=st(5)),em(e,r),r.write_shift(1,t.v?1:0),r}function XUe(t){var e=Kl(t),r=t.read_shift(1);return[e,r,"e"]}function qUe(t,e,r){return r==null&&(r=st(9)),Qg(e,r),r.write_shift(1,t.v),r}function JUe(t){var e=Zg(t),r=t.read_shift(1);return[e,r,"e"]}function QUe(t,e,r){return r==null&&(r=st(8)),em(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZUe(t){var e=Kl(t),r=t.read_shift(4);return[e,r,"s"]}function eze(t,e,r){return r==null&&(r=st(12)),Qg(e,r),r.write_shift(4,e.v),r}function tze(t){var e=Zg(t),r=t.read_shift(4);return[e,r,"s"]}function rze(t,e,r){return r==null&&(r=st(8)),em(e,r),r.write_shift(4,e.v),r}function nze(t){var e=Kl(t),r=W1(t);return[e,r,"n"]}function ize(t,e,r){return r==null&&(r=st(16)),Qg(e,r),Dg(t.v,r),r}function sze(t){var e=Zg(t),r=W1(t);return[e,r,"n"]}function oze(t,e,r){return r==null&&(r=st(12)),em(e,r),Dg(t.v,r),r}function aze(t){var e=Kl(t),r=bee(t);return[e,r,"n"]}function lze(t,e,r){return r==null&&(r=st(12)),Qg(e,r),xee(t.v,r),r}function cze(t){var e=Zg(t),r=bee(t);return[e,r,"n"]}function uze(t,e,r){return r==null&&(r=st(8)),em(e,r),xee(t.v,r),r}function hze(t){var e=Kl(t),r=z6(t);return[e,r,"is"]}function fze(t){var e=Kl(t),r=No(t);return[e,r,"str"]}function dze(t,e,r){return r==null&&(r=st(12+4*t.v.length)),Qg(e,r),zs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gze(t){var e=Zg(t),r=No(t);return[e,r,"str"]}function mze(t,e,r){return r==null&&(r=st(8+4*t.v.length)),em(e,r),zs(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pze(t,e,r){var i=t.l+e,s=Kl(t);s.r=r["!row"];var n=t.read_shift(1),o=[s,n,"b"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function vze(t,e,r){var i=t.l+e,s=Kl(t);s.r=r["!row"];var n=t.read_shift(1),o=[s,n,"e"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function wze(t,e,r){var i=t.l+e,s=Kl(t);s.r=r["!row"];var n=W1(t),o=[s,n,"n"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function yze(t,e,r){var i=t.l+e,s=Kl(t);s.r=r["!row"];var n=No(t),o=[s,n,"str"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}var Cze=tm,Sze=V1;function bze(t,e){return e==null&&(e=st(4)),e.write_shift(4,t),e}function xze(t,e){var r=t.l+e,i=tm(t),s=G6(t),n=No(t),o=No(t),l=No(t);t.l=r;var h={rfx:i,relId:s,loc:n,display:l};return o&&(h.Tooltip=o),h}function Eze(t,e){var r=st(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));V1({s:Us(t[0]),e:Us(t[0])},r),Y6("rId"+e,r);var i=t[1].Target.indexOf("#"),s=i==-1?"":t[1].Target.slice(i+1);return zs(s||"",r),zs(t[1].Tooltip||"",r),zs("",r),r.slice(0,r.l)}function Tze(){}function _ze(t,e,r){var i=t.l+e,s=Eee(t),n=t.read_shift(1),o=[s];if(o[2]=n,r.cellFormula){var l=gUe(t,i-t.l,r);o[1]=l}else t.l=i;return o}function Rze(t,e,r){var i=t.l+e,s=tm(t),n=[s];if(r.cellFormula){var o=pUe(t,i-t.l,r);n[1]=o,t.l=i}else t.l=i;return n}function Aze(t,e,r){r==null&&(r=st(18));var i=SR(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(i.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var ate=["left","right","top","bottom","header","footer"];function Oze(t){var e={};return ate.forEach(function(r){e[r]=W1(t)}),e}function Ize(t,e){return e==null&&(e=st(6*8)),ste(t),ate.forEach(function(r){Dg(t[r],e)}),e}function Pze(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Fze(t,e,r){r==null&&(r=st(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),r.write_shift(2,i),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Mze(t){var e=st(24);return e.write_shift(4,4),e.write_shift(4,1),V1(t,e),e}function kze(t,e){return e==null&&(e=st(16*4+2)),e.write_shift(2,t.password?Wee(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Nze(){}function Dze(){}function Lze(t,e,r,i,s,n,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Ma(e),e.z=e.z||Qi[14],e.v=Fa(na(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var h={r,c:i};switch(h.s=Bd(s.cellXfs,e,s),e.l&&n["!links"].push([Kn(h),e.l]),e.c&&n["!comments"].push([Kn(h),e.c]),e.t){case"s":case"str":return s.bookSST?(l=Z6(s.Strings,e.v,s.revStrings),h.t="s",h.v=l,o?pt(t,18,rze(e,h)):pt(t,7,eze(e,h))):(h.t="str",o?pt(t,17,mze(e,h)):pt(t,6,dze(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?pt(t,13,uze(e,h)):pt(t,2,lze(e,h)):o?pt(t,16,oze(e,h)):pt(t,5,ize(e,h)),!0;case"b":return h.t="b",o?pt(t,15,KUe(e,h)):pt(t,4,GUe(e,h)),!0;case"e":return h.t="e",o?pt(t,14,QUe(e,h)):pt(t,3,qUe(e,h)),!0}return o?pt(t,12,UUe(e,h)):pt(t,1,WUe(e,h)),!0}function Hze(t,e,r,i){var s=yi(e["!ref"]||"A1"),n,o="",l=[];pt(t,145);var h=Array.isArray(e),d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var g=s.s.r;g<=d;++g){o=oo(g),NUe(t,e,s,g);var y=!1;if(g<=s.e.r)for(var C=s.s.c;C<=s.e.c;++C){g===s.s.r&&(l[C]=ko(C)),n=l[C]+o;var x=h?(e[g]||[])[C]:e[n];if(!x){y=!1;continue}y=Lze(t,x,g,C,i,e,y)}}pt(t,146)}function $ze(t,e){!e||!e["!merges"]||(pt(t,177,bze(e["!merges"].length)),e["!merges"].forEach(function(r){pt(t,176,Sze(r))}),pt(t,178))}function Bze(t,e){!e||!e["!cols"]||(pt(t,390),e["!cols"].forEach(function(r,i){r&&pt(t,60,Aze(i,r))}),pt(t,391))}function Vze(t,e){!e||!e["!ref"]||(pt(t,648),pt(t,649,Mze(yi(e["!ref"]))),pt(t,650))}function Wze(t,e,r){e["!links"].forEach(function(i){if(i[1].Target){var s=zn(r,-1,i[1].Target.replace(/#.*$/,""),_n.HLINK);pt(t,494,Eze(i,s))}}),delete e["!links"]}function jze(t,e,r,i){if(e["!comments"].length>0){var s=zn(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_n.VML);pt(t,551,Y6("rId"+s)),e["!legacy"]=s}}function Uze(t,e,r,i){if(e["!autofilter"]){var s=e["!autofilter"],n=typeof s.ref=="string"?s.ref:ps(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=ol(n);l.s.r==l.e.r&&(l.e.r=ol(e["!ref"]).e.r,n=ps(l));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==i){d.Ref="'"+r.SheetNames[i]+"'!"+n;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+n}),pt(t,161,V1(yi(n))),pt(t,162)}}function zze(t,e,r){pt(t,133),pt(t,137,Fze(e,r)),pt(t,138),pt(t,134)}function Gze(t,e){e["!protect"]&&pt(t,535,kze(e["!protect"]))}function Yze(t,e,r,i){var s=Ia(),n=r.SheetNames[t],o=r.Sheets[n]||{},l=n;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var h=yi(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],pt(s,129),(r.vbaraw||o["!outline"])&&pt(s,147,BUe(l,o["!outline"])),pt(s,148,LUe(h)),zze(s,o,r.Workbook),Bze(s,o),Hze(s,o,t,e),Gze(s,o),Uze(s,o,r,t),$ze(s,o),Wze(s,o,i),o["!margins"]&&pt(s,476,Ize(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Vze(s,o),jze(s,o,t,i),pt(s,130),s.end()}function Kze(t,e){t.l+=10;var r=No(t);return{name:r}}var Xze=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function qze(t){return!t.Workbook||!t.Workbook.WBProps?"false":RBe(t.Workbook.WBProps.date1904)?"true":"false"}var Jze="][*?/\\".split("");function lte(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Jze.forEach(function(i){if(t.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Qze(t,e,r){t.forEach(function(i,s){lte(i);for(var n=0;n<s;++n)if(i==t[n])throw new Error("Duplicate Sheet Name: "+i);if(r){var o=e[s]&&e[s].CodeName||i;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Zze(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Qze(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)SUe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function cte(t){var e=[Ss];e[e.length]=kt("workbook",null,{xmlns:$1[0],"xmlns:r":js.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Xze.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=kt("workbookPr",null,i);var s=t.Workbook&&t.Workbook.Sheets||[],n=0;if(s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",n=0;n!=t.SheetNames.length&&!(!s[n]||!s[n].Hidden);++n);n==t.SheetNames.length&&(n=0),e[e.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",n=0;n!=t.SheetNames.length;++n){var o={name:Gn(t.SheetNames[n].slice(0,31))};if(o.sheetId=""+(n+1),o["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=kt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var h={name:l.Name};l.Comment&&(h.comment=l.Comment),l.Sheet!=null&&(h.localSheetId=""+l.Sheet),l.Hidden&&(h.hidden="1"),l.Ref&&(e[e.length]=kt("definedName",Gn(l.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function eGe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=WF(t),r.name=No(t),r}function tGe(t,e){return e||(e=st(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Y6(t.strRelID,e),zs(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rGe(t,e){var r={},i=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?No(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(i&65536),r.backupFile=!!(i&64),r.checkCompatibility=!!(i&4096),r.date1904=!!(i&1),r.filterPrivacy=!!(i&8),r.hidePivotFieldList=!!(i&1024),r.promptedSolutions=!!(i&16),r.publishItems=!!(i&2048),r.refreshAllConnections=!!(i&262144),r.saveExternalLinkValues=!!(i&128),r.showBorderUnselectedTables=!!(i&4),r.showInkAnnotation=!!(i&32),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(i&32768),r.updateLinks=["userSet","never","always"][i>>8&3],r}function nGe(t,e){e||(e=st(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),See(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function iGe(t,e,r){var i=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),n=qBe(t),o=mUe(t,0,r),l=G6(t);t.l=i;var h={Name:n,Ptg:o};return s<268435455&&(h.Sheet=s),l&&(h.Comment=l),h}function sGe(t,e){pt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:i,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};pt(t,156,tGe(s))}pt(t,144)}function oGe(t,e){e||(e=st(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return zs("SheetJS",e),zs(kT.version,e),zs(kT.version,e),zs("7262",e),e.length>e.l?e.slice(0,e.l):e}function aGe(t,e){e||(e=st(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function lGe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,i=0,s=-1,n=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&s==-1?s=i:r[i].Hidden==1&&n==-1&&(n=i);n>s||(pt(t,135),pt(t,158,aGe(s)),pt(t,136))}}function cGe(t,e){var r=Ia();return pt(r,131),pt(r,128,oGe()),pt(r,153,nGe(t.Workbook&&t.Workbook.WBProps||null)),lGe(r,t),sGe(r,t),pt(r,132),r.end()}function uGe(t,e,r){return(e.slice(-4)===".bin"?cGe:cte)(t)}function hGe(t,e,r,i,s){return(e.slice(-4)===".bin"?Yze:ote)(t,r,i,s)}function fGe(t,e,r){return(e.slice(-4)===".bin"?IWe:zee)(t,r)}function dGe(t,e,r){return(e.slice(-4)===".bin"?nWe:Vee)(t,r)}function gGe(t,e,r){return(e.slice(-4)===".bin"?GWe:qee)(t)}function mGe(t){return(t.slice(-4)===".bin"?HWe:Kee)()}function pGe(t,e){var r=[];return t.Props&&r.push(fVe(t.Props,e)),t.Custprops&&r.push(dVe(t.Props,t.Custprops)),r.join("")}function vGe(){return""}function wGe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,s){var n=[];n.push(kt("NumberFormat",null,{"ss:Format":Gn(Qi[i.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(kt("Style",n.join(""),o))}),kt("Styles",r.join(""))}function ute(t){return kt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+J6(t.Ref,{r:0,c:0})})}function yGe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],i=0;i<e.length;++i){var s=e[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(ute(s)))}return kt("Names",r.join(""))}function CGe(t,e,r,i){if(!t||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,n=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||n.push(ute(l)))}return n.join("")}function SGe(t,e,r,i){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(kt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(kt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(kt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[r])if(i.Workbook.Sheets[r].Hidden)s.push(kt("Visible",i.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(i.Workbook.Sheets[n]&&!i.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(no("ProtectContents","True")),t["!protect"].objects&&s.push(no("ProtectObjects","True")),t["!protect"].scenarios&&s.push(no("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(no("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(no("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":kt("WorksheetOptions",s.join(""),{xmlns:Ja.x})}function bGe(t){return t.map(function(e){var r=_Be(e.t||""),i=kt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return kt("Comment",i,{"ss:Author":e.a})}).join("")}function xGe(t,e,r,i,s,n,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Gn(J6(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var h=Us(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Gn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Gn(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=o.c||d[g].s.r!=o.r||(d[g].e.c>d[g].s.c&&(l["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(l["ss:MergeDown"]=d[g].e.r-d[g].s.r));var y="",C="";switch(t.t){case"z":if(!i.sheetStubs)return"";break;case"n":y="Number",C=String(t.v);break;case"b":y="Boolean",C=t.v?"1":"0";break;case"e":y="Error",C=mS[t.v];break;case"d":y="DateTime",C=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Qi[14]);break;case"s":y="String",C=TBe(t.v||"");break}var x=Bd(i.cellXfs,t,i);l["ss:StyleID"]="s"+(21+x),l["ss:Index"]=o.c+1;var _=t.v!=null?C:"",E=t.t=="z"?"":'<Data ss:Type="'+y+'">'+_+"</Data>";return(t.c||[]).length>0&&(E+=bGe(t.c)),kt("Cell",E,l)}function EGe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Uee(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function TGe(t,e,r,i){if(!t["!ref"])return"";var s=yi(t["!ref"]),n=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(R,I){X6(R);var F=!!R.width,D=SR(I,R),U={"ss:Index":I+1};F&&(U["ss:Width"]=UT(D.width)),R.hidden&&(U["ss:Hidden"]="1"),l.push(kt("Column",null,U))});for(var h=Array.isArray(t),d=s.s.r;d<=s.e.r;++d){for(var g=[EGe(d,(t["!rows"]||[])[d])],y=s.s.c;y<=s.e.c;++y){var C=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>y)&&!(n[o].s.r>d)&&!(n[o].e.c<y)&&!(n[o].e.r<d)){(n[o].s.c!=y||n[o].s.r!=d)&&(C=!0);break}if(!C){var x={r:d,c:y},_=Kn(x),E=h?(t[d]||[])[y]:t[_];g.push(xGe(E,_,t,e,r,i,x))}}g.push("</Row>"),g.length>2&&l.push(g.join(""))}return l.join("")}function _Ge(t,e,r){var i=[],s=r.SheetNames[t],n=r.Sheets[s],o=n?CGe(n,e,t,r):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=n?TGe(n,e,t,r):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(SGe(n,e,t,r)),i.join("")}function RGe(t,e){e||(e={}),t.SSF||(t.SSF=Ma(Qi)),t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Bd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pGe(t,e)),r.push(vGe()),r.push(""),r.push("");for(var i=0;i<t.SheetNames.length;++i)r.push(kt("Worksheet",_Ge(i,e,t),{"ss:Name":Gn(t.SheetNames[i])}));return r[2]=wGe(t,e),r[3]=yGe(t),Ss+kt("Workbook",r.join(""),{xmlns:Ja.ss,"xmlns:o":Ja.o,"xmlns:x":Ja.x,"xmlns:ss":Ja.ss,"xmlns:dt":Ja.dt,"xmlns:html":Ja.html})}var p3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AGe(t,e){var r=[],i=[],s=[],n=0,o,l=$j(Qj,"n"),h=$j(Zj,"n");if(t.Props)for(o=lo(t.Props),n=0;n<o.length;++n)(Object.prototype.hasOwnProperty.call(l,o[n])?r:Object.prototype.hasOwnProperty.call(h,o[n])?i:s).push([o[n],t.Props[o[n]]]);if(t.Custprops)for(o=lo(t.Custprops),n=0;n<o.length;++n)Object.prototype.hasOwnProperty.call(t.Props||{},o[n])||(Object.prototype.hasOwnProperty.call(l,o[n])?r:Object.prototype.hasOwnProperty.call(h,o[n])?i:s).push([o[n],t.Custprops[o[n]]]);var d=[];for(n=0;n<s.length;++n)kee.indexOf(s[n][0])>-1||Pee.indexOf(s[n][0])>-1||s[n][1]!=null&&d.push(s[n]);i.length&&Zn.utils.cfb_add(e,"/SummaryInformation",iU(i,p3.SI,h,Zj)),(r.length||d.length)&&Zn.utils.cfb_add(e,"/DocumentSummaryInformation",iU(r,p3.DSI,l,Qj,d.length?d:null,p3.UDI))}function OGe(t,e){var r=e,i=Zn.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Zn.utils.cfb_add(i,s,hte(t,r)),r.biff==8&&(t.Props||t.Custprops)&&AGe(t,i),r.biff==8&&t.vbaraw&&YWe(i,Zn.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),i}var IGe={0:{f:MUe},1:{f:VUe},2:{f:aze},3:{f:XUe},4:{f:zUe},5:{f:nze},6:{f:fze},7:{f:ZUe},8:{f:yze},9:{f:wze},10:{f:pze},11:{f:vze},12:{f:jUe},13:{f:cze},14:{f:JUe},15:{f:YUe},16:{f:sze},17:{f:gze},18:{f:tze},19:{f:z6},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:iGe},40:{},42:{},43:{f:fWe},44:{f:uWe},45:{f:mWe},46:{f:vWe},47:{f:pWe},48:{},49:{f:jBe},50:{},51:{f:MWe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:UVe},62:{f:hze},63:{f:$We},64:{f:Nze},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ju,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Pze},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$Ue},148:{f:DUe,p:16},151:{f:Tze},152:{},153:{f:rGe},154:{},155:{},156:{f:eGe},157:{},158:{},159:{T:1,f:eWe},160:{T:-1},161:{T:1,f:tm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Cze},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PWe},336:{T:-1},337:{f:DWe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:WF},357:{},358:{},359:{},360:{T:1},361:{},362:{f:HVe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_ze},427:{f:Rze},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Oze},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:HUe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xze},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:WF},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UWe},633:{T:1},634:{T:-1},635:{T:1,f:WWe},636:{T:-1},637:{f:YBe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Kze},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Dze},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ht(t,e,r,i){var s=e;if(!isNaN(s)){var n=i||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,n),n>0&&W6(r)&&t.push(r)}}function PGe(t,e,r,i){var s=(r||[]).length||0;if(s<=8224)return Ht(t,e,r,s);var n=e;if(!isNaN(n)){for(var o=r.parts||[],l=0,h=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var g=t.next(4);for(g.write_shift(2,n),g.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<s;){for(g=t.next(4),g.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;g.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function vS(t,e,r){return t||(t=st(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function FGe(t,e,r,i){var s=st(9);return vS(s,t,e),Dee(r,i||"b",s),s}function MGe(t,e,r){var i=st(8+2*r.length);return vS(i,t,e),i.write_shift(1,r.length),i.write_shift(r.length,r,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function kGe(t,e,r,i){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Fa(na(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Ht(t,2,KVe(r,i,s)):Ht(t,3,YVe(r,i,s));return;case"b":case"e":Ht(t,5,FGe(r,i,e.v,e.t));return;case"s":case"str":Ht(t,4,MGe(r,i,(e.v||"").slice(0,255)));return}Ht(t,1,vS(null,r,i))}function NGe(t,e,r,i){var s=Array.isArray(e),n=yi(e["!ref"]||"A1"),o,l="",h=[];if(n.e.c>255||n.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),o=ps(n)}for(var d=n.s.r;d<=n.e.r;++d){l=oo(d);for(var g=n.s.c;g<=n.e.c;++g){d===n.s.r&&(h[g]=ko(g)),o=h[g]+l;var y=s?(e[d]||[])[g]:e[o];y&&kGe(t,y,d,g)}}}function DGe(t,e){for(var r=e||{},i=Ia(),s=0,n=0;n<t.SheetNames.length;++n)t.SheetNames[n]==r.sheet&&(s=n);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ht(i,r.biff==4?1033:r.biff==3?521:9,K6(t,16,r)),NGe(i,t.Sheets[t.SheetNames[s]],s,r),Ht(i,10),i.end()}function LGe(t,e,r){Ht(t,49,IVe({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function HGe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&Ht(t,1054,MVe(s,e[s],r))})}function $Ge(t,e){var r=st(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ht(t,2151,r),r=st(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),$ee(yi(e["!ref"]||"A1"),r),r.write_shift(4,4),Ht(t,2152,r)}function BGe(t,e){for(var r=0;r<16;++r)Ht(t,224,oU({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Ht(t,224,oU(i,0,e))})}function VGe(t,e){for(var r=0;r<e["!links"].length;++r){var i=e["!links"][r];Ht(t,440,VVe(i)),i[1].Tooltip&&Ht(t,2048,WVe(i))}delete e["!links"]}function WGe(t,e){if(e){var r=0;e.forEach(function(i,s){++r<=256&&i&&Ht(t,125,zVe(SR(s,i),s))})}}function jGe(t,e,r,i,s){var n=16+Bd(s.cellXfs,e,s);if(e.v==null&&!e.bf){Ht(t,513,Lg(r,i,n));return}if(e.bf)Ht(t,6,dUe(e,r,i,s,n));else switch(e.t){case"d":case"n":var o=e.t=="d"?Fa(na(e.v)):e.v;Ht(t,515,LVe(r,i,o,n));break;case"b":case"e":Ht(t,517,DVe(r,i,e.v,n,s,e.t));break;case"s":case"str":if(s.bookSST){var l=Z6(s.Strings,e.v,s.revStrings);Ht(t,253,PVe(r,i,l,n))}else Ht(t,516,FVe(r,i,(e.v||"").slice(0,255),n,s));break;default:Ht(t,513,Lg(r,i,n))}}function UGe(t,e,r){var i=Ia(),s=r.SheetNames[t],n=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},h=Array.isArray(n),d=e.biff==8,g,y="",C=[],x=yi(n["!ref"]||"A1"),_=d?65536:16384;if(x.e.c>255||x.e.r>=_){if(e.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,_-1)}Ht(i,2057,K6(r,16,e)),Ht(i,13,Pl(1)),Ht(i,12,Pl(100)),Ht(i,15,Jo(!0)),Ht(i,17,Jo(!1)),Ht(i,16,Dg(.001)),Ht(i,95,Jo(!0)),Ht(i,42,Jo(!1)),Ht(i,43,Jo(!1)),Ht(i,130,Pl(1)),Ht(i,128,NVe()),Ht(i,131,Jo(!1)),Ht(i,132,Jo(!1)),d&&WGe(i,n["!cols"]),Ht(i,512,kVe(x,e)),d&&(n["!links"]=[]);for(var E=x.s.r;E<=x.e.r;++E){y=oo(E);for(var R=x.s.c;R<=x.e.c;++R){E===x.s.r&&(C[R]=ko(R)),g=C[R]+y;var I=h?(n[E]||[])[R]:n[g];I&&(jGe(i,I,E,R,e),d&&I.l&&n["!links"].push([g,I.l]))}}var F=l.CodeName||l.name||s;return d&&Ht(i,574,OVe((o.Views||[])[0])),d&&(n["!merges"]||[]).length&&Ht(i,229,BVe(n["!merges"])),d&&VGe(i,n),Ht(i,442,Hee(F)),d&&$Ge(i,n),Ht(i,10),i.end()}function zGe(t,e,r){var i=Ia(),s=(t||{}).Workbook||{},n=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,h=r.biff==5;if(Ht(i,2057,K6(t,5,r)),r.bookType=="xla"&&Ht(i,135),Ht(i,225,l?Pl(1200):null),Ht(i,193,pVe(2)),h&&Ht(i,191),h&&Ht(i,192),Ht(i,226),Ht(i,92,TVe("SheetJS",r)),Ht(i,66,Pl(l?1200:1252)),l&&Ht(i,353,Pl(0)),l&&Ht(i,448),Ht(i,317,GVe(t.SheetNames.length)),l&&t.vbaraw&&Ht(i,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Ht(i,442,Hee(d))}Ht(i,156,Pl(17)),Ht(i,25,Jo(!1)),Ht(i,18,Jo(!1)),Ht(i,19,Pl(0)),l&&Ht(i,431,Jo(!1)),l&&Ht(i,444,Pl(0)),Ht(i,61,AVe()),Ht(i,64,Jo(!1)),Ht(i,141,Pl(0)),Ht(i,34,Jo(qze(t)=="true")),Ht(i,14,Jo(!0)),l&&Ht(i,439,Jo(!1)),Ht(i,218,Pl(0)),LGe(i,t,r),HGe(i,t.SSF,r),BGe(i,r),l&&Ht(i,352,Jo(!1));var g=i.end(),y=Ia();l&&Ht(y,140,jVe()),l&&r.Strings&&PGe(y,252,RVe(r.Strings)),Ht(y,10);var C=y.end(),x=Ia(),_=0,E=0;for(E=0;E<t.SheetNames.length;++E)_+=(l?12:11)+(l?2:1)*t.SheetNames[E].length;var R=g.length+_+C.length;for(E=0;E<t.SheetNames.length;++E){var I=n[E]||{};Ht(x,133,_Ve({pos:R,hs:I.Hidden||0,dt:0,name:t.SheetNames[E]},r)),R+=e[E].length}var F=x.end();if(_!=F.length)throw new Error("BS8 "+_+" != "+F.length);var D=[];return g.length&&D.push(g),F.length&&D.push(F),C.length&&D.push(C),ro(D)}function GGe(t,e){var r=e||{},i=[];t&&!t.SSF&&(t.SSF=Ma(Qi)),t&&t.SSF&&(pR(),mR(t.SSF),r.revssf=vR(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,e5(r),r.cellXfs=[],Bd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)i[i.length]=UGe(s,r,t);return i.unshift(zGe(t,i,r)),ro(i)}function hte(t,e){for(var r=0;r<=t.SheetNames.length;++r){var i=t.Sheets[t.SheetNames[r]];if(!(!i||!i["!ref"])){var s=ol(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=e||{};switch(n.biff||2){case 8:case 5:return GGe(t,e);case 4:case 3:case 2:return DGe(t,e)}throw new Error("invalid type "+n.bookType+" for BIFF")}function YGe(t,e,r,i){for(var s=t["!merges"]||[],n=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var g=Kn({r,c:o}),y=i.dense?(t[r]||[])[o]:t[g],C=y&&y.v!=null&&(y.h||EBe(y.w||(sf(y),y.w)||""))||"",x={};l>1&&(x.rowspan=l),h>1&&(x.colspan=h),i.editable?C='<span contenteditable="true">'+C+"</span>":y&&(x["data-t"]=y&&y.t||"z",y.v!=null&&(x["data-v"]=y.v),y.z!=null&&(x["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(C='<a href="'+y.l.Target+'">'+C+"</a>")),x.id=(i.id||"sjs")+"-"+g,n.push(kt("td",C,x))}}var _="<tr>";return _+n.join("")+"</tr>"}var KGe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XGe="</body></html>";function qGe(t,e,r){var i=[];return i.join("")+"<table"+(r.id?' id="'+r.id+'"':"")+">"}function fte(t,e){var r=e||{},i=r.header!=null?r.header:KGe,s=r.footer!=null?r.footer:XGe,n=[i],o=ol(t["!ref"]);r.dense=Array.isArray(t),n.push(qGe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)n.push(YGe(t,o,l,r));return n.push("</table>"+s),n.join("")}function dte(t,e,r){var i=r||{},s=0,n=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var o=typeof i.origin=="string"?Us(i.origin):i.origin;s=o.r,n=o.c}var l=e.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:n}};if(t["!ref"]){var g=ol(t["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),s==-1&&(d.e.r=s=g.e.r+1)}var y=[],C=0,x=t["!rows"]||(t["!rows"]=[]),_=0,E=0,R=0,I=0,F=0,D=0;for(t["!cols"]||(t["!cols"]=[]);_<l.length&&E<h;++_){var U=l[_];if(dU(U)){if(i.display)continue;x[E]={hidden:!0}}var X=U.children;for(R=I=0;R<X.length;++R){var te=X[R];if(!(i.display&&dU(te))){var Y=te.hasAttribute("data-v")?te.getAttribute("data-v"):te.hasAttribute("v")?te.getAttribute("v"):ABe(te.innerHTML),oe=te.getAttribute("data-z")||te.getAttribute("z");for(C=0;C<y.length;++C){var me=y[C];me.s.c==I+n&&me.s.r<E+s&&E+s<=me.e.r&&(I=me.e.c+1-n,C=-1)}D=+te.getAttribute("colspan")||1,((F=+te.getAttribute("rowspan")||1)>1||D>1)&&y.push({s:{r:E+s,c:I+n},e:{r:E+s+(F||1)-1,c:I+n+(D||1)-1}});var de={t:"s",v:Y},ye=te.getAttribute("data-t")||te.getAttribute("t")||"";Y!=null&&(Y.length==0?de.t=ye||"z":i.raw||Y.trim().length==0||ye=="s"||(Y==="TRUE"?de={t:"b",v:!0}:Y==="FALSE"?de={t:"b",v:!1}:isNaN(Gh(Y))?isNaN(CC(Y).getDate())||(de={t:"d",v:na(Y)},i.cellDates||(de={t:"n",v:Fa(de.v)}),de.z=i.dateNF||Qi[14]):de={t:"n",v:Gh(Y)})),de.z===void 0&&oe!=null&&(de.z=oe);var Ee="",ke=te.getElementsByTagName("A");if(ke&&ke.length)for(var nt=0;nt<ke.length&&!(ke[nt].hasAttribute("href")&&(Ee=ke[nt].getAttribute("href"),Ee.charAt(0)!="#"));++nt);Ee&&Ee.charAt(0)!="#"&&(de.l={Target:Ee}),i.dense?(t[E+s]||(t[E+s]=[]),t[E+s][I+n]=de):t[Kn({c:I+n,r:E+s})]=de,d.e.c<I+n&&(d.e.c=I+n),I+=D}}++E}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),d.e.r=Math.max(d.e.r,E-1+s),t["!ref"]=ps(d),E>=h&&(t["!fullref"]=ps((d.e.r=l.length-_+E-1+s,d))),t}function gte(t,e){var r=e||{},i=r.dense?[]:{};return dte(i,t,e)}function JGe(t,e){return Jg(gte(t,e),e)}function dU(t){var e="",r=QGe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function QGe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ZGe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+bC({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ss+e}}(),gU=function(){var t=function(n){return Gn(n).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,i=function(n,o,l){var h=[];h.push('      <table:table table:name="'+Gn(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,g=0,y=ol(n["!ref"]||"A1"),C=n["!merges"]||[],x=0,_=Array.isArray(n);if(n["!cols"])for(g=0;g<=y.e.c;++g)h.push("        <table:table-column"+(n["!cols"][g]?' table:style-name="co'+n["!cols"][g].ods+'"':"")+`></table:table-column>
`);var E="",R=n["!rows"]||[];for(d=0;d<y.s.r;++d)E=R[d]?' table:style-name="ro'+R[d].ods+'"':"",h.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=y.e.r;++d){for(E=R[d]?' table:style-name="ro'+R[d].ods+'"':"",h.push("        <table:table-row"+E+`>
`),g=0;g<y.s.c;++g)h.push(e);for(;g<=y.e.c;++g){var I=!1,F={},D="";for(x=0;x!=C.length;++x)if(!(C[x].s.c>g)&&!(C[x].s.r>d)&&!(C[x].e.c<g)&&!(C[x].e.r<d)){(C[x].s.c!=g||C[x].s.r!=d)&&(I=!0),F["table:number-columns-spanned"]=C[x].e.c-C[x].s.c+1,F["table:number-rows-spanned"]=C[x].e.r-C[x].s.r+1;break}if(I){h.push(r);continue}var U=Kn({r:d,c:g}),X=_?(n[d]||[])[g]:n[U];if(X&&X.f&&(F["table:formula"]=Gn(yUe(X.f)),X.F&&X.F.slice(0,U.length)==U)){var te=ol(X.F);F["table:number-matrix-columns-spanned"]=te.e.c-te.s.c+1,F["table:number-matrix-rows-spanned"]=te.e.r-te.s.r+1}if(!X){h.push(e);continue}switch(X.t){case"b":D=X.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=X.v?"true":"false";break;case"n":D=X.w||String(X.v||0),F["office:value-type"]="float",F["office:value"]=X.v||0;break;case"s":case"str":D=X.v==null?"":X.v,F["office:value-type"]="string";break;case"d":D=X.w||na(X.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=na(X.v).toISOString(),F["table:style-name"]="ce1";break;default:h.push(e);continue}var Y=t(D);if(X.l&&X.l.Target){var oe=X.l.Target;oe=oe.charAt(0)=="#"?"#"+CUe(oe.slice(1)):oe,oe.charAt(0)!="#"&&!oe.match(/^\w+:/)&&(oe="../"+oe),Y=kt("text:a",Y,{"xlink:href":oe.replace(/&/g,"&amp;")})}h.push("          "+kt("table:table-cell",kt("text:p",Y,{}),F)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(n,o){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var y=d["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;X6(y),y.ods=l;var C=d["!cols"][g].wpx+"px";n.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+C+`"/>
`),n.push(`  </style:style>
`),++l}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var y=d["!rows"][g].hpx+"px";n.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),n.push(`  </style:style>
`),++h}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(o,l){var h=[Ss],d=bC({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=bC({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(Oee().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var y=0;y!=o.SheetNames.length;++y)h.push(i(o.Sheets[o.SheetNames[y]],o,y));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),l.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}}();function mte(t,e){if(e.bookType=="fods")return gU(t,e);var r=H6(),i="",s=[],n=[];return i="mimetype",Jr(r,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Jr(r,i,gU(t,e)),s.push([i,"text/xml"]),n.push([i,"ContentFile"]),i="styles.xml",Jr(r,i,ZGe(t,e)),s.push([i,"text/xml"]),n.push([i,"StylesFile"]),i="meta.xml",Jr(r,i,Ss+Oee()),s.push([i,"text/xml"]),n.push([i,"MetadataFile"]),i="manifest.rdf",Jr(r,i,hVe(n)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Jr(r,i,cVe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function YT(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function eYe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ec(SC(t))}function tYe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var i=0;i<e.length;++i)if(t[r+i]!=e[i])continue e;return!0}return!1}function Fd(t){var e=t.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(e),i=0;return t.forEach(function(s){r.set(s,i),i+=s.length}),r}function rYe(t,e,r){var i=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,i-6176);t[e+15]|=i>>7,t[e+14]|=(i&127)<<1;for(var n=0;s>=1;++n,s/=256)t[e+n]=s&255;t[e+15]|=r>=0?0:128}function xC(t,e){var r=e?e[0]:0,i=t[r]&127;e:if(t[r++]>=128&&(i|=(t[r]&127)<<7,t[r++]<128||(i|=(t[r]&127)<<14,t[r++]<128)||(i|=(t[r]&127)<<21,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),i}function jn(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Zp(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function As(t){for(var e=[],r=[0];r[0]<t.length;){var i=r[0],s=xC(t,r),n=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(n){case 0:{for(var h=r[0];t[r[0]++]>=128;);l=t.slice(h,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=xC(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(i))}var d={data:l,type:n};e[s]==null?e[s]=[d]:e[s].push(d)}return e}function Zs(t){var e=[];return t.forEach(function(r,i){r.forEach(function(s){s.data&&(e.push(jn(i*8+s.type)),s.type==2&&e.push(jn(s.data.length)),e.push(s.data))})}),Fd(e)}function ac(t){for(var e,r=[],i=[0];i[0]<t.length;){var s=xC(t,i),n=As(t.slice(i[0],i[0]+s));i[0]+=s;var o={id:Zp(n[1][0].data),messages:[]};n[2].forEach(function(l){var h=As(l.data),d=Zp(h[3][0].data);o.messages.push({meta:h,data:t.slice(i[0],i[0]+d)}),i[0]+=d}),(e=n[3])!=null&&e[0]&&(o.merge=Zp(n[3][0].data)>>>0>0),r.push(o)}return r}function np(t){var e=[];return t.forEach(function(r){var i=[];i[1]=[{data:jn(r.id),type:0}],i[2]=[],r.merge!=null&&(i[3]=[{data:jn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:jn(o.data.length)}],i[2].push({data:Zs(o.meta),type:2})});var n=Zs(i);e.push(jn(n.length)),e.push(n),s.forEach(function(o){return e.push(o)})}),Fd(e)}function nYe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],i=xC(e,r),s=[];r[0]<e.length;){var n=e[r[0]]&3;if(n==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(n==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,n==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Fd(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var g=Fd(s);if(g.length!=i)throw new Error("Unexpected length: ".concat(g.length," != ").concat(i));return g}function lc(t){for(var e=[],r=0;r<t.length;){var i=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(nYe(i,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Fd(e)}function ip(t){for(var e=[],r=0;r<t.length;){var i=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var n=jn(i),o=n.length;e.push(n),i<=60?(o++,e.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(t.slice(r,r+i)),o+=i,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=i}return Fd(e)}function v3(t,e){var r=new Uint8Array(32),i=YT(r),s=12,n=0;switch(r[0]=5,t.t){case"n":r[1]=2,rYe(r,s,t.v),n|=1,s+=16;break;case"b":r[1]=6,i.setFloat64(s,t.v?1:0,!0),n|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,i.setUint32(s,e.indexOf(t.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(8,n,!0),r.slice(0,s)}function w3(t,e){var r=new Uint8Array(32),i=YT(r),s=12,n=0;switch(r[0]=3,t.t){case"n":r[2]=2,i.setFloat64(s,t.v,!0),n|=32,s+=8;break;case"b":r[2]=6,i.setFloat64(s,t.v?1:0,!0),n|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,i.setUint32(s,e.indexOf(t.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(4,n,!0),r.slice(0,s)}function $f(t){var e=As(t);return xC(e[1][0].data)}function iYe(t,e,r){var i,s,n,o;if(!((i=t[6])!=null&&i[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(n=t[8])==null?void 0:n[0])==null?void 0:o.data)&&Zp(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var h=0,d=YT(t[7][0].data),g=0,y=[],C=YT(t[4][0].data),x=0,_=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),C.setUint16(E*2,65535);continue}d.setUint16(E*2,g,!0),C.setUint16(E*2,x,!0);var R,I;switch(typeof e[E]){case"string":R=v3({t:"s",v:e[E]},r),I=w3({t:"s",v:e[E]},r);break;case"number":R=v3({t:"n",v:e[E]},r),I=w3({t:"n",v:e[E]},r);break;case"boolean":R=v3({t:"b",v:e[E]},r),I=w3({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}y.push(R),g+=R.length,_.push(I),x+=I.length,++h}for(t[2][0].data=jn(h);E<t[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),C.setUint16(E*2,65535,!0);return t[6][0].data=Fd(y),t[3][0].data=Fd(_),h}function sYe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=ol(r["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ps(i)));var n=KT(r,{range:i,header:1}),o=["~Sh33tJ5~"];n.forEach(function(N){return N.forEach(function(H){typeof H=="string"&&o.push(H)})});var l={},h=[],d=Zn.read(e.numbers,{type:"base64"});d.FileIndex.map(function(N,H){return[N,d.FullPaths[H]]}).forEach(function(N){var H=N[0],B=N[1];if(H.type==2&&H.name.match(/\.iwa/)){var K=H.content,Z=lc(K),we=ac(Z);we.forEach(function(Ce){h.push(Ce.id),l[Ce.id]={deps:[],location:B,type:Zp(Ce.messages[0].meta[1][0].data)}})}}),h.sort(function(N,H){return N-H});var g=h.filter(function(N){return N>1}).map(function(N){return[N,jn(N)]});d.FileIndex.map(function(N,H){return[N,d.FullPaths[H]]}).forEach(function(N){var H=N[0];if(N[1],!!H.name.match(/\.iwa/)){var B=ac(lc(H.content));B.forEach(function(K){K.messages.forEach(function(Z){g.forEach(function(we){K.messages.some(function(Ce){return Zp(Ce.meta[1][0].data)!=11006&&tYe(Ce.data,we[1])})&&l[we[0]].deps.push(K.id)})})})}});for(var y=Zn.find(d,l[1].location),C=ac(lc(y.content)),x,_=0;_<C.length;++_){var E=C[_];E.id==1&&(x=E)}var R=$f(As(x.messages[0].data)[1][0].data);for(y=Zn.find(d,l[R].location),C=ac(lc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);for(R=$f(As(x.messages[0].data)[2][0].data),y=Zn.find(d,l[R].location),C=ac(lc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);for(R=$f(As(x.messages[0].data)[2][0].data),y=Zn.find(d,l[R].location),C=ac(lc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);var I=As(x.messages[0].data);{I[6][0].data=jn(i.e.r+1),I[7][0].data=jn(i.e.c+1);var F=$f(I[46][0].data),D=Zn.find(d,l[F].location),U=ac(lc(D.content));{for(var X=0;X<U.length&&U[X].id!=F;++X);if(U[X].id!=F)throw"Bad ColumnRowUIDMapArchive";var te=As(U[X].messages[0].data);te[1]=[],te[2]=[],te[3]=[];for(var Y=0;Y<=i.e.c;++Y){var oe=[];oe[1]=oe[2]=[{type:0,data:jn(Y+420690)}],te[1].push({type:2,data:Zs(oe)}),te[2].push({type:0,data:jn(Y)}),te[3].push({type:0,data:jn(Y)})}te[4]=[],te[5]=[],te[6]=[];for(var me=0;me<=i.e.r;++me)oe=[],oe[1]=oe[2]=[{type:0,data:jn(me+726270)}],te[4].push({type:2,data:Zs(oe)}),te[5].push({type:0,data:jn(me)}),te[6].push({type:0,data:jn(me)});U[X].messages[0].data=Zs(te)}D.content=ip(np(U)),D.size=D.content.length,delete I[46];var de=As(I[4][0].data);{de[7][0].data=jn(i.e.r+1);var ye=As(de[1][0].data),Ee=$f(ye[2][0].data);D=Zn.find(d,l[Ee].location),U=ac(lc(D.content));{if(U[0].id!=Ee)throw"Bad HeaderStorageBucket";var ke=As(U[0].messages[0].data);for(me=0;me<n.length;++me){var nt=As(ke[2][0].data);nt[1][0].data=jn(me),nt[4][0].data=jn(n[me].length),ke[2][me]={type:ke[2][0].type,data:Zs(nt)}}U[0].messages[0].data=Zs(ke)}D.content=ip(np(U)),D.size=D.content.length;var at=$f(de[2][0].data);D=Zn.find(d,l[at].location),U=ac(lc(D.content));{if(U[0].id!=at)throw"Bad HeaderStorageBucket";for(ke=As(U[0].messages[0].data),Y=0;Y<=i.e.c;++Y)nt=As(ke[2][0].data),nt[1][0].data=jn(Y),nt[4][0].data=jn(i.e.r+1),ke[2][Y]={type:ke[2][0].type,data:Zs(nt)};U[0].messages[0].data=Zs(ke)}D.content=ip(np(U)),D.size=D.content.length;var Ze=$f(de[4][0].data);(function(){for(var N=Zn.find(d,l[Ze].location),H=ac(lc(N.content)),B,K=0;K<H.length;++K){var Z=H[K];Z.id==Ze&&(B=Z)}var we=As(B.messages[0].data);{we[3]=[];var Ce=[];o.forEach(function(re,ve){Ce[1]=[{type:0,data:jn(ve)}],Ce[2]=[{type:0,data:jn(1)}],Ce[3]=[{type:2,data:eYe(re)}],we[3].push({type:2,data:Zs(Ce)})})}B.messages[0].data=Zs(we);var z=np(H),q=ip(z);N.content=q,N.size=N.content.length})();var Xe=As(de[3][0].data);{var Pe=Xe[1][0];delete Xe[2];var Be=As(Pe.data);{var Me=$f(Be[2][0].data);(function(){for(var N=Zn.find(d,l[Me].location),H=ac(lc(N.content)),B,K=0;K<H.length;++K){var Z=H[K];Z.id==Me&&(B=Z)}var we=As(B.messages[0].data);{delete we[6],delete Xe[7];var Ce=new Uint8Array(we[5][0].data);we[5]=[];for(var z=0,q=0;q<=i.e.r;++q){var re=As(Ce);z+=iYe(re,n[q],o),re[1][0].data=jn(q),we[5].push({data:Zs(re),type:2})}we[1]=[{type:0,data:jn(i.e.c+1)}],we[2]=[{type:0,data:jn(i.e.r+1)}],we[3]=[{type:0,data:jn(z)}],we[4]=[{type:0,data:jn(i.e.r+1)}]}B.messages[0].data=Zs(we);var ve=np(H),ce=ip(ve);N.content=ce,N.size=N.content.length})()}Pe.data=Zs(Be)}de[3][0].data=Zs(Xe)}I[4][0].data=Zs(de)}x.messages[0].data=Zs(I);var A=np(C),O=ip(A);return y.content=O,y.size=y.content.length,d}function oYe(t){return function(r){for(var i=0;i!=t.length;++i){var s=t[i];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function e5(t){oYe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function aYe(t,e){return e.bookType=="ods"?mte(t,e):e.bookType=="numbers"?sYe(t,e):e.bookType=="xlsb"?lYe(t,e):cYe(t,e)}function lYe(t,e){kp=1024,t&&!t.SSF&&(t.SSF=Ma(Qi)),t&&t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oy?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",i=Jee.indexOf(e.bookType)>-1,s=_ee();e5(e=e||{});var n=H6(),o="",l=0;if(e.cellXfs=[],Bd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jr(n,o,Iee(t.Props,e)),s.coreprops.push(o),zn(e.rels,2,o,_n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,Jr(n,o,Fee(t.Props)),s.extprops.push(o),zn(e.rels,3,o,_n.EXT_PROPS),t.Custprops!==t.Props&&lo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jr(n,o,Mee(t.Custprops)),s.custprops.push(o),zn(e.rels,4,o,_n.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var g={"!id":{}},y=t.Sheets[t.SheetNames[l-1]],C=(y||{})["!type"]||"sheet";switch(C){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jr(n,o,hGe(l-1,o,e,t,g)),s.sheets.push(o),zn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,_n.WS[0])}if(y){var x=y["!comments"],_=!1,E="";x&&x.length>0&&(E="xl/comments"+l+"."+r,Jr(n,E,gGe(x,E)),s.comments.push(E),zn(g,-1,"../comments"+l+"."+r,_n.CMNT),_=!0),y["!legacy"]&&_&&Jr(n,"xl/drawings/vmlDrawing"+l+".vml",Xee(l,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&Jr(n,Aee(o),Jp(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jr(n,o,dGe(e.Strings,o,e)),s.strs.push(o),zn(e.wbrels,-1,"sharedStrings."+r,_n.SST)),o="xl/workbook."+r,Jr(n,o,uGe(t,o)),s.workbooks.push(o),zn(e.rels,1,o,_n.WB),o="xl/theme/theme1.xml",Jr(n,o,Yee(t.Themes,e)),s.themes.push(o),zn(e.wbrels,-1,"theme/theme1.xml",_n.THEME),o="xl/styles."+r,Jr(n,o,fGe(t,o,e)),s.styles.push(o),zn(e.wbrels,-1,"styles."+r,_n.STY),t.vbaraw&&i&&(o="xl/vbaProject.bin",Jr(n,o,t.vbaraw),s.vba.push(o),zn(e.wbrels,-1,"vbaProject.bin",_n.VBA)),o="xl/metadata."+r,Jr(n,o,mGe(o)),s.metadata.push(o),zn(e.wbrels,-1,"metadata."+r,_n.XLMETA),Jr(n,"[Content_Types].xml",Ree(s,e)),Jr(n,"_rels/.rels",Jp(e.rels)),Jr(n,"xl/_rels/workbook."+r+".rels",Jp(e.wbrels)),delete e.revssf,delete e.ssf,n}function cYe(t,e){kp=1024,t&&!t.SSF&&(t.SSF=Ma(Qi)),t&&t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oy?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",i=Jee.indexOf(e.bookType)>-1,s=_ee();e5(e=e||{});var n=H6(),o="",l=0;if(e.cellXfs=[],Bd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jr(n,o,Iee(t.Props,e)),s.coreprops.push(o),zn(e.rels,2,o,_n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,Jr(n,o,Fee(t.Props)),s.extprops.push(o),zn(e.rels,3,o,_n.EXT_PROPS),t.Custprops!==t.Props&&lo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jr(n,o,Mee(t.Custprops)),s.custprops.push(o),zn(e.rels,4,o,_n.CUST_PROPS));var g=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var y={"!id":{}},C=t.Sheets[t.SheetNames[l-1]],x=(C||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jr(n,o,ote(l-1,e,t,y)),s.sheets.push(o),zn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,_n.WS[0])}if(C){var _=C["!comments"],E=!1,R="";if(_&&_.length>0){var I=!1;_.forEach(function(F){F[1].forEach(function(D){D.T==!0&&(I=!0)})}),I&&(R="xl/threadedComments/threadedComment"+l+"."+r,Jr(n,R,BWe(_,g,e)),s.threadedcomments.push(R),zn(y,-1,"../threadedComments/threadedComment"+l+"."+r,_n.TCMNT)),R="xl/comments"+l+"."+r,Jr(n,R,qee(_)),s.comments.push(R),zn(y,-1,"../comments"+l+"."+r,_n.CMNT),E=!0}C["!legacy"]&&E&&Jr(n,"xl/drawings/vmlDrawing"+l+".vml",Xee(l,C["!comments"])),delete C["!comments"],delete C["!legacy"]}y["!id"].rId1&&Jr(n,Aee(o),Jp(y))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jr(n,o,Vee(e.Strings,e)),s.strs.push(o),zn(e.wbrels,-1,"sharedStrings."+r,_n.SST)),o="xl/workbook."+r,Jr(n,o,cte(t)),s.workbooks.push(o),zn(e.rels,1,o,_n.WB),o="xl/theme/theme1.xml",Jr(n,o,Yee(t.Themes,e)),s.themes.push(o),zn(e.wbrels,-1,"theme/theme1.xml",_n.THEME),o="xl/styles."+r,Jr(n,o,zee(t,e)),s.styles.push(o),zn(e.wbrels,-1,"styles."+r,_n.STY),t.vbaraw&&i&&(o="xl/vbaProject.bin",Jr(n,o,t.vbaraw),s.vba.push(o),zn(e.wbrels,-1,"vbaProject.bin",_n.VBA)),o="xl/metadata."+r,Jr(n,o,Kee()),s.metadata.push(o),zn(e.wbrels,-1,"metadata."+r,_n.XLMETA),g.length>1&&(o="xl/persons/person.xml",Jr(n,o,VWe(g)),s.people.push(o),zn(e.wbrels,-1,"persons/person.xml",_n.PEOPLE)),Jr(n,"[Content_Types].xml",Ree(s,e)),Jr(n,"_rels/.rels",Jp(e.rels)),Jr(n,"xl/_rels/workbook."+r+".rels",Jp(e.wbrels)),delete e.revssf,delete e.ssf,n}function uYe(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=nf(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function pte(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return dS(e.file,Zn.write(t,{type:kn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Zn.write(t,e)}function hYe(t,e){var r=Ma(e||{}),i=aYe(t,r);return fYe(i,r)}function fYe(t,e){var r={},i=kn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=i;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Zn.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(gR(s))}return e.password&&typeof encrypt_agile<"u"?pte(encrypt_agile(s,e.password),e):e.type==="file"?dS(e.file,s):e.type=="string"?Ty(s):s}function dYe(t,e){var r=e||{},i=OGe(t,r);return pte(i,r)}function Su(t,e,r){r||(r="");var i=r+t;switch(e.type){case"base64":return yC(SC(i));case"binary":return SC(i);case"string":return t;case"file":return dS(e.file,i,"utf8");case"buffer":return kn?df(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Su(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gYe(t,e){switch(e.type){case"base64":return yC(t);case"binary":return t;case"string":return t;case"file":return dS(e.file,t,"binary");case"buffer":return kn?df(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function m2(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",i=0;i<t.length;++i)r+=String.fromCharCode(t[i]);return e.type=="base64"?yC(r):e.type=="string"?Ty(r):r;case"file":return dS(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function vte(t,e){W9e(),Zze(t);var r=Ma(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var i=vte(t,r);return r.type="array",gR(i)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Su(RGe(t,r),r);case"slk":case"sylk":return Su(qVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Su(fte(t.Sheets[t.SheetNames[s]],r),r);case"txt":return gYe(wte(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Su(t5(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Su(JVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return m2(XVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Su(QVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Su(sWe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Su(Bee.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Su(mte(t,r),r);case"wk1":return m2(aU.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return m2(aU.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),m2(hte(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dYe(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hYe(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mYe(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function pYe(t,e,r){var i={};return i.type="file",i.file=e,mYe(i),vte(t,i)}function vYe(t,e,r,i,s,n,o,l){var h=oo(r),d=l.defval,g=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),y=!0,C=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(C,"__rowNum__",{value:r,enumerable:!1})}catch{C.__rowNum__=r}else C.__rowNum__=r;if(!o||t[r])for(var x=e.s.c;x<=e.e.c;++x){var _=o?t[r][x]:t[i[x]+h];if(_===void 0||_.t===void 0){if(d===void 0)continue;n[x]!=null&&(C[n[x]]=d);continue}var E=_.v;switch(_.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(n[x]!=null){if(E==null)if(_.t=="e"&&E===null)C[n[x]]=null;else if(d!==void 0)C[n[x]]=d;else if(g&&E===null)C[n[x]]=null;else continue;else C[n[x]]=g&&(_.t!=="n"||_.t==="n"&&l.rawNumbers!==!1)?E:sf(_,E,l);E!=null&&(y=!1)}}return{row:C,isempty:y}}function KT(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},i=0,s=1,n=[],o=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?i=1:d.header==="A"?i=2:Array.isArray(d.header)?i=3:d.header==null&&(i=0),typeof g){case"string":h=yi(g);break;case"number":h=yi(t["!ref"]),h.s.r=g;break;default:h=g}i>0&&(s=0);var y=oo(h.s.r),C=[],x=[],_=0,E=0,R=Array.isArray(t),I=h.s.r,F=0,D={};R&&!t[I]&&(t[I]=[]);var U=d.skipHidden&&t["!cols"]||[],X=d.skipHidden&&t["!rows"]||[];for(F=h.s.c;F<=h.e.c;++F)if(!(U[F]||{}).hidden)switch(C[F]=ko(F),r=R?t[I][F]:t[C[F]+y],i){case 1:n[F]=F-h.s.c;break;case 2:n[F]=C[F];break;case 3:n[F]=d.header[F-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=sf(r,null,d),E=D[o]||0,!E)D[o]=1;else{do l=o+"_"+E++;while(D[l]);D[o]=E,D[l]=1}n[F]=l}for(I=h.s.r+s;I<=h.e.r;++I)if(!(X[I]||{}).hidden){var te=vYe(t,h,I,C,i,n,R,d);(te.isempty===!1||(i===1?d.blankrows!==!1:d.blankrows))&&(x[_++]=te.row)}return x.length=_,x}var mU=/"/g;function wYe(t,e,r,i,s,n,o,l){for(var h=!0,d=[],g="",y=oo(r),C=e.s.c;C<=e.e.c;++C)if(i[C]){var x=l.dense?(t[r]||[])[C]:t[i[C]+y];if(x==null)g="";else if(x.v!=null){h=!1,g=""+(l.rawNumbers&&x.t=="n"?x.v:sf(x,null,l));for(var _=0,E=0;_!==g.length;++_)if((E=g.charCodeAt(_))===s||E===n||E===34||l.forceQuotes){g='"'+g.replace(mU,'""')+'"';break}g=="ID"&&(g='"ID"')}else x.f!=null&&!x.F?(h=!1,g="="+x.f,g.indexOf(",")>=0&&(g='"'+g.replace(mU,'""')+'"')):g="";d.push(g)}return l.blankrows===!1&&h?null:d.join(o)}function t5(t,e){var r=[],i=e??{};if(t==null||t["!ref"]==null)return"";var s=yi(t["!ref"]),n=i.FS!==void 0?i.FS:",",o=n.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,h=l.charCodeAt(0),d=new RegExp((n=="|"?"\\|":n)+"+$"),g="",y=[];i.dense=Array.isArray(t);for(var C=i.skipHidden&&t["!cols"]||[],x=i.skipHidden&&t["!rows"]||[],_=s.s.c;_<=s.e.c;++_)(C[_]||{}).hidden||(y[_]=ko(_));for(var E=0,R=s.s.r;R<=s.e.r;++R)(x[R]||{}).hidden||(g=wYe(t,s,R,y,o,h,n,i),g!=null&&(i.strip&&(g=g.replace(d,"")),(g||i.blankrows!==!1)&&r.push((E++?l:"")+g)));return delete i.dense,r.join("")}function wte(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=t5(t,e);return r}function yYe(t){var e="",r,i="";if(t==null||t["!ref"]==null)return[];var s=yi(t["!ref"]),n="",o=[],l,h=[],d=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=ko(l);for(var g=s.s.r;g<=s.e.r;++g)for(n=oo(g),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+n,r=d?(t[g]||[])[l]:t[e],i="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;i=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)i=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}h[h.length]=e+"="+i}return h}function yte(t,e,r){var i=r||{},s=+!i.skipHeader,n=t||{},o=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?Us(i.origin):i.origin;o=h.r,l=h.c}var d,g={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(n["!ref"]){var y=yi(n["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),o==-1&&(o=y.e.r+1,g.e.r=o+e.length-1+s)}else o==-1&&(o=0,g.e.r=e.length-1+s);var C=i.header||[],x=0;e.forEach(function(E,R){lo(E).forEach(function(I){(x=C.indexOf(I))==-1&&(C[x=C.length]=I);var F=E[I],D="z",U="",X=Kn({c:l+x,r:o+R+s});d=EC(n,X),F&&typeof F=="object"&&!(F instanceof Date)?n[X]=F:(typeof F=="number"?D="n":typeof F=="boolean"?D="b":typeof F=="string"?D="s":F instanceof Date?(D="d",i.cellDates||(D="n",F=Fa(F)),U=i.dateNF||Qi[14]):F===null&&i.nullError&&(D="e",F=0),d?(d.t=D,d.v=F,delete d.w,delete d.R,U&&(d.z=U)):n[X]=d={t:D,v:F},U&&(d.z=U))})}),g.e.c=Math.max(g.e.c,l+C.length-1);var _=oo(o);if(s)for(x=0;x<C.length;++x)n[ko(x+l)+_]={t:"s",v:C[x]};return n["!ref"]=ps(g),n}function CYe(t,e){return yte(null,t,e)}function EC(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var i=Us(e);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?EC(t,Kn(e)):EC(t,Kn({r:e,c:r||0}))}function SYe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function bYe(){return{SheetNames:[],Sheets:{}}}function xYe(t,e,r,i){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var o=n&&n[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(lte(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function EYe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=SYe(t,e);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[i].Hidden=r}function TYe(t,e){return t.z=e,t}function Cte(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _Ye(t,e,r){return Cte(t,"#"+e,r)}function RYe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function AYe(t,e,r,i){for(var s=typeof e!="string"?e:yi(e),n=typeof e=="string"?e:ps(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var h=EC(t,o,l);h.t="n",h.F=n,delete h.v,o==s.s.r&&l==s.s.c&&(h.f=r,i&&(h.D=!0))}return t}var Fw={encode_col:ko,encode_row:oo,encode_cell:Kn,encode_range:ps,decode_col:U6,decode_row:j6,split_cell:WBe,decode_cell:Us,decode_range:ol,format_cell:sf,sheet_add_aoa:Cee,sheet_add_json:yte,sheet_add_dom:dte,aoa_to_sheet:B1,json_to_sheet:CYe,table_to_sheet:gte,table_to_book:JGe,sheet_to_csv:t5,sheet_to_txt:wte,sheet_to_json:KT,sheet_to_html:fte,sheet_to_formulae:yYe,sheet_to_row_object_array:KT,sheet_get_cell:EC,book_new:bYe,book_append_sheet:xYe,book_set_sheet_visibility:EYe,cell_set_number_format:TYe,cell_set_hyperlink:Cte,cell_set_internal_link:_Ye,cell_add_comment:RYe,sheet_set_array_formula:AYe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Ste(t,e){return function(){return t.apply(e,arguments)}}const{toString:OYe}=Object.prototype,{getPrototypeOf:r5}=Object,bR=(t=>e=>{const r=OYe.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Wc=t=>(t=t.toLowerCase(),e=>bR(e)===t),xR=t=>e=>typeof e===t,{isArray:j1}=Array,TC=xR("undefined");function IYe(t){return t!==null&&!TC(t)&&t.constructor!==null&&!TC(t.constructor)&&nl(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const bte=Wc("ArrayBuffer");function PYe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&bte(t.buffer),e}const FYe=xR("string"),nl=xR("function"),xte=xR("number"),ER=t=>t!==null&&typeof t=="object",MYe=t=>t===!0||t===!1,tE=t=>{if(bR(t)!=="object")return!1;const e=r5(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},kYe=Wc("Date"),NYe=Wc("File"),DYe=Wc("Blob"),LYe=Wc("FileList"),HYe=t=>ER(t)&&nl(t.pipe),$Ye=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||nl(t.append)&&((e=bR(t))==="formdata"||e==="object"&&nl(t.toString)&&t.toString()==="[object FormData]"))},BYe=Wc("URLSearchParams"),[VYe,WYe,jYe,UYe]=["ReadableStream","Request","Response","Headers"].map(Wc),zYe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wS(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let i,s;if(typeof t!="object"&&(t=[t]),j1(t))for(i=0,s=t.length;i<s;i++)e.call(null,t[i],i,t);else{const n=r?Object.getOwnPropertyNames(t):Object.keys(t),o=n.length;let l;for(i=0;i<o;i++)l=n[i],e.call(null,t[l],l,t)}}function Ete(t,e){e=e.toLowerCase();const r=Object.keys(t);let i=r.length,s;for(;i-- >0;)if(s=r[i],e===s.toLowerCase())return s;return null}const ug=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Tte=t=>!TC(t)&&t!==ug;function UF(){const{caseless:t}=Tte(this)&&this||{},e={},r=(i,s)=>{const n=t&&Ete(e,s)||s;tE(e[n])&&tE(i)?e[n]=UF(e[n],i):tE(i)?e[n]=UF({},i):j1(i)?e[n]=i.slice():e[n]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&wS(arguments[i],r);return e}const GYe=(t,e,r,{allOwnKeys:i}={})=>(wS(e,(s,n)=>{r&&nl(s)?t[n]=Ste(s,r):t[n]=s},{allOwnKeys:i}),t),YYe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),KYe=(t,e,r,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},XYe=(t,e,r,i)=>{let s,n,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),n=s.length;n-- >0;)o=s[n],(!i||i(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=r!==!1&&r5(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},qYe=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const i=t.indexOf(e,r);return i!==-1&&i===r},JYe=t=>{if(!t)return null;if(j1(t))return t;let e=t.length;if(!xte(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},QYe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&r5(Uint8Array)),ZYe=(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=i.next())&&!s.done;){const n=s.value;e.call(t,n[0],n[1])}},eKe=(t,e)=>{let r;const i=[];for(;(r=t.exec(e))!==null;)i.push(r);return i},tKe=Wc("HTMLFormElement"),rKe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,s){return i.toUpperCase()+s}),pU=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),nKe=Wc("RegExp"),_te=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),i={};wS(r,(s,n)=>{let o;(o=e(s,n,t))!==!1&&(i[n]=o||s)}),Object.defineProperties(t,i)},iKe=t=>{_te(t,(e,r)=>{if(nl(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=t[r];if(nl(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sKe=(t,e)=>{const r={},i=s=>{s.forEach(n=>{r[n]=!0})};return j1(t)?i(t):i(String(t).split(e)),r},oKe=()=>{},aKe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,y3="abcdefghijklmnopqrstuvwxyz",vU="0123456789",Rte={DIGIT:vU,ALPHA:y3,ALPHA_DIGIT:y3+y3.toUpperCase()+vU},lKe=(t=16,e=Rte.ALPHA_DIGIT)=>{let r="";const{length:i}=e;for(;t--;)r+=e[Math.random()*i|0];return r};function cKe(t){return!!(t&&nl(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const uKe=t=>{const e=new Array(10),r=(i,s)=>{if(ER(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[s]=i;const n=j1(i)?[]:{};return wS(i,(o,l)=>{const h=r(o,s+1);!TC(h)&&(n[l]=h)}),e[s]=void 0,n}}return i};return r(t,0)},hKe=Wc("AsyncFunction"),fKe=t=>t&&(ER(t)||nl(t))&&nl(t.then)&&nl(t.catch),Ate=((t,e)=>t?setImmediate:e?((r,i)=>(ug.addEventListener("message",({source:s,data:n})=>{s===ug&&n===r&&i.length&&i.shift()()},!1),s=>{i.push(s),ug.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",nl(ug.postMessage)),dKe=typeof queueMicrotask<"u"?queueMicrotask.bind(ug):typeof process<"u"&&process.nextTick||Ate,rt={isArray:j1,isArrayBuffer:bte,isBuffer:IYe,isFormData:$Ye,isArrayBufferView:PYe,isString:FYe,isNumber:xte,isBoolean:MYe,isObject:ER,isPlainObject:tE,isReadableStream:VYe,isRequest:WYe,isResponse:jYe,isHeaders:UYe,isUndefined:TC,isDate:kYe,isFile:NYe,isBlob:DYe,isRegExp:nKe,isFunction:nl,isStream:HYe,isURLSearchParams:BYe,isTypedArray:QYe,isFileList:LYe,forEach:wS,merge:UF,extend:GYe,trim:zYe,stripBOM:YYe,inherits:KYe,toFlatObject:XYe,kindOf:bR,kindOfTest:Wc,endsWith:qYe,toArray:JYe,forEachEntry:ZYe,matchAll:eKe,isHTMLForm:tKe,hasOwnProperty:pU,hasOwnProp:pU,reduceDescriptors:_te,freezeMethods:iKe,toObjectSet:sKe,toCamelCase:rKe,noop:oKe,toFiniteNumber:aKe,findKey:Ete,global:ug,isContextDefined:Tte,ALPHABET:Rte,generateString:lKe,isSpecCompliantForm:cKe,toJSONObject:uKe,isAsyncFn:hKe,isThenable:fKe,setImmediate:Ate,asap:dKe};function Ur(t,e,r,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}rt.inherits(Ur,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:rt.toJSONObject(this.config),code:this.code,status:this.status}}});const Ote=Ur.prototype,Ite={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ite[t]={value:t}});Object.defineProperties(Ur,Ite);Object.defineProperty(Ote,"isAxiosError",{value:!0});Ur.from=(t,e,r,i,s,n)=>{const o=Object.create(Ote);return rt.toFlatObject(t,o,function(h){return h!==Error.prototype},l=>l!=="isAxiosError"),Ur.call(o,t.message,e,r,i,s),o.cause=t,o.name=t.name,n&&Object.assign(o,n),o};const gKe=null;function zF(t){return rt.isPlainObject(t)||rt.isArray(t)}function Pte(t){return rt.endsWith(t,"[]")?t.slice(0,-2):t}function wU(t,e,r){return t?t.concat(e).map(function(s,n){return s=Pte(s),!r&&n?"["+s+"]":s}).join(r?".":""):e}function mKe(t){return rt.isArray(t)&&!t.some(zF)}const pKe=rt.toFlatObject(rt,{},null,function(e){return/^is[A-Z]/.test(e)});function TR(t,e,r){if(!rt.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=rt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,R){return!rt.isUndefined(R[E])});const i=r.metaTokens,s=r.visitor||g,n=r.dots,o=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&rt.isSpecCompliantForm(e);if(!rt.isFunction(s))throw new TypeError("visitor must be a function");function d(_){if(_===null)return"";if(rt.isDate(_))return _.toISOString();if(!h&&rt.isBlob(_))throw new Ur("Blob is not supported. Use a Buffer instead.");return rt.isArrayBuffer(_)||rt.isTypedArray(_)?h&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function g(_,E,R){let I=_;if(_&&!R&&typeof _=="object"){if(rt.endsWith(E,"{}"))E=i?E:E.slice(0,-2),_=JSON.stringify(_);else if(rt.isArray(_)&&mKe(_)||(rt.isFileList(_)||rt.endsWith(E,"[]"))&&(I=rt.toArray(_)))return E=Pte(E),I.forEach(function(D,U){!(rt.isUndefined(D)||D===null)&&e.append(o===!0?wU([E],U,n):o===null?E:E+"[]",d(D))}),!1}return zF(_)?!0:(e.append(wU(R,E,n),d(_)),!1)}const y=[],C=Object.assign(pKe,{defaultVisitor:g,convertValue:d,isVisitable:zF});function x(_,E){if(!rt.isUndefined(_)){if(y.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));y.push(_),rt.forEach(_,function(I,F){(!(rt.isUndefined(I)||I===null)&&s.call(e,I,rt.isString(F)?F.trim():F,E,C))===!0&&x(I,E?E.concat(F):[F])}),y.pop()}}if(!rt.isObject(t))throw new TypeError("data must be an object");return x(t),e}function yU(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function n5(t,e){this._pairs=[],t&&TR(t,this,e)}const Fte=n5.prototype;Fte.append=function(e,r){this._pairs.push([e,r])};Fte.toString=function(e){const r=e?function(i){return e.call(this,i,yU)}:yU;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function vKe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Mte(t,e,r){if(!e)return t;const i=r&&r.encode||vKe;rt.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let n;if(s?n=s(e,r):n=rt.isURLSearchParams(e)?e.toString():new n5(e,r).toString(i),n){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class CU{constructor(){this.handlers=[]}use(e,r,i){return this.handlers.push({fulfilled:e,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){rt.forEach(this.handlers,function(i){i!==null&&e(i)})}}const kte={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wKe=typeof URLSearchParams<"u"?URLSearchParams:n5,yKe=typeof FormData<"u"?FormData:null,CKe=typeof Blob<"u"?Blob:null,SKe={isBrowser:!0,classes:{URLSearchParams:wKe,FormData:yKe,Blob:CKe},protocols:["http","https","file","blob","url","data"]},i5=typeof window<"u"&&typeof document<"u",GF=typeof navigator=="object"&&navigator||void 0,bKe=i5&&(!GF||["ReactNative","NativeScript","NS"].indexOf(GF.product)<0),xKe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",EKe=i5&&window.location.href||"http://localhost",TKe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:i5,hasStandardBrowserEnv:bKe,hasStandardBrowserWebWorkerEnv:xKe,navigator:GF,origin:EKe},Symbol.toStringTag,{value:"Module"})),Fo={...TKe,...SKe};function _Ke(t,e){return TR(t,new Fo.classes.URLSearchParams,Object.assign({visitor:function(r,i,s,n){return Fo.isNode&&rt.isBuffer(r)?(this.append(i,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}function RKe(t){return rt.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function AKe(t){const e={},r=Object.keys(t);let i;const s=r.length;let n;for(i=0;i<s;i++)n=r[i],e[n]=t[n];return e}function Nte(t){function e(r,i,s,n){let o=r[n++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=n>=r.length;return o=!o&&rt.isArray(s)?s.length:o,h?(rt.hasOwnProp(s,o)?s[o]=[s[o],i]:s[o]=i,!l):((!s[o]||!rt.isObject(s[o]))&&(s[o]=[]),e(r,i,s[o],n)&&rt.isArray(s[o])&&(s[o]=AKe(s[o])),!l)}if(rt.isFormData(t)&&rt.isFunction(t.entries)){const r={};return rt.forEachEntry(t,(i,s)=>{e(RKe(i),s,r,0)}),r}return null}function OKe(t,e,r){if(rt.isString(t))try{return(e||JSON.parse)(t),rt.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(0,JSON.stringify)(t)}const yS={transitional:kte,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const i=r.getContentType()||"",s=i.indexOf("application/json")>-1,n=rt.isObject(e);if(n&&rt.isHTMLForm(e)&&(e=new FormData(e)),rt.isFormData(e))return s?JSON.stringify(Nte(e)):e;if(rt.isArrayBuffer(e)||rt.isBuffer(e)||rt.isStream(e)||rt.isFile(e)||rt.isBlob(e)||rt.isReadableStream(e))return e;if(rt.isArrayBufferView(e))return e.buffer;if(rt.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(n){if(i.indexOf("application/x-www-form-urlencoded")>-1)return _Ke(e,this.formSerializer).toString();if((l=rt.isFileList(e))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return TR(l?{"files[]":e}:e,h&&new h,this.formSerializer)}}return n||s?(r.setContentType("application/json",!1),OKe(e)):e}],transformResponse:[function(e){const r=this.transitional||yS.transitional,i=r&&r.forcedJSONParsing,s=this.responseType==="json";if(rt.isResponse(e)||rt.isReadableStream(e))return e;if(e&&rt.isString(e)&&(i&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?Ur.from(l,Ur.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fo.classes.FormData,Blob:Fo.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};rt.forEach(["delete","get","head","post","put","patch"],t=>{yS.headers[t]={}});const IKe=rt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),PKe=t=>{const e={};let r,i,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),i=o.substring(s+1).trim(),!(!r||e[r]&&IKe[r])&&(r==="set-cookie"?e[r]?e[r].push(i):e[r]=[i]:e[r]=e[r]?e[r]+", "+i:i)}),e},SU=Symbol("internals");function Mw(t){return t&&String(t).trim().toLowerCase()}function rE(t){return t===!1||t==null?t:rt.isArray(t)?t.map(rE):String(t)}function FKe(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(t);)e[i[1]]=i[2];return e}const MKe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function C3(t,e,r,i,s){if(rt.isFunction(i))return i.call(this,e,r);if(s&&(e=r),!!rt.isString(e)){if(rt.isString(i))return e.indexOf(i)!==-1;if(rt.isRegExp(i))return i.test(e)}}function kKe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,i)=>r.toUpperCase()+i)}function NKe(t,e){const r=rt.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+r,{value:function(s,n,o){return this[i].call(this,e,s,n,o)},configurable:!0})})}class Pa{constructor(e){e&&this.set(e)}set(e,r,i){const s=this;function n(l,h,d){const g=Mw(h);if(!g)throw new Error("header name must be a non-empty string");const y=rt.findKey(s,g);(!y||s[y]===void 0||d===!0||d===void 0&&s[y]!==!1)&&(s[y||h]=rE(l))}const o=(l,h)=>rt.forEach(l,(d,g)=>n(d,g,h));if(rt.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(rt.isString(e)&&(e=e.trim())&&!MKe(e))o(PKe(e),r);else if(rt.isHeaders(e))for(const[l,h]of e.entries())n(h,l,i);else e!=null&&n(r,e,i);return this}get(e,r){if(e=Mw(e),e){const i=rt.findKey(this,e);if(i){const s=this[i];if(!r)return s;if(r===!0)return FKe(s);if(rt.isFunction(r))return r.call(this,s,i);if(rt.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=Mw(e),e){const i=rt.findKey(this,e);return!!(i&&this[i]!==void 0&&(!r||C3(this,this[i],i,r)))}return!1}delete(e,r){const i=this;let s=!1;function n(o){if(o=Mw(o),o){const l=rt.findKey(i,o);l&&(!r||C3(i,i[l],l,r))&&(delete i[l],s=!0)}}return rt.isArray(e)?e.forEach(n):n(e),s}clear(e){const r=Object.keys(this);let i=r.length,s=!1;for(;i--;){const n=r[i];(!e||C3(this,this[n],n,e,!0))&&(delete this[n],s=!0)}return s}normalize(e){const r=this,i={};return rt.forEach(this,(s,n)=>{const o=rt.findKey(i,n);if(o){r[o]=rE(s),delete r[n];return}const l=e?kKe(n):String(n).trim();l!==n&&delete r[n],r[l]=rE(s),i[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return rt.forEach(this,(i,s)=>{i!=null&&i!==!1&&(r[s]=e&&rt.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const i=new this(e);return r.forEach(s=>i.set(s)),i}static accessor(e){const i=(this[SU]=this[SU]={accessors:{}}).accessors,s=this.prototype;function n(o){const l=Mw(o);i[l]||(NKe(s,o),i[l]=!0)}return rt.isArray(e)?e.forEach(n):n(e),this}}Pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);rt.reduceDescriptors(Pa.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(i){this[r]=i}}});rt.freezeMethods(Pa);function S3(t,e){const r=this||yS,i=e||r,s=Pa.from(i.headers);let n=i.data;return rt.forEach(t,function(l){n=l.call(r,n,s.normalize(),e?e.status:void 0)}),s.normalize(),n}function Dte(t){return!!(t&&t.__CANCEL__)}function U1(t,e,r){Ur.call(this,t??"canceled",Ur.ERR_CANCELED,e,r),this.name="CanceledError"}rt.inherits(U1,Ur,{__CANCEL__:!0});function Lte(t,e,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?t(r):e(new Ur("Request failed with status code "+r.status,[Ur.ERR_BAD_REQUEST,Ur.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function DKe(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function LKe(t,e){t=t||10;const r=new Array(t),i=new Array(t);let s=0,n=0,o;return e=e!==void 0?e:1e3,function(h){const d=Date.now(),g=i[n];o||(o=d),r[s]=h,i[s]=d;let y=n,C=0;for(;y!==s;)C+=r[y++],y=y%t;if(s=(s+1)%t,s===n&&(n=(n+1)%t),d-o<e)return;const x=g&&d-g;return x?Math.round(C*1e3/x):void 0}}function HKe(t,e){let r=0,i=1e3/e,s,n;const o=(d,g=Date.now())=>{r=g,s=null,n&&(clearTimeout(n),n=null),t.apply(null,d)};return[(...d)=>{const g=Date.now(),y=g-r;y>=i?o(d,g):(s=d,n||(n=setTimeout(()=>{n=null,o(s)},i-y)))},()=>s&&o(s)]}const XT=(t,e,r=3)=>{let i=0;const s=LKe(50,250);return HKe(n=>{const o=n.loaded,l=n.lengthComputable?n.total:void 0,h=o-i,d=s(h),g=o<=l;i=o;const y={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:d||void 0,estimated:d&&l&&g?(l-o)/d:void 0,event:n,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(y)},r)},bU=(t,e)=>{const r=t!=null;return[i=>e[0]({lengthComputable:r,total:t,loaded:i}),e[1]]},xU=t=>(...e)=>rt.asap(()=>t(...e)),$Ke=Fo.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Fo.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Fo.origin),Fo.navigator&&/(msie|trident)/i.test(Fo.navigator.userAgent)):()=>!0,BKe=Fo.hasStandardBrowserEnv?{write(t,e,r,i,s,n){const o=[t+"="+encodeURIComponent(e)];rt.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),rt.isString(i)&&o.push("path="+i),rt.isString(s)&&o.push("domain="+s),n===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VKe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function WKe(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Hte(t,e){return t&&!VKe(e)?WKe(t,e):e}const EU=t=>t instanceof Pa?{...t}:t;function Hg(t,e){e=e||{};const r={};function i(d,g,y,C){return rt.isPlainObject(d)&&rt.isPlainObject(g)?rt.merge.call({caseless:C},d,g):rt.isPlainObject(g)?rt.merge({},g):rt.isArray(g)?g.slice():g}function s(d,g,y,C){if(rt.isUndefined(g)){if(!rt.isUndefined(d))return i(void 0,d,y,C)}else return i(d,g,y,C)}function n(d,g){if(!rt.isUndefined(g))return i(void 0,g)}function o(d,g){if(rt.isUndefined(g)){if(!rt.isUndefined(d))return i(void 0,d)}else return i(void 0,g)}function l(d,g,y){if(y in e)return i(d,g);if(y in t)return i(void 0,d)}const h={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,g,y)=>s(EU(d),EU(g),y,!0)};return rt.forEach(Object.keys(Object.assign({},t,e)),function(g){const y=h[g]||s,C=y(t[g],e[g],g);rt.isUndefined(C)&&y!==l||(r[g]=C)}),r}const $te=t=>{const e=Hg({},t);let{data:r,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:n,headers:o,auth:l}=e;e.headers=o=Pa.from(o),e.url=Mte(Hte(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let h;if(rt.isFormData(r)){if(Fo.hasStandardBrowserEnv||Fo.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((h=o.getContentType())!==!1){const[d,...g]=h?h.split(";").map(y=>y.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...g].join("; "))}}if(Fo.hasStandardBrowserEnv&&(i&&rt.isFunction(i)&&(i=i(e)),i||i!==!1&&$Ke(e.url))){const d=s&&n&&BKe.read(n);d&&o.set(s,d)}return e},jKe=typeof XMLHttpRequest<"u",UKe=jKe&&function(t){return new Promise(function(r,i){const s=$te(t);let n=s.data;const o=Pa.from(s.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:d}=s,g,y,C,x,_;function E(){x&&x(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let R=new XMLHttpRequest;R.open(s.method.toUpperCase(),s.url,!0),R.timeout=s.timeout;function I(){if(!R)return;const D=Pa.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),X={data:!l||l==="text"||l==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:D,config:t,request:R};Lte(function(Y){r(Y),E()},function(Y){i(Y),E()},X),R=null}"onloadend"in R?R.onloadend=I:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(I)},R.onabort=function(){R&&(i(new Ur("Request aborted",Ur.ECONNABORTED,t,R)),R=null)},R.onerror=function(){i(new Ur("Network Error",Ur.ERR_NETWORK,t,R)),R=null},R.ontimeout=function(){let U=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const X=s.transitional||kte;s.timeoutErrorMessage&&(U=s.timeoutErrorMessage),i(new Ur(U,X.clarifyTimeoutError?Ur.ETIMEDOUT:Ur.ECONNABORTED,t,R)),R=null},n===void 0&&o.setContentType(null),"setRequestHeader"in R&&rt.forEach(o.toJSON(),function(U,X){R.setRequestHeader(X,U)}),rt.isUndefined(s.withCredentials)||(R.withCredentials=!!s.withCredentials),l&&l!=="json"&&(R.responseType=s.responseType),d&&([C,_]=XT(d,!0),R.addEventListener("progress",C)),h&&R.upload&&([y,x]=XT(h),R.upload.addEventListener("progress",y),R.upload.addEventListener("loadend",x)),(s.cancelToken||s.signal)&&(g=D=>{R&&(i(!D||D.type?new U1(null,t,R):D),R.abort(),R=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const F=DKe(s.url);if(F&&Fo.protocols.indexOf(F)===-1){i(new Ur("Unsupported protocol "+F+":",Ur.ERR_BAD_REQUEST,t));return}R.send(n||null)})},zKe=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let i=new AbortController,s;const n=function(d){if(!s){s=!0,l();const g=d instanceof Error?d:this.reason;i.abort(g instanceof Ur?g:new U1(g instanceof Error?g.message:g))}};let o=e&&setTimeout(()=>{o=null,n(new Ur(`timeout ${e} of ms exceeded`,Ur.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(n):d.removeEventListener("abort",n)}),t=null)};t.forEach(d=>d.addEventListener("abort",n));const{signal:h}=i;return h.unsubscribe=()=>rt.asap(l),h}},GKe=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let i=0,s;for(;i<r;)s=i+e,yield t.slice(i,s),i=s},YKe=async function*(t,e){for await(const r of KKe(t))yield*GKe(r,e)},KKe=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:i}=await e.read();if(r)break;yield i}}finally{await e.cancel()}},TU=(t,e,r,i)=>{const s=YKe(t,e);let n=0,o,l=h=>{o||(o=!0,i&&i(h))};return new ReadableStream({async pull(h){try{const{done:d,value:g}=await s.next();if(d){l(),h.close();return}let y=g.byteLength;if(r){let C=n+=y;r(C)}h.enqueue(new Uint8Array(g))}catch(d){throw l(d),d}},cancel(h){return l(h),s.return()}},{highWaterMark:2})},_R=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Bte=_R&&typeof ReadableStream=="function",XKe=_R&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Vte=(t,...e)=>{try{return!!t(...e)}catch{return!1}},qKe=Bte&&Vte(()=>{let t=!1;const e=new Request(Fo.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),_U=64*1024,YF=Bte&&Vte(()=>rt.isReadableStream(new Response("").body)),qT={stream:YF&&(t=>t.body)};_R&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!qT[e]&&(qT[e]=rt.isFunction(t[e])?r=>r[e]():(r,i)=>{throw new Ur(`Response type '${e}' is not supported`,Ur.ERR_NOT_SUPPORT,i)})})})(new Response);const JKe=async t=>{if(t==null)return 0;if(rt.isBlob(t))return t.size;if(rt.isSpecCompliantForm(t))return(await new Request(Fo.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(rt.isArrayBufferView(t)||rt.isArrayBuffer(t))return t.byteLength;if(rt.isURLSearchParams(t)&&(t=t+""),rt.isString(t))return(await XKe(t)).byteLength},QKe=async(t,e)=>{const r=rt.toFiniteNumber(t.getContentLength());return r??JKe(e)},ZKe=_R&&(async t=>{let{url:e,method:r,data:i,signal:s,cancelToken:n,timeout:o,onDownloadProgress:l,onUploadProgress:h,responseType:d,headers:g,withCredentials:y="same-origin",fetchOptions:C}=$te(t);d=d?(d+"").toLowerCase():"text";let x=zKe([s,n&&n.toAbortSignal()],o),_;const E=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let R;try{if(h&&qKe&&r!=="get"&&r!=="head"&&(R=await QKe(g,i))!==0){let X=new Request(e,{method:"POST",body:i,duplex:"half"}),te;if(rt.isFormData(i)&&(te=X.headers.get("content-type"))&&g.setContentType(te),X.body){const[Y,oe]=bU(R,XT(xU(h)));i=TU(X.body,_U,Y,oe)}}rt.isString(y)||(y=y?"include":"omit");const I="credentials"in Request.prototype;_=new Request(e,{...C,signal:x,method:r.toUpperCase(),headers:g.normalize().toJSON(),body:i,duplex:"half",credentials:I?y:void 0});let F=await fetch(_);const D=YF&&(d==="stream"||d==="response");if(YF&&(l||D&&E)){const X={};["status","statusText","headers"].forEach(me=>{X[me]=F[me]});const te=rt.toFiniteNumber(F.headers.get("content-length")),[Y,oe]=l&&bU(te,XT(xU(l),!0))||[];F=new Response(TU(F.body,_U,Y,()=>{oe&&oe(),E&&E()}),X)}d=d||"text";let U=await qT[rt.findKey(qT,d)||"text"](F,t);return!D&&E&&E(),await new Promise((X,te)=>{Lte(X,te,{data:U,headers:Pa.from(F.headers),status:F.status,statusText:F.statusText,config:t,request:_})})}catch(I){throw E&&E(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new Ur("Network Error",Ur.ERR_NETWORK,t,_),{cause:I.cause||I}):Ur.from(I,I&&I.code,t,_)}}),KF={http:gKe,xhr:UKe,fetch:ZKe};rt.forEach(KF,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const RU=t=>`- ${t}`,eXe=t=>rt.isFunction(t)||t===null||t===!1,Wte={getAdapter:t=>{t=rt.isArray(t)?t:[t];const{length:e}=t;let r,i;const s={};for(let n=0;n<e;n++){r=t[n];let o;if(i=r,!eXe(r)&&(i=KF[(o=String(r)).toLowerCase()],i===void 0))throw new Ur(`Unknown adapter '${o}'`);if(i)break;s[o||"#"+n]=i}if(!i){const n=Object.entries(s).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let o=e?n.length>1?`since :
`+n.map(RU).join(`
`):" "+RU(n[0]):"as no adapter specified";throw new Ur("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:KF};function b3(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new U1(null,t)}function AU(t){return b3(t),t.headers=Pa.from(t.headers),t.data=S3.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Wte.getAdapter(t.adapter||yS.adapter)(t).then(function(i){return b3(t),i.data=S3.call(t,t.transformResponse,i),i.headers=Pa.from(i.headers),i},function(i){return Dte(i)||(b3(t),i&&i.response&&(i.response.data=S3.call(t,t.transformResponse,i.response),i.response.headers=Pa.from(i.response.headers))),Promise.reject(i)})}const jte="1.7.9",RR={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{RR[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const OU={};RR.transitional=function(e,r,i){function s(n,o){return"[Axios v"+jte+"] Transitional option '"+n+"'"+o+(i?". "+i:"")}return(n,o,l)=>{if(e===!1)throw new Ur(s(o," has been removed"+(r?" in "+r:"")),Ur.ERR_DEPRECATED);return r&&!OU[o]&&(OU[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(n,o,l):!0}};RR.spelling=function(e){return(r,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function tXe(t,e,r){if(typeof t!="object")throw new Ur("options must be an object",Ur.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let s=i.length;for(;s-- >0;){const n=i[s],o=e[n];if(o){const l=t[n],h=l===void 0||o(l,n,t);if(h!==!0)throw new Ur("option "+n+" must be "+h,Ur.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Ur("Unknown option "+n,Ur.ERR_BAD_OPTION)}}const nE={assertOptions:tXe,validators:RR},pu=nE.validators;class wg{constructor(e){this.defaults=e,this.interceptors={request:new CU,response:new CU}}async request(e,r){try{return await this._request(e,r)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const n=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?n&&!String(i.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+n):i.stack=n}catch{}}throw i}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Hg(this.defaults,r);const{transitional:i,paramsSerializer:s,headers:n}=r;i!==void 0&&nE.assertOptions(i,{silentJSONParsing:pu.transitional(pu.boolean),forcedJSONParsing:pu.transitional(pu.boolean),clarifyTimeoutError:pu.transitional(pu.boolean)},!1),s!=null&&(rt.isFunction(s)?r.paramsSerializer={serialize:s}:nE.assertOptions(s,{encode:pu.function,serialize:pu.function},!0)),nE.assertOptions(r,{baseUrl:pu.spelling("baseURL"),withXsrfToken:pu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=n&&rt.merge(n.common,n[r.method]);n&&rt.forEach(["delete","get","head","post","put","patch","common"],_=>{delete n[_]}),r.headers=Pa.concat(o,n);const l=[];let h=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(r)===!1||(h=h&&E.synchronous,l.unshift(E.fulfilled,E.rejected))});const d=[];this.interceptors.response.forEach(function(E){d.push(E.fulfilled,E.rejected)});let g,y=0,C;if(!h){const _=[AU.bind(this),void 0];for(_.unshift.apply(_,l),_.push.apply(_,d),C=_.length,g=Promise.resolve(r);y<C;)g=g.then(_[y++],_[y++]);return g}C=l.length;let x=r;for(y=0;y<C;){const _=l[y++],E=l[y++];try{x=_(x)}catch(R){E.call(this,R);break}}try{g=AU.call(this,x)}catch(_){return Promise.reject(_)}for(y=0,C=d.length;y<C;)g=g.then(d[y++],d[y++]);return g}getUri(e){e=Hg(this.defaults,e);const r=Hte(e.baseURL,e.url);return Mte(r,e.params,e.paramsSerializer)}}rt.forEach(["delete","get","head","options"],function(e){wg.prototype[e]=function(r,i){return this.request(Hg(i||{},{method:e,url:r,data:(i||{}).data}))}});rt.forEach(["post","put","patch"],function(e){function r(i){return function(n,o,l){return this.request(Hg(l||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}wg.prototype[e]=r(),wg.prototype[e+"Form"]=r(!0)});class s5{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const i=this;this.promise.then(s=>{if(!i._listeners)return;let n=i._listeners.length;for(;n-- >0;)i._listeners[n](s);i._listeners=null}),this.promise.then=s=>{let n;const o=new Promise(l=>{i.subscribe(l),n=l}).then(s);return o.cancel=function(){i.unsubscribe(n)},o},e(function(n,o,l){i.reason||(i.reason=new U1(n,o,l),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=i=>{e.abort(i)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new s5(function(s){e=s}),cancel:e}}}function rXe(t){return function(r){return t.apply(null,r)}}function nXe(t){return rt.isObject(t)&&t.isAxiosError===!0}const XF={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(XF).forEach(([t,e])=>{XF[e]=t});function Ute(t){const e=new wg(t),r=Ste(wg.prototype.request,e);return rt.extend(r,wg.prototype,e,{allOwnKeys:!0}),rt.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return Ute(Hg(t,s))},r}const ws=Ute(yS);ws.Axios=wg;ws.CanceledError=U1;ws.CancelToken=s5;ws.isCancel=Dte;ws.VERSION=jte;ws.toFormData=TR;ws.AxiosError=Ur;ws.Cancel=ws.CanceledError;ws.all=function(e){return Promise.all(e)};ws.spread=rXe;ws.isAxiosError=nXe;ws.mergeConfig=Hg;ws.AxiosHeaders=Pa;ws.formToJSON=t=>Nte(rt.isHTMLForm(t)?new FormData(t):t);ws.getAdapter=Wte.getAdapter;ws.HttpStatusCode=XF;ws.default=ws;const iXe=()=>{const t=["Ngy","STT","Tn","n v","S lng","n gi","Thnh tin","Tng"],[e,r]=We.useState([]),[i,s]=We.useState([]),[n,o]=We.useState(null),[l,h]=We.useState(""),[d,g]=We.useState(!1),[y,C]=We.useState(""),[x,_]=We.useState([]),[E,R]=We.useState(!1),[I,F]=We.useState(""),D=We.useRef(null);We.useEffect(()=>{const Ze=Xe=>{D.current&&!D.current.contains(Xe.target)&&R(!1)};return document.addEventListener("mousedown",Ze),()=>document.removeEventListener("mousedown",Ze)},[]);function U(Ze){const Xe={};return Ze.forEach(Pe=>{Xe[Pe]=""}),Xe}const X=()=>{if(!y){alert("Vui lng nhp tn file");return}h(y),r(t);const Ze=Array(15).fill(null).map(()=>U(t));s(Ze),g(!1),C("")},te=()=>{const Ze=[...i,U(e)];s(ye(Ze))},Y=()=>{const Ze=prompt("Nhp tn ct mi:");if(Ze&&!e.includes(Ze)){const Xe=[...e,Ze];r(Xe);const Pe=i.map(Be=>({...Be,[Ze]:""}));s(Pe)}},oe=(Ze,Xe)=>{const[Pe,Be]=Ze.split("/").map(Number),[Me,A]=Xe.split("/").map(Number);return Be!==A?Be-A:Pe-Me},me=(Ze,Xe,Pe)=>{if(!Xe.Ngy)return"";let Be="",Me=Pe;for(let N=Pe;N>=0;N--)if(Ze[N].Ngy&&Ze[N].STT){Be=Ze[N].STT,Me=N;break}if(!Be)return"";let A=Pe+1;for(;A<Ze.length&&(!Ze[A].Ngy||!Ze[A].STT);)A++;let O=0;for(let N=Me;N<A;N++)Ze[N]["Thnh tin"]&&(O+=Number(Ze[N]["Thnh tin"])||0);return O||""},de=(Ze,Xe,Pe)=>{let Be=[...i];if(Xe==="Ngy"){if(!/^(0?[1-9]|[12][0-9]|3[01])\/(0?[1-9]|1[0-2])$/.test(Pe)&&Pe!==""){alert("Vui lng nhp ngy theo nh dng dd/mm");return}Be[Ze][Xe]=Pe,Be=ye(Be)}else if(Xe==="S lng"||Xe==="n gi"){const Me=Pe.replace(/[^0-9]/g,"");Be[Ze][Xe]=Me;const A=Number(Be[Ze]["S lng"])||0,O=Number(Be[Ze]["n gi"])||0;Be[Ze]["Thnh tin"]=A*O,Be=Be.map((N,H)=>(N.Ngy?N.Tng=me(Be,N,H):N.Tng="",N))}else Xe!=="STT"&&Xe!=="Thnh tin"&&Xe!=="Tng"&&(Be[Ze][Xe]=Pe);s(Be),Xe!=="Tn"&&o(null)},ye=Ze=>{const Xe=Ze.map((Pe,Be)=>({...Pe,originalIndex:Be})).filter(Pe=>Pe.Ngy);if(Xe.length>0){Xe.sort((A,O)=>oe(A.Ngy,O.Ngy));let Pe=1;const Be=new Map;Xe.forEach(A=>{Be.set(A.originalIndex,Pe++)});const Me=Ze.map((A,O)=>(A.Ngy?(A.STT=Be.get(O),A.Tng=me(Ze,A)):(A.STT="",A.Tng=""),A));for(let A=0;A<Me.length;A++){const O=me(Me,Me[A],A);O>0?Me[A].Tng=O:Me[A].Tng=""}return Me}return Ze},Ee=()=>{try{if(!i||!e||e.length===0)throw new Error("D liu khng hp l");const Ze=i.filter(Z=>Object.values(Z).some(we=>we!==""&&we!==null&&we!==void 0)),Xe=Fw.book_new(),Pe=[["Tn file"],[],e];Ze.forEach(Z=>{const we=e.map(Ce=>Z[Ce]||"");Pe.push(we)});const Be=Ze.reduce((Z,we)=>Z+(Number(we["Thnh tin"])||0),0),Me=Ze.reduce((Z,we)=>Z+(Number(we.Tng)||0),0),A=Be*.03,O=Me*.03,N=Be-A,H=Me-O;Pe.push(Array(e.length).fill(""),["","","Tng tin","","","",Be,Me],["","","Chit khu 3%","","","",A,O],["","","Tng","","","",N,H]);const B=Fw.aoa_to_sheet(Pe);B["!merges"]=[{s:{r:0,c:0},e:{r:0,c:4}}];const K=Fw.decode_range(B["!ref"]);for(let Z=K.s.r;Z<=K.e.r;Z++)for(let we=K.s.c;we<=K.e.c;we++){const Ce=Fw.encode_cell({r:Z,c:we});B[Ce]&&(B[Ce].s={font:{name:"Arial",sz:Z===0?40:11,bold:Z===0||Z===2||Z>K.e.r-3},alignment:{vertical:"center",horizontal:we===2?"left":"center",wrapText:!0},border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}},Z>2&&(we===5||we===6||we===7)&&(B[Ce].z="#,##0",B[Ce].v&&(B[Ce].t="n")))}B["!cols"]=e.map(Z=>({wch:Z==="Tn"?30:15})),B["!rows"]=[{hpt:50}],Fw.book_append_sheet(Xe,B,"Bng d liu"),pYe(Xe,`${l||"bang_du_lieu"}.xlsx`)}catch(Ze){throw console.error("Li xut Excel:",Ze),new Error("Khng th xut file Excel. Vui lng th li.")}},ke=async Ze=>{try{const Pe=(await ws.get("https://backend-giahung.onrender.com/api/products?limit=9999")).data.data.filter(Be=>Be.name.toLowerCase().includes(Ze.toLowerCase()));_(Pe)}catch(Xe){console.error("Error searching products:",Xe)}},nt=(Ze,Xe)=>{const Pe=[...i];if(Pe[Xe].Tn=Ze.name,Pe[Xe]["n v"]=Ze.unit,Pe[Xe]["n gi"]=Ze.price,Pe[Xe]["S lng"]){const Be=Number(Pe[Xe]["S lng"]);Pe[Xe]["Thnh tin"]=Be*Ze.price}s(Pe),R(!1),F("")},at=Ze=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(Ze);return V.jsxs("div",{className:"tool-container",children:[V.jsx("h1",{children:"Excel Tool"}),V.jsxs("div",{className:"tool-header",children:[V.jsx("button",{onClick:()=>g(!0),className:"create-btn",children:"Create New File"}),l&&V.jsxs("div",{className:"current-file",children:["Current file: ",l]})]}),d&&V.jsx("div",{className:"modal",children:V.jsxs("div",{className:"modal-content",children:[V.jsx("h2",{children:"Create New Excel File"}),V.jsx("input",{type:"text",value:y,onChange:Ze=>C(Ze.target.value),placeholder:"Enter file name (without extension)",className:"file-name-input"}),V.jsxs("div",{className:"modal-buttons",children:[V.jsx("button",{onClick:X,className:"create-btn",children:"Create"}),V.jsx("button",{onClick:()=>{g(!1),C("")},className:"cancel-btn",children:"Cancel"})]})]})}),e.length>0&&V.jsxs(V.Fragment,{children:[V.jsxs("div",{className:"table-controls",children:[V.jsx("button",{onClick:te,className:"control-btn",children:"Add Row"}),V.jsx("button",{onClick:Y,className:"control-btn",children:"Add Column"}),V.jsx("button",{onClick:Ee,className:"export-btn",children:"Export to Excel"})]}),V.jsx("div",{className:"table-container",children:V.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[V.jsx("thead",{children:V.jsx("tr",{children:e.map(Ze=>V.jsx("th",{className:"border border-gray-300 bg-gray-100 px-4 py-2 text-center",children:Ze},Ze))})}),V.jsx("tbody",{children:i.map((Ze,Xe)=>V.jsx("tr",{children:e.map(Pe=>V.jsx("td",{onClick:()=>{["STT","Thnh tin","Tng"].includes(Pe)||(o({rowIndex:Xe,column:Pe}),Pe==="Tn"&&F(Ze[Pe]))},className:`relative border border-gray-300 px-4 py-2
                          ${!Ze.Ngy&&(Pe==="STT"||Pe==="Tng")?"text-transparent":""}
                          ${["STT","Thnh tin","Tng"].includes(Pe)?"bg-gray-50":""}
                          ${["Ngy","STT","n v","S lng","n gi","Thnh tin","Tng"].includes(Pe)?"text-center":""}
                          ${Pe==="Tn"?"text-left":""}`,children:(n==null?void 0:n.rowIndex)===Xe&&(n==null?void 0:n.column)===Pe?V.jsxs("div",{ref:Pe==="Tn"?D:null,children:[V.jsx("input",{type:"text",value:Pe==="Tn"?I:Ze[Pe],autoFocus:!0,className:`w-full px-2 py-1 border border-blue-500 rounded
                                ${["Ngy","STT","n v","S lng","n gi","Thnh tin","Tng"].includes(Pe)?"text-center":"text-left"}`,onChange:Be=>{if(Pe==="Tn")F(Be.target.value),ke(Be.target.value),R(!0);else{const Me=[...i];Me[Xe][Pe]=Be.target.value,s(Me)}},onBlur:Be=>{de(Xe,Pe,Be.target.value),Pe!=="Tn"&&o(null)},onKeyPress:Be=>{Be.key==="Enter"&&(de(Xe,Pe,Be.target.value),o(null))}}),Pe==="Tn"&&E&&x.length>0&&V.jsx("div",{className:"suggestions-container",children:x.map((Be,Me)=>V.jsx("div",{className:"suggestion-item",onClick:()=>nt(Be,Xe),children:Be.name},Me))})]}):!Ze.Ngy&&(Pe==="STT"||Pe==="Tng")?"":["n gi","Thnh tin","Tng"].includes(Pe)&&Ze[Pe]!==""?at(Number(Ze[Pe])||0):Ze[Pe]},`${Xe}-${Pe}`))},Xe))})]})})]})]})},sXe=()=>{const t=GM(),e=MC(),[r,i]=We.useState(!0),[s,n]=We.useState("dashboard"),[o,l]=We.useState("");We.useEffect(()=>{const g=localStorage.getItem("userRole");l(g||"")},[]),br.useEffect(()=>{var g;(g=e.state)!=null&&g.showToast&&zt.success("ng nhp thnh cng!")},[e]);const h=()=>{localStorage.removeItem("token"),t("/login")},d=()=>[{id:"dashboard",label:"Dashboard",icon:""},{id:"products",label:"Products",icon:""},{id:"categories",label:"Categories",icon:""},{id:"customers",label:"Customers",icon:""},{id:"settings",label:"Settings",icon:""},{id:"tool",label:"Tool",icon:""}];return V.jsxs("div",{className:"min-h-1 flex bg-gray-100",children:[V.jsxs("div",{className:`bg-white shadow-lg ${r?"w-64":"w-20"} transition-all duration-300`,children:[V.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[V.jsx("h2",{className:`font-bold ${r?"block":"hidden"}`,children:"Admin Panel"}),V.jsx("button",{onClick:()=>i(!r),className:"p-2 rounded-lg hover:bg-gray-100",children:r?"":""})]}),V.jsx("nav",{className:"mt-4",children:d().map(g=>V.jsxs("button",{onClick:()=>n(g.id),className:`w-full flex items-center p-3 hover:bg-blue-50 transition-colors
                ${s===g.id?"bg-blue-100 text-blue-600":""}
                ${r?"justify-start":"justify-center"}`,children:[V.jsx("span",{className:"text-xl",children:g.icon}),r&&V.jsx("span",{className:"ml-3",children:g.label})]},g.id))})]}),V.jsxs("div",{className:"flex-1",children:[V.jsx("header",{className:"bg-white shadow-md",children:V.jsxs("div",{className:"flex justify-between items-center px-8 py-4",children:[V.jsx("h1",{className:"text-2xl font-bold",children:"Welcome to Dashboard"}),V.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Logout"})]})}),V.jsx("main",{className:"p-8",children:V.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s==="dashboard"&&V.jsx(gce,{}),s==="products"&&V.jsx(hce,{}),s==="categories"&&V.jsx(fce,{}),s==="customers"&&V.jsx(dce,{}),s==="settings"&&V.jsx($9e,{}),s==="tool"&&V.jsx(iXe,{})]})})]}),V.jsx(hY,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})},yh="https://backend-giahung.onrender.com/api",IU={async login(t){try{console.log("Login request:",{url:`${yh}/auth/login`,body:t});const r=await(await fetch(`${yh}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("Login response:",r),r.status==="success"&&(localStorage.setItem("token",r.tokens.accessToken),localStorage.setItem("userName",r.user.name),localStorage.setItem("userRole",r.user.role),localStorage.setItem("userId",r.user.id),console.log("Stored user info:",{token:r.tokens.accessToken,name:r.user.name,role:r.user.role,id:r.user.id})),r}catch(e){throw console.error("Login error:",e),e}},async register(t){try{console.log("Register request:",{url:`${yh}/auth/register`,body:t});const r=await(await fetch(`${yh}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("Register response:",r),r}catch(e){throw console.error("Register error:",e),e}},async getProducts(){return(await fetch(`${yh}/products`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json()},async getCategories(){return(await fetch(`${yh}/categories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json()},async verifyToken(){try{const t=localStorage.getItem("token");return t?(await fetch(`${yh}users/me`,{headers:{Authorization:`Bearer ${t}`}})).ok:!1}catch{return!1}},async getCurrentUser(){try{const t=localStorage.getItem("token");console.log("Token for getCurrentUser:",t);const e=await fetch(`${yh}/auth/profile`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to get user data");const r=await e.json();return console.log("Get user response:",r),r}catch(t){throw console.error("Get user error:",t),t}},async refreshToken(){try{const t=localStorage.getItem("refreshToken"),r=await(await fetch(`${yh}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})})).json();return console.log("Refresh token response:",r),r}catch(t){throw console.error("Refresh token error:",t),t}}};function oXe(){const t=GM(),[e,r]=We.useState(!0),[i,s]=We.useState({email:"",password:"",name:""}),n=async o=>{o.preventDefault();try{if(e){const l=await IU.login(i);l.status==="success"?(localStorage.setItem("token",l.tokens.accessToken),zt.success("ng nhp thnh cng!"),t("/",{replace:!0})):zt.error("ng nhp tht bi. Vui lng kim tra li thng tin!")}else{const l=await IU.register(i);l.user&&l.tokens?(zt.success("ng k thnh cng!"),r(!0)):zt.error("ng k tht bi. Vui lng th li!")}}catch(l){console.error(e?"Login error:":"Signup error:",l),zt.error(e?"ng nhp tht bi!":"ng k tht bi!")}};return V.jsxs("div",{className:"min-h-screen",children:[V.jsx(hY,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),V.jsx("div",{className:"wrapper",children:V.jsxs("div",{className:"form-box",children:[V.jsxs("div",{className:"button-box",children:[V.jsx("button",{className:`toggle-btn ${e?"active":""}`,onClick:()=>r(!0),children:"Login"}),V.jsx("button",{className:`toggle-btn ${e?"":"active"}`,onClick:()=>r(!1),children:"Sign up"})]}),V.jsxs("form",{onSubmit:n,className:`input-group ${e?"active":""}`,children:[V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"email",placeholder:"Email",value:i.email,onChange:o=>s({...i,email:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"password",placeholder:"Password",value:i.password,onChange:o=>s({...i,password:o.target.value}),required:!0})}),e&&V.jsx("div",{className:"forgot-password",children:V.jsx("a",{href:"#",children:"Forgot Password?"})}),V.jsx("button",{type:"submit",className:"submit-btn",children:e?"Login":"Sign up"})]}),V.jsxs("form",{onSubmit:n,className:`input-group ${e?"":"active"}`,children:[V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"text",placeholder:"Full Name",value:i.name,onChange:o=>s({...i,name:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"email",placeholder:"Email",value:i.email,onChange:o=>s({...i,email:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"password",placeholder:"Password",value:i.password,onChange:o=>s({...i,password:o.target.value}),required:!0})}),V.jsx("button",{type:"submit",className:"submit-btn",children:"Sign up"})]})]})})]})}const aXe=({children:t})=>localStorage.getItem("token")?t:V.jsx(nY,{to:"/login"});function lXe(){return V.jsx(yle,{children:V.jsxs(ple,{children:[V.jsx(A2,{path:"/",element:V.jsx(aXe,{children:V.jsx(sXe,{})})}),V.jsx(A2,{path:"/login",element:V.jsx(oXe,{})}),V.jsx(A2,{path:"*",element:V.jsx(nY,{to:"/"})})]})})}x3.createRoot(document.getElementById("root")).render(V.jsx(br.StrictMode,{children:V.jsx(lXe,{})}))});export default cXe();
