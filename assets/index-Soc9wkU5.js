var ese=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var cXe=ese((OXe,iE)=>{function tse(t,e){for(var r=0;r<e.length;r++){const i=e[r];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in t)){const n=Object.getOwnPropertyDescriptor(i,s);n&&Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var kw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function JF(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rse(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var s=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:function(){return t[i]}})}),r}var PU={exports:{}},JT={},FU={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C=Symbol.for("react.element"),nse=Symbol.for("react.portal"),ise=Symbol.for("react.fragment"),sse=Symbol.for("react.strict_mode"),ose=Symbol.for("react.profiler"),ase=Symbol.for("react.provider"),lse=Symbol.for("react.context"),cse=Symbol.for("react.forward_ref"),use=Symbol.for("react.suspense"),hse=Symbol.for("react.memo"),fse=Symbol.for("react.lazy"),YH=Symbol.iterator;function dse(t){return t===null||typeof t!="object"?null:(t=YH&&t[YH]||t["@@iterator"],typeof t=="function"?t:null)}var MU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kU=Object.assign,NU={};function w1(t,e,r){this.props=t,this.context=e,this.refs=NU,this.updater=r||MU}w1.prototype.isReactComponent={};w1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};w1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function DU(){}DU.prototype=w1.prototype;function QF(t,e,r){this.props=t,this.context=e,this.refs=NU,this.updater=r||MU}var ZF=QF.prototype=new DU;ZF.constructor=QF;kU(ZF,w1.prototype);ZF.isPureReactComponent=!0;var KH=Array.isArray,LU=Object.prototype.hasOwnProperty,eM={current:null},HU={key:!0,ref:!0,__self:!0,__source:!0};function $U(t,e,r){var i,s={},n=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(n=""+e.key),e)LU.call(e,i)&&!HU.hasOwnProperty(i)&&(s[i]=e[i]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var h=Array(l),d=0;d<l;d++)h[d]=arguments[d+2];s.children=h}if(t&&t.defaultProps)for(i in l=t.defaultProps,l)s[i]===void 0&&(s[i]=l[i]);return{$$typeof:_C,type:t,key:n,ref:o,props:s,_owner:eM.current}}function gse(t,e){return{$$typeof:_C,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function tM(t){return typeof t=="object"&&t!==null&&t.$$typeof===_C}function mse(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var XH=/\/+/g;function jA(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mse(""+t.key):e.toString(36)}function p2(t,e,r,i,s){var n=typeof t;(n==="undefined"||n==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(n){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case _C:case nse:o=!0}}if(o)return o=t,s=s(o),t=i===""?"."+jA(o,0):i,KH(s)?(r="",t!=null&&(r=t.replace(XH,"$&/")+"/"),p2(s,e,r,"",function(d){return d})):s!=null&&(tM(s)&&(s=gse(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(XH,"$&/")+"/")+t)),e.push(s)),1;if(o=0,i=i===""?".":i+":",KH(t))for(var l=0;l<t.length;l++){n=t[l];var h=i+jA(n,l);o+=p2(n,e,r,h,s)}else if(h=dse(t),typeof h=="function")for(t=h.call(t),l=0;!(n=t.next()).done;)n=n.value,h=i+jA(n,l++),o+=p2(n,e,r,h,s);else if(n==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function rb(t,e,r){if(t==null)return t;var i=[],s=0;return p2(t,i,"","",function(n){return e.call(r,n,s++)}),i}function pse(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ca={current:null},v2={transition:null},vse={ReactCurrentDispatcher:ca,ReactCurrentBatchConfig:v2,ReactCurrentOwner:eM};function BU(){throw Error("act(...) is not supported in production builds of React.")}cn.Children={map:rb,forEach:function(t,e,r){rb(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return rb(t,function(){e++}),e},toArray:function(t){return rb(t,function(e){return e})||[]},only:function(t){if(!tM(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cn.Component=w1;cn.Fragment=ise;cn.Profiler=ose;cn.PureComponent=QF;cn.StrictMode=sse;cn.Suspense=use;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vse;cn.act=BU;cn.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=kU({},t.props),s=t.key,n=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(n=e.ref,o=eM.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(h in e)LU.call(e,h)&&!HU.hasOwnProperty(h)&&(i[h]=e[h]===void 0&&l!==void 0?l[h]:e[h])}var h=arguments.length-2;if(h===1)i.children=r;else if(1<h){l=Array(h);for(var d=0;d<h;d++)l[d]=arguments[d+2];i.children=l}return{$$typeof:_C,type:t.type,key:s,ref:n,props:i,_owner:o}};cn.createContext=function(t){return t={$$typeof:lse,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ase,_context:t},t.Consumer=t};cn.createElement=$U;cn.createFactory=function(t){var e=$U.bind(null,t);return e.type=t,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(t){return{$$typeof:cse,render:t}};cn.isValidElement=tM;cn.lazy=function(t){return{$$typeof:fse,_payload:{_status:-1,_result:t},_init:pse}};cn.memo=function(t,e){return{$$typeof:hse,type:t,compare:e===void 0?null:e}};cn.startTransition=function(t){var e=v2.transition;v2.transition={};try{t()}finally{v2.transition=e}};cn.unstable_act=BU;cn.useCallback=function(t,e){return ca.current.useCallback(t,e)};cn.useContext=function(t){return ca.current.useContext(t)};cn.useDebugValue=function(){};cn.useDeferredValue=function(t){return ca.current.useDeferredValue(t)};cn.useEffect=function(t,e){return ca.current.useEffect(t,e)};cn.useId=function(){return ca.current.useId()};cn.useImperativeHandle=function(t,e,r){return ca.current.useImperativeHandle(t,e,r)};cn.useInsertionEffect=function(t,e){return ca.current.useInsertionEffect(t,e)};cn.useLayoutEffect=function(t,e){return ca.current.useLayoutEffect(t,e)};cn.useMemo=function(t,e){return ca.current.useMemo(t,e)};cn.useReducer=function(t,e,r){return ca.current.useReducer(t,e,r)};cn.useRef=function(t){return ca.current.useRef(t)};cn.useState=function(t){return ca.current.useState(t)};cn.useSyncExternalStore=function(t,e,r){return ca.current.useSyncExternalStore(t,e,r)};cn.useTransition=function(){return ca.current.useTransition()};cn.version="18.3.1";FU.exports=cn;var He=FU.exports;const Cr=JF(He),wse=tse({__proto__:null,default:Cr},[He]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yse=He,Cse=Symbol.for("react.element"),Sse=Symbol.for("react.fragment"),bse=Object.prototype.hasOwnProperty,xse=yse.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ese={key:!0,ref:!0,__self:!0,__source:!0};function VU(t,e,r){var i,s={},n=null,o=null;r!==void 0&&(n=""+r),e.key!==void 0&&(n=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)bse.call(e,i)&&!Ese.hasOwnProperty(i)&&(s[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:Cse,type:t,key:n,ref:o,props:s,_owner:xse.current}}JT.Fragment=Sse;JT.jsx=VU;JT.jsxs=VU;PU.exports=JT;var V=PU.exports,E3={},WU={exports:{}},ul={},jU={exports:{}},UU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ue,Je){var Fe=Ue.length;Ue.push(Je);e:for(;0<Fe;){var A=Fe-1>>>1,O=Ue[A];if(0<s(O,Je))Ue[A]=Je,Ue[Fe]=O,Fe=A;else break e}}function r(Ue){return Ue.length===0?null:Ue[0]}function i(Ue){if(Ue.length===0)return null;var Je=Ue[0],Fe=Ue.pop();if(Fe!==Je){Ue[0]=Fe;e:for(var A=0,O=Ue.length,k=O>>>1;A<k;){var L=2*(A+1)-1,D=Ue[L],K=L+1,Q=Ue[K];if(0>s(D,Fe))K<O&&0>s(Q,D)?(Ue[A]=Q,Ue[K]=Fe,A=K):(Ue[A]=D,Ue[L]=Fe,A=L);else if(K<O&&0>s(Q,Fe))Ue[A]=Q,Ue[K]=Fe,A=K;else break e}}return Je}function s(Ue,Je){var Fe=Ue.sortIndex-Je.sortIndex;return Fe!==0?Fe:Ue.id-Je.id}if(typeof performance=="object"&&typeof performance.now=="function"){var n=performance;t.unstable_now=function(){return n.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var h=[],d=[],g=1,y=null,C=3,x=!1,_=!1,E=!1,R=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(Ue){for(var Je=r(d);Je!==null;){if(Je.callback===null)i(d);else if(Je.startTime<=Ue)i(d),Je.sortIndex=Je.expirationTime,e(h,Je);else break;Je=r(d)}}function z(Ue){if(E=!1,H(Ue),!_)if(r(h)!==null)_=!0,Ct(q);else{var Je=r(d);Je!==null&&ct(z,Je.startTime-Ue)}}function q(Ue,Je){_=!1,E&&(E=!1,I(oe),oe=-1),x=!0;var Fe=C;try{for(H(Je),y=r(h);y!==null&&(!(y.expirationTime>Je)||Ue&&!Re());){var A=y.callback;if(typeof A=="function"){y.callback=null,C=y.priorityLevel;var O=A(y.expirationTime<=Je);Je=t.unstable_now(),typeof O=="function"?y.callback=O:y===r(h)&&i(h),H(Je)}else i(h);y=r(h)}if(y!==null)var k=!0;else{var L=r(d);L!==null&&ct(z,L.startTime-Je),k=!1}return k}finally{y=null,C=Fe,x=!1}}var re=!1,Y=null,oe=-1,me=5,de=-1;function Re(){return!(t.unstable_now()-de<me)}function Ie(){if(Y!==null){var Ue=t.unstable_now();de=Ue;var Je=!0;try{Je=Y(!0,Ue)}finally{Je?Be():(re=!1,Y=null)}}else re=!1}var Be;if(typeof F=="function")Be=function(){F(Ie)};else if(typeof MessageChannel<"u"){var lt=new MessageChannel,pt=lt.port2;lt.port1.onmessage=Ie,Be=function(){pt.postMessage(null)}}else Be=function(){R(Ie,0)};function Ct(Ue){Y=Ue,re||(re=!0,Be())}function ct(Ue,Je){oe=R(function(){Ue(t.unstable_now())},Je)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ue){Ue.callback=null},t.unstable_continueExecution=function(){_||x||(_=!0,Ct(q))},t.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<Ue?Math.floor(1e3/Ue):5},t.unstable_getCurrentPriorityLevel=function(){return C},t.unstable_getFirstCallbackNode=function(){return r(h)},t.unstable_next=function(Ue){switch(C){case 1:case 2:case 3:var Je=3;break;default:Je=C}var Fe=C;C=Je;try{return Ue()}finally{C=Fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ue,Je){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var Fe=C;C=Ue;try{return Je()}finally{C=Fe}},t.unstable_scheduleCallback=function(Ue,Je,Fe){var A=t.unstable_now();switch(typeof Fe=="object"&&Fe!==null?(Fe=Fe.delay,Fe=typeof Fe=="number"&&0<Fe?A+Fe:A):Fe=A,Ue){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=Fe+O,Ue={id:g++,callback:Je,priorityLevel:Ue,startTime:Fe,expirationTime:O,sortIndex:-1},Fe>A?(Ue.sortIndex=Fe,e(d,Ue),r(h)===null&&Ue===r(d)&&(E?(I(oe),oe=-1):E=!0,ct(z,Fe-A))):(Ue.sortIndex=O,e(h,Ue),_||x||(_=!0,Ct(q))),Ue},t.unstable_shouldYield=Re,t.unstable_wrapCallback=function(Ue){var Je=C;return function(){var Fe=C;C=Je;try{return Ue.apply(this,arguments)}finally{C=Fe}}}})(UU);jU.exports=UU;var Tse=jU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _se=He,al=Tse;function _t(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zU=new Set,Iy={};function Bg(t,e){e1(t,e),e1(t+"Capture",e)}function e1(t,e){for(Iy[t]=e,t=0;t<e.length;t++)zU.add(e[t])}var qh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),T3=Object.prototype.hasOwnProperty,Rse=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qH={},JH={};function Ase(t){return T3.call(JH,t)?!0:T3.call(qH,t)?!1:Rse.test(t)?JH[t]=!0:(qH[t]=!0,!1)}function Ose(t,e,r,i){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ise(t,e,r,i){if(e===null||typeof e>"u"||Ose(t,e,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ua(t,e,r,i,s,n,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=n,this.removeEmptyString=o}var ho={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ho[t]=new ua(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ho[e]=new ua(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ho[t]=new ua(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ho[t]=new ua(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ho[t]=new ua(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ho[t]=new ua(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ho[t]=new ua(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ho[t]=new ua(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ho[t]=new ua(t,5,!1,t.toLowerCase(),null,!1,!1)});var rM=/[\-:]([a-z])/g;function nM(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(rM,nM);ho[e]=new ua(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(rM,nM);ho[e]=new ua(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(rM,nM);ho[e]=new ua(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ho[t]=new ua(t,1,!1,t.toLowerCase(),null,!1,!1)});ho.xlinkHref=new ua("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ho[t]=new ua(t,1,!1,t.toLowerCase(),null,!0,!0)});function iM(t,e,r,i){var s=ho.hasOwnProperty(e)?ho[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ise(e,r,s,i)&&(r=null),i||s===null?Ase(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,i=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,i?t.setAttributeNS(i,e,r):t.setAttribute(e,r))))}var lf=_se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nb=Symbol.for("react.element"),mp=Symbol.for("react.portal"),pp=Symbol.for("react.fragment"),sM=Symbol.for("react.strict_mode"),_3=Symbol.for("react.profiler"),GU=Symbol.for("react.provider"),YU=Symbol.for("react.context"),oM=Symbol.for("react.forward_ref"),R3=Symbol.for("react.suspense"),A3=Symbol.for("react.suspense_list"),aM=Symbol.for("react.memo"),jf=Symbol.for("react.lazy"),KU=Symbol.for("react.offscreen"),QH=Symbol.iterator;function yv(t){return t===null||typeof t!="object"?null:(t=QH&&t[QH]||t["@@iterator"],typeof t=="function"?t:null)}var Vi=Object.assign,UA;function Nw(t){if(UA===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);UA=e&&e[1]||""}return`
`+UA+t}var zA=!1;function GA(t,e){if(!t||zA)return"";zA=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var i=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){i=d}t.call(e.prototype)}else{try{throw Error()}catch(d){i=d}t()}}catch(d){if(d&&i&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),n=i.stack.split(`
`),o=s.length-1,l=n.length-1;1<=o&&0<=l&&s[o]!==n[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==n[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==n[l]){var h=`
`+s[o].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=o&&0<=l);break}}}finally{zA=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Nw(t):""}function Pse(t){switch(t.tag){case 5:return Nw(t.type);case 16:return Nw("Lazy");case 13:return Nw("Suspense");case 19:return Nw("SuspenseList");case 0:case 2:case 15:return t=GA(t.type,!1),t;case 11:return t=GA(t.type.render,!1),t;case 1:return t=GA(t.type,!0),t;default:return""}}function O3(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pp:return"Fragment";case mp:return"Portal";case _3:return"Profiler";case sM:return"StrictMode";case R3:return"Suspense";case A3:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case YU:return(t.displayName||"Context")+".Consumer";case GU:return(t._context.displayName||"Context")+".Provider";case oM:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case aM:return e=t.displayName||null,e!==null?e:O3(t.type)||"Memo";case jf:e=t._payload,t=t._init;try{return O3(t(e))}catch{}}return null}function Fse(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return O3(e);case 8:return e===sM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function _d(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function XU(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Mse(t){var e=XU(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,n=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,n.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ib(t){t._valueTracker||(t._valueTracker=Mse(t))}function qU(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),i="";return t&&(i=XU(t)?t.checked?"true":"false":t.value),t=i,t!==r?(e.setValue(t),!0):!1}function sE(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function I3(t,e){var r=e.checked;return Vi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function ZH(t,e){var r=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;r=_d(e.value!=null?e.value:r),t._wrapperState={initialChecked:i,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function JU(t,e){e=e.checked,e!=null&&iM(t,"checked",e,!1)}function P3(t,e){JU(t,e);var r=_d(e.value),i=e.type;if(r!=null)i==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?F3(t,e.type,r):e.hasOwnProperty("defaultValue")&&F3(t,e.type,_d(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function e7(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function F3(t,e,r){(e!=="number"||sE(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Dw=Array.isArray;function Np(t,e,r,i){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&i&&(t[r].defaultSelected=!0)}else{for(r=""+_d(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,i&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function M3(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_t(91));return Vi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function t7(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(_t(92));if(Dw(r)){if(1<r.length)throw Error(_t(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:_d(r)}}function QU(t,e){var r=_d(e.value),i=_d(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),i!=null&&(t.defaultValue=""+i)}function r7(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ZU(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function k3(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ZU(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var sb,ez=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,i,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,i,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(sb=sb||document.createElement("div"),sb.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=sb.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Py(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Yw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kse=["Webkit","ms","Moz","O"];Object.keys(Yw).forEach(function(t){kse.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yw[e]=Yw[t]})});function tz(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Yw.hasOwnProperty(t)&&Yw[t]?(""+e).trim():e+"px"}function rz(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var i=r.indexOf("--")===0,s=tz(r,e[r],i);r==="float"&&(r="cssFloat"),i?t.setProperty(r,s):t[r]=s}}var Nse=Vi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function N3(t,e){if(e){if(Nse[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_t(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_t(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_t(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_t(62))}}function D3(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var L3=null;function lM(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var H3=null,Dp=null,Lp=null;function n7(t){if(t=OC(t)){if(typeof H3!="function")throw Error(_t(280));var e=t.stateNode;e&&(e=r_(e),H3(t.stateNode,t.type,e))}}function nz(t){Dp?Lp?Lp.push(t):Lp=[t]:Dp=t}function iz(){if(Dp){var t=Dp,e=Lp;if(Lp=Dp=null,n7(t),e)for(t=0;t<e.length;t++)n7(e[t])}}function sz(t,e){return t(e)}function oz(){}var YA=!1;function az(t,e,r){if(YA)return t(e,r);YA=!0;try{return sz(t,e,r)}finally{YA=!1,(Dp!==null||Lp!==null)&&(oz(),iz())}}function Fy(t,e){var r=t.stateNode;if(r===null)return null;var i=r_(r);if(i===null)return null;r=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(_t(231,e,typeof r));return r}var $3=!1;if(qh)try{var Cv={};Object.defineProperty(Cv,"passive",{get:function(){$3=!0}}),window.addEventListener("test",Cv,Cv),window.removeEventListener("test",Cv,Cv)}catch{$3=!1}function Dse(t,e,r,i,s,n,o,l,h){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(g){this.onError(g)}}var Kw=!1,oE=null,aE=!1,B3=null,Lse={onError:function(t){Kw=!0,oE=t}};function Hse(t,e,r,i,s,n,o,l,h){Kw=!1,oE=null,Dse.apply(Lse,arguments)}function $se(t,e,r,i,s,n,o,l,h){if(Hse.apply(this,arguments),Kw){if(Kw){var d=oE;Kw=!1,oE=null}else throw Error(_t(198));aE||(aE=!0,B3=d)}}function Vg(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function lz(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function i7(t){if(Vg(t)!==t)throw Error(_t(188))}function Bse(t){var e=t.alternate;if(!e){if(e=Vg(t),e===null)throw Error(_t(188));return e!==t?null:t}for(var r=t,i=e;;){var s=r.return;if(s===null)break;var n=s.alternate;if(n===null){if(i=s.return,i!==null){r=i;continue}break}if(s.child===n.child){for(n=s.child;n;){if(n===r)return i7(s),t;if(n===i)return i7(s),e;n=n.sibling}throw Error(_t(188))}if(r.return!==i.return)r=s,i=n;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,i=n;break}if(l===i){o=!0,i=s,r=n;break}l=l.sibling}if(!o){for(l=n.child;l;){if(l===r){o=!0,r=n,i=s;break}if(l===i){o=!0,i=n,r=s;break}l=l.sibling}if(!o)throw Error(_t(189))}}if(r.alternate!==i)throw Error(_t(190))}if(r.tag!==3)throw Error(_t(188));return r.stateNode.current===r?t:e}function cz(t){return t=Bse(t),t!==null?uz(t):null}function uz(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=uz(t);if(e!==null)return e;t=t.sibling}return null}var hz=al.unstable_scheduleCallback,s7=al.unstable_cancelCallback,Vse=al.unstable_shouldYield,Wse=al.unstable_requestPaint,ss=al.unstable_now,jse=al.unstable_getCurrentPriorityLevel,cM=al.unstable_ImmediatePriority,fz=al.unstable_UserBlockingPriority,lE=al.unstable_NormalPriority,Use=al.unstable_LowPriority,dz=al.unstable_IdlePriority,QT=null,$u=null;function zse(t){if($u&&typeof $u.onCommitFiberRoot=="function")try{$u.onCommitFiberRoot(QT,t,void 0,(t.current.flags&128)===128)}catch{}}var Ic=Math.clz32?Math.clz32:Kse,Gse=Math.log,Yse=Math.LN2;function Kse(t){return t>>>=0,t===0?32:31-(Gse(t)/Yse|0)|0}var ob=64,ab=4194304;function Lw(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function cE(t,e){var r=t.pendingLanes;if(r===0)return 0;var i=0,s=t.suspendedLanes,n=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?i=Lw(l):(n&=o,n!==0&&(i=Lw(n)))}else o=r&~s,o!==0?i=Lw(o):n!==0&&(i=Lw(n));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,n=e&-e,s>=n||s===16&&(n&4194240)!==0))return e;if(i&4&&(i|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)r=31-Ic(e),s=1<<r,i|=t[r],e&=~s;return i}function Xse(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qse(t,e){for(var r=t.suspendedLanes,i=t.pingedLanes,s=t.expirationTimes,n=t.pendingLanes;0<n;){var o=31-Ic(n),l=1<<o,h=s[o];h===-1?(!(l&r)||l&i)&&(s[o]=Xse(l,e)):h<=e&&(t.expiredLanes|=l),n&=~l}}function V3(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gz(){var t=ob;return ob<<=1,!(ob&4194240)&&(ob=64),t}function KA(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function RC(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ic(e),t[e]=r}function Jse(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ic(r),n=1<<s;e[s]=0,i[s]=-1,t[s]=-1,r&=~n}}function uM(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var i=31-Ic(r),s=1<<i;s&e|t[i]&e&&(t[i]|=e),r&=~s}}var Kn=0;function mz(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var pz,hM,vz,wz,yz,W3=!1,lb=[],dd=null,gd=null,md=null,My=new Map,ky=new Map,qf=[],Qse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function o7(t,e){switch(t){case"focusin":case"focusout":dd=null;break;case"dragenter":case"dragleave":gd=null;break;case"mouseover":case"mouseout":md=null;break;case"pointerover":case"pointerout":My.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ky.delete(e.pointerId)}}function Sv(t,e,r,i,s,n){return t===null||t.nativeEvent!==n?(t={blockedOn:e,domEventName:r,eventSystemFlags:i,nativeEvent:n,targetContainers:[s]},e!==null&&(e=OC(e),e!==null&&hM(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Zse(t,e,r,i,s){switch(e){case"focusin":return dd=Sv(dd,t,e,r,i,s),!0;case"dragenter":return gd=Sv(gd,t,e,r,i,s),!0;case"mouseover":return md=Sv(md,t,e,r,i,s),!0;case"pointerover":var n=s.pointerId;return My.set(n,Sv(My.get(n)||null,t,e,r,i,s)),!0;case"gotpointercapture":return n=s.pointerId,ky.set(n,Sv(ky.get(n)||null,t,e,r,i,s)),!0}return!1}function Cz(t){var e=tg(t.target);if(e!==null){var r=Vg(e);if(r!==null){if(e=r.tag,e===13){if(e=lz(r),e!==null){t.blockedOn=e,yz(t.priority,function(){vz(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function w2(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=j3(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var i=new r.constructor(r.type,r);L3=i,r.target.dispatchEvent(i),L3=null}else return e=OC(r),e!==null&&hM(e),t.blockedOn=r,!1;e.shift()}return!0}function a7(t,e,r){w2(t)&&r.delete(e)}function eoe(){W3=!1,dd!==null&&w2(dd)&&(dd=null),gd!==null&&w2(gd)&&(gd=null),md!==null&&w2(md)&&(md=null),My.forEach(a7),ky.forEach(a7)}function bv(t,e){t.blockedOn===e&&(t.blockedOn=null,W3||(W3=!0,al.unstable_scheduleCallback(al.unstable_NormalPriority,eoe)))}function Ny(t){function e(s){return bv(s,t)}if(0<lb.length){bv(lb[0],t);for(var r=1;r<lb.length;r++){var i=lb[r];i.blockedOn===t&&(i.blockedOn=null)}}for(dd!==null&&bv(dd,t),gd!==null&&bv(gd,t),md!==null&&bv(md,t),My.forEach(e),ky.forEach(e),r=0;r<qf.length;r++)i=qf[r],i.blockedOn===t&&(i.blockedOn=null);for(;0<qf.length&&(r=qf[0],r.blockedOn===null);)Cz(r),r.blockedOn===null&&qf.shift()}var Hp=lf.ReactCurrentBatchConfig,uE=!0;function toe(t,e,r,i){var s=Kn,n=Hp.transition;Hp.transition=null;try{Kn=1,fM(t,e,r,i)}finally{Kn=s,Hp.transition=n}}function roe(t,e,r,i){var s=Kn,n=Hp.transition;Hp.transition=null;try{Kn=4,fM(t,e,r,i)}finally{Kn=s,Hp.transition=n}}function fM(t,e,r,i){if(uE){var s=j3(t,e,r,i);if(s===null)i4(t,e,i,hE,r),o7(t,i);else if(Zse(s,t,e,r,i))i.stopPropagation();else if(o7(t,i),e&4&&-1<Qse.indexOf(t)){for(;s!==null;){var n=OC(s);if(n!==null&&pz(n),n=j3(t,e,r,i),n===null&&i4(t,e,i,hE,r),n===s)break;s=n}s!==null&&i.stopPropagation()}else i4(t,e,i,null,r)}}var hE=null;function j3(t,e,r,i){if(hE=null,t=lM(i),t=tg(t),t!==null)if(e=Vg(t),e===null)t=null;else if(r=e.tag,r===13){if(t=lz(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return hE=t,null}function Sz(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(jse()){case cM:return 1;case fz:return 4;case lE:case Use:return 16;case dz:return 536870912;default:return 16}default:return 16}}var td=null,dM=null,y2=null;function bz(){if(y2)return y2;var t,e=dM,r=e.length,i,s="value"in td?td.value:td.textContent,n=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(i=1;i<=o&&e[r-i]===s[n-i];i++);return y2=s.slice(t,1<i?1-i:void 0)}function C2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cb(){return!0}function l7(){return!1}function hl(t){function e(r,i,s,n,o){this._reactName=r,this._targetInst=s,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(n):n[l]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?cb:l7,this.isPropagationStopped=l7,this}return Vi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cb)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cb)},persist:function(){},isPersistent:cb}),e}var y1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gM=hl(y1),AC=Vi({},y1,{view:0,detail:0}),noe=hl(AC),XA,qA,xv,ZT=Vi({},AC,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mM,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xv&&(xv&&t.type==="mousemove"?(XA=t.screenX-xv.screenX,qA=t.screenY-xv.screenY):qA=XA=0,xv=t),XA)},movementY:function(t){return"movementY"in t?t.movementY:qA}}),c7=hl(ZT),ioe=Vi({},ZT,{dataTransfer:0}),soe=hl(ioe),ooe=Vi({},AC,{relatedTarget:0}),JA=hl(ooe),aoe=Vi({},y1,{animationName:0,elapsedTime:0,pseudoElement:0}),loe=hl(aoe),coe=Vi({},y1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uoe=hl(coe),hoe=Vi({},y1,{data:0}),u7=hl(hoe),foe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},doe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},goe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function moe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=goe[t])?!!e[t]:!1}function mM(){return moe}var poe=Vi({},AC,{key:function(t){if(t.key){var e=foe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=C2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?doe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mM,charCode:function(t){return t.type==="keypress"?C2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?C2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),voe=hl(poe),woe=Vi({},ZT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),h7=hl(woe),yoe=Vi({},AC,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mM}),Coe=hl(yoe),Soe=Vi({},y1,{propertyName:0,elapsedTime:0,pseudoElement:0}),boe=hl(Soe),xoe=Vi({},ZT,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Eoe=hl(xoe),Toe=[9,13,27,32],pM=qh&&"CompositionEvent"in window,Xw=null;qh&&"documentMode"in document&&(Xw=document.documentMode);var _oe=qh&&"TextEvent"in window&&!Xw,xz=qh&&(!pM||Xw&&8<Xw&&11>=Xw),f7=" ",d7=!1;function Ez(t,e){switch(t){case"keyup":return Toe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tz(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var vp=!1;function Roe(t,e){switch(t){case"compositionend":return Tz(e);case"keypress":return e.which!==32?null:(d7=!0,f7);case"textInput":return t=e.data,t===f7&&d7?null:t;default:return null}}function Aoe(t,e){if(vp)return t==="compositionend"||!pM&&Ez(t,e)?(t=bz(),y2=dM=td=null,vp=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return xz&&e.locale!=="ko"?null:e.data;default:return null}}var Ooe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g7(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ooe[t.type]:e==="textarea"}function _z(t,e,r,i){nz(i),e=fE(e,"onChange"),0<e.length&&(r=new gM("onChange","change",null,r,i),t.push({event:r,listeners:e}))}var qw=null,Dy=null;function Ioe(t){Lz(t,0)}function e_(t){var e=Cp(t);if(qU(e))return t}function Poe(t,e){if(t==="change")return e}var Rz=!1;if(qh){var QA;if(qh){var ZA="oninput"in document;if(!ZA){var m7=document.createElement("div");m7.setAttribute("oninput","return;"),ZA=typeof m7.oninput=="function"}QA=ZA}else QA=!1;Rz=QA&&(!document.documentMode||9<document.documentMode)}function p7(){qw&&(qw.detachEvent("onpropertychange",Az),Dy=qw=null)}function Az(t){if(t.propertyName==="value"&&e_(Dy)){var e=[];_z(e,Dy,t,lM(t)),az(Ioe,e)}}function Foe(t,e,r){t==="focusin"?(p7(),qw=e,Dy=r,qw.attachEvent("onpropertychange",Az)):t==="focusout"&&p7()}function Moe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return e_(Dy)}function koe(t,e){if(t==="click")return e_(e)}function Noe(t,e){if(t==="input"||t==="change")return e_(e)}function Doe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Nc=typeof Object.is=="function"?Object.is:Doe;function Ly(t,e){if(Nc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var s=r[i];if(!T3.call(e,s)||!Nc(t[s],e[s]))return!1}return!0}function v7(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function w7(t,e){var r=v7(t);t=0;for(var i;r;){if(r.nodeType===3){if(i=t+r.textContent.length,t<=e&&i>=e)return{node:r,offset:e-t};t=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v7(r)}}function Oz(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Oz(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Iz(){for(var t=window,e=sE();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=sE(t.document)}return e}function vM(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Loe(t){var e=Iz(),r=t.focusedElem,i=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Oz(r.ownerDocument.documentElement,r)){if(i!==null&&vM(r)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,n=Math.min(i.start,s);i=i.end===void 0?n:Math.min(i.end,s),!t.extend&&n>i&&(s=i,i=n,n=s),s=w7(r,n);var o=w7(r,i);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),n>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Hoe=qh&&"documentMode"in document&&11>=document.documentMode,wp=null,U3=null,Jw=null,z3=!1;function y7(t,e,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;z3||wp==null||wp!==sE(i)||(i=wp,"selectionStart"in i&&vM(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Jw&&Ly(Jw,i)||(Jw=i,i=fE(U3,"onSelect"),0<i.length&&(e=new gM("onSelect","select",null,e,r),t.push({event:e,listeners:i}),e.target=wp)))}function ub(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var yp={animationend:ub("Animation","AnimationEnd"),animationiteration:ub("Animation","AnimationIteration"),animationstart:ub("Animation","AnimationStart"),transitionend:ub("Transition","TransitionEnd")},e4={},Pz={};qh&&(Pz=document.createElement("div").style,"AnimationEvent"in window||(delete yp.animationend.animation,delete yp.animationiteration.animation,delete yp.animationstart.animation),"TransitionEvent"in window||delete yp.transitionend.transition);function t_(t){if(e4[t])return e4[t];if(!yp[t])return t;var e=yp[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Pz)return e4[t]=e[r];return t}var Fz=t_("animationend"),Mz=t_("animationiteration"),kz=t_("animationstart"),Nz=t_("transitionend"),Dz=new Map,C7="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kd(t,e){Dz.set(t,e),Bg(e,[t])}for(var t4=0;t4<C7.length;t4++){var r4=C7[t4],$oe=r4.toLowerCase(),Boe=r4[0].toUpperCase()+r4.slice(1);kd($oe,"on"+Boe)}kd(Fz,"onAnimationEnd");kd(Mz,"onAnimationIteration");kd(kz,"onAnimationStart");kd("dblclick","onDoubleClick");kd("focusin","onFocus");kd("focusout","onBlur");kd(Nz,"onTransitionEnd");e1("onMouseEnter",["mouseout","mouseover"]);e1("onMouseLeave",["mouseout","mouseover"]);e1("onPointerEnter",["pointerout","pointerover"]);e1("onPointerLeave",["pointerout","pointerover"]);Bg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Bg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Bg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Bg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Bg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Bg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Voe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hw));function S7(t,e,r){var i=t.type||"unknown-event";t.currentTarget=r,$se(i,e,void 0,t),t.currentTarget=null}function Lz(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var i=t[r],s=i.event;i=i.listeners;e:{var n=void 0;if(e)for(var o=i.length-1;0<=o;o--){var l=i[o],h=l.instance,d=l.currentTarget;if(l=l.listener,h!==n&&s.isPropagationStopped())break e;S7(s,l,d),n=h}else for(o=0;o<i.length;o++){if(l=i[o],h=l.instance,d=l.currentTarget,l=l.listener,h!==n&&s.isPropagationStopped())break e;S7(s,l,d),n=h}}}if(aE)throw t=B3,aE=!1,B3=null,t}function vi(t,e){var r=e[q3];r===void 0&&(r=e[q3]=new Set);var i=t+"__bubble";r.has(i)||(Hz(e,t,2,!1),r.add(i))}function n4(t,e,r){var i=0;e&&(i|=4),Hz(r,t,i,e)}var hb="_reactListening"+Math.random().toString(36).slice(2);function Hy(t){if(!t[hb]){t[hb]=!0,zU.forEach(function(r){r!=="selectionchange"&&(Voe.has(r)||n4(r,!1,t),n4(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[hb]||(e[hb]=!0,n4("selectionchange",!1,e))}}function Hz(t,e,r,i){switch(Sz(e)){case 1:var s=toe;break;case 4:s=roe;break;default:s=fM}r=s.bind(null,e,r,t),s=void 0,!$3||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function i4(t,e,r,i,s){var n=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var l=i.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var h=o.tag;if((h===3||h===4)&&(h=o.stateNode.containerInfo,h===s||h.nodeType===8&&h.parentNode===s))return;o=o.return}for(;l!==null;){if(o=tg(l),o===null)return;if(h=o.tag,h===5||h===6){i=n=o;continue e}l=l.parentNode}}i=i.return}az(function(){var d=n,g=lM(r),y=[];e:{var C=Dz.get(t);if(C!==void 0){var x=gM,_=t;switch(t){case"keypress":if(C2(r)===0)break e;case"keydown":case"keyup":x=voe;break;case"focusin":_="focus",x=JA;break;case"focusout":_="blur",x=JA;break;case"beforeblur":case"afterblur":x=JA;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=c7;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=soe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Coe;break;case Fz:case Mz:case kz:x=loe;break;case Nz:x=boe;break;case"scroll":x=noe;break;case"wheel":x=Eoe;break;case"copy":case"cut":case"paste":x=uoe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=h7}var E=(e&4)!==0,R=!E&&t==="scroll",I=E?C!==null?C+"Capture":null:C;E=[];for(var F=d,H;F!==null;){H=F;var z=H.stateNode;if(H.tag===5&&z!==null&&(H=z,I!==null&&(z=Fy(F,I),z!=null&&E.push($y(F,z,H)))),R)break;F=F.return}0<E.length&&(C=new x(C,_,null,r,g),y.push({event:C,listeners:E}))}}if(!(e&7)){e:{if(C=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",C&&r!==L3&&(_=r.relatedTarget||r.fromElement)&&(tg(_)||_[Jh]))break e;if((x||C)&&(C=g.window===g?g:(C=g.ownerDocument)?C.defaultView||C.parentWindow:window,x?(_=r.relatedTarget||r.toElement,x=d,_=_?tg(_):null,_!==null&&(R=Vg(_),_!==R||_.tag!==5&&_.tag!==6)&&(_=null)):(x=null,_=d),x!==_)){if(E=c7,z="onMouseLeave",I="onMouseEnter",F="mouse",(t==="pointerout"||t==="pointerover")&&(E=h7,z="onPointerLeave",I="onPointerEnter",F="pointer"),R=x==null?C:Cp(x),H=_==null?C:Cp(_),C=new E(z,F+"leave",x,r,g),C.target=R,C.relatedTarget=H,z=null,tg(g)===d&&(E=new E(I,F+"enter",_,r,g),E.target=H,E.relatedTarget=R,z=E),R=z,x&&_)t:{for(E=x,I=_,F=0,H=E;H;H=wm(H))F++;for(H=0,z=I;z;z=wm(z))H++;for(;0<F-H;)E=wm(E),F--;for(;0<H-F;)I=wm(I),H--;for(;F--;){if(E===I||I!==null&&E===I.alternate)break t;E=wm(E),I=wm(I)}E=null}else E=null;x!==null&&b7(y,C,x,E,!1),_!==null&&R!==null&&b7(y,R,_,E,!0)}}e:{if(C=d?Cp(d):window,x=C.nodeName&&C.nodeName.toLowerCase(),x==="select"||x==="input"&&C.type==="file")var q=Poe;else if(g7(C))if(Rz)q=Noe;else{q=Moe;var re=Foe}else(x=C.nodeName)&&x.toLowerCase()==="input"&&(C.type==="checkbox"||C.type==="radio")&&(q=koe);if(q&&(q=q(t,d))){_z(y,q,r,g);break e}re&&re(t,C,d),t==="focusout"&&(re=C._wrapperState)&&re.controlled&&C.type==="number"&&F3(C,"number",C.value)}switch(re=d?Cp(d):window,t){case"focusin":(g7(re)||re.contentEditable==="true")&&(wp=re,U3=d,Jw=null);break;case"focusout":Jw=U3=wp=null;break;case"mousedown":z3=!0;break;case"contextmenu":case"mouseup":case"dragend":z3=!1,y7(y,r,g);break;case"selectionchange":if(Hoe)break;case"keydown":case"keyup":y7(y,r,g)}var Y;if(pM)e:{switch(t){case"compositionstart":var oe="onCompositionStart";break e;case"compositionend":oe="onCompositionEnd";break e;case"compositionupdate":oe="onCompositionUpdate";break e}oe=void 0}else vp?Ez(t,r)&&(oe="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(oe="onCompositionStart");oe&&(xz&&r.locale!=="ko"&&(vp||oe!=="onCompositionStart"?oe==="onCompositionEnd"&&vp&&(Y=bz()):(td=g,dM="value"in td?td.value:td.textContent,vp=!0)),re=fE(d,oe),0<re.length&&(oe=new u7(oe,t,null,r,g),y.push({event:oe,listeners:re}),Y?oe.data=Y:(Y=Tz(r),Y!==null&&(oe.data=Y)))),(Y=_oe?Roe(t,r):Aoe(t,r))&&(d=fE(d,"onBeforeInput"),0<d.length&&(g=new u7("onBeforeInput","beforeinput",null,r,g),y.push({event:g,listeners:d}),g.data=Y))}Lz(y,e)})}function $y(t,e,r){return{instance:t,listener:e,currentTarget:r}}function fE(t,e){for(var r=e+"Capture",i=[];t!==null;){var s=t,n=s.stateNode;s.tag===5&&n!==null&&(s=n,n=Fy(t,r),n!=null&&i.unshift($y(t,n,s)),n=Fy(t,e),n!=null&&i.push($y(t,n,s))),t=t.return}return i}function wm(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function b7(t,e,r,i,s){for(var n=e._reactName,o=[];r!==null&&r!==i;){var l=r,h=l.alternate,d=l.stateNode;if(h!==null&&h===i)break;l.tag===5&&d!==null&&(l=d,s?(h=Fy(r,n),h!=null&&o.unshift($y(r,h,l))):s||(h=Fy(r,n),h!=null&&o.push($y(r,h,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var Woe=/\r\n?/g,joe=/\u0000|\uFFFD/g;function x7(t){return(typeof t=="string"?t:""+t).replace(Woe,`
`).replace(joe,"")}function fb(t,e,r){if(e=x7(e),x7(t)!==e&&r)throw Error(_t(425))}function dE(){}var G3=null,Y3=null;function K3(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var X3=typeof setTimeout=="function"?setTimeout:void 0,Uoe=typeof clearTimeout=="function"?clearTimeout:void 0,E7=typeof Promise=="function"?Promise:void 0,zoe=typeof queueMicrotask=="function"?queueMicrotask:typeof E7<"u"?function(t){return E7.resolve(null).then(t).catch(Goe)}:X3;function Goe(t){setTimeout(function(){throw t})}function s4(t,e){var r=e,i=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(i===0){t.removeChild(s),Ny(e);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=s}while(r);Ny(e)}function pd(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function T7(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var C1=Math.random().toString(36).slice(2),Mu="__reactFiber$"+C1,By="__reactProps$"+C1,Jh="__reactContainer$"+C1,q3="__reactEvents$"+C1,Yoe="__reactListeners$"+C1,Koe="__reactHandles$"+C1;function tg(t){var e=t[Mu];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Jh]||r[Mu]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=T7(t);t!==null;){if(r=t[Mu])return r;t=T7(t)}return e}t=r,r=t.parentNode}return null}function OC(t){return t=t[Mu]||t[Jh],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Cp(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(_t(33))}function r_(t){return t[By]||null}var J3=[],Sp=-1;function Nd(t){return{current:t}}function yi(t){0>Sp||(t.current=J3[Sp],J3[Sp]=null,Sp--)}function ui(t,e){Sp++,J3[Sp]=t.current,t.current=e}var Rd={},Ho=Nd(Rd),Ia=Nd(!1),Cg=Rd;function t1(t,e){var r=t.type.contextTypes;if(!r)return Rd;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},n;for(n in r)s[n]=e[n];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pa(t){return t=t.childContextTypes,t!=null}function gE(){yi(Ia),yi(Ho)}function _7(t,e,r){if(Ho.current!==Rd)throw Error(_t(168));ui(Ho,e),ui(Ia,r)}function $z(t,e,r){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(_t(108,Fse(t)||"Unknown",s));return Vi({},r,i)}function mE(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Rd,Cg=Ho.current,ui(Ho,t),ui(Ia,Ia.current),!0}function R7(t,e,r){var i=t.stateNode;if(!i)throw Error(_t(169));r?(t=$z(t,e,Cg),i.__reactInternalMemoizedMergedChildContext=t,yi(Ia),yi(Ho),ui(Ho,t)):yi(Ia),ui(Ia,r)}var Fh=null,n_=!1,o4=!1;function Bz(t){Fh===null?Fh=[t]:Fh.push(t)}function Xoe(t){n_=!0,Bz(t)}function Dd(){if(!o4&&Fh!==null){o4=!0;var t=0,e=Kn;try{var r=Fh;for(Kn=1;t<r.length;t++){var i=r[t];do i=i(!0);while(i!==null)}Fh=null,n_=!1}catch(s){throw Fh!==null&&(Fh=Fh.slice(t+1)),hz(cM,Dd),s}finally{Kn=e,o4=!1}}return null}var bp=[],xp=0,pE=null,vE=0,Dl=[],Ll=0,Sg=null,Dh=1,Lh="";function G0(t,e){bp[xp++]=vE,bp[xp++]=pE,pE=t,vE=e}function Vz(t,e,r){Dl[Ll++]=Dh,Dl[Ll++]=Lh,Dl[Ll++]=Sg,Sg=t;var i=Dh;t=Lh;var s=32-Ic(i)-1;i&=~(1<<s),r+=1;var n=32-Ic(e)+s;if(30<n){var o=s-s%5;n=(i&(1<<o)-1).toString(32),i>>=o,s-=o,Dh=1<<32-Ic(e)+s|r<<s|i,Lh=n+t}else Dh=1<<n|r<<s|i,Lh=t}function wM(t){t.return!==null&&(G0(t,1),Vz(t,1,0))}function yM(t){for(;t===pE;)pE=bp[--xp],bp[xp]=null,vE=bp[--xp],bp[xp]=null;for(;t===Sg;)Sg=Dl[--Ll],Dl[Ll]=null,Lh=Dl[--Ll],Dl[Ll]=null,Dh=Dl[--Ll],Dl[Ll]=null}var sl=null,rl=null,Ri=!1,Tc=null;function Wz(t,e){var r=Vl(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function A7(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,sl=t,rl=pd(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,sl=t,rl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Sg!==null?{id:Dh,overflow:Lh}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Vl(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,sl=t,rl=null,!0):!1;default:return!1}}function Q3(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Z3(t){if(Ri){var e=rl;if(e){var r=e;if(!A7(t,e)){if(Q3(t))throw Error(_t(418));e=pd(r.nextSibling);var i=sl;e&&A7(t,e)?Wz(i,r):(t.flags=t.flags&-4097|2,Ri=!1,sl=t)}}else{if(Q3(t))throw Error(_t(418));t.flags=t.flags&-4097|2,Ri=!1,sl=t}}}function O7(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;sl=t}function db(t){if(t!==sl)return!1;if(!Ri)return O7(t),Ri=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!K3(t.type,t.memoizedProps)),e&&(e=rl)){if(Q3(t))throw jz(),Error(_t(418));for(;e;)Wz(t,e),e=pd(e.nextSibling)}if(O7(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(_t(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){rl=pd(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}rl=null}}else rl=sl?pd(t.stateNode.nextSibling):null;return!0}function jz(){for(var t=rl;t;)t=pd(t.nextSibling)}function r1(){rl=sl=null,Ri=!1}function CM(t){Tc===null?Tc=[t]:Tc.push(t)}var qoe=lf.ReactCurrentBatchConfig;function Ev(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(_t(309));var i=r.stateNode}if(!i)throw Error(_t(147,t));var s=i,n=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===n?e.ref:(e=function(o){var l=s.refs;o===null?delete l[n]:l[n]=o},e._stringRef=n,e)}if(typeof t!="string")throw Error(_t(284));if(!r._owner)throw Error(_t(290,t))}return t}function gb(t,e){throw t=Object.prototype.toString.call(e),Error(_t(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function I7(t){var e=t._init;return e(t._payload)}function Uz(t){function e(I,F){if(t){var H=I.deletions;H===null?(I.deletions=[F],I.flags|=16):H.push(F)}}function r(I,F){if(!t)return null;for(;F!==null;)e(I,F),F=F.sibling;return null}function i(I,F){for(I=new Map;F!==null;)F.key!==null?I.set(F.key,F):I.set(F.index,F),F=F.sibling;return I}function s(I,F){return I=Cd(I,F),I.index=0,I.sibling=null,I}function n(I,F,H){return I.index=H,t?(H=I.alternate,H!==null?(H=H.index,H<F?(I.flags|=2,F):H):(I.flags|=2,F)):(I.flags|=1048576,F)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,F,H,z){return F===null||F.tag!==6?(F=d4(H,I.mode,z),F.return=I,F):(F=s(F,H),F.return=I,F)}function h(I,F,H,z){var q=H.type;return q===pp?g(I,F,H.props.children,z,H.key):F!==null&&(F.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===jf&&I7(q)===F.type)?(z=s(F,H.props),z.ref=Ev(I,F,H),z.return=I,z):(z=R2(H.type,H.key,H.props,null,I.mode,z),z.ref=Ev(I,F,H),z.return=I,z)}function d(I,F,H,z){return F===null||F.tag!==4||F.stateNode.containerInfo!==H.containerInfo||F.stateNode.implementation!==H.implementation?(F=g4(H,I.mode,z),F.return=I,F):(F=s(F,H.children||[]),F.return=I,F)}function g(I,F,H,z,q){return F===null||F.tag!==7?(F=dg(H,I.mode,z,q),F.return=I,F):(F=s(F,H),F.return=I,F)}function y(I,F,H){if(typeof F=="string"&&F!==""||typeof F=="number")return F=d4(""+F,I.mode,H),F.return=I,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case nb:return H=R2(F.type,F.key,F.props,null,I.mode,H),H.ref=Ev(I,null,F),H.return=I,H;case mp:return F=g4(F,I.mode,H),F.return=I,F;case jf:var z=F._init;return y(I,z(F._payload),H)}if(Dw(F)||yv(F))return F=dg(F,I.mode,H,null),F.return=I,F;gb(I,F)}return null}function C(I,F,H,z){var q=F!==null?F.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return q!==null?null:l(I,F,""+H,z);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case nb:return H.key===q?h(I,F,H,z):null;case mp:return H.key===q?d(I,F,H,z):null;case jf:return q=H._init,C(I,F,q(H._payload),z)}if(Dw(H)||yv(H))return q!==null?null:g(I,F,H,z,null);gb(I,H)}return null}function x(I,F,H,z,q){if(typeof z=="string"&&z!==""||typeof z=="number")return I=I.get(H)||null,l(F,I,""+z,q);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case nb:return I=I.get(z.key===null?H:z.key)||null,h(F,I,z,q);case mp:return I=I.get(z.key===null?H:z.key)||null,d(F,I,z,q);case jf:var re=z._init;return x(I,F,H,re(z._payload),q)}if(Dw(z)||yv(z))return I=I.get(H)||null,g(F,I,z,q,null);gb(F,z)}return null}function _(I,F,H,z){for(var q=null,re=null,Y=F,oe=F=0,me=null;Y!==null&&oe<H.length;oe++){Y.index>oe?(me=Y,Y=null):me=Y.sibling;var de=C(I,Y,H[oe],z);if(de===null){Y===null&&(Y=me);break}t&&Y&&de.alternate===null&&e(I,Y),F=n(de,F,oe),re===null?q=de:re.sibling=de,re=de,Y=me}if(oe===H.length)return r(I,Y),Ri&&G0(I,oe),q;if(Y===null){for(;oe<H.length;oe++)Y=y(I,H[oe],z),Y!==null&&(F=n(Y,F,oe),re===null?q=Y:re.sibling=Y,re=Y);return Ri&&G0(I,oe),q}for(Y=i(I,Y);oe<H.length;oe++)me=x(Y,I,oe,H[oe],z),me!==null&&(t&&me.alternate!==null&&Y.delete(me.key===null?oe:me.key),F=n(me,F,oe),re===null?q=me:re.sibling=me,re=me);return t&&Y.forEach(function(Re){return e(I,Re)}),Ri&&G0(I,oe),q}function E(I,F,H,z){var q=yv(H);if(typeof q!="function")throw Error(_t(150));if(H=q.call(H),H==null)throw Error(_t(151));for(var re=q=null,Y=F,oe=F=0,me=null,de=H.next();Y!==null&&!de.done;oe++,de=H.next()){Y.index>oe?(me=Y,Y=null):me=Y.sibling;var Re=C(I,Y,de.value,z);if(Re===null){Y===null&&(Y=me);break}t&&Y&&Re.alternate===null&&e(I,Y),F=n(Re,F,oe),re===null?q=Re:re.sibling=Re,re=Re,Y=me}if(de.done)return r(I,Y),Ri&&G0(I,oe),q;if(Y===null){for(;!de.done;oe++,de=H.next())de=y(I,de.value,z),de!==null&&(F=n(de,F,oe),re===null?q=de:re.sibling=de,re=de);return Ri&&G0(I,oe),q}for(Y=i(I,Y);!de.done;oe++,de=H.next())de=x(Y,I,oe,de.value,z),de!==null&&(t&&de.alternate!==null&&Y.delete(de.key===null?oe:de.key),F=n(de,F,oe),re===null?q=de:re.sibling=de,re=de);return t&&Y.forEach(function(Ie){return e(I,Ie)}),Ri&&G0(I,oe),q}function R(I,F,H,z){if(typeof H=="object"&&H!==null&&H.type===pp&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case nb:e:{for(var q=H.key,re=F;re!==null;){if(re.key===q){if(q=H.type,q===pp){if(re.tag===7){r(I,re.sibling),F=s(re,H.props.children),F.return=I,I=F;break e}}else if(re.elementType===q||typeof q=="object"&&q!==null&&q.$$typeof===jf&&I7(q)===re.type){r(I,re.sibling),F=s(re,H.props),F.ref=Ev(I,re,H),F.return=I,I=F;break e}r(I,re);break}else e(I,re);re=re.sibling}H.type===pp?(F=dg(H.props.children,I.mode,z,H.key),F.return=I,I=F):(z=R2(H.type,H.key,H.props,null,I.mode,z),z.ref=Ev(I,F,H),z.return=I,I=z)}return o(I);case mp:e:{for(re=H.key;F!==null;){if(F.key===re)if(F.tag===4&&F.stateNode.containerInfo===H.containerInfo&&F.stateNode.implementation===H.implementation){r(I,F.sibling),F=s(F,H.children||[]),F.return=I,I=F;break e}else{r(I,F);break}else e(I,F);F=F.sibling}F=g4(H,I.mode,z),F.return=I,I=F}return o(I);case jf:return re=H._init,R(I,F,re(H._payload),z)}if(Dw(H))return _(I,F,H,z);if(yv(H))return E(I,F,H,z);gb(I,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,F!==null&&F.tag===6?(r(I,F.sibling),F=s(F,H),F.return=I,I=F):(r(I,F),F=d4(H,I.mode,z),F.return=I,I=F),o(I)):r(I,F)}return R}var n1=Uz(!0),zz=Uz(!1),wE=Nd(null),yE=null,Ep=null,SM=null;function bM(){SM=Ep=yE=null}function xM(t){var e=wE.current;yi(wE),t._currentValue=e}function eP(t,e,r){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===r)break;t=t.return}}function $p(t,e){yE=t,SM=Ep=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Oa=!0),t.firstContext=null)}function Ul(t){var e=t._currentValue;if(SM!==t)if(t={context:t,memoizedValue:e,next:null},Ep===null){if(yE===null)throw Error(_t(308));Ep=t,yE.dependencies={lanes:0,firstContext:t}}else Ep=Ep.next=t;return e}var rg=null;function EM(t){rg===null?rg=[t]:rg.push(t)}function Gz(t,e,r,i){var s=e.interleaved;return s===null?(r.next=r,EM(e)):(r.next=s.next,s.next=r),e.interleaved=r,Qh(t,i)}function Qh(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Uf=!1;function TM(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Yz(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Uh(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function vd(t,e,r){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,En&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,Qh(t,r)}return s=i.interleaved,s===null?(e.next=e,EM(i)):(e.next=s.next,s.next=e),i.interleaved=e,Qh(t,r)}function S2(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,uM(t,r)}}function P7(t,e){var r=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var s=null,n=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};n===null?s=n=o:n=n.next=o,r=r.next}while(r!==null);n===null?s=n=e:n=n.next=e}else s=n=e;r={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:n,shared:i.shared,effects:i.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function CE(t,e,r,i){var s=t.updateQueue;Uf=!1;var n=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var h=l,d=h.next;h.next=null,o===null?n=d:o.next=d,o=h;var g=t.alternate;g!==null&&(g=g.updateQueue,l=g.lastBaseUpdate,l!==o&&(l===null?g.firstBaseUpdate=d:l.next=d,g.lastBaseUpdate=h))}if(n!==null){var y=s.baseState;o=0,g=d=h=null,l=n;do{var C=l.lane,x=l.eventTime;if((i&C)===C){g!==null&&(g=g.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,E=l;switch(C=e,x=r,E.tag){case 1:if(_=E.payload,typeof _=="function"){y=_.call(x,y,C);break e}y=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=E.payload,C=typeof _=="function"?_.call(x,y,C):_,C==null)break e;y=Vi({},y,C);break e;case 2:Uf=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,C=s.effects,C===null?s.effects=[l]:C.push(l))}else x={eventTime:x,lane:C,tag:l.tag,payload:l.payload,callback:l.callback,next:null},g===null?(d=g=x,h=y):g=g.next=x,o|=C;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;C=l,l=C.next,C.next=null,s.lastBaseUpdate=C,s.shared.pending=null}}while(!0);if(g===null&&(h=y),s.baseState=h,s.firstBaseUpdate=d,s.lastBaseUpdate=g,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else n===null&&(s.shared.lanes=0);xg|=o,t.lanes=o,t.memoizedState=y}}function F7(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],s=i.callback;if(s!==null){if(i.callback=null,i=r,typeof s!="function")throw Error(_t(191,s));s.call(i)}}}var IC={},Bu=Nd(IC),Vy=Nd(IC),Wy=Nd(IC);function ng(t){if(t===IC)throw Error(_t(174));return t}function _M(t,e){switch(ui(Wy,e),ui(Vy,t),ui(Bu,IC),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:k3(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=k3(e,t)}yi(Bu),ui(Bu,e)}function i1(){yi(Bu),yi(Vy),yi(Wy)}function Kz(t){ng(Wy.current);var e=ng(Bu.current),r=k3(e,t.type);e!==r&&(ui(Vy,t),ui(Bu,r))}function RM(t){Vy.current===t&&(yi(Bu),yi(Vy))}var Li=Nd(0);function SE(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var a4=[];function AM(){for(var t=0;t<a4.length;t++)a4[t]._workInProgressVersionPrimary=null;a4.length=0}var b2=lf.ReactCurrentDispatcher,l4=lf.ReactCurrentBatchConfig,bg=0,Bi=null,Fs=null,js=null,bE=!1,Qw=!1,jy=0,Joe=0;function Eo(){throw Error(_t(321))}function OM(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Nc(t[r],e[r]))return!1;return!0}function IM(t,e,r,i,s,n){if(bg=n,Bi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,b2.current=t===null||t.memoizedState===null?tae:rae,t=r(i,s),Qw){n=0;do{if(Qw=!1,jy=0,25<=n)throw Error(_t(301));n+=1,js=Fs=null,e.updateQueue=null,b2.current=nae,t=r(i,s)}while(Qw)}if(b2.current=xE,e=Fs!==null&&Fs.next!==null,bg=0,js=Fs=Bi=null,bE=!1,e)throw Error(_t(300));return t}function PM(){var t=jy!==0;return jy=0,t}function Tu(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return js===null?Bi.memoizedState=js=t:js=js.next=t,js}function zl(){if(Fs===null){var t=Bi.alternate;t=t!==null?t.memoizedState:null}else t=Fs.next;var e=js===null?Bi.memoizedState:js.next;if(e!==null)js=e,Fs=t;else{if(t===null)throw Error(_t(310));Fs=t,t={memoizedState:Fs.memoizedState,baseState:Fs.baseState,baseQueue:Fs.baseQueue,queue:Fs.queue,next:null},js===null?Bi.memoizedState=js=t:js=js.next=t}return js}function Uy(t,e){return typeof e=="function"?e(t):e}function c4(t){var e=zl(),r=e.queue;if(r===null)throw Error(_t(311));r.lastRenderedReducer=t;var i=Fs,s=i.baseQueue,n=r.pending;if(n!==null){if(s!==null){var o=s.next;s.next=n.next,n.next=o}i.baseQueue=s=n,r.pending=null}if(s!==null){n=s.next,i=i.baseState;var l=o=null,h=null,d=n;do{var g=d.lane;if((bg&g)===g)h!==null&&(h=h.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),i=d.hasEagerState?d.eagerState:t(i,d.action);else{var y={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};h===null?(l=h=y,o=i):h=h.next=y,Bi.lanes|=g,xg|=g}d=d.next}while(d!==null&&d!==n);h===null?o=i:h.next=l,Nc(i,e.memoizedState)||(Oa=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=h,r.lastRenderedState=i}if(t=r.interleaved,t!==null){s=t;do n=s.lane,Bi.lanes|=n,xg|=n,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function u4(t){var e=zl(),r=e.queue;if(r===null)throw Error(_t(311));r.lastRenderedReducer=t;var i=r.dispatch,s=r.pending,n=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do n=t(n,o.action),o=o.next;while(o!==s);Nc(n,e.memoizedState)||(Oa=!0),e.memoizedState=n,e.baseQueue===null&&(e.baseState=n),r.lastRenderedState=n}return[n,i]}function Xz(){}function qz(t,e){var r=Bi,i=zl(),s=e(),n=!Nc(i.memoizedState,s);if(n&&(i.memoizedState=s,Oa=!0),i=i.queue,FM(Zz.bind(null,r,i,t),[t]),i.getSnapshot!==e||n||js!==null&&js.memoizedState.tag&1){if(r.flags|=2048,zy(9,Qz.bind(null,r,i,s,e),void 0,null),Xs===null)throw Error(_t(349));bg&30||Jz(r,e,s)}return s}function Jz(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Bi.updateQueue,e===null?(e={lastEffect:null,stores:null},Bi.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Qz(t,e,r,i){e.value=r,e.getSnapshot=i,eG(e)&&tG(t)}function Zz(t,e,r){return r(function(){eG(e)&&tG(t)})}function eG(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Nc(t,r)}catch{return!0}}function tG(t){var e=Qh(t,1);e!==null&&Pc(e,t,1,-1)}function M7(t){var e=Tu();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uy,lastRenderedState:t},e.queue=t,t=t.dispatch=eae.bind(null,Bi,t),[e.memoizedState,t]}function zy(t,e,r,i){return t={tag:t,create:e,destroy:r,deps:i,next:null},e=Bi.updateQueue,e===null?(e={lastEffect:null,stores:null},Bi.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(i=r.next,r.next=t,t.next=i,e.lastEffect=t)),t}function rG(){return zl().memoizedState}function x2(t,e,r,i){var s=Tu();Bi.flags|=t,s.memoizedState=zy(1|e,r,void 0,i===void 0?null:i)}function i_(t,e,r,i){var s=zl();i=i===void 0?null:i;var n=void 0;if(Fs!==null){var o=Fs.memoizedState;if(n=o.destroy,i!==null&&OM(i,o.deps)){s.memoizedState=zy(e,r,n,i);return}}Bi.flags|=t,s.memoizedState=zy(1|e,r,n,i)}function k7(t,e){return x2(8390656,8,t,e)}function FM(t,e){return i_(2048,8,t,e)}function nG(t,e){return i_(4,2,t,e)}function iG(t,e){return i_(4,4,t,e)}function sG(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function oG(t,e,r){return r=r!=null?r.concat([t]):null,i_(4,4,sG.bind(null,e,t),r)}function MM(){}function aG(t,e){var r=zl();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&OM(e,i[1])?i[0]:(r.memoizedState=[t,e],t)}function lG(t,e){var r=zl();e=e===void 0?null:e;var i=r.memoizedState;return i!==null&&e!==null&&OM(e,i[1])?i[0]:(t=t(),r.memoizedState=[t,e],t)}function cG(t,e,r){return bg&21?(Nc(r,e)||(r=gz(),Bi.lanes|=r,xg|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Oa=!0),t.memoizedState=r)}function Qoe(t,e){var r=Kn;Kn=r!==0&&4>r?r:4,t(!0);var i=l4.transition;l4.transition={};try{t(!1),e()}finally{Kn=r,l4.transition=i}}function uG(){return zl().memoizedState}function Zoe(t,e,r){var i=yd(t);if(r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},hG(t))fG(e,r);else if(r=Gz(t,e,r,i),r!==null){var s=sa();Pc(r,t,i,s),dG(r,e,i)}}function eae(t,e,r){var i=yd(t),s={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(hG(t))fG(e,s);else{var n=t.alternate;if(t.lanes===0&&(n===null||n.lanes===0)&&(n=e.lastRenderedReducer,n!==null))try{var o=e.lastRenderedState,l=n(o,r);if(s.hasEagerState=!0,s.eagerState=l,Nc(l,o)){var h=e.interleaved;h===null?(s.next=s,EM(e)):(s.next=h.next,h.next=s),e.interleaved=s;return}}catch{}finally{}r=Gz(t,e,s,i),r!==null&&(s=sa(),Pc(r,t,i,s),dG(r,e,i))}}function hG(t){var e=t.alternate;return t===Bi||e!==null&&e===Bi}function fG(t,e){Qw=bE=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function dG(t,e,r){if(r&4194240){var i=e.lanes;i&=t.pendingLanes,r|=i,e.lanes=r,uM(t,r)}}var xE={readContext:Ul,useCallback:Eo,useContext:Eo,useEffect:Eo,useImperativeHandle:Eo,useInsertionEffect:Eo,useLayoutEffect:Eo,useMemo:Eo,useReducer:Eo,useRef:Eo,useState:Eo,useDebugValue:Eo,useDeferredValue:Eo,useTransition:Eo,useMutableSource:Eo,useSyncExternalStore:Eo,useId:Eo,unstable_isNewReconciler:!1},tae={readContext:Ul,useCallback:function(t,e){return Tu().memoizedState=[t,e===void 0?null:e],t},useContext:Ul,useEffect:k7,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,x2(4194308,4,sG.bind(null,e,t),r)},useLayoutEffect:function(t,e){return x2(4194308,4,t,e)},useInsertionEffect:function(t,e){return x2(4,2,t,e)},useMemo:function(t,e){var r=Tu();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var i=Tu();return e=r!==void 0?r(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Zoe.bind(null,Bi,t),[i.memoizedState,t]},useRef:function(t){var e=Tu();return t={current:t},e.memoizedState=t},useState:M7,useDebugValue:MM,useDeferredValue:function(t){return Tu().memoizedState=t},useTransition:function(){var t=M7(!1),e=t[0];return t=Qoe.bind(null,t[1]),Tu().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var i=Bi,s=Tu();if(Ri){if(r===void 0)throw Error(_t(407));r=r()}else{if(r=e(),Xs===null)throw Error(_t(349));bg&30||Jz(i,e,r)}s.memoizedState=r;var n={value:r,getSnapshot:e};return s.queue=n,k7(Zz.bind(null,i,n,t),[t]),i.flags|=2048,zy(9,Qz.bind(null,i,n,r,e),void 0,null),r},useId:function(){var t=Tu(),e=Xs.identifierPrefix;if(Ri){var r=Lh,i=Dh;r=(i&~(1<<32-Ic(i)-1)).toString(32)+r,e=":"+e+"R"+r,r=jy++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Joe++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},rae={readContext:Ul,useCallback:aG,useContext:Ul,useEffect:FM,useImperativeHandle:oG,useInsertionEffect:nG,useLayoutEffect:iG,useMemo:lG,useReducer:c4,useRef:rG,useState:function(){return c4(Uy)},useDebugValue:MM,useDeferredValue:function(t){var e=zl();return cG(e,Fs.memoizedState,t)},useTransition:function(){var t=c4(Uy)[0],e=zl().memoizedState;return[t,e]},useMutableSource:Xz,useSyncExternalStore:qz,useId:uG,unstable_isNewReconciler:!1},nae={readContext:Ul,useCallback:aG,useContext:Ul,useEffect:FM,useImperativeHandle:oG,useInsertionEffect:nG,useLayoutEffect:iG,useMemo:lG,useReducer:u4,useRef:rG,useState:function(){return u4(Uy)},useDebugValue:MM,useDeferredValue:function(t){var e=zl();return Fs===null?e.memoizedState=t:cG(e,Fs.memoizedState,t)},useTransition:function(){var t=u4(Uy)[0],e=zl().memoizedState;return[t,e]},useMutableSource:Xz,useSyncExternalStore:qz,useId:uG,unstable_isNewReconciler:!1};function Cc(t,e){if(t&&t.defaultProps){e=Vi({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function tP(t,e,r,i){e=t.memoizedState,r=r(i,e),r=r==null?e:Vi({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var s_={isMounted:function(t){return(t=t._reactInternals)?Vg(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var i=sa(),s=yd(t),n=Uh(i,s);n.payload=e,r!=null&&(n.callback=r),e=vd(t,n,s),e!==null&&(Pc(e,t,s,i),S2(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var i=sa(),s=yd(t),n=Uh(i,s);n.tag=1,n.payload=e,r!=null&&(n.callback=r),e=vd(t,n,s),e!==null&&(Pc(e,t,s,i),S2(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=sa(),i=yd(t),s=Uh(r,i);s.tag=2,e!=null&&(s.callback=e),e=vd(t,s,i),e!==null&&(Pc(e,t,i,r),S2(e,t,i))}};function N7(t,e,r,i,s,n,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,n,o):e.prototype&&e.prototype.isPureReactComponent?!Ly(r,i)||!Ly(s,n):!0}function gG(t,e,r){var i=!1,s=Rd,n=e.contextType;return typeof n=="object"&&n!==null?n=Ul(n):(s=Pa(e)?Cg:Ho.current,i=e.contextTypes,n=(i=i!=null)?t1(t,s):Rd),e=new e(r,n),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=s_,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=n),e}function D7(t,e,r,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,i),e.state!==t&&s_.enqueueReplaceState(e,e.state,null)}function rP(t,e,r,i){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},TM(t);var n=e.contextType;typeof n=="object"&&n!==null?s.context=Ul(n):(n=Pa(e)?Cg:Ho.current,s.context=t1(t,n)),s.state=t.memoizedState,n=e.getDerivedStateFromProps,typeof n=="function"&&(tP(t,e,n,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&s_.enqueueReplaceState(s,s.state,null),CE(t,r,s,i),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function s1(t,e){try{var r="",i=e;do r+=Pse(i),i=i.return;while(i);var s=r}catch(n){s=`
Error generating stack: `+n.message+`
`+n.stack}return{value:t,source:e,stack:s,digest:null}}function h4(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function nP(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var iae=typeof WeakMap=="function"?WeakMap:Map;function mG(t,e,r){r=Uh(-1,r),r.tag=3,r.payload={element:null};var i=e.value;return r.callback=function(){TE||(TE=!0,dP=i),nP(t,e)},r}function pG(t,e,r){r=Uh(-1,r),r.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;r.payload=function(){return i(s)},r.callback=function(){nP(t,e)}}var n=t.stateNode;return n!==null&&typeof n.componentDidCatch=="function"&&(r.callback=function(){nP(t,e),typeof i!="function"&&(wd===null?wd=new Set([this]):wd.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function L7(t,e,r){var i=t.pingCache;if(i===null){i=t.pingCache=new iae;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(r)||(s.add(r),t=wae.bind(null,t,e,r),e.then(t,t))}function H7(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $7(t,e,r,i,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Uh(-1,1),e.tag=2,vd(r,e,1))),r.lanes|=1),t)}var sae=lf.ReactCurrentOwner,Oa=!1;function Jo(t,e,r,i){e.child=t===null?zz(e,null,r,i):n1(e,t.child,r,i)}function B7(t,e,r,i,s){r=r.render;var n=e.ref;return $p(e,s),i=IM(t,e,r,i,n,s),r=PM(),t!==null&&!Oa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zh(t,e,s)):(Ri&&r&&wM(e),e.flags|=1,Jo(t,e,i,s),e.child)}function V7(t,e,r,i,s){if(t===null){var n=r.type;return typeof n=="function"&&!VM(n)&&n.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=n,vG(t,e,n,i,s)):(t=R2(r.type,null,i,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(n=t.child,!(t.lanes&s)){var o=n.memoizedProps;if(r=r.compare,r=r!==null?r:Ly,r(o,i)&&t.ref===e.ref)return Zh(t,e,s)}return e.flags|=1,t=Cd(n,i),t.ref=e.ref,t.return=e,e.child=t}function vG(t,e,r,i,s){if(t!==null){var n=t.memoizedProps;if(Ly(n,i)&&t.ref===e.ref)if(Oa=!1,e.pendingProps=i=n,(t.lanes&s)!==0)t.flags&131072&&(Oa=!0);else return e.lanes=t.lanes,Zh(t,e,s)}return iP(t,e,r,i,s)}function wG(t,e,r){var i=e.pendingProps,s=i.children,n=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ui(_p,Ja),Ja|=r;else{if(!(r&1073741824))return t=n!==null?n.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ui(_p,Ja),Ja|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=n!==null?n.baseLanes:r,ui(_p,Ja),Ja|=i}else n!==null?(i=n.baseLanes|r,e.memoizedState=null):i=r,ui(_p,Ja),Ja|=i;return Jo(t,e,s,r),e.child}function yG(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function iP(t,e,r,i,s){var n=Pa(r)?Cg:Ho.current;return n=t1(e,n),$p(e,s),r=IM(t,e,r,i,n,s),i=PM(),t!==null&&!Oa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Zh(t,e,s)):(Ri&&i&&wM(e),e.flags|=1,Jo(t,e,r,s),e.child)}function W7(t,e,r,i,s){if(Pa(r)){var n=!0;mE(e)}else n=!1;if($p(e,s),e.stateNode===null)E2(t,e),gG(e,r,i),rP(e,r,i,s),i=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var h=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=Ul(d):(d=Pa(r)?Cg:Ho.current,d=t1(e,d));var g=r.getDerivedStateFromProps,y=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function";y||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==i||h!==d)&&D7(e,o,i,d),Uf=!1;var C=e.memoizedState;o.state=C,CE(e,i,o,s),h=e.memoizedState,l!==i||C!==h||Ia.current||Uf?(typeof g=="function"&&(tP(e,r,g,i),h=e.memoizedState),(l=Uf||N7(e,r,l,i,C,h,d))?(y||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=h),o.props=i,o.state=h,o.context=d,i=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,Yz(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Cc(e.type,l),o.props=d,y=e.pendingProps,C=o.context,h=r.contextType,typeof h=="object"&&h!==null?h=Ul(h):(h=Pa(r)?Cg:Ho.current,h=t1(e,h));var x=r.getDerivedStateFromProps;(g=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==y||C!==h)&&D7(e,o,i,h),Uf=!1,C=e.memoizedState,o.state=C,CE(e,i,o,s);var _=e.memoizedState;l!==y||C!==_||Ia.current||Uf?(typeof x=="function"&&(tP(e,r,x,i),_=e.memoizedState),(d=Uf||N7(e,r,d,i,C,_,h)||!1)?(g||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,h),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,h)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=h,i=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&C===t.memoizedState||(e.flags|=1024),i=!1)}return sP(t,e,r,i,n,s)}function sP(t,e,r,i,s,n){yG(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&R7(e,r,!1),Zh(t,e,n);i=e.stateNode,sae.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=n1(e,t.child,null,n),e.child=n1(e,null,l,n)):Jo(t,e,l,n),e.memoizedState=i.state,s&&R7(e,r,!0),e.child}function CG(t){var e=t.stateNode;e.pendingContext?_7(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_7(t,e.context,!1),_M(t,e.containerInfo)}function j7(t,e,r,i,s){return r1(),CM(s),e.flags|=256,Jo(t,e,r,i),e.child}var oP={dehydrated:null,treeContext:null,retryLane:0};function aP(t){return{baseLanes:t,cachePool:null,transitions:null}}function SG(t,e,r){var i=e.pendingProps,s=Li.current,n=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(n=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ui(Li,s&1),t===null)return Z3(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,n?(i=e.mode,n=e.child,o={mode:"hidden",children:o},!(i&1)&&n!==null?(n.childLanes=0,n.pendingProps=o):n=l_(o,i,0,null),t=dg(t,i,r,null),n.return=e,t.return=e,n.sibling=t,e.child=n,e.child.memoizedState=aP(r),e.memoizedState=oP,t):kM(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return oae(t,e,o,i,l,s,r);if(n){n=i.fallback,o=e.mode,s=t.child,l=s.sibling;var h={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=h,e.deletions=null):(i=Cd(s,h),i.subtreeFlags=s.subtreeFlags&14680064),l!==null?n=Cd(l,n):(n=dg(n,o,r,null),n.flags|=2),n.return=e,i.return=e,i.sibling=n,e.child=i,i=n,n=e.child,o=t.child.memoizedState,o=o===null?aP(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},n.memoizedState=o,n.childLanes=t.childLanes&~r,e.memoizedState=oP,i}return n=t.child,t=n.sibling,i=Cd(n,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=r),i.return=e,i.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=i,e.memoizedState=null,i}function kM(t,e){return e=l_({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function mb(t,e,r,i){return i!==null&&CM(i),n1(e,t.child,null,r),t=kM(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function oae(t,e,r,i,s,n,o){if(r)return e.flags&256?(e.flags&=-257,i=h4(Error(_t(422))),mb(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(n=i.fallback,s=e.mode,i=l_({mode:"visible",children:i.children},s,0,null),n=dg(n,s,o,null),n.flags|=2,i.return=e,n.return=e,i.sibling=n,e.child=i,e.mode&1&&n1(e,t.child,null,o),e.child.memoizedState=aP(o),e.memoizedState=oP,n);if(!(e.mode&1))return mb(t,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var l=i.dgst;return i=l,n=Error(_t(419)),i=h4(n,i,void 0),mb(t,e,o,i)}if(l=(o&t.childLanes)!==0,Oa||l){if(i=Xs,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==n.retryLane&&(n.retryLane=s,Qh(t,s),Pc(i,t,s,-1))}return BM(),i=h4(Error(_t(421))),mb(t,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=yae.bind(null,t),s._reactRetry=e,null):(t=n.treeContext,rl=pd(s.nextSibling),sl=e,Ri=!0,Tc=null,t!==null&&(Dl[Ll++]=Dh,Dl[Ll++]=Lh,Dl[Ll++]=Sg,Dh=t.id,Lh=t.overflow,Sg=e),e=kM(e,i.children),e.flags|=4096,e)}function U7(t,e,r){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),eP(t.return,e,r)}function f4(t,e,r,i,s){var n=t.memoizedState;n===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:s}:(n.isBackwards=e,n.rendering=null,n.renderingStartTime=0,n.last=i,n.tail=r,n.tailMode=s)}function bG(t,e,r){var i=e.pendingProps,s=i.revealOrder,n=i.tail;if(Jo(t,e,i.children,r),i=Li.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&U7(t,r,e);else if(t.tag===19)U7(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(ui(Li,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&SE(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),f4(e,!1,s,r,n);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&SE(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}f4(e,!0,r,null,n);break;case"together":f4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function E2(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Zh(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),xg|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(_t(153));if(e.child!==null){for(t=e.child,r=Cd(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Cd(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function aae(t,e,r){switch(e.tag){case 3:CG(e),r1();break;case 5:Kz(e);break;case 1:Pa(e.type)&&mE(e);break;case 4:_M(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;ui(wE,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(ui(Li,Li.current&1),e.flags|=128,null):r&e.child.childLanes?SG(t,e,r):(ui(Li,Li.current&1),t=Zh(t,e,r),t!==null?t.sibling:null);ui(Li,Li.current&1);break;case 19:if(i=(r&e.childLanes)!==0,t.flags&128){if(i)return bG(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ui(Li,Li.current),i)break;return null;case 22:case 23:return e.lanes=0,wG(t,e,r)}return Zh(t,e,r)}var xG,lP,EG,TG;xG=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};lP=function(){};EG=function(t,e,r,i){var s=t.memoizedProps;if(s!==i){t=e.stateNode,ng(Bu.current);var n=null;switch(r){case"input":s=I3(t,s),i=I3(t,i),n=[];break;case"select":s=Vi({},s,{value:void 0}),i=Vi({},i,{value:void 0}),n=[];break;case"textarea":s=M3(t,s),i=M3(t,i),n=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=dE)}N3(r,i);var o;r=null;for(d in s)if(!i.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Iy.hasOwnProperty(d)?n||(n=[]):(n=n||[]).push(d,null));for(d in i){var h=i[d];if(l=s!=null?s[d]:void 0,i.hasOwnProperty(d)&&h!==l&&(h!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||h&&h.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in h)h.hasOwnProperty(o)&&l[o]!==h[o]&&(r||(r={}),r[o]=h[o])}else r||(n||(n=[]),n.push(d,r)),r=h;else d==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,l=l?l.__html:void 0,h!=null&&l!==h&&(n=n||[]).push(d,h)):d==="children"?typeof h!="string"&&typeof h!="number"||(n=n||[]).push(d,""+h):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Iy.hasOwnProperty(d)?(h!=null&&d==="onScroll"&&vi("scroll",t),n||l===h||(n=[])):(n=n||[]).push(d,h))}r&&(n=n||[]).push("style",r);var d=n;(e.updateQueue=d)&&(e.flags|=4)}};TG=function(t,e,r,i){r!==i&&(e.flags|=4)};function Tv(t,e){if(!Ri)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function To(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,i=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=i,t.childLanes=r,e}function lae(t,e,r){var i=e.pendingProps;switch(yM(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return To(e),null;case 1:return Pa(e.type)&&gE(),To(e),null;case 3:return i=e.stateNode,i1(),yi(Ia),yi(Ho),AM(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(db(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Tc!==null&&(pP(Tc),Tc=null))),lP(t,e),To(e),null;case 5:RM(e);var s=ng(Wy.current);if(r=e.type,t!==null&&e.stateNode!=null)EG(t,e,r,i,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(_t(166));return To(e),null}if(t=ng(Bu.current),db(e)){i=e.stateNode,r=e.type;var n=e.memoizedProps;switch(i[Mu]=e,i[By]=n,t=(e.mode&1)!==0,r){case"dialog":vi("cancel",i),vi("close",i);break;case"iframe":case"object":case"embed":vi("load",i);break;case"video":case"audio":for(s=0;s<Hw.length;s++)vi(Hw[s],i);break;case"source":vi("error",i);break;case"img":case"image":case"link":vi("error",i),vi("load",i);break;case"details":vi("toggle",i);break;case"input":ZH(i,n),vi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!n.multiple},vi("invalid",i);break;case"textarea":t7(i,n),vi("invalid",i)}N3(r,n),s=null;for(var o in n)if(n.hasOwnProperty(o)){var l=n[o];o==="children"?typeof l=="string"?i.textContent!==l&&(n.suppressHydrationWarning!==!0&&fb(i.textContent,l,t),s=["children",l]):typeof l=="number"&&i.textContent!==""+l&&(n.suppressHydrationWarning!==!0&&fb(i.textContent,l,t),s=["children",""+l]):Iy.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&vi("scroll",i)}switch(r){case"input":ib(i),e7(i,n,!0);break;case"textarea":ib(i),r7(i);break;case"select":case"option":break;default:typeof n.onClick=="function"&&(i.onclick=dE)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ZU(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(r,{is:i.is}):(t=o.createElement(r),r==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,r),t[Mu]=e,t[By]=i,xG(t,e,!1,!1),e.stateNode=t;e:{switch(o=D3(r,i),r){case"dialog":vi("cancel",t),vi("close",t),s=i;break;case"iframe":case"object":case"embed":vi("load",t),s=i;break;case"video":case"audio":for(s=0;s<Hw.length;s++)vi(Hw[s],t);s=i;break;case"source":vi("error",t),s=i;break;case"img":case"image":case"link":vi("error",t),vi("load",t),s=i;break;case"details":vi("toggle",t),s=i;break;case"input":ZH(t,i),s=I3(t,i),vi("invalid",t);break;case"option":s=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},s=Vi({},i,{value:void 0}),vi("invalid",t);break;case"textarea":t7(t,i),s=M3(t,i),vi("invalid",t);break;default:s=i}N3(r,s),l=s;for(n in l)if(l.hasOwnProperty(n)){var h=l[n];n==="style"?rz(t,h):n==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&ez(t,h)):n==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&Py(t,h):typeof h=="number"&&Py(t,""+h):n!=="suppressContentEditableWarning"&&n!=="suppressHydrationWarning"&&n!=="autoFocus"&&(Iy.hasOwnProperty(n)?h!=null&&n==="onScroll"&&vi("scroll",t):h!=null&&iM(t,n,h,o))}switch(r){case"input":ib(t),e7(t,i,!1);break;case"textarea":ib(t),r7(t);break;case"option":i.value!=null&&t.setAttribute("value",""+_d(i.value));break;case"select":t.multiple=!!i.multiple,n=i.value,n!=null?Np(t,!!i.multiple,n,!1):i.defaultValue!=null&&Np(t,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=dE)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return To(e),null;case 6:if(t&&e.stateNode!=null)TG(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(_t(166));if(r=ng(Wy.current),ng(Bu.current),db(e)){if(i=e.stateNode,r=e.memoizedProps,i[Mu]=e,(n=i.nodeValue!==r)&&(t=sl,t!==null))switch(t.tag){case 3:fb(i.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&fb(i.nodeValue,r,(t.mode&1)!==0)}n&&(e.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[Mu]=e,e.stateNode=i}return To(e),null;case 13:if(yi(Li),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ri&&rl!==null&&e.mode&1&&!(e.flags&128))jz(),r1(),e.flags|=98560,n=!1;else if(n=db(e),i!==null&&i.dehydrated!==null){if(t===null){if(!n)throw Error(_t(318));if(n=e.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(_t(317));n[Mu]=e}else r1(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;To(e),n=!1}else Tc!==null&&(pP(Tc),Tc=null),n=!0;if(!n)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Li.current&1?Ms===0&&(Ms=3):BM())),e.updateQueue!==null&&(e.flags|=4),To(e),null);case 4:return i1(),lP(t,e),t===null&&Hy(e.stateNode.containerInfo),To(e),null;case 10:return xM(e.type._context),To(e),null;case 17:return Pa(e.type)&&gE(),To(e),null;case 19:if(yi(Li),n=e.memoizedState,n===null)return To(e),null;if(i=(e.flags&128)!==0,o=n.rendering,o===null)if(i)Tv(n,!1);else{if(Ms!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=SE(t),o!==null){for(e.flags|=128,Tv(n,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=r,r=e.child;r!==null;)n=r,t=i,n.flags&=14680066,o=n.alternate,o===null?(n.childLanes=0,n.lanes=t,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,t=o.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ui(Li,Li.current&1|2),e.child}t=t.sibling}n.tail!==null&&ss()>o1&&(e.flags|=128,i=!0,Tv(n,!1),e.lanes=4194304)}else{if(!i)if(t=SE(o),t!==null){if(e.flags|=128,i=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Tv(n,!0),n.tail===null&&n.tailMode==="hidden"&&!o.alternate&&!Ri)return To(e),null}else 2*ss()-n.renderingStartTime>o1&&r!==1073741824&&(e.flags|=128,i=!0,Tv(n,!1),e.lanes=4194304);n.isBackwards?(o.sibling=e.child,e.child=o):(r=n.last,r!==null?r.sibling=o:e.child=o,n.last=o)}return n.tail!==null?(e=n.tail,n.rendering=e,n.tail=e.sibling,n.renderingStartTime=ss(),e.sibling=null,r=Li.current,ui(Li,i?r&1|2:r&1),e):(To(e),null);case 22:case 23:return $M(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Ja&1073741824&&(To(e),e.subtreeFlags&6&&(e.flags|=8192)):To(e),null;case 24:return null;case 25:return null}throw Error(_t(156,e.tag))}function cae(t,e){switch(yM(e),e.tag){case 1:return Pa(e.type)&&gE(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return i1(),yi(Ia),yi(Ho),AM(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return RM(e),null;case 13:if(yi(Li),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(_t(340));r1()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yi(Li),null;case 4:return i1(),null;case 10:return xM(e.type._context),null;case 22:case 23:return $M(),null;case 24:return null;default:return null}}var pb=!1,Fo=!1,uae=typeof WeakSet=="function"?WeakSet:Set,or=null;function Tp(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){Ji(t,e,i)}else r.current=null}function cP(t,e,r){try{r()}catch(i){Ji(t,e,i)}}var z7=!1;function hae(t,e){if(G3=uE,t=Iz(),vM(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var s=i.anchorOffset,n=i.focusNode;i=i.focusOffset;try{r.nodeType,n.nodeType}catch{r=null;break e}var o=0,l=-1,h=-1,d=0,g=0,y=t,C=null;t:for(;;){for(var x;y!==r||s!==0&&y.nodeType!==3||(l=o+s),y!==n||i!==0&&y.nodeType!==3||(h=o+i),y.nodeType===3&&(o+=y.nodeValue.length),(x=y.firstChild)!==null;)C=y,y=x;for(;;){if(y===t)break t;if(C===r&&++d===s&&(l=o),C===n&&++g===i&&(h=o),(x=y.nextSibling)!==null)break;y=C,C=y.parentNode}y=x}r=l===-1||h===-1?null:{start:l,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(Y3={focusedElem:t,selectionRange:r},uE=!1,or=e;or!==null;)if(e=or,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,or=t;else for(;or!==null;){e=or;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var E=_.memoizedProps,R=_.memoizedState,I=e.stateNode,F=I.getSnapshotBeforeUpdate(e.elementType===e.type?E:Cc(e.type,E),R);I.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var H=e.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_t(163))}}catch(z){Ji(e,e.return,z)}if(t=e.sibling,t!==null){t.return=e.return,or=t;break}or=e.return}return _=z7,z7=!1,_}function Zw(t,e,r){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&t)===t){var n=s.destroy;s.destroy=void 0,n!==void 0&&cP(e,r,n)}s=s.next}while(s!==i)}}function o_(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var i=r.create;r.destroy=i()}r=r.next}while(r!==e)}}function uP(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function _G(t){var e=t.alternate;e!==null&&(t.alternate=null,_G(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Mu],delete e[By],delete e[q3],delete e[Yoe],delete e[Koe])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function RG(t){return t.tag===5||t.tag===3||t.tag===4}function G7(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||RG(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hP(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=dE));else if(i!==4&&(t=t.child,t!==null))for(hP(t,e,r),t=t.sibling;t!==null;)hP(t,e,r),t=t.sibling}function fP(t,e,r){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(fP(t,e,r),t=t.sibling;t!==null;)fP(t,e,r),t=t.sibling}var io=null,Sc=!1;function Ef(t,e,r){for(r=r.child;r!==null;)AG(t,e,r),r=r.sibling}function AG(t,e,r){if($u&&typeof $u.onCommitFiberUnmount=="function")try{$u.onCommitFiberUnmount(QT,r)}catch{}switch(r.tag){case 5:Fo||Tp(r,e);case 6:var i=io,s=Sc;io=null,Ef(t,e,r),io=i,Sc=s,io!==null&&(Sc?(t=io,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):io.removeChild(r.stateNode));break;case 18:io!==null&&(Sc?(t=io,r=r.stateNode,t.nodeType===8?s4(t.parentNode,r):t.nodeType===1&&s4(t,r),Ny(t)):s4(io,r.stateNode));break;case 4:i=io,s=Sc,io=r.stateNode.containerInfo,Sc=!0,Ef(t,e,r),io=i,Sc=s;break;case 0:case 11:case 14:case 15:if(!Fo&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var n=s,o=n.destroy;n=n.tag,o!==void 0&&(n&2||n&4)&&cP(r,e,o),s=s.next}while(s!==i)}Ef(t,e,r);break;case 1:if(!Fo&&(Tp(r,e),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(l){Ji(r,e,l)}Ef(t,e,r);break;case 21:Ef(t,e,r);break;case 22:r.mode&1?(Fo=(i=Fo)||r.memoizedState!==null,Ef(t,e,r),Fo=i):Ef(t,e,r);break;default:Ef(t,e,r)}}function Y7(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new uae),e.forEach(function(i){var s=Cae.bind(null,t,i);r.has(i)||(r.add(i),i.then(s,s))})}}function tc(t,e){var r=e.deletions;if(r!==null)for(var i=0;i<r.length;i++){var s=r[i];try{var n=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:io=l.stateNode,Sc=!1;break e;case 3:io=l.stateNode.containerInfo,Sc=!0;break e;case 4:io=l.stateNode.containerInfo,Sc=!0;break e}l=l.return}if(io===null)throw Error(_t(160));AG(n,o,s),io=null,Sc=!1;var h=s.alternate;h!==null&&(h.return=null),s.return=null}catch(d){Ji(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)OG(e,t),e=e.sibling}function OG(t,e){var r=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tc(e,t),eu(t),i&4){try{Zw(3,t,t.return),o_(3,t)}catch(E){Ji(t,t.return,E)}try{Zw(5,t,t.return)}catch(E){Ji(t,t.return,E)}}break;case 1:tc(e,t),eu(t),i&512&&r!==null&&Tp(r,r.return);break;case 5:if(tc(e,t),eu(t),i&512&&r!==null&&Tp(r,r.return),t.flags&32){var s=t.stateNode;try{Py(s,"")}catch(E){Ji(t,t.return,E)}}if(i&4&&(s=t.stateNode,s!=null)){var n=t.memoizedProps,o=r!==null?r.memoizedProps:n,l=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{l==="input"&&n.type==="radio"&&n.name!=null&&JU(s,n),D3(l,o);var d=D3(l,n);for(o=0;o<h.length;o+=2){var g=h[o],y=h[o+1];g==="style"?rz(s,y):g==="dangerouslySetInnerHTML"?ez(s,y):g==="children"?Py(s,y):iM(s,g,y,d)}switch(l){case"input":P3(s,n);break;case"textarea":QU(s,n);break;case"select":var C=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!n.multiple;var x=n.value;x!=null?Np(s,!!n.multiple,x,!1):C!==!!n.multiple&&(n.defaultValue!=null?Np(s,!!n.multiple,n.defaultValue,!0):Np(s,!!n.multiple,n.multiple?[]:"",!1))}s[By]=n}catch(E){Ji(t,t.return,E)}}break;case 6:if(tc(e,t),eu(t),i&4){if(t.stateNode===null)throw Error(_t(162));s=t.stateNode,n=t.memoizedProps;try{s.nodeValue=n}catch(E){Ji(t,t.return,E)}}break;case 3:if(tc(e,t),eu(t),i&4&&r!==null&&r.memoizedState.isDehydrated)try{Ny(e.containerInfo)}catch(E){Ji(t,t.return,E)}break;case 4:tc(e,t),eu(t);break;case 13:tc(e,t),eu(t),s=t.child,s.flags&8192&&(n=s.memoizedState!==null,s.stateNode.isHidden=n,!n||s.alternate!==null&&s.alternate.memoizedState!==null||(LM=ss())),i&4&&Y7(t);break;case 22:if(g=r!==null&&r.memoizedState!==null,t.mode&1?(Fo=(d=Fo)||g,tc(e,t),Fo=d):tc(e,t),eu(t),i&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!g&&t.mode&1)for(or=t,g=t.child;g!==null;){for(y=or=g;or!==null;){switch(C=or,x=C.child,C.tag){case 0:case 11:case 14:case 15:Zw(4,C,C.return);break;case 1:Tp(C,C.return);var _=C.stateNode;if(typeof _.componentWillUnmount=="function"){i=C,r=C.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(E){Ji(i,r,E)}}break;case 5:Tp(C,C.return);break;case 22:if(C.memoizedState!==null){X7(y);continue}}x!==null?(x.return=C,or=x):X7(y)}g=g.sibling}e:for(g=null,y=t;;){if(y.tag===5){if(g===null){g=y;try{s=y.stateNode,d?(n=s.style,typeof n.setProperty=="function"?n.setProperty("display","none","important"):n.display="none"):(l=y.stateNode,h=y.memoizedProps.style,o=h!=null&&h.hasOwnProperty("display")?h.display:null,l.style.display=tz("display",o))}catch(E){Ji(t,t.return,E)}}}else if(y.tag===6){if(g===null)try{y.stateNode.nodeValue=d?"":y.memoizedProps}catch(E){Ji(t,t.return,E)}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===t)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===t)break e;for(;y.sibling===null;){if(y.return===null||y.return===t)break e;g===y&&(g=null),y=y.return}g===y&&(g=null),y.sibling.return=y.return,y=y.sibling}}break;case 19:tc(e,t),eu(t),i&4&&Y7(t);break;case 21:break;default:tc(e,t),eu(t)}}function eu(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(RG(r)){var i=r;break e}r=r.return}throw Error(_t(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(Py(s,""),i.flags&=-33);var n=G7(t);fP(t,n,s);break;case 3:case 4:var o=i.stateNode.containerInfo,l=G7(t);hP(t,l,o);break;default:throw Error(_t(161))}}catch(h){Ji(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function fae(t,e,r){or=t,IG(t)}function IG(t,e,r){for(var i=(t.mode&1)!==0;or!==null;){var s=or,n=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||pb;if(!o){var l=s.alternate,h=l!==null&&l.memoizedState!==null||Fo;l=pb;var d=Fo;if(pb=o,(Fo=h)&&!d)for(or=s;or!==null;)o=or,h=o.child,o.tag===22&&o.memoizedState!==null?q7(s):h!==null?(h.return=o,or=h):q7(s);for(;n!==null;)or=n,IG(n),n=n.sibling;or=s,pb=l,Fo=d}K7(t)}else s.subtreeFlags&8772&&n!==null?(n.return=s,or=n):K7(t)}}function K7(t){for(;or!==null;){var e=or;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Fo||o_(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Fo)if(r===null)i.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Cc(e.type,r.memoizedProps);i.componentDidUpdate(s,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var n=e.updateQueue;n!==null&&F7(e,n,i);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}F7(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var y=g.dehydrated;y!==null&&Ny(y)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_t(163))}Fo||e.flags&512&&uP(e)}catch(C){Ji(e,e.return,C)}}if(e===t){or=null;break}if(r=e.sibling,r!==null){r.return=e.return,or=r;break}or=e.return}}function X7(t){for(;or!==null;){var e=or;if(e===t){or=null;break}var r=e.sibling;if(r!==null){r.return=e.return,or=r;break}or=e.return}}function q7(t){for(;or!==null;){var e=or;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{o_(4,e)}catch(h){Ji(e,r,h)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(h){Ji(e,s,h)}}var n=e.return;try{uP(e)}catch(h){Ji(e,n,h)}break;case 5:var o=e.return;try{uP(e)}catch(h){Ji(e,o,h)}}}catch(h){Ji(e,e.return,h)}if(e===t){or=null;break}var l=e.sibling;if(l!==null){l.return=e.return,or=l;break}or=e.return}}var dae=Math.ceil,EE=lf.ReactCurrentDispatcher,NM=lf.ReactCurrentOwner,Wl=lf.ReactCurrentBatchConfig,En=0,Xs=null,ps=null,lo=0,Ja=0,_p=Nd(0),Ms=0,Gy=null,xg=0,a_=0,DM=0,ey=null,Aa=null,LM=0,o1=1/0,Rh=null,TE=!1,dP=null,wd=null,vb=!1,rd=null,_E=0,ty=0,gP=null,T2=-1,_2=0;function sa(){return En&6?ss():T2!==-1?T2:T2=ss()}function yd(t){return t.mode&1?En&2&&lo!==0?lo&-lo:qoe.transition!==null?(_2===0&&(_2=gz()),_2):(t=Kn,t!==0||(t=window.event,t=t===void 0?16:Sz(t.type)),t):1}function Pc(t,e,r,i){if(50<ty)throw ty=0,gP=null,Error(_t(185));RC(t,r,i),(!(En&2)||t!==Xs)&&(t===Xs&&(!(En&2)&&(a_|=r),Ms===4&&Jf(t,lo)),Fa(t,i),r===1&&En===0&&!(e.mode&1)&&(o1=ss()+500,n_&&Dd()))}function Fa(t,e){var r=t.callbackNode;qse(t,e);var i=cE(t,t===Xs?lo:0);if(i===0)r!==null&&s7(r),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(r!=null&&s7(r),e===1)t.tag===0?Xoe(J7.bind(null,t)):Bz(J7.bind(null,t)),zoe(function(){!(En&6)&&Dd()}),r=null;else{switch(mz(i)){case 1:r=cM;break;case 4:r=fz;break;case 16:r=lE;break;case 536870912:r=dz;break;default:r=lE}r=HG(r,PG.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function PG(t,e){if(T2=-1,_2=0,En&6)throw Error(_t(327));var r=t.callbackNode;if(Bp()&&t.callbackNode!==r)return null;var i=cE(t,t===Xs?lo:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=RE(t,i);else{e=i;var s=En;En|=2;var n=MG();(Xs!==t||lo!==e)&&(Rh=null,o1=ss()+500,fg(t,e));do try{pae();break}catch(l){FG(t,l)}while(!0);bM(),EE.current=n,En=s,ps!==null?e=0:(Xs=null,lo=0,e=Ms)}if(e!==0){if(e===2&&(s=V3(t),s!==0&&(i=s,e=mP(t,s))),e===1)throw r=Gy,fg(t,0),Jf(t,i),Fa(t,ss()),r;if(e===6)Jf(t,i);else{if(s=t.current.alternate,!(i&30)&&!gae(s)&&(e=RE(t,i),e===2&&(n=V3(t),n!==0&&(i=n,e=mP(t,n))),e===1))throw r=Gy,fg(t,0),Jf(t,i),Fa(t,ss()),r;switch(t.finishedWork=s,t.finishedLanes=i,e){case 0:case 1:throw Error(_t(345));case 2:Y0(t,Aa,Rh);break;case 3:if(Jf(t,i),(i&130023424)===i&&(e=LM+500-ss(),10<e)){if(cE(t,0)!==0)break;if(s=t.suspendedLanes,(s&i)!==i){sa(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=X3(Y0.bind(null,t,Aa,Rh),e);break}Y0(t,Aa,Rh);break;case 4:if(Jf(t,i),(i&4194240)===i)break;for(e=t.eventTimes,s=-1;0<i;){var o=31-Ic(i);n=1<<o,o=e[o],o>s&&(s=o),i&=~n}if(i=s,i=ss()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*dae(i/1960))-i,10<i){t.timeoutHandle=X3(Y0.bind(null,t,Aa,Rh),i);break}Y0(t,Aa,Rh);break;case 5:Y0(t,Aa,Rh);break;default:throw Error(_t(329))}}}return Fa(t,ss()),t.callbackNode===r?PG.bind(null,t):null}function mP(t,e){var r=ey;return t.current.memoizedState.isDehydrated&&(fg(t,e).flags|=256),t=RE(t,e),t!==2&&(e=Aa,Aa=r,e!==null&&pP(e)),t}function pP(t){Aa===null?Aa=t:Aa.push.apply(Aa,t)}function gae(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var s=r[i],n=s.getSnapshot;s=s.value;try{if(!Nc(n(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jf(t,e){for(e&=~DM,e&=~a_,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ic(e),i=1<<r;t[r]=-1,e&=~i}}function J7(t){if(En&6)throw Error(_t(327));Bp();var e=cE(t,0);if(!(e&1))return Fa(t,ss()),null;var r=RE(t,e);if(t.tag!==0&&r===2){var i=V3(t);i!==0&&(e=i,r=mP(t,i))}if(r===1)throw r=Gy,fg(t,0),Jf(t,e),Fa(t,ss()),r;if(r===6)throw Error(_t(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Y0(t,Aa,Rh),Fa(t,ss()),null}function HM(t,e){var r=En;En|=1;try{return t(e)}finally{En=r,En===0&&(o1=ss()+500,n_&&Dd())}}function Eg(t){rd!==null&&rd.tag===0&&!(En&6)&&Bp();var e=En;En|=1;var r=Wl.transition,i=Kn;try{if(Wl.transition=null,Kn=1,t)return t()}finally{Kn=i,Wl.transition=r,En=e,!(En&6)&&Dd()}}function $M(){Ja=_p.current,yi(_p)}function fg(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Uoe(r)),ps!==null)for(r=ps.return;r!==null;){var i=r;switch(yM(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&gE();break;case 3:i1(),yi(Ia),yi(Ho),AM();break;case 5:RM(i);break;case 4:i1();break;case 13:yi(Li);break;case 19:yi(Li);break;case 10:xM(i.type._context);break;case 22:case 23:$M()}r=r.return}if(Xs=t,ps=t=Cd(t.current,null),lo=Ja=e,Ms=0,Gy=null,DM=a_=xg=0,Aa=ey=null,rg!==null){for(e=0;e<rg.length;e++)if(r=rg[e],i=r.interleaved,i!==null){r.interleaved=null;var s=i.next,n=r.pending;if(n!==null){var o=n.next;n.next=s,i.next=o}r.pending=i}rg=null}return t}function FG(t,e){do{var r=ps;try{if(bM(),b2.current=xE,bE){for(var i=Bi.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}bE=!1}if(bg=0,js=Fs=Bi=null,Qw=!1,jy=0,NM.current=null,r===null||r.return===null){Ms=1,Gy=e,ps=null;break}e:{var n=t,o=r.return,l=r,h=e;if(e=lo,l.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var d=h,g=l,y=g.tag;if(!(g.mode&1)&&(y===0||y===11||y===15)){var C=g.alternate;C?(g.updateQueue=C.updateQueue,g.memoizedState=C.memoizedState,g.lanes=C.lanes):(g.updateQueue=null,g.memoizedState=null)}var x=H7(o);if(x!==null){x.flags&=-257,$7(x,o,l,n,e),x.mode&1&&L7(n,d,e),e=x,h=d;var _=e.updateQueue;if(_===null){var E=new Set;E.add(h),e.updateQueue=E}else _.add(h);break e}else{if(!(e&1)){L7(n,d,e),BM();break e}h=Error(_t(426))}}else if(Ri&&l.mode&1){var R=H7(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),$7(R,o,l,n,e),CM(s1(h,l));break e}}n=h=s1(h,l),Ms!==4&&(Ms=2),ey===null?ey=[n]:ey.push(n),n=o;do{switch(n.tag){case 3:n.flags|=65536,e&=-e,n.lanes|=e;var I=mG(n,h,e);P7(n,I);break e;case 1:l=h;var F=n.type,H=n.stateNode;if(!(n.flags&128)&&(typeof F.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(wd===null||!wd.has(H)))){n.flags|=65536,e&=-e,n.lanes|=e;var z=pG(n,l,e);P7(n,z);break e}}n=n.return}while(n!==null)}NG(r)}catch(q){e=q,ps===r&&r!==null&&(ps=r=r.return);continue}break}while(!0)}function MG(){var t=EE.current;return EE.current=xE,t===null?xE:t}function BM(){(Ms===0||Ms===3||Ms===2)&&(Ms=4),Xs===null||!(xg&268435455)&&!(a_&268435455)||Jf(Xs,lo)}function RE(t,e){var r=En;En|=2;var i=MG();(Xs!==t||lo!==e)&&(Rh=null,fg(t,e));do try{mae();break}catch(s){FG(t,s)}while(!0);if(bM(),En=r,EE.current=i,ps!==null)throw Error(_t(261));return Xs=null,lo=0,Ms}function mae(){for(;ps!==null;)kG(ps)}function pae(){for(;ps!==null&&!Vse();)kG(ps)}function kG(t){var e=LG(t.alternate,t,Ja);t.memoizedProps=t.pendingProps,e===null?NG(t):ps=e,NM.current=null}function NG(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=cae(r,e),r!==null){r.flags&=32767,ps=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ms=6,ps=null;return}}else if(r=lae(r,e,Ja),r!==null){ps=r;return}if(e=e.sibling,e!==null){ps=e;return}ps=e=t}while(e!==null);Ms===0&&(Ms=5)}function Y0(t,e,r){var i=Kn,s=Wl.transition;try{Wl.transition=null,Kn=1,vae(t,e,r,i)}finally{Wl.transition=s,Kn=i}return null}function vae(t,e,r,i){do Bp();while(rd!==null);if(En&6)throw Error(_t(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(_t(177));t.callbackNode=null,t.callbackPriority=0;var n=r.lanes|r.childLanes;if(Jse(t,n),t===Xs&&(ps=Xs=null,lo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||vb||(vb=!0,HG(lE,function(){return Bp(),null})),n=(r.flags&15990)!==0,r.subtreeFlags&15990||n){n=Wl.transition,Wl.transition=null;var o=Kn;Kn=1;var l=En;En|=4,NM.current=null,hae(t,r),OG(r,t),Loe(Y3),uE=!!G3,Y3=G3=null,t.current=r,fae(r),Wse(),En=l,Kn=o,Wl.transition=n}else t.current=r;if(vb&&(vb=!1,rd=t,_E=s),n=t.pendingLanes,n===0&&(wd=null),zse(r.stateNode),Fa(t,ss()),e!==null)for(i=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],i(s.value,{componentStack:s.stack,digest:s.digest});if(TE)throw TE=!1,t=dP,dP=null,t;return _E&1&&t.tag!==0&&Bp(),n=t.pendingLanes,n&1?t===gP?ty++:(ty=0,gP=t):ty=0,Dd(),null}function Bp(){if(rd!==null){var t=mz(_E),e=Wl.transition,r=Kn;try{if(Wl.transition=null,Kn=16>t?16:t,rd===null)var i=!1;else{if(t=rd,rd=null,_E=0,En&6)throw Error(_t(331));var s=En;for(En|=4,or=t.current;or!==null;){var n=or,o=n.child;if(or.flags&16){var l=n.deletions;if(l!==null){for(var h=0;h<l.length;h++){var d=l[h];for(or=d;or!==null;){var g=or;switch(g.tag){case 0:case 11:case 15:Zw(8,g,n)}var y=g.child;if(y!==null)y.return=g,or=y;else for(;or!==null;){g=or;var C=g.sibling,x=g.return;if(_G(g),g===d){or=null;break}if(C!==null){C.return=x,or=C;break}or=x}}}var _=n.alternate;if(_!==null){var E=_.child;if(E!==null){_.child=null;do{var R=E.sibling;E.sibling=null,E=R}while(E!==null)}}or=n}}if(n.subtreeFlags&2064&&o!==null)o.return=n,or=o;else e:for(;or!==null;){if(n=or,n.flags&2048)switch(n.tag){case 0:case 11:case 15:Zw(9,n,n.return)}var I=n.sibling;if(I!==null){I.return=n.return,or=I;break e}or=n.return}}var F=t.current;for(or=F;or!==null;){o=or;var H=o.child;if(o.subtreeFlags&2064&&H!==null)H.return=o,or=H;else e:for(o=F;or!==null;){if(l=or,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:o_(9,l)}}catch(q){Ji(l,l.return,q)}if(l===o){or=null;break e}var z=l.sibling;if(z!==null){z.return=l.return,or=z;break e}or=l.return}}if(En=s,Dd(),$u&&typeof $u.onPostCommitFiberRoot=="function")try{$u.onPostCommitFiberRoot(QT,t)}catch{}i=!0}return i}finally{Kn=r,Wl.transition=e}}return!1}function Q7(t,e,r){e=s1(r,e),e=mG(t,e,1),t=vd(t,e,1),e=sa(),t!==null&&(RC(t,1,e),Fa(t,e))}function Ji(t,e,r){if(t.tag===3)Q7(t,t,r);else for(;e!==null;){if(e.tag===3){Q7(e,t,r);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(wd===null||!wd.has(i))){t=s1(r,t),t=pG(e,t,1),e=vd(e,t,1),t=sa(),e!==null&&(RC(e,1,t),Fa(e,t));break}}e=e.return}}function wae(t,e,r){var i=t.pingCache;i!==null&&i.delete(e),e=sa(),t.pingedLanes|=t.suspendedLanes&r,Xs===t&&(lo&r)===r&&(Ms===4||Ms===3&&(lo&130023424)===lo&&500>ss()-LM?fg(t,0):DM|=r),Fa(t,e)}function DG(t,e){e===0&&(t.mode&1?(e=ab,ab<<=1,!(ab&130023424)&&(ab=4194304)):e=1);var r=sa();t=Qh(t,e),t!==null&&(RC(t,e,r),Fa(t,r))}function yae(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),DG(t,r)}function Cae(t,e){var r=0;switch(t.tag){case 13:var i=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(_t(314))}i!==null&&i.delete(e),DG(t,r)}var LG;LG=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ia.current)Oa=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Oa=!1,aae(t,e,r);Oa=!!(t.flags&131072)}else Oa=!1,Ri&&e.flags&1048576&&Vz(e,vE,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;E2(t,e),t=e.pendingProps;var s=t1(e,Ho.current);$p(e,r),s=IM(null,e,i,t,s,r);var n=PM();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pa(i)?(n=!0,mE(e)):n=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,TM(e),s.updater=s_,e.stateNode=s,s._reactInternals=e,rP(e,i,t,r),e=sP(null,e,i,!0,n,r)):(e.tag=0,Ri&&n&&wM(e),Jo(null,e,s,r),e=e.child),e;case 16:i=e.elementType;e:{switch(E2(t,e),t=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=bae(i),t=Cc(i,t),s){case 0:e=iP(null,e,i,t,r);break e;case 1:e=W7(null,e,i,t,r);break e;case 11:e=B7(null,e,i,t,r);break e;case 14:e=V7(null,e,i,Cc(i.type,t),r);break e}throw Error(_t(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Cc(i,s),iP(t,e,i,s,r);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Cc(i,s),W7(t,e,i,s,r);case 3:e:{if(CG(e),t===null)throw Error(_t(387));i=e.pendingProps,n=e.memoizedState,s=n.element,Yz(t,e),CE(e,i,null,r);var o=e.memoizedState;if(i=o.element,n.isDehydrated)if(n={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=n,e.memoizedState=n,e.flags&256){s=s1(Error(_t(423)),e),e=j7(t,e,i,r,s);break e}else if(i!==s){s=s1(Error(_t(424)),e),e=j7(t,e,i,r,s);break e}else for(rl=pd(e.stateNode.containerInfo.firstChild),sl=e,Ri=!0,Tc=null,r=zz(e,null,i,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(r1(),i===s){e=Zh(t,e,r);break e}Jo(t,e,i,r)}e=e.child}return e;case 5:return Kz(e),t===null&&Z3(e),i=e.type,s=e.pendingProps,n=t!==null?t.memoizedProps:null,o=s.children,K3(i,s)?o=null:n!==null&&K3(i,n)&&(e.flags|=32),yG(t,e),Jo(t,e,o,r),e.child;case 6:return t===null&&Z3(e),null;case 13:return SG(t,e,r);case 4:return _M(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=n1(e,null,i,r):Jo(t,e,i,r),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Cc(i,s),B7(t,e,i,s,r);case 7:return Jo(t,e,e.pendingProps,r),e.child;case 8:return Jo(t,e,e.pendingProps.children,r),e.child;case 12:return Jo(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,n=e.memoizedProps,o=s.value,ui(wE,i._currentValue),i._currentValue=o,n!==null)if(Nc(n.value,o)){if(n.children===s.children&&!Ia.current){e=Zh(t,e,r);break e}}else for(n=e.child,n!==null&&(n.return=e);n!==null;){var l=n.dependencies;if(l!==null){o=n.child;for(var h=l.firstContext;h!==null;){if(h.context===i){if(n.tag===1){h=Uh(-1,r&-r),h.tag=2;var d=n.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?h.next=h:(h.next=g.next,g.next=h),d.pending=h}}n.lanes|=r,h=n.alternate,h!==null&&(h.lanes|=r),eP(n.return,r,e),l.lanes|=r;break}h=h.next}}else if(n.tag===10)o=n.type===e.type?null:n.child;else if(n.tag===18){if(o=n.return,o===null)throw Error(_t(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),eP(o,r,e),o=n.sibling}else o=n.child;if(o!==null)o.return=n;else for(o=n;o!==null;){if(o===e){o=null;break}if(n=o.sibling,n!==null){n.return=o.return,o=n;break}o=o.return}n=o}Jo(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,$p(e,r),s=Ul(s),i=i(s),e.flags|=1,Jo(t,e,i,r),e.child;case 14:return i=e.type,s=Cc(i,e.pendingProps),s=Cc(i.type,s),V7(t,e,i,s,r);case 15:return vG(t,e,e.type,e.pendingProps,r);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:Cc(i,s),E2(t,e),e.tag=1,Pa(i)?(t=!0,mE(e)):t=!1,$p(e,r),gG(e,i,s),rP(e,i,s,r),sP(null,e,i,!0,t,r);case 19:return bG(t,e,r);case 22:return wG(t,e,r)}throw Error(_t(156,e.tag))};function HG(t,e){return hz(t,e)}function Sae(t,e,r,i){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vl(t,e,r,i){return new Sae(t,e,r,i)}function VM(t){return t=t.prototype,!(!t||!t.isReactComponent)}function bae(t){if(typeof t=="function")return VM(t)?1:0;if(t!=null){if(t=t.$$typeof,t===oM)return 11;if(t===aM)return 14}return 2}function Cd(t,e){var r=t.alternate;return r===null?(r=Vl(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function R2(t,e,r,i,s,n){var o=2;if(i=t,typeof t=="function")VM(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pp:return dg(r.children,s,n,e);case sM:o=8,s|=8;break;case _3:return t=Vl(12,r,e,s|2),t.elementType=_3,t.lanes=n,t;case R3:return t=Vl(13,r,e,s),t.elementType=R3,t.lanes=n,t;case A3:return t=Vl(19,r,e,s),t.elementType=A3,t.lanes=n,t;case KU:return l_(r,s,n,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case GU:o=10;break e;case YU:o=9;break e;case oM:o=11;break e;case aM:o=14;break e;case jf:o=16,i=null;break e}throw Error(_t(130,t==null?t:typeof t,""))}return e=Vl(o,r,e,s),e.elementType=t,e.type=i,e.lanes=n,e}function dg(t,e,r,i){return t=Vl(7,t,i,e),t.lanes=r,t}function l_(t,e,r,i){return t=Vl(22,t,i,e),t.elementType=KU,t.lanes=r,t.stateNode={isHidden:!1},t}function d4(t,e,r){return t=Vl(6,t,null,e),t.lanes=r,t}function g4(t,e,r){return e=Vl(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function xae(t,e,r,i,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=KA(0),this.expirationTimes=KA(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=KA(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function WM(t,e,r,i,s,n,o,l,h){return t=new xae(t,e,r,l,h),e===1?(e=1,n===!0&&(e|=8)):e=0,n=Vl(3,null,null,e),t.current=n,n.stateNode=t,n.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},TM(n),t}function Eae(t,e,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mp,key:i==null?null:""+i,children:t,containerInfo:e,implementation:r}}function $G(t){if(!t)return Rd;t=t._reactInternals;e:{if(Vg(t)!==t||t.tag!==1)throw Error(_t(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pa(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_t(171))}if(t.tag===1){var r=t.type;if(Pa(r))return $z(t,r,e)}return e}function BG(t,e,r,i,s,n,o,l,h){return t=WM(r,i,!0,t,s,n,o,l,h),t.context=$G(null),r=t.current,i=sa(),s=yd(r),n=Uh(i,s),n.callback=e??null,vd(r,n,s),t.current.lanes=s,RC(t,s,i),Fa(t,i),t}function c_(t,e,r,i){var s=e.current,n=sa(),o=yd(s);return r=$G(r),e.context===null?e.context=r:e.pendingContext=r,e=Uh(n,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=vd(s,e,o),t!==null&&(Pc(t,s,o,n),S2(t,s,o)),o}function AE(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Z7(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function jM(t,e){Z7(t,e),(t=t.alternate)&&Z7(t,e)}var VG=typeof reportError=="function"?reportError:function(t){console.error(t)};function UM(t){this._internalRoot=t}u_.prototype.render=UM.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(_t(409));c_(t,e,null,null)};u_.prototype.unmount=UM.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Eg(function(){c_(null,t,null,null)}),e[Jh]=null}};function u_(t){this._internalRoot=t}u_.prototype.unstable_scheduleHydration=function(t){if(t){var e=wz();t={blockedOn:null,target:t,priority:e};for(var r=0;r<qf.length&&e!==0&&e<qf[r].priority;r++);qf.splice(r,0,t),r===0&&Cz(t)}};function zM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function h_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function e$(){}function Tae(t,e,r,i,s){if(s){if(typeof i=="function"){var n=i;i=function(){var d=AE(o);n.call(d)}}var o=BG(e,i,t,0,null,!1,!1,"",e$);return t._reactRootContainer=o,t[Jh]=o.current,Hy(t.nodeType===8?t.parentNode:t),Eg(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof i=="function"){var l=i;i=function(){var d=AE(h);l.call(d)}}var h=WM(t,0,!1,null,null,!1,!1,"",e$);return t._reactRootContainer=h,t[Jh]=h.current,Hy(t.nodeType===8?t.parentNode:t),Eg(function(){c_(e,h,r,i)}),h}function f_(t,e,r,i,s){var n=r._reactRootContainer;if(n){var o=n;if(typeof s=="function"){var l=s;s=function(){var h=AE(o);l.call(h)}}c_(e,o,t,s)}else o=Tae(r,e,t,s,i);return AE(o)}pz=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Lw(e.pendingLanes);r!==0&&(uM(e,r|1),Fa(e,ss()),!(En&6)&&(o1=ss()+500,Dd()))}break;case 13:Eg(function(){var i=Qh(t,1);if(i!==null){var s=sa();Pc(i,t,1,s)}}),jM(t,1)}};hM=function(t){if(t.tag===13){var e=Qh(t,134217728);if(e!==null){var r=sa();Pc(e,t,134217728,r)}jM(t,134217728)}};vz=function(t){if(t.tag===13){var e=yd(t),r=Qh(t,e);if(r!==null){var i=sa();Pc(r,t,e,i)}jM(t,e)}};wz=function(){return Kn};yz=function(t,e){var r=Kn;try{return Kn=t,e()}finally{Kn=r}};H3=function(t,e,r){switch(e){case"input":if(P3(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var i=r[e];if(i!==t&&i.form===t.form){var s=r_(i);if(!s)throw Error(_t(90));qU(i),P3(i,s)}}}break;case"textarea":QU(t,r);break;case"select":e=r.value,e!=null&&Np(t,!!r.multiple,e,!1)}};sz=HM;oz=Eg;var _ae={usingClientEntryPoint:!1,Events:[OC,Cp,r_,nz,iz,HM]},_v={findFiberByHostInstance:tg,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Rae={bundleType:_v.bundleType,version:_v.version,rendererPackageName:_v.rendererPackageName,rendererConfig:_v.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lf.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=cz(t),t===null?null:t.stateNode},findFiberByHostInstance:_v.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wb.isDisabled&&wb.supportsFiber)try{QT=wb.inject(Rae),$u=wb}catch{}}ul.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_ae;ul.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zM(e))throw Error(_t(200));return Eae(t,e,null,r)};ul.createRoot=function(t,e){if(!zM(t))throw Error(_t(299));var r=!1,i="",s=VG;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=WM(t,1,!1,null,null,r,!1,i,s),t[Jh]=e.current,Hy(t.nodeType===8?t.parentNode:t),new UM(e)};ul.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(_t(188)):(t=Object.keys(t).join(","),Error(_t(268,t)));return t=cz(e),t=t===null?null:t.stateNode,t};ul.flushSync=function(t){return Eg(t)};ul.hydrate=function(t,e,r){if(!h_(e))throw Error(_t(200));return f_(null,t,e,!0,r)};ul.hydrateRoot=function(t,e,r){if(!zM(t))throw Error(_t(405));var i=r!=null&&r.hydratedSources||null,s=!1,n="",o=VG;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(n=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=BG(e,null,t,1,r??null,s,!1,n,o),t[Jh]=e.current,Hy(t),i)for(t=0;t<i.length;t++)r=i[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new u_(e)};ul.render=function(t,e,r){if(!h_(e))throw Error(_t(200));return f_(null,t,e,!1,r)};ul.unmountComponentAtNode=function(t){if(!h_(t))throw Error(_t(40));return t._reactRootContainer?(Eg(function(){f_(null,null,t,!1,function(){t._reactRootContainer=null,t[Jh]=null})}),!0):!1};ul.unstable_batchedUpdates=HM;ul.unstable_renderSubtreeIntoContainer=function(t,e,r,i){if(!h_(r))throw Error(_t(200));if(t==null||t._reactInternals===void 0)throw Error(_t(38));return f_(t,e,r,!1,i)};ul.version="18.3.1-next-f1338f8080-20240426";function WG(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WG)}catch(t){console.error(t)}}WG(),WU.exports=ul;var jG=WU.exports;const UG=JF(jG);var t$=jG;E3.createRoot=t$.createRoot,E3.hydrateRoot=t$.hydrateRoot;/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yy(){return Yy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Yy.apply(this,arguments)}var nd;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(nd||(nd={}));const r$="popstate";function Aae(t){t===void 0&&(t={});function e(i,s){let{pathname:n,search:o,hash:l}=i.location;return vP("",{pathname:n,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(i,s){return typeof s=="string"?s:GG(s)}return Iae(e,r,null,t)}function ws(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zG(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Oae(){return Math.random().toString(36).substr(2,8)}function n$(t,e){return{usr:t.state,key:t.key,idx:e}}function vP(t,e,r,i){return r===void 0&&(r=null),Yy({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?S1(e):e,{state:r,key:e&&e.key||i||Oae()})}function GG(t){let{pathname:e="/",search:r="",hash:i=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function S1(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function Iae(t,e,r,i){i===void 0&&(i={});let{window:s=document.defaultView,v5Compat:n=!1}=i,o=s.history,l=nd.Pop,h=null,d=g();d==null&&(d=0,o.replaceState(Yy({},o.state,{idx:d}),""));function g(){return(o.state||{idx:null}).idx}function y(){l=nd.Pop;let R=g(),I=R==null?null:R-d;d=R,h&&h({action:l,location:E.location,delta:I})}function C(R,I){l=nd.Push;let F=vP(E.location,R,I);d=g()+1;let H=n$(F,d),z=E.createHref(F);try{o.pushState(H,"",z)}catch(q){if(q instanceof DOMException&&q.name==="DataCloneError")throw q;s.location.assign(z)}n&&h&&h({action:l,location:E.location,delta:1})}function x(R,I){l=nd.Replace;let F=vP(E.location,R,I);d=g();let H=n$(F,d),z=E.createHref(F);o.replaceState(H,"",z),n&&h&&h({action:l,location:E.location,delta:0})}function _(R){let I=s.location.origin!=="null"?s.location.origin:s.location.href,F=typeof R=="string"?R:GG(R);return F=F.replace(/ $/,"%20"),ws(I,"No window.location.(origin|href) available to create URL for href: "+F),new URL(F,I)}let E={get action(){return l},get location(){return t(s,o)},listen(R){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(r$,y),h=R,()=>{s.removeEventListener(r$,y),h=null}},createHref(R){return e(s,R)},createURL:_,encodeLocation(R){let I=_(R);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:C,replace:x,go(R){return o.go(R)}};return E}var i$;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(i$||(i$={}));function Pae(t,e,r){return r===void 0&&(r="/"),Fae(t,e,r)}function Fae(t,e,r,i){let s=typeof e=="string"?S1(e):e,n=XG(s.pathname||"/",r);if(n==null)return null;let o=YG(t);Mae(o);let l=null;for(let h=0;l==null&&h<o.length;++h){let d=zae(n);l=Wae(o[h],d)}return l}function YG(t,e,r,i){e===void 0&&(e=[]),r===void 0&&(r=[]),i===void 0&&(i="");let s=(n,o,l)=>{let h={relativePath:l===void 0?n.path||"":l,caseSensitive:n.caseSensitive===!0,childrenIndex:o,route:n};h.relativePath.startsWith("/")&&(ws(h.relativePath.startsWith(i),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(i.length));let d=gg([i,h.relativePath]),g=r.concat(h);n.children&&n.children.length>0&&(ws(n.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),YG(n.children,e,g,d)),!(n.path==null&&!n.index)&&e.push({path:d,score:Bae(d,n.index),routesMeta:g})};return t.forEach((n,o)=>{var l;if(n.path===""||!((l=n.path)!=null&&l.includes("?")))s(n,o);else for(let h of KG(n.path))s(n,o,h)}),e}function KG(t){let e=t.split("/");if(e.length===0)return[];let[r,...i]=e,s=r.endsWith("?"),n=r.replace(/\?$/,"");if(i.length===0)return s?[n,""]:[n];let o=KG(i.join("/")),l=[];return l.push(...o.map(h=>h===""?n:[n,h].join("/"))),s&&l.push(...o),l.map(h=>t.startsWith("/")&&h===""?"/":h)}function Mae(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:Vae(e.routesMeta.map(i=>i.childrenIndex),r.routesMeta.map(i=>i.childrenIndex)))}const kae=/^:[\w-]+$/,Nae=3,Dae=2,Lae=1,Hae=10,$ae=-2,s$=t=>t==="*";function Bae(t,e){let r=t.split("/"),i=r.length;return r.some(s$)&&(i+=$ae),e&&(i+=Dae),r.filter(s=>!s$(s)).reduce((s,n)=>s+(kae.test(n)?Nae:n===""?Lae:Hae),i)}function Vae(t,e){return t.length===e.length&&t.slice(0,-1).every((i,s)=>i===e[s])?t[t.length-1]-e[e.length-1]:0}function Wae(t,e,r){let{routesMeta:i}=t,s={},n="/",o=[];for(let l=0;l<i.length;++l){let h=i[l],d=l===i.length-1,g=n==="/"?e:e.slice(n.length)||"/",y=jae({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),C=h.route;if(!y)return null;Object.assign(s,y.params),o.push({params:s,pathname:gg([n,y.pathname]),pathnameBase:Xae(gg([n,y.pathnameBase])),route:C}),y.pathnameBase!=="/"&&(n=gg([n,y.pathnameBase]))}return o}function jae(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,i]=Uae(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let n=s[0],o=n.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:i.reduce((d,g,y)=>{let{paramName:C,isOptional:x}=g;if(C==="*"){let E=l[y]||"";o=n.slice(0,n.length-E.length).replace(/(.)\/+$/,"$1")}const _=l[y];return x&&!_?d[C]=void 0:d[C]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:n,pathnameBase:o,pattern:t}}function Uae(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),zG(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,h)=>(i.push({paramName:l,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(i.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function zae(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zG(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function XG(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,i=t.charAt(r);return i&&i!=="/"?null:t.slice(r)||"/"}function Gae(t,e){e===void 0&&(e="/");let{pathname:r,search:i="",hash:s=""}=typeof t=="string"?S1(t):t;return{pathname:r?r.startsWith("/")?r:Yae(r,e):e,search:qae(i),hash:Jae(s)}}function Yae(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function m4(t,e,r,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Kae(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function qG(t,e){let r=Kae(t);return e?r.map((i,s)=>s===r.length-1?i.pathname:i.pathnameBase):r.map(i=>i.pathnameBase)}function JG(t,e,r,i){i===void 0&&(i=!1);let s;typeof t=="string"?s=S1(t):(s=Yy({},t),ws(!s.pathname||!s.pathname.includes("?"),m4("?","pathname","search",s)),ws(!s.pathname||!s.pathname.includes("#"),m4("#","pathname","hash",s)),ws(!s.search||!s.search.includes("#"),m4("#","search","hash",s)));let n=t===""||s.pathname==="",o=n?"/":s.pathname,l;if(o==null)l=r;else{let y=e.length-1;if(!i&&o.startsWith("..")){let C=o.split("/");for(;C[0]==="..";)C.shift(),y-=1;s.pathname=C.join("/")}l=y>=0?e[y]:"/"}let h=Gae(s,l),d=o&&o!=="/"&&o.endsWith("/"),g=(n||o===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}const gg=t=>t.join("/").replace(/\/\/+/g,"/"),Xae=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),qae=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Jae=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Qae(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QG=["post","put","patch","delete"];new Set(QG);const Zae=["get",...QG];new Set(Zae);/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ky(){return Ky=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Ky.apply(this,arguments)}const GM=He.createContext(null),ele=He.createContext(null),PC=He.createContext(null),d_=He.createContext(null),Wg=He.createContext({outlet:null,matches:[],isDataRoute:!1}),ZG=He.createContext(null);function FC(){return He.useContext(d_)!=null}function MC(){return FC()||ws(!1),He.useContext(d_).location}function eY(t){He.useContext(PC).static||He.useLayoutEffect(t)}function YM(){let{isDataRoute:t}=He.useContext(Wg);return t?dle():tle()}function tle(){FC()||ws(!1);let t=He.useContext(GM),{basename:e,future:r,navigator:i}=He.useContext(PC),{matches:s}=He.useContext(Wg),{pathname:n}=MC(),o=JSON.stringify(qG(s,r.v7_relativeSplatPath)),l=He.useRef(!1);return eY(()=>{l.current=!0}),He.useCallback(function(d,g){if(g===void 0&&(g={}),!l.current)return;if(typeof d=="number"){i.go(d);return}let y=JG(d,JSON.parse(o),n,g.relative==="path");t==null&&e!=="/"&&(y.pathname=y.pathname==="/"?e:gg([e,y.pathname])),(g.replace?i.replace:i.push)(y,g.state,g)},[e,i,o,n,t])}function rle(t,e){return nle(t,e)}function nle(t,e,r,i){FC()||ws(!1);let{navigator:s}=He.useContext(PC),{matches:n}=He.useContext(Wg),o=n[n.length-1],l=o?o.params:{};o&&o.pathname;let h=o?o.pathnameBase:"/";o&&o.route;let d=MC(),g;if(e){var y;let R=typeof e=="string"?S1(e):e;h==="/"||(y=R.pathname)!=null&&y.startsWith(h)||ws(!1),g=R}else g=d;let C=g.pathname||"/",x=C;if(h!=="/"){let R=h.replace(/^\//,"").split("/");x="/"+C.replace(/^\//,"").split("/").slice(R.length).join("/")}let _=Pae(t,{pathname:x}),E=lle(_&&_.map(R=>Object.assign({},R,{params:Object.assign({},l,R.params),pathname:gg([h,s.encodeLocation?s.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?h:gg([h,s.encodeLocation?s.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),n,r,i);return e&&E?He.createElement(d_.Provider,{value:{location:Ky({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:nd.Pop}},E):E}function ile(){let t=fle(),e=Qae(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return He.createElement(He.Fragment,null,He.createElement("h2",null,"Unexpected Application Error!"),He.createElement("h3",{style:{fontStyle:"italic"}},e),r?He.createElement("pre",{style:s},r):null,null)}const sle=He.createElement(ile,null);class ole extends He.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?He.createElement(Wg.Provider,{value:this.props.routeContext},He.createElement(ZG.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ale(t){let{routeContext:e,match:r,children:i}=t,s=He.useContext(GM);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),He.createElement(Wg.Provider,{value:e},i)}function lle(t,e,r,i){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),i===void 0&&(i=null),t==null){var n;if(!r)return null;if(r.errors)t=r.matches;else if((n=i)!=null&&n.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let g=o.findIndex(y=>y.route.id&&(l==null?void 0:l[y.route.id])!==void 0);g>=0||ws(!1),o=o.slice(0,Math.min(o.length,g+1))}let h=!1,d=-1;if(r&&i&&i.v7_partialHydration)for(let g=0;g<o.length;g++){let y=o[g];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=g),y.route.id){let{loaderData:C,errors:x}=r,_=y.route.loader&&C[y.route.id]===void 0&&(!x||x[y.route.id]===void 0);if(y.route.lazy||_){h=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((g,y,C)=>{let x,_=!1,E=null,R=null;r&&(x=l&&y.route.id?l[y.route.id]:void 0,E=y.route.errorElement||sle,h&&(d<0&&C===0?(_=!0,R=null):d===C&&(_=!0,R=y.route.hydrateFallbackElement||null)));let I=e.concat(o.slice(0,C+1)),F=()=>{let H;return x?H=E:_?H=R:y.route.Component?H=He.createElement(y.route.Component,null):y.route.element?H=y.route.element:H=g,He.createElement(ale,{match:y,routeContext:{outlet:g,matches:I,isDataRoute:r!=null},children:H})};return r&&(y.route.ErrorBoundary||y.route.errorElement||C===0)?He.createElement(ole,{location:r.location,revalidation:r.revalidation,component:E,error:x,children:F(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):F()},null)}var tY=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(tY||{}),OE=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(OE||{});function cle(t){let e=He.useContext(GM);return e||ws(!1),e}function ule(t){let e=He.useContext(ele);return e||ws(!1),e}function hle(t){let e=He.useContext(Wg);return e||ws(!1),e}function rY(t){let e=hle(),r=e.matches[e.matches.length-1];return r.route.id||ws(!1),r.route.id}function fle(){var t;let e=He.useContext(ZG),r=ule(OE.UseRouteError),i=rY(OE.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[i]}function dle(){let{router:t}=cle(tY.UseNavigateStable),e=rY(OE.UseNavigateStable),r=He.useRef(!1);return eY(()=>{r.current=!0}),He.useCallback(function(s,n){n===void 0&&(n={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Ky({fromRouteId:e},n)))},[t,e])}const o$={};function gle(t,e){o$[e]||(o$[e]=!0,console.warn(e))}const a$=(t,e,r)=>gle(t," React Router Future Flag Warning: "+e+". "+("You can use the `"+t+"` future flag to opt-in early. ")+("For more information, see "+r+"."));function mle(t,e){(t==null?void 0:t.v7_startTransition)===void 0&&a$("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(t==null?void 0:t.v7_relativeSplatPath)===void 0&&!e&&a$("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath")}function nY(t){let{to:e,replace:r,state:i,relative:s}=t;FC()||ws(!1);let{future:n,static:o}=He.useContext(PC),{matches:l}=He.useContext(Wg),{pathname:h}=MC(),d=YM(),g=JG(e,qG(l,n.v7_relativeSplatPath),h,s==="path"),y=JSON.stringify(g);return He.useEffect(()=>d(JSON.parse(y),{replace:r,state:i,relative:s}),[d,y,s,r,i]),null}function A2(t){ws(!1)}function ple(t){let{basename:e="/",children:r=null,location:i,navigationType:s=nd.Pop,navigator:n,static:o=!1,future:l}=t;FC()&&ws(!1);let h=e.replace(/^\/*/,"/"),d=He.useMemo(()=>({basename:h,navigator:n,static:o,future:Ky({v7_relativeSplatPath:!1},l)}),[h,l,n,o]);typeof i=="string"&&(i=S1(i));let{pathname:g="/",search:y="",hash:C="",state:x=null,key:_="default"}=i,E=He.useMemo(()=>{let R=XG(g,h);return R==null?null:{location:{pathname:R,search:y,hash:C,state:x,key:_},navigationType:s}},[h,g,y,C,x,_,s]);return E==null?null:He.createElement(PC.Provider,{value:d},He.createElement(d_.Provider,{children:r,value:E}))}function vle(t){let{children:e,location:r}=t;return rle(wP(e),r)}new Promise(()=>{});function wP(t,e){e===void 0&&(e=[]);let r=[];return He.Children.forEach(t,(i,s)=>{if(!He.isValidElement(i))return;let n=[...e,s];if(i.type===He.Fragment){r.push.apply(r,wP(i.props.children,n));return}i.type!==A2&&ws(!1),!i.props.index||!i.props.children||ws(!1);let o={id:i.props.id||n.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=wP(i.props.children,n)),r.push(o)}),r}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const wle="6";try{window.__reactRouterVersion=wle}catch{}const yle="startTransition",l$=wse[yle];function Cle(t){let{basename:e,children:r,future:i,window:s}=t,n=He.useRef();n.current==null&&(n.current=Aae({window:s,v5Compat:!0}));let o=n.current,[l,h]=He.useState({action:o.action,location:o.location}),{v7_startTransition:d}=i||{},g=He.useCallback(y=>{d&&l$?l$(()=>h(y)):h(y)},[h,d]);return He.useLayoutEffect(()=>o.listen(g),[o,g]),He.useEffect(()=>mle(i),[i]),He.createElement(ple,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:i})}var c$;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(c$||(c$={}));var u$;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(u$||(u$={}));function iY(t){var e,r,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=iY(t[e]))&&(i&&(i+=" "),i+=r)}else for(r in t)t[r]&&(i&&(i+=" "),i+=r);return i}function mg(){for(var t,e,r=0,i="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=iY(t))&&(i&&(i+=" "),i+=e);return i}function Sle(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}Sle(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var kC=t=>typeof t=="number"&&!isNaN(t),Tg=t=>typeof t=="string",ef=t=>typeof t=="function",ble=t=>Tg(t)||kC(t),yP=t=>Tg(t)||ef(t)?t:null,xle=(t,e)=>t===!1||kC(t)&&t>0?t:e,CP=t=>He.isValidElement(t)||Tg(t)||ef(t)||kC(t);function Ele(t,e,r=300){let{scrollHeight:i,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=i+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,r)})})}function Tle({enter:t,exit:e,appendPosition:r=!1,collapse:i=!0,collapseDuration:s=300}){return function({children:n,position:o,preventExitTransition:l,done:h,nodeRef:d,isIn:g,playToast:y}){let C=r?`${t}--${o}`:t,x=r?`${e}--${o}`:e,_=He.useRef(0);return He.useLayoutEffect(()=>{let E=d.current,R=C.split(" "),I=F=>{F.target===d.current&&(y(),E.removeEventListener("animationend",I),E.removeEventListener("animationcancel",I),_.current===0&&F.type!=="animationcancel"&&E.classList.remove(...R))};E.classList.add(...R),E.addEventListener("animationend",I),E.addEventListener("animationcancel",I)},[]),He.useEffect(()=>{let E=d.current,R=()=>{E.removeEventListener("animationend",R),i?Ele(E,h,s):h()};g||(l?R():(_.current=1,E.className+=` ${x}`,E.addEventListener("animationend",R)))},[g]),Cr.createElement(Cr.Fragment,null,n)}}function h$(t,e){return{content:sY(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function sY(t,e,r=!1){return He.isValidElement(t)&&!Tg(t.type)?He.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):ef(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:r}):t}function _le({closeToast:t,theme:e,ariaLabel:r="close"}){return Cr.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:i=>{i.stopPropagation(),t(!0)},"aria-label":r},Cr.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Cr.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function Rle({delay:t,isRunning:e,closeToast:r,type:i="default",hide:s,className:n,controlledProgress:o,progress:l,rtl:h,isIn:d,theme:g}){let y=s||o&&l===0,C={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};o&&(C.transform=`scaleX(${l})`);let x=mg("Toastify__progress-bar",o?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${g}`,`Toastify__progress-bar--${i}`,{"Toastify__progress-bar--rtl":h}),_=ef(n)?n({rtl:h,type:i,defaultClassName:x}):mg(x,n),E={[o&&l>=1?"onTransitionEnd":"onAnimationEnd"]:o&&l<1?null:()=>{d&&r()}};return Cr.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":y},Cr.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${g} Toastify__progress-bar--${i}`}),Cr.createElement("div",{role:"progressbar","aria-hidden":y?"true":"false","aria-label":"notification timer",className:_,style:C,...E}))}var Ale=1,oY=()=>`${Ale++}`;function Ole(t,e,r){let i=1,s=0,n=[],o=[],l=e,h=new Map,d=new Set,g=F=>(d.add(F),()=>d.delete(F)),y=()=>{o=Array.from(h.values()),d.forEach(F=>F())},C=({containerId:F,toastId:H,updateId:z})=>{let q=F?F!==t:t!==1,re=h.has(H)&&z==null;return q||re},x=(F,H)=>{h.forEach(z=>{var q;(H==null||H===z.props.toastId)&&((q=z.toggle)==null||q.call(z,F))})},_=F=>{var H,z;(z=(H=F.props)==null?void 0:H.onClose)==null||z.call(H,F.removalReason),F.isActive=!1},E=F=>{if(F==null)h.forEach(_);else{let H=h.get(F);H&&_(H)}y()},R=()=>{s-=n.length,n=[]},I=F=>{var H,z;let{toastId:q,updateId:re}=F.props,Y=re==null;F.staleId&&h.delete(F.staleId),F.isActive=!0,h.set(q,F),y(),r(h$(F,Y?"added":"updated")),Y&&((z=(H=F.props).onOpen)==null||z.call(H))};return{id:t,props:l,observe:g,toggle:x,removeToast:E,toasts:h,clearQueue:R,buildToast:(F,H)=>{if(C(H))return;let{toastId:z,updateId:q,data:re,staleId:Y,delay:oe}=H,me=q==null;me&&s++;let de={...l,style:l.toastStyle,key:i++,...Object.fromEntries(Object.entries(H).filter(([Ie,Be])=>Be!=null)),toastId:z,updateId:q,data:re,isIn:!1,className:yP(H.className||l.toastClassName),progressClassName:yP(H.progressClassName||l.progressClassName),autoClose:H.isLoading?!1:xle(H.autoClose,l.autoClose),closeToast(Ie){h.get(z).removalReason=Ie,E(z)},deleteToast(){let Ie=h.get(z);if(Ie!=null){if(r(h$(Ie,"removed")),h.delete(z),s--,s<0&&(s=0),n.length>0){I(n.shift());return}y()}}};de.closeButton=l.closeButton,H.closeButton===!1||CP(H.closeButton)?de.closeButton=H.closeButton:H.closeButton===!0&&(de.closeButton=CP(l.closeButton)?l.closeButton:!0);let Re={content:F,props:de,staleId:Y};l.limit&&l.limit>0&&s>l.limit&&me?n.push(Re):kC(oe)?setTimeout(()=>{I(Re)},oe):I(Re)},setProps(F){l=F},setToggle:(F,H)=>{let z=h.get(F);z&&(z.toggle=H)},isToastActive:F=>{var H;return(H=h.get(F))==null?void 0:H.isActive},getSnapshot:()=>o}}var ia=new Map,Xy=[],SP=new Set,Ile=t=>SP.forEach(e=>e(t)),aY=()=>ia.size>0;function Ple(){Xy.forEach(t=>cY(t.content,t.options)),Xy=[]}var Fle=(t,{containerId:e})=>{var r;return(r=ia.get(e||1))==null?void 0:r.toasts.get(t)};function lY(t,e){var r;if(e)return!!((r=ia.get(e))!=null&&r.isToastActive(t));let i=!1;return ia.forEach(s=>{s.isToastActive(t)&&(i=!0)}),i}function Mle(t){if(!aY()){Xy=Xy.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||ble(t))ia.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=ia.get(t.containerId);e?e.removeToast(t.id):ia.forEach(r=>{r.removeToast(t.id)})}}var kle=(t={})=>{ia.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function cY(t,e){CP(t)&&(aY()||Xy.push({content:t,options:e}),ia.forEach(r=>{r.buildToast(t,e)}))}function Nle(t){var e;(e=ia.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function uY(t,e){ia.forEach(r=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===r.id)&&r.toggle(t,e==null?void 0:e.id)})}function Dle(t){let e=t.containerId||1;return{subscribe(r){let i=Ole(e,t,Ile);ia.set(e,i);let s=i.observe(r);return Ple(),()=>{s(),ia.delete(e)}},setProps(r){var i;(i=ia.get(e))==null||i.setProps(r)},getSnapshot(){var r;return(r=ia.get(e))==null?void 0:r.getSnapshot()}}}function Lle(t){return SP.add(t),()=>{SP.delete(t)}}function Hle(t){return t&&(Tg(t.toastId)||kC(t.toastId))?t.toastId:oY()}function NC(t,e){return cY(t,e),e.toastId}function g_(t,e){return{...e,type:e&&e.type||t,toastId:Hle(e)}}function m_(t){return(e,r)=>NC(e,g_(t,r))}function Vt(t,e){return NC(t,g_("default",e))}Vt.loading=(t,e)=>NC(t,g_("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function $le(t,{pending:e,error:r,success:i},s){let n;e&&(n=Tg(e)?Vt.loading(e,s):Vt.loading(e.render,{...s,...e}));let o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(d,g,y)=>{if(g==null){Vt.dismiss(n);return}let C={type:d,...o,...s,data:y},x=Tg(g)?{render:g}:g;return n?Vt.update(n,{...C,...x}):Vt(x.render,{...C,...x}),y},h=ef(t)?t():t;return h.then(d=>l("success",i,d)).catch(d=>l("error",r,d)),h}Vt.promise=$le;Vt.success=m_("success");Vt.info=m_("info");Vt.error=m_("error");Vt.warning=m_("warning");Vt.warn=Vt.warning;Vt.dark=(t,e)=>NC(t,g_("default",{theme:"dark",...e}));function Ble(t){Mle(t)}Vt.dismiss=Ble;Vt.clearWaitingQueue=kle;Vt.isActive=lY;Vt.update=(t,e={})=>{let r=Fle(t,e);if(r){let{props:i,content:s}=r,n={delay:100,...i,...e,toastId:e.toastId||t,updateId:oY()};n.toastId!==t&&(n.staleId=t);let o=n.render||s;delete n.render,NC(o,n)}};Vt.done=t=>{Vt.update(t,{progress:1})};Vt.onChange=Lle;Vt.play=t=>uY(!0,t);Vt.pause=t=>uY(!1,t);function Vle(t){var e;let{subscribe:r,getSnapshot:i,setProps:s}=He.useRef(Dle(t)).current;s(t);let n=(e=He.useSyncExternalStore(r,i,i))==null?void 0:e.slice();function o(l){if(!n)return[];let h=new Map;return t.newestOnTop&&n.reverse(),n.forEach(d=>{let{position:g}=d.props;h.has(g)||h.set(g,[]),h.get(g).push(d)}),Array.from(h,d=>l(d[0],d[1]))}return{getToastToRender:o,isToastActive:lY,count:n==null?void 0:n.length}}function Wle(t){let[e,r]=He.useState(!1),[i,s]=He.useState(!1),n=He.useRef(null),o=He.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:h,closeToast:d,onClick:g,closeOnClick:y}=t;Nle({id:t.toastId,containerId:t.containerId,fn:r}),He.useEffect(()=>{if(t.pauseOnFocusLoss)return C(),()=>{x()}},[t.pauseOnFocusLoss]);function C(){document.hasFocus()||I(),window.addEventListener("focus",R),window.addEventListener("blur",I)}function x(){window.removeEventListener("focus",R),window.removeEventListener("blur",I)}function _(Y){if(t.draggable===!0||t.draggable===Y.pointerType){F();let oe=n.current;o.canCloseOnClick=!0,o.canDrag=!0,oe.style.transition="none",t.draggableDirection==="x"?(o.start=Y.clientX,o.removalDistance=oe.offsetWidth*(t.draggablePercent/100)):(o.start=Y.clientY,o.removalDistance=oe.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function E(Y){let{top:oe,bottom:me,left:de,right:Re}=n.current.getBoundingClientRect();Y.nativeEvent.type!=="touchend"&&t.pauseOnHover&&Y.clientX>=de&&Y.clientX<=Re&&Y.clientY>=oe&&Y.clientY<=me?I():R()}function R(){r(!0)}function I(){r(!1)}function F(){o.didMove=!1,document.addEventListener("pointermove",z),document.addEventListener("pointerup",q)}function H(){document.removeEventListener("pointermove",z),document.removeEventListener("pointerup",q)}function z(Y){let oe=n.current;if(o.canDrag&&oe){o.didMove=!0,e&&I(),t.draggableDirection==="x"?o.delta=Y.clientX-o.start:o.delta=Y.clientY-o.start,o.start!==Y.clientX&&(o.canCloseOnClick=!1);let me=t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`;oe.style.transform=`translate3d(${me},0)`,oe.style.opacity=`${1-Math.abs(o.delta/o.removalDistance)}`}}function q(){H();let Y=n.current;if(o.canDrag&&o.didMove&&Y){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance){s(!0),t.closeToast(!0),t.collapseAll();return}Y.style.transition="transform 0.2s, opacity 0.2s",Y.style.removeProperty("transform"),Y.style.removeProperty("opacity")}}let re={onPointerDown:_,onPointerUp:E};return l&&h&&(re.onMouseEnter=I,t.stacked||(re.onMouseLeave=R)),y&&(re.onClick=Y=>{g&&g(Y),o.canCloseOnClick&&d(!0)}),{playToast:R,pauseToast:I,isRunning:e,preventExitTransition:i,toastRef:n,eventHandlers:re}}var jle=typeof window<"u"?He.useLayoutEffect:He.useEffect,p_=({theme:t,type:e,isLoading:r,...i})=>Cr.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...i});function Ule(t){return Cr.createElement(p_,{...t},Cr.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function zle(t){return Cr.createElement(p_,{...t},Cr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function Gle(t){return Cr.createElement(p_,{...t},Cr.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function Yle(t){return Cr.createElement(p_,{...t},Cr.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function Kle(){return Cr.createElement("div",{className:"Toastify__spinner"})}var bP={info:zle,warning:Ule,success:Gle,error:Yle,spinner:Kle},Xle=t=>t in bP;function qle({theme:t,type:e,isLoading:r,icon:i}){let s=null,n={theme:t,type:e};return i===!1||(ef(i)?s=i({...n,isLoading:r}):He.isValidElement(i)?s=He.cloneElement(i,n):r?s=bP.spinner():Xle(e)&&(s=bP[e](n))),s}var Jle=t=>{let{isRunning:e,preventExitTransition:r,toastRef:i,eventHandlers:s,playToast:n}=Wle(t),{closeButton:o,children:l,autoClose:h,onClick:d,type:g,hideProgressBar:y,closeToast:C,transition:x,position:_,className:E,style:R,progressClassName:I,updateId:F,role:H,progress:z,rtl:q,toastId:re,deleteToast:Y,isIn:oe,isLoading:me,closeOnClick:de,theme:Re,ariaLabel:Ie}=t,Be=mg("Toastify__toast",`Toastify__toast-theme--${Re}`,`Toastify__toast--${g}`,{"Toastify__toast--rtl":q},{"Toastify__toast--close-on-click":de}),lt=ef(E)?E({rtl:q,position:_,type:g,defaultClassName:Be}):mg(Be,E),pt=qle(t),Ct=!!z||!h,ct={closeToast:C,type:g,theme:Re},Ue=null;return o===!1||(ef(o)?Ue=o(ct):He.isValidElement(o)?Ue=He.cloneElement(o,ct):Ue=_le(ct)),Cr.createElement(x,{isIn:oe,done:Y,position:_,preventExitTransition:r,nodeRef:i,playToast:n},Cr.createElement("div",{id:re,tabIndex:0,onClick:d,"data-in":oe,className:lt,...s,style:R,ref:i,...oe&&{role:H,"aria-label":Ie}},pt!=null&&Cr.createElement("div",{className:mg("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!me})},pt),sY(l,t,!e),Ue,!t.customProgressBar&&Cr.createElement(Rle,{...F&&!Ct?{key:`p-${F}`}:{},rtl:q,theme:Re,delay:h,isRunning:e,isIn:oe,closeToast:C,hide:y,type:g,className:I,controlledProgress:Ct,progress:z||0})))},Qle=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),Zle=Tle(Qle("bounce",!0)),ece={position:"top-right",transition:Zle,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function hY(t){let e={...ece,...t},r=t.stacked,[i,s]=He.useState(!0),n=He.useRef(null),{getToastToRender:o,isToastActive:l,count:h}=Vle(e),{className:d,style:g,rtl:y,containerId:C,hotKeys:x}=e;function _(R){let I=mg("Toastify__toast-container",`Toastify__toast-container--${R}`,{"Toastify__toast-container--rtl":y});return ef(d)?d({position:R,rtl:y,defaultClassName:I}):mg(I,yP(d))}function E(){r&&(s(!0),Vt.play())}return jle(()=>{var R;if(r){let I=n.current.querySelectorAll('[data-in="true"]'),F=12,H=(R=e.position)==null?void 0:R.includes("top"),z=0,q=0;Array.from(I).reverse().forEach((re,Y)=>{let oe=re;oe.classList.add("Toastify__toast--stacked"),Y>0&&(oe.dataset.collapsed=`${i}`),oe.dataset.pos||(oe.dataset.pos=H?"top":"bot");let me=z*(i?.2:1)+(i?0:F*Y);oe.style.setProperty("--y",`${H?me:me*-1}px`),oe.style.setProperty("--g",`${F}`),oe.style.setProperty("--s",`${1-(i?q:0)}`),z+=oe.offsetHeight,q+=.025})}},[i,h,r]),He.useEffect(()=>{function R(I){var F;let H=n.current;x(I)&&((F=H.querySelector('[tabIndex="0"]'))==null||F.focus(),s(!1),Vt.pause()),I.key==="Escape"&&(document.activeElement===H||H!=null&&H.contains(document.activeElement))&&(s(!0),Vt.play())}return document.addEventListener("keydown",R),()=>{document.removeEventListener("keydown",R)}},[x]),Cr.createElement("section",{ref:n,className:"Toastify",id:C,onMouseEnter:()=>{r&&(s(!1),Vt.pause())},onMouseLeave:E,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},o((R,I)=>{let F=I.length?{...g}:{...g,pointerEvents:"none"};return Cr.createElement("div",{tabIndex:-1,className:_(R),"data-stacked":r,style:F,key:`c-${R}`},I.map(({content:H,props:z})=>Cr.createElement(Jle,{...z,stacked:r,collapseAll:E,isIn:l(z.toastId,z.containerId),key:`t-${z.key}`},H)))}))}var fY={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},f$=Cr.createContext&&Cr.createContext(fY),tce=["attr","size","title"];function rce(t,e){if(t==null)return{};var r=nce(t,e),i,s;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(r[i]=t[i])}return r}function nce(t,e){if(t==null)return{};var r={};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){if(e.indexOf(i)>=0)continue;r[i]=t[i]}return r}function IE(){return IE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},IE.apply(this,arguments)}function d$(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function PE(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?d$(Object(r),!0).forEach(function(i){ice(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d$(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function ice(t,e,r){return e=sce(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sce(t){var e=oce(t,"string");return typeof e=="symbol"?e:e+""}function oce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dY(t){return t&&t.map((e,r)=>Cr.createElement(e.tag,PE({key:r},e.attr),dY(e.child)))}function KM(t){return e=>Cr.createElement(ace,IE({attr:PE({},t.attr)},e),dY(t.child))}function ace(t){var e=r=>{var{attr:i,size:s,title:n}=t,o=rce(t,tce),l=s||r.size||"1em",h;return r.className&&(h=r.className),t.className&&(h=(h?h+" ":"")+t.className),Cr.createElement("svg",IE({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,o,{className:h,style:PE(PE({color:t.color||r.color},r.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),n&&Cr.createElement("title",null,n),t.children)};return f$!==void 0?Cr.createElement(f$.Consumer,null,r=>e(r)):e(fY)}function p4(t){return KM({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(t)}function lce(t){return KM({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M433.941 129.941l-83.882-83.882A48 48 0 0 0 316.118 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h352c26.51 0 48-21.49 48-48V163.882a48 48 0 0 0-14.059-33.941zM224 416c-35.346 0-64-28.654-64-64 0-35.346 28.654-64 64-64s64 28.654 64 64c0 35.346-28.654 64-64 64zm96-304.52V212c0 6.627-5.373 12-12 12H76c-6.627 0-12-5.373-12-12V108c0-6.627 5.373-12 12-12h228.52c3.183 0 6.235 1.264 8.485 3.515l3.48 3.48A11.996 11.996 0 0 1 320 111.48z"},child:[]}]})(t)}function gY(t){return KM({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"},child:[]}]})(t)}const cce=[{value:"Ci",label:"Ci"},{value:"Hp",label:"Hp"},{value:"Kg",label:"Kg"},{value:"Cp",label:"Cp"},{value:"Con",label:"Con"},{value:"Bch",label:"Bch"},{value:"Cun",label:"Cun"},{value:"H",label:"H"},{value:"B",label:"B"},{value:"Cy",label:"Cy"},{value:"Ti",label:"Ti"},{value:"H",label:"H"},{value:"Si",label:"Si"},{value:"Tm",label:"Tm"},{value:"M",label:"M"},{value:"Bng",label:"Bng"},{value:"Lt",label:"Lt"},{value:"Chai",label:"Chai"},{value:"Thng",label:"Thng"},{value:"Gi",label:"Gi"}],uce=()=>{const[t,e]=He.useState([]),[r,i]=He.useState(!1),[s,n]=He.useState(""),[o,l]=He.useState(!1),[h,d]=He.useState([]),[g,y]=He.useState({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]}),[C,x]=He.useState({_id:"",name:"",description:"",import_price:"",price:"",category:"",unit:"Ci",image:null,imagePreview:null}),[_,E]=He.useState(!1),[R,I]=He.useState(!1),[F,H]=He.useState(""),[z,q]=He.useState(null),[re,Y]=He.useState([]),[oe,me]=He.useState(!1),[de,Re]=He.useState([]),[Ie,Be]=He.useState(1),[lt]=He.useState(10),[pt,Ct]=He.useState(0),[ct,Ue]=He.useState(null),[Je,Fe]=He.useState(""),[A,O]=He.useState("duplicates"),[k,L]=He.useState([]),[D,K]=He.useState([]),[Q,pe]=He.useState(!1),[ye,j]=He.useState(""),[X,te]=He.useState(!1),[we,ce]=He.useState(0),_e=He.useRef(null);He.useEffect(()=>{(()=>{const ot=localStorage.getItem("userRole");console.log("=== User Role Check on Mount ==="),console.log("Current Role:",ot),console.log("============================"),n(ot||"")})(),Ee(),he()},[]);const Ee=async(Ve=Ie)=>{try{i(!0);const ot=localStorage.getItem("token"),It="https://backend-giahung.onrender.com/api/products",ar=ye?`${It}/search?q=${encodeURIComponent(ye)}&page=${Ve}&limit=${lt}`:`${It}?page=${Ve}&limit=${lt}`,Ur=await(await fetch(ar,{headers:{Authorization:`Bearer ${ot}`}})).json();Ur.status==="success"&&(e(Ur.data),K(Ur.data),Ct(Ur.total),ce(Ur.total))}catch(ot){console.error("Error fetching products:",ot),Vt.error("Khng th ti danh sch sn phm")}finally{i(!1),te(!1)}};He.useEffect(()=>{const Ve=setTimeout(()=>{Ee(1),Be(1)},300);return()=>clearTimeout(Ve)},[ye]),He.useEffect(()=>{X||Ee(Ie)},[Ie]);const he=async()=>{try{const Ve=localStorage.getItem("token"),It=await(await fetch("https://backend-giahung.onrender.com/api/categories",{headers:{Authorization:`Bearer ${Ve}`}})).json();It.status==="success"&&d(It.data)}catch(Ve){console.error("Error fetching categories:",Ve),Vt.error("Khng th ti danh mc")}},Ae=Ve=>{const{name:ot,value:It}=Ve.target;y(ar=>({...ar,[ot]:It}))},Ne=async Ve=>{Ve.preventDefault();try{console.log("=== Submitting Form ==="),console.log("Product Data:",g);const ot=new FormData;if(!g.name||!g.price){Vt.error("Vui lng in y  tn sn phm v gi bn");return}ot.append("name",g.name),ot.append("price",g.price),g.import_price&&ot.append("import_price",g.import_price),g.description&&ot.append("description",g.description),g.category&&ot.append("category",g.category),g.image instanceof File&&(ot.append("image",g.image),console.log("=== Image File Info ==="),console.log("File name:",g.image.name),console.log("File size:",g.image.size),console.log("File type:",g.image.type)),console.log("=== FormData Contents ===");for(let Ur of ot.entries())console.log(Ur[0]+":",Ur[1]);const It=localStorage.getItem("token"),ar=await fetch("https://backend-giahung.onrender.com/api/products",{method:"POST",headers:{Authorization:`Bearer ${It}`},body:ot});if(console.log("=== Response Status ==="),console.log("Status:",ar.status),!ar.ok){const Ur=await ar.json();throw new Error(Ur.message||"C li xy ra khi thm sn phm")}const Oi=await ar.json();if(Oi.status==="success")Vt.success("Thm sn phm thnh cng"),l(!1),Ue(null),Fe(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]}),Ee();else throw new Error(Oi.message||"Li khi thm sn phm")}catch(ot){console.error("Error:",ot),Vt.error(ot.message||"Khng th thm sn phm")}},Le=async Ve=>{if(window.confirm("Bn c chc chn mun xa sn phm ny?"))try{const ot=localStorage.getItem("token"),It=await fetch(`https://backend-giahung.onrender.com/api/products/${Ve}`,{method:"DELETE",headers:{Authorization:`Bearer ${ot}`,"Content-Type":"application/json"}});if(It.ok)Vt.success("Xa sn phm thnh cng"),Ee();else{const ar=await It.json();throw new Error(ar.message||"Khng th xa sn phm")}}catch(ot){console.error("Error deleting product:",ot),Vt.error(ot.message||"C li xy ra khi xa sn phm")}},Xe=Ve=>{var ot,It,ar;x({_id:Ve._id,name:Ve.name,description:Ve.description||"",import_price:Ve.import_price||"",price:Ve.price||"",category:((ot=Ve.category)==null?void 0:ot._id)||"",unit:Ve.unit||"Ci",image:Ve.image||null,imagePreview:((It=Ve.image)==null?void 0:It.url)||null}),Fe((ar=Ve.image)!=null&&ar.url?"Current image":""),E(!0)},Ft=async Ve=>{Ve.preventDefault();try{const ot=new FormData;ot.append("name",C.name||""),ot.append("price",C.price||""),ot.append("import_price",C.import_price||""),ot.append("description",C.description||""),ot.append("category",C.category||""),ot.append("unit",C.unit),ot.append("image",C.image||""),console.log("Sending update with unit:",C.unit);const It=document.querySelector('input[type="file"]').files[0];It&&ot.append("image",It),console.log("=== Update Data ===");for(let Bo of ot.entries())console.log(Bo[0]+": "+Bo[1]);const ar=localStorage.getItem("token"),Oi=await fetch(`https://backend-giahung.onrender.com/api/products/${C._id}`,{method:"PUT",headers:{Authorization:`Bearer ${ar}`},body:ot});if(!Oi.ok)throw new Error("Li khi cp nht sn phm");const Ur=await Oi.json();if(Ur.status==="success")Vt.success("Cp nht sn phm thnh cng"),E(!1),Ee();else throw new Error(Ur.message||"Li khi cp nht sn phm")}catch(ot){console.error("Update Error:",ot),Vt.error("Khng th cp nht sn phm: "+ot.message)}},St=async()=>{if(de.length)try{pe(!0);const Ve=localStorage.getItem("token"),It=await(await fetch("https://backend-giahung.onrender.com/api/products/bulk",{method:"POST",headers:{Authorization:`Bearer ${Ve}`,"Content-Type":"application/json"},body:JSON.stringify({products:de})})).json();if(It.status==="success")Vt.success(` import ${de.length} sn phm thnh cng`),I(!1),q(null),Re([]),Y([]),Ee();else throw new Error(It.message||"Li khi import sn phm")}catch(Ve){console.error("Import Error:",Ve),Vt.error("Khng th import sn phm: "+Ve.message)}finally{pe(!1)}},zt=async()=>{try{const Ve=localStorage.getItem("token"),ot=await fetch("https://backend-giahung.onrender.com/api/products?limit=9999",{headers:{Authorization:`Bearer ${Ve}`}});if(!ot.ok)throw new Error("Khng th xut d liu");const It=await ot.json();if(It.status==="success"){const ar=It.data,Oi=JSON.stringify(ar,null,2),Ur=new Blob([Oi],{type:"application/json"}),Bo=window.URL.createObjectURL(Ur),Zt=document.createElement("a");Zt.href=Bo,Zt.download=`products_export_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(Zt),Zt.click(),window.URL.revokeObjectURL(Bo),document.body.removeChild(Zt),Vt.success(` xut ${ar.length} sn phm thnh cng`),I(!1)}else throw new Error(It.message||"Li khi xut d liu")}catch(Ve){console.error("Export Error:",Ve),Vt.error("Khng th xut d liu: "+Ve.message)}},kr=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-5xl w-full",children:[V.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Kim tra sn phm import"}),V.jsxs("div",{className:"flex border-b mb-4",children:[V.jsxs("button",{className:`py-2 px-4 mr-2 ${A==="duplicates"?"border-b-2 border-blue-500 text-blue-600 font-medium":"text-gray-500 hover:text-gray-700"}`,onClick:()=>O("duplicates"),children:["Sn phm trng lp (",re.length,")"]}),V.jsxs("button",{className:`py-2 px-4 ${A==="new"?"border-b-2 border-blue-500 text-blue-600 font-medium":"text-gray-500 hover:text-gray-700"}`,onClick:()=>O("new"),children:["Sn phm mi (",de.length,")"]})]}),V.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"n v"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A==="duplicates"?re.map((Ve,ot)=>{var It,ar;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ve.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(It=Ve.import_price)==null?void 0:It.toLocaleString("vi-VN")," "]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(ar=Ve.price)==null?void 0:ar.toLocaleString("vi-VN")," "]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ve.unit||"Ci"})]},ot)}):de.map((Ve,ot)=>{var It,ar;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ve.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(It=Ve.import_price)==null?void 0:It.toLocaleString("vi-VN")," "]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[(ar=Ve.price)==null?void 0:ar.toLocaleString("vi-VN")," "]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Ve.unit||"Ci"})]},ot)})})]})}),V.jsxs("div",{className:"mt-4 flex justify-end space-x-4",children:[V.jsx("button",{onClick:()=>me(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 border rounded",children:"Hy"}),V.jsxs("button",{onClick:()=>importProducts(de),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:["Import ",de.length," sn phm mi"]})]})]})}),xr=Ve=>{Ve<1||Ve>Math.ceil(pt/lt)||(Be(Ve),console.log("=== Page Change ==="),console.log("Current Page:",Ve),console.log("Total Products:",pt),console.log("Products Per Page:",lt))},ir=()=>{const Ve=Math.ceil(we/lt),ot=()=>{let It=[];if(Ve<=7)for(let ar=1;ar<=Ve;ar++)It.push(ar);else{It.push(1),Ie>3&&It.push("...");let ar=Math.max(2,Ie-1),Oi=Math.min(Ie+1,Ve-1);for(let Ur=ar;Ur<=Oi;Ur++)It.push(Ur);Ie<Ve-2&&It.push("..."),Ve>1&&It.push(Ve)}return It};return V.jsxs("div",{className:"flex justify-between items-center mt-4 pb-4",children:[V.jsxs("div",{className:"text-sm text-gray-700",children:["Hin th ",Math.min((Ie-1)*lt+1,pt)," n"," ",Math.min(Ie*lt,pt)," trong s"," ",pt," sn phm"]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("button",{onClick:()=>xr(Ie-1),disabled:Ie===1,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Trc"}),ot().map((It,ar)=>V.jsx("button",{onClick:()=>{It!=="..."&&xr(It)},disabled:It==="...",className:`px-3 py-1 border rounded-md ${It===Ie?"bg-blue-500 text-white":It==="..."?"cursor-default":"hover:bg-gray-100"}`,children:It},ar)),V.jsx("button",{onClick:()=>xr(Ie+1),disabled:Ie===Ve,className:"px-3 py-1 border rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:"Sau"})]})]})};He.useEffect(()=>()=>{C.imagePreview&&C.imagePreview.startsWith("blob:")&&URL.revokeObjectURL(C.imagePreview)},[C.imagePreview]);const hr=Ve=>{const ot=Ve.target.files[0];if(ot){const It=new FileReader;It.onloadend=()=>{x(ar=>({...ar,image:ot,imagePreview:It.result}))},It.readAsDataURL(ot),Fe(ot.name)}},Hn=()=>{x(Ve=>({...Ve,image:null,imagePreview:null})),Fe("")},xi=()=>{var Ve;return V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[V.jsx("h3",{className:"text-xl font-semibold mb-4 sticky top-0 bg-white pb-2",children:"Chnh sa sn phm"}),V.jsxs("form",{onSubmit:Ft,encType:"multipart/form-data",children:[V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn sn phm"}),V.jsx("input",{type:"text",name:"name",value:C.name||"",onChange:ot=>{const It=ot.target.value;x(ar=>({...ar,name:It}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:C.description||"",onChange:ot=>{const It=ot.target.value;x(ar=>({...ar,description:It}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",rows:"3"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"n v"}),V.jsx("select",{name:"unit",value:C.unit||"Ci",onChange:ot=>{const It=ot.target.value;x(ar=>({...ar,unit:It}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:cce.map(ot=>V.jsx("option",{value:ot.value,children:ot.label},ot.value))})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gi nhp"}),V.jsx("input",{type:"number",name:"import_price",value:C.import_price||"",onChange:ot=>{const It=ot.target.value;x(ar=>({...ar,import_price:It}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gi bn"}),V.jsx("input",{type:"number",name:"price",value:C.price||"",onChange:ot=>{const It=ot.target.value;x(ar=>({...ar,price:It}))},className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hnh nh sn phm"}),V.jsxs("div",{className:"mt-1 flex items-center",children:[V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"file",onChange:hr,className:"hidden",id:"edit-image-upload",accept:"image/*"}),V.jsx("label",{htmlFor:"edit-image-upload",className:"cursor-pointer bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:"Chn hnh nh"})]}),Je&&V.jsx("span",{className:"ml-3 text-sm text-gray-500",children:Je})]}),(C.imagePreview||((Ve=C.image)==null?void 0:Ve.url))&&V.jsxs("div",{className:"mt-2 relative",children:[V.jsx("img",{src:C.imagePreview||C.image.url,alt:"Preview",className:"max-h-64 w-auto object-contain rounded-md"}),V.jsx("button",{type:"button",onClick:Hn,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),V.jsxs("div",{className:"mt-6 flex justify-end sticky bottom-0 bg-white pt-2",children:[V.jsx("button",{type:"button",onClick:()=>E(!1),className:"mr-2 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-md",children:"Lu thay i"})]})]})]})})},qs=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:V.jsxs("div",{className:"bg-white rounded-lg w-full max-w-md max-h-[90vh] overflow-y-auto",children:[V.jsx("div",{className:"sticky top-0 bg-white px-6 py-4 border-b",children:V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("h3",{className:"text-xl font-semibold",children:"Thm sn phm mi"}),V.jsx("button",{type:"button",onClick:()=>{l(!1),Ue(null),Fe(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]})},className:"text-gray-400 hover:text-gray-500",children:V.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),V.jsx("div",{className:"px-6 py-4",children:V.jsxs("form",{onSubmit:Ne,encType:"multipart/form-data",className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tn sn phm *"}),V.jsx("input",{type:"text",name:"name",value:g.name,onChange:Ae,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi nhp"}),V.jsx("input",{type:"number",name:"import_price",value:g.import_price,onChange:Ae,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gi bn *"}),V.jsx("input",{type:"number",name:"price",value:g.price,onChange:Ae,required:!0,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"M t"}),V.jsx("textarea",{name:"description",value:g.description,onChange:Ae,rows:"3",className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Danh mc"}),V.jsxs("select",{name:"category",value:g.category,onChange:Ae,className:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",children:[V.jsx("option",{value:"",children:"Chn danh mc"}),h.map(Ve=>V.jsx("option",{value:Ve._id,children:Ve.name},Ve._id))]})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Hnh nh"}),V.jsxs("div",{className:"flex flex-col space-y-2",children:[V.jsx("input",{type:"file",accept:"image/*",onChange:Ve=>{const ot=Ve.target.files[0];if(ot){if(ot.size>5*1024*1024){Vt.error("Kch thc file khng c vt qu 5MB"),Ve.target.value="",Ue(null),Fe("");return}Fe(ot.name);const It=new FileReader;It.onloadend=()=>{Ue(It.result)},It.readAsDataURL(ot),y(ar=>({...ar,image:ot}))}},className:"w-full"}),Je&&V.jsxs("div",{className:"text-sm text-gray-600",children:["File  chn: ",Je]}),ct&&V.jsxs("div",{className:"relative inline-block",children:[V.jsx("img",{src:ct,alt:"Preview",className:"h-32 w-32 object-cover rounded-lg border"}),V.jsx("button",{type:"button",onClick:()=>{Ue(null),Fe(""),y(ot=>({...ot,image:null}));const Ve=document.querySelector('input[type="file"]');Ve&&(Ve.value="")},className:"absolute top-0 right-0 -mt-2 -mr-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:V.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:V.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]}),V.jsx("div",{className:"sticky bottom-0 bg-white pt-4 pb-4 border-t mt-4",children:V.jsxs("div",{className:"flex justify-end space-x-2",children:[V.jsx("button",{type:"button",onClick:()=>{l(!1),Ue(null),Fe(""),y({name:"",import_price:"",price:"",description:"",category:"",image:null,date:new Date().toISOString().split("T")[0]})},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Thm sn phm"})]})})]})})]})}),oi=Ve=>{L(ot=>ot.includes(Ve)?ot.filter(It=>It!==Ve):[...ot,Ve])},Jn=Ve=>{Ve.target.checked?L(t.map(ot=>ot._id)):L([])},$n=async()=>{if(window.confirm(`Bn c chc chn mun xa ${k.length} sn phm  chn?`))try{const Ve=localStorage.getItem("token"),ot=k.map(It=>fetch(`https://backend-giahung.onrender.com/api/products/${It}`,{method:"DELETE",headers:{Authorization:`Bearer ${Ve}`,"Content-Type":"application/json"}}));await Promise.all(ot),Vt.success(` xa ${k.length} sn phm`),L([]),Ee()}catch(Ve){console.error("Error deleting products:",Ve),Vt.error("C li xy ra khi xa sn phm")}},Lr=()=>F==="export"?V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-md",children:[V.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Export JSON"}),V.jsx("div",{className:"mb-6",children:V.jsxs("p",{className:"text-gray-600",children:["Bn c mun xut ",pt," sn phm ra file JSON khng?"]})}),V.jsxs("div",{className:"flex justify-end space-x-3",children:[V.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",children:"Hy"}),V.jsx("button",{onClick:()=>{zt(),I(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Xut file"})]})]})}):V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-4xl",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold",children:"Import JSON"}),V.jsx("button",{onClick:()=>I(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),z?V.jsxs("div",{className:"max-h-[80vh] flex flex-col",children:[V.jsx("div",{className:"border-b border-gray-200",children:V.jsxs("nav",{className:"flex space-x-4","aria-label":"Tabs",children:[V.jsxs("button",{onClick:()=>O("new"),className:`px-3 py-2 text-sm font-medium ${A==="new"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Sn phm mi (",de.length,")"]}),V.jsxs("button",{onClick:()=>O("duplicates"),className:`px-3 py-2 text-sm font-medium ${A==="duplicates"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:["Sn phm trng (",re.length,")"]})]})}),V.jsx("div",{className:"flex-1 overflow-hidden",children:V.jsx("div",{className:"overflow-y-auto h-full",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider bg-gray-50",children:"n v"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(A==="new"?de:re).map((Ve,ot)=>{var It,ar;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ve.name}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(It=Ve.import_price)==null?void 0:It.toLocaleString("vi-VN")," VN"]}),V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[(ar=Ve.price)==null?void 0:ar.toLocaleString("vi-VN")," VN"]}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:Ve.unit})]},ot)})})]})})}),V.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 bg-white",children:V.jsxs("div",{className:"flex justify-between items-center",children:[V.jsx("div",{className:"text-sm text-gray-500",children:A==="new"?`${de.length} sn phm mi`:`${re.length} sn phm trng`}),V.jsxs("div",{className:"flex space-x-3",children:[V.jsx("button",{onClick:()=>{q(null),Re([]),Y([])},className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:Q,children:"Hy"}),V.jsx("button",{onClick:St,disabled:de.length===0||Q,className:`px-4 py-2 rounded-lg ${Q?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white flex items-center space-x-2`,children:Q?V.jsxs(V.Fragment,{children:[V.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[V.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),V.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),V.jsx("span",{children:"ang import..."})]}):V.jsxs("span",{children:["Import ",de.length," sn phm"]})})]})]})})]}):V.jsxs("div",{className:"text-center py-12",children:[V.jsx("input",{type:"file",accept:".json",onChange:Ve=>{const ot=Ve.target.files[0];ot&&Nr(ot)},className:"hidden",id:"jsonFileInput"}),V.jsxs("label",{htmlFor:"jsonFileInput",className:"px-6 py-4 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 inline-block",children:[V.jsx("div",{className:"text-gray-600",children:"Click  chn file JSON"}),V.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"hoc ko th file vo y"})]})]})]})}),Nr=async Ve=>{try{const ot=await Ve.text(),It=JSON.parse(ot),ar=[],Oi=[];for(const Ur of It)t.some(Zt=>Zt.name.toLowerCase()===Ur.name.toLowerCase())?ar.push(Ur):Oi.push(Ur);q(Ve),Re(Oi),Y(ar),O("new")}catch(ot){console.error("Error reading file:",ot),Vt.error("File JSON khng hp l")}};return V.jsxs("div",{className:"container mx-auto px-4 py-8",children:[V.jsxs("div",{className:"flex justify-between items-center mb-6 gap-4 flex-wrap",children:[V.jsx("div",{children:V.jsxs("h1",{className:"text-2xl font-bold",children:["Danh sch sn phm (",we,")"]})}),V.jsxs("div",{className:"flex items-center gap-4 justify-end flex-grow",children:[V.jsx("div",{className:"relative w-full",ref:_e,children:V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"text",placeholder:"Tm kim sn phm...",value:ye,onChange:Ve=>j(Ve.target.value),className:"w-full px-4 py-2 pl-10 pr-4 text-sm text-gray-700 bg-white border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-200"}),V.jsx(gY,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})}),s==="admin"&&V.jsxs(V.Fragment,{children:[V.jsx("button",{onClick:()=>{H("import"),I(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Import JSON"}),V.jsx("button",{onClick:()=>{H("export"),I(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Export JSON"}),V.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Thm sn phm"})]})]})]}),k.length>0&&s==="admin"&&V.jsx("div",{className:"mb-4",children:V.jsxs("button",{onClick:$n,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:["Xa (",k.length,")"]})}),r?V.jsxs("div",{className:"text-center py-8",children:[V.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),V.jsx("div",{className:"mt-4 text-gray-600",children:"ang ti..."})]}):D.length===0?V.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:V.jsx("div",{className:"text-gray-500 text-lg",children:ye?V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"mb-2",children:""}),V.jsxs("div",{children:['Khng tm thy sn phm no cho "',ye,'"']})]}):V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"mb-2",children:""}),V.jsx("div",{children:"Cha c sn phm no"})]})})}):V.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[V.jsx("thead",{className:"bg-gray-50",children:V.jsxs("tr",{children:[s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-10",children:V.jsx("input",{type:"checkbox",onChange:Jn,checked:k.length===D.length&&D.length>0,className:"rounded border-gray-300"})}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hnh nh"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn sn phm"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M t"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi nhp"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gi bn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"n v"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Danh mc"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(Ve=>{var ot,It,ar,Oi;return V.jsxs("tr",{className:"hover:bg-gray-50",children:[s==="admin"&&V.jsx("td",{className:"px-6 py-4 whitespace-nowrap w-10",children:V.jsx("input",{type:"checkbox",checked:k.includes(Ve._id),onChange:()=>oi(Ve._id),className:"rounded border-gray-300"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:(ot=Ve.image)!=null&&ot.url?V.jsx("img",{src:Ve.image.url,alt:Ve.name,className:"h-16 w-16 object-cover rounded-lg"}):V.jsx("div",{className:"h-16 w-16 bg-gray-100 flex items-center justify-center rounded-lg",children:V.jsx("span",{className:"text-gray-400",children:"No image"})})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:Ve.name})}),V.jsx("td",{className:"px-6 py-4",children:V.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:Ve.description||"Khng c m t"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsxs("div",{className:"text-sm text-gray-900",children:[(It=Ve.import_price)==null?void 0:It.toLocaleString("vi-VN")," VN"]})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsxs("div",{className:"text-sm text-gray-900",children:[(ar=Ve.price)==null?void 0:ar.toLocaleString("vi-VN")," VN"]})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:Ve.unit})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:((Oi=Ve.category)==null?void 0:Oi.name)||"Cha phn loi"})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[V.jsx("button",{onClick:()=>Xe(Ve),className:"text-indigo-600 hover:text-indigo-900 mr-4",children:"Sa"}),V.jsx("button",{onClick:()=>Le(Ve._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},Ve._id)})})]})})}),!r&&D.length>0&&V.jsx(ir,{}),R&&V.jsx(Lr,{}),o&&V.jsx(qs,{}),_&&V.jsx(xi,{}),oe&&V.jsx(kr,{})]})},hce=()=>{const[t,e]=He.useState([]),[r,i]=He.useState(!1),[s,n]=He.useState(""),[o,l]=He.useState(!1),[h,d]=He.useState({name:"",description:""}),[g,y]=He.useState(null),[C,x]=He.useState(!1);He.useEffect(()=>{const z=localStorage.getItem("userRole");n(z||""),_()},[]);const _=async()=>{try{i(!0);const z=localStorage.getItem("token"),re=await(await fetch("https://backend-giahung.onrender.com/api/categories",{headers:{Authorization:`Bearer ${z}`,"Content-Type":"application/json"}})).json();re.status==="success"&&e(re.data)}catch(z){console.error("Error fetching categories:",z),Vt.error("Khng th ti danh sch danh mc")}finally{i(!1)}},E=z=>{const{name:q,value:re}=z.target;d(Y=>({...Y,[q]:re}))},R=async z=>{z.preventDefault();try{i(!0);const q=localStorage.getItem("token"),re=await fetch("https://backend-giahung.onrender.com/api/categories",{method:"POST",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"},body:JSON.stringify(h)}),Y=await re.json();if(re.ok)Vt.success("Thm danh mc thnh cng"),l(!1),d({name:"",description:""}),_();else throw new Error(Y.message||"C li xy ra khi thm danh mc")}catch(q){Vt.error(q.message||"Khng th thm danh mc")}finally{i(!1)}},I=async z=>{if(window.confirm("Bn c chc chn mun xa danh mc ny?"))try{const q=localStorage.getItem("token"),re=await fetch(`https://backend-giahung.onrender.com/api/categories/${z}`,{method:"DELETE",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}});if(re.ok)Vt.success("Xa danh mc thnh cng"),_();else{const Y=await re.json();throw new Error(Y.message||"Khng th xa danh mc")}}catch(q){console.error("Error deleting category:",q),Vt.error(q.message||"C li xy ra khi xa danh mc")}},F=z=>{y(z),x(!0)},H=async z=>{z.preventDefault();try{i(!0);const q=localStorage.getItem("token"),re=await fetch(`https://backend-giahung.onrender.com/api/categories/${g._id}`,{method:"PUT",headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"},body:JSON.stringify(g)}),Y=await re.json();if(re.ok)Vt.success("Cp nht danh mc thnh cng"),x(!1),y(null),_();else throw new Error(Y.message||"C li xy ra khi cp nht danh mc")}catch(q){Vt.error(q.message||"Khng th cp nht danh mc")}finally{i(!1)}};return V.jsxs("div",{children:[V.jsxs("div",{className:"flex justify-between items-center mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold",children:"Danh sch danh mc"}),s==="admin"&&V.jsx("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Thm danh mc"})]}),o&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Thm danh mc mi"}),V.jsxs("form",{onSubmit:R,className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn danh mc"}),V.jsx("input",{type:"text",name:"name",value:h.name,onChange:E,className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:h.description,onChange:E,rows:"4",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200 resize-none"})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[V.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:r,children:r?"ang x l...":"Thm danh mc"})]})]})]})}),C&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sa danh mc"}),V.jsxs("form",{onSubmit:H,className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tn danh mc"}),V.jsx("input",{type:"text",name:"name",value:g==null?void 0:g.name,onChange:z=>y(q=>({...q,name:z.target.value})),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"M t"}),V.jsx("textarea",{name:"description",value:g==null?void 0:g.description,onChange:z=>y(q=>({...q,description:z.target.value})),rows:"4",className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200 resize-none"})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[V.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",disabled:r,children:r?"ang x l...":"Cp nht danh mc"})]})]})]})}),r?V.jsx("div",{className:"text-center py-4",children:"ang ti..."}):t.length===0?V.jsx("div",{className:"text-center py-8",children:V.jsx("div",{className:"text-gray-500 text-lg",children:"Cha c danh mc no"})}):V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[V.jsx("thead",{className:"bg-gray-100",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ID"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tn danh mc"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"M t"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngy to"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(z=>V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:z._id})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.name})}),V.jsx("td",{className:"px-6 py-4",children:V.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:z.description||"Khng c m t"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-500",children:new Date(z.createdAt).toLocaleDateString("vi-VN")})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[V.jsx("button",{className:"text-blue-600 hover:text-blue-900 mr-3",onClick:()=>F(z),children:"Sa"}),V.jsx("button",{onClick:()=>I(z._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},z._id))})]})})]})},fce=()=>{const[t,e]=He.useState([]),[r,i]=He.useState(!1),[s,n]=He.useState(""),[o,l]=He.useState(null),[h,d]=He.useState(!1);He.useEffect(()=>{(()=>{const E=localStorage.getItem("token"),R=localStorage.getItem("userRole");return console.log("=== Auth Check ==="),console.log("Token:",E?"Present":"Missing"),console.log("Token value:",E),console.log("User Role:",R),console.log("================"),E?(n(R||""),!0):(Vt.error("Bn cn ng nhp  xem ni dung ny"),!1)})()&&g()},[]);const g=async()=>{try{i(!0);const _=localStorage.getItem("token");console.log("=== Fetch Customers Request ==="),console.log("Using token:",_);const E=await fetch("https://backend-giahung.onrender.com/api/users",{headers:{Authorization:`Bearer ${_}`,"Content-Type":"application/json"}});console.log("Response status:",E.status);const R=await E.json();if(console.log("Response data:",R),console.log("==========================="),E.ok)e(Array.isArray(R)?R:[]);else throw new Error(R.message||"Failed to fetch customers")}catch(_){console.error("Error details:",_),Vt.error("Khng th ti danh sch ngi dng")}finally{i(!1)}},y=async _=>{try{const E=localStorage.getItem("token"),R=await fetch(`https://backend-giahung.onrender.com/api/users/${_}`,{method:"DELETE",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"}});if(R.ok)Vt.success("Xa ti khon thnh cng"),s==="admin"?fetchAllUsers():(localStorage.removeItem("token"),localStorage.removeItem("userRole"),window.location.href="/login");else{const I=await R.json();throw new Error(I.message)}}catch(E){Vt.error(E.message||"Khng th xa ti khon")}},C=_=>{l(_),d(!0)},x=async _=>{_.preventDefault();try{const E=localStorage.getItem("token"),R=s==="admin"?editUser._id:"me",I=await fetch(`https://backend-giahung.onrender.com/api/users/${R}`,{method:"PUT",headers:{Authorization:`Bearer ${E}`,"Content-Type":"application/json"},body:JSON.stringify({name:editUser.name,email:editUser.email})});if(I.ok)Vt.success("Cp nht thng tin thnh cng"),d(!1),s==="admin"?fetchAllUsers():fetchCurrentUser();else{const F=await I.json();throw new Error(F.message)}}catch(E){Vt.error(E.message||"Khng th cp nht thng tin")}};return V.jsxs("div",{children:[V.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Danh sch ngi dng"}),r?V.jsx("div",{className:"text-center py-4",children:"ang ti..."}):t.length===0?V.jsx("div",{className:"text-center py-8",children:V.jsx("div",{className:"text-gray-500 text-lg",children:"Cha c ngi dng no"})}):V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden",children:[V.jsx("thead",{className:"bg-gray-100",children:V.jsxs("tr",{children:[V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"H tn"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"S in thoi"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vai tr"}),V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ngy to"}),s==="admin"&&V.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Thao tc"})]})}),V.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(_=>V.jsxs("tr",{className:"hover:bg-gray-50",children:[V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm font-medium text-gray-900",children:_.name})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:_.email})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-900",children:_.phone||"Cha cp nht"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${_.role==="admin"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:_.role==="admin"?"Admin":"Khch hng"})}),V.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:V.jsx("div",{className:"text-sm text-gray-500",children:new Date(_.createdAt).toLocaleDateString("vi-VN")})}),s==="admin"&&V.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[V.jsx("button",{onClick:()=>C(_),className:"text-blue-600 hover:text-blue-900 mr-3",children:"Sa"}),V.jsx("button",{onClick:()=>y(_._id),className:"text-red-600 hover:text-red-900",children:"Xa"})]})]},_._id))})]})}),h&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white p-8 rounded-lg w-full max-w-md",children:[V.jsx("h2",{className:"text-xl font-semibold mb-6",children:"Chnh sa thng tin ngi dng"}),V.jsxs("form",{onSubmit:x,className:"space-y-6",children:[V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"H tn"}),V.jsx("input",{type:"text",value:(o==null?void 0:o.name)||"",onChange:_=>l({...o,name:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),V.jsx("input",{type:"email",value:(o==null?void 0:o.email)||"",onChange:_=>l({...o,email:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",required:!0})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"S in thoi"}),V.jsx("input",{type:"tel",value:(o==null?void 0:o.phone)||"",onChange:_=>l({...o,phone:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200"})]}),V.jsxs("div",{children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vai tr"}),V.jsxs("select",{value:(o==null?void 0:o.role)||"",onChange:_=>l({...o,role:_.target.value}),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-md focus:border-blue-500 focus:ring-2 focus:ring-blue-200",children:[V.jsx("option",{value:"user",children:"Khch hng"}),V.jsx("option",{value:"admin",children:"Admin"})]})]}),V.jsxs("div",{className:"flex justify-end space-x-4 mt-8",children:[V.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Hy"}),V.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:r?"ang x l...":"Cp nht"})]})]})]})})]})},dce=({onSearch:t})=>{const[e,r]=He.useState(""),[i,s]=He.useState([]),[n,o]=He.useState(!1),[l,h]=He.useState(!1),[d,g]=He.useState(null),[y,C]=He.useState(!1),x=He.useRef(null),[_,E]=He.useState("");He.useEffect(()=>{const H=z=>{x.current&&!x.current.contains(z.target)&&h(!1)};return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[]),He.useEffect(()=>{const H=localStorage.getItem("userRole");console.log("Current user role:",H),E(H||"")},[]);const R=async H=>{if(!H.trim()){s([]);return}try{o(!0);const q=await(await fetch(`https://backend-giahung.onrender.com/api/products/search?q=${encodeURIComponent(H)}`)).json();q.status==="success"&&s(q.data||[])}catch(z){console.error("Error fetching suggestions:",z)}finally{o(!1)}};He.useEffect(()=>{const H=setTimeout(()=>{e&&R(e)},300);return()=>clearTimeout(H)},[e]);const I=H=>{r(H.name),h(!1),g(H),C(!0),t(H)},F=H=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(H);return console.log("User role in render:",_),console.log("Selected product:",d),V.jsxs("div",{className:"relative w-full",ref:x,children:[V.jsxs("div",{className:"relative",children:[V.jsx("input",{type:"text",placeholder:"Tm kim...",value:e,onChange:H=>{r(H.target.value),h(!0)},onFocus:()=>h(!0),className:"w-full px-3 py-1.5 pl-8 pr-3 text-sm text-gray-700 bg-white border border-gray-300 rounded-md focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-200"}),V.jsx(gY,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 text-gray-400 w-3 h-3"})]}),l&&e&&V.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto",children:n?V.jsx("div",{className:"p-2 text-center text-gray-500",children:V.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})}):i.length>0?V.jsx("ul",{className:"py-1",children:i.map(H=>V.jsx("li",{className:"px-3 py-1.5 hover:bg-gray-50 cursor-pointer text-sm",onClick:()=>I(H),children:V.jsxs("div",{className:"flex items-center space-x-2",children:[H.image?V.jsx("img",{src:H.image,alt:H.name,className:"w-8 h-8 object-cover rounded",onError:z=>{z.target.onerror=null,z.target.src="/placeholder.png"}}):V.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-500",children:"No IMG"}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsx("div",{className:"font-medium text-gray-900 truncate",children:H.name}),V.jsx("div",{className:"text-xs text-gray-500",children:F(H.price)})]})]})},H._id))}):V.jsx("div",{className:"p-2 text-center text-sm text-gray-500",children:"Khng tm thy sn phm"})}),y&&d&&V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",children:[V.jsxs("div",{className:"flex justify-between items-start mb-4",children:[V.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Chi tit sn phm"}),V.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-500",children:V.jsx("span",{className:"text-2xl",children:""})})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[V.jsx("div",{className:"aspect-w-1 aspect-h-1",children:d.image?V.jsx("img",{src:d.image,alt:d.name,className:"w-full h-full object-cover rounded-lg"}):V.jsx("div",{className:"w-full h-full bg-gray-100 rounded-lg flex items-center justify-center",children:V.jsx("span",{className:"text-gray-500",children:"Khng c hnh nh"})})}),V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("h4",{className:"text-lg font-medium text-gray-900",children:d.name}),V.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-2",children:F(d.price)})]}),V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"M t"}),V.jsx("p",{className:"mt-1 text-gray-600",children:d.description||"Khng c m t"})]}),V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"Danh mc"}),V.jsx("p",{className:"mt-1 text-gray-600",children:d.category||"Cha phn loi"})]}),_==="admin"&&V.jsxs("div",{children:[V.jsx("h5",{className:"text-sm font-medium text-gray-500",children:"Gi nhp"}),V.jsx("p",{className:"mt-1 text-gray-600",children:F(d.import_price)})]}),V.jsxs("div",{className:"text-xs text-gray-400",children:["Role: ",_]})]})]})]})})]})},gce=()=>{const[t,e]=He.useState([]),[r,i]=He.useState([]),[s,n]=He.useState(!0);He.useEffect(()=>{o()},[]);const o=async()=>{try{n(!0);const d=await(await fetch("your-api-endpoint")).json();e(d),i(d)}catch(h){console.error("Error fetching data:",h)}finally{n(!1)}},l=h=>{if(!h.trim()){i(t);return}const d=t.filter(g=>g.name.toLowerCase().includes(h.toLowerCase())||g.email.toLowerCase().includes(h.toLowerCase())||g.role.toLowerCase().includes(h.toLowerCase()));i(d)};return V.jsxs("div",{className:"p-6",children:[V.jsxs("div",{className:"mb-8",children:[V.jsx("h1",{className:"text-2xl font-semibold text-gray-800 mb-4",children:"Dashboard"}),V.jsx(dce,{onSearch:l})]}),s?V.jsx("div",{className:"flex justify-center items-center h-64",children:V.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):V.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(h=>V.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[V.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:h.name}),V.jsx("p",{className:"text-gray-600",children:h.email}),V.jsx("span",{className:`inline-block px-2 py-1 mt-2 text-sm rounded-full ${h.role==="admin"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:h.role})]},h.id))}),!s&&r.length===0&&V.jsx("div",{className:"text-center text-gray-500 mt-8",children:"Khng tm thy kt qu ph hp"})]})};function O2(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var xP={exports:{}},v4={exports:{}};/*! cpexcel.js (C) 2013-present SheetJS -- http://sheetjs.com */var g$;function mce(){return g$||(g$=1,function(t){var e={version:"1.15.0"};e[437]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[620]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[737]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[850]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[852]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[857]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[861]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[865]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[866]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[874]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[895]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[932]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);return{enc:i,dec:r}}(),e[936]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[133]="".split(""),n=0;n!=s[133].length;++n)s[133][n].charCodeAt(0)!==65533&&(i[s[133][n]]=34048+n,r[34048+n]=s[133][n]);for(s[134]="".split(""),n=0;n!=s[134].length;++n)s[134][n].charCodeAt(0)!==65533&&(i[s[134][n]]=34304+n,r[34304+n]=s[134][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[160]="".split(""),n=0;n!=s[160].length;++n)s[160][n].charCodeAt(0)!==65533&&(i[s[160][n]]=40960+n,r[40960+n]=s[160][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);for(s[253]="".split(""),n=0;n!=s[253].length;++n)s[253][n].charCodeAt(0)!==65533&&(i[s[253][n]]=64768+n,r[64768+n]=s[253][n]);for(s[254]="".split(""),n=0;n!=s[254].length;++n)s[254][n].charCodeAt(0)!==65533&&(i[s[254][n]]=65024+n,r[65024+n]=s[254][n]);return{enc:i,dec:r}}(),e[949]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[129]="".split(""),n=0;n!=s[129].length;++n)s[129][n].charCodeAt(0)!==65533&&(i[s[129][n]]=33024+n,r[33024+n]=s[129][n]);for(s[130]="".split(""),n=0;n!=s[130].length;++n)s[130][n].charCodeAt(0)!==65533&&(i[s[130][n]]=33280+n,r[33280+n]=s[130][n]);for(s[131]="".split(""),n=0;n!=s[131].length;++n)s[131][n].charCodeAt(0)!==65533&&(i[s[131][n]]=33536+n,r[33536+n]=s[131][n]);for(s[132]="".split(""),n=0;n!=s[132].length;++n)s[132][n].charCodeAt(0)!==65533&&(i[s[132][n]]=33792+n,r[33792+n]=s[132][n]);for(s[133]="".split(""),n=0;n!=s[133].length;++n)s[133][n].charCodeAt(0)!==65533&&(i[s[133][n]]=34048+n,r[34048+n]=s[133][n]);for(s[134]="".split(""),n=0;n!=s[134].length;++n)s[134][n].charCodeAt(0)!==65533&&(i[s[134][n]]=34304+n,r[34304+n]=s[134][n]);for(s[135]="".split(""),n=0;n!=s[135].length;++n)s[135][n].charCodeAt(0)!==65533&&(i[s[135][n]]=34560+n,r[34560+n]=s[135][n]);for(s[136]="".split(""),n=0;n!=s[136].length;++n)s[136][n].charCodeAt(0)!==65533&&(i[s[136][n]]=34816+n,r[34816+n]=s[136][n]);for(s[137]="".split(""),n=0;n!=s[137].length;++n)s[137][n].charCodeAt(0)!==65533&&(i[s[137][n]]=35072+n,r[35072+n]=s[137][n]);for(s[138]="".split(""),n=0;n!=s[138].length;++n)s[138][n].charCodeAt(0)!==65533&&(i[s[138][n]]=35328+n,r[35328+n]=s[138][n]);for(s[139]="".split(""),n=0;n!=s[139].length;++n)s[139][n].charCodeAt(0)!==65533&&(i[s[139][n]]=35584+n,r[35584+n]=s[139][n]);for(s[140]="".split(""),n=0;n!=s[140].length;++n)s[140][n].charCodeAt(0)!==65533&&(i[s[140][n]]=35840+n,r[35840+n]=s[140][n]);for(s[141]="".split(""),n=0;n!=s[141].length;++n)s[141][n].charCodeAt(0)!==65533&&(i[s[141][n]]=36096+n,r[36096+n]=s[141][n]);for(s[142]="".split(""),n=0;n!=s[142].length;++n)s[142][n].charCodeAt(0)!==65533&&(i[s[142][n]]=36352+n,r[36352+n]=s[142][n]);for(s[143]="".split(""),n=0;n!=s[143].length;++n)s[143][n].charCodeAt(0)!==65533&&(i[s[143][n]]=36608+n,r[36608+n]=s[143][n]);for(s[144]="".split(""),n=0;n!=s[144].length;++n)s[144][n].charCodeAt(0)!==65533&&(i[s[144][n]]=36864+n,r[36864+n]=s[144][n]);for(s[145]="".split(""),n=0;n!=s[145].length;++n)s[145][n].charCodeAt(0)!==65533&&(i[s[145][n]]=37120+n,r[37120+n]=s[145][n]);for(s[146]="".split(""),n=0;n!=s[146].length;++n)s[146][n].charCodeAt(0)!==65533&&(i[s[146][n]]=37376+n,r[37376+n]=s[146][n]);for(s[147]="".split(""),n=0;n!=s[147].length;++n)s[147][n].charCodeAt(0)!==65533&&(i[s[147][n]]=37632+n,r[37632+n]=s[147][n]);for(s[148]="".split(""),n=0;n!=s[148].length;++n)s[148][n].charCodeAt(0)!==65533&&(i[s[148][n]]=37888+n,r[37888+n]=s[148][n]);for(s[149]="".split(""),n=0;n!=s[149].length;++n)s[149][n].charCodeAt(0)!==65533&&(i[s[149][n]]=38144+n,r[38144+n]=s[149][n]);for(s[150]="".split(""),n=0;n!=s[150].length;++n)s[150][n].charCodeAt(0)!==65533&&(i[s[150][n]]=38400+n,r[38400+n]=s[150][n]);for(s[151]="".split(""),n=0;n!=s[151].length;++n)s[151][n].charCodeAt(0)!==65533&&(i[s[151][n]]=38656+n,r[38656+n]=s[151][n]);for(s[152]="".split(""),n=0;n!=s[152].length;++n)s[152][n].charCodeAt(0)!==65533&&(i[s[152][n]]=38912+n,r[38912+n]=s[152][n]);for(s[153]="".split(""),n=0;n!=s[153].length;++n)s[153][n].charCodeAt(0)!==65533&&(i[s[153][n]]=39168+n,r[39168+n]=s[153][n]);for(s[154]="".split(""),n=0;n!=s[154].length;++n)s[154][n].charCodeAt(0)!==65533&&(i[s[154][n]]=39424+n,r[39424+n]=s[154][n]);for(s[155]="".split(""),n=0;n!=s[155].length;++n)s[155][n].charCodeAt(0)!==65533&&(i[s[155][n]]=39680+n,r[39680+n]=s[155][n]);for(s[156]="".split(""),n=0;n!=s[156].length;++n)s[156][n].charCodeAt(0)!==65533&&(i[s[156][n]]=39936+n,r[39936+n]=s[156][n]);for(s[157]="".split(""),n=0;n!=s[157].length;++n)s[157][n].charCodeAt(0)!==65533&&(i[s[157][n]]=40192+n,r[40192+n]=s[157][n]);for(s[158]="".split(""),n=0;n!=s[158].length;++n)s[158][n].charCodeAt(0)!==65533&&(i[s[158][n]]=40448+n,r[40448+n]=s[158][n]);for(s[159]="".split(""),n=0;n!=s[159].length;++n)s[159][n].charCodeAt(0)!==65533&&(i[s[159][n]]=40704+n,r[40704+n]=s[159][n]);for(s[160]="".split(""),n=0;n!=s[160].length;++n)s[160][n].charCodeAt(0)!==65533&&(i[s[160][n]]=40960+n,r[40960+n]=s[160][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);for(s[250]="".split(""),n=0;n!=s[250].length;++n)s[250][n].charCodeAt(0)!==65533&&(i[s[250][n]]=64e3+n,r[64e3+n]=s[250][n]);for(s[251]="".split(""),n=0;n!=s[251].length;++n)s[251][n].charCodeAt(0)!==65533&&(i[s[251][n]]=64256+n,r[64256+n]=s[251][n]);for(s[252]="".split(""),n=0;n!=s[252].length;++n)s[252][n].charCodeAt(0)!==65533&&(i[s[252][n]]=64512+n,r[64512+n]=s[252][n]);for(s[253]="".split(""),n=0;n!=s[253].length;++n)s[253][n].charCodeAt(0)!==65533&&(i[s[253][n]]=64768+n,r[64768+n]=s[253][n]);return{enc:i,dec:r}}(),e[950]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[170]="".split(""),n=0;n!=s[170].length;++n)s[170][n].charCodeAt(0)!==65533&&(i[s[170][n]]=43520+n,r[43520+n]=s[170][n]);for(s[171]="".split(""),n=0;n!=s[171].length;++n)s[171][n].charCodeAt(0)!==65533&&(i[s[171][n]]=43776+n,r[43776+n]=s[171][n]);for(s[172]="".split(""),n=0;n!=s[172].length;++n)s[172][n].charCodeAt(0)!==65533&&(i[s[172][n]]=44032+n,r[44032+n]=s[172][n]);for(s[173]="".split(""),n=0;n!=s[173].length;++n)s[173][n].charCodeAt(0)!==65533&&(i[s[173][n]]=44288+n,r[44288+n]=s[173][n]);for(s[174]="".split(""),n=0;n!=s[174].length;++n)s[174][n].charCodeAt(0)!==65533&&(i[s[174][n]]=44544+n,r[44544+n]=s[174][n]);for(s[175]="".split(""),n=0;n!=s[175].length;++n)s[175][n].charCodeAt(0)!==65533&&(i[s[175][n]]=44800+n,r[44800+n]=s[175][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);for(s[248]="".split(""),n=0;n!=s[248].length;++n)s[248][n].charCodeAt(0)!==65533&&(i[s[248][n]]=63488+n,r[63488+n]=s[248][n]);for(s[249]="".split(""),n=0;n!=s[249].length;++n)s[249][n].charCodeAt(0)!==65533&&(i[s[249][n]]=63744+n,r[63744+n]=s[249][n]);return{enc:i,dec:r}}(),e[1250]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1251]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1252]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1253]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1254]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1255]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1256]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1257]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1258]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[1e4]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10006]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10007]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10008]=function(){var r=[],i={},s=[],n;for(s[0]=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`.split(""),n=0;n!=s[0].length;++n)s[0][n].charCodeAt(0)!==65533&&(i[s[0][n]]=0+n,r[0+n]=s[0][n]);for(s[161]="".split(""),n=0;n!=s[161].length;++n)s[161][n].charCodeAt(0)!==65533&&(i[s[161][n]]=41216+n,r[41216+n]=s[161][n]);for(s[162]="".split(""),n=0;n!=s[162].length;++n)s[162][n].charCodeAt(0)!==65533&&(i[s[162][n]]=41472+n,r[41472+n]=s[162][n]);for(s[163]="".split(""),n=0;n!=s[163].length;++n)s[163][n].charCodeAt(0)!==65533&&(i[s[163][n]]=41728+n,r[41728+n]=s[163][n]);for(s[164]="".split(""),n=0;n!=s[164].length;++n)s[164][n].charCodeAt(0)!==65533&&(i[s[164][n]]=41984+n,r[41984+n]=s[164][n]);for(s[165]="".split(""),n=0;n!=s[165].length;++n)s[165][n].charCodeAt(0)!==65533&&(i[s[165][n]]=42240+n,r[42240+n]=s[165][n]);for(s[166]="".split(""),n=0;n!=s[166].length;++n)s[166][n].charCodeAt(0)!==65533&&(i[s[166][n]]=42496+n,r[42496+n]=s[166][n]);for(s[167]="".split(""),n=0;n!=s[167].length;++n)s[167][n].charCodeAt(0)!==65533&&(i[s[167][n]]=42752+n,r[42752+n]=s[167][n]);for(s[168]="".split(""),n=0;n!=s[168].length;++n)s[168][n].charCodeAt(0)!==65533&&(i[s[168][n]]=43008+n,r[43008+n]=s[168][n]);for(s[169]="".split(""),n=0;n!=s[169].length;++n)s[169][n].charCodeAt(0)!==65533&&(i[s[169][n]]=43264+n,r[43264+n]=s[169][n]);for(s[176]="".split(""),n=0;n!=s[176].length;++n)s[176][n].charCodeAt(0)!==65533&&(i[s[176][n]]=45056+n,r[45056+n]=s[176][n]);for(s[177]="".split(""),n=0;n!=s[177].length;++n)s[177][n].charCodeAt(0)!==65533&&(i[s[177][n]]=45312+n,r[45312+n]=s[177][n]);for(s[178]="".split(""),n=0;n!=s[178].length;++n)s[178][n].charCodeAt(0)!==65533&&(i[s[178][n]]=45568+n,r[45568+n]=s[178][n]);for(s[179]="".split(""),n=0;n!=s[179].length;++n)s[179][n].charCodeAt(0)!==65533&&(i[s[179][n]]=45824+n,r[45824+n]=s[179][n]);for(s[180]="".split(""),n=0;n!=s[180].length;++n)s[180][n].charCodeAt(0)!==65533&&(i[s[180][n]]=46080+n,r[46080+n]=s[180][n]);for(s[181]="".split(""),n=0;n!=s[181].length;++n)s[181][n].charCodeAt(0)!==65533&&(i[s[181][n]]=46336+n,r[46336+n]=s[181][n]);for(s[182]="".split(""),n=0;n!=s[182].length;++n)s[182][n].charCodeAt(0)!==65533&&(i[s[182][n]]=46592+n,r[46592+n]=s[182][n]);for(s[183]="".split(""),n=0;n!=s[183].length;++n)s[183][n].charCodeAt(0)!==65533&&(i[s[183][n]]=46848+n,r[46848+n]=s[183][n]);for(s[184]="".split(""),n=0;n!=s[184].length;++n)s[184][n].charCodeAt(0)!==65533&&(i[s[184][n]]=47104+n,r[47104+n]=s[184][n]);for(s[185]="".split(""),n=0;n!=s[185].length;++n)s[185][n].charCodeAt(0)!==65533&&(i[s[185][n]]=47360+n,r[47360+n]=s[185][n]);for(s[186]="".split(""),n=0;n!=s[186].length;++n)s[186][n].charCodeAt(0)!==65533&&(i[s[186][n]]=47616+n,r[47616+n]=s[186][n]);for(s[187]="".split(""),n=0;n!=s[187].length;++n)s[187][n].charCodeAt(0)!==65533&&(i[s[187][n]]=47872+n,r[47872+n]=s[187][n]);for(s[188]="".split(""),n=0;n!=s[188].length;++n)s[188][n].charCodeAt(0)!==65533&&(i[s[188][n]]=48128+n,r[48128+n]=s[188][n]);for(s[189]="".split(""),n=0;n!=s[189].length;++n)s[189][n].charCodeAt(0)!==65533&&(i[s[189][n]]=48384+n,r[48384+n]=s[189][n]);for(s[190]="".split(""),n=0;n!=s[190].length;++n)s[190][n].charCodeAt(0)!==65533&&(i[s[190][n]]=48640+n,r[48640+n]=s[190][n]);for(s[191]="".split(""),n=0;n!=s[191].length;++n)s[191][n].charCodeAt(0)!==65533&&(i[s[191][n]]=48896+n,r[48896+n]=s[191][n]);for(s[192]="".split(""),n=0;n!=s[192].length;++n)s[192][n].charCodeAt(0)!==65533&&(i[s[192][n]]=49152+n,r[49152+n]=s[192][n]);for(s[193]="".split(""),n=0;n!=s[193].length;++n)s[193][n].charCodeAt(0)!==65533&&(i[s[193][n]]=49408+n,r[49408+n]=s[193][n]);for(s[194]="".split(""),n=0;n!=s[194].length;++n)s[194][n].charCodeAt(0)!==65533&&(i[s[194][n]]=49664+n,r[49664+n]=s[194][n]);for(s[195]="".split(""),n=0;n!=s[195].length;++n)s[195][n].charCodeAt(0)!==65533&&(i[s[195][n]]=49920+n,r[49920+n]=s[195][n]);for(s[196]="".split(""),n=0;n!=s[196].length;++n)s[196][n].charCodeAt(0)!==65533&&(i[s[196][n]]=50176+n,r[50176+n]=s[196][n]);for(s[197]="".split(""),n=0;n!=s[197].length;++n)s[197][n].charCodeAt(0)!==65533&&(i[s[197][n]]=50432+n,r[50432+n]=s[197][n]);for(s[198]="".split(""),n=0;n!=s[198].length;++n)s[198][n].charCodeAt(0)!==65533&&(i[s[198][n]]=50688+n,r[50688+n]=s[198][n]);for(s[199]="".split(""),n=0;n!=s[199].length;++n)s[199][n].charCodeAt(0)!==65533&&(i[s[199][n]]=50944+n,r[50944+n]=s[199][n]);for(s[200]="".split(""),n=0;n!=s[200].length;++n)s[200][n].charCodeAt(0)!==65533&&(i[s[200][n]]=51200+n,r[51200+n]=s[200][n]);for(s[201]="".split(""),n=0;n!=s[201].length;++n)s[201][n].charCodeAt(0)!==65533&&(i[s[201][n]]=51456+n,r[51456+n]=s[201][n]);for(s[202]="".split(""),n=0;n!=s[202].length;++n)s[202][n].charCodeAt(0)!==65533&&(i[s[202][n]]=51712+n,r[51712+n]=s[202][n]);for(s[203]="".split(""),n=0;n!=s[203].length;++n)s[203][n].charCodeAt(0)!==65533&&(i[s[203][n]]=51968+n,r[51968+n]=s[203][n]);for(s[204]="".split(""),n=0;n!=s[204].length;++n)s[204][n].charCodeAt(0)!==65533&&(i[s[204][n]]=52224+n,r[52224+n]=s[204][n]);for(s[205]="".split(""),n=0;n!=s[205].length;++n)s[205][n].charCodeAt(0)!==65533&&(i[s[205][n]]=52480+n,r[52480+n]=s[205][n]);for(s[206]="".split(""),n=0;n!=s[206].length;++n)s[206][n].charCodeAt(0)!==65533&&(i[s[206][n]]=52736+n,r[52736+n]=s[206][n]);for(s[207]="".split(""),n=0;n!=s[207].length;++n)s[207][n].charCodeAt(0)!==65533&&(i[s[207][n]]=52992+n,r[52992+n]=s[207][n]);for(s[208]="".split(""),n=0;n!=s[208].length;++n)s[208][n].charCodeAt(0)!==65533&&(i[s[208][n]]=53248+n,r[53248+n]=s[208][n]);for(s[209]="".split(""),n=0;n!=s[209].length;++n)s[209][n].charCodeAt(0)!==65533&&(i[s[209][n]]=53504+n,r[53504+n]=s[209][n]);for(s[210]="".split(""),n=0;n!=s[210].length;++n)s[210][n].charCodeAt(0)!==65533&&(i[s[210][n]]=53760+n,r[53760+n]=s[210][n]);for(s[211]="".split(""),n=0;n!=s[211].length;++n)s[211][n].charCodeAt(0)!==65533&&(i[s[211][n]]=54016+n,r[54016+n]=s[211][n]);for(s[212]="".split(""),n=0;n!=s[212].length;++n)s[212][n].charCodeAt(0)!==65533&&(i[s[212][n]]=54272+n,r[54272+n]=s[212][n]);for(s[213]="".split(""),n=0;n!=s[213].length;++n)s[213][n].charCodeAt(0)!==65533&&(i[s[213][n]]=54528+n,r[54528+n]=s[213][n]);for(s[214]="".split(""),n=0;n!=s[214].length;++n)s[214][n].charCodeAt(0)!==65533&&(i[s[214][n]]=54784+n,r[54784+n]=s[214][n]);for(s[215]="".split(""),n=0;n!=s[215].length;++n)s[215][n].charCodeAt(0)!==65533&&(i[s[215][n]]=55040+n,r[55040+n]=s[215][n]);for(s[216]="".split(""),n=0;n!=s[216].length;++n)s[216][n].charCodeAt(0)!==65533&&(i[s[216][n]]=55296+n,r[55296+n]=s[216][n]);for(s[217]="".split(""),n=0;n!=s[217].length;++n)s[217][n].charCodeAt(0)!==65533&&(i[s[217][n]]=55552+n,r[55552+n]=s[217][n]);for(s[218]="".split(""),n=0;n!=s[218].length;++n)s[218][n].charCodeAt(0)!==65533&&(i[s[218][n]]=55808+n,r[55808+n]=s[218][n]);for(s[219]="".split(""),n=0;n!=s[219].length;++n)s[219][n].charCodeAt(0)!==65533&&(i[s[219][n]]=56064+n,r[56064+n]=s[219][n]);for(s[220]="".split(""),n=0;n!=s[220].length;++n)s[220][n].charCodeAt(0)!==65533&&(i[s[220][n]]=56320+n,r[56320+n]=s[220][n]);for(s[221]="".split(""),n=0;n!=s[221].length;++n)s[221][n].charCodeAt(0)!==65533&&(i[s[221][n]]=56576+n,r[56576+n]=s[221][n]);for(s[222]="".split(""),n=0;n!=s[222].length;++n)s[222][n].charCodeAt(0)!==65533&&(i[s[222][n]]=56832+n,r[56832+n]=s[222][n]);for(s[223]="".split(""),n=0;n!=s[223].length;++n)s[223][n].charCodeAt(0)!==65533&&(i[s[223][n]]=57088+n,r[57088+n]=s[223][n]);for(s[224]="".split(""),n=0;n!=s[224].length;++n)s[224][n].charCodeAt(0)!==65533&&(i[s[224][n]]=57344+n,r[57344+n]=s[224][n]);for(s[225]="".split(""),n=0;n!=s[225].length;++n)s[225][n].charCodeAt(0)!==65533&&(i[s[225][n]]=57600+n,r[57600+n]=s[225][n]);for(s[226]="".split(""),n=0;n!=s[226].length;++n)s[226][n].charCodeAt(0)!==65533&&(i[s[226][n]]=57856+n,r[57856+n]=s[226][n]);for(s[227]="".split(""),n=0;n!=s[227].length;++n)s[227][n].charCodeAt(0)!==65533&&(i[s[227][n]]=58112+n,r[58112+n]=s[227][n]);for(s[228]="".split(""),n=0;n!=s[228].length;++n)s[228][n].charCodeAt(0)!==65533&&(i[s[228][n]]=58368+n,r[58368+n]=s[228][n]);for(s[229]="".split(""),n=0;n!=s[229].length;++n)s[229][n].charCodeAt(0)!==65533&&(i[s[229][n]]=58624+n,r[58624+n]=s[229][n]);for(s[230]="".split(""),n=0;n!=s[230].length;++n)s[230][n].charCodeAt(0)!==65533&&(i[s[230][n]]=58880+n,r[58880+n]=s[230][n]);for(s[231]="".split(""),n=0;n!=s[231].length;++n)s[231][n].charCodeAt(0)!==65533&&(i[s[231][n]]=59136+n,r[59136+n]=s[231][n]);for(s[232]="".split(""),n=0;n!=s[232].length;++n)s[232][n].charCodeAt(0)!==65533&&(i[s[232][n]]=59392+n,r[59392+n]=s[232][n]);for(s[233]="".split(""),n=0;n!=s[233].length;++n)s[233][n].charCodeAt(0)!==65533&&(i[s[233][n]]=59648+n,r[59648+n]=s[233][n]);for(s[234]="".split(""),n=0;n!=s[234].length;++n)s[234][n].charCodeAt(0)!==65533&&(i[s[234][n]]=59904+n,r[59904+n]=s[234][n]);for(s[235]="".split(""),n=0;n!=s[235].length;++n)s[235][n].charCodeAt(0)!==65533&&(i[s[235][n]]=60160+n,r[60160+n]=s[235][n]);for(s[236]="".split(""),n=0;n!=s[236].length;++n)s[236][n].charCodeAt(0)!==65533&&(i[s[236][n]]=60416+n,r[60416+n]=s[236][n]);for(s[237]="".split(""),n=0;n!=s[237].length;++n)s[237][n].charCodeAt(0)!==65533&&(i[s[237][n]]=60672+n,r[60672+n]=s[237][n]);for(s[238]="".split(""),n=0;n!=s[238].length;++n)s[238][n].charCodeAt(0)!==65533&&(i[s[238][n]]=60928+n,r[60928+n]=s[238][n]);for(s[239]="".split(""),n=0;n!=s[239].length;++n)s[239][n].charCodeAt(0)!==65533&&(i[s[239][n]]=61184+n,r[61184+n]=s[239][n]);for(s[240]="".split(""),n=0;n!=s[240].length;++n)s[240][n].charCodeAt(0)!==65533&&(i[s[240][n]]=61440+n,r[61440+n]=s[240][n]);for(s[241]="".split(""),n=0;n!=s[241].length;++n)s[241][n].charCodeAt(0)!==65533&&(i[s[241][n]]=61696+n,r[61696+n]=s[241][n]);for(s[242]="".split(""),n=0;n!=s[242].length;++n)s[242][n].charCodeAt(0)!==65533&&(i[s[242][n]]=61952+n,r[61952+n]=s[242][n]);for(s[243]="".split(""),n=0;n!=s[243].length;++n)s[243][n].charCodeAt(0)!==65533&&(i[s[243][n]]=62208+n,r[62208+n]=s[243][n]);for(s[244]="".split(""),n=0;n!=s[244].length;++n)s[244][n].charCodeAt(0)!==65533&&(i[s[244][n]]=62464+n,r[62464+n]=s[244][n]);for(s[245]="".split(""),n=0;n!=s[245].length;++n)s[245][n].charCodeAt(0)!==65533&&(i[s[245][n]]=62720+n,r[62720+n]=s[245][n]);for(s[246]="".split(""),n=0;n!=s[246].length;++n)s[246][n].charCodeAt(0)!==65533&&(i[s[246][n]]=62976+n,r[62976+n]=s[246][n]);for(s[247]="".split(""),n=0;n!=s[247].length;++n)s[247][n].charCodeAt(0)!==65533&&(i[s[247][n]]=63232+n,r[63232+n]=s[247][n]);return{enc:i,dec:r}}(),e[10029]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10079]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[10081]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),e[28591]=function(){for(var r=`\0\x07\b	
\v\f\r\x1B !"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_\`abcdefghijklmnopqrstuvwxyz{|}~`,i=[],s={},n=0;n!=r.length;++n)r.charCodeAt(n)!==65533&&(s[r.charAt(n)]=n),i[n]=r.charAt(n);return{enc:s,dec:i}}(),t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"&&(t.exports=e);/*! cputils.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(r,i){if(typeof e>"u")if(typeof O2<"u"){var s=e;t.exports&&typeof DO_NOT_EXPORT_CODEPAGE>"u"?t.exports=i(s):r.cptable=i(s)}else throw new Error("cptable not found");else e=i(e)})(kw,function(r){var i={1200:"utf16le",1201:"utf16be",12e3:"utf32le",12001:"utf32be",16969:"utf64le",20127:"ascii",65e3:"utf7",65001:"utf8"},s=[874,1250,1251,1252,1253,1254,1255,1256,1e4],n=[932,936,949,950],o=[65001],l={},h={},d={},g={},y=function(Fe){return String.fromCharCode(Fe)},C=function(Fe){return Fe.charCodeAt(0)},x=typeof Buffer<"u",_=function(){};if(x){var E=!Buffer.from;if(!E)try{Buffer.from("foo","utf8")}catch{E=!0}_=E?function(Je,Fe){return Fe?new Buffer(Je,Fe):new Buffer(Je)}:Buffer.from.bind(Buffer),Buffer.allocUnsafe||(Buffer.allocUnsafe=function(Je){return new Buffer(Je)});var R=1024,I=Buffer.allocUnsafe(R),F=function(Fe){for(var A=Buffer.allocUnsafe(65536),O=0;O<65536;++O)A[O]=0;for(var k=Object.keys(Fe),L=k.length,D=0,K=k[D];D<L;++D)(K=k[D])&&(A[K.charCodeAt(0)]=Fe[K]);return A},H=function(Fe){var A=F(r[Fe].enc);return function(k,L){var D=k.length,K,Q=0,pe=0,ye=0,j=0;if(typeof k=="string")for(K=Buffer.allocUnsafe(D),Q=0;Q<D;++Q)K[Q]=A[k.charCodeAt(Q)];else if(Buffer.isBuffer(k)){for(K=Buffer.allocUnsafe(2*D),pe=0,Q=0;Q<D;++Q)ye=k[Q],ye<128?K[pe++]=A[ye]:ye<224?(K[pe++]=A[((ye&31)<<6)+(k[Q+1]&63)],++Q):ye<240?(K[pe++]=A[((ye&15)<<12)+((k[Q+1]&63)<<6)+(k[Q+2]&63)],Q+=2):(j=((ye&7)<<18)+((k[Q+1]&63)<<12)+((k[Q+2]&63)<<6)+(k[Q+3]&63),Q+=3,j<65536?K[pe++]=A[j]:(j-=65536,K[pe++]=A[55296+(j>>10&1023)],K[pe++]=A[56320+(j&1023)]));K=K.slice(0,pe)}else for(K=Buffer.allocUnsafe(D),Q=0;Q<D;++Q)K[Q]=A[k[Q].charCodeAt(0)];return!L||L==="buf"?K:L!=="arr"?K.toString("binary"):[].slice.call(K)}},z=function(Fe){var A=r[Fe].dec,O=Buffer.allocUnsafe(131072),k=0,L="";for(k=0;k<A.length;++k)if(L=A[k]){var D=L.charCodeAt(0);O[2*k]=D&255,O[2*k+1]=D>>8}return function(Q){var pe=Q.length,ye=0,j=0;if(2*pe>R&&(R=2*pe,I=Buffer.allocUnsafe(R)),Buffer.isBuffer(Q))for(ye=0;ye<pe;ye++)j=2*Q[ye],I[2*ye]=O[j],I[2*ye+1]=O[j+1];else if(typeof Q=="string")for(ye=0;ye<pe;ye++)j=2*Q.charCodeAt(ye),I[2*ye]=O[j],I[2*ye+1]=O[j+1];else for(ye=0;ye<pe;ye++)j=2*Q[ye],I[2*ye]=O[j],I[2*ye+1]=O[j+1];return I.slice(0,2*pe).toString("ucs2")}},q=function(Fe){for(var A=r[Fe].enc,O=Buffer.allocUnsafe(131072),k=0;k<131072;++k)O[k]=0;for(var L=Object.keys(A),D=0,K=L[D];D<L.length;++D)if(K=L[D]){var Q=K.charCodeAt(0);O[2*Q]=A[K]&255,O[2*Q+1]=A[K]>>8}return function(ye,j){var X=ye.length,te=Buffer.allocUnsafe(2*X),we=0,ce=0,_e=0,Ee=0,he=0;if(typeof ye=="string"){for(we=Ee=0;we<X;++we)ce=ye.charCodeAt(we)*2,te[Ee++]=O[ce+1]||O[ce],O[ce+1]>0&&(te[Ee++]=O[ce]);te=te.slice(0,Ee)}else if(Buffer.isBuffer(ye)){for(we=Ee=0;we<X;++we)he=ye[we],he<128?ce=he:he<224?(ce=((he&31)<<6)+(ye[we+1]&63),++we):he<240?(ce=((he&15)<<12)+((ye[we+1]&63)<<6)+(ye[we+2]&63),we+=2):(ce=((he&7)<<18)+((ye[we+1]&63)<<12)+((ye[we+2]&63)<<6)+(ye[we+3]&63),we+=3),ce<65536?(ce*=2,te[Ee++]=O[ce+1]||O[ce],O[ce+1]>0&&(te[Ee++]=O[ce])):(_e=ce-65536,ce=2*(55296+(_e>>10&1023)),te[Ee++]=O[ce+1]||O[ce],O[ce+1]>0&&(te[Ee++]=O[ce]),ce=2*(56320+(_e&1023)),te[Ee++]=O[ce+1]||O[ce],O[ce+1]>0&&(te[Ee++]=O[ce]));te=te.slice(0,Ee)}else for(we=Ee=0;we<X;we++)ce=ye[we].charCodeAt(0)*2,te[Ee++]=O[ce+1]||O[ce],O[ce+1]>0&&(te[Ee++]=O[ce]);return!j||j==="buf"?te:j!=="arr"?te.toString("binary"):[].slice.call(te)}},re=function(Fe){var A=r[Fe].dec,O=Buffer.allocUnsafe(131072),k=0,L,D=0,K=0,Q=0;for(Q=0;Q<65536;++Q)O[2*Q]=255,O[2*Q+1]=253;for(k=0;k<A.length;++k)(L=A[k])&&(D=L.charCodeAt(0),K=2*k,O[K]=D&255,O[K+1]=D>>8);return function(ye){var j=ye.length,X=Buffer.allocUnsafe(2*j),te=0,we=0,ce=0;if(Buffer.isBuffer(ye))for(te=0;te<j;te++)we=2*ye[te],O[we]===255&&O[we+1]===253&&(we=2*((ye[te]<<8)+ye[te+1]),++te),X[ce++]=O[we],X[ce++]=O[we+1];else if(typeof ye=="string")for(te=0;te<j;te++)we=2*ye.charCodeAt(te),O[we]===255&&O[we+1]===253&&(we=2*((ye.charCodeAt(te)<<8)+ye.charCodeAt(te+1)),++te),X[ce++]=O[we],X[ce++]=O[we+1];else for(te=0;te<j;te++)we=2*ye[te],O[we]===255&&O[we+1]===253&&(we=2*((ye[te]<<8)+ye[te+1]),++te),X[ce++]=O[we],X[ce++]=O[we+1];return X.slice(0,ce).toString("ucs2")}};l[65001]=function Je(Fe){if(typeof Fe=="string")return Je(Fe.split("").map(C));var A=Fe.length,O=0,k=0;4*A>R&&(R=4*A,I=Buffer.allocUnsafe(R));var L=0;A>=3&&Fe[0]==239&&Fe[1]==187&&Fe[2]==191&&(L=3);for(var D=1,K=0,Q=0;L<A;L+=D)D=1,Q=Fe[L],Q<128?O=Q:Q<224?(O=(Q&31)*64+(Fe[L+1]&63),D=2):Q<240?(O=((Q&15)<<12)+(Fe[L+1]&63)*64+(Fe[L+2]&63),D=3):(O=(Q&7)*262144+((Fe[L+1]&63)<<12)+(Fe[L+2]&63)*64+(Fe[L+3]&63),D=4),O<65536?(I[K++]=O&255,I[K++]=O>>8):(O-=65536,k=55296+(O>>10&1023),O=56320+(O&1023),I[K++]=k&255,I[K++]=k>>>8,I[K++]=O&255,I[K++]=O>>>8&255);return I.slice(0,K).toString("ucs2")},h[65001]=function(Fe,A){if(x&&Buffer.isBuffer(Fe))return!A||A==="buf"?Fe:A!=="arr"?Fe.toString("binary"):[].slice.call(Fe);var O=Fe.length,k=0,L=0,D=0,K=typeof Fe=="string";4*O>R&&(R=4*O,I=Buffer.allocUnsafe(R));for(var Q=0;Q<O;++Q)k=K?Fe.charCodeAt(Q):Fe[Q].charCodeAt(0),k<=127?I[D++]=k:k<=2047?(I[D++]=192+(k>>6),I[D++]=128+(k&63)):k>=55296&&k<=57343?(k-=55296,++Q,L=(K?Fe.charCodeAt(Q):Fe[Q].charCodeAt(0))-56320+(k<<10),I[D++]=240+(L>>>18&7),I[D++]=144+(L>>>12&63),I[D++]=128+(L>>>6&63),I[D++]=128+(L&63)):(I[D++]=224+(k>>12),I[D++]=128+(k>>6&63),I[D++]=128+(k&63));return!A||A==="buf"?I.slice(0,D):A!=="arr"?I.slice(0,D).toString("binary"):[].slice.call(I,0,D)}}var Y=function(){if(x){if(d[s[0]])return;var Fe=0,A=0;for(Fe=0;Fe<s.length;++Fe)A=s[Fe],r[A]&&(d[A]=z(A),g[A]=H(A));for(Fe=0;Fe<n.length;++Fe)A=n[Fe],r[A]&&(d[A]=re(A),g[A]=q(A));for(Fe=0;Fe<o.length;++Fe)A=o[Fe],l[A]&&(d[A]=l[A]),h[A]&&(g[A]=h[A])}},oe=function(Je,Fe){return""},me=function(Fe){delete d[Fe],delete g[Fe]},de=function(){if(x){if(!d[s[0]])return;s.forEach(me),n.forEach(me),o.forEach(me)}lt=oe,pt=0},Re={encache:Y,decache:de,sbcs:s,dbcs:n};Y();var Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Be="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'(),-./:?",lt=oe,pt=0,Ct=function Je(Fe,A,O){if(Fe===pt&&lt)return lt(A,O);if(g[Fe])return lt=g[pt=Fe],lt(A,O);x&&Buffer.isBuffer(A)&&(A=A.toString("utf8"));var k=A.length,L=x?Buffer.allocUnsafe(4*k):[],D=0,K=0,Q=0,pe=0,ye=r[Fe],j,X="",te=typeof A=="string";if(ye&&(j=ye.enc))for(K=0;K<k;++K,++Q)D=j[te?A.charAt(K):A[K]],D>255?(L[Q]=D>>8,L[++Q]=D&255):L[Q]=D&255;else if(X=i[Fe])switch(X){case"utf8":if(x&&te){L=_(A,X),Q=L.length;break}for(K=0;K<k;++K,++Q)D=te?A.charCodeAt(K):A[K].charCodeAt(0),D<=127?L[Q]=D:D<=2047?(L[Q]=192+(D>>6),L[++Q]=128+(D&63)):D>=55296&&D<=57343?(D-=55296,pe=(te?A.charCodeAt(++K):A[++K].charCodeAt(0))-56320+(D<<10),L[Q]=240+(pe>>>18&7),L[++Q]=144+(pe>>>12&63),L[++Q]=128+(pe>>>6&63),L[++Q]=128+(pe&63)):(L[Q]=224+(D>>12),L[++Q]=128+(D>>6&63),L[++Q]=128+(D&63));break;case"ascii":if(x&&typeof A=="string"){L=_(A,X),Q=L.length;break}for(K=0;K<k;++K,++Q)if(D=te?A.charCodeAt(K):A[K].charCodeAt(0),D<=127)L[Q]=D;else throw new Error("bad ascii "+D);break;case"utf16le":if(x&&typeof A=="string"){L=_(A,X),Q=L.length;break}for(K=0;K<k;++K)D=te?A.charCodeAt(K):A[K].charCodeAt(0),L[Q++]=D&255,L[Q++]=D>>8;break;case"utf16be":for(K=0;K<k;++K)D=te?A.charCodeAt(K):A[K].charCodeAt(0),L[Q++]=D>>8,L[Q++]=D&255;break;case"utf32le":for(K=0;K<k;++K)D=te?A.charCodeAt(K):A[K].charCodeAt(0),D>=55296&&D<=57343&&(D=65536+(D-55296<<10)+(A[++K].charCodeAt(0)-56320)),L[Q++]=D&255,D>>=8,L[Q++]=D&255,D>>=8,L[Q++]=D&255,D>>=8,L[Q++]=D&255;break;case"utf32be":for(K=0;K<k;++K)D=te?A.charCodeAt(K):A[K].charCodeAt(0),D>=55296&&D<=57343&&(D=65536+(D-55296<<10)+(A[++K].charCodeAt(0)-56320)),L[Q+3]=D&255,D>>=8,L[Q+2]=D&255,D>>=8,L[Q+1]=D&255,D>>=8,L[Q]=D&255,Q+=4;break;case"utf7":for(K=0;K<k;K++){var we=te?A.charAt(K):A[K].charAt(0);if(we==="+"){L[Q++]=43,L[Q++]=45;continue}if(Be.indexOf(we)>-1){L[Q++]=we.charCodeAt(0);continue}var ce=Je(1201,we);L[Q++]=43,L[Q++]=Ie.charCodeAt(ce[0]>>2),L[Q++]=Ie.charCodeAt(((ce[0]&3)<<4)+((ce[1]||0)>>4)),L[Q++]=Ie.charCodeAt(((ce[1]&15)<<2)+((ce[2]||0)>>6)),L[Q++]=45}break;default:throw new Error("Unsupported magic: "+Fe+" "+i[Fe])}else throw new Error("Unrecognized CP: "+Fe);return L=L.slice(0,Q),x?!O||O==="buf"?L:O!=="arr"?L.toString("binary"):[].slice.call(L):O=="str"?L.map(y).join(""):L},ct=function Je(Fe,A){var O;if(O=d[Fe])return O(A);if(typeof A=="string")return Je(Fe,A.split("").map(C));var k=A.length,L=new Array(k),D="",K=0,Q=0,pe=1,ye=0,j=0,X=r[Fe],te,we="";if(X&&(te=X.dec))for(Q=0;Q<k;Q+=pe){if(pe=2,D=te[(A[Q]<<8)+A[Q+1]],D||(pe=1,D=te[A[Q]]),!D)throw new Error("Unrecognized code: "+A[Q]+" "+A[Q+pe-1]+" "+Q+" "+pe+" "+te[A[Q]]);L[ye++]=D}else if(we=i[Fe])switch(we){case"utf8":for(k>=3&&A[0]==239&&A[1]==187&&A[2]==191&&(Q=3);Q<k;Q+=pe)pe=1,A[Q]<128?K=A[Q]:A[Q]<224?(K=(A[Q]&31)*64+(A[Q+1]&63),pe=2):A[Q]<240?(K=((A[Q]&15)<<12)+(A[Q+1]&63)*64+(A[Q+2]&63),pe=3):(K=(A[Q]&7)*262144+((A[Q+1]&63)<<12)+(A[Q+2]&63)*64+(A[Q+3]&63),pe=4),K<65536||(K-=65536,j=55296+(K>>10&1023),K=56320+(K&1023),L[ye++]=String.fromCharCode(j)),L[ye++]=String.fromCharCode(K);break;case"ascii":if(x&&Buffer.isBuffer(A))return A.toString(we);for(Q=0;Q<k;Q++)L[Q]=String.fromCharCode(A[Q]);ye=k;break;case"utf16le":if(k>=2&&A[0]==255&&A[1]==254&&(Q=2),x&&Buffer.isBuffer(A))return A.toString(we);for(pe=2;Q+1<k;Q+=pe)L[ye++]=String.fromCharCode((A[Q+1]<<8)+A[Q]);break;case"utf16be":for(k>=2&&A[0]==254&&A[1]==255&&(Q=2),pe=2;Q+1<k;Q+=pe)L[ye++]=String.fromCharCode((A[Q]<<8)+A[Q+1]);break;case"utf32le":for(k>=4&&A[0]==255&&A[1]==254&&A[2]===0&&A[3]===0&&(Q=4),pe=4;Q<k;Q+=pe)K=(A[Q+3]<<24)+(A[Q+2]<<16)+(A[Q+1]<<8)+A[Q],K>65535?(K-=65536,L[ye++]=String.fromCharCode(55296+(K>>10&1023)),L[ye++]=String.fromCharCode(56320+(K&1023))):L[ye++]=String.fromCharCode(K);break;case"utf32be":for(k>=4&&A[3]==255&&A[2]==254&&A[1]===0&&A[0]===0&&(Q=4),pe=4;Q<k;Q+=pe)K=(A[Q]<<24)+(A[Q+1]<<16)+(A[Q+2]<<8)+A[Q+3],K>65535?(K-=65536,L[ye++]=String.fromCharCode(55296+(K>>10&1023)),L[ye++]=String.fromCharCode(56320+(K&1023))):L[ye++]=String.fromCharCode(K);break;case"utf7":for(k>=4&&A[0]==43&&A[1]==47&&A[2]==118&&(k>=5&&A[3]==56&&A[4]==45?Q=5:(A[3]==56||A[3]==57||A[3]==43||A[3]==47)&&(Q=4));Q<k;Q+=pe){if(A[Q]!==43){pe=1,L[ye++]=String.fromCharCode(A[Q]);continue}if(pe=1,A[Q+1]===45){pe=2,L[ye++]="+";continue}for(;String.fromCharCode(A[Q+pe]).match(/[A-Za-z0-9+\/]/);)pe++;var ce=0;A[Q+pe]===45&&(++pe,ce=1);for(var _e=[],Ee="",he=0,Ae=0,Ne=0,Le=0,Xe=0,Ft=0,St=0,zt=1;zt<pe-ce&&(Le=Ie.indexOf(String.fromCharCode(A[Q+zt++])),Xe=Ie.indexOf(String.fromCharCode(A[Q+zt++])),he=Le<<2|Xe>>4,_e.push(he),Ft=Ie.indexOf(String.fromCharCode(A[Q+zt++])),!(Ft===-1||(Ae=(Xe&15)<<4|Ft>>2,_e.push(Ae),St=Ie.indexOf(String.fromCharCode(A[Q+zt++])),St===-1)));)Ne=(Ft&3)<<6|St,St<64&&_e.push(Ne);for(Ee=Je(1201,_e),zt=0;zt<Ee.length;++zt)L[ye++]=Ee.charAt(zt)}break;default:throw new Error("Unsupported magic: "+Fe+" "+i[Fe])}else throw new Error("Unrecognized CP: "+Fe);return L.slice(0,ye).join("")},Ue=function(Fe){return!!(r[Fe]||i[Fe])};return r.utils={decode:ct,encode:Ct,hascp:Ue,magic:i,cache:Re},r})}(v4)),v4.exports}const pce={},vce=Object.freeze(Object.defineProperty({__proto__:null,default:pce},Symbol.toStringTag,{value:"Module"})),w4=rse(vce);(function(t,e){var r={};function i(s){s.version="0.18.5",s.style_version="1.2.0";var n,o=1200,l=1252;typeof cptable<"u"?n=cptable:typeof O2<"u"&&(n=mce());var h=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],d={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},g=function(a){h.indexOf(a)!=-1&&(l=d[0]=a)},y=function(a){g(o=a)};function C(){y(1200),g(1252)}function x(a){for(var c=[],u=0,f=a.length;u<f;++u)c[u]=a.charCodeAt(u);return c}function _(a){for(var c=[],u=0;u<a.length>>1;++u)c[u]=String.fromCharCode(a.charCodeAt(2*u+1)+(a.charCodeAt(2*u)<<8));return c.join("")}var E=function(a){var c=a.charCodeAt(0),u=a.charCodeAt(1);return c==255&&u==254?function(f){for(var m=[],v=0;v<f.length>>1;++v)m[v]=String.fromCharCode(f.charCodeAt(2*v)+(f.charCodeAt(2*v+1)<<8));return m.join("")}(a.slice(2)):c==254&&u==255?_(a.slice(2)):c==65279?a.slice(1):a},R=function(a){return String.fromCharCode(a)},I=function(a){return String.fromCharCode(a)};n!==void 0&&(y=function(a){g(o=a)},E=function(a){return a.charCodeAt(0)===255&&a.charCodeAt(1)===254?n.utils.decode(1200,x(a.slice(2))):a},R=function(a){return o===1200?String.fromCharCode(a):n.utils.decode(o,[255&a,a>>8])[0]},I=function(a){return n.utils.decode(l,[a])[0]});var F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function H(a){for(var c,u,f,m,v,p="",w=0,S=0,b=0;b<a.length;)m=(c=a.charCodeAt(b++))>>2,v=(3&c)<<4|(u=a.charCodeAt(b++))>>4,w=(15&u)<<2|(f=a.charCodeAt(b++))>>6,S=63&f,isNaN(u)?w=S=64:isNaN(f)&&(S=64),p+=F.charAt(m)+F.charAt(v)+F.charAt(w)+F.charAt(S);return p}function z(a){var c,u,f,m,v,p,w="";a=a.replace(/[^\w\+\/\=]/g,"");for(var S=0;S<a.length;)c=F.indexOf(a.charAt(S++))<<2|(m=F.indexOf(a.charAt(S++)))>>4,w+=String.fromCharCode(c),u=(15&m)<<4|(v=F.indexOf(a.charAt(S++)))>>2,v!==64&&(w+=String.fromCharCode(u)),f=(3&v)<<6|(p=F.indexOf(a.charAt(S++))),p!==64&&(w+=String.fromCharCode(f));return w}var q=typeof Buffer<"u"&&typeof process<"u"&&process.versions!==void 0&&!!process.versions.node,re=function(){if(typeof Buffer>"u")return function(){};var a=!Buffer.from;if(!a)try{Buffer.from("foo","utf8")}catch{a=!0}return a?function(c,u){return u?new Buffer(c,u):new Buffer(c)}:Buffer.from.bind(Buffer)}();function Y(a){return q?Buffer.alloc?Buffer.alloc(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}function oe(a){return q?Buffer.allocUnsafe?Buffer.allocUnsafe(a):new Buffer(a):new(typeof Uint8Array<"u"?Uint8Array:Array)(a)}var me=function(a){return q?re(a,"binary"):a.split("").map(function(c){return 255&c.charCodeAt(0)})};function de(a){if(typeof ArrayBuffer>"u")return me(a);for(var c=new ArrayBuffer(a.length),u=new Uint8Array(c),f=0;f!=a.length;++f)u[f]=255&a.charCodeAt(f);return c}function Re(a){if(Array.isArray(a))return a.map(function(f){return String.fromCharCode(f)}).join("");for(var c=[],u=0;u<a.length;++u)c[u]=String.fromCharCode(a[u]);return c.join("")}function Ie(a){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(a instanceof ArrayBuffer)return Ie(new Uint8Array(a));for(var c=new Array(a.length),u=0;u<a.length;++u)c[u]=a[u];return c}var Be=q?function(a){return Buffer.concat(a.map(function(c){return Buffer.isBuffer(c)?c:re(c)}))}:function(a){if(typeof Uint8Array>"u")return[].concat.apply([],a.map(function(v){return Array.isArray(v)?v:[].slice.call(v)}));for(var u=0,c=0,u=0;u<a.length;++u)c+=a[u].length;for(var f,m=new Uint8Array(c),c=u=0;u<a.length;c+=f,++u)if(f=a[u].length,a[u]instanceof Uint8Array)m.set(a[u],c);else{if(typeof a[u]=="string")throw"wtf";m.set(new Uint8Array(a[u]),c)}return m},lt=/\u0000/g,pt=/[\u0001-\u0006]/g;function Ct(a){for(var c="",u=a.length-1;0<=u;)c+=a.charAt(u--);return c}function ct(a,c){return a=""+a,c<=a.length?a:Ye("0",c-a.length)+a}function Ue(a,c){return a=""+a,c<=a.length?a:Ye(" ",c-a.length)+a}function Je(a,c){return a=""+a,c<=a.length?a:a+Ye(" ",c-a.length)}var Fe=Math.pow(2,32);function A(m,c){if(Fe<m||m<-Fe)return u=m,f=c,u=""+Math.round(u),f<=u.length?u:Ye("0",f-u.length)+u;var u,f,m=Math.round(m);return(c=c)<=(m=""+(m=m)).length?m:Ye("0",c-m.length)+m}function O(a,c){return c=c||0,a.length>=7+c&&(32|a.charCodeAt(c))==103&&(32|a.charCodeAt(c+1))==101&&(32|a.charCodeAt(c+2))==110&&(32|a.charCodeAt(c+3))==101&&(32|a.charCodeAt(c+4))==114&&(32|a.charCodeAt(c+5))==97&&(32|a.charCodeAt(c+6))==108}var k=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],L=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],D={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},K={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Q={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function pe(a,c,u){for(var f=a<0?-1:1,m=a*f,v=0,p=1,w=0,S=1,b=0,T=0,P=Math.floor(m);b<c&&(w=(P=Math.floor(m))*p+v,T=P*b+S,!(m-P<5e-8));)m=1/(m-P),v=p,p=w,S=b,b=T;return c<T&&(w=c<b?(T=S,v):(T=b,p)),u?(u=Math.floor(f*w/T),[u,f*w-u*T,T]):[0,f*w,T]}function ye(w,c,u){if(2958465<w||w<0)return null;var f=0|w,m=Math.floor(86400*(w-f)),v=0,p=[],w={D:f,T:m,u:86400*(w-f)-m,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(w.u)<1e-6&&(w.u=0),c&&c.date1904&&(f+=1462),.9999<w.u&&(w.u=0,++m==86400&&(w.T=m=0,++f,++w.D)),f===60?(p=u?[1317,10,29]:[1900,2,29],v=3):f===0?(p=u?[1317,8,29]:[1900,1,0],v=6):(60<f&&--f,(c=new Date(1900,0,1)).setDate(c.getDate()+f-1),p=[c.getFullYear(),c.getMonth()+1,c.getDate()],v=c.getDay(),f<60&&(v=(v+6)%7),u&&(v=function(S,b){return b[0]-=581,b=S.getDay(),S<60&&(b=(b+6)%7),b}(c,p))),w.y=p[0],w.m=p[1],w.d=p[2],w.S=m%60,m=Math.floor(m/60),w.M=m%60,m=Math.floor(m/60),w.H=m,w.q=v,w}var j=new Date(1899,11,31,0,0,0),X=j.getTime(),te=new Date(1900,2,1,0,0,0);function we(a,c){var u=a.getTime();return c?u-=1262304e5:te<=a&&(u+=864e5),(u-(X+6e4*(a.getTimezoneOffset()-j.getTimezoneOffset())))/864e5}function ce(a){return a.indexOf(".")==-1?a:a.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _e(a){var c,u,f,m=Math.floor(Math.log(Math.abs(a))*Math.LOG10E),v=-4<=m&&m<=-1?a.toPrecision(10+m):Math.abs(m)<=9?(u=(c=a)<0?12:11,(f=ce(c.toFixed(12))).length<=u||(f=c.toPrecision(10)).length<=u?f:c.toExponential(5)):m===10?a.toFixed(10).substr(0,12):(v=ce((a=a).toFixed(11))).length>(a<0?12:11)||v==="0"||v==="-0"?a.toPrecision(6):v;return ce((v=v.toUpperCase()).indexOf("E")==-1?v:v.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2"))}function Ee(a,c){switch(typeof a){case"string":return a;case"boolean":return a?"TRUE":"FALSE";case"number":return(0|a)===a?a.toString(10):_e(a);case"undefined":return"";case"object":if(a==null)return"";if(a instanceof Date)return Lr(14,we(a,c&&c.date1904),c)}throw new Error("unsupported value in General format: "+a)}function he(a){if(a.length<=3)return a;for(var c=a.length%3,u=a.substr(0,c);c!=a.length;c+=3)u+=(0<u.length?",":"")+a.substr(c,3);return u}var Ae=/%/g,Ne=/# (\?+)( ?)\/( ?)(\d+)/,Le=/^#*0*\.([0#]+)/,Xe=/\).*[0#]/,Ft=/\(###\) ###\\?-####/;function St(a){for(var c,u="",f=0;f!=a.length;++f)switch(c=a.charCodeAt(f)){case 35:break;case 63:u+=" ";break;case 48:u+="0";break;default:u+=String.fromCharCode(c)}return u}function zt(a,c){return c=Math.pow(10,c),""+Math.round(a*c)/c}function kr(f,c){var u=f-Math.floor(f),f=Math.pow(10,c);return c<(""+Math.round(u*f)).length?0:Math.round(u*f)}function xr(a,c,u){if(a.charCodeAt(0)===40&&!c.match(Xe)){var f=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?xr("n",f,u):"("+xr("n",f,-u)+")"}if(c.charCodeAt(c.length-1)===44)return function(W,J,ne){for(var se=J.length-1;J.charCodeAt(se-1)===44;)--se;return hr(W,J.substr(0,se),ne/Math.pow(10,3*(J.length-se)))}(a,c,u);if(c.indexOf("%")!==-1)return w=a,b=u,S=(T=c).replace(Ae,""),T=T.length-S.length,hr(w,S,b*Math.pow(10,2*T))+Ye("%",T);var m;if(c.indexOf("E")!==-1)return function W(J,ne){var se,be=J.indexOf("E")-J.indexOf(".")-1;if(J.match(/^#+0.0E\+0$/)){if(ne==0)return"0.0E+0";if(ne<0)return"-"+W(J,-ne);var De=J.indexOf(".");De===-1&&(De=J.indexOf("E"));var Pe=Math.floor(Math.log(ne)*Math.LOG10E)%De;if(Pe<0&&(Pe+=De),(se=(ne/Math.pow(10,Pe)).toPrecision(1+be+(De+Pe)%De)).indexOf("e")===-1){var je=Math.floor(Math.log(ne)*Math.LOG10E);for(se.indexOf(".")===-1?se=se.charAt(0)+"."+se.substr(1)+"E+"+(je-se.length+Pe):se+="E+"+(je-Pe);se.substr(0,2)==="0.";)se=(se=se.charAt(0)+se.substr(2,De)+"."+se.substr(2+De)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");se=se.replace(/\+-/,"-")}se=se.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(it,st,Ke,yt){return st+Ke+yt.substr(0,(De+Pe)%De)+"."+yt.substr(Pe)+"E"})}else se=ne.toExponential(be);return J.match(/E\+00$/)&&se.match(/e[+-]\d$/)&&(se=se.substr(0,se.length-1)+"0"+se.charAt(se.length-1)),(se=J.match(/E\-/)&&se.match(/e\+/)?se.replace(/e\+/,"e"):se).replace("e","E")}(c,u);if(c.charCodeAt(0)===36)return"$"+xr(a,c.substr(c.charAt(1)==" "?2:1),u);var v,p,w,S,b,T,P,M=Math.abs(u),N=u<0?"-":"";if(c.match(/^00+$/))return N+A(M,c.length);if(c.match(/^[#?]+$/))return(m=(m=A(u,0))==="0"?"":m).length>c.length?m:St(c.substr(0,c.length-m.length))+m;if(v=c.match(Ne))return P=v,w=M,S=N,b=parseInt(P[4],10),T=Math.round(w*b),w=Math.floor(T/b),S+(w===0?"":""+w)+" "+((T-=w*b)==0?Ye(" ",P[1].length+1+P[4].length):Ue(T,P[1].length)+P[2]+"/"+P[3]+ct(b,P[4].length));if(c.match(/^#+0+$/))return N+A(M,c.length-c.indexOf("0"));if(v=c.match(Le))return m=zt(u,v[1].length).replace(/^([^\.]+)$/,"$1."+St(v[1])).replace(/\.$/,"."+St(v[1])).replace(/\.(\d*)$/,function(W,J){return"."+J+Ye("0",St(v[1]).length-J.length)}),c.indexOf("0.")!==-1?m:m.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),v=c.match(/^(0*)\.(#*)$/))return N+zt(M,v[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,v[1].length?"0.":".");if(v=c.match(/^#{1,3},##0(\.?)$/))return N+he(A(M,0));if(v=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+xr(a,c,-u):he(""+(Math.floor(u)+(P=u,(U=v[1].length)<(""+Math.round((P-Math.floor(P))*Math.pow(10,U))).length?1:0)))+"."+ct(kr(u,v[1].length),v[1].length);if(v=c.match(/^#,#*,#0/))return xr(a,c.replace(/^#,#*,/,""),u);if(v=c.match(/^([0#]+)(\\?-([0#]+))+$/))return m=Ct(xr(a,c.replace(/[\\-]/g,""),u)),p=0,Ct(Ct(c.replace(/\\/g,"")).replace(/[0#]/g,function(W){return p<m.length?m.charAt(p++):W==="0"?"0":""}));if(c.match(Ft))return"("+(m=xr(a,"##########",u)).substr(0,3)+") "+m.substr(3,3)+"-"+m.substr(6);var U="";if(v=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(v[4].length,7),B=pe(M,Math.pow(10,p)-1,!1),m=N,(U=hr("n",v[1],B[1])).charAt(U.length-1)==" "&&(U=U.substr(0,U.length-1)+"0"),m+=U+v[2]+"/"+v[3],(U=Je(B[2],p)).length<v[4].length&&(U=St(v[4].substr(v[4].length-U.length))+U),m+=U;if(v=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return p=Math.min(Math.max(v[1].length,v[4].length),7),N+((B=pe(M,Math.pow(10,p)-1,!0))[0]||(B[1]?"":"0"))+" "+(B[1]?Ue(B[1],p)+v[2]+"/"+v[3]+Je(B[2],p):Ye(" ",2*p+1+v[2].length+v[3].length));if(v=c.match(/^[#0?]+$/))return m=A(u,0),c.length<=m.length?m:St(c.substr(0,c.length-m.length))+m;if(v=c.match(/^([#0?]+)\.([#0]+)$/)){m=""+u.toFixed(Math.min(v[2].length,10)).replace(/([^0])0+$/,"$1"),p=m.indexOf(".");var B=c.indexOf(".")-p,Z=c.length-m.length-B;return St(c.substr(0,B)+m+c.substr(c.length-Z))}if(v=c.match(/^00,000\.([#0]*0)$/))return p=kr(u,v[1].length),u<0?"-"+xr(a,c,-u):he((Z=u)<2147483647&&-2147483648<Z?""+(0<=Z?0|Z:Z-1|0):""+Math.floor(Z)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(W){return"00,"+(W.length<3?ct(0,3-W.length):"")+W})+"."+ct(p,v[1].length);switch(c){case"###,##0.00":return xr(a,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var G=he(A(M,0));return G!=="0"?N+G:"";case"###,###.00":return xr(a,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return xr(a,"#,##0.00",u).replace(/^0\./,".")}throw new Error("unsupported format |"+c+"|")}function ir(a,c,u){if(a.charCodeAt(0)===40&&!c.match(Xe)){var f=c.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=u?ir("n",f,u):"("+ir("n",f,-u)+")"}if(c.charCodeAt(c.length-1)===44)return function(B,Z,G){for(var W=Z.length-1;Z.charCodeAt(W-1)===44;)--W;return hr(B,Z.substr(0,W),G/Math.pow(10,3*(Z.length-W)))}(a,c,u);if(c.indexOf("%")!==-1)return m=a,p=u,f=(v=c).replace(Ae,""),v=v.length-f.length,hr(m,f,p*Math.pow(10,2*v))+Ye("%",v);var m,v,p,w;if(c.indexOf("E")!==-1)return function B(Z,G){var W,J=Z.indexOf("E")-Z.indexOf(".")-1;if(Z.match(/^#+0.0E\+0$/)){if(G==0)return"0.0E+0";if(G<0)return"-"+B(Z,-G);var ne=Z.indexOf(".");ne===-1&&(ne=Z.indexOf("E"));var se,be=Math.floor(Math.log(G)*Math.LOG10E)%ne;be<0&&(be+=ne),(W=(G/Math.pow(10,be)).toPrecision(1+J+(ne+be)%ne)).match(/[Ee]/)||(se=Math.floor(Math.log(G)*Math.LOG10E),W.indexOf(".")===-1?W=W.charAt(0)+"."+W.substr(1)+"E+"+(se-W.length+be):W+="E+"+(se-be),W=W.replace(/\+-/,"-")),W=W.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(De,Pe,je,it){return Pe+je+it.substr(0,(ne+be)%ne)+"."+it.substr(be)+"E"})}else W=G.toExponential(J);return Z.match(/E\+00$/)&&W.match(/e[+-]\d$/)&&(W=W.substr(0,W.length-1)+"0"+W.charAt(W.length-1)),(W=Z.match(/E\-/)&&W.match(/e\+/)?W.replace(/e\+/,"e"):W).replace("e","E")}(c,u);if(c.charCodeAt(0)===36)return"$"+ir(a,c.substr(c.charAt(1)==" "?2:1),u);var S,b,T=Math.abs(u),P=u<0?"-":"";if(c.match(/^00+$/))return P+ct(T,c.length);if(c.match(/^[#?]+$/))return(w=u===0?"":""+u).length>c.length?w:St(c.substr(0,c.length-w.length))+w;if(S=c.match(Ne))return P+((M=T)===0?"":""+M)+Ye(" ",(M=S)[1].length+2+M[4].length);if(c.match(/^#+0+$/))return P+ct(T,c.length-c.indexOf("0"));if(S=c.match(Le))return w=(w=(""+u).replace(/^([^\.]+)$/,"$1."+St(S[1])).replace(/\.$/,"."+St(S[1]))).replace(/\.(\d*)$/,function(B,Z){return"."+Z+Ye("0",St(S[1]).length-Z.length)}),c.indexOf("0.")!==-1?w:w.replace(/^0\./,".");if(c=c.replace(/^#+([0.])/,"$1"),S=c.match(/^(0*)\.(#*)$/))return P+(""+T).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,S[1].length?"0.":".");if(S=c.match(/^#{1,3},##0(\.?)$/))return P+he(""+T);if(S=c.match(/^#,##0\.([#0]*0)$/))return u<0?"-"+ir(a,c,-u):he(""+u)+"."+Ye("0",S[1].length);if(S=c.match(/^#,#*,#0/))return ir(a,c.replace(/^#,#*,/,""),u);if(S=c.match(/^([0#]+)(\\?-([0#]+))+$/))return w=Ct(ir(a,c.replace(/[\\-]/g,""),u)),b=0,Ct(Ct(c.replace(/\\/g,"")).replace(/[0#]/g,function(B){return b<w.length?w.charAt(b++):B==="0"?"0":""}));if(c.match(Ft))return"("+(w=ir(a,"##########",u)).substr(0,3)+") "+w.substr(3,3)+"-"+w.substr(6);var M="";if(S=c.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(S[4].length,7),N=pe(T,Math.pow(10,b)-1,!1),w=P,(M=hr("n",S[1],N[1])).charAt(M.length-1)==" "&&(M=M.substr(0,M.length-1)+"0"),w+=M+S[2]+"/"+S[3],(M=Je(N[2],b)).length<S[4].length&&(M=St(S[4].substr(S[4].length-M.length))+M),w+=M;if(S=c.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return b=Math.min(Math.max(S[1].length,S[4].length),7),P+((N=pe(T,Math.pow(10,b)-1,!0))[0]||(N[1]?"":"0"))+" "+(N[1]?Ue(N[1],b)+S[2]+"/"+S[3]+Je(N[2],b):Ye(" ",2*b+1+S[2].length+S[3].length));if(S=c.match(/^[#0?]+$/))return w=""+u,c.length<=w.length?w:St(c.substr(0,c.length-w.length))+w;if(S=c.match(/^([#0]+)\.([#0]+)$/)){w=""+u.toFixed(Math.min(S[2].length,10)).replace(/([^0])0+$/,"$1"),b=w.indexOf(".");var M=c.indexOf(".")-b,N=c.length-w.length-M;return St(c.substr(0,M)+w+c.substr(c.length-N))}if(S=c.match(/^00,000\.([#0]*0)$/))return u<0?"-"+ir(a,c,-u):he(""+u).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(B){return"00,"+(B.length<3?ct(0,3-B.length):"")+B})+"."+ct(0,S[1].length);switch(c){case"###,###":case"##,###":case"#,###":var U=he(""+T);return U!=="0"?P+U:"";default:if(c.match(/\.[0#?]*$/))return ir(a,c.slice(0,c.lastIndexOf(".")),u)+St(c.slice(c.lastIndexOf(".")))}throw new Error("unsupported format |"+c+"|")}function hr(a,c,u){return((0|u)===u?ir:xr)(a,c,u)}var Hn=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xi(a){for(var c=0,u="",f="";c<a.length;)switch(u=a.charAt(c)){case"G":O(a,c)&&(c+=6),c++;break;case'"':for(;a.charCodeAt(++c)!==34&&c<a.length;);++c;break;case"\\":case"_":c+=2;break;case"@":++c;break;case"B":case"b":if(a.charAt(c+1)==="1"||a.charAt(c+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(a.substr(c,3).toUpperCase()==="A/P"||a.substr(c,5).toUpperCase()==="AM/PM"||a.substr(c,5).toUpperCase()==="/")return!0;++c;break;case"[":for(f=u;a.charAt(c++)!=="]"&&c<a.length;)f+=a.charAt(c);if(f.match(Hn))return!0;break;case".":case"0":case"#":for(;c<a.length&&(-1<"0#?.,E+-%".indexOf(u=a.charAt(++c))||u=="\\"&&a.charAt(c+1)=="-"&&-1<"0#".indexOf(a.charAt(c+2))););break;case"?":for(;a.charAt(++c)===u;);break;case"*":++c,a.charAt(c)!=" "&&a.charAt(c)!="*"||++c;break;case"(":case")":++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;c<a.length&&-1<"0123456789".indexOf(a.charAt(++c)););break;case" ":default:++c}return!1}function qs(a,c,u,f){for(var m,v,p,w=[],S="",b=0,T="",P="t",M="H";b<a.length;)switch(T=a.charAt(b)){case"G":if(!O(a,b))throw new Error("unrecognized character "+T+" in "+a);w[w.length]={t:"G",v:"General"},b+=7;break;case'"':for(S="";(p=a.charCodeAt(++b))!==34&&b<a.length;)S+=String.fromCharCode(p);w[w.length]={t:"t",v:S},++b;break;case"\\":var N=a.charAt(++b),U=N==="("||N===")"?N:"t";w[w.length]={t:U,v:N},++b;break;case"_":w[w.length]={t:"t",v:" "},b+=2;break;case"@":w[w.length]={t:"T",v:c},++b;break;case"B":case"b":if(a.charAt(b+1)==="1"||a.charAt(b+1)==="2"){if(m==null&&(m=ye(c,u,a.charAt(b+1)==="2"))==null)return"";w[w.length]={t:"X",v:a.substr(b,2)},P=T,b+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(c<0||m==null&&(m=ye(c,u))==null)return"";for(S=T;++b<a.length&&a.charAt(b).toLowerCase()===T;)S+=T;(T=T==="m"&&P.toLowerCase()==="h"?"M":T)==="h"&&(T=M),w[w.length]={t:T,v:S},P=T;break;case"A":case"a":case"":if(N={t:T,v:T},m==null&&(m=ye(c,u)),a.substr(b,3).toUpperCase()==="A/P"?(m!=null&&(N.v=12<=m.H?"P":"A"),N.t="T",M="h",b+=3):a.substr(b,5).toUpperCase()==="AM/PM"?(m!=null&&(N.v=12<=m.H?"PM":"AM"),N.t="T",b+=5,M="h"):a.substr(b,5).toUpperCase()==="/"?(m!=null&&(N.v=12<=m.H?"":""),N.t="T",b+=5,M="h"):(N.t="t",++b),m==null&&N.t==="T")return"";w[w.length]=N,P=T;break;case"[":for(S=T;a.charAt(b++)!=="]"&&b<a.length;)S+=a.charAt(b);if(S.slice(-1)!=="]")throw'unterminated "[" block: |'+S+"|";if(S.match(Hn)){if(m==null&&(m=ye(c,u))==null)return"";w[w.length]={t:"Z",v:S.toLowerCase()},P=S.charAt(1)}else-1<S.indexOf("$")&&(S=(S.match(/\$([^-\[\]]*)/)||[])[1]||"$",xi(a)||(w[w.length]={t:"t",v:S}));break;case".":if(m!=null){for(S=T;++b<a.length&&(T=a.charAt(b))==="0";)S+=T;w[w.length]={t:"s",v:S};break}case"0":case"#":for(S=T;++b<a.length&&-1<"0#?.,E+-%".indexOf(T=a.charAt(b));)S+=T;w[w.length]={t:"n",v:S};break;case"?":for(S=T;a.charAt(++b)===T;)S+=T;w[w.length]={t:T,v:S},P=T;break;case"*":++b,a.charAt(b)!=" "&&a.charAt(b)!="*"||++b;break;case"(":case")":w[w.length]={t:f===1?"t":T,v:T},++b;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(S=T;b<a.length&&-1<"0123456789".indexOf(a.charAt(++b));)S+=a.charAt(b);w[w.length]={t:"D",v:S};break;case" ":w[w.length]={t:T,v:T},++b;break;case"$":w[w.length]={t:"t",v:"$"},++b;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+a);w[w.length]={t:"t",v:T},++b}var B,Z=0,G=0;for(b=w.length-1,P="t";0<=b;--b)switch(w[b].t){case"h":case"H":w[b].t=M,P="h",Z<1&&(Z=1);break;case"s":(B=w[b].v.match(/\.0+$/))&&(G=Math.max(G,B[0].length-1)),Z<3&&(Z=3);case"d":case"y":case"M":case"e":P=w[b].t;break;case"m":P==="s"&&(w[b].t="M",Z<2&&(Z=2));break;case"X":break;case"Z":(Z=(Z=Z<1&&w[b].v.match(/[Hh]/)?1:Z)<2&&w[b].v.match(/[Mm]/)?2:Z)<3&&w[b].v.match(/[Ss]/)&&(Z=3)}switch(Z){case 0:break;case 1:.5<=m.u&&(m.u=0,++m.S),60<=m.S&&(m.S=0,++m.M),60<=m.M&&(m.M=0,++m.H);break;case 2:.5<=m.u&&(m.u=0,++m.S),60<=m.S&&(m.S=0,++m.M)}var W,J="";for(b=0;b<w.length;++b)switch(w[b].t){case"t":case"T":case" ":case"D":break;case"X":w[b].v="",w[b].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":w[b].v=function(it,st,Ke,yt){var Wt,Ht="",At=0,Pt=0,Tt=Ke.y,ft=0;switch(it){case 98:Tt=Ke.y+543;case 121:switch(st.length){case 1:case 2:Wt=Tt%100,ft=2;break;default:Wt=Tt%1e4,ft=4}break;case 109:switch(st.length){case 1:case 2:Wt=Ke.m,ft=st.length;break;case 3:return L[Ke.m-1][1];case 5:return L[Ke.m-1][0];default:return L[Ke.m-1][2]}break;case 100:switch(st.length){case 1:case 2:Wt=Ke.d,ft=st.length;break;case 3:return k[Ke.q][0];default:return k[Ke.q][1]}break;case 104:switch(st.length){case 1:case 2:Wt=1+(Ke.H+11)%12,ft=st.length;break;default:throw"bad hour format: "+st}break;case 72:switch(st.length){case 1:case 2:Wt=Ke.H,ft=st.length;break;default:throw"bad hour format: "+st}break;case 77:switch(st.length){case 1:case 2:Wt=Ke.M,ft=st.length;break;default:throw"bad minute format: "+st}break;case 115:if(st!="s"&&st!="ss"&&st!=".0"&&st!=".00"&&st!=".000")throw"bad second format: "+st;return Ke.u!==0||st!="s"&&st!="ss"?(60*(Pt=2<=yt?yt===3?1e3:100:yt===1?10:1)<=(At=Math.round(Pt*(Ke.S+Ke.u)))&&(At=0),st==="s"?At===0?"0":""+At/Pt:(Ht=ct(At,2+yt),st==="ss"?Ht.substr(0,2):"."+Ht.substr(2,st.length-1))):ct(Ke.S,st.length);case 90:switch(st){case"[h]":case"[hh]":Wt=24*Ke.D+Ke.H;break;case"[m]":case"[mm]":Wt=60*(24*Ke.D+Ke.H)+Ke.M;break;case"[s]":case"[ss]":Wt=60*(60*(24*Ke.D+Ke.H)+Ke.M)+Math.round(Ke.S+Ke.u);break;default:throw"bad abstime format: "+st}ft=st.length===3?1:2;break;case 101:Wt=Tt,ft=1}return 0<ft?ct(Wt,ft):""}(w[b].t.charCodeAt(0),w[b].v,m,G),w[b].t="t";break;case"n":case"?":for(W=b+1;w[W]!=null&&((T=w[W].t)==="?"||T==="D"||(T===" "||T==="t")&&w[W+1]!=null&&(w[W+1].t==="?"||w[W+1].t==="t"&&w[W+1].v==="/")||w[b].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(w[W].v==="/"||w[W].v===" "&&w[W+1]!=null&&w[W+1].t=="?"));)w[b].v+=w[W].v,w[W]={v:"",t:";"},++W;J+=w[b].v,b=W-1;break;case"G":w[b].t="t",w[b].v=Ee(c,u)}var ne,se,be="";if(0<J.length){J.charCodeAt(0)==40?(ne=c<0&&J.charCodeAt(0)===45?-c:c,se=hr("n",J,ne)):(se=hr("n",J,ne=c<0&&1<f?-c:c),ne<0&&w[0]&&w[0].t=="t"&&(se=se.substr(1),w[0].v="-"+w[0].v)),W=se.length-1;for(var De=w.length,b=0;b<w.length;++b)if(w[b]!=null&&w[b].t!="t"&&-1<w[b].v.indexOf(".")){De=b;break}var Pe=w.length;if(De===w.length&&se.indexOf("E")===-1){for(b=w.length-1;0<=b;--b)w[b]!=null&&"n?".indexOf(w[b].t)!==-1&&(W>=w[b].v.length-1?(W-=w[b].v.length,w[b].v=se.substr(W+1,w[b].v.length)):W<0?w[b].v="":(w[b].v=se.substr(0,W+1),W=-1),w[b].t="t",Pe=b);0<=W&&Pe<w.length&&(w[Pe].v=se.substr(0,W+1)+w[Pe].v)}else if(De!==w.length&&se.indexOf("E")===-1){for(W=se.indexOf(".")-1,b=De;0<=b;--b)if(w[b]!=null&&"n?".indexOf(w[b].t)!==-1){for(v=-1<w[b].v.indexOf(".")&&b===De?w[b].v.indexOf(".")-1:w[b].v.length-1,be=w[b].v.substr(v+1);0<=v;--v)0<=W&&(w[b].v.charAt(v)==="0"||w[b].v.charAt(v)==="#")&&(be=se.charAt(W--)+be);w[b].v=be,w[b].t="t",Pe=b}for(0<=W&&Pe<w.length&&(w[Pe].v=se.substr(0,W+1)+w[Pe].v),W=se.indexOf(".")+1,b=De;b<w.length;++b)if(w[b]!=null&&("n?(".indexOf(w[b].t)!==-1||b===De)){for(v=-1<w[b].v.indexOf(".")&&b===De?w[b].v.indexOf(".")+1:0,be=w[b].v.substr(0,v);v<w[b].v.length;++v)W<se.length&&(be+=se.charAt(W++));w[b].v=be,w[b].t="t",Pe=b}}}for(b=0;b<w.length;++b)w[b]!=null&&-1<"n?".indexOf(w[b].t)&&(ne=1<f&&c<0&&0<b&&w[b-1].v==="-"?-c:c,w[b].v=hr(w[b].t,w[b].v,ne),w[b].t="t");var je="";for(b=0;b!==w.length;++b)w[b]!=null&&(je+=w[b].v);return je}var oi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Jn(a,c){if(c!=null){var u=parseFloat(c[2]);switch(c[1]){case"=":if(a==u)return 1;break;case">":if(u<a)return 1;break;case"<":if(a<u)return 1;break;case"<>":if(a!=u)return 1;break;case">=":if(u<=a)return 1;break;case"<=":if(a<=u)return 1}}}function $n(a,c){var u=function(p){for(var w=[],S=!1,b=0,T=0;b<p.length;++b)switch(p.charCodeAt(b)){case 34:S=!S;break;case 95:case 42:case 92:++b;break;case 59:w[w.length]=p.substr(T,b-T),T=b+1}if(w[w.length]=p.substr(T),S===!0)throw new Error("Format |"+p+"| unterminated string ");return w}(a),f=u.length,m=u[f-1].indexOf("@");if(f<4&&-1<m&&--f,4<u.length)throw new Error("cannot find right format for |"+u.join("|")+"|");if(typeof c!="number")return[4,u.length===4||-1<m?u[u.length-1]:"@"];switch(u.length){case 1:u=-1<m?["General","General","General",u[0]]:[u[0],u[0],u[0],"@"];break;case 2:u=-1<m?[u[0],u[0],u[0],u[1]]:[u[0],u[1],u[0],"@"];break;case 3:u=-1<m?[u[0],u[1],u[0],u[2]]:[u[0],u[1],u[2],"@"]}var v=0<c?u[0]:c<0?u[1]:u[2];return u[0].indexOf("[")===-1&&u[1].indexOf("[")===-1?[f,v]:u[0].match(/\[[=<>]/)==null&&u[1].match(/\[[=<>]/)==null?[f,v]:(a=u[0].match(oi),v=u[1].match(oi),Jn(c,a)?[f,u[0]]:Jn(c,v)?[f,u[1]]:[f,u[a!=null&&v!=null?2:1]])}function Lr(a,c,u){u==null&&(u={});var f="";switch(typeof a){case"string":f=a=="m/d/yy"&&u.dateNF?u.dateNF:a;break;case"number":(f=(f=a==14&&u.dateNF?u.dateNF:(u.table!=null?u.table:D)[a])==null?u.table&&u.table[K[a]]||D[K[a]]:f)==null&&(f=Q[a]||"General")}if(O(f,0))return Ee(c,u);var m=$n(f,c=c instanceof Date?we(c,u.date1904):c);if(O(m[1]))return Ee(c,u);if(c===!0)c="TRUE";else if(c===!1)c="FALSE";else if(c===""||c==null)return"";return qs(m[1],c,u,m[0])}function Nr(a,c){if(typeof c!="number"){c=+c||-1;for(var u=0;u<392;++u)if(D[u]!=null){if(D[u]==a){c=u;break}}else c<0&&(c=u);c<0&&(c=391)}return D[c]=a,c}function Ve(a){for(var c=0;c!=392;++c)a[c]!==void 0&&Nr(a[c],c)}function ot(){var a;(a=a||{})[0]="General",a[1]="0",a[2]="0.00",a[3]="#,##0",a[4]="#,##0.00",a[9]="0%",a[10]="0.00%",a[11]="0.00E+00",a[12]="# ?/?",a[13]="# ??/??",a[14]="m/d/yy",a[15]="d-mmm-yy",a[16]="d-mmm",a[17]="mmm-yy",a[18]="h:mm AM/PM",a[19]="h:mm:ss AM/PM",a[20]="h:mm",a[21]="h:mm:ss",a[22]="m/d/yy h:mm",a[37]="#,##0 ;(#,##0)",a[38]="#,##0 ;[Red](#,##0)",a[39]="#,##0.00;(#,##0.00)",a[40]="#,##0.00;[Red](#,##0.00)",a[45]="mm:ss",a[46]="[h]:mm:ss",a[47]="mmss.0",a[48]="##0.0E+0",a[49]="@",a[56]='"/ "hh""mm""ss" "',D=a}var It={format:Lr,load:Nr,_table:D,load_table:Ve,parse_date_code:ye,is_date:xi,get_table:function(){return It._table=D}},ar={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Oi=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,Ur,Bo=function(){var a={};a.version="1.2.0";var c=function(){for(var W=0,J=new Array(256),ne=0;ne!=256;++ne)W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=1&(W=ne)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1)?-306674912^W>>>1:W>>>1,J[ne]=W;return typeof Int32Array<"u"?new Int32Array(J):J}(),u=function(W){for(var J=0,ne=0,be=0,se=new(typeof Int32Array<"u"?Int32Array:Array)(4096),be=0;be!=256;++be)se[be]=W[be];for(be=0;be!=256;++be)for(ne=W[be],J=256+be;J<4096;J+=256)ne=se[J]=ne>>>8^W[255&ne];var De=[];for(be=1;be!=16;++be)De[be-1]=typeof Int32Array<"u"?se.subarray(256*be,256*be+256):se.slice(256*be,256*be+256);return De}(c),f=u[0],m=u[1],v=u[2],p=u[3],w=u[4],S=u[5],b=u[6],T=u[7],P=u[8],M=u[9],N=u[10],U=u[11],B=u[12],Z=u[13],G=u[14];return a.table=c,a.bstr=function(W,J){for(var ne=-1^J,se=0,be=W.length;se<be;)ne=ne>>>8^c[255&(ne^W.charCodeAt(se++))];return~ne},a.buf=function(W,J){for(var ne=-1^J,se=W.length-15,be=0;be<se;)ne=G[W[be++]^255&ne]^Z[W[be++]^ne>>8&255]^B[W[be++]^ne>>16&255]^U[W[be++]^ne>>>24]^N[W[be++]]^M[W[be++]]^P[W[be++]]^T[W[be++]]^b[W[be++]]^S[W[be++]]^w[W[be++]]^p[W[be++]]^v[W[be++]]^m[W[be++]]^f[W[be++]]^c[W[be++]];for(se+=15;be<se;)ne=ne>>>8^c[255&(ne^W[be++])];return~ne},a.str=function(W,J){for(var ne,se=-1^J,be=0,De=W.length,Pe=0;be<De;)se=(Pe=W.charCodeAt(be++))<128?se>>>8^c[255&(se^Pe)]:Pe<2048?(se=se>>>8^c[255&(se^(192|Pe>>6&31))])>>>8^c[255&(se^(128|63&Pe))]:55296<=Pe&&Pe<57344?(Pe=64+(1023&Pe),ne=1023&W.charCodeAt(be++),(se=(se=(se=se>>>8^c[255&(se^(240|Pe>>8&7))])>>>8^c[255&(se^(128|Pe>>2&63))])>>>8^c[255&(se^(128|ne>>6&15|(3&Pe)<<4))])>>>8^c[255&(se^(128|63&ne))]):(se=(se=se>>>8^c[255&(se^(224|Pe>>12&15))])>>>8^c[255&(se^(128|Pe>>6&63))])>>>8^c[255&(se^(128|63&Pe))];return~se},a}(),Zt=function(){var a,c={};function u(fe){if(fe.charAt(fe.length-1)=="/")return fe.slice(0,-1).indexOf("/")===-1?fe:u(fe.slice(0,-1));var qe=fe.lastIndexOf("/");return qe===-1?fe:fe.slice(0,qe+1)}function f(fe){if(fe.charAt(fe.length-1)=="/")return f(fe.slice(0,-1));var qe=fe.lastIndexOf("/");return qe===-1?fe:fe.slice(qe+1)}function m(fe){Zs(fe,0);for(var qe,Se={};fe.l<=fe.length-4;){var ze=fe.read_shift(2),Ce=fe.read_shift(2),gt=fe.l+Ce,Ge={};ze===21589&&(1&(qe=fe.read_shift(1))&&(Ge.mtime=fe.read_shift(4)),5<Ce&&(2&qe&&(Ge.atime=fe.read_shift(4)),4&qe&&(Ge.ctime=fe.read_shift(4))),Ge.mtime&&(Ge.mt=new Date(1e3*Ge.mtime))),fe.l=gt,Se[ze]=Ge}return Se}function v(){return a=a||w4}function p(fe,qe){if(fe[0]==80&&fe[1]==75)return Tn(fe,qe);if((32|fe[0])==109&&(32|fe[1])==105)return function(Et,mr){if(W(Et.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Kt=mr&&mr.root||"",Ot=(q&&Buffer.isBuffer(Et)?Et.toString("binary"):W(Et)).split(`\r
`),Sr=0,br="";for(Sr=0;Sr<Ot.length;++Sr)if(br=Ot[Sr],/^Content-Location:/i.test(br)&&(br=br.slice(br.indexOf("file")),Kt=Kt||br.slice(0,br.lastIndexOf("/")+1),br.slice(0,Kt.length)!=Kt))for(;0<Kt.length&&(Kt=(Kt=Kt.slice(0,Kt.length-1)).slice(0,Kt.lastIndexOf("/")+1),br.slice(0,Kt.length)!=Kt););if(Et=(Ot[1]||"").match(/boundary="(.*?)"/),!Et)throw new Error("MAD cannot find boundary");var ni="--"+(Et[1]||""),Ar={FileIndex:[],FullPaths:[]};S(Ar);var Vr,ur=0;for(Sr=0;Sr<Ot.length;++Sr){var nn=Ot[Sr];nn!==ni&&nn!==ni+"--"||(ur++&&function(an,jt,tr){for(var Jt,Yr="",xn="",Rs="",Hs=0;Hs<10;++Hs){var fs=jt[Hs];if(!fs||fs.match(/^\s*$/))break;var bo=fs.match(/^(.*?):\s*([^\s].*)$/);if(bo)switch(bo[1].toLowerCase()){case"content-location":Yr=bo[2].trim();break;case"content-type":Rs=bo[2].trim();break;case"content-transfer-encoding":xn=bo[2].trim()}}switch(++Hs,xn.toLowerCase()){case"base64":Jt=me(z(jt.slice(Hs).join("")));break;case"quoted-printable":Jt=function(xo){for(var i0=[],Uo=0;Uo<xo.length;++Uo){for(var ah=xo[Uo];Uo<=xo.length&&ah.charAt(ah.length-1)=="=";)ah=ah.slice(0,ah.length-1)+xo[++Uo];i0.push(ah)}for(var s0=0;s0<i0.length;++s0)i0[s0]=i0[s0].replace(/[=][0-9A-Fa-f]{2}/g,function(Zie){return String.fromCharCode(parseInt(Zie.slice(1),16))});return me(i0.join(`\r
`))}(jt.slice(Hs));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+xn)}tr=Cl(an,Yr.slice(tr.length),Jt,{unsafe:!0}),Rs&&(tr.ctype=Rs)}(Ar,Ot.slice(Vr,Sr),Kt),Vr=Sr)}return Ar}(fe,qe);if(fe.length<512)throw new Error("CFB file size "+fe.length+" < 512");var Se,ze,Ce,gt=3,Ge=512,Mt=0,Ze=[],We=fe.slice(0,512);Zs(We,0);var nt=function(Et){if(Et[Et.l]==80&&Et[Et.l+1]==75)return[0,0];Et.chk(U,"Header Signature: "),Et.l+=16;var mr=Et.read_shift(2,"u");return[Et.read_shift(2,"u"),mr]}(We);switch(gt=nt[0]){case 3:Ge=512;break;case 4:Ge=4096;break;case 0:if(nt[1]==0)return Tn(fe,qe);default:throw new Error("Major Version: Expected 3 or 4 saw "+gt)}Ge!==512&&Zs(We=fe.slice(0,Ge),28);var xt=fe.slice(0,Ge);(function(Et,mr){var Kt=9;switch(Et.l+=2,Kt=Et.read_shift(2)){case 9:if(mr!=3)throw new Error("Sector Shift: Expected 9 saw "+Kt);break;case 12:if(mr!=4)throw new Error("Sector Shift: Expected 12 saw "+Kt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Kt)}Et.chk("0600","Mini Sector Shift: "),Et.chk("000000000000","Reserved: ")})(We,gt);var fr=We.read_shift(4,"i");if(gt===3&&fr!==0)throw new Error("# Directory Sectors: Expected 0 saw "+fr);We.l+=4,ze=We.read_shift(4,"i"),We.l+=4,We.chk("00100000","Mini Stream Cutoff Size: "),Ce=We.read_shift(4,"i"),Se=We.read_shift(4,"i"),dr=We.read_shift(4,"i"),Mt=We.read_shift(4,"i");for(var cr,qt=0;qt<109&&!((cr=We.read_shift(4,"i"))<0);++qt)Ze[qt]=cr;var $t=function(Et,mr){for(var Kt=Math.ceil(Et.length/mr)-1,Ot=[],Sr=1;Sr<Kt;++Sr)Ot[Sr-1]=Et.slice(Sr*mr,(Sr+1)*mr);return Ot[Kt-1]=Et.slice(Kt*mr),Ot}(fe,Ge);(function Et(mr,Kt,Ot,Sr,br){var ni=N;if(mr===N){if(Kt!==0)throw new Error("DIFAT chain shorter than expected")}else if(mr!==-1){var Ar=Ot[mr],Vr=(Sr>>>2)-1;if(Ar){for(var ur=0;ur<Vr&&(ni=zd(Ar,4*ur))!==N;++ur)br.push(ni);Et(zd(Ar,Sr-4),Kt-1,Ot,Sr,br)}}})(dr,Mt,$t,Ge,Ze);var er=function(Et,mr,Kt,Ot){var Sr=Et.length,br=[],ni=[],Ar=[],Vr=[],ur=Ot-1,nn=0,an=0,jt=0,tr=0;for(nn=0;nn<Sr;++nn)if(Ar=[],Sr<=(jt=nn+mr)&&(jt-=Sr),!ni[jt]){Vr=[];var Jt=[];for(an=jt;0<=an;){Jt[an]=!0,ni[an]=!0,Ar[Ar.length]=an,Vr.push(Et[an]);var Yr=Kt[Math.floor(4*an/Ot)];if(Ot<4+(tr=4*an&ur))throw new Error("FAT boundary crossed: "+an+" 4 "+Ot);if(!Et[Yr]||(an=zd(Et[Yr],tr),Jt[an]))break}br[jt]={nodes:Ar,data:O5([Vr])}}return br}($t,ze,Ze,Ge);er[ze].name="!Directory",0<Se&&Ce!==N&&(er[Ce].name="!MiniFAT"),er[Ze[0]].name="!FAT",er.fat_addrs=Ze,er.ssz=Ge;var fr=[],dr=[],Mt=[];return function(Et,mr,Kt,Ot,Sr,br,ni){for(var Ar,Vr=0,ur=Kt.length?2:0,nn=Et[ze].data,an=0,jt=0;an<nn.length;an+=128){var tr=nn.slice(an,an+128);Zs(tr,64),jt=tr.read_shift(2),Ar=bS(tr,0,jt-ur),Kt.push(Ar);var Jt={name:Ar,type:tr.read_shift(1),color:tr.read_shift(1),L:tr.read_shift(4,"i"),R:tr.read_shift(4,"i"),C:tr.read_shift(4,"i"),clsid:tr.read_shift(16),state:tr.read_shift(4,"i"),start:0,size:0};tr.read_shift(2)+tr.read_shift(2)+tr.read_shift(2)+tr.read_shift(2)!==0&&(Jt.ct=w(tr,tr.l-8)),tr.read_shift(2)+tr.read_shift(2)+tr.read_shift(2)+tr.read_shift(2)!==0&&(Jt.mt=w(tr,tr.l-8)),Jt.start=tr.read_shift(4,"i"),Jt.size=tr.read_shift(4,"i"),Jt.size<0&&Jt.start<0&&(Jt.size=Jt.type=0,Jt.start=N,Jt.name=""),Jt.type===5?(Vr=Jt.start,0<Ot&&Vr!==N&&(Et[Vr].name="!StreamData")):4096<=Jt.size?(Jt.storage="fat",Et[Jt.start]===void 0&&(Et[Jt.start]=function(Yr,xn,Rs,Hs,fs){var bo=[],xo=[];fs=fs||[];var i0=Hs-1,Uo=0,ah=0;for(Uo=xn;0<=Uo;){fs[Uo]=!0,bo[bo.length]=Uo,xo.push(Yr[Uo]);var s0=Rs[Math.floor(4*Uo/Hs)];if(Hs<4+(ah=4*Uo&i0))throw new Error("FAT boundary crossed: "+Uo+" 4 "+Hs);if(!Yr[s0])break;Uo=zd(Yr[s0],ah)}return{nodes:bo,data:O5([xo])}}(mr,Jt.start,Et.fat_addrs,Et.ssz)),Et[Jt.start].name=Jt.name,Jt.content=Et[Jt.start].data.slice(0,Jt.size)):(Jt.storage="minifat",Jt.size<0?Jt.size=0:Vr!==N&&Jt.start!==N&&Et[Vr]&&(Jt.content=function(Yr,xn,Rs){for(var Hs=Yr.start,fs=Yr.size,bo=[],xo=Hs;Rs&&0<fs&&0<=xo;)bo.push(xn.slice(xo*M,xo*M+M)),fs-=M,xo=zd(Rs,4*xo);return bo.length===0?tt(0):Be(bo).slice(0,Yr.size)}(Jt,Et[Vr].data,(Et[ni]||{}).data))),Jt.content&&Zs(Jt.content,0),Sr[Ar]=Jt,br.push(Jt)}}(er,$t,fr,Se,{},dr,Ce),function(Et,mr,Kt){for(var Ot=0,Sr=0,br=0,ni=0,Ar=0,Vr=Kt.length,ur=[],nn=[];Ot<Vr;++Ot)ur[Ot]=nn[Ot]=Ot,mr[Ot]=Kt[Ot];for(;Ar<nn.length;++Ar)Ot=nn[Ar],Sr=Et[Ot].L,br=Et[Ot].R,ni=Et[Ot].C,ur[Ot]===Ot&&(Sr!==-1&&ur[Sr]!==Sr&&(ur[Ot]=ur[Sr]),br!==-1&&ur[br]!==br&&(ur[Ot]=ur[br])),ni!==-1&&(ur[ni]=Ot),Sr!==-1&&Ot!=ur[Ot]&&(ur[Sr]=ur[Ot],nn.lastIndexOf(Sr)<Ar&&nn.push(Sr)),br!==-1&&Ot!=ur[Ot]&&(ur[br]=ur[Ot],nn.lastIndexOf(br)<Ar&&nn.push(br));for(Ot=1;Ot<Vr;++Ot)ur[Ot]===Ot&&(br!==-1&&ur[br]!==br?ur[Ot]=ur[br]:Sr!==-1&&ur[Sr]!==Sr&&(ur[Ot]=ur[Sr]));for(Ot=1;Ot<Vr;++Ot)if(Et[Ot].type!==0){if((Ar=Ot)!=ur[Ar])for(;Ar=ur[Ar],mr[Ot]=mr[Ar]+"/"+mr[Ot],Ar!==0&&ur[Ar]!==-1&&Ar!=ur[Ar];);ur[Ot]=-1}for(mr[0]+="/",Ot=1;Ot<Vr;++Ot)Et[Ot].type!==2&&(mr[Ot]+="/")}(dr,Mt,fr),fr.shift(),Mt={FileIndex:dr,FullPaths:Mt},qe&&qe.raw&&(Mt.raw={header:xt,sectors:$t}),Mt}function w(fe,qe){return new Date(1e3*(Ds(fe,qe+4)/1e7*Math.pow(2,32)+Ds(fe,qe)/1e7-11644473600))}function S(fe,ze){var Se=ze||{},ze=Se.root||"Root Entry";if(fe.FullPaths||(fe.FullPaths=[]),fe.FileIndex||(fe.FileIndex=[]),fe.FullPaths.length!==fe.FileIndex.length)throw new Error("inconsistent CFB structure");fe.FullPaths.length===0&&(fe.FullPaths[0]=ze+"/",fe.FileIndex[0]={name:ze,type:5}),Se.CLSID&&(fe.FileIndex[0].clsid=Se.CLSID),ze=fe,Se="Sh33tJ5",Zt.find(ze,"/"+Se)||((fe=tt(4))[0]=55,fe[1]=fe[3]=50,fe[2]=54,ze.FileIndex.push({name:Se,type:2,content:fe,size:4,L:69,R:69,C:69}),ze.FullPaths.push(ze.FullPaths[0]+Se),b(ze))}function b(fe,qe){S(fe);for(var Se=!1,ze=!1,Ce=fe.FullPaths.length-1;0<=Ce;--Ce){var gt=fe.FileIndex[Ce];switch(gt.type){case 0:ze?Se=!0:(fe.FileIndex.pop(),fe.FullPaths.pop());break;case 1:case 2:case 5:ze=!0,isNaN(gt.R*gt.L*gt.C)&&(Se=!0),-1<gt.R&&-1<gt.L&&gt.R==gt.L&&(Se=!0);break;default:Se=!0}}if(Se||qe){for(var Ge=new Date(1987,1,19),Ze=0,We=Object.create?Object.create(null):{},nt=[],Ce=0;Ce<fe.FullPaths.length;++Ce)We[fe.FullPaths[Ce]]=!0,fe.FileIndex[Ce].type!==0&&nt.push([fe.FullPaths[Ce],fe.FileIndex[Ce]]);for(Ce=0;Ce<nt.length;++Ce){var xt=u(nt[Ce][0]);(ze=We[xt])||(nt.push([xt,{name:f(xt).replace("/",""),type:1,clsid:Z,ct:Ge,mt:Ge,content:null}]),We[xt]=!0)}for(nt.sort(function($t,er){return function(fr,dr){for(var Mt,Et=fr.split("/"),mr=dr.split("/"),Kt=0,Ot=Math.min(Et.length,mr.length);Kt<Ot;++Kt){if(Mt=Et[Kt].length-mr[Kt].length)return Mt;if(Et[Kt]!=mr[Kt])return Et[Kt]<mr[Kt]?-1:1}return Et.length-mr.length}($t[0],er[0])}),fe.FullPaths=[],fe.FileIndex=[],Ce=0;Ce<nt.length;++Ce)fe.FullPaths[Ce]=nt[Ce][0],fe.FileIndex[Ce]=nt[Ce][1];for(Ce=0;Ce<nt.length;++Ce){var cr=fe.FileIndex[Ce],qt=fe.FullPaths[Ce];if(cr.name=f(qt).replace("/",""),cr.L=cr.R=cr.C=-(cr.color=1),cr.size=cr.content?cr.content.length:0,cr.start=0,cr.clsid=cr.clsid||Z,Ce===0)cr.C=1<nt.length?1:-1,cr.size=0,cr.type=5;else if(qt.slice(-1)=="/"){for(Ze=Ce+1;Ze<nt.length&&u(fe.FullPaths[Ze])!=qt;++Ze);for(cr.C=Ze>=nt.length?-1:Ze,Ze=Ce+1;Ze<nt.length&&u(fe.FullPaths[Ze])!=u(qt);++Ze);cr.R=Ze>=nt.length?-1:Ze,cr.type=1}else u(fe.FullPaths[Ce+1]||"")==u(qt)&&(cr.R=Ce+1),cr.type=2}}}function T(fe,qe){var Se=qe||{};if(Se.fileType=="mad")return function(qt,$t){for(var er=$t||{},fr=er.boundary||"SheetJS",dr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(fr="------="+fr).slice(2)+'"',"","",""],Mt=qt.FullPaths[0],Et=Mt,mr=qt.FileIndex[0],Kt=1;Kt<qt.FullPaths.length;++Kt)if(Et=qt.FullPaths[Kt].slice(Mt.length),(mr=qt.FileIndex[Kt]).size&&mr.content&&Et!="Sh33tJ5"){Et=Et.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ur){return"_x"+ur.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ur){return"_u"+ur.charCodeAt(0).toString(16)+"_"});for(var Ot=mr.content,Sr=q&&Buffer.isBuffer(Ot)?Ot.toString("binary"):W(Ot),br=0,ni=Math.min(1024,Sr.length),Ar=0,Vr=0;Vr<=ni;++Vr)32<=(Ar=Sr.charCodeAt(Vr))&&Ar<128&&++br;Ot=4*ni/5<=br,dr.push(fr),dr.push("Content-Location: "+(er.root||"file:///C:/SheetJS/")+Et),dr.push("Content-Transfer-Encoding: "+(Ot?"quoted-printable":"base64")),dr.push("Content-Type: "+function(jt,nn){if(jt.ctype)return jt.ctype;var an=jt.name||"",jt=an.match(/\.([^\.]+)$/);return jt&&_s[jt[1]]||nn&&(jt=(an=nn).match(/[\.\\]([^\.\\])+$/))&&_s[jt[1]]?_s[jt[1]]:"application/octet-stream"}(mr,Et)),dr.push(""),dr.push((Ot?function(ur){ur=ur.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Rs){return Rs=Rs.charCodeAt(0).toString(16).toUpperCase(),"="+(Rs.length==1?"0"+Rs:Rs)}),(ur=ur.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)==`
`&&(ur="=0D"+ur.slice(1)),ur=ur.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var nn=[],an=ur.split(`\r
`),jt=0;jt<an.length;++jt){var tr=an[jt];if(tr.length!=0)for(var Jt=0;Jt<tr.length;){var Yr=76,xn=tr.slice(Jt,Jt+Yr);xn.charAt(Yr-1)=="="?Yr--:xn.charAt(Yr-2)=="="?Yr-=2:xn.charAt(Yr-3)=="="&&(Yr-=3),xn=tr.slice(Jt,Jt+Yr),(Jt+=Yr)<tr.length&&(xn+="="),nn.push(xn)}else nn.push("")}return nn.join(`\r
`)}:function(ur){for(var nn=H(ur),an=[],jt=0;jt<nn.length;jt+=76)an.push(nn.slice(jt,jt+76));return an.join(`\r
`)+`\r
`})(Sr))}return dr.push(fr+`--\r
`),dr.join(`\r
`)}(fe,Se);if(b(fe),Se.fileType==="zip")return function(qt,er){var er=er||{},fr=[],dr=[],Mt=tt(1),Et=er.compression?8:0,mr=0,Kt=0,Ot=0,Sr=0,br=0,ni=qt.FullPaths[0],Ar=ni,Vr=qt.FileIndex[0],ur=[],nn=0;for(Kt=1;Kt<qt.FullPaths.length;++Kt)if(Ar=qt.FullPaths[Kt].slice(ni.length),(Vr=qt.FileIndex[Kt]).size&&Vr.content&&Ar!="Sh33tJ5"){var an=Sr,jt=tt(Ar.length);for(Ot=0;Ot<Ar.length;++Ot)jt.write_shift(1,127&Ar.charCodeAt(Ot));jt=jt.slice(0,jt.l),ur[br]=Bo.buf(Vr.content,0);var tr=Vr.content;Et==8&&(tr=function(Jt){return P?P.deflateRawSync(Jt):Yt(Jt)}(tr)),(Mt=tt(30)).write_shift(4,67324752),Mt.write_shift(2,20),Mt.write_shift(2,mr),Mt.write_shift(2,Et),Vr.mt?function(Jt,Yr){var xn=(Yr=typeof Yr=="string"?new Date(Yr):Yr).getHours();xn=(xn=xn<<6|Yr.getMinutes())<<5|Yr.getSeconds()>>>1,Jt.write_shift(2,xn),xn=(xn=(xn=Yr.getFullYear()-1980)<<4|Yr.getMonth()+1)<<5|Yr.getDate(),Jt.write_shift(2,xn)}(Mt,Vr.mt):Mt.write_shift(4,0),Mt.write_shift(-4,ur[br]),Mt.write_shift(4,tr.length),Mt.write_shift(4,Vr.content.length),Mt.write_shift(2,jt.length),Mt.write_shift(2,0),Sr+=Mt.length,fr.push(Mt),Sr+=jt.length,fr.push(jt),Sr+=tr.length,fr.push(tr),(Mt=tt(46)).write_shift(4,33639248),Mt.write_shift(2,0),Mt.write_shift(2,20),Mt.write_shift(2,mr),Mt.write_shift(2,Et),Mt.write_shift(4,0),Mt.write_shift(-4,ur[br]),Mt.write_shift(4,tr.length),Mt.write_shift(4,Vr.content.length),Mt.write_shift(2,jt.length),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(4,0),Mt.write_shift(4,an),nn+=Mt.l,dr.push(Mt),nn+=jt.length,dr.push(jt),++br}return(Mt=tt(22)).write_shift(4,101010256),Mt.write_shift(2,0),Mt.write_shift(2,0),Mt.write_shift(2,br),Mt.write_shift(2,br),Mt.write_shift(4,nn),Mt.write_shift(4,Sr),Mt.write_shift(2,0),Be([Be(fr),Be(dr),Mt])}(fe,Se);for(var ze=function(qt){for(var $t=0,er=0,fr=0;fr<qt.FileIndex.length;++fr){var dr=qt.FileIndex[fr];dr.content&&0<(dr=dr.content.length)&&(dr<4096?$t+=dr+63>>6:er+=dr+511>>9)}for(var Mt=qt.FullPaths.length+3>>2,Et=$t+127>>7,mr=($t+7>>3)+er+Mt+Et,Kt=mr+127>>7,Ot=Kt<=109?0:Math.ceil((Kt-109)/127);Kt<mr+Kt+Ot+127>>7;)Ot=++Kt<=109?0:Math.ceil((Kt-109)/127);return Mt=[1,Ot,Kt,Et,Mt,er,$t,0],qt.FileIndex[0].size=$t<<6,Mt[7]=(qt.FileIndex[0].start=Mt[0]+Mt[1]+Mt[2]+Mt[3]+Mt[4]+Mt[5])+(Mt[6]+7>>3),Mt}(fe),Ce=tt(ze[7]<<9),Ge=0,gt=0,Ge=0;Ge<8;++Ge)Ce.write_shift(1,B[Ge]);for(Ge=0;Ge<8;++Ge)Ce.write_shift(2,0);for(Ce.write_shift(2,62),Ce.write_shift(2,3),Ce.write_shift(2,65534),Ce.write_shift(2,9),Ce.write_shift(2,6),Ge=0;Ge<3;++Ge)Ce.write_shift(2,0);for(Ce.write_shift(4,0),Ce.write_shift(4,ze[2]),Ce.write_shift(4,ze[0]+ze[1]+ze[2]+ze[3]-1),Ce.write_shift(4,0),Ce.write_shift(4,4096),Ce.write_shift(4,ze[3]?ze[0]+ze[1]+ze[2]-1:N),Ce.write_shift(4,ze[3]),Ce.write_shift(-4,ze[1]?ze[0]-1:N),Ce.write_shift(4,ze[1]),Ge=0;Ge<109;++Ge)Ce.write_shift(-4,Ge<ze[2]?ze[1]+Ge:-1);if(ze[1])for(gt=0;gt<ze[1];++gt){for(;Ge<236+127*gt;++Ge)Ce.write_shift(-4,Ge<ze[2]?ze[1]+Ge:-1);Ce.write_shift(-4,gt===ze[1]-1?N:gt+1)}function Ze(qt){for(gt+=qt;Ge<gt-1;++Ge)Ce.write_shift(-4,Ge+1);qt&&(++Ge,Ce.write_shift(-4,N))}for(gt=Ge=0,gt+=ze[1];Ge<gt;++Ge)Ce.write_shift(-4,G.DIFSECT);for(gt+=ze[2];Ge<gt;++Ge)Ce.write_shift(-4,G.FATSECT);Ze(ze[3]),Ze(ze[4]);for(var We=0,nt=0,xt=fe.FileIndex[0];We<fe.FileIndex.length;++We)(xt=fe.FileIndex[We]).content&&((nt=xt.content.length)<4096||(xt.start=gt,Ze(nt+511>>9)));for(Ze(ze[6]+7>>3);511&Ce.l;)Ce.write_shift(-4,G.ENDOFCHAIN);for(We=gt=Ge=0;We<fe.FileIndex.length;++We)(xt=fe.FileIndex[We]).content&&(!(nt=xt.content.length)||4096<=nt||(xt.start=gt,Ze(nt+63>>6)));for(;511&Ce.l;)Ce.write_shift(-4,G.ENDOFCHAIN);for(Ge=0;Ge<ze[4]<<2;++Ge){var cr=fe.FullPaths[Ge];if(cr&&cr.length!==0){if(xt=fe.FileIndex[Ge],Ge===0&&(xt.start=xt.size?xt.start-1:N),cr=Ge===0&&Se.root||xt.name,nt=2*(cr.length+1),Ce.write_shift(64,cr,"utf16le"),Ce.write_shift(2,nt),Ce.write_shift(1,xt.type),Ce.write_shift(1,xt.color),Ce.write_shift(-4,xt.L),Ce.write_shift(-4,xt.R),Ce.write_shift(-4,xt.C),xt.clsid)Ce.write_shift(16,xt.clsid,"hex");else for(We=0;We<4;++We)Ce.write_shift(4,0);Ce.write_shift(4,xt.state||0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(4,xt.start),Ce.write_shift(4,xt.size),Ce.write_shift(4,0)}else{for(We=0;We<17;++We)Ce.write_shift(4,0);for(We=0;We<3;++We)Ce.write_shift(4,-1);for(We=0;We<12;++We)Ce.write_shift(4,0)}}for(Ge=1;Ge<fe.FileIndex.length;++Ge)if(4096<=(xt=fe.FileIndex[Ge]).size)if(Ce.l=xt.start+1<<9,q&&Buffer.isBuffer(xt.content))xt.content.copy(Ce,Ce.l,0,xt.size),Ce.l+=xt.size+511&-512;else{for(We=0;We<xt.size;++We)Ce.write_shift(1,xt.content[We]);for(;511&We;++We)Ce.write_shift(1,0)}for(Ge=1;Ge<fe.FileIndex.length;++Ge)if(0<(xt=fe.FileIndex[Ge]).size&&xt.size<4096)if(q&&Buffer.isBuffer(xt.content))xt.content.copy(Ce,Ce.l,0,xt.size),Ce.l+=xt.size+63&-64;else{for(We=0;We<xt.size;++We)Ce.write_shift(1,xt.content[We]);for(;63&We;++We)Ce.write_shift(1,0)}if(q)Ce.l=Ce.length;else for(;Ce.l<Ce.length;)Ce.write_shift(1,0);return Ce}c.version="1.2.1";var P,M=64,N=-2,U="d0cf11e0a1b11ae1",B=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:N,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(fe){for(var qe=new Array(fe.length),Se=0;Se<fe.length;++Se)qe[Se]=String.fromCharCode(fe[Se]);return qe.join("")}for(var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],be,De=typeof Uint8Array<"u",Pe=De?new Uint8Array(256):[],je=0;je<256;++je)Pe[je]=255&((be=139536&((be=je)<<1|be<<11)|558144&(be<<5|be<<15))>>16|be>>8|be);function it(fe,ze){var Se=7&ze,ze=ze>>>3;return(fe[ze]|(Se<=5?0:fe[1+ze]<<8))>>>Se&7}function st(fe,ze){var Se=7&ze,ze=ze>>>3;return(fe[ze]|(Se<=3?0:fe[1+ze]<<8))>>>Se&31}function Ke(fe,ze){var Se=7&ze,ze=ze>>>3;return(fe[ze]|(Se<=1?0:fe[1+ze]<<8))>>>Se&127}function yt(fe,Ge,Se){var ze=7&Ge,Ce=Ge>>>3,gt=(1<<Se)-1,Ge=fe[Ce]>>>ze;return Se<8-ze?Ge&gt:(Ge|=fe[1+Ce]<<8-ze,Se<16-ze?Ge&gt:(Ge|=fe[2+Ce]<<16-ze,Se<24-ze?Ge&gt:(Ge|=fe[3+Ce]<<24-ze)&gt))}function Wt(fe,qe,Se){var ze=7&qe,Ce=qe>>>3;return ze<=5?fe[Ce]|=(7&Se)<<ze:(fe[Ce]|=Se<<ze&255,fe[1+Ce]=(7&Se)>>8-ze),qe+3}function Ht(fe,qe,Se){var ze=qe>>>3;return Se<<=7&qe,fe[ze]|=255&Se,Se>>>=8,fe[1+ze]=Se,qe+8}function At(fe,qe,Se){var ze=qe>>>3;return Se<<=7&qe,fe[ze]|=255&Se,Se>>>=8,fe[1+ze]=255&Se,fe[2+ze]=Se>>>8,qe+16}function Pt(fe,qe){var Se=fe.length,ze=qe<2*Se?2*Se:qe+5,Ce=0;if(qe<=Se)return fe;if(q){var gt=oe(ze);if(fe.copy)fe.copy(gt);else for(;Ce<fe.length;++Ce)gt[Ce]=fe[Ce];return gt}if(De){var Ge=new Uint8Array(ze);if(Ge.set)Ge.set(fe);else for(;Ce<Se;++Ce)Ge[Ce]=fe[Ce];return Ge}return fe.length=ze,fe}function Tt(fe){for(var qe=new Array(fe),Se=0;Se<fe;++Se)qe[Se]=0;return qe}function ft(fe,qe,Se){for(var ze,Ce=1,nt=0,gt=0,Ge=0,Ze=fe.length,We=De?new Uint16Array(32):Tt(32),nt=0;nt<32;++nt)We[nt]=0;for(nt=Ze;nt<Se;++nt)fe[nt]=0;Ze=fe.length;var xt=De?new Uint16Array(Ze):Tt(Ze);for(nt=0;nt<Ze;++nt)We[ze=fe[nt]]++,Ce<ze&&(Ce=ze),xt[nt]=0;for(We[0]=0,nt=1;nt<=Ce;++nt)We[nt+16]=Ge=Ge+We[nt-1]<<1;for(nt=0;nt<Ze;++nt)(Ge=fe[nt])!=0&&(xt[nt]=We[Ge+16]++);var cr,qt,$t,er;for(nt=0;nt<Ze;++nt)if((cr=fe[nt])!=0)for(qt=xt[nt],$t=Ce,er=void 0,er=Pe[255&qt],Ge=($t<=8?er>>>8-$t:(er=er<<8|Pe[qt>>8&255],$t<=16?er>>>16-$t:(er=er<<8|Pe[qt>>16&255])>>>24-$t))>>Ce-cr,gt=(1<<Ce+4-cr)-1;0<=gt;--gt)qe[Ge|gt<<cr]=15&cr|nt<<4;return Ce}var Qt=De?new Uint16Array(512):Tt(512),sr=De?new Uint16Array(32):Tt(32);if(!De){for(var wr=0;wr<512;++wr)Qt[wr]=0;for(wr=0;wr<32;++wr)sr[wr]=0}(function(){for(var fe=[],qe=0;qe<32;qe++)fe.push(5);ft(fe,sr,32);for(var Se=[],qe=0;qe<=143;qe++)Se.push(8);for(;qe<=255;qe++)Se.push(9);for(;qe<=279;qe++)Se.push(7);for(;qe<=287;qe++)Se.push(8);ft(Se,Qt,288)})();var Gr=function(){for(var fe=De?new Uint8Array(32768):[],qe=0,Se=0;qe<se.length-1;++qe)for(;Se<se[qe+1];++Se)fe[Se]=qe;for(;Se<32768;++Se)fe[Se]=29;for(var ze=De?new Uint8Array(259):[],qe=0,Se=0;qe<ne.length-1;++qe)for(;Se<ne[qe+1];++Se)ze[Se]=qe;return function(Ce,gt){return(Ce.length<8?function(Ge,Ze){for(var We=0;We<Ge.length;){var nt=Math.min(65535,Ge.length-We),xt=We+nt==Ge.length;for(Ze.write_shift(1,+xt),Ze.write_shift(2,nt),Ze.write_shift(2,65535&~nt);0<nt--;)Ze[Ze.l++]=Ge[We++]}return Ze.l}:function(Ge,Ze){for(var We=0,nt=0,xt=De?new Uint16Array(32768):[];nt<Ge.length;){var cr=Math.min(65535,Ge.length-nt);if(cr<10){for(7&(We=Wt(Ze,We,+(nt+cr==Ge.length)))&&(We+=8-(7&We)),Ze.l=We/8|0,Ze.write_shift(2,cr),Ze.write_shift(2,65535&~cr);0<cr--;)Ze[Ze.l++]=Ge[nt++];We=8*Ze.l}else{We=Wt(Ze,We,+(nt+cr==Ge.length)+2);for(var qt=0;0<cr--;){var $t=Ge[nt],qt=32767&(qt<<5^$t),er=-1,fr=0;if((er=xt[qt])&&(nt<(er|=-32768&nt)&&(er-=32768),er<nt))for(;Ge[er+fr]==Ge[nt+fr]&&fr<250;)++fr;if(2<fr){($t=ze[fr])<=22?We=Ht(Ze,We,Pe[$t+1]>>1)-1:(Ht(Ze,We,3),Ht(Ze,We+=5,Pe[$t-23]>>5),We+=3);var dr=$t<8?0:$t-4>>2;0<dr&&(At(Ze,We,fr-ne[$t]),We+=dr),$t=fe[nt-er],We=Ht(Ze,We,Pe[$t]>>3),We-=3;var Mt=$t<4?0:$t-2>>1;0<Mt&&(At(Ze,We,nt-er-se[$t]),We+=Mt);for(var Et=0;Et<fr;++Et)xt[qt]=32767&nt,qt=32767&(qt<<5^Ge[nt]),++nt;cr-=fr-1}else $t<=143?$t+=48:(dr=((dr=1)&dr)<<(7&(Mt=We)),Ze[Mt>>>3]|=dr,We=Mt+1),We=Ht(Ze,We,Pe[$t]),xt[qt]=32767&nt,++nt}We=Ht(Ze,We,0)-1}}return Ze.l=(We+7)/8|0,Ze.l})(Ce,gt)}}();function Yt(Se){var qe=tt(50+Math.floor(1.1*Se.length)),Se=Gr(Se,qe);return qe.slice(0,Se)}var wt=De?new Uint16Array(32768):Tt(32768),Mr=De?new Uint16Array(32768):Tt(32768),fn=De?new Uint16Array(128):Tt(128),rn=1,In=1;function zi(fe,qe){if(fe[0]==3&&!(3&fe[1]))return[Y(qe),2];for(var Se=0,ze=0,Ce=oe(qe||1<<18),gt=0,Ge=Ce.length>>>0,Ze=0,We=0;!(1&ze);)if(ze=it(fe,Se),Se+=3,ze>>>1!=0)for(We=ze>>1==1?(Ze=9,5):(Se=function(fr,dr){var Mt,Et,mr,Kt=st(fr,dr)+257,Ot=st(fr,dr+=5)+1,Sr=(mr=7&(Et=dr+=5),4+(((Mt=fr)[Et=Et>>>3]|(mr<=4?0:Mt[1+Et]<<8))>>>mr&15));dr+=4;for(var br=0,ni=De?new Uint8Array(19):Tt(19),Ar=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Vr=1,ur=De?new Uint8Array(8):Tt(8),nn=De?new Uint8Array(8):Tt(8),an=ni.length,jt=0;jt<Sr;++jt)ni[J[jt]]=br=it(fr,dr),Vr<br&&(Vr=br),ur[br]++,dr+=3;var tr=0;for(ur[0]=0,jt=1;jt<=Vr;++jt)nn[jt]=tr=tr+ur[jt-1]<<1;for(jt=0;jt<an;++jt)(tr=ni[jt])!=0&&(Ar[jt]=nn[tr]++);for(var Jt,jt=0;jt<an;++jt)if((Jt=ni[jt])!=0){tr=Pe[Ar[jt]]>>8-Jt;for(var Yr=(1<<7-Jt)-1;0<=Yr;--Yr)fn[tr|Yr<<Jt]=7&Jt|jt<<3}for(var xn,Rs,Hs,fs=[],Vr=1;fs.length<Kt+Ot;)switch(dr+=7&(tr=fn[Ke(fr,dr)]),tr>>>=3){case 16:for(br=3+(Hs=void 0,Hs=7&(Rs=dr),((xn=fr)[Rs=Rs>>>3]|(Hs<=6?0:xn[1+Rs]<<8))>>>Hs&3),dr+=2,tr=fs[fs.length-1];0<br--;)fs.push(tr);break;case 17:for(br=3+it(fr,dr),dr+=3;0<br--;)fs.push(0);break;case 18:for(br=11+Ke(fr,dr),dr+=7;0<br--;)fs.push(0);break;default:fs.push(tr),Vr<tr&&(Vr=tr)}var bo=fs.slice(0,Kt),xo=fs.slice(Kt);for(jt=Kt;jt<286;++jt)bo[jt]=0;for(jt=Ot;jt<30;++jt)xo[jt]=0;return rn=ft(bo,wt,286),In=ft(xo,Mr,30),dr}(fe,Se),Ze=rn,In);;){!qe&&Ge<gt+32767&&(Ge=(Ce=Pt(Ce,gt+32767)).length);var nt=yt(fe,Se,Ze),xt=(ze>>>1==1?Qt:wt)[nt];if(Se+=15&xt,((xt>>>=4)>>>8&255)==0)Ce[gt++]=xt;else{if(xt==256)break;var cr=(xt-=257)<8?0:xt-4>>2;5<cr&&(cr=0);var qt=gt+ne[xt];0<cr&&(qt+=yt(fe,Se,cr),Se+=cr),nt=yt(fe,Se,We),Se+=15&(xt=(ze>>>1==1?sr:Mr)[nt]);var nt=(xt>>>=4)<4?0:xt-2>>1,$t=se[xt];for(0<nt&&($t+=yt(fe,Se,nt),Se+=nt),!qe&&Ge<qt&&(Ge=(Ce=Pt(Ce,qt+100)).length);gt<qt;)Ce[gt]=Ce[gt-$t],++gt}}else{7&Se&&(Se+=8-(7&Se));var er=fe[Se>>>3]|fe[1+(Se>>>3)]<<8;if(Se+=32,0<er)for(!qe&&Ge<gt+er&&(Ge=(Ce=Pt(Ce,gt+er)).length);0<er--;)Ce[gt++]=fe[Se>>>3],Se+=8}return qe?[Ce,Se+7>>>3]:[Ce.slice(0,gt),Se+7>>>3]}function Te(fe,qe){return qe=zi(fe.slice(fe.l||0),qe),fe.l+=qe[1],qe[0]}function Pn(fe,qe){if(!fe)throw new Error(qe);typeof console<"u"&&console.error(qe)}function Tn(fe,qe){var Se=fe;Zs(Se,0);var ze={FileIndex:[],FullPaths:[]};S(ze,{root:qe.root});for(var Ce=Se.length-4;(Se[Ce]!=80||Se[Ce+1]!=75||Se[Ce+2]!=5||Se[Ce+3]!=6)&&0<=Ce;)--Ce;Se.l=Ce+4,Se.l+=4;var gt=Se.read_shift(2);for(Se.l+=6,qe=Se.read_shift(4),Se.l=qe,Ce=0;Ce<gt;++Ce){Se.l+=20;var Ge=Se.read_shift(4),Ze=Se.read_shift(4),We=Se.read_shift(2),nt=Se.read_shift(2),xt=Se.read_shift(2);Se.l+=8;var cr=Se.read_shift(4),qt=m(Se.slice(Se.l+We,Se.l+We+nt));Se.l+=We+nt+xt,xt=Se.l,Se.l=cr+4,function($t,er,fr,dr,Mt){$t.l+=2;var Et=$t.read_shift(2),mr=$t.read_shift(2),Kt=function(xn){var jt=65535&xn.read_shift(2),tr=65535&xn.read_shift(2),Jt=new Date,Yr=31&tr,xn=15&(tr>>>=5);return tr>>>=4,Jt.setMilliseconds(0),Jt.setFullYear(1980+tr),Jt.setMonth(xn-1),Jt.setDate(Yr),xn=31&jt,Yr=63&(jt>>>=5),jt>>>=6,Jt.setHours(jt),Jt.setMinutes(Yr),Jt.setSeconds(xn<<1),Jt}($t);if(8257&Et)throw new Error("Unsupported ZIP encryption");$t.read_shift(4);for(var Ot,Sr=$t.read_shift(4),br=$t.read_shift(4),ni=$t.read_shift(2),Ar=$t.read_shift(2),Vr="",ur=0;ur<ni;++ur)Vr+=String.fromCharCode($t[$t.l++]);Ar&&(((Ot=m($t.slice($t.l,$t.l+Ar)))[21589]||{}).mt&&(Kt=Ot[21589].mt),((Mt||{})[21589]||{}).mt&&(Kt=Mt[21589].mt)),$t.l+=Ar;var nn=$t.slice($t.l,$t.l+Sr);switch(mr){case 8:nn=function(an,Jt){if(!P)return Te(an,Jt);var tr=new P.InflateRaw,Jt=tr._processChunk(an.slice(an.l),tr._finishFlushFlag);return an.l+=tr.bytesRead,Jt}($t,br);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+mr)}Ar=!1,8&Et&&($t.read_shift(4)==134695760&&($t.read_shift(4),Ar=!0),Sr=$t.read_shift(4),br=$t.read_shift(4)),Sr!=er&&Pn(Ar,"Bad compressed size: "+er+" != "+Sr),br!=fr&&Pn(Ar,"Bad uncompressed size: "+fr+" != "+br),Cl(dr,Vr,nn,{unsafe:!0,mt:Kt})}(Se,Ge,Ze,ze,qt),Se.l=xt}return ze}var _s={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Cl(fe,qe,Se,ze){var Ce=ze&&ze.unsafe;Ce||S(fe);var gt,Ge=!Ce&&Zt.find(fe,qe);return Ge||(gt=fe.FullPaths[0],gt=qe.slice(0,gt.length)==gt?qe:(gt.slice(-1)!="/"&&(gt+="/"),(gt+qe).replace("//","/")),Ge={name:f(qe),type:2},fe.FileIndex.push(Ge),fe.FullPaths.push(gt),Ce||Zt.utils.cfb_gc(fe)),Ge.content=Se,Ge.size=Se?Se.length:0,ze&&(ze.CLSID&&(Ge.clsid=ze.CLSID),ze.mt&&(Ge.mt=ze.mt),ze.ct&&(Ge.ct=ze.ct)),Ge}return c.find=function(fe,qe){var Se=fe.FullPaths.map(function(We){return We.toUpperCase()}),ze=Se.map(function(We){var nt=We.split("/");return nt[nt.length-(We.slice(-1)=="/"?2:1)]}),Ce=!1;qe.charCodeAt(0)===47?(Ce=!0,qe=Se[0].slice(0,-1)+qe):Ce=qe.indexOf("/")!==-1;var Ze=qe.toUpperCase(),gt=(Ce===!0?Se:ze).indexOf(Ze);if(gt!==-1)return fe.FileIndex[gt];var Ge=!Ze.match(pt),Ze=Ze.replace(lt,"");for(Ge&&(Ze=Ze.replace(pt,"!")),gt=0;gt<Se.length;++gt)if((Ge?Se[gt].replace(pt,"!"):Se[gt]).replace(lt,"")==Ze||(Ge?ze[gt].replace(pt,"!"):ze[gt]).replace(lt,"")==Ze)return fe.FileIndex[gt];return null},c.read=function(fe,qe){var Se,ze,Ce=qe&&qe.type;switch(Ce||q&&Buffer.isBuffer(fe)&&(Ce="buffer"),Ce||"base64"){case"file":return Se=fe,ze=qe,v(),p(a.readFileSync(Se),ze);case"base64":return p(me(z(fe)),qe);case"binary":return p(me(fe),qe)}return p(fe,qe)},c.parse=p,c.write=function(fe,qe){var Se=T(fe,qe);switch(qe&&qe.type||"buffer"){case"file":return v(),a.writeFileSync(qe.filename,Se),Se;case"binary":return typeof Se=="string"?Se:W(Se);case"base64":return H(typeof Se=="string"?Se:W(Se));case"buffer":if(q)return Buffer.isBuffer(Se)?Se:re(Se);case"array":return typeof Se=="string"?me(Se):Se}return Se},c.writeFile=function(fe,qe,Se){v(),Se=T(fe,Se),a.writeFileSync(qe,Se)},c.utils={cfb_new:function(fe){var qe={};return S(qe,fe),qe},cfb_add:Cl,cfb_del:function(fe,qe){S(fe);var Se=Zt.find(fe,qe);if(Se){for(var ze=0;ze<fe.FileIndex.length;++ze)if(fe.FileIndex[ze]==Se)return fe.FileIndex.splice(ze,1),fe.FullPaths.splice(ze,1),!0}return!1},cfb_mov:function(fe,qe,Se){S(fe);var ze=Zt.find(fe,qe);if(ze){for(var Ce=0;Ce<fe.FileIndex.length;++Ce)if(fe.FileIndex[Ce]==ze)return fe.FileIndex[Ce].name=f(Se),fe.FullPaths[Ce]=Se,!0}return!1},cfb_gc:function(fe){b(fe,!0)},ReadShift:K1,CheckField:P5,prep_blob:Zs,bconcat:Be,use_zlib:function(fe){try{var qe=new fe.InflateRaw;if(qe._processChunk(new Uint8Array([3,0]),qe._finishFlushFlag),!qe.bytesRead)throw new Error("zlib does not expose bytesRead");P=fe}catch(Se){console.error("cannot use native zlib: "+(Se.message||Se))}},_deflateRaw:Yt,_inflateRaw:Te,consts:G},c}();if(typeof O2<"u")try{Ur=w4}catch{}function ji(a){return typeof a=="string"?de(a):Array.isArray(a)?function(c){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(c)}(a):a}function da(a,c,u){if(Ur!==void 0&&Ur.writeFileSync)return u?Ur.writeFileSync(a,c,u):Ur.writeFileSync(a,c);if(typeof Deno<"u"){if(u&&typeof c=="string")switch(u){case"utf8":c=new TextEncoder(u).encode(c);break;case"binary":c=de(c);break;default:throw new Error("Unsupported encoding "+u)}return Deno.writeFileSync(a,c)}var f=u=="utf8"?Kc(c):c;if(typeof IE_SaveFile<"u")return IE_SaveFile(f,a);if(typeof Blob<"u"){if(f=new Blob([ji(f)],{type:"application/octet-stream"}),typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(f,a);if(typeof saveAs<"u")return saveAs(f,a);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var m=URL.createObjectURL(f);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(m)},6e4),chrome.downloads.download({url:m,filename:a,saveAs:!0});if(f=document.createElement("a"),f.download!=null)return f.download=a,f.href=m,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(m)},6e4),m}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var v=File(a);return v.open("w"),v.encoding="binary",Array.isArray(c)&&(c=Re(c)),v.write(c),v.close(),c}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+a)}function ai(a){for(var c=Object.keys(a),u=[],f=0;f<c.length;++f)Object.prototype.hasOwnProperty.call(a,c[f])&&u.push(c[f]);return u}function Wd(a,c){for(var u=[],f=ai(a),m=0;m!==f.length;++m)u[a[f[m]][c]]==null&&(u[a[f[m]][c]]=f[m]);return u}function Gc(a){for(var c=[],u=ai(a),f=0;f!==u.length;++f)c[a[u[f]]]=u[f];return c}function eh(a){for(var c=[],u=ai(a),f=0;f!==u.length;++f)c[a[u[f]]]=parseInt(u[f],10);return c}var th=new Date(1899,11,30,0,0,0);function hi(a,c){var u=a.getTime();return(u-(th.getTime()+6e4*(a.getTimezoneOffset()-th.getTimezoneOffset())))/864e5}var Js=new Date,pf=th.getTime()+6e4*(Js.getTimezoneOffset()-th.getTimezoneOffset()),jd=Js.getTimezoneOffset();function ee(a){var c=new Date;return c.setTime(24*a*60*60*1e3+pf),c.getTimezoneOffset()!==jd&&c.setTime(c.getTime()+6e4*(c.getTimezoneOffset()-jd)),c}var ge=new Date("2017-02-19T19:06:09.000Z"),ae=isNaN(ge.getFullYear())?new Date("2/19/17"):ge,le=ae.getFullYear()==2017;function ue(a,c){var u=new Date(a);return le?(0<c?u.setTime(u.getTime()+60*u.getTimezoneOffset()*1e3):c<0&&u.setTime(u.getTime()-60*u.getTimezoneOffset()*1e3),u):a instanceof Date?a:ae.getFullYear()==1917&&!isNaN(u.getFullYear())?(c=u.getFullYear(),-1<a.indexOf(""+c)||u.setFullYear(u.getFullYear()+100),u):(u=a.match(/\d+/g)||["2017","2","19","0","0","0"],u=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0),u=-1<a.indexOf("Z")?new Date(u.getTime()-60*u.getTimezoneOffset()*1e3):u)}function ve(a,c){if(q&&Buffer.isBuffer(a)){if(c){if(a[0]==255&&a[1]==254)return Kc(a.slice(2).toString("utf16le"));if(a[1]==254&&a[2]==255)return Kc(_(a.slice(2).toString("binary")))}return a.toString("binary")}if(typeof TextDecoder<"u")try{if(c){if(a[0]==255&&a[1]==254)return Kc(new TextDecoder("utf-16le").decode(a.slice(2)));if(a[0]==254&&a[1]==255)return Kc(new TextDecoder("utf-16be").decode(a.slice(2)))}var u={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(a)&&(a=new Uint8Array(a)),new TextDecoder("latin1").decode(a).replace(/[]/g,function(v){return u[v]||v})}catch{}for(var f=[],m=0;m!=a.length;++m)f.push(String.fromCharCode(a[m]));return f.join("")}function ke(a){if(typeof JSON<"u"&&!Array.isArray(a))return JSON.parse(JSON.stringify(a));if(typeof a!="object"||a==null)return a;if(a instanceof Date)return new Date(a.getTime());var c,u={};for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(u[c]=ke(a[c]));return u}function Ye(a,c){for(var u="";u.length<c;)u+=a;return u}function $e(f){var c=Number(f);if(!isNaN(c))return isFinite(c)?c:NaN;if(!/\d/.test(f))return c;var u=1,f=f.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return u*=100,""});return isNaN(c=Number(f))?(f=f.replace(/[(](.*)[)]/,function(m,v){return u=-u,v}),isNaN(c=Number(f))?c:c/u):c/u}var Oe=["january","february","march","april","may","june","july","august","september","october","november","december"];function ie(a){var c=new Date(a),u=new Date(NaN),f=c.getYear(),m=c.getMonth(),v=c.getDate();if(isNaN(v))return u;var p=a.toLowerCase();if(p.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(3<(p=p.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length&&Oe.indexOf(p)==-1)return u}else if(p.match(/[a-z]/))return u;return f<0||8099<f||(!(0<m||1<v)||f==101)&&a.match(/[^-0-9:,\/\\]/)?u:c}var Me,Qe=(Me="abacaba".split(/(:?b)/i).length==5,function(a,c,u){if(Me||typeof c=="string")return a.split(c);for(var f=a.split(c),m=[f[0]],v=1;v<f.length;++v)m.push(u),m.push(f[v]);return m});function bt(a){return a?a.content&&a.type?ve(a.content,!0):a.data?E(a.data):a.asNodeBuffer&&q?E(a.asNodeBuffer().toString("binary")):a.asBinary?E(a.asBinary()):a._data&&a._data.getContent?E(ve(Array.prototype.slice.call(a._data.getContent(),0))):null:null}function ut(a){if(!a)return null;if(a.data)return x(a.data);if(a.asNodeBuffer&&q)return a.asNodeBuffer();if(a._data&&a._data.getContent){var c=a._data.getContent();return typeof c=="string"?x(c):Array.prototype.slice.call(c)}return a.content&&a.type?a.content:null}function vt(a,c){for(var u=a.FullPaths||ai(a.files),f=c.toLowerCase().replace(/[\/]/g,"\\"),m=f.replace(/\\/g,"/"),v=0;v<u.length;++v){var p=u[v].replace(/^Root Entry[\/]/,"").toLowerCase();if(f==p||m==p)return a.files?a.files[u[v]]:a.FileIndex[v]}return null}function gr(a,c){if(a=vt(a,c),a==null)throw new Error("Cannot find file "+c+" in zip");return a}function Er(a,c,u){if(!u)return((u=gr(a,c))&&u.name.slice(-4)===".bin"?ut:bt)(u);if(!c)return null;try{return Er(a,c)}catch{return null}}function Br(a,c,u){if(!u)return bt(gr(a,c));if(!c)return null;try{return Br(a,c)}catch{return null}}function mn(a){for(var c=a.FullPaths||ai(a.files),u=[],f=0;f<c.length;++f)c[f].slice(-1)!="/"&&u.push(c[f].replace(/^Root Entry[\/]/,""));return u.sort()}function Ir(a,c,u){if(a.FullPaths){if(typeof u=="string"){var f=(q?re:function(m){for(var v=[],p=0,w=m.length+250,S=Y(m.length+255),b=0;b<m.length;++b){var T,P=m.charCodeAt(b);P<128?S[p++]=P:P<2048?(S[p++]=192|P>>6&31,S[p++]=128|63&P):55296<=P&&P<57344?(P=64+(1023&P),T=1023&m.charCodeAt(++b),S[p++]=240|P>>8&7,S[p++]=128|P>>2&63,S[p++]=128|T>>6&15|(3&P)<<4,S[p++]=128|63&T):(S[p++]=224|P>>12&15,S[p++]=128|P>>6&63,S[p++]=128|63&P),w<p&&(v.push(S.slice(0,p)),p=0,S=Y(65535),w=65530)}return v.push(S.slice(0,p)),Be(v)})(u);return Zt.utils.cfb_add(a,c,f)}Zt.utils.cfb_add(a,c,u)}else a.file(c,u)}function dl(){return Zt.utils.cfb_new()}function vf(a,c){switch(c.type){case"base64":return Zt.read(a,{type:"base64"});case"binary":return Zt.read(a,{type:"binary"});case"buffer":case"array":return Zt.read(a,{type:"buffer"})}throw new Error("Unrecognized type "+c.type)}function Ha(a,c){if(a.charAt(0)=="/")return a.slice(1);var u=c.split("/");c.slice(-1)!="/"&&u.pop();for(var f=a.split("/");f.length!==0;){var m=f.shift();m===".."?u.pop():m!=="."&&u.push(m)}return u.join("/")}var fi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Ql=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,YS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,po=fi.match(YS)?YS:/<[^>]*>/g,Gte=/<\w*:/,Yte=/<(\/?)\w+:/;function Pr(a,c,u){for(var f={},m=0,v=0;m!==a.length&&(v=a.charCodeAt(m))!==32&&v!==10&&v!==13;++m);if(c||(f[0]=a.slice(0,m)),m===a.length)return f;var p,w,S,b=a.match(Ql),T=0,P=0,M="",N="";if(b)for(P=0;P!=b.length;++P){for(N=b[P],v=0;v!=N.length&&N.charCodeAt(v)!==61;++v);for(M=N.slice(0,v).trim();N.charCodeAt(v+1)==32;)++v;for(w=(m=N.charCodeAt(v+1))==34||m==39?1:0,p=N.slice(v+1+w,N.length-w),T=0;T!=M.length&&M.charCodeAt(T)!==58;++T);T===M.length?(f[M=0<M.indexOf("_")?M.slice(0,M.indexOf("_")):M]=p,f[M.toLowerCase()]=p):f[S=(T===5&&M.slice(0,5)==="xmlns"?"xmlns":"")+M.slice(T+1)]&&M.slice(T-3,T)=="ext"||(f[S]=p,f[S.toLowerCase()]=p)}return f}function Yc(a){return a.replace(Yte,"<$1")}var a5,l5,c5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},AR=Gc(c5),Sn=(a5=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,l5=/_x([\da-fA-F]{4})_/gi,function a(c){var u=c+"",f=u.indexOf("<![CDATA[");return f==-1?u.replace(a5,function(m,v){return c5[m]||String.fromCharCode(parseInt(v,-1<m.indexOf("x")?16:10))||m}).replace(l5,function(m,v){return String.fromCharCode(parseInt(v,16))}):(c=u.indexOf("]]>"),a(u.slice(0,f))+u.slice(f+9,c)+a(u.slice(c+3)))}),OR=/[&<>'"]/g,Kte=/[\u0000-\u0008\u000b-\u001f]/g;function Bn(a){return(a+"").replace(OR,function(c){return AR[c]}).replace(Kte,function(c){return"_x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+"_"})}function u5(a){return Bn(a).replace(/ /g,"_x0020_")}var h5=/[\u0000-\u001f]/g;function IR(a){return(a+"").replace(OR,function(c){return AR[c]}).replace(/\n/g,"<br/>").replace(h5,function(c){return"&#x"+("000"+c.charCodeAt(0).toString(16)).slice(-4)+";"})}var f5,d5=(f5=/&#(\d+);/g,function(a){return a.replace(f5,Xte)});function Xte(a,c){return String.fromCharCode(parseInt(c,10))}function di(a){switch(a){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function PR(a){for(var c,u,f,m,v="",p=0,w=0;p<a.length;)(c=a.charCodeAt(p++))<128?v+=String.fromCharCode(c):(u=a.charCodeAt(p++),191<c&&c<224?(w=(31&c)<<6,w|=63&u,v+=String.fromCharCode(w)):(f=a.charCodeAt(p++),c<240?v+=String.fromCharCode((15&c)<<12|(63&u)<<6|63&f):(m=((7&c)<<18|(63&u)<<12|(63&f)<<6|63&(w=a.charCodeAt(p++)))-65536,v+=String.fromCharCode(55296+(m>>>10&1023)),v+=String.fromCharCode(56320+(1023&m)))));return v}function g5(a){for(var c,u,f=Y(2*a.length),m=1,v=0,p=0,w=0;w<a.length;w+=m)m=1,(u=a.charCodeAt(w))<128?c=u:u<224?(c=64*(31&u)+(63&a.charCodeAt(w+1)),m=2):u<240?(c=4096*(15&u)+64*(63&a.charCodeAt(w+1))+(63&a.charCodeAt(w+2)),m=3):(m=4,c=262144*(7&u)+4096*(63&a.charCodeAt(w+1))+64*(63&a.charCodeAt(w+2))+(63&a.charCodeAt(w+3)),p=55296+((c-=65536)>>>10&1023),c=56320+(1023&c)),p!==0&&(f[v++]=255&p,f[v++]=p>>>8,p=0),f[v++]=c%256,f[v++]=c>>>8;return f.slice(0,v).toString("ucs2")}function m5(a){return re(a,"binary").toString("utf8")}var FR,CS,SS,pm="foo bar baz",Qn=q&&(m5(pm)==PR(pm)?m5:g5(pm)==PR(pm)&&g5)||PR,Kc=q?function(a){return re(a,"utf8").toString("binary")}:function(a){for(var c,u=[],f=0,m=0;f<a.length;)switch(!0){case(m=a.charCodeAt(f++))<128:u.push(String.fromCharCode(m));break;case m<2048:u.push(String.fromCharCode(192+(m>>6))),u.push(String.fromCharCode(128+(63&m)));break;case(55296<=m&&m<57344):m-=55296,c=a.charCodeAt(f++)-56320+(m<<10),u.push(String.fromCharCode(240+(c>>18&7))),u.push(String.fromCharCode(144+(c>>12&63))),u.push(String.fromCharCode(128+(c>>6&63))),u.push(String.fromCharCode(128+(63&c)));break;default:u.push(String.fromCharCode(224+(m>>12))),u.push(String.fromCharCode(128+(m>>6&63))),u.push(String.fromCharCode(128+(63&m)))}return u.join("")},z1=(FR={},function(a,c){var u=a+"|"+(c||"");return FR[u]||(FR[u]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",c||""))}),p5=(CS=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]}),function(a){for(var c=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<CS.length;++u)c=c.replace(CS[u][0],CS[u][1]);return c}),qte=(SS={},function(a){return SS[a]!==void 0?SS[a]:SS[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}),Jte=/<\/?(?:vt:)?variant>/g,Qte=/<(?:vt:)([^>]*)>([\s\S]*)</;function v5(f,c){var u=Pr(f),f=f.match(qte(u.baseType))||[],m=[];if(f.length==u.size)return f.forEach(function(v){v=v.replace(Jte,"").match(Qte),v&&m.push({v:Qn(v[2]),t:v[1]})}),m;if(c.WTF)throw new Error("unexpected vector length "+f.length+" != "+u.size);return m}var w5=/(^\s|\s$|\n)/;function Qs(a,c){return"<"+a+(c.match(w5)?' xml:space="preserve"':"")+">"+c+"</"+a+">"}function G1(a){return ai(a).map(function(c){return" "+c+'="'+a[c]+'"'}).join("")}function Nt(a,c,u){return"<"+a+(u!=null?G1(u):"")+(c!=null?(c.match(w5)?' xml:space="preserve"':"")+">"+c+"</"+a:"/")+">"}function MR(a,c){try{return a.toISOString().replace(/\.\d*/,"")}catch(u){if(c)throw u}return""}function kR(a){if(q&&Buffer.isBuffer(a))return a.toString("utf8");if(typeof a=="string")return a;if(typeof Uint8Array<"u"&&a instanceof Uint8Array)return Qn(Re(Ie(a)));throw new Error("Bad input format: expected Buffer or string")}var Y1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Ts={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ud=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$a={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function y5(a){for(var c=[],u=0;u<a[0].length;++u)if(a[0][u])for(var f=0,m=a[0][u].length;f<m;f+=10240)c.push.apply(c,a[0][u].slice(f,f+10240));return c}function C5(a,c,u){for(var f=[],m=c;m<u;m+=2)f.push(String.fromCharCode(rh(a,m)));return f.join("").replace(lt,"")}function S5(a,c,u){for(var f=[],m=c;m<c+u;++m)f.push(("0"+a[m].toString(16)).slice(-2));return f.join("")}function b5(a,c,u){for(var f=[],m=c;m<u;m++)f.push(String.fromCharCode(im(a,m)));return f.join("")}function x5(a,c){var u=Ds(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function E5(a,c){var u=Ds(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function T5(a,c){var u=2*Ds(a,c);return 0<u?nm(a,c+4,c+4+u-1):""}function _5(a,c){var u=Ds(a,c);return 0<u?bS(a,c+4,c+4+u):""}function R5(a,c){var u=Ds(a,c);return 0<u?nm(a,c+4,c+4+u):""}function A5(a,c){for(var u=1-2*(a[c+7]>>>7),f=((127&a[c+7])<<4)+(a[c+6]>>>4&15),m=15&a[c+6],v=5;0<=v;--v)m=256*m+a[c+v];return f==2047?m==0?1/0*u:NaN:(f==0?f=-1022:(f-=1023,m+=Math.pow(2,52)),u*Math.pow(2,f-52)*m)}var O5=q?function(a){return 0<a[0].length&&Buffer.isBuffer(a[0][0])?Buffer.concat(a[0].map(function(c){return Buffer.isBuffer(c)?c:re(c)})):y5(a)}:y5,bS=q?function(a,c,u){return Buffer.isBuffer(a)?a.toString("utf16le",c,u).replace(lt,""):C5(a,c,u)}:C5,I5=q?function(a,c,u){return Buffer.isBuffer(a)?a.toString("hex",c,c+u):S5(a,c,u)}:S5,nm=q?function(a,c,u){return Buffer.isBuffer(a)?a.toString("utf8",c,u):b5(a,c,u)}:b5,NR=x5,DR=E5,LR=T5,HR=_5,$R=R5,xS=A5,BR=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};q&&(NR=function(a,c){if(!Buffer.isBuffer(a))return x5(a,c);var u=a.readUInt32LE(c);return 0<u?a.toString("utf8",c+4,c+4+u-1):""},DR=function(a,c){if(!Buffer.isBuffer(a))return E5(a,c);var u=a.readUInt32LE(c);return 0<u?a.toString("utf8",c+4,c+4+u-1):""},LR=function(a,c){if(!Buffer.isBuffer(a))return T5(a,c);var u=2*a.readUInt32LE(c);return a.toString("utf16le",c+4,c+4+u-1)},HR=function(a,c){if(!Buffer.isBuffer(a))return _5(a,c);var u=a.readUInt32LE(c);return a.toString("utf16le",c+4,c+4+u)},$R=function(a,c){if(!Buffer.isBuffer(a))return R5(a,c);var u=a.readUInt32LE(c);return a.toString("utf8",c+4,c+4+u)},xS=function(a,c){return Buffer.isBuffer(a)?a.readDoubleLE(c):A5(a,c)},BR=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array}),n!==void 0&&(bS=function(a,c,u){return n.utils.decode(1200,a.slice(c,u)).replace(lt,"")},nm=function(a,c,u){return n.utils.decode(65001,a.slice(c,u))},NR=function(a,c){var u=Ds(a,c);return 0<u?n.utils.decode(l,a.slice(c+4,c+4+u-1)):""},DR=function(a,c){var u=Ds(a,c);return 0<u?n.utils.decode(o,a.slice(c+4,c+4+u-1)):""},LR=function(a,c){var u=2*Ds(a,c);return 0<u?n.utils.decode(1200,a.slice(c+4,c+4+u-1)):""},HR=function(a,c){var u=Ds(a,c);return 0<u?n.utils.decode(1200,a.slice(c+4,c+4+u)):""},$R=function(a,c){var u=Ds(a,c);return 0<u?n.utils.decode(65001,a.slice(c+4,c+4+u)):""});var im=function(a,c){return a[c]},rh=function(a,c){return 256*a[c+1]+a[c]},Zte=function(a,c){return c=256*a[c+1]+a[c],c<32768?c:-1*(65535-c+1)},Ds=function(a,c){return a[c+3]*(1<<24)+(a[c+2]<<16)+(a[c+1]<<8)+a[c]},zd=function(a,c){return a[c+3]<<24|a[c+2]<<16|a[c+1]<<8|a[c]},ere=function(a,c){return a[c]<<24|a[c+1]<<16|a[c+2]<<8|a[c+3]};function K1(a,c){var u,f,m,v,p,w,S="",b=[];switch(c){case"dbcs":if(w=this.l,q&&Buffer.isBuffer(this))S=this.slice(this.l,this.l+2*a).toString("utf16le");else for(p=0;p<a;++p)S+=String.fromCharCode(rh(this,w)),w+=2;a*=2;break;case"utf8":S=nm(this,this.l,this.l+a);break;case"utf16le":a*=2,S=bS(this,this.l,this.l+a);break;case"wstr":if(n===void 0)return K1.call(this,a,"dbcs");S=n.utils.decode(o,this.slice(this.l,this.l+2*a)),a*=2;break;case"lpstr-ansi":S=NR(this,this.l),a=4+Ds(this,this.l);break;case"lpstr-cp":S=DR(this,this.l),a=4+Ds(this,this.l);break;case"lpwstr":S=LR(this,this.l),a=4+2*Ds(this,this.l);break;case"lpp4":a=4+Ds(this,this.l),S=HR(this,this.l),2&a&&(a+=2);break;case"8lpp4":a=4+Ds(this,this.l),S=$R(this,this.l),3&a&&(a+=4-(3&a));break;case"cstr":for(a=0,S="";(m=im(this,this.l+a++))!==0;)b.push(R(m));S=b.join("");break;case"_wstr":for(a=0,S="";(m=rh(this,this.l+a))!==0;)b.push(R(m)),a+=2;a+=2,S=b.join("");break;case"dbcs-cont":for(S="",w=this.l,p=0;p<a;++p){if(this.lens&&this.lens.indexOf(w)!==-1)return m=im(this,w),this.l=w+1,v=K1.call(this,a-p,m?"dbcs-cont":"sbcs-cont"),b.join("")+v;b.push(R(rh(this,w))),w+=2}S=b.join(""),a*=2;break;case"cpstr":if(n!==void 0){S=n.utils.decode(o,this.slice(this.l,this.l+a));break}case"sbcs-cont":for(S="",w=this.l,p=0;p!=a;++p){if(this.lens&&this.lens.indexOf(w)!==-1)return m=im(this,w),this.l=w+1,v=K1.call(this,a-p,m?"dbcs-cont":"sbcs-cont"),b.join("")+v;b.push(R(im(this,w))),w+=1}S=b.join("");break;default:switch(a){case 1:return u=im(this,this.l),this.l++,u;case 2:return u=(c==="i"?Zte:rh)(this,this.l),this.l+=2,u;case 4:case-4:return c==="i"||!(128&this[this.l+3])?(u=(0<a?zd:ere)(this,this.l),this.l+=4,u):(f=Ds(this,this.l),this.l+=4,f);case 8:case-8:if(c==="f")return f=a==8?xS(this,this.l):xS([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,f;a=8;case 16:S=I5(this,this.l,a)}}return this.l+=a,S}var tre=function(a,c,u){a[u]=255&c,a[u+1]=c>>>8&255,a[u+2]=c>>>16&255,a[u+3]=c>>>24&255},rre=function(a,c,u){a[u]=255&c,a[u+1]=c>>8&255,a[u+2]=c>>16&255,a[u+3]=c>>24&255},nre=function(a,c,u){a[u]=255&c,a[u+1]=c>>>8&255};function ire(a,c,u){var f=0,m=0;if(u==="dbcs"){for(m=0;m!=c.length;++m)nre(this,c.charCodeAt(m),this.l+2*m);f=2*c.length}else if(u==="sbcs"){if(n!==void 0&&l==874)for(m=0;m!=c.length;++m){var v=n.utils.encode(l,c.charAt(m));this[this.l+m]=v[0]}else for(c=c.replace(/[^\x00-\x7F]/g,"_"),m=0;m!=c.length;++m)this[this.l+m]=255&c.charCodeAt(m);f=c.length}else{if(u==="hex"){for(;m<a;++m)this[this.l++]=parseInt(c.slice(2*m,2*m+2),16)||0;return this}if(u==="utf16le"){for(var p=Math.min(this.l+a,this.length),m=0;m<Math.min(c.length,a);++m){var w=c.charCodeAt(m);this[this.l++]=255&w,this[this.l++]=w>>8}for(;this.l<p;)this[this.l++]=0;return this}switch(a){case 1:f=1,this[this.l]=255&c;break;case 2:f=2,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c;break;case 3:f=3,this[this.l]=255&c,c>>>=8,this[this.l+1]=255&c,c>>>=8,this[this.l+2]=255&c;break;case 4:f=4,tre(this,c,this.l);break;case 8:if(f=8,u==="f"){(function(S,b,T){var P=(b<0||1/b==-1/0?1:0)<<7,M=0,N=0,U=P?-b:b;isFinite(U)?U==0?M=N=0:(M=Math.floor(Math.log(U)/Math.LN2),N=U*Math.pow(2,52-M),M<=-1023&&(!isFinite(N)||N<Math.pow(2,52))?M=-1022:(N-=Math.pow(2,52),M+=1023)):(M=2047,N=isNaN(b)?26985:0);for(var B=0;B<=5;++B,N/=256)S[T+B]=255&N;S[T+6]=(15&M)<<4|15&N,S[T+7]=M>>4|P})(this,c,this.l);break}case 16:break;case-4:f=4,rre(this,c,this.l)}}return this.l+=f,this}function P5(a,c){var u=I5(this,this.l,a.length>>1);if(u!==a)throw new Error(c+"Expected "+a+" saw "+u);this.l+=a.length>>1}function Zs(a,c){a.l=c,a.read_shift=K1,a.chk=P5,a.write_shift=ire}function vo(a,c){a.l+=c}function tt(a){return a=Y(a),Zs(a,0),a}function nh(a,c,u){if(a){Zs(a,a.l||0);for(var f,m=a.length,v=0;a.l<m;){128&(v=a.read_shift(1))&&(v=(127&v)+((127&a.read_shift(1))<<7));for(var p,w=pv[v]||pv[65535],S=127&(p=a.read_shift(1)),b=1;b<4&&128&p;++b)S+=(127&(p=a.read_shift(1)))<<7*b;f=a.l+S;var T=w.f&&w.f(a,S,u);if(a.l=f,c(T,w,v))return}}}function ga(){function a(p){return Zs(p=tt(p),0),p}function c(){v&&(v.length>v.l&&((v=v.slice(0,v.l)).l=v.length),0<v.length&&f.push(v),v=null)}function u(p){return v&&p<v.length-v.l?v:(c(),v=a(Math.max(p+1,m)))}var f=[],m=q?256:2048,v=a(m);return{next:u,push:function(p){c(),(v=p).l==null&&(v.l=v.length),u(m)},end:function(){return c(),Be(f)},_bufs:f}}function ht(a,c,u,f){var m=+c;if(!isNaN(m)){c=1+(128<=m?1:0)+1,128<=(f=f||pv[m].p||(u||[]).length||0)&&++c,16384<=f&&++c,2097152<=f&&++c;var v=a.next(c);m<=127?v.write_shift(1,m):(v.write_shift(1,128+(127&m)),v.write_shift(1,m>>7));for(var p=0;p!=4;++p){if(!(128<=f)){v.write_shift(1,f);break}v.write_shift(1,128+(127&f)),f>>=7}0<f&&BR(u)&&a.push(u)}}function X1(a,c,u){var f=ke(a);if(c.s?(f.cRel&&(f.c+=c.s.c),f.rRel&&(f.r+=c.s.r)):(f.cRel&&(f.c+=c.c),f.rRel&&(f.r+=c.r)),!u||u.biff<12){for(;256<=f.c;)f.c-=256;for(;65536<=f.r;)f.r-=65536}return f}function F5(a,c,u){return a=ke(a),a.s=X1(a.s,c.s,u),a.e=X1(a.e,c.s,u),a}function q1(a,c){if(a.cRel&&a.c<0)for(a=ke(a);a.c<0;)a.c+=8<c?16384:256;if(a.rRel&&a.r<0)for(a=ke(a);a.r<0;)a.r+=8<c?1048576:5<c?65536:16384;var u=Fr(a);return a.cRel||a.cRel==null||(u=u.replace(/^([A-Z])/,"$$$1")),u=!a.rRel&&a.rRel!=null?u.replace(/([A-Z]|^)(\d+)$/,"$1$$$2"):u}function VR(a,c){return a.s.r!=0||a.s.rRel||a.e.r!=(12<=c.biff?1048575:8<=c.biff?65536:16384)||a.e.rRel?a.s.c!=0||a.s.cRel||a.e.c!=(12<=c.biff?16383:255)||a.e.cRel?q1(a.s,c.biff)+":"+q1(a.e,c.biff):(a.s.rRel?"":"$")+Ui(a.s.r)+":"+(a.e.rRel?"":"$")+Ui(a.e.r):(a.s.cRel?"":"$")+gi(a.s.c)+":"+(a.e.cRel?"":"$")+gi(a.e.c)}function WR(a){return parseInt(a.replace(/\$(\d+)$/,"$1"),10)-1}function Ui(a){return""+(a+1)}function jR(a){for(var c=a.replace(/^\$([A-Z])/,"$1"),u=0,f=0;f!==c.length;++f)u=26*u+c.charCodeAt(f)-64;return u-1}function gi(a){if(a<0)throw new Error("invalid column "+a);var c="";for(++a;a;a=Math.floor((a-1)/26))c=String.fromCharCode((a-1)%26+65)+c;return c}function Ii(a){for(var c=0,u=0,f=0;f<a.length;++f){var m=a.charCodeAt(f);48<=m&&m<=57?c=10*c+(m-48):65<=m&&m<=90&&(u=26*u+(m-64))}return{c:u-1,r:c-1}}function Fr(a){for(var c=a.c+1,u="";c;c=(c-1)/26|0)u=String.fromCharCode((c-1)%26+65)+u;return u+(a.r+1)}function Vo(a){var c=a.indexOf(":");return c==-1?{s:Ii(a),e:Ii(a)}:{s:Ii(a.slice(0,c)),e:Ii(a.slice(c+1))}}function Wr(a,c){return c===void 0||typeof c=="number"?Wr(a.s,a.e):(a=typeof a!="string"?Fr(a):a)==(c=typeof c!="string"?Fr(c):c)?a:a+":"+c}function un(a){for(var c={s:{c:0,r:0},e:{c:0,r:0}},v=0,u=0,f=0,m=a.length,v=0;u<m&&!((f=a.charCodeAt(u)-64)<1||26<f);++u)v=26*v+f;for(c.s.c=--v,v=0;u<m&&!((f=a.charCodeAt(u)-48)<0||9<f);++u)v=10*v+f;if(c.s.r=--v,u===m||f!=10)return c.e.c=c.s.c,c.e.r=c.s.r,c;for(++u,v=0;u!=m&&!((f=a.charCodeAt(u)-64)<1||26<f);++u)v=26*v+f;for(c.e.c=--v,v=0;u!=m&&!((f=a.charCodeAt(u)-48)<0||9<f);++u)v=10*v+f;return c.e.r=--v,c}function sre(a,c){var u=a.t=="d"&&c instanceof Date;if(a.z!=null)try{return a.w=Lr(a.z,u?hi(c):c)}catch{}try{return a.w=Lr((a.XF||{}).numFmtId||(u?14:0),u?hi(c):c)}catch{return""+c}}function Xc(a,c,u){return a==null||a.t==null||a.t=="z"?"":a.w!==void 0?a.w:(a.t=="d"&&!a.z&&u&&u.dateNF&&(a.z=u.dateNF),a.t=="e"?ih[a.v]||a.v:sre(a,c??a.v))}function wf(a,f){var u=f&&f.sheet?f.sheet:"Sheet1",f={};return f[u]=a,{SheetNames:[u],Sheets:f}}function M5(a,c,u){var f=u||{},m=a?Array.isArray(a):f.dense,v=a||(m?[]:{}),p=0,w=0;v&&f.origin!=null&&(typeof f.origin=="number"?p=f.origin:(p=(S=typeof f.origin=="string"?Ii(f.origin):f.origin).r,w=S.c),v["!ref"]||(v["!ref"]="A1:A1"));var S,b={s:{c:1e7,r:1e7},e:{c:0,r:0}};v["!ref"]&&(S=un(v["!ref"]),b.s.c=S.s.c,b.s.r=S.s.r,b.e.c=Math.max(b.e.c,S.e.c),b.e.r=Math.max(b.e.r,S.e.r),p==-1&&(b.e.r=p=S.e.r+1));for(var T=0;T!=c.length;++T)if(c[T]){if(!Array.isArray(c[T]))throw new Error("aoa_to_sheet expects an array of arrays");for(var P=0;P!=c[T].length;++P)if(c[T][P]!==void 0){var M={v:c[T][P]},N=p+T,U=w+P;if(b.s.r>N&&(b.s.r=N),b.s.c>U&&(b.s.c=U),b.e.r<N&&(b.e.r=N),b.e.c<U&&(b.e.c=U),!c[T][P]||typeof c[T][P]!="object"||Array.isArray(c[T][P])||c[T][P]instanceof Date)if(Array.isArray(M.v)&&(M.f=c[T][P][1],M.v=M.v[0]),M.v===null)if(M.f)M.t="n";else if(f.nullError)M.t="e",M.v=0;else{if(!f.sheetStubs)continue;M.t="z"}else typeof M.v=="number"?M.t="n":typeof M.v=="boolean"?M.t="b":M.v instanceof Date?(M.z=f.dateNF||D[14],f.cellDates?(M.t="d",M.w=Lr(M.z,hi(M.v))):(M.t="n",M.v=hi(M.v),M.w=Lr(M.z,M.v))):M.t="s";else M=c[T][P];m?(v[N]||(v[N]=[]),v[N][U]&&v[N][U].z&&(M.z=v[N][U].z),v[N][U]=M):(v[N=Fr({c:U,r:N})]&&v[N].z&&(M.z=v[N].z),v[N]=M)}}return b.s.c<1e7&&(v["!ref"]=Wr(b)),v}function sm(a,c){return M5(null,a,c)}function Zl(a,c){return(c=c||tt(4)).write_shift(4,a),c}function wo(a){var c=a.read_shift(4);return c===0?"":a.read_shift(c,"dbcs")}function Ls(a,c){var u=!1;return c==null&&(u=!0,c=tt(4+2*a.length)),c.write_shift(4,a.length),0<a.length&&c.write_shift(0,a,"dbcs"),u?c.slice(0,c.l):c}function UR(a,c){var u,f=a.l,m=a.read_shift(1),p=wo(a),v=[],p={t:p,h:p};if(1&m){for(var w=a.read_shift(4),S=0;S!=w;++S)v.push({ich:(u=a).read_shift(2),ifnt:u.read_shift(2)});p.r=v}else p.r=[{ich:0,ifnt:0}];return a.l=f+c,p}var ore=UR;function are(a,c){var u,f=!1;return c==null&&(f=!0,c=tt(23+4*a.t.length)),c.write_shift(1,1),Ls(a.t,c),c.write_shift(4,1),u={ich:0,ifnt:0},(a=(a=c)||tt(4)).write_shift(2,u.ich||0),a.write_shift(2,u.ifnt||0),f?c.slice(0,c.l):c}function gl(a){var c=a.read_shift(4),u=a.read_shift(2);return u+=a.read_shift(1)<<16,a.l++,{c,iStyleRef:u}}function Gd(a,c){return(c=c??tt(8)).write_shift(-4,a.c),c.write_shift(3,a.iStyleRef||a.s),c.write_shift(1,0),c}function Yd(a){var c=a.read_shift(2);return c+=a.read_shift(1)<<16,a.l++,{c:-1,iStyleRef:c}}function Kd(a,c){return(c=c??tt(4)).write_shift(3,a.iStyleRef||a.s),c.write_shift(1,0),c}var lre=wo,k5=Ls;function zR(a){var c=a.read_shift(4);return c===0||c===4294967295?"":a.read_shift(c,"dbcs")}function ES(a,c){var u=!1;return c==null&&(u=!0,c=tt(127)),c.write_shift(4,0<a.length?a.length:4294967295),0<a.length&&c.write_shift(0,a,"dbcs"),u?c.slice(0,c.l):c}var cre=wo,GR=zR,YR=ES;function KR(a){var c=a.slice(a.l,a.l+4),u=1&c[0],f=2&c[0];return a.l+=4,c=f==0?xS([0,0,0,0,252&c[0],c[1],c[2],c[3]],0):zd(c,0)>>2,u?c/100:c}function N5(a,c){c==null&&(c=tt(4));var u=0,f=0,m=100*a;if(a==(0|a)&&-(1<<29)<=a&&a<1<<29?f=1:m==(0|m)&&-(1<<29)<=m&&m<1<<29&&(u=f=1),!f)throw new Error("unsupported RkNumber "+a);c.write_shift(-4,((u?m:a)<<2)+(u+2))}function D5(a){var c={s:{},e:{}};return c.s.r=a.read_shift(4),c.e.r=a.read_shift(4),c.s.c=a.read_shift(4),c.e.c=a.read_shift(4),c}var Xd=D5,om=function(a,c){return(c=c||tt(16)).write_shift(4,a.s.r),c.write_shift(4,a.e.r),c.write_shift(4,a.s.c),c.write_shift(4,a.e.c),c};function yo(a){if(a.length-a.l<8)throw"XLS Xnum Buffer underflow";return a.read_shift(8,"f")}function am(a,c){return(c||tt(8)).write_shift(8,a,"f")}function TS(a,c){if(c=c||tt(8),!a||a.auto)return c.write_shift(4,0),c.write_shift(4,0),c;a.index!=null?(c.write_shift(1,2),c.write_shift(1,a.index)):a.theme!=null?(c.write_shift(1,6),c.write_shift(1,a.theme)):(c.write_shift(1,5),c.write_shift(1,0));var u=a.tint||0;return 0<u?u*=32767:u<0&&(u*=32768),c.write_shift(2,u),a.rgb&&a.theme==null?(typeof(a=a.rgb||"FFFFFF")=="number"&&(a=("000000"+a.toString(16)).slice(-6)),c.write_shift(1,parseInt(a.slice(0,2),16)),c.write_shift(1,parseInt(a.slice(2,4),16)),c.write_shift(1,parseInt(a.slice(4,6),16)),c.write_shift(1,255)):(c.write_shift(2,0),c.write_shift(1,0),c.write_shift(1,0)),c}function L5(a,c){var u=a.read_shift(4);switch(u){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[a.read_shift(4)]||""}if(400<u)throw new Error("Unsupported Clipboard: "+u.toString(16));return a.l-=4,a.read_shift(0,c==1?"lpstr":"lpwstr")}var XR=2,ma=3,H5=12,$5=81,ure=[80,$5],qR={1:{n:"CodePage",t:XR},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:ma},5:{n:"LineCount",t:ma},6:{n:"ParagraphCount",t:ma},7:{n:"SlideCount",t:ma},8:{n:"NoteCount",t:ma},9:{n:"HiddenCount",t:ma},10:{n:"MultimediaClipCount",t:ma},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:ma},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:ma,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},JR={1:{n:"CodePage",t:XR},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:ma},15:{n:"WordCount",t:ma},16:{n:"CharCount",t:ma},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:ma},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},B5={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},hre=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],J1=ke([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].map(function(a){return[a>>16&255,a>>8&255,255&a]})),ih={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},V5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},QR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},_S={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ZR(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function W5(a,c){var u,f=function(S){for(var b=[],T=ai(S),P=0;P!==T.length;++P)b[S[T[P]]]==null&&(b[S[T[P]]]=[]),b[S[T[P]]].push(T[P]);return b}(QR),m=[];m[m.length]=fi,m[m.length]=Nt("Types",null,{xmlns:Ts.CT,"xmlns:xsd":Ts.xsd,"xmlns:xsi":Ts.xsi}),m=m.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(S){return Nt("Default",null,{Extension:S[0],ContentType:S[1]})}));function v(S){a[S]&&0<a[S].length&&(u=a[S][0],m[m.length]=Nt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:_S[S][c.bookType]||_S[S].xlsx}))}function p(S){(a[S]||[]).forEach(function(b){m[m.length]=Nt("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:_S[S][c.bookType]||_S[S].xlsx})})}function w(S){(a[S]||[]).forEach(function(b){m[m.length]=Nt("Override",null,{PartName:(b[0]=="/"?"":"/")+b,ContentType:f[S][0]})})}return v("workbooks"),p("sheets"),p("charts"),w("themes"),["strs","styles"].forEach(v),["coreprops","extprops","custprops"].forEach(w),w("vba"),w("comments"),w("threadedcomments"),w("drawings"),p("metadata"),w("people"),2<m.length&&(m[m.length]="</Types>",m[1]=m[1].replace("/>",">")),m.join("")}var zr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Q1(a){var c=a.lastIndexOf("/");return a.slice(0,c+1)+"_rels/"+a.slice(c+1)+".rels"}function Z1(a,c){var u={"!id":{}};if(!a)return u;c.charAt(0)!=="/"&&(c="/"+c);var f={};return(a.match(po)||[]).forEach(function(m){var v,p=Pr(m);p[0]==="<Relationship"&&((v={}).Type=p.Type,v.Target=p.Target,v.Id=p.Id,p.TargetMode&&(v.TargetMode=p.TargetMode),m=p.TargetMode==="External"?p.Target:Ha(p.Target,c),u[m]=v,f[p.Id]=v)}),u["!id"]=f,u}function lm(a){var c=[fi,Nt("Relationships",null,{xmlns:Ts.RELS})];return ai(a["!id"]).forEach(function(u){c[c.length]=Nt("Relationship",null,a["!id"][u])}),2<c.length&&(c[c.length]="</Relationships>",c[1]=c[1].replace("/>",">")),c.join("")}function Vn(a,c,u,f,m,v){if(m=m||{},a["!id"]||(a["!id"]={}),a["!idx"]||(a["!idx"]=1),c<0)for(c=a["!idx"];a["!id"]["rId"+c];++c);if(a["!idx"]=c+1,m.Id="rId"+c,m.Type=f,m.Target=u,-1<[zr.HLINK,zr.XPATH,zr.XMISS].indexOf(m.Type)&&(m.TargetMode="External"),a["!id"][m.Id])throw new Error("Cannot rewrite rId "+c);return a["!id"][m.Id]=m,a[("/"+m.Target).replace("//","/")]=m,c}var fre="application/vnd.oasis.opendocument.spreadsheet";function j5(a,c,u){return['  <rdf:Description rdf:about="'+a+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(u||"odf")+"#"+c+`"/>
`,`  </rdf:Description>
`].join("")}function U5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s.version+"</meta:generator></office:meta></office:document-meta>"}var ml=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dre=function(){for(var a=new Array(ml.length),c=0;c<ml.length;++c){var u=ml[c],u="(?:"+u[0].slice(0,u[0].indexOf(":"))+":)"+u[0].slice(u[0].indexOf(":")+1);a[c]=new RegExp("<"+u+"[^>]*>([\\s\\S]*?)</"+u+">")}return a}();function z5(a){var c={};a=Qn(a);for(var u=0;u<ml.length;++u){var f=ml[u],m=a.match(dre[u]);m!=null&&0<m.length&&(c[f[1]]=Sn(m[1])),f[2]==="date"&&c[f[1]]&&(c[f[1]]=ue(c[f[1]]))}return c}function eA(a,c,u,f,m){m[a]==null&&c!=null&&c!==""&&(c=Bn(m[a]=c),f[f.length]=u?Nt(a,c,u):Qs(a,c))}function G5(a,c){var u=c||{},f=[fi,Nt("cp:coreProperties",null,{"xmlns:cp":Ts.CORE_PROPS,"xmlns:dc":Ts.dc,"xmlns:dcterms":Ts.dcterms,"xmlns:dcmitype":Ts.dcmitype,"xmlns:xsi":Ts.xsi})],m={};if(!a&&!u.Props)return f.join("");a&&(a.CreatedDate!=null&&eA("dcterms:created",typeof a.CreatedDate=="string"?a.CreatedDate:MR(a.CreatedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},f,m),a.ModifiedDate!=null&&eA("dcterms:modified",typeof a.ModifiedDate=="string"?a.ModifiedDate:MR(a.ModifiedDate,u.WTF),{"xsi:type":"dcterms:W3CDTF"},f,m));for(var v=0;v!=ml.length;++v){var p=ml[v],w=u.Props&&u.Props[p[1]]!=null?u.Props[p[1]]:a?a[p[1]]:null;w===!0?w="1":w===!1?w="0":typeof w=="number"&&(w=String(w)),w!=null&&eA(p[0],w,null,f,m)}return 2<f.length&&(f[f.length]="</cp:coreProperties>",f[1]=f[1].replace("/>",">")),f.join("")}var qd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Y5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function K5(a,c,u,f){var m=[];if(typeof a=="string")m=v5(a,f);else for(var v=0;v<a.length;++v)m=m.concat(a[v].map(function(T){return{v:T}}));var p,w=typeof c=="string"?v5(c,f).map(function(T){return T.v}):c,S=0;if(0<w.length)for(var b=0;b!==m.length;b+=2){switch(p=+m[b+1].v,m[b].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":u.Worksheets=p,u.SheetNames=w.slice(S,S+p);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":u.NamedRanges=p,u.DefinedNames=w.slice(S,S+p);break;case"Charts":case"Diagramme":u.Chartsheets=p,u.ChartNames=w.slice(S,S+p)}S+=p}}function X5(a){var c=[],u=Nt;return(a=a||{}).Application="SheetJS",c[c.length]=fi,c[c.length]=Nt("Properties",null,{xmlns:Ts.EXT_PROPS,"xmlns:vt":Ts.vt}),qd.forEach(function(f){if(a[f[1]]!==void 0){var m;switch(f[2]){case"string":m=Bn(String(a[f[1]]));break;case"bool":m=a[f[1]]?"true":"false"}m!==void 0&&(c[c.length]=u(f[0],m))}}),c[c.length]=u("HeadingPairs",u("vt:vector",u("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+u("vt:variant",u("vt:i4",String(a.Worksheets))),{size:2,baseType:"variant"})),c[c.length]=u("TitlesOfParts",u("vt:vector",a.SheetNames.map(function(f){return"<vt:lpstr>"+Bn(f)+"</vt:lpstr>"}).join(""),{size:a.Worksheets,baseType:"lpstr"})),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var gre=/<[^>]+>[^<]*/g;function q5(a){var c=[fi,Nt("Properties",null,{xmlns:Ts.CUST_PROPS,"xmlns:vt":Ts.vt})];if(!a)return c.join("");var u=1;return ai(a).forEach(function(f){++u,c[c.length]=Nt("property",function(m,v){switch(typeof m){case"string":var p=Nt("vt:lpwstr",Bn(m));return p=p.replace(/&quot;/g,"_x0022_");case"number":return Nt((0|m)==m?"vt:i4":"vt:r8",Bn(String(m)));case"boolean":return Nt("vt:bool",m?"true":"false")}if(m instanceof Date)return Nt("vt:filetime",MR(m));throw new Error("Unable to serialize "+m)}(a[f]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:u,name:Bn(f)})}),2<c.length&&(c[c.length]="</Properties>",c[1]=c[1].replace("/>",">")),c.join("")}var J5,tA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function rA(u){var c=u.read_shift(4),u=u.read_shift(4);return new Date(1e3*(u/1e7*Math.pow(2,32)+c/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Q5(a,c,u){var f=a.l,m=a.read_shift(0,"lpstr-cp");if(u)for(;a.l-f&3;)++a.l;return m}function Z5(a,c,u){var f=a.read_shift(0,"lpwstr");return f}function eL(a,c,u){return c===31?Z5(a):Q5(a,0,u)}function tL(a,c,u){return eL(a,c,u===!1?0:4)}function mre(a){for(var c,u,f,m=a.read_shift(4),v=[],p=0;p<m/2;++p)v.push((f=u=void 0,u=(c=a).l,f=RS(c,$5),c[c.l]==0&&c[c.l+1]==0&&c.l-u&2&&(c.l+=2),[f,RS(c,ma)]));return v}function rL(a,c){for(var u=a.read_shift(4),f={},m=0;m!=u;++m){var v=a.read_shift(4),p=a.read_shift(4);f[v]=a.read_shift(p,c===1200?"utf16le":"utf8").replace(lt,"").replace(pt,"!"),c===1200&&p%2&&(a.l+=2)}return 3&a.l&&(a.l=a.l>>3<<2),f}function nL(a){var c=a.read_shift(4),u=a.slice(a.l,a.l+c);return a.l+=c,0<(3&c)&&(a.l+=4-(3&c)&3),u}function RS(a,c,u){var f,m,v=a.read_shift(2),p=u||{};if(a.l+=2,c!==H5&&v!==c&&ure.indexOf(c)===-1&&((65534&c)!=4126||(65534&v)!=4126))throw new Error("Expected type "+c+" saw "+v);switch(c===H5?v:c){case 2:return f=a.read_shift(2,"i"),p.raw||(a.l+=2),f;case 3:return f=a.read_shift(4,"i");case 11:return a.read_shift(4)!==0;case 19:return f=a.read_shift(4);case 30:return Q5(a,0,4).replace(lt,"");case 31:return Z5(a);case 64:return rA(a);case 65:return nL(a);case 71:return(m={}).Size=(f=a).read_shift(4),f.l+=m.Size+3-(m.Size-1)%4,m;case 80:return tL(a,v,!p.raw).replace(lt,"");case 81:return function(w,S){if(!S)throw new Error("VtUnalignedString must have positive length");return eL(w,S,0)}(a,v).replace(lt,"");case 4108:return mre(a);case 4126:case 4127:return(v==4127?function(w){for(var S=w.read_shift(4),b=[],T=0;T!=S;++T){var P=w.l;b[T]=w.read_shift(0,"lpwstr").replace(lt,""),w.l-P&2&&(w.l+=2)}return b}:function(w){for(var S=w.read_shift(4),b=[],T=0;T!=S;++T)b[T]=w.read_shift(0,"lpstr-cp").replace(lt,"");return b})(a);default:throw new Error("TypedPropertyValue unrecognized type "+c+" "+v)}}function iL(a,c){var u,f,m,v=tt(4),p=tt(4);switch(v.write_shift(4,a==80?31:a),a){case 3:p.write_shift(-4,c);break;case 5:(p=tt(8)).write_shift(8,c,"f");break;case 11:p.write_shift(4,c?1:0);break;case 64:f=(typeof(u=c)=="string"?new Date(Date.parse(u)):u).getTime()/1e3+11644473600,m=f%Math.pow(2,32),u=(f-m)/Math.pow(2,32),u*=1e7,0<(f=(m*=1e7)/Math.pow(2,32)|0)&&(m%=Math.pow(2,32),u+=f),(f=tt(8)).write_shift(4,m),f.write_shift(4,u),p=f;break;case 31:case 80:for((p=tt(4+2*(c.length+1)+(c.length%2?0:2))).write_shift(4,c.length+1),p.write_shift(0,c,"dbcs");p.l!=p.length;)p.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+c)}return Be([v,p])}function sL(a,c){for(var u=a.l,f=a.read_shift(4),m=a.read_shift(4),v=[],b=0,p=0,w=-1,S={},b=0;b!=m;++b){var T=a.read_shift(4),P=a.read_shift(4);v[b]=[T,P+u]}v.sort(function(G,W){return G[1]-W[1]});var M={};for(b=0;b!=m;++b){if(a.l!==v[b][1]){var N=!0;if(0<b&&c)switch(c[v[b-1][0]].t){case 2:a.l+2===v[b][1]&&(a.l+=2,N=!1);break;case 80:case 4108:a.l<=v[b][1]&&(a.l=v[b][1],N=!1)}if((!c||b==0)&&a.l<=v[b][1]&&(N=!1,a.l=v[b][1]),N)throw new Error("Read Error: Expected address "+v[b][1]+" at "+a.l+" :"+b)}if(c){var U=c[v[b][0]];if(M[U.n]=RS(a,U.t,{raw:!0}),U.p==="version"&&(M[U.n]=String(M[U.n]>>16)+"."+("0000"+String(65535&M[U.n])).slice(-4)),U.n=="CodePage")switch(M[U.n]){case 0:M[U.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:y(p=M[U.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+M[U.n])}}else if(v[b][0]===1)p=M.CodePage=RS(a,XR),y(p),w!==-1&&(Z=a.l,a.l=v[w][1],S=rL(a,p),a.l=Z);else if(v[b][0]===0)p!==0?S=rL(a,p):(w=b,a.l=v[b+1][1]);else{var B,Z=S[v[b][0]];switch(a[a.l]){case 65:a.l+=4,B=nL(a);break;case 30:case 31:a.l+=4,B=tL(a,a[a.l-4]).replace(/\u0000+$/,"");break;case 3:a.l+=4,B=a.read_shift(4,"i");break;case 19:a.l+=4,B=a.read_shift(4);break;case 5:a.l+=4,B=a.read_shift(8,"f");break;case 11:a.l+=4,B=ns(a,4);break;case 64:a.l+=4,B=ue(rA(a));break;default:throw new Error("unparsed value: "+a[a.l])}M[Z]=B}}return a.l=u+f,M}var oL=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function aL(a,c,u){var f,m,v,p,w=tt(8),S=[],b=[],T=8,P=0,M=tt(8),N=tt(8);if(M.write_shift(4,2),M.write_shift(4,1200),N.write_shift(4,1),b.push(M),S.push(N),T+=8+M.length,!c){(N=tt(8)).write_shift(4,0),S.unshift(N);var U=[tt(4)];for(U[0].write_shift(4,a.length),P=0;P<a.length;++P){var B=a[P][0];for((M=tt(8+2*(B.length+1)+(B.length%2?0:2))).write_shift(4,P+2),M.write_shift(4,B.length+1),M.write_shift(0,B,"dbcs");M.l!=M.length;)M.write_shift(1,0);U.push(M)}M=Be(U),b.unshift(M),T+=8+M.length}for(P=0;P<a.length;++P)c&&!c[a[P][0]]||-1<oL.indexOf(a[P][0])||-1<Y5.indexOf(a[P][0])||a[P][1]!=null&&(v=a[P][1],f=0,M=c?((p=u[f=+c[a[P][0]]]).p=="version"&&typeof v=="string"&&(v=(+(m=v.split("."))[0]<<16)+(+m[1]||0)),iL(p.t,v)):((p=function(G){switch(typeof G){case"boolean":return 11;case"number":return(0|G)==G?3:5;case"string":return 31;case"object":if(G instanceof Date)return 64}return-1}(v))==-1&&(p=31,v=String(v)),iL(p,v)),b.push(M),(N=tt(8)).write_shift(4,c?f:2+P),S.push(N),T+=8+M.length);for(var Z=8*(b.length+1),P=0;P<b.length;++P)S[P].write_shift(4,Z),Z+=b[P].length;return w.write_shift(4,T),w.write_shift(4,b.length),Be([w].concat(S).concat(b))}function lL(a,c,u){var f=a.content;if(!f)return{};Zs(f,0);var m,v=0;f.chk("feff","Byte Order: "),f.read_shift(2);var p=f.read_shift(4),w=f.read_shift(16);if(w!==Zt.utils.consts.HEADER_CLSID&&w!==u)throw new Error("Bad PropertySet CLSID "+w);if((a=f.read_shift(4))!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(u=f.read_shift(16),w=f.read_shift(4),a===1&&w!==f.l)throw new Error("Length mismatch: "+w+" !== "+f.l);a===2&&(m=f.read_shift(16),v=f.read_shift(4));var S,b,T=sL(f,c),P={SystemIdentifier:p};for(S in T)P[S]=T[S];if(P.FMTID=u,a===1)return P;if(v-f.l==2&&(f.l+=2),f.l!==v)throw new Error("Length mismatch 2: "+f.l+" !== "+v);try{b=sL(f,null)}catch{}for(S in b)P[S]=b[S];return P.FMTID=[u,m],P}function cL(a,c,u,f,m,v){var p=tt(m?68:48),w=[p];return p.write_shift(2,65534),p.write_shift(2,0),p.write_shift(4,842412599),p.write_shift(16,Zt.utils.consts.HEADER_CLSID,"hex"),p.write_shift(4,m?2:1),p.write_shift(16,c,"hex"),p.write_shift(4,m?68:48),f=aL(a,u,f),w.push(f),m&&(m=aL(m,null,null),p.write_shift(16,v,"hex"),p.write_shift(4,68+f.length),w.push(m)),Be(w)}function yf(a,c){return a.read_shift(c),null}function ns(a,c){return a.read_shift(c)===1}function Wo(a,c){return(c=c||tt(2)).write_shift(2,+!!a),c}function us(a){return a.read_shift(2,"u")}function pl(a,c){return(c=c||tt(2)).write_shift(2,a),c}function uL(a,c){return function(u,f,m){for(var v=[],p=u.l+f;u.l<p;)v.push(m(u,p-u.l));if(p!==u.l)throw new Error("Slurp error");return v}(a,c,us)}function hL(a,c,u){return(u=u||tt(2)).write_shift(1,c=="e"?+a:+!!a),u.write_shift(1,c=="e"?1:0),u}function ev(a,c,u){var f=a.read_shift(u&&12<=u.biff?2:1),m="sbcs-cont",v=o;return u&&8<=u.biff&&(o=1200),u&&u.biff!=8?u.biff==12&&(m="wstr"):a.read_shift(1)&&(m="dbcs-cont"),2<=u.biff&&u.biff<=5&&(m="cpstr"),m=f?a.read_shift(f,m):"",o=v,m}function Jd(a,c,u){if(u){if(2<=u.biff&&u.biff<=5)return a.read_shift(c,"cpstr");if(12<=u.biff)return a.read_shift(c,"dbcs-cont")}return a.read_shift(1)===0?a.read_shift(c,"sbcs-cont"):a.read_shift(c,"dbcs-cont")}function tv(a,c,u){var f=a.read_shift(u&&u.biff==2?1:2);return f===0?(a.l++,""):Jd(a,f,u)}function Qd(a,c,u){if(5<u.biff)return tv(a,0,u);var f=a.read_shift(1);return f===0?(a.l++,""):a.read_shift(f,u.biff<=4||!a.lens?"cpstr":"sbcs-cont")}function fL(a,c,u){return(u=u||tt(3+2*a.length)).write_shift(2,a.length),u.write_shift(1,1),u.write_shift(31,a,"utf16le"),u}function pre(a){var c,u,f,m,v=a.read_shift(16);switch(v){case"e0c9ea79f9bace118c8200aa004ba90b":return u=(c=a).read_shift(4),f=c.l,m=!1,24<u&&(c.l+=u-24,c.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(m=!0),c.l=f),u=c.read_shift((m?u-24:u)>>1,"utf16le").replace(lt,""),m&&(c.l+=24),u;case"0303000000000000c000000000000046":return function(p){for(var w=p.read_shift(2),S="";0<w--;)S+="../";var b=p.read_shift(0,"lpstr-ansi");if(p.l+=2,p.read_shift(2)!=57005)throw new Error("Bad FileMoniker");if(p.read_shift(4)===0)return S+b.replace(/\\/g,"/");if(b=p.read_shift(4),p.read_shift(2)!=3)throw new Error("Bad FileMoniker");return S+p.read_shift(b>>1,"utf16le").replace(lt,"")}(a);default:throw new Error("Unsupported Moniker "+v)}}function AS(a){var c=a.read_shift(4);return 0<c?a.read_shift(c,"utf16le").replace(lt,""):""}function dL(a,c){(c=c||tt(6+2*a.length)).write_shift(4,1+a.length);for(var u=0;u<a.length;++u)c.write_shift(2,a.charCodeAt(u));return c.write_shift(2,0),c}function gL(a){return[a.read_shift(1),a.read_shift(1),a.read_shift(1),a.read_shift(1)]}function mL(a){return a=gL(a),a[3]=0,a}function qc(a){return{r:a.read_shift(2),c:a.read_shift(2),ixfe:a.read_shift(2)}}function Zd(a,c,u,f){return(f=f||tt(6)).write_shift(2,a),f.write_shift(2,c),f.write_shift(2,u||0),f}function pL(a){return[a.read_shift(2),KR(a)]}function OS(a){var c=a.read_shift(2),u=a.read_shift(2);return{s:{c:a.read_shift(2),r:c},e:{c:a.read_shift(2),r:u}}}function vL(a,c){return(c=c||tt(8)).write_shift(2,a.s.r),c.write_shift(2,a.e.r),c.write_shift(2,a.s.c),c.write_shift(2,a.e.c),c}function wL(a){var c=a.read_shift(2),u=a.read_shift(2);return{s:{c:a.read_shift(1),r:c},e:{c:a.read_shift(1),r:u}}}var vre=wL;function yL(a){a.l+=4;var c=a.read_shift(2),u=a.read_shift(2),f=a.read_shift(2);return a.l+=12,[u,c,f]}function Co(a){a.l+=2,a.l+=a.read_shift(2)}var wre={0:Co,4:Co,5:Co,6:Co,7:function(a){return a.l+=4,a.cf=a.read_shift(2),{}},8:Co,9:Co,10:Co,11:Co,12:Co,13:function(a){var c={};return a.l+=4,a.l+=16,c.fSharedNote=a.read_shift(2),a.l+=4,c},14:Co,15:Co,16:Co,17:Co,18:Co,19:Co,20:Co,21:yL};function IS(a,c){var u={BIFFVer:0,dt:0};switch(u.BIFFVer=a.read_shift(2),2<=(c-=2)&&(u.dt=a.read_shift(2),a.l-=2),u.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(6<c)throw new Error("Unexpected BIFF Ver "+u.BIFFVer)}return a.read_shift(c),u}function nA(a,c,u){var f=1536,m=16;switch(u.bookType){case"biff8":break;case"biff5":f=1280,m=8;break;case"biff4":f=4,m=6;break;case"biff3":f=3,m=6;break;case"biff2":f=2,m=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}return u=tt(m),u.write_shift(2,f),u.write_shift(2,c),4<m&&u.write_shift(2,29282),6<m&&u.write_shift(2,1997),8<m&&(u.write_shift(2,49161),u.write_shift(2,1),u.write_shift(2,1798),u.write_shift(2,0)),u}function yre(a){var c=tt(8);c.write_shift(4,a.Count),c.write_shift(4,a.Unique);for(var u,f,m,v=[],p=0;p<a.length;++p)v[p]=(u=a[p],m=f=void 0,f=u.t||"",(m=tt(3)).write_shift(2,f.length),m.write_shift(1,1),(u=tt(2*f.length)).write_shift(2*f.length,f,"utf16le"),Be([m,u]));var w=Be([c].concat(v));return w.parts=[c.length].concat(v.map(function(S){return S.length})),w}function CL(a,c,u){var f=0;return u&&u.biff==2||(f=a.read_shift(2)),a=a.read_shift(2),u&&u.biff==2&&(f=1-(a>>15),a&=32767),[{Unsynced:1&f,DyZero:(2&f)>>1,ExAsc:(4&f)>>2,ExDsc:(8&f)>>3},a]}var vm=Qd;function SL(a,v,p){var f=a.l+v,w=p.biff!=8&&p.biff?2:4,m=a.read_shift(w),v=a.read_shift(w),p=a.read_shift(2),w=a.read_shift(2);return a.l=f,{s:{r:m,c:p},e:{r:v,c:w}}}function bL(a,c,u,f){return u=u&&u.biff==5,(f=f||tt(u?16:20)).write_shift(2,0),a.style?(f.write_shift(2,a.numFmtId||0),f.write_shift(2,65524)):(f.write_shift(2,a.numFmtId||0),f.write_shift(2,c<<4)),c=0,0<a.numFmtId&&u&&(c|=1024),f.write_shift(4,c),f.write_shift(4,0),u||f.write_shift(4,0),f.write_shift(2,0),f}function xL(a,c,u){var f=qc(a);return u.biff!=2&&c!=9||++a.l,a=(c=a).read_shift(1),a=c.read_shift(1)===1?a:a===1,f.val=a,f.t=a===!0||a===!1?"b":"e",f}function EL(a,c,u){return c===0?"":Qd(a,0,u)}function TL(a,c,u){var f,m=a.read_shift(2),m={fBuiltIn:1&m,fWantAdvise:m>>>1&1,fWantPict:m>>>2&1,fOle:m>>>3&1,fOleLink:m>>>4&1,cf:m>>>5&1023,fIcon:m>>>15&1};return u.sbcch===14849&&(f=function(v,b,w){v.l+=4,b-=4;var S=v.l+b,b=ev(v,0,w);if((w=v.read_shift(2))!==(S-=v.l))throw new Error("Malformed AddinUdf: padding = "+S+" != "+w);return v.l+=w,b}(a,c-2,u)),m.body=f||a.read_shift(c-2),typeof f=="string"&&(m.Name=f),m}var Cre=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function _L(a,S,u){var f=a.l+S,m=a.read_shift(2),v=a.read_shift(1),p=a.read_shift(1),w=a.read_shift(u&&u.biff==2?1:2),S=0;return(!u||5<=u.biff)&&(u.biff!=5&&(a.l+=2),S=a.read_shift(2),u.biff==5&&(a.l+=2),a.l+=4),p=Jd(a,p,u),32&m&&(p=Cre[p.charCodeAt(0)]),m=f-a.l,u&&u.biff==2&&--m,{chKey:v,Name:p,itab:S,rgce:f!=a.l&&w!==0&&0<m?function(b,U,P,B){var N,U=b.l+U,B=hv(b,B,P);return U!==b.l&&(N=uv(b,U-b.l,B,P)),[B,N]}(a,m,u,w):[]}}function RL(a,c,u){if(u.biff<8)return function(w,S){return w[w.l+1]==3&&w[w.l]++,S=ev(w,0,S),S.charCodeAt(0)==3?S.slice(1):S}(a,u);for(var f,m,v=[],c=a.l+c,p=a.read_shift(8<u.biff?4:2);p--!=0;)v.push((f=a,u.biff,m=8<(m=u).biff?4:2,[f.read_shift(m),f.read_shift(m,"i"),f.read_shift(m,"i")]));if(a.l!=c)throw new Error("Bad ExternSheet: "+a.l+" != "+c);return v}function AL(a,c,u){var f=vre(a);switch(u.biff){case 2:a.l++,c-=7;break;case 3:case 4:a.l+=2,c-=8;break;default:a.l+=6,c-=12}return[f,function(m,v,p){var w,S=m.l+v,b=p.biff==2?1:2,T=m.read_shift(b);if(T==65535)return[[],vo(m,v-2)];var P=hv(m,T,p);return v!==T+b&&(w=uv(m,v-T-b,P,p)),m.l=S,[P,w]}(a,c,u)]}var Sre={8:function(a,c){var u=a.l+c;a.l+=10;var f=a.read_shift(2);return a.l+=4,a.l+=2,a.l+=2,a.l+=2,a.l+=4,c=a.read_shift(1),a.l+=c,a.l=u,{fmt:f}}};function bre(a){var c=tt(24),u=Ii(a[0]);c.write_shift(2,u.r),c.write_shift(2,u.r),c.write_shift(2,u.c),c.write_shift(2,u.c);for(var f="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),m=0;m<16;++m)c.write_shift(1,parseInt(f[m],16));return Be([c,function(v){var p=tt(512),w=0,S=v.Target,b=-1<(v=(S=S.slice(0,7)=="file://"?S.slice(7):S).indexOf("#"))?31:23;switch(S.charAt(0)){case"#":b=28;break;case".":b&=-3}p.write_shift(4,2),p.write_shift(4,b);for(var T=[8,6815827,6619237,4849780,83],w=0;w<T.length;++w)p.write_shift(4,T[w]);if(b==28)dL(S=S.slice(1),p);else if(2&b){for(T="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),w=0;w<T.length;++w)p.write_shift(1,parseInt(T[w],16));var P=-1<v?S.slice(0,v):S;for(p.write_shift(4,2*(P.length+1)),w=0;w<P.length;++w)p.write_shift(2,P.charCodeAt(w));p.write_shift(2,0),8&b&&dL(-1<v?S.slice(v+1):"",p)}else{for(T="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),w=0;w<T.length;++w)p.write_shift(1,parseInt(T[w],16));for(var M=0;S.slice(3*M,3*M+3)=="../"||S.slice(3*M,3*M+3)=="..\\";)++M;for(p.write_shift(2,M),p.write_shift(4,S.length-3*M+1),w=0;w<S.length-3*M;++w)p.write_shift(1,255&S.charCodeAt(w+3*M));for(p.write_shift(1,0),p.write_shift(2,65535),p.write_shift(2,57005),w=0;w<6;++w)p.write_shift(4,0)}return p.slice(0,p.l)}(a[1])])}function OL(a,S,u){if(!u.cellStyles)return vo(a,S);var f=u&&12<=u.biff?4:2,m=a.read_shift(f),v=a.read_shift(f),p=a.read_shift(f),w=a.read_shift(f),S=a.read_shift(2);return f==2&&(a.l+=2),w={s:m,e:v,w:p,ixfe:w,flags:S},(5<=u.biff||!u.biff)&&(w.level=S>>8&7),w}var xre=qc,Ere=uL,WA=tv,IL,PL,PS,Tre=[2,3,48,49,131,139,140,245],iA=(IL={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},PL=Gc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127}),PS={B:8,C:250,L:1,D:8,"?":0,"":0},{to_workbook:function(a,c){try{return wf(FL(a,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}},to_sheet:FL,from_sheet:function(a,c){if(0<=+(c=c||{}).codepage&&y(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");for(var u=ga(),f=(c=ZS(a,{header:1,raw:!0,cellDates:!0}))[0],m=c.slice(1),v=a["!cols"]||[],b=0,p=0,w=0,S=1,b=0;b<f.length;++b)if(((v[b]||{}).DBF||{}).name)f[b]=v[b].DBF.name,++w;else if(f[b]!=null){if(++w,typeof f[b]=="number"&&(f[b]=f[b].toString(10)),typeof f[b]!="string")throw new Error("DBF Invalid column name "+f[b]+" |"+typeof f[b]+"|");if(f.indexOf(f[b])!==b){for(p=0;p<1024;++p)if(f.indexOf(f[b]+"_"+p)==-1){f[b]+="_"+p;break}}}var T=un(a["!ref"]),P=[],M=[],N=[];for(b=0;b<=T.e.c-T.s.c;++b){for(var U="",B="",Z=0,G=[],p=0;p<m.length;++p)m[p][b]!=null&&G.push(m[p][b]);if(G.length!=0&&f[b]!=null){for(p=0;p<G.length;++p){switch(typeof G[p]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=G[p]instanceof Date?"D":"C";break;default:B="C"}Z=Math.max(Z,String(G[p]).length),U=U&&U!=B?"C":B}250<Z&&(Z=250),(B=((v[b]||{}).DBF||{}).type)=="C"&&v[b].DBF.len>Z&&(Z=v[b].DBF.len),U=="B"&&B=="N"&&(U="N",N[b]=v[b].DBF.dec,Z=v[b].DBF.len),M[b]=U=="C"||B=="N"?Z:PS[U]||0,S+=M[b],P[b]=U}else P[b]="?"}var W,J,ne=u.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,m.length),ne.write_shift(2,296+32*w),ne.write_shift(2,S),b=0;b<4;++b)ne.write_shift(4,0);for(ne.write_shift(4,0|(+PL[l]||3)<<8),p=b=0;b<f.length;++b)f[b]!=null&&(W=u.next(32),J=(f[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11),W.write_shift(1,J,"sbcs"),W.write_shift(1,P[b]=="?"?"C":P[b],"sbcs"),W.write_shift(4,p),W.write_shift(1,M[b]||PS[P[b]]||0),W.write_shift(1,N[b]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),p+=M[b]||PS[P[b]]||0);var se=u.next(264);for(se.write_shift(4,13),b=0;b<65;++b)se.write_shift(4,0);for(b=0;b<m.length;++b){var be=u.next(S);for(be.write_shift(1,0),p=0;p<f.length;++p)if(f[p]!=null)switch(P[p]){case"L":be.write_shift(1,m[b][p]==null?63:m[b][p]?84:70);break;case"B":be.write_shift(8,m[b][p]||0,"f");break;case"N":var De="0";for(typeof m[b][p]=="number"&&(De=m[b][p].toFixed(N[p]||0)),w=0;w<M[p]-De.length;++w)be.write_shift(1,32);be.write_shift(1,De,"sbcs");break;case"D":m[b][p]?(be.write_shift(4,("0000"+m[b][p].getFullYear()).slice(-4),"sbcs"),be.write_shift(2,("00"+(m[b][p].getMonth()+1)).slice(-2),"sbcs"),be.write_shift(2,("00"+m[b][p].getDate()).slice(-2),"sbcs")):be.write_shift(8,"00000000","sbcs");break;case"C":var Pe=String(m[b][p]!=null?m[b][p]:"").slice(0,M[p]);for(be.write_shift(1,Pe,"sbcs"),w=0;w<M[p]-Pe.length;++w)be.write_shift(1,32)}}return u.next(1).write_shift(1,26),u.end()}});function FL(a,c){return c=c||{},c.dateNF||(c.dateNF="yyyymmdd"),a=sm(function(u,f){var m=[],v=Y(1);switch(f.type){case"base64":v=me(z(u));break;case"binary":v=me(u);break;case"buffer":case"array":v=u}Zs(v,0);var p=v.read_shift(1),w=!!(136&p),S=!1,b=!1;switch(p){case 2:case 3:break;case 48:case 49:w=S=!0;break;case 131:case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var T=0,P=521;p==2&&(T=v.read_shift(2)),v.l+=3,1048576<(T=p!=2?v.read_shift(4):T)&&(T=1e6),p!=2&&(P=v.read_shift(2));var M=v.read_shift(2),N=f.codepage||1252;p!=2&&(v.l+=16,v.read_shift(1),v[v.l]!==0&&(N=IL[v[v.l]]),v.l+=1,v.l+=2),b&&(v.l+=36);for(var U=[],B={},Z=Math.min(v.length,p==2?521:P-10-(S?264:0)),G=b?32:11;v.l<Z&&v[v.l]!=13;)switch((B={}).name=n.utils.decode(N,v.slice(v.l,v.l+G)).replace(/[\u0000\r\n].*$/g,""),v.l+=G,B.type=String.fromCharCode(v.read_shift(1)),p==2||b||(B.offset=v.read_shift(4)),B.len=v.read_shift(1),p==2&&(B.offset=v.read_shift(2)),B.dec=v.read_shift(1),B.name.length&&U.push(B),p!=2&&(v.l+=b?13:14),B.type){case"B":S&&B.len==8||!f.WTF||console.log("Skipping "+B.name+":"+B.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+B.name+":"+B.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+B.type)}if(v[v.l]!==13&&(v.l=P-1),v.read_shift(1)!==13)throw new Error("DBF Terminator not found "+v.l+" "+v[v.l]);v.l=P;var W=0,J=0;for(m[0]=[],J=0;J!=U.length;++J)m[0][J]=U[J].name;for(;0<T--;)if(v[v.l]!==42)for(++v.l,m[++W]=[],J=J=0;J!=U.length;++J){var ne=v.slice(v.l,v.l+U[J].len);v.l+=U[J].len,Zs(ne,0);var se=n.utils.decode(N,ne);switch(U[J].type){case"C":se.trim().length&&(m[W][J]=se.replace(/\s+$/,""));break;case"D":se.length===8?m[W][J]=new Date(+se.slice(0,4),+se.slice(4,6)-1,+se.slice(6,8)):m[W][J]=se;break;case"F":m[W][J]=parseFloat(se.trim());break;case"+":case"I":m[W][J]=b?2147483648^ne.read_shift(-4,"i"):ne.read_shift(4,"i");break;case"L":switch(se.trim().toUpperCase()){case"Y":case"T":m[W][J]=!0;break;case"N":case"F":m[W][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+se+"|")}break;case"M":if(!w)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));m[W][J]="##MEMO##"+(b?parseInt(se.trim(),10):ne.read_shift(4));break;case"N":(se=se.replace(/\u0000/g,"").trim())&&se!="."&&(m[W][J]=+se||0);break;case"@":m[W][J]=new Date(ne.read_shift(-8,"f")-621356832e5);break;case"T":m[W][J]=new Date(864e5*(ne.read_shift(4)-2440588)+ne.read_shift(4));break;case"Y":m[W][J]=ne.read_shift(4,"i")/1e4+ne.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[W][J]=-ne.read_shift(-8,"f");break;case"B":if(S&&U[J].len==8){m[W][J]=ne.read_shift(8,"f");break}case"G":case"P":ne.l+=U[J].len;break;case"0":if(U[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+U[J].type)}}else v.l+=M;if(p!=2&&v.l<v.length&&v[v.l++]!=26)throw new Error("DBF EOF Marker missing "+(v.l-1)+" of "+v.length+" "+v[v.l-1].toString(16));return f&&f.sheetRows&&(m=m.slice(0,f.sheetRows)),f.DBF=U,m}(a,c),c),a["!cols"]=c.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete c.DBF,a}var FS,ML,kL,NL,DL=(FS={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},ML=new RegExp("\x1BN("+ai(FS).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),kL=function(a,c){return c=FS[c],typeof c=="number"?I(c):c},NL=function(a,c,u){return u=c.charCodeAt(0)-32<<4|u.charCodeAt(0)-48,u==59?a:I(u)},FS["|"]=254,{to_workbook:function(a,c){return wf(LL(a,c),c)},to_sheet:LL,from_sheet:function(a,c){var u,f,m=["ID;PWXL;N;E"],v=[],p=un(a["!ref"]),w=Array.isArray(a),S=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),a["!cols"]&&(u=m,a["!cols"].forEach(function(M,N){N="F;W"+(N+1)+" "+(N+1)+" ",M.hidden?N+="0":(typeof M.width!="number"||M.wpx||(M.wpx=iv(M.width)),typeof M.wpx!="number"||M.wch||(M.wch=sv(M.wpx)),typeof M.wch=="number"&&(N+=Math.round(M.wch))),N.charAt(N.length-1)!=" "&&u.push(N)})),a["!rows"]&&(f=m,a["!rows"].forEach(function(M,N){var U="F;";M.hidden?U+="M0;":M.hpt?U+="M"+20*M.hpt+";":M.hpx&&(U+="M"+20*ov(M.hpx)+";"),2<U.length&&f.push(U+"R"+(N+1))})),m.push("B;Y"+(p.e.r-p.s.r+1)+";X"+(p.e.c-p.s.c+1)+";D"+[p.s.c,p.s.r,p.e.c,p.e.r].join(" "));for(var b=p.s.r;b<=p.e.r;++b)for(var T=p.s.c;T<=p.e.c;++T){var P=Fr({r:b,c:T});(P=w?(a[b]||[])[T]:a[P])&&(P.v!=null||P.f&&!P.F)&&v.push(function(M,N,U){var B="C;Y"+(N+1)+";X"+(U+1)+";K";switch(M.t){case"n":B+=M.v||0,M.f&&!M.F&&(B+=";E"+yA(M.f,{r:N,c:U}));break;case"b":B+=M.v?"TRUE":"FALSE";break;case"e":B+=M.w||M.v;break;case"d":B+='"'+(M.w||M.v)+'"';break;case"s":B+='"'+M.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return B}(P,b,T))}return m.join(S)+S+v.join(S)+S+"E"+S}});function MS(M,c){var u,f,m=M.split(/[\n\r]+/),v=-1,p=-1,w=0,S=0,b=[],T=[],P=null,M={},N=[],U=[],B=0;for(0<=+c.codepage&&y(+c.codepage);w!==m.length;++w){B=0;var Z,G=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,NL).replace(ML,kL),W=G.replace(/;;/g,"\0").split(";").map(function(yt){return yt.replace(/\u0000/g,";")}),J=W[0];if(0<G.length)switch(J){case"ID":case"E":case"B":case"O":case"W":break;case"P":W[1].charAt(0)=="P"&&T.push(G.slice(3).replace(/;;/g,";"));break;case"C":for(var ne=!1,se=!1,be=!1,De=!1,Pe=-1,je=-1,S=1;S<W.length;++S)switch(W[S].charAt(0)){case"A":break;case"X":p=parseInt(W[S].slice(1))-1,se=!0;break;case"Y":for(v=parseInt(W[S].slice(1))-1,se||(p=0),f=b.length;f<=v;++f)b[f]=[];break;case"K":(Z=W[S].slice(1)).charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN($e(Z))?isNaN(ie(Z).getDate())||(Z=ue(Z)):(Z=$e(Z),P!==null&&xi(P)&&(Z=ee(Z))),n!==void 0&&typeof Z=="string"&&(c||{}).type!="string"&&(c||{}).codepage&&(Z=n.utils.decode(c.codepage,Z)),ne=!0;break;case"E":De=!0;var it=gm(W[S].slice(1),{r:v,c:p});b[v][p]=[b[v][p],it];break;case"S":be=!0,b[v][p]=[b[v][p],"S5S"];break;case"G":break;case"R":Pe=parseInt(W[S].slice(1))-1;break;case"C":je=parseInt(W[S].slice(1))-1;break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}if(ne&&(b[v][p]&&b[v][p].length==2?b[v][p][0]=Z:b[v][p]=Z,P=null),be){if(De)throw new Error("SYLK shared formula cannot have own formula");var st=-1<Pe&&b[Pe][je];if(!st||!st[1])throw new Error("SYLK shared formula cannot find base");b[v][p][1]=F8(st[1],{r:v-Pe,c:p-je})}break;case"F":var Ke=0;for(S=1;S<W.length;++S)switch(W[S].charAt(0)){case"X":p=parseInt(W[S].slice(1))-1,++Ke;break;case"Y":for(v=parseInt(W[S].slice(1))-1,f=b.length;f<=v;++f)b[f]=[];break;case"M":B=parseInt(W[S].slice(1))/20;break;case"F":case"G":break;case"P":P=T[parseInt(W[S].slice(1))];break;case"S":case"D":case"N":break;case"W":for(u=W[S].slice(1).split(" "),f=parseInt(u[0],10);f<=parseInt(u[1],10);++f)B=parseInt(u[2],10),U[f-1]=B===0?{hidden:!0}:{wch:B},Cf(U[f-1]);break;case"C":U[p=parseInt(W[S].slice(1))-1]||(U[p]={});break;case"R":N[v=parseInt(W[S].slice(1))-1]||(N[v]={}),0<B?(N[v].hpt=B,N[v].hpx=fm(B)):B===0&&(N[v].hidden=!0);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}Ke<1&&(P=null);break;default:if(c&&c.WTF)throw new Error("SYLK bad record "+G)}}return 0<N.length&&(M["!rows"]=N),0<U.length&&(M["!cols"]=U),[b=c&&c.sheetRows?b.slice(0,c.sheetRows):b,M]}function LL(f,c){var u=function(p,w){switch(w.type){case"base64":return MS(z(p),w);case"binary":return MS(p,w);case"buffer":return MS(q&&Buffer.isBuffer(p)?p.toString("binary"):Re(p),w);case"array":return MS(ve(p),w)}throw new Error("Unrecognized type "+w.type)}(f,c),f=u[0],m=u[1],v=sm(f,c);return ai(m).forEach(function(p){v[p]=m[p]}),v}var HL={to_workbook:function(a,c){return wf($L(a,c),c)},to_sheet:$L,from_sheet:function(a){var c=[],u=un(a["!ref"]),f=Array.isArray(a);NS(c,"TABLE",0,1,"sheetjs"),NS(c,"VECTORS",0,u.e.r-u.s.r+1,""),NS(c,"TUPLES",0,u.e.c-u.s.c+1,""),NS(c,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){Jc(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var p,w=Fr({r:m,c:v});if(p=f?(a[m]||[])[v]:a[w])switch(p.t){case"n":var S=p.w;(S=!S&&p.v!=null?p.v:S)==null?p.f&&!p.F?Jc(c,1,0,"="+p.f):Jc(c,1,0,""):Jc(c,0,S,"V");break;case"b":Jc(c,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":Jc(c,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Lr(p.z||D[14],hi(ue(p.v)))),Jc(c,0,p.w,"V");break;default:Jc(c,1,0,"")}else Jc(c,1,0,"")}}return Jc(c,-1,0,"EOD"),c.join(`\r
`)}};function kS(a,c){for(var u=a.split(`
`),f=-1,m=-1,v=0,p=[];v!==u.length;++v)if(u[v].trim()!=="BOT"){if(!(f<0)){for(var w=u[v].trim().split(","),S=w[0],b=w[1],T=u[++v]||"";1&(T.match(/["]/g)||[]).length&&v<u.length-1;)T+=`
`+u[++v];switch(T=T.trim(),+S){case-1:if(T==="BOT"){p[++f]=[],m=0;continue}if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?p[f][m]=!0:T==="FALSE"?p[f][m]=!1:isNaN($e(b))?isNaN(ie(b).getDate())?p[f][m]=b:p[f][m]=ue(b):p[f][m]=$e(b),++m;break;case 1:T=(T=T.slice(1,T.length-1)).replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),p[f][m++]=T!==""?T:null}if(T==="EOD")break}}else p[++f]=[],m=0;return p=c&&c.sheetRows?p.slice(0,c.sheetRows):p}function $L(a,c){return sm(function(u,f){switch(f.type){case"base64":return kS(z(u),f);case"binary":return kS(u,f);case"buffer":return kS(q&&Buffer.isBuffer(u)?u.toString("binary"):Re(u),f);case"array":return kS(ve(u),f)}throw new Error("Unrecognized type "+f.type)}(a,c),c)}function NS(a,c,u,f,m){a.push(c),a.push(u+","+f),a.push('"'+m.replace(/"/g,'""')+'"')}function Jc(a,c,u,f){a.push(c+","+u),a.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)}var BL,sA,VL,WL,jL=(BL=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),sA=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,VL=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),WL="--SocialCalcSpreadsheetControlSave--",{to_workbook:function(a,c){return wf(UL(a,c),c)},to_sheet:UL,from_sheet:function(a){return[BL,sA,VL,sA,function(c){if(!c||!c["!ref"])return"";for(var u,f,m=[],v=[],p=Vo(c["!ref"]),w=Array.isArray(c),S=p.s.r;S<=p.e.r;++S)for(var b=p.s.c;b<=p.e.c;++b)if(f=Fr({r:S,c:b}),(u=w?(c[S]||[])[b]:c[f])&&u.v!=null&&u.t!=="z"){switch(v=["cell",f,"t"],u.t){case"s":case"str":v.push(oA(u.v));break;case"n":u.f?(v[2]="vtf",v[3]="n",v[4]=u.v,v[5]=oA(u.f)):(v[2]="v",v[3]=u.v);break;case"b":v[2]="vt"+(u.f?"f":"c"),v[3]="nl",v[4]=u.v?"1":"0",v[5]=oA(u.f||(u.v?"TRUE":"FALSE"));break;case"d":var T=hi(ue(u.v));v[2]="vtc",v[3]="nd",v[4]=""+T,v[5]=u.w||Lr(u.z||D[14],T);break;case"e":continue}m.push(v.join(":"))}return m.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}(a),WL].join(`
`)}});function oA(a){return a.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function UL(a,c){return sm(function(u,f){for(var m,v=u.split(`
`),p=-1,w=0,S=[];w!==v.length;++w){var b=v[w].trim().split(":");if(b[0]==="cell"){var T=Ii(b[1]);if(S.length<=T.r)for(p=S.length;p<=T.r;++p)S[p]||(S[p]=[]);switch(p=T.r,m=T.c,b[2]){case"t":S[p][m]=b[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`);break;case"v":S[p][m]=+b[3];break;case"vtf":var P=b[b.length-1];case"vtc":b[3]==="nl"?S[p][m]=!!+b[4]:S[p][m]=+b[4],b[2]=="vtf"&&(S[p][m]=[S[p][m],P])}}}return S=f&&f.sheetRows?S.slice(0,f.sheetRows):S}(a,c),c)}var aA,DS,cm=(aA={44:",",9:"	",59:";",124:"|"},DS={44:3,9:2,59:1,124:0},{to_workbook:function(a,c){return wf(YL(a,c),c)},to_sheet:YL,from_sheet:function(a){for(var c=[],u=un(a["!ref"]),f=Array.isArray(a),m=u.s.r;m<=u.e.r;++m){for(var v=[],p=u.s.c;p<=u.e.c;++p){var w=Fr({r:m,c:p});if((w=f?(a[m]||[])[p]:a[w])&&w.v!=null){for(var S=(w.w||(Xc(w),w.w)||"").slice(0,10);S.length<10;)S+=" ";v.push(S+(p===0?" ":""))}else v.push("          ")}c.push(v.join(""))}return c.join(`
`)}});function zL(a,c,u,f,m){m.raw?c[u][f]=a:a===""||(a==="TRUE"?c[u][f]=!0:a==="FALSE"?c[u][f]=!1:isNaN($e(a))?isNaN(ie(a).getDate())?c[u][f]=a:c[u][f]=ue(a):c[u][f]=$e(a))}function GL(a){for(var c={},u=!1,f=0,m=0;f<a.length;++f)(m=a.charCodeAt(f))==34?u=!u:!u&&m in aA&&(c[m]=(c[m]||0)+1);for(f in m=[],c)Object.prototype.hasOwnProperty.call(c,f)&&m.push([c[f],f]);if(!m.length)for(f in c=DS)Object.prototype.hasOwnProperty.call(c,f)&&m.push([c[f],f]);return m.sort(function(v,p){return v[0]-p[0]||DS[v[1]]-DS[p[1]]}),aA[m.pop()[1]]||44}function _re(a,f){var u=f||{},f="",m=u.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};a.slice(0,4)=="sep="?a.charCodeAt(5)==13&&a.charCodeAt(6)==10?(f=a.charAt(4),a=a.slice(7)):a.charCodeAt(5)==13||a.charCodeAt(5)==10?(f=a.charAt(4),a=a.slice(6)):f=GL(a.slice(0,1024)):f=u.FS?u.FS:GL(a.slice(0,1024));var p=0,w=0,S=0,b=0,T=0,P=f.charCodeAt(0),M=!1,N=0,U=a.charCodeAt(0);a=a.replace(/\r\n/gm,`
`);var B=u.dateNF!=null?(f=(f=typeof(f=u.dateNF)=="number"?D[f]:f).replace(Oi,"(\\d+)"),new RegExp("^"+f+"$")):null;function Z(){var G,W=a.slice(b,T),J={};if((W=W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'?W.slice(1,-1).replace(/""/g,'"'):W).length===0?J.t="z":u.raw||W.trim().length===0?(J.t="s",J.v=W):W.charCodeAt(0)==61?W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(J.t="s",J.v=W.slice(2,-1).replace(/""/g,'"')):W.length!=1?(J.t="n",J.f=W.slice(1)):(J.t="s",J.v=W):W=="TRUE"?(J.t="b",J.v=!0):W=="FALSE"?(J.t="b",J.v=!1):isNaN(S=$e(W))?!isNaN(ie(W).getDate())||B&&W.match(B)?(J.z=u.dateNF||D[14],G=0,B&&W.match(B)&&(W=function(ne,se){var be=-1,De=-1,Pe=-1,je=-1,it=-1,st=-1;(ne.match(Oi)||[]).forEach(function(yt,Wt){var Ht=parseInt(se[Wt+1],10);switch(yt.toLowerCase().charAt(0)){case"y":be=Ht;break;case"d":Pe=Ht;break;case"h":je=Ht;break;case"s":st=Ht;break;case"m":0<=je?it=Ht:De=Ht}}),0<=st&&it==-1&&0<=De&&(it=De,De=-1);var Ke=(""+(0<=be?be:new Date().getFullYear())).slice(-4)+"-"+("00"+(1<=De?De:1)).slice(-2)+"-"+("00"+(1<=Pe?Pe:1)).slice(-2);return(Ke=Ke.length==7?"0"+Ke:Ke).length==8&&(Ke="20"+Ke),ne=("00"+(0<=je?je:0)).slice(-2)+":"+("00"+(0<=it?it:0)).slice(-2)+":"+("00"+(0<=st?st:0)).slice(-2),je==-1&&it==-1&&st==-1?Ke:be==-1&&De==-1&&Pe==-1?ne:Ke+"T"+ne}(u.dateNF,W.match(B)||[]),G=1),u.cellDates?(J.t="d",J.v=ue(W,G)):(J.t="n",J.v=hi(ue(W,G))),u.cellText!==!1&&(J.w=Lr(J.z,J.v instanceof Date?hi(J.v):J.v)),u.cellNF||delete J.z):(J.t="s",J.v=W):(!(J.t="n")!==u.cellText&&(J.w=W),J.v=S),J.t=="z"||(u.dense?(m[p]||(m[p]=[]),m[p][w]=J):m[Fr({c:w,r:p})]=J),b=T+1,U=a.charCodeAt(b),v.e.c<w&&(v.e.c=w),v.e.r<p&&(v.e.r=p),N!=P)return w=0,++p,u.sheetRows&&u.sheetRows<=p?1:void 0;++w}e:for(;T<a.length;++T)switch(N=a.charCodeAt(T)){case 34:U===34&&(M=!M);break;case P:case 10:case 13:if(!M&&Z())break e}return 0<T-b&&Z(),m["!ref"]=Wr(v),m}function Rre(a,c){return!c||!c.PRN||c.FS||a.slice(0,4)=="sep="||0<=a.indexOf("	")||0<=a.indexOf(",")||0<=a.indexOf(";")?_re(a,c):sm(function(u,f){var m=f||{},v=[];if(!u||u.length===0)return v;for(var p=u.split(/[\r\n]/),w=p.length-1;0<=w&&p[w].length===0;)--w;for(var S=10,b=0,T=0;T<=w;++T)(b=p[T].indexOf(" "))==-1?b=p[T].length:b++,S=Math.max(S,b);for(T=0;T<=w;++T){v[T]=[];var P=0;for(zL(p[T].slice(0,S).trim(),v,T,P,m),P=1;P<=(p[T].length-S)/10+1;++P)zL(p[T].slice(S+10*(P-1),S+10*P).trim(),v,T,P,m)}return v=m.sheetRows?v.slice(0,m.sheetRows):v}(a,c),c)}function YL(a,c){var u="",f=c.type=="string"?[0,0,0,0]:NA(a,c);switch(c.type){case"base64":u=z(a);break;case"binary":u=a;break;case"buffer":u=c.codepage==65001?a.toString("utf8"):c.codepage&&n!==void 0?n.utils.decode(c.codepage,a):q&&Buffer.isBuffer(a)?a.toString("binary"):Re(a);break;case"array":u=ve(a);break;case"string":u=a;break;default:throw new Error("Unrecognized type "+c.type)}return f[0]==239&&f[1]==187&&f[2]==191?u=Qn(u.slice(3)):c.type!="string"&&c.type!="buffer"&&c.codepage==65001?u=Qn(u):c.type=="binary"&&n!==void 0&&c.codepage&&(u=n.utils.decode(c.codepage,n.utils.encode(28591,u))),u.slice(0,19)=="socialcalc:version:"?jL.to_sheet(c.type=="string"?u:Qn(u),c):Rre(u,c)}var LS,lA,cA,KL,e0=(LS={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},lA=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""],cA={0:{n:"BOF",f:us},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(a,c,u){var f={s:{c:0,r:0},e:{c:0,r:0}};return c==8&&u.qpro?(f.s.c=a.read_shift(1),a.l++,f.s.r=a.read_shift(2),f.e.c=a.read_shift(1),a.l++,f.e.r=a.read_shift(2)):(f.s.c=a.read_shift(2),f.s.r=a.read_shift(2),c==12&&u.qpro&&(a.l+=2),f.e.c=a.read_shift(2),f.e.r=a.read_shift(2),c==12&&u.qpro&&(a.l+=2),f.s.c==65535&&(f.s.c=f.e.c=f.s.r=f.e.r=0)),f}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(a,c,u){return(u=HS(a,0,u))[1].v=a.read_shift(2,"i"),u}},14:{n:"NUMBER",f:function(a,c,u){return(u=HS(a,0,u))[1].v=a.read_shift(8,"f"),u}},15:{n:"LABEL",f:qL},16:{n:"FORMULA",f:function(a,c,u){var f=a.l+c;return(c=HS(a,0,u))[1].v=a.read_shift(8,"f"),u.qpro?a.l=f:(f=a.read_shift(2),function(m,v){Zs(m,0);for(var p=[],w=0,S="",b="",T="",P="";m.l<m.length;){var M=m[m.l++];switch(M){case 0:p.push(m.read_shift(8,"f"));break;case 1:b=um(v[0].c,m.read_shift(2),!0),S=um(v[0].r,m.read_shift(2),!1),p.push(b+S);break;case 2:var N=um(v[0].c,m.read_shift(2),!0),U=um(v[0].r,m.read_shift(2),!1);b=um(v[0].c,m.read_shift(2),!0),S=um(v[0].r,m.read_shift(2),!1),p.push(N+U+":"+b+S);break;case 3:if(m.l<m.length)return console.error("WK1 premature formula end");break;case 4:p.push("("+p.pop()+")");break;case 5:p.push(m.read_shift(2));break;case 6:for(var B="";M=m[m.l++];)B+=String.fromCharCode(M);p.push('"'+B.replace(/"/g,'""')+'"');break;case 8:p.push("-"+p.pop());break;case 23:p.push("+"+p.pop());break;case 22:p.push("NOT("+p.pop()+")");break;case 20:case 21:P=p.pop(),T=p.pop(),p.push(["AND","OR"][M-20]+"("+T+","+P+")");break;default:if(M<32&&lA[M])P=p.pop(),T=p.pop(),p.push(T+lA[M]+P);else{if(!LS[M])return M<=7?console.error("WK1 invalid opcode "+M.toString(16)):M<=24?console.error("WK1 unsupported op "+M.toString(16)):M<=30?console.error("WK1 invalid opcode "+M.toString(16)):M<=115?console.error("WK1 unsupported function opcode "+M.toString(16)):console.error("WK1 unrecognized opcode "+M.toString(16));if((w=(w=LS[M][1])==69?m[m.l++]:w)>p.length)return console.error("WK1 bad formula parse 0x"+M.toString(16)+":|"+p.join("|")+"|");U=p.slice(-w),p.length-=w,p.push(LS[M][0]+"("+U.join(",")+")")}}}p.length==1?v[1].f=""+p[0]:console.error("WK1 bad formula parse |"+p.join("|")+"|")}(a.slice(a.l,a.l+f),c),a.l+=f),c}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:qL},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ZL},222:{n:"SHEETNAMELP",f:function(a,c){var u=a[a.l++];c-1<u&&(u=c-1);for(var f="";f.length<u;)f+=String.fromCharCode(a[a.l++]);return f}},65535:{n:""}},KL={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(a,c){var u=rv(a);return u[1].t="s",u[1].v=a.read_shift(c-4,"cstr"),u}},23:{n:"NUMBER17",f:JL},24:{n:"NUMBER18",f:function(a,c){var u=rv(a);u[1].v=a.read_shift(2);var f=u[1].v>>1;if(1&u[1].v)switch(7&f){case 0:f=5e3*(f>>3);break;case 1:f=500*(f>>3);break;case 2:f=(f>>3)/20;break;case 3:f=(f>>3)/200;break;case 4:f=(f>>3)/2e3;break;case 5:f=(f>>3)/2e4;break;case 6:f=(f>>3)/16;break;case 7:f=(f>>3)/64}return u[1].v=f,u}},25:{n:"FORMULA19",f:function(a,c){var u=JL(a);return a.l+=c-14,u}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(a,c){for(var u={},f=a.l+c;a.l<f;){var m=a.read_shift(2);if(m==14e3){for(u[m]=[0,""],u[m][0]=a.read_shift(2);a[a.l];)u[m][1]+=String.fromCharCode(a[a.l]),a.l++;a.l++}}return u}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(f,c){var u=rv(f),f=f.read_shift(4);return u[1].v=f>>6,u}},38:{n:"??"},39:{n:"NUMBER27",f:QL},40:{n:"FORMULA28",f:function(a,c){var u=QL(a);return a.l+=c-10,u}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ZL},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(a,c,u){if(u.qpro&&!(c<21))return u=a.read_shift(1),a.l+=17,a.l+=1,a.l+=2,[u,a.read_shift(c-21,"cstr")]}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},{sheet_to_wk1:function(a,c){var u=c||{};if(0<=+u.codepage&&y(+u.codepage),u.type=="string")throw new Error("Cannot write WK1 to JS string");var f=ga(),m=un(a["!ref"]),v=Array.isArray(a),p=[];Dt(f,0,(c=1030,(u=tt(2)).write_shift(2,c),u)),Dt(f,6,(c=m,(u=tt(8)).write_shift(2,c.s.c),u.write_shift(2,c.s.r),u.write_shift(2,c.e.c),u.write_shift(2,c.e.r),u));for(var w,S,b,T,P=Math.min(m.e.r,8191),M=m.s.r;M<=P;++M)for(var N=Ui(M),U=m.s.c;U<=m.e.c;++U){M===m.s.r&&(p[U]=gi(U));var B=p[U]+N,B=v?(a[M]||[])[U]:a[B];B&&B.t!="z"&&(B.t=="n"?(0|B.v)==B.v&&-32768<=B.v&&B.v<=32767?Dt(f,13,(w=M,S=U,b=B.v,T=void 0,(T=tt(7)).write_shift(1,255),T.write_shift(2,S),T.write_shift(2,w),T.write_shift(2,b,"i"),T)):Dt(f,14,(S=M,w=U,b=B.v,T=void 0,(T=tt(13)).write_shift(1,255),T.write_shift(2,w),T.write_shift(2,S),T.write_shift(8,b,"f"),T)):Dt(f,15,function(Z,G,W){var J=tt(7+W.length);J.write_shift(1,255),J.write_shift(2,G),J.write_shift(2,Z),J.write_shift(1,39);for(var ne=0;ne<J.length;++ne){var se=W.charCodeAt(ne);J.write_shift(1,128<=se?95:se)}return J.write_shift(1,0),J}(M,U,Xc(B).slice(0,239))))}return Dt(f,1),f.end()},book_to_wk3:function(a,c){if(0<=+(c=c||{}).codepage&&y(+c.codepage),c.type=="string")throw new Error("Cannot write WK3 to JS string");var u=ga();Dt(u,0,function(B){var Z=tt(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var G=0,W=0,J=0,ne=0;ne<B.SheetNames.length;++ne){var se=B.SheetNames[ne],se=B.Sheets[se];se&&se["!ref"]&&(++J,se=Vo(se["!ref"]),G<se.e.r&&(G=se.e.r),W<se.e.c&&(W=se.e.c))}return 8191<G&&(G=8191),Z.write_shift(2,G),Z.write_shift(1,J),Z.write_shift(1,W),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}(a));for(var f=0,m=0;f<a.SheetNames.length;++f)(a.Sheets[a.SheetNames[f]]||{})["!ref"]&&Dt(u,27,function(B,Z){var G=tt(5+B.length);G.write_shift(2,14e3),G.write_shift(2,Z);for(var W=0;W<B.length;++W){var J=B.charCodeAt(W);G[G.l++]=127<J?95:J}return G[G.l++]=0,G}(a.SheetNames[f],m++));for(var v=0,f=0;f<a.SheetNames.length;++f){var p=a.Sheets[a.SheetNames[f]];if(p&&p["!ref"]){for(var w=un(p["!ref"]),S=Array.isArray(p),b=[],T=Math.min(w.e.r,8191),P=w.s.r;P<=T;++P)for(var M=Ui(P),N=w.s.c;N<=w.e.c;++N){P===w.s.r&&(b[N]=gi(N));var U=b[N]+M,U=S?(p[P]||[])[N]:p[U];U&&U.t!="z"&&(U.t=="n"?Dt(u,23,function(be,Pe,De,J){var ne=tt(14);if(ne.write_shift(2,be),ne.write_shift(1,De),ne.write_shift(1,Pe),J==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var se=0,be=0,De=0,Pe=0;return J<0&&(se=1,J=-J),be=0|Math.log2(J),J/=Math.pow(2,be-31),!(2147483648&(Pe=J>>>0))&&(++be,Pe=(J/=2)>>>0),J-=Pe,Pe|=2147483648,Pe>>>=0,J*=Math.pow(2,32),De=J>>>0,ne.write_shift(4,De),ne.write_shift(4,Pe),be+=16383+(se?32768:0),ne.write_shift(2,be),ne}(P,N,v,U.v)):Dt(u,22,function(Z,G,W,J){var ne=tt(6+J.length);ne.write_shift(2,Z),ne.write_shift(1,W),ne.write_shift(1,G),ne.write_shift(1,39);for(var se=0;se<J.length;++se){var be=J.charCodeAt(se);ne.write_shift(1,128<=be?95:be)}return ne.write_shift(1,0),ne}(P,N,v,Xc(U).slice(0,239))))}++v}}return Dt(u,1),u.end()},to_workbook:function(a,c){switch(c.type){case"base64":return uA(me(z(a)),c);case"binary":return uA(me(a),c);case"buffer":case"array":return uA(a,c)}throw"Unsupported type "+c.type}});function XL(a,c,u){if(a){Zs(a,a.l||0);for(var f=u.Enum||cA;a.l<a.length;){var m=a.read_shift(2),v=f[m]||f[65535],w=a.read_shift(2),p=a.l+w,w=v.f&&v.f(a,w,u);if(a.l=p,c(w,v,m))return}}}function uA(a,c){if(!a)return a;var u=c||{},f=u.dense?[]:{},m="Sheet1",v="",p=0,w={},S=[],b=[],T={s:{r:0,c:0},e:{r:0,c:0}},P=u.sheetRows||0;if(a[2]==0&&(a[3]==8||a[3]==9)&&16<=a.length&&a[14]==5&&a[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(a[2]==2)u.Enum=cA,XL(a,function(B,Z,G){switch(G){case 0:4096<=(u.vers=B)&&(u.qpro=!0);break;case 6:T=B;break;case 204:B&&(v=B);break;case 222:v=B;break;case 15:case 51:u.qpro||(B[1].v=B[1].v.slice(1));case 13:case 14:case 16:G==14&&(112&B[2])==112&&1<(15&B[2])&&(15&B[2])<15&&(B[1].z=u.dateNF||D[14],u.cellDates&&(B[1].t="d",B[1].v=ee(B[1].v))),u.qpro&&B[3]>p&&(f["!ref"]=Wr(T),w[m]=f,S.push(m),f=u.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},p=B[3],m=v||"Sheet"+(p+1),v="");var W=u.dense?(f[B[0].r]||[])[B[0].c]:f[Fr(B[0])];if(W){W.t=B[1].t,W.v=B[1].v,B[1].z!=null&&(W.z=B[1].z),B[1].f!=null&&(W.f=B[1].f);break}u.dense?(f[B[0].r]||(f[B[0].r]=[]),f[B[0].r][B[0].c]=B[1]):f[Fr(B[0])]=B[1]}},u);else{if(a[2]!=26&&a[2]!=14)throw new Error("Unrecognized LOTUS BOF "+a[2]);u.Enum=KL,a[2]==14&&(u.qpro=!0,a.l=0),XL(a,function(B,Z,G){switch(G){case 204:m=B;break;case 22:B[1].v=B[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(B[3]>p&&(f["!ref"]=Wr(T),w[m]=f,S.push(m),f=u.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},p=B[3],m="Sheet"+(p+1)),0<P&&B[0].r>=P)break;u.dense?(f[B[0].r]||(f[B[0].r]=[]),f[B[0].r][B[0].c]=B[1]):f[Fr(B[0])]=B[1],T.e.c<B[0].c&&(T.e.c=B[0].c),T.e.r<B[0].r&&(T.e.r=B[0].r);break;case 27:B[14e3]&&(b[B[14e3][0]]=B[14e3][1]);break;case 1537:b[B[0]]=B[1],B[0]==p&&(m=B[1])}},u)}if(f["!ref"]=Wr(T),w[v||m]=f,S.push(v||m),!b.length)return{SheetNames:S,Sheets:w};for(var M={},N=[],U=0;U<b.length;++U)w[S[U]]?(N.push(b[U]||S[U]),M[b[U]]=w[b[U]]||w[S[U]]):(N.push(b[U]),M[b[U]]={"!ref":"A1"});return{SheetNames:N,Sheets:M}}function HS(a,c,u){var f=[{c:0,r:0},{t:"n",v:0},0,0];return u.qpro&&u.vers!=20768?(f[0].c=a.read_shift(1),f[3]=a.read_shift(1),f[0].r=a.read_shift(2),a.l+=2):(f[2]=a.read_shift(1),f[0].c=a.read_shift(2),f[0].r=a.read_shift(2)),f}function qL(a,m,u){var f=a.l+m,m=HS(a,0,u);return m[1].t="s",u.vers!=20768?(u.qpro&&a.l++,m[1].v=a.read_shift(f-a.l,"cstr"),m):(a.l++,f=a.read_shift(1),m[1].v=a.read_shift(f,"utf8"),m)}function um(a,c,u){var f=32768&c;return(f?"":"$")+(u?gi:Ui)(c=(f?a:0)+(8192<=(c&=-32769)?c-16384:c))}function rv(a){var c=[{c:0,r:0},{t:"n",v:0},0];return c[0].r=a.read_shift(2),c[3]=a[a.l++],c[0].c=a[a.l++],c}function JL(v,c){var u=rv(v),f=v.read_shift(4),m=v.read_shift(4);if((p=v.read_shift(2))==65535)return f===0&&m===3221225472?(u[1].t="e",u[1].v=15):f===0&&m===3489660928?(u[1].t="e",u[1].v=42):u[1].v=0,u;var v=32768&p,p=(32767&p)-16446;return u[1].v=(1-2*v)*(m*Math.pow(2,32+p)+f*Math.pow(2,p)),u}function QL(f,c){var u=rv(f),f=f.read_shift(8,"f");return u[1].v=f,u}function ZL(a,c){return a[a.l+c-1]==0?a.read_shift(c,"cstr"):""}var e8,t8,r8,n8,Are=(e8=z1("t"),t8=z1("rPr"),r8=/<(?:\w+:)?r>/g,n8=/<\/(?:\w+:)?r>/,function(a){return a.replace(r8,"").split(n8).map(Ore).filter(function(c){return c.v})});function Ore(a){var c=a.match(e8);return c?(c={t:"s",v:Sn(c[1])},a=a.match(t8),a&&(c.s=function(u){var f={},m=u.match(po),v=0,p=!1;if(m)for(;v!=m.length;++v){var w=Pr(m[v]);switch(w[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!w.val)break;case"<shadow>":case"<shadow/>":f.shadow=1;break;case"</shadow>":break;case"<charset":if(w.val=="1")break;f.cp=d[parseInt(w.val,10)];break;case"<outline":if(!w.val)break;case"<outline>":case"<outline/>":f.outline=1;break;case"</outline>":break;case"<rFont":f.name=w.val;break;case"<sz":f.sz=w.val;break;case"<strike":if(!w.val)break;case"<strike>":case"<strike/>":f.strike=1;break;case"</strike>":break;case"<u":if(!w.val)break;switch(w.val){case"double":f.uval="double";break;case"singleAccounting":f.uval="single-accounting";break;case"doubleAccounting":f.uval="double-accounting"}case"<u>":case"<u/>":f.u=1;break;case"</u>":break;case"<b":if(w.val=="0")break;case"<b>":case"<b/>":f.b=1;break;case"</b>":break;case"<i":if(w.val=="0")break;case"<i>":case"<i/>":f.i=1;break;case"</i>":break;case"<color":w.rgb&&(f.color=w.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":f.family=w.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":f.valign=w.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;default:if(w[0].charCodeAt(1)!==47&&!p)throw new Error("Unrecognized rich format "+w[0])}}return f}(a[1])),c):{t:"s",v:""}}var i8,Ire=(i8=/(\r\n|\n)/g,function(a){return a.map(Pre).join("")});function Pre(a){var c,u,f,m=[[],a.v,[]];return a.v?(a.s&&(c=a.s,u=m[0],f=m[2],a=[],c.u&&a.push("text-decoration: underline;"),c.uval&&a.push("text-underline-style:"+c.uval+";"),c.sz&&a.push("font-size:"+c.sz+"pt;"),c.outline&&a.push("text-effect: outline;"),c.shadow&&a.push("text-shadow: auto;"),u.push('<span style="'+a.join("")+'">'),c.b&&(u.push("<b>"),f.push("</b>")),c.i&&(u.push("<i>"),f.push("</i>")),c.strike&&(u.push("<s>"),f.push("</s>")),(a=c.valign||"")=="superscript"||a=="super"?a="sup":a=="subscript"&&(a="sub"),a!=""&&(u.push("<"+a+">"),f.push("</"+a+">")),f.push("</span>")),m[0].join("")+m[1].replace(i8,"<br/>")+m[2].join("")):""}var Fre=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Mre=/<(?:\w+:)?r>/,kre=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hA(a,f){var u=!f||f.cellHTML,f={};return a?(a.match(/^\s*<(?:\w+:)?t[^>]*>/)?(f.t=Sn(Qn(a.slice(a.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),f.r=Qn(a),u&&(f.h=IR(f.t))):a.match(Mre)&&(f.r=Qn(a),f.t=Sn(Qn((a.replace(kre,"").match(Fre)||[]).join("").replace(po,""))),u&&(f.h=Ire(Are(f.r)))),f):{t:""}}var Nre=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Dre=/<(?:\w+:)?(?:si|sstItem)>/g,Lre=/<\/(?:\w+:)?(?:si|sstItem)>/,Hre=/^\s|\s$|[\t\n\r]/;function s8(a,c){if(!c.bookSST)return"";var u=[fi];u[u.length]=Nt("sst",null,{xmlns:Ud[0],count:a.Count,uniqueCount:a.Unique});for(var f,m,v=0;v!=a.length;++v)a[v]!=null&&(m="<si>",(f=a[v]).r?m+=f.r:(m+="<t",f.t||(f.t=""),f.t.match(Hre)&&(m+=' xml:space="preserve"'),m+=">"+Bn(f.t)+"</t>"),m+="</si>",u[u.length]=m);return 2<u.length&&(u[u.length]="</sst>",u[1]=u[1].replace("/>",">")),u.join("")}var $re=function(a,c){var u=!1;return c==null&&(u=!0,c=tt(15+4*a.t.length)),c.write_shift(1,0),Ls(a.t,c),u?c.slice(0,c.l):c};function Bre(a){var c,u,f=ga();ht(f,159,(c=a,(u=u||tt(8)).write_shift(4,c.Count),u.write_shift(4,c.Unique),u));for(var m=0;m<a.length;++m)ht(f,19,$re(a[m]));return ht(f,160),f.end()}function o8(a){if(n!==void 0)return n.utils.encode(l,a);for(var c=[],u=a.split(""),f=0;f<u.length;++f)c[f]=u[f].charCodeAt(0);return c}function sh(a,c){var u={};return u.Major=a.read_shift(2),u.Minor=a.read_shift(2),4<=c&&(a.l+=c-4),u}function Vre(a){var c=[];a.l+=4;for(var u=a.read_shift(4);0<u--;)c.push(function(f){for(var v=f.read_shift(4),m=f.l+v-4,v={},p=f.read_shift(4),w=[];0<p--;)w.push({t:f.read_shift(4),v:f.read_shift(0,"lpp4")});if(v.name=f.read_shift(0,"lpp4"),v.comps=w,f.l!=m)throw new Error("Bad DataSpaceMapEntry: "+f.l+" != "+m);return v}(a));return c}function Wre(a){var c,u,u=(u={},(c=a).read_shift(4),c.l+=4,u.id=c.read_shift(0,"lpp4"),u.name=c.read_shift(0,"lpp4"),u.R=sh(c,4),u.U=sh(c,4),u.W=sh(c,4),u);if(u.ename=a.read_shift(0,"8lpp4"),u.blksz=a.read_shift(4),u.cmode=a.read_shift(4),a.read_shift(4)!=4)throw new Error("Bad !Primary record");return u}function a8(a,u){var u=a.l+u,f={};f.Flags=63&a.read_shift(4),a.l+=4,f.AlgID=a.read_shift(4);var m=!1;switch(f.AlgID){case 26126:case 26127:case 26128:m=f.Flags==36;break;case 26625:m=f.Flags==4;break;case 0:m=f.Flags==16||f.Flags==4||f.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+f.AlgID}if(!m)throw new Error("Encryption Flags/AlgID mismatch");return f.AlgIDHash=a.read_shift(4),f.KeySize=a.read_shift(4),f.ProviderType=a.read_shift(4),a.l+=8,f.CSPName=a.read_shift(u-a.l>>1,"utf16le"),a.l=u,f}function l8(a,f){var u={},f=a.l+f;return a.l+=4,u.Salt=a.slice(a.l,a.l+16),a.l+=16,u.Verifier=a.slice(a.l,a.l+16),a.l+=16,a.read_shift(4),u.VerifierHash=a.slice(a.l,f),a.l=f,u}function jre(a){var c=sh(a);switch(c.Minor){case 2:return[c.Minor,function(m){if((63&m.read_shift(4))!=36)throw new Error("EncryptionInfo mismatch");var f=m.read_shift(4),f=a8(m,f),m=l8(m,m.length-m.l);return{t:"Std",h:f,v:m}}(a)];case 3:return[c.Minor,function(){throw new Error("File is password-protected: ECMA-376 Extensible")}()];case 4:return[c.Minor,function(m){var f=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];m.l+=4;var m=m.read_shift(m.length-m.l,"utf8"),v={};return m.replace(po,function(p){var w=Pr(p);switch(Yc(w[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":f.forEach(function(S){v[S]=w[S]});break;case"<dataIntegrity":v.encryptedHmacKey=w.encryptedHmacKey,v.encryptedHmacValue=w.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":v.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":v.uri=w.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":v.encs.push(w);break;default:throw w[0]}}),v}(a)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+c.Minor)}function fA(a){var c,u=0,f=o8(a),m=f.length+1,v=Y(m);for(v[0]=f.length,c=1;c!=m;++c)v[c]=f[c-1];for(c=m-1;0<=c;--c)u=((16384&u?1:0)|u<<1&32767)^v[c];return 52811^u}var dA,c8,u8,h8=(dA=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],c8=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],u8=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],function(a){for(var c,u,f=o8(a),m=function(S){for(var b=c8[S.length-1],T=104,P=S.length-1;0<=P;--P)for(var M=S[P],N=0;N!=7;++N)64&M&&(b^=u8[T]),M*=2,--T;return b}(f),v=f.length,p=Y(16),w=0;w!=16;++w)p[w]=0;for((1&v)==1&&(c=m>>8,p[v]=hm(dA[0],c),--v,c=255&m,a=f[f.length-1],p[v]=hm(a,c));0<v;)c=m>>8,p[--v]=hm(f[v],c),c=255&m,p[--v]=hm(f[v],c);for(u=(v=15)-f.length;0<u;)c=m>>8,p[v]=hm(dA[u],c),--u,c=255&m,p[--v]=hm(f[v],c),--v,--u;return p});function hm(a,c){return 255&((c=a^c)/2|128*c)}var Ure=function(a){var c=0,u=h8(a);return function(f){return f=function(m,v,p,w,S){var b,T;for(S=S||v,w=w||h8(m),b=0;b!=v.length;++b)T=v[b],T=255&((T^=w[p])>>5|T<<3),S[b]=T,++p;return[S,p,w]}("",f,c,u),c=f[1],f[0]}};function zre(a,c,u){return u=u||{},u.Info=a.read_shift(2),a.l-=2,u.Info===1?u.Data=function(f){var m={},v=m.EncryptionVersionInfo=sh(f,4);if(v.Major!=1||v.Minor!=1)throw"unrecognized version code "+v.Major+" : "+v.Minor;return m.Salt=f.read_shift(16),m.EncryptedVerifier=f.read_shift(16),m.EncryptedVerifierHash=f.read_shift(16),m}(a):u.Data=function(f,m){var v={},p=v.EncryptionVersionInfo=sh(f,4);if(m-=4,p.Minor!=2)throw new Error("unrecognized minor version code: "+p.Minor);if(4<p.Major||p.Major<2)throw new Error("unrecognized major version code: "+p.Major);return v.Flags=f.read_shift(4),m-=4,p=f.read_shift(4),m-=4,v.EncryptionHeader=a8(f,p),m-=p,v.EncryptionVerifier=l8(f,m),v}(a,c),u}var f8={to_workbook:function(a,c){return wf(d8(a,c),c)},to_sheet:d8,from_sheet:function(a){for(var c=["{\\rtf1\\ansi"],u=un(a["!ref"]),f=Array.isArray(a),m=u.s.r;m<=u.e.r;++m){c.push("\\trowd\\trautofit1");for(var v=u.s.c;v<=u.e.c;++v)c.push("\\cellx"+(v+1));for(c.push("\\pard\\intbl"),v=u.s.c;v<=u.e.c;++v){var p=Fr({r:m,c:v});(p=f?(a[m]||[])[v]:a[p])&&(p.v!=null||p.f&&!p.F)&&(c.push(" "+(p.w||(Xc(p),p.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}};function d8(a,c){switch(c.type){case"base64":return $S(z(a),c);case"binary":return $S(a,c);case"buffer":return $S(q&&Buffer.isBuffer(a)?a.toString("binary"):Re(a),c);case"array":return $S(ve(a),c)}throw new Error("Unrecognized type "+c.type)}function $S(f,c){var u=(c||{}).dense?[]:{},f=f.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(v,p){Array.isArray(u)&&(u[p]=[]);for(var w,S=/\\\w+\b/g,b=0,T=-1;w=S.exec(v);)w[0]==="\\cell"&&(++T,(w=(w=v.slice(b,S.lastIndex-w[0].length))[0]==" "?w.slice(1):w).length&&(w={v:w,t:"s"},Array.isArray(u)?u[p][T]=w:u[Fr({r:p,c:T})]=w)),b=S.lastIndex;T>m.e.c&&(m.e.c=T)}),u["!ref"]=Wr(m),u}function nv(a){for(var c=0,u=1;c!=3;++c)u=256*u+(255<a[c]?255:a[c]<0?0:a[c]);return u.toString(16).toUpperCase().slice(1)}function BS(a,c){return c===0?a:(a=function(T){var f=T[0]/255,m=T[1]/255,v=T[2]/255,p=Math.max(f,m,v),w=Math.min(f,m,v),S=p-w;if(S==0)return[0,0,f];var b=0,T=0,T=S/(1<(w=p+w)?2-w:w);switch(p){case f:b=((m-v)/S+6)%6;break;case m:b=(v-f)/S+2;break;case v:b=(f-m)/S+4}return[b/6,T,w/2]}((a=(a=a).slice(a[0]==="#"?1:0).slice(0,6),[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)])),a[2]=c<0?a[2]*(1+c):1-(1-a[2])*(1-c),nv(function(p){var f,m=p[0],v=p[1],p=p[2],w=2*v*(p<.5?p:1-p),S=[p=p-w/2,p,p],b=6*m;if(v!==0)switch(0|b){case 0:case 6:f=w*b,S[0]+=w,S[1]+=f;break;case 1:f=w*(2-b),S[0]+=f,S[1]+=w;break;case 2:f=w*(b-2),S[1]+=w,S[2]+=f;break;case 3:f=w*(4-b),S[1]+=f,S[2]+=w;break;case 4:f=w*(b-4),S[2]+=w,S[0]+=f;break;case 5:f=w*(6-b),S[2]+=f,S[0]+=w}for(var T=0;T!=3;++T)S[T]=Math.round(255*S[T]);return S}(a)))}var g8=6,Gre=15,Yre=1,So=g8;function iv(a){return Math.floor((a+Math.round(128/So)/256)*So)}function sv(a){return Math.floor((a-5)/So*100+.5)/100}function VS(a){return Math.round((a*So+5)/So*256)/256}function gA(a){return VS(sv(iv(a)))}function mA(a){var c=Math.abs(a-gA(a)),u=So;if(.005<c)for(So=Yre;So<Gre;++So)Math.abs(a-gA(a))<=c&&(c=Math.abs(a-gA(a)),u=So);So=u}function Cf(a){a.width?(a.wpx=iv(a.width),a.wch=sv(a.wpx),a.MDW=So):a.wpx?(a.wch=sv(a.wpx),a.width=VS(a.wch),a.MDW=So):typeof a.wch=="number"&&(a.width=VS(a.wch),a.wpx=iv(a.width),a.MDW=So),a.customWidth&&delete a.customWidth}var m8=96;function ov(a){return 96*a/m8}function fm(a){return a*m8/96}var Kre={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},WS=["numFmtId","fillId","fontId","borderId","xfId"],jS=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],p8,v8,w8,y8,C8,av,Xre=(p8=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,v8=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,w8=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,y8=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,C8=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/,function(a,c,u){var f,m,v,p,w,S={};return a&&((f=(a=a.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(p8))&&function(b,T,P){T.NumberFmt=[];for(var M=ai(D),N=0;N<M.length;++N)T.NumberFmt[M[N]]=D[M[N]];var U=b[0].match(po);if(U)for(N=0;N<U.length;++N){var B=Pr(U[N]);switch(Yc(B[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":var Z=Sn(Qn(B.formatCode)),G=parseInt(B.numFmtId,10);if(T.NumberFmt[G]=Z,0<G){if(392<G){for(G=392;60<G&&T.NumberFmt[G]!=null;--G);T.NumberFmt[G]=Z}Nr(Z,G)}break;case"</numFmt>":break;default:if(P.WTF)throw new Error("unrecognized "+B[0]+" in numFmts")}}}(f,S,u),(f=a.match(y8))&&function(b,T,P,M){T.Fonts=[];var N={},U=!1;(b[0].match(po)||[]).forEach(function(B){var Z,G=Pr(B);switch(Yc(G[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":T.Fonts.push(N),N={};break;case"<name":G.val&&(N.name=Qn(G.val));break;case"<name/>":case"</name>":break;case"<b":N.bold=G.val?di(G.val):1;break;case"<b/>":N.bold=1;break;case"<i":N.italic=G.val?di(G.val):1;break;case"<i/>":N.italic=1;break;case"<u":switch(G.val){case"none":N.underline=0;break;case"single":N.underline=1;break;case"double":N.underline=2;break;case"singleAccounting":N.underline=33;break;case"doubleAccounting":N.underline=34}break;case"<u/>":N.underline=1;break;case"<strike":N.strike=G.val?di(G.val):1;break;case"<strike/>":N.strike=1;break;case"<outline":N.outline=G.val?di(G.val):1;break;case"<outline/>":N.outline=1;break;case"<shadow":N.shadow=G.val?di(G.val):1;break;case"<shadow/>":N.shadow=1;break;case"<condense":N.condense=G.val?di(G.val):1;break;case"<condense/>":N.condense=1;break;case"<extend":N.extend=G.val?di(G.val):1;break;case"<extend/>":N.extend=1;break;case"<sz":G.val&&(N.sz=+G.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":G.val&&(N.vertAlign=G.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":G.val&&(N.family=parseInt(G.val,10));break;case"<family/>":case"</family>":break;case"<scheme":G.val&&(N.scheme=G.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(G.val=="1")break;G.codepage=d[parseInt(G.val,10)];break;case"<color":N.color||(N.color={}),G.auto&&(N.color.auto=di(G.auto)),G.rgb?N.color.rgb=G.rgb.slice(-6):G.indexed?(N.color.index=parseInt(G.indexed,10),Z=J1[N.color.index],Z=(Z=N.color.index==81?J1[1]:Z)||J1[1],N.color.rgb=Z[0].toString(16)+Z[1].toString(16)+Z[2].toString(16)):G.theme&&(N.color.theme=parseInt(G.theme,10),G.tint&&(N.color.tint=parseFloat(G.tint)),G.theme&&P.themeElements&&P.themeElements.clrScheme&&(N.color.rgb=BS(P.themeElements.clrScheme[N.color.theme].rgb,N.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":U=!0;break;case"</AlternateContent>":U=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":U=!0;break;case"</ext>":U=!1;break;default:if(M&&M.WTF&&!U)throw new Error("unrecognized "+G[0]+" in fonts")}})}(f,S,c,u),(f=a.match(w8))&&function(b,T,P){T.Fills=[];var M={},N=!1;(b[0].match(po)||[]).forEach(function(U){var B=Pr(U);switch(Yc(B[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":M={},T.Fills.push(M);break;case"</fill>":case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":T.Fills.push(M),M={};break;case"<patternFill":case"<patternFill>":B.patternType&&(M.patternType=B.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":M.bgColor||(M.bgColor={}),B.indexed&&(M.bgColor.indexed=parseInt(B.indexed,10)),B.theme&&(M.bgColor.theme=parseInt(B.theme,10)),B.tint&&(M.bgColor.tint=parseFloat(B.tint)),B.rgb&&(M.bgColor.rgb=B.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":M.fgColor||(M.fgColor={}),B.theme&&(M.fgColor.theme=parseInt(B.theme,10)),B.tint&&(M.fgColor.tint=parseFloat(B.tint)),B.rgb!=null&&(M.fgColor.rgb=B.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":case"</stop>":break;case"<color":case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":N=!0;break;case"</ext>":N=!1;break;default:if(P&&P.WTF&&!N)throw new Error("unrecognized "+B[0]+" in fills")}})}(f,S,u),(f=a.match(C8))&&function(b,T,P){T.Borders=[];var M={},N=!1;(b[0].match(po)||[]).forEach(function(U){var B=Pr(U);switch(Yc(B[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":M={},B.diagonalUp&&(M.diagonalUp=di(B.diagonalUp)),B.diagonalDown&&(M.diagonalDown=di(B.diagonalDown)),T.Borders.push(M);break;case"</border>":case"<left/>":break;case"<left":case"<left>":case"</left>":case"<right/>":break;case"<right":case"<right>":case"</right>":case"<top/>":break;case"<top":case"<top>":case"</top>":case"<bottom/>":break;case"<bottom":case"<bottom>":case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":break;case"<start":case"<start>":case"<start/>":case"</start>":break;case"<end":case"<end>":case"<end/>":case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":N=!0;break;case"</ext>":N=!1;break;default:if(P&&P.WTF&&!N)throw new Error("unrecognized "+B[0]+" in borders")}})}(f,S,u),(f=a.match(v8))&&(f=f,v=u,w=!((m=S).CellXf=[]),(f[0].match(po)||[]).forEach(function(b){var T=Pr(b),P=0;switch(Yc(T[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(delete(p=T)[0],P=0;P<WS.length;++P)p[WS[P]]&&(p[WS[P]]=parseInt(p[WS[P]],10));for(P=0;P<jS.length;++P)p[jS[P]]&&(p[jS[P]]=di(p[jS[P]]));if(m.NumberFmt&&392<p.numFmtId){for(P=392;60<P;--P)if(m.NumberFmt[p.numFmtId]==m.NumberFmt[P]){p.numFmtId=P;break}}m.CellXf.push(p);break;case"</xf>":break;case"<alignment":case"<alignment/>":var M={};T.vertical&&(M.vertical=T.vertical),T.horizontal&&(M.horizontal=T.horizontal),T.textRotation!=null&&(M.textRotation=T.textRotation),T.indent&&(M.indent=T.indent),T.wrapText&&(M.wrapText=di(T.wrapText)),p.alignment=M;break;case"</alignment>":case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":w=!0;break;case"</AlternateContent>":w=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":w=!0;break;case"</ext>":w=!1;break;default:if(v&&v.WTF&&!w)throw new Error("unrecognized "+T[0]+" in cellXfs")}}))),S});function S8(a,c){if(av!==void 0)return av.toXml();var u,f,m,v,p=[fi,Nt("styleSheet",null,{xmlns:Ud[0],"xmlns:vt":Ts.vt})];return a.SSF&&(f=a.SSF,m=["<numFmts>"],[[5,8],[23,26],[41,44],[50,392]].forEach(function(w){for(var S=w[0];S<=w[1];++S)f[S]!=null&&(m[m.length]=Nt("numFmt",null,{numFmtId:S,formatCode:Bn(f[S])}))}),(u=m.length===1?"":(m[m.length]="</numFmts>",m[0]=Nt("numFmts",null,{count:m.length-2}).replace("/>",">"),m.join("")))!=null)&&(p[p.length]=u),p[p.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',p[p.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',p[p.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',p[p.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',c=c.cellXfs,(v=[])[v.length]="<cellXfs/>",c.forEach(function(w){v[v.length]=Nt("xf",null,w)}),v[v.length]="</cellXfs>",(u=v.length===2?"":(v[0]=Nt("cellXfs",null,{count:v.length-2}).replace("/>",">"),v.join("")))&&(p[p.length]=u),p[p.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',p[p.length]='<dxfs count="0"/>',p[p.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',2<p.length&&(p[p.length]="</styleSheet>",p[1]=p[1].replace("/>",">")),p.join("")}function qre(a,c){var u;(c=c||tt(153)).write_shift(2,20*a.sz),u=a,f=(f=c)||tt(2),u=(u.italic?2:0)|(u.strike?8:0)|(u.outline?16:0)|(u.shadow?32:0)|(u.condense?64:0)|(u.extend?128:0),f.write_shift(1,u),f.write_shift(1,0),c.write_shift(2,a.bold?700:400);var f=0;return a.vertAlign=="superscript"?f=1:a.vertAlign=="subscript"&&(f=2),c.write_shift(2,f),c.write_shift(1,a.underline||0),c.write_shift(1,a.family||0),c.write_shift(1,a.charset||0),c.write_shift(1,0),TS(a.color,c),f=0,a.scheme=="major"&&(f=1),a.scheme=="minor"&&(f=2),c.write_shift(1,f),Ls(a.name,c),c.length>c.l?c.slice(0,c.l):c}var b8,Jre=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qre=vo;function x8(a,c){c=c||tt(84),a=(b8=b8||Gc(Jre))[a.patternType],a==null&&(a=40),c.write_shift(4,a);var u=0;if(a!=40)for(TS({auto:1},c),TS({auto:1},c);u<12;++u)c.write_shift(4,0);else{for(;u<4;++u)c.write_shift(4,0);for(;u<12;++u)c.write_shift(4,0)}return c.length>c.l?c.slice(0,c.l):c}function E8(a,c,u){return(u=u||tt(16)).write_shift(2,c||0),u.write_shift(2,a.numFmtId||0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u.write_shift(1,0),u}function lv(a,c){return(c=c||tt(10)).write_shift(1,0),c.write_shift(1,0),c.write_shift(4,0),c.write_shift(4,0),c}Js=vo;function Zre(a,c){var u;c&&(u=0,[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m=f[0];m<=f[1];++m)c[m]!=null&&++u}),u!=0&&(ht(a,615,Zl(u)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m,v,p,w=f[0];w<=f[1];++w)c[w]!=null&&ht(a,44,(m=w,v=c[w],(p=(p=void 0)||tt(6+4*v.length)).write_shift(2,m),Ls(v,p),v=p.length>p.l?p.slice(0,p.l):p,p.l==null&&(p.l=p.length),v))}),ht(a,616)))}function ene(a){var c;ht(a,613,Zl(1)),ht(a,46,((c=c||tt(51)).write_shift(1,0),lv(0,c),lv(0,c),lv(0,c),lv(0,c),lv(0,c),c.length>c.l?c.slice(0,c.l):c)),ht(a,614)}function tne(a){var c,u;ht(a,619,Zl(1)),ht(a,48,(c={xfId:0,builtinId:0,name:"Normal"},(u=u||tt(52)).write_shift(4,c.xfId),u.write_shift(2,1),u.write_shift(1,+c.builtinId),u.write_shift(1,0),ES(c.name||"",u),u.length>u.l?u.slice(0,u.l):u)),ht(a,620)}function rne(a){var c,u,f,m;ht(a,508,(c=0,u="TableStyleMedium9",f="PivotStyleMedium4",(m=tt(2052)).write_shift(4,c),ES(u,m),ES(f,m),m.length>m.l?m.slice(0,m.l):m)),ht(a,509)}function nne(a,c){var u,f=ga();return ht(f,278),Zre(f,a.SSF),ht(a=f,611,Zl(1)),ht(a,43,qre({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ht(a,612),ht(a=f,603,Zl(2)),ht(a,45,x8({patternType:"none"})),ht(a,45,x8({patternType:"gray125"})),ht(a,604),ene(f),ht(a=f,626,Zl(1)),ht(a,47,E8({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ht(a,627),u=f,c=c.cellXfs,ht(u,617,Zl(c.length)),c.forEach(function(m){ht(u,47,E8(m,0))}),ht(u,618),tne(f),ht(c=f,505,Zl(0)),ht(c,506),rne(f),ht(f,279),f.end()}var ine=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function sne(a,c,u){c.themeElements.clrScheme=[];var f={};(a[0].match(po)||[]).forEach(function(m){var v=Pr(m);switch(v[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":f.rgb=v.val;break;case"<a:sysClr":f.rgb=v.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":v[0].charAt(1)==="/"?(c.themeElements.clrScheme[ine.indexOf(v[0])]=f,f={}):f.name=v[0].slice(3,v[0].length-1);break;default:if(u&&u.WTF)throw new Error("Unrecognized "+v[0]+" in clrScheme")}})}function one(){}function ane(){}var lne=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,cne=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,une=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/,hne=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T8(a,c){var u,f,m,v,p,w={};if(!(u=(a=!a||a.length===0?pA():a).match(hne)))throw new Error("themeElements not found in theme");return f=u[0],v=c,(m=w).themeElements={},[["clrScheme",lne,sne],["fontScheme",cne,one],["fmtScheme",une,ane]].forEach(function(S){if(!(p=f.match(S[1])))throw new Error(S[0]+" not found in themeElements");S[2](p,m,v)}),w.raw=a,w}function pA(a,c){return c&&c.themeXLSX?c.themeXLSX:a&&typeof a.raw=="string"?a.raw:(a=[fi],a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join(""))}function fne(a){var c={};switch(c.xclrType=a.read_shift(2),c.nTintShade=a.read_shift(2),c.xclrType){case 0:a.l+=4;break;case 1:c.xclrValue=vo(a,4);break;case 2:c.xclrValue=gL(a);break;case 3:c.xclrValue=a.read_shift(4);break;case 4:a.l+=4}return a.l+=8,c}function dne(a){var c=a.read_shift(2),u=a.read_shift(2)-4,f=[c];switch(c){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:f[1]=fne(a);break;case 6:f[1]=vo(a,u);break;case 14:case 15:f[1]=a.read_shift(u==1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+c+" "+u)}return f}function gne(){var a,c,u,f=ga();return ht(f,332),ht(f,334,Zl(1)),ht(f,335,((u=tt(12+2*(c={name:"XLDAPR",version:12e4,flags:3496657072}).name.length)).write_shift(4,c.flags),u.write_shift(4,c.version),Ls(c.name,u),u.slice(0,u.l))),ht(f,336),ht(f,339,(a=1,(u=tt(8+2*(c="XLDAPR").length)).write_shift(4,a),Ls(c,u),u.slice(0,u.l))),ht(f,52),ht(f,35,Zl(514)),ht(f,4096,Zl(0)),ht(f,4097,pl(1)),ht(f,36),ht(f,53),ht(f,340),ht(f,337,(a=1,c=!0,(u=tt(8)).write_shift(4,a),u.write_shift(4,c?1:0),u)),ht(f,51,function(m){var v=tt(4+8*m.length);v.write_shift(4,m.length);for(var p=0;p<m.length;++p)v.write_shift(4,m[p][0]),v.write_shift(4,m[p][1]);return v}([[1,0]])),ht(f,338),ht(f,333),f.end()}function _8(){var a=[fi];return a.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),a.join("")}var dm=1024;function R8(a,c){for(var u=[21600,21600],f=["m0,0l0",u[1],u[0],u[1],u[0],"0xe"].join(","),m=[Nt("xml",null,{"xmlns:v":$a.v,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:mv":$a.mv}).replace(/\/>/,">"),Nt("o:shapelayout",Nt("o:idmap",null,{"v:ext":"edit",data:a}),{"v:ext":"edit"}),Nt("v:shapetype",[Nt("v:stroke",null,{joinstyle:"miter"}),Nt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:u.join(","),path:f})];dm<1e3*a;)dm+=1e3;return c.forEach(function(v){var p=Ii(v[0]),S={color2:"#BEFF82",type:"gradient"};S.type=="gradient"&&(S.angle="-180");var w=S.type=="gradient"?Nt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,S=Nt("v:fill",w,S);++dm,m=m.concat(["<v:shape"+G1({id:"_x0000_s"+dm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(v[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",S,Nt("v:shadow",null,{on:"t",obscured:"t"}),Nt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qs("x:Anchor",[p.c+1,0,p.r+1,0,p.c+3,20,p.r+5,20].join(",")),Qs("x:AutoFill","False"),Qs("x:Row",String(p.r)),Qs("x:Column",String(p.c)),v[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),m.push("</xml>"),m.join("")}function A8(a,c,u,f){var m,v=Array.isArray(a);c.forEach(function(p){var w,S=Ii(p.ref);(m=v?(a[S.r]||(a[S.r]=[]),a[S.r][S.c]):a[p.ref])||(m={t:"z"},v?a[S.r][S.c]=m:a[p.ref]=m,(w=un(a["!ref"]||"BDWGO1000001:A1")).s.r>S.r&&(w.s.r=S.r),w.e.r<S.r&&(w.e.r=S.r),w.s.c>S.c&&(w.s.c=S.c),w.e.c<S.c&&(w.e.c=S.c),(w=Wr(w))!==a["!ref"]&&(a["!ref"]=w)),m.c||(m.c=[]);var b={a:p.author,t:p.t,r:p.r,T:u};p.h&&(b.h=p.h);for(var T=m.c.length-1;0<=T;--T){if(!u&&m.c[T].T)return;u&&!m.c[T].T&&m.c.splice(T,1)}if(u&&f){for(T=0;T<f.length;++T)if(b.a==f[T].id){b.a=f[T].name||b.a;break}}m.c.push(b)})}function O8(a){var c=[fi,Nt("comments",null,{xmlns:Ud[0]})],u=[];return c.push("<authors>"),a.forEach(function(f){f[1].forEach(function(m){var v=Bn(m.a);u.indexOf(v)==-1&&(u.push(v),c.push("<author>"+v+"</author>")),m.T&&m.ID&&u.indexOf("tc="+m.ID)==-1&&(u.push("tc="+m.ID),c.push("<author>tc="+m.ID+"</author>"))})}),u.length==0&&(u.push("SheetJ5"),c.push("<author>SheetJ5</author>")),c.push("</authors>"),c.push("<commentList>"),a.forEach(function(f){var m=0,v=[];if(f[1][0]&&f[1][0].T&&f[1][0].ID?m=u.indexOf("tc="+f[1][0].ID):f[1].forEach(function(S){S.a&&(m=u.indexOf(Bn(S.a))),v.push(S.t||"")}),c.push('<comment ref="'+f[0]+'" authorId="'+m+'"><text>'),v.length<=1)c.push(Qs("t",Bn(v[0]||"")));else{for(var p=`Comment:
    `+v[0]+`
`,w=1;w<v.length;++w)p+=`Reply:
    `+v[w]+`
`;c.push(Qs("t",Bn(p)))}c.push("</text></comment>")}),c.push("</commentList>"),2<c.length&&(c[c.length]="</comments>",c[1]=c[1].replace("/>",">")),c.join("")}ge=wo;function mne(a){var c=ga(),u=[];return ht(c,628),ht(c,630),a.forEach(function(f){f[1].forEach(function(m){-1<u.indexOf(m.a)||(u.push(m.a.slice(0,54)),ht(c,632,Ls(m.a.slice(0,54))))})}),ht(c,631),ht(c,633),a.forEach(function(f){f[1].forEach(function(m){m.iauthor=u.indexOf(m.a);var v,p={s:Ii(f[0]),e:Ii(f[0])};ht(c,635,(p=[p,m],(v=v??tt(36)).write_shift(4,p[1].iauthor),om(p[0],v),v.write_shift(4,0),v.write_shift(4,0),v.write_shift(4,0),v.write_shift(4,0),v)),m.t&&0<m.t.length&&ht(c,637,are(m)),ht(c,636),delete m.iauthor})}),ht(c,634),ht(c,629),c.end()}var pne="application/vnd.ms-office.vbaProject",I8=["xlsb","xlsm","xlam","biff8","xla"],vA,P8,gm=(P8=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,function(a,c){return vA=c,a.replace(P8,vne)});function vne(a,c,u,f){var m=!1,v=!1;return u.length==0?v=!0:u.charAt(0)=="["&&(v=!0,u=u.slice(1,-1)),f.length==0?m=!0:f.charAt(0)=="["&&(m=!0,f=f.slice(1,-1)),u=0<u.length?0|parseInt(u,10):0,f=0<f.length?0|parseInt(f,10):0,m?f+=vA.c:--f,v?u+=vA.r:--u,c+(m?"":"$")+gi(f)+(v?"":"$")+Ui(u)}var wA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yA=function(a,c){return a.replace(wA,function(u,f,m,v,p,w){return v=jR(v)-(m?0:c.c),w=WR(w)-(p?0:c.r),f+"R"+(w==0?"":p?1+w:"["+w+"]")+"C"+(v==0?"":m?1+v:"["+v+"]")})};function F8(a,c){return a.replace(wA,function(u,f,m,v,p,w){return f+(m=="$"?m+v:gi(jR(v)+c.c))+(p=="$"?p+w:Ui(WR(w)+c.r))})}function M8(a){return a.replace(/_xlfn\./g,"")}function hs(a){a.l+=1}function Sf(a,c){return c=a.read_shift(c==1?1:2),[16383&c,c>>14&1,c>>15&1]}function k8(p,c,m){var v=2;if(m){if(2<=m.biff&&m.biff<=5)return N8(p);m.biff==12&&(v=4)}var f=p.read_shift(v),m=p.read_shift(v),v=Sf(p,2),p=Sf(p,2);return{s:{r:f,c:v[0],cRel:v[1],rRel:v[2]},e:{r:m,c:p[0],cRel:p[1],rRel:p[2]}}}function N8(m){var c=Sf(m,2),u=Sf(m,2),f=m.read_shift(1),m=m.read_shift(1);return{s:{r:c[0],c:f,cRel:c[1],rRel:c[2]},e:{r:u[0],c:m,cRel:u[1],rRel:u[2]}}}function D8(p,c,v){if(v&&2<=v.biff&&v.biff<=5)return m=Sf(f=p,2),f=f.read_shift(1),{r:m[0],c:f,cRel:m[1],rRel:m[2]};var f,m,v=p.read_shift(v&&v.biff==12?4:2),p=Sf(p,2);return{r:v,c:p[0],cRel:p[1],rRel:p[2]}}function wne(p,c,v){if(v=v&&v.biff?v.biff:8,2<=v&&v<=5)return function(P){var S=P.read_shift(2),b=P.read_shift(1),T=(32768&S)>>15,P=(16384&S)>>14;return S&=16383,T==1&&8192<=S&&(S-=16384),P==1&&128<=b&&(b-=256),{r:S,c:b,cRel:P,rRel:T}}(p);var f=p.read_shift(12<=v?4:2),m=p.read_shift(2),v=(16384&m)>>14,p=(32768&m)>>15;if(m&=16383,p==1)for(;524287<f;)f-=1048576;if(v==1)for(;8191<m;)m-=16384;return{r:f,c:m,cRel:v,rRel:p}}function L8(a){var c=1&a[a.l+1];return a.l+=4,[c,1]}function H8(a){return[a.read_shift(1),a.read_shift(1)]}function yne(a,c,u){var f=0,m=0;u.biff==12?(f=a.read_shift(4),m=a.read_shift(4)):(m=1+a.read_shift(1),f=1+a.read_shift(2)),2<=u.biff&&u.biff<8&&(--f,--m==0&&(m=256));for(var v=0,p=[];v!=f&&(p[v]=[]);++v)for(var w=0;w!=m;++w)p[v][w]=function(S,b){var T=[S.read_shift(1)];if(b==12)switch(T[0]){case 2:T[0]=4;break;case 4:T[0]=16;break;case 0:T[0]=1;break;case 1:T[0]=2}switch(T[0]){case 4:T[1]=ns(S,1)?"TRUE":"FALSE",b!=12&&(S.l+=7);break;case 37:case 16:T[1]=ih[S[S.l]],S.l+=b==12?4:8;break;case 0:S.l+=8;break;case 1:T[1]=yo(S);break;case 2:T[1]=Qd(S,0,{biff:0<b&&b<8?2:b});break;default:throw new Error("Bad SerAr: "+T[0])}return T}(a,u.biff);return p}function cv(a,c,u){return a.l+=2,[(a=(f=a).read_shift(2),f=f.read_shift(2),{r:a,c:255&f,fQuoted:!!(16384&f),cRel:f>>15,rRel:f>>15})];var f}function CA(a){return a.l+=6,[]}function $8(a){return a.l+=2,[us(a),1&a.read_shift(2)]}var Cne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],B8={1:{n:"PtgExp",f:function(a,c,u){return a.l++,u&&u.biff==12?[a.read_shift(4,"i"),0]:[a.read_shift(2),a.read_shift(u&&u.biff==2?1:2)]}},2:{n:"PtgTbl",f:vo},3:{n:"PtgAdd",f:hs},4:{n:"PtgSub",f:hs},5:{n:"PtgMul",f:hs},6:{n:"PtgDiv",f:hs},7:{n:"PtgPower",f:hs},8:{n:"PtgConcat",f:hs},9:{n:"PtgLt",f:hs},10:{n:"PtgLe",f:hs},11:{n:"PtgEq",f:hs},12:{n:"PtgGe",f:hs},13:{n:"PtgGt",f:hs},14:{n:"PtgNe",f:hs},15:{n:"PtgIsect",f:hs},16:{n:"PtgUnion",f:hs},17:{n:"PtgRange",f:hs},18:{n:"PtgUplus",f:hs},19:{n:"PtgUminus",f:hs},20:{n:"PtgPercent",f:hs},21:{n:"PtgParen",f:hs},22:{n:"PtgMissArg",f:hs},23:{n:"PtgStr",f:function(a,c,u){return a.l++,ev(a,0,u)}},26:{n:"PtgSheet",f:function(a,c,u){return a.l+=5,a.l+=2,a.l+=u.biff==2?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(a,c,u){return a.l+=u.biff==2?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(a){return a.l++,ih[a.read_shift(1)]}},29:{n:"PtgBool",f:function(a){return a.l++,a.read_shift(1)!==0}},30:{n:"PtgInt",f:function(a){return a.l++,a.read_shift(2)}},31:{n:"PtgNum",f:function(a){return a.l++,yo(a)}},32:{n:"PtgArray",f:function(a,c,u){var f=(96&a[a.l++])>>5;return a.l+=u.biff==2?6:u.biff==12?14:7,[f]}},33:{n:"PtgFunc",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,u=a.read_shift(u&&u.biff<=3?1:2),[Ine[u],j8[u],f]}},34:{n:"PtgFuncVar",f:function(a,c,u){var f=a[a.l++],m=a.read_shift(1),v=u&&u.biff<=3?[f==88?-1:0,a.read_shift(1)]:[(v=a)[v.l+1]>>7,32767&v.read_shift(2)];return[m,(v[0]===0?j8:One)[v[1]]]}},35:{n:"PtgName",f:function(a,c,u){var f=a.read_shift(1)>>>5&3,m=!u||8<=u.biff?4:2,m=a.read_shift(m);switch(u.biff){case 2:a.l+=5;break;case 3:case 4:a.l+=8;break;case 5:a.l+=12}return[f,0,m]}},36:{n:"PtgRef",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,[f,D8(a,0,u)]}},37:{n:"PtgArea",f:function(a,c,u){return[(96&a[a.l++])>>5,k8(a,2<=u.biff&&u.biff,u)]}},38:{n:"PtgMemArea",f:function(a,c,u){var f=a.read_shift(1)>>>5&3;return a.l+=u&&u.biff==2?3:4,[f,a.read_shift(u&&u.biff==2?1:2)]}},39:{n:"PtgMemErr",f:vo},40:{n:"PtgMemNoMem",f:vo},41:{n:"PtgMemFunc",f:function(a,c,u){return[a.read_shift(1)>>>5&3,a.read_shift(u&&u.biff==2?1:2)]}},42:{n:"PtgRefErr",f:function(a,c,u){var f=a.read_shift(1)>>>5&3;return a.l+=4,u.biff<8&&a.l--,u.biff==12&&(a.l+=2),[f]}},43:{n:"PtgAreaErr",f:function(a,c,u){var f=(96&a[a.l++])>>5;return a.l+=u&&8<u.biff?12:u.biff<8?6:8,[f]}},44:{n:"PtgRefN",f:function(a,c,u){var f=(96&a[a.l])>>5;return a.l+=1,[f,wne(a,0,u)]}},45:{n:"PtgAreaN",f:function(a,c,u){return[(96&a[a.l++])>>5,function(S,w){if(w.biff<8)return N8(S);var v=S.read_shift(w.biff==12?4:2),p=S.read_shift(w.biff==12?4:2),w=Sf(S,2),S=Sf(S,2);return{s:{r:v,c:w[0],cRel:w[1],rRel:w[2]},e:{r:p,c:S[0],cRel:S[1],rRel:S[2]}}}(a,u)]}},46:{n:"PtgMemAreaN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(a){return[a.read_shift(1)>>>5&3,a.read_shift(2)]}},57:{n:"PtgNameX",f:function(a,c,u){return u.biff==5?function(f){var m=f.read_shift(1)>>>5&3,v=f.read_shift(2,"i");f.l+=8;var p=f.read_shift(2);return f.l+=12,[m,v,p]}(a):[a.read_shift(1)>>>5&3,a.read_shift(2),a.read_shift(4)]}},58:{n:"PtgRef3d",f:function(a,c,u){var f=(96&a[a.l])>>5;a.l+=1;var m=a.read_shift(2);return u&&u.biff==5&&(a.l+=12),[f,m,D8(a,0,u)]}},59:{n:"PtgArea3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2,"i");if(u)switch(u.biff){case 5:a.l+=12;break}return[f,m,k8(a,0,u)]}},60:{n:"PtgRefErr3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2),v=4;if(u)switch(u.biff){case 5:v=15;break;case 12:v=6}return a.l+=v,[f,m]}},61:{n:"PtgAreaErr3d",f:function(a,c,u){var f=(96&a[a.l++])>>5,m=a.read_shift(2),v=8;if(u)switch(u.biff){case 5:a.l+=12,v=6;break;case 12:v=12}return a.l+=v,[f,m]}},255:{}},Sne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},bne={1:{n:"PtgElfLel",f:$8},2:{n:"PtgElfRw",f:cv},3:{n:"PtgElfCol",f:cv},6:{n:"PtgElfRwV",f:cv},7:{n:"PtgElfColV",f:cv},10:{n:"PtgElfRadical",f:cv},11:{n:"PtgElfRadicalS",f:CA},13:{n:"PtgElfColS",f:CA},15:{n:"PtgElfColSV",f:CA},16:{n:"PtgElfRadicalLel",f:$8},25:{n:"PtgList",f:function(v){v.l+=2;var c=v.read_shift(2),u=v.read_shift(2),f=v.read_shift(4),m=v.read_shift(2),v=v.read_shift(2);return{ixti:c,coltype:3&u,rt:Cne[u>>2&31],idx:f,c:m,C:v}}},29:{n:"PtgSxName",f:function(a){return a.l+=2,[a.read_shift(4)]}},255:{}},xne={0:{n:"PtgAttrNoop",f:function(a){return a.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=u&&u.biff==2?3:4,[f]}},2:{n:"PtgAttrIf",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=2,[f,a.read_shift(u&&u.biff==2?1:2)]}},4:{n:"PtgAttrChoose",f:function(a,c,u){a.l+=2;for(var f=a.read_shift(u&&u.biff==2?1:2),m=[],v=0;v<=f;++v)m.push(a.read_shift(u&&u.biff==2?1:2));return m}},8:{n:"PtgAttrGoto",f:function(a,c,u){var f=255&a[a.l+1]?1:0;return a.l+=2,[f,a.read_shift(u&&u.biff==2?1:2)]}},16:{n:"PtgAttrSum",f:function(a,c,u){a.l+=u&&u.biff==2?3:4}},32:{n:"PtgAttrBaxcel",f:L8},33:{n:"PtgAttrBaxcel",f:L8},64:{n:"PtgAttrSpace",f:function(a){return a.read_shift(2),H8(a)}},65:{n:"PtgAttrSpaceSemi",f:function(a){return a.read_shift(2),H8(a)}},128:{n:"PtgAttrIfError",f:function(a){var c=255&a[a.l+1]?1:0;return a.l+=2,[c,a.read_shift(2)]}},255:{}};function uv(a,c,u,f){if(f.biff<8)return vo(a,c);for(var m=a.l+c,v=[],p=0;p!==u.length;++p)switch(u[p][0]){case"PtgArray":u[p][1]=yne(a,0,f),v.push(u[p][1]);break;case"PtgMemArea":u[p][2]=function(w,S){for(var b=w.read_shift(S.biff==12?4:2),T=[],P=0;P!=b;++P)T.push((S.biff==12?Xd:OS)(w));return T}(a,(u[p][1],f)),v.push(u[p][2]);break;case"PtgExp":f&&f.biff==12&&(u[p][1][1]=a.read_shift(4),v.push(u[p][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+u[p][0]}return(c=m-a.l)!==0&&v.push(vo(a,c)),v}function hv(a,c,u){for(var f,m,v=a.l+c,p=[];v!=a.l;)c=v-a.l,m=a[a.l],f=B8[m]||B8[Sne[m]],(f=m===24||m===25?(m===24?bne:xne)[a[a.l+1]]:f)&&f.f?p.push([f.n,f.f(a,c,u)]):vo(a,c);return p}var Ene={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function V8(a,c,u){if(!a)return"SH33TJSERR0";if(8<u.biff&&(!a.XTI||!a.XTI[c]))return a.SheetNames[c];if(!a.XTI)return"SH33TJSERR6";var f=a.XTI[c];if(u.biff<8)return 1e4<c&&(c-=65536),(c=c<0?-c:c)==0?"":a.XTI[c-1];if(!f)return"SH33TJSERR1";var m="";if(8<u.biff)switch(a[f[0]][0]){case 357:return m=f[1]==-1?"#REF":a.SheetNames[f[1]],f[1]==f[2]?m:m+":"+a.SheetNames[f[2]];case 358:return u.SID!=null?a.SheetNames[u.SID]:"SH33TJSSAME"+a[f[0]][0];case 355:default:return"SH33TJSSRC"+a[f[0]][0]}switch(a[f[0]][0][0]){case 1025:return m=f[1]==-1?"#REF":a.SheetNames[f[1]]||"SH33TJSERR3",f[1]==f[2]?m:m+":"+a.SheetNames[f[2]];case 14849:return a[f[0]].slice(1).map(function(v){return v.Name}).join(";;");default:return a[f[0]][0][3]?(m=f[1]==-1?"#REF":a[f[0]][0][3][f[1]]||"SH33TJSERR4",f[1]==f[2]?m:m+":"+a[f[0]][0][3][f[2]]):"SH33TJSERR2"}}function W8(a,c,u){return c=V8(a,c,u),c=="#REF"?c:function(f,m){if(!(f||m&&m.biff<=5&&2<=m.biff))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(f)?"'"+f+"'":f}(c,u)}function jo(a,c,u,f,m){var v,p,w,S=m&&m.biff||8,b={s:{c:0,r:0},e:{c:0,r:0}},T=[],P=0,M=0,N="";if(!a[0]||!a[0][0])return"";for(var U=-1,B="",Z=0,G=a[0].length;Z<G;++Z){var W=a[0][Z];switch(W[0]){case"PtgUminus":T.push("-"+T.pop());break;case"PtgUplus":T.push("+"+T.pop());break;case"PtgPercent":T.push(T.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(Wt=T.pop(),v=T.pop(),0<=U){switch(a[0][U][1][0]){case 0:B=Ye(" ",a[0][U][1][1]);break;case 1:B=Ye("\r",a[0][U][1][1]);break;default:if(B="",m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][U][1][0])}v+=B,U=-1}T.push(v+Ene[W[0]]+Wt);break;case"PtgIsect":Wt=T.pop(),v=T.pop(),T.push(v+" "+Wt);break;case"PtgUnion":Wt=T.pop(),v=T.pop(),T.push(v+","+Wt);break;case"PtgRange":Wt=T.pop(),v=T.pop(),T.push(v+":"+Wt);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":break;case"PtgRef":p=X1(W[1][1],b,m),T.push(q1(p,S));break;case"PtgRefN":p=u?X1(W[1][1],u,m):W[1][1],T.push(q1(p,S));break;case"PtgRef3d":P=W[1][1],p=X1(W[1][2],b,m),N=W8(f,P,m),T.push(N+"!"+q1(p,S));break;case"PtgFunc":case"PtgFuncVar":var ne=W[1][0],J=W[1][1],ne=ne||0,se=(ne&=127)==0?[]:T.slice(-ne);T.length-=ne,J==="User"&&(J=se.shift()),T.push(J+"("+se.join(",")+")");break;case"PtgBool":T.push(W[1]?"TRUE":"FALSE");break;case"PtgInt":T.push(W[1]);break;case"PtgNum":T.push(String(W[1]));break;case"PtgStr":T.push('"'+W[1].replace(/"/g,'""')+'"');break;case"PtgErr":T.push(W[1]);break;case"PtgAreaN":w=F5(W[1][1],u?{s:u}:b,m),T.push(VR(w,m));break;case"PtgArea":w=F5(W[1][1],b,m),T.push(VR(w,m));break;case"PtgArea3d":P=W[1][1],w=W[1][2],N=W8(f,P,m),T.push(N+"!"+VR(w,m));break;case"PtgAttrSum":T.push("SUM("+T.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":M=W[1][2];var be=(f.names||[])[M-1]||(f[0]||[])[M],De=be?be.Name:"SH33TJSNAME"+String(M);De&&De.slice(0,6)=="_xlfn."&&!m.xlfn&&(De=De.slice(6)),T.push(De);break;case"PtgNameX":var Pe,je=W[1][1],M=W[1][2];if(!(m.biff<=5)){be="",((f[je]||[])[0]||[])[0]==14849||(((f[je]||[])[0]||[])[0]==1025?f[je][M]&&0<f[je][M].itab&&(be=f.SheetNames[f[je][M].itab-1]+"!"):be=f.SheetNames[M-1]+"!"),f[je]&&f[je][M]?be+=f[je][M].Name:f[0]&&f[0][M]?be+=f[0][M].Name:(De=(V8(f,je,m)||"").split(";;"))[M-1]?be=De[M-1]:be+="SH33TJSERRX",T.push(be);break}Pe=(Pe=f[je=je<0?-je:je]?f[je][M]:Pe)||{Name:"SH33TJSERRY"},T.push(Pe.Name);break;case"PtgParen":var it="(",st=")";if(0<=U){switch(B="",a[0][U][1][0]){case 2:it=Ye(" ",a[0][U][1][1])+it;break;case 3:it=Ye("\r",a[0][U][1][1])+it;break;case 4:st=Ye(" ",a[0][U][1][1])+st;break;case 5:st=Ye("\r",a[0][U][1][1])+st;break;default:if(m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+a[0][U][1][0])}U=-1}T.push(it+T.pop()+st);break;case"PtgRefErr":case"PtgRefErr3d":T.push("#REF!");break;case"PtgExp":p={c:W[1][1],r:W[1][0]};var Ke={c:u.c,r:u.r};if(f.sharedf[Fr(p)])je=f.sharedf[Fr(p)],T.push(jo(je,0,Ke,f,m));else{for(var yt=!1,Wt=0;Wt!=f.arrayf.length;++Wt)if(v=f.arrayf[Wt],!(p.c<v[0].s.c||p.c>v[0].e.c||p.r<v[0].s.r||p.r>v[0].e.r)){T.push(jo(v[1],0,Ke,f,m)),yt=!0;break}yt||T.push(W[1])}break;case"PtgArray":T.push("{"+function(Pt){for(var Tt=[],ft=0;ft<Pt.length;++ft){for(var Qt=Pt[ft],sr=[],wr=0;wr<Qt.length;++wr){var Gr=Qt[wr];Gr?Gr[0]===2?sr.push('"'+Gr[1].replace(/"/g,'""')+'"'):sr.push(Gr[1]):sr.push("")}Tt.push(sr.join(","))}return Tt.join(";")}(W[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":U=Z;break;case"PtgTbl":case"PtgMemErr":break;case"PtgMissArg":T.push("");break;case"PtgAreaErr":case"PtgAreaErr3d":T.push("#REF!");break;case"PtgList":T.push("Table"+W[1].idx+"[#"+W[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":default:throw new Error("Unrecognized Formula Token: "+String(W))}if(m.biff!=3&&0<=U&&["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(a[0][Z][0])==-1){var Ht=!0;switch((W=a[0][U])[1][0]){case 4:Ht=!1;case 0:B=Ye(" ",W[1][1]);break;case 5:Ht=!1;case 1:B=Ye("\r",W[1][1]);break;default:if(B="",m.WTF)throw new Error("Unexpected PtgAttrSpaceType "+W[1][0])}T.push((Ht?B:"")+T.pop()+(Ht?"":B)),U=-1}}if(1<T.length&&m.WTF)throw new Error("bad formula stack");return T[0]}function SA(a,p,u){var f=a.l+p,m=qc(a);u.biff==2&&++a.l;var v=function(w){var S;if(rh(w,w.l+6)!==65535)return[yo(w),"n"];switch(w[w.l]){case 0:return w.l+=8,["String","s"];case 1:return S=w[w.l+2]===1,w.l+=8,[S,"b"];case 2:return S=w[w.l+2],w.l+=8,[S,"e"];case 3:return w.l+=8,["","s"]}return[]}(a),p=a.read_shift(1);return u.biff!=2&&(a.read_shift(1),5<=u.biff&&a.read_shift(4)),u=function(w,S,b){var T,P=w.l+S,M=b.biff==2?1:2,N=w.read_shift(M);if(N==65535)return[[],vo(w,S-2)];var U=hv(w,N,b);return S!==N+M&&(T=uv(w,S-N-M,U,b)),w.l=P,[U,T]}(a,f-a.l,u),{cell:m,val:v[0],formula:u,shared:p>>3&1,tt:v[1]}}function Tne(a,c,u,f,m){c=Zd(c,u,m),m=(u=a.v)!=null?am(typeof u=="number"?u:0):((u=tt(8)).write_shift(1,3),u.write_shift(1,0),u.write_shift(2,0),u.write_shift(2,0),u.write_shift(2,65535),u),u=tt(6),u.write_shift(2,33),u.write_shift(4,0);for(var v=tt(a.bf.length),p=0;p<a.bf.length;++p)v[p]=a.bf[p];return Be([c,m,u,v])}function US(a,c,u){var m=a.read_shift(4),f=hv(a,m,u),m=a.read_shift(4);return[f,0<m?uv(a,m,f,u):null]}var _ne=US,zS=US,Rne=US,Ane=US,One={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},j8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Ine={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function U8(a){return(a=(a=(a=(a=(a=a.slice(0,3)=="of:"?a.slice(3):a).charCodeAt(0)==61&&(a=a.slice(1)).charCodeAt(0)==61?a.slice(1):a).replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(c,u){return u.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function bA(a){return a=a.split(":"),[a[0].split(".")[0],a[0].split(".")[1]+(1<a.length?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}var fv={},mm={},dv=typeof Map<"u";function xA(a,c,u){var f=0,m=a.length;if(u){if(dv?u.has(c):Object.prototype.hasOwnProperty.call(u,c)){for(var v=dv?u.get(c):u[c];f<v.length;++f)if(a[v[f]].t===c)return a.Count++,v[f]}}else for(;f<m;++f)if(a[f].t===c)return a.Count++,f;return a[m]={t:c},a.Count++,a.Unique++,u&&(dv?(u.has(c)||u.set(c,[]),u.get(c).push(m)):(Object.prototype.hasOwnProperty.call(u,c)||(u[c]=[]),u[c].push(m))),m}function GS(f,c){var u={min:f+1,max:f+1},f=-1;return c.MDW&&(So=c.MDW),c.width!=null?u.customWidth=1:c.wpx!=null?f=sv(c.wpx):c.wch!=null&&(f=c.wch),-1<f?(u.width=VS(f),u.customWidth=1):c.width!=null&&(u.width=c.width),c.hidden&&(u.hidden=!0),c.level!=null&&(u.outlineLevel=u.level=c.level),u}function t0(a,c){a&&(c=c=="xlml"?[1,1,1,1,.5,.5]:[.7,.7,.75,.75,.3,.3],a.left==null&&(a.left=c[0]),a.right==null&&(a.right=c[1]),a.top==null&&(a.top=c[2]),a.bottom==null&&(a.bottom=c[3]),a.header==null&&(a.header=c[4]),a.footer==null&&(a.footer=c[5]))}function bf(a,c,u){if(av!==void 0){if(/^\d+$/.exec(c.s)||c.s&&c.s==+c.s)return c.s;var f=c.s||{};return c.z&&(f.numFmt=c.z),av.addStyle(f)}var m=u.revssf[c.z!=null?c.z:"General"],v=60,p=a.length;if(m==null&&u.ssf){for(;v<392;++v)if(u.ssf[v]==null){Nr(c.z,v),u.ssf[v]=c.z,u.revssf[c.z]=m=v;break}}for(v=0;v!=p;++v)if(a[v].numFmtId===m)return v;return a[p]={numFmtId:m,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},p}function z8(a,c,u,f,m,v){try{f.cellNF&&(a.z=D[c])}catch(w){if(f.WTF)throw w}if(a.t!=="z"||f.cellStyles){if(a.t==="d"&&typeof a.v=="string"&&(a.v=ue(a.v)),(!f||f.cellText!==!1)&&a.t!=="z")try{if(D[c]==null&&Nr(ar[c]||"General",c),a.t==="e")a.w=a.w||ih[a.v];else if(c===0)if(a.t==="n")(0|a.v)===a.v?a.w=a.v.toString(10):a.w=_e(a.v);else if(a.t==="d"){var p=hi(a.v);a.w=(0|p)===p?p.toString(10):_e(p)}else{if(a.v===void 0)return;a.w=Ee(a.v,mm)}else a.t==="d"?a.w=Lr(c,hi(a.v),mm):a.w=Lr(c,a.v,mm)}catch(w){if(f.WTF)throw w}if(f.cellStyles&&u!=null)try{a.s=v.Fills[u],a.s.fgColor&&a.s.fgColor.theme&&!a.s.fgColor.rgb&&(a.s.fgColor.rgb=BS(m.themeElements.clrScheme[a.s.fgColor.theme].rgb,a.s.fgColor.tint||0),f.WTF&&(a.s.fgColor.raw_rgb=m.themeElements.clrScheme[a.s.fgColor.theme].rgb)),a.s.bgColor&&a.s.bgColor.theme&&(a.s.bgColor.rgb=BS(m.themeElements.clrScheme[a.s.bgColor.theme].rgb,a.s.bgColor.tint||0),f.WTF&&(a.s.bgColor.raw_rgb=m.themeElements.clrScheme[a.s.bgColor.theme].rgb))}catch(w){if(f.WTF&&v.Fills)throw w}}}var Pne=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Fne=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mne=/<(?:\w:)?hyperlink [^>]*>/gm,kne=/"(\w*:\w*)"/,Nne=/<(?:\w:)?col\b[^>]*[\/]?>/g,Dne=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Lne=/<(?:\w:)?pageMargins[^>]*\/>/g,G8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Hne=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,$ne=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bne(a,c,u,f,m,v,p){if(!a)return a;f=f||{"!id":{}};var w=c.dense?[]:{},S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b="",De="",T=a.match(Fne);T?(b=a.slice(0,T.index),De=a.slice(T.index+T[0].length)):b=De=a;var P=b.match(G8);P?EA(P[0],0,m,u):(P=b.match(Hne))&&(a=P[0],P[1],P=w,M=m,N=u,EA(a.slice(0,a.indexOf(">")),0,M,N));var M,N,U=(b.match(/<(?:\w*:)?dimension/)||{index:-1}).index;0<U&&(M=b.slice(U,U+50).match(kne))&&(N=w,(Z=un(Z=M[1])).s.r<=Z.e.r&&Z.s.c<=Z.e.c&&0<=Z.s.r&&0<=Z.s.c&&(N["!ref"]=Wr(Z)));var B,Z=b.match($ne);Z&&Z[1]&&(W=Z[1],(B=m).Views||(B.Views=[{}]),(W.match(jne)||[]).forEach(function(Pe,je){Pe=Pr(Pe),B.Views[je]||(B.Views[je]={}),+Pe.zoomScale&&(B.Views[je].zoom=+Pe.zoomScale),di(Pe.rightToLeft)&&(B.Views[je].RTL=!0)}));var G,W=[];c.cellStyles&&(G=b.match(Nne))&&function(Pe,je){for(var it=!1,st=0;st!=je.length;++st){var Ke=Pr(je[st],!0);Ke.hidden&&(Ke.hidden=di(Ke.hidden));var yt=parseInt(Ke.min,10)-1,Wt=parseInt(Ke.max,10)-1;for(Ke.outlineLevel&&(Ke.level=+Ke.outlineLevel||0),delete Ke.min,delete Ke.max,Ke.width=+Ke.width,!it&&Ke.width&&(it=!0,mA(Ke.width)),Cf(Ke);yt<=Wt;)Pe[yt++]=ke(Ke)}}(W,G),T&&Une(T[1],w,c,S,v,p),p=De.match(Dne),p&&(w["!autofilter"]={ref:(p[0].match(/ref="([^"]*)"/)||[])[1]});var J=[],ne=De.match(Pne);if(ne)for(U=0;U!=ne.length;++U)J[U]=un(ne[U].slice(ne[U].indexOf('"')+1));p=De.match(Mne),p&&function(Pe,je,it){for(var st=Array.isArray(Pe),Ke=0;Ke!=je.length;++Ke){var yt=Pr(Qn(je[Ke]),!0);if(!yt.ref)return;var Wt=((it||{})["!id"]||[])[yt.id];Wt?(yt.Target=Wt.Target,yt.location&&(yt.Target+="#"+Sn(yt.location))):(yt.Target="#"+Sn(yt.location),Wt={Target:yt.Target,TargetMode:"Internal"}),yt.Rel=Wt,yt.tooltip&&(yt.Tooltip=yt.tooltip,delete yt.tooltip);for(var Ht=un(yt.ref),At=Ht.s.r;At<=Ht.e.r;++At)for(var Pt=Ht.s.c;Pt<=Ht.e.c;++Pt){var Tt=Fr({c:Pt,r:At});st?(Pe[At]||(Pe[At]=[]),Pe[At][Pt]||(Pe[At][Pt]={t:"z",v:void 0}),Pe[At][Pt].l=yt):(Pe[Tt]||(Pe[Tt]={t:"z",v:void 0}),Pe[Tt].l=yt)}}}(w,p,f);var se,be,De=De.match(Lne);return De&&(w["!margins"]=(se=Pr(De[0]),be={},["left","right","top","bottom","header","footer"].forEach(function(Pe){se[Pe]&&(be[Pe]=parseFloat(se[Pe]))}),be)),!w["!ref"]&&S.e.c>=S.s.c&&S.e.r>=S.s.r&&(w["!ref"]=Wr(S)),0<c.sheetRows&&w["!ref"]&&(De=un(w["!ref"]),c.sheetRows<=+De.e.r&&(De.e.r=c.sheetRows-1,De.e.r>S.e.r&&(De.e.r=S.e.r),De.e.r<De.s.r&&(De.s.r=De.e.r),De.e.c>S.e.c&&(De.e.c=S.e.c),De.e.c<De.s.c&&(De.s.c=De.e.c),w["!fullref"]=w["!ref"],w["!ref"]=Wr(De))),0<W.length&&(w["!cols"]=W),0<J.length&&(w["!merges"]=J),w}function EA(a,c,u,f){a=Pr(a),u.Sheets[f]||(u.Sheets[f]={}),a.codeName&&(u.Sheets[f].CodeName=Sn(Qn(a.codeName)))}var Vne=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Wne=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],jne=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/,Y8,K8,X8,q8,J8,Q8,Z8,Une=(Y8=/<(?:\w+:)?c[ \/>]/,K8=/<\/(?:\w+:)?row>/,X8=/r=["']([^"']*)["']/,q8=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,J8=/ref=["']([^"']*)["']/,Q8=z1("v"),Z8=z1("f"),function(a,c,u,f,m,v){for(var p,w,S,b,T,P,M=0,N="",U=[],B=[],Z=0,G=0,W="",J=0,ne=0,se=0,be=0,De=Array.isArray(v.CellXf),Pe=[],je=[],it=Array.isArray(c),st=[],Ke={},yt=!1,Wt=!!u.sheetStubs,Ht=a.split(K8),At=0,Pt=Ht.length;At!=Pt;++At){var Tt=(N=Ht[At].trim()).length;if(Tt!==0){var ft=0;e:for(M=0;M<Tt;++M)switch(N[M]){case">":if(N[M-1]!="/"){++M;break e}if(u&&u.cellStyles){if(J=(S=Pr(N.slice(ft,M),!0)).r!=null?parseInt(S.r,10):J+1,ne=-1,u.sheetRows&&u.sheetRows<J)continue;yt=!(Ke={}),S.ht&&(yt=!0,Ke.hpt=parseFloat(S.ht),Ke.hpx=fm(Ke.hpt)),S.hidden=="1"&&(yt=!0,Ke.hidden=!0),S.outlineLevel!=null&&(yt=!0,Ke.level=+S.outlineLevel),yt&&(st[J-1]=Ke)}break;case"<":ft=M}if(M<=ft)break;if(J=(S=Pr(N.slice(ft,M),!0)).r!=null?parseInt(S.r,10):J+1,ne=-1,!(u.sheetRows&&u.sheetRows<J)){f.s.r>J-1&&(f.s.r=J-1),f.e.r<J-1&&(f.e.r=J-1),u&&u.cellStyles&&(yt=!(Ke={}),S.ht&&(yt=!0,Ke.hpt=parseFloat(S.ht),Ke.hpx=fm(Ke.hpt)),S.hidden=="1"&&(yt=!0,Ke.hidden=!0),S.outlineLevel!=null&&(yt=!0,Ke.level=+S.outlineLevel),yt&&(st[J-1]=Ke)),U=N.slice(M).split(Y8);for(var Qt,sr=0;sr!=U.length&&U[sr].trim().charAt(0)=="<";++sr);for(U=U.slice(sr),M=0;M!=U.length;++M)if((N=U[M].trim()).length!==0){if(B=N.match(X8),Z=M,G=0,N="<c "+(N.slice(0,1)=="<"?">":"")+N,B!=null&&B.length===2){for(Z=0,W=B[1],G=0;G!=W.length&&!((p=W.charCodeAt(G)-64)<1||26<p);++G)Z=26*Z+p;ne=--Z}else++ne;for(G=0;G!=N.length&&N.charCodeAt(G)!==62;++G);if(++G,(S=Pr(N.slice(0,G),!0)).r||(S.r=Fr({r:J-1,c:ne})),w={t:""},(B=(W=N.slice(G)).match(Q8))!=null&&B[1]!==""&&(w.v=Sn(B[1])),u.cellFormula){(B=W.match(Z8))!=null&&B[1]!==""?(w.f=Sn(Qn(B[1])).replace(/\r\n/g,`
`),u.xlfn||(w.f=M8(w.f)),-1<B[0].indexOf('t="array"')?(w.F=(W.match(J8)||[])[1],-1<w.F.indexOf(":")&&Pe.push([un(w.F),w.F])):-1<B[0].indexOf('t="shared"')&&(T=Pr(B[0]),Qt=Sn(Qn(B[1])),u.xlfn||(Qt=M8(Qt)),je[parseInt(T.si,10)]=[T,Qt,S.r])):(B=W.match(/<f[^>]*\/>/))&&je[(T=Pr(B[0])).si]&&(w.f=(P=je[T.si][1],Yt=je[T.si][2],Qt=S.r,Yt=Vo(Yt).s,Qt=Ii(Qt),F8(P,{r:Qt.r-Yt.r,c:Qt.c-Yt.c})));for(var wr=Ii(S.r),G=0;G<Pe.length;++G)wr.r>=Pe[G][0].s.r&&wr.r<=Pe[G][0].e.r&&wr.c>=Pe[G][0].s.c&&wr.c<=Pe[G][0].e.c&&(w.F=Pe[G][1])}if(S.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else{if(!Wt)continue;w.t="z"}else w.t=S.t||"n";switch(f.s.c>ne&&(f.s.c=ne),f.e.c<ne&&(f.e.c=ne),w.t){case"n":if(w.v==""||w.v==null){if(!Wt)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(w.v===void 0){if(!Wt)continue;w.t="z"}else b=fv[parseInt(w.v,10)],w.v=b.t,w.r=b.r,u.cellHTML&&(w.h=b.h);break;case"str":w.t="s",w.v=w.v!=null?Qn(w.v):"",u.cellHTML&&(w.h=IR(w.v));break;case"inlineStr":B=W.match(q8),w.t="s",B!=null&&(b=hA(B[1]))?(w.v=b.t,u.cellHTML&&(w.h=b.h)):w.v="";break;case"b":w.v=di(w.v);break;case"d":u.cellDates?w.v=ue(w.v,1):(w.v=hi(ue(w.v,1)),w.t="n");break;case"e":u&&u.cellText===!1||(w.w=w.v),w.v=V5[w.v]}var Gr,se=be=0,Yt=null;De&&S.s!==void 0&&(Yt=v.CellXf[S.s])!=null&&(Yt.numFmtId!=null&&(se=Yt.numFmtId),u.cellStyles&&Yt.fillId!=null&&(be=Yt.fillId)),z8(w,se,be,u,m,v),u.cellDates&&De&&w.t=="n"&&xi(D[se])&&(w.t="d",w.v=ee(w.v)),S.cm&&u.xlmeta&&(Gr=(u.xlmeta.Cell||[])[+S.cm-1])&&Gr.type=="XLDAPR"&&(w.D=!0),it?(c[(Gr=Ii(S.r)).r]||(c[Gr.r]=[]),c[Gr.r][Gr.c]=w):c[S.r]=w}}}}0<st.length&&(c["!rows"]=st)});function zne(a,c){for(var u,f,m,v,p=[],w=[],S=un(a["!ref"]),b=[],T=0,B=0,P=a["!rows"],M=Array.isArray(a),N={r:""},U=-1,B=S.s.c;B<=S.e.c;++B)b[B]=gi(B);for(T=S.s.r;T<=S.e.r;++T){for(w=[],m=Ui(T),B=S.s.c;B<=S.e.c;++B){f=b[B]+m;var Z=M?(a[T]||[])[B]:a[f];Z!==void 0&&(u=function(G,W,J,ne){if(G.c&&J["!comments"].push([W,G.c]),G.v===void 0&&typeof G.f!="string"||G.t==="z"&&!G.f)return"";var se="",be=G.t,De=G.v;if(G.t!=="z")switch(G.t){case"b":se=G.v?"1":"0";break;case"n":se=""+G.v;break;case"e":se=ih[G.v];break;case"d":se=ne&&ne.cellDates?ue(G.v,-1).toISOString():((G=ke(G)).t="n",""+(G.v=hi(ue(G.v)))),G.z===void 0&&(G.z=D[14]);break;default:se=G.v}var Pe=Qs("v",Bn(se)),je={r:W},it=bf(ne.cellXfs,G,ne);switch(it!==0&&(je.s=it),G.t){case"n":break;case"d":je.t="d";break;case"b":je.t="b";break;case"e":je.t="e";break;case"z":break;default:if(G.v==null){delete G.t;break}if(32767<G.v.length)throw new Error("Text length must not exceed 32767 characters");if(ne&&ne.bookSST){Pe=Qs("v",""+xA(ne.Strings,G.v,ne.revStrings)),je.t="s";break}je.t="str"}return G.t!=be&&(G.t=be,G.v=De),typeof G.f=="string"&&G.f&&(De=G.F&&G.F.slice(0,W.length)==W?{t:"array",ref:G.F}:null,Pe=Nt("f",Bn(G.f),De)+(G.v!=null?Pe:"")),G.l&&J["!links"].push([W,G.l]),G.D&&(je.cm=1),Nt("c",Pe,je)}(Z,f,a,c))!=null&&w.push(u)}(0<w.length||P&&P[T])&&(N={r:m},P&&P[T]&&((v=P[T]).hidden&&(N.hidden=1),U=-1,v.hpx?U=ov(v.hpx):v.hpt&&(U=v.hpt),-1<U&&(N.ht=U,N.customHeight=1),v.level&&(N.outlineLevel=v.level)),p[p.length]=Nt("row",w.join(""),N))}if(P)for(;T<P.length;++T)P&&P[T]&&(N={r:T+1},(v=P[T]).hidden&&(N.hidden=1),U=-1,v.hpx?U=ov(v.hpx):v.hpt&&(U=v.hpt),-1<U&&(N.ht=U,N.customHeight=1),v.level&&(N.outlineLevel=v.level),p[p.length]=Nt("row","",N));return p.join("")}function eH(a,c,u,f){var m,v,p=[fi,Nt("worksheet",null,{xmlns:Ud[0],"xmlns:r":Ts.r})],w=u.SheetNames[a],S=u.Sheets[w],b=(S=S??{})["!ref"]||"A1",T=un(b);if(16383<T.e.c||1048575<T.e.r){if(c.WTF)throw new Error("Range "+b+" exceeds format limit A1:XFD1048576");T.e.c=Math.min(T.e.c,16383),T.e.r=Math.min(T.e.c,1048575),b=Wr(T)}f=f||{},S["!comments"]=[];var P,M,N=[];(function(G,W,J,ne,se){var be=!1,De={},Pe=null;if(ne.bookType!=="xlsx"&&W.vbaraw){var je=W.SheetNames[J];try{W.Workbook&&(je=W.Workbook.Sheets[J].CodeName||je)}catch{}be=!0,De.codeName=Kc(Bn(je))}G&&G["!outline"]&&(ne={summaryBelow:1,summaryRight:1},G["!outline"].above&&(ne.summaryBelow=0),G["!outline"].left&&(ne.summaryRight=0),Pe=(Pe||"")+Nt("outlinePr",null,ne)),(be||Pe)&&(se[se.length]=Nt("sheetPr",Pe,De))})(S,u,a,c,p),p[p.length]=Nt("dimension",null,{ref:b}),p[p.length]=(w={workbookViewId:"0"},((((T=u)||{}).Workbook||{}).Views||[])[0]&&(w.rightToLeft=T.Workbook.Views[0].RTL?"1":"0"),Nt("sheetViews",Nt("sheetView",null,w),{})),c.sheetFormat&&(p[p.length]=Nt("sheetFormatPr",null,{defaultRowHeight:c.sheetFormat.defaultRowHeight||"16",baseColWidth:c.sheetFormat.baseColWidth||"10",outlineLevelRow:c.sheetFormat.outlineLevelRow||"7"})),S["!cols"]!=null&&0<S["!cols"].length&&(p[p.length]=function(G){for(var W,J=["<cols>"],ne=0;ne!=G.length;++ne)(W=G[ne])&&(J[J.length]=Nt("col",null,GS(ne,W)));return J[J.length]="</cols>",J.join("")}(S["!cols"])),p[m=p.length]="<sheetData/>",S["!links"]=[],S["!ref"]!=null&&0<(v=zne(S,c)).length&&(p[p.length]=v),p.length>m+1&&(p[p.length]="</sheetData>",p[m]=p[m].replace("/>",">")),S["!protect"]&&(p[p.length]=(P=S["!protect"],M={sheet:1},Vne.forEach(function(G){P[G]!=null&&P[G]&&(M[G]="1")}),Wne.forEach(function(G){P[G]==null||P[G]||(M[G]="0")}),P.password&&(M.password=fA(P.password).toString(16).toUpperCase()),Nt("sheetProtection",null,M))),S["!autofilter"]!=null&&(p[p.length]=function(G,W,J,ne){var se=typeof G.ref=="string"?G.ref:Wr(G.ref);J.Workbook||(J.Workbook={Sheets:[]}),J.Workbook.Names||(J.Workbook.Names=[]);var be=J.Workbook.Names;(G=Vo(se)).s.r==G.e.r&&(G.e.r=Vo(W["!ref"]).e.r,se=Wr(G));for(var De=0;De<be.length;++De){var Pe=be[De];if(Pe.Name=="_xlnm._FilterDatabase"&&Pe.Sheet==ne){Pe.Ref="'"+J.SheetNames[ne]+"'!"+se;break}}return De==be.length&&be.push({Name:"_xlnm._FilterDatabase",Sheet:ne,Ref:"'"+J.SheetNames[ne]+"'!"+se}),Nt("autoFilter",null,{ref:se})}(S["!autofilter"],S,u,a)),S["!merges"]!=null&&0<S["!merges"].length&&(p[p.length]=function(G){if(G.length===0)return"";for(var W='<mergeCells count="'+G.length+'">',J=0;J!=G.length;++J)W+='<mergeCell ref="'+Wr(G[J])+'"/>';return W+"</mergeCells>"}(S["!merges"]));var U,B,Z=-1;return 0<S["!links"].length&&(p[p.length]="<hyperlinks>",S["!links"].forEach(function(G){G[1].Target&&(B={ref:G[0]},G[1].Target.charAt(0)!="#"&&(Z=Vn(f,-1,Bn(G[1].Target).replace(/#.*$/,""),zr.HLINK),B["r:id"]="rId"+Z),-1<(U=G[1].Target.indexOf("#"))&&(B.location=Bn(G[1].Target.slice(U+1))),G[1].Tooltip&&(B.tooltip=Bn(G[1].Tooltip)),p[p.length]=Nt("hyperlink",null,B))}),p[p.length]="</hyperlinks>"),delete S["!links"],S["!margins"]!=null&&(p[p.length]=(t0(u=S["!margins"]),Nt("pageMargins",null,u))),c&&!c.ignoreEC&&c.ignoreEC!=null||(p[p.length]=Qs("ignoredErrors",Nt("ignoredError",null,{numberStoredAsText:1,sqref:b}))),0<N.length&&(Z=Vn(f,-1,"../drawings/drawing"+(a+1)+".xml",zr.DRAW),p[p.length]=Nt("drawing",null,{"r:id":"rId"+Z}),S["!drawing"]=N),0<S["!comments"].length&&(Z=Vn(f,-1,"../drawings/vmlDrawing"+(a+1)+".vml",zr.VML),p[p.length]=Nt("legacyDrawing",null,{"r:id":"rId"+Z}),S["!legacy"]=Z),1<p.length&&(p[p.length]="</worksheet>",p[1]=p[1].replace("/>",">")),p.join("")}function Gne(a,c,u,f){u=function(m,v,p){var w=tt(145),S=(p["!rows"]||[])[m]||{};w.write_shift(4,m),w.write_shift(4,0);var T=320;S.hpx?T=20*ov(S.hpx):S.hpt&&(T=20*S.hpt),w.write_shift(2,T),w.write_shift(1,0),T=0,S.level&&(T|=S.level),S.hidden&&(T|=16),(S.hpx||S.hpt)&&(T|=32),w.write_shift(1,T),w.write_shift(1,0);var b=0,T=w.l;w.l+=4;for(var P={r:m,c:0},M=0;M<16;++M)if(!(v.s.c>M+1<<10||v.e.c<M<<10)){for(var N=-1,U=-1,B=M<<10;B<M+1<<10;++B)P.c=B,(Array.isArray(p)?(p[P.r]||[])[P.c]:p[Fr(P)])&&(N<0&&(N=B),U=B);N<0||(++b,w.write_shift(4,N),w.write_shift(4,U))}return m=w.l,w.l=T,w.write_shift(4,b),w.l=m,w.length>w.l?w.slice(0,w.l):w}(f,u,c),(17<u.length||(c["!rows"]||[])[f])&&ht(a,0,u)}var YS=Xd,Yne=om;function tH(a){return[Yd(a),yo(a),"n"]}var pm=Xd,Kne=om,rH=["left","right","top","bottom","header","footer"];function Xne(a,c,u,f,m,v,p){if(c.v===void 0)return!1;var w="";switch(c.t){case"b":w=c.v?"1":"0";break;case"d":(c=ke(c)).z=c.z||D[14],c.v=hi(ue(c.v)),c.t="n";break;case"n":case"e":w=""+c.v;break;default:w=c.v}var S,b,T,P,M,N,U,B,Z,G,W,J,ne,se,be,De,Pe,je,it,st,Ke={r:u,c:f};switch(Ke.s=bf(m.cellXfs,c,m),c.l&&v["!links"].push([Fr(Ke),c.l]),c.c&&v["!comments"].push([Fr(Ke),c.c]),c.t){case"s":case"str":return m.bookSST?(w=xA(m.Strings,c.v,m.revStrings),Ke.t="s",Ke.v=w,p?ht(a,18,(Kd(Pe=Ke,je=je??tt(8)),je.write_shift(4,Pe.v),je)):ht(a,7,(Gd(Pe=Ke,De=De??tt(12)),De.write_shift(4,Pe.v),De))):(Ke.t="str",p?ht(a,17,(se=c,Kd(Ke,be=be??tt(8+4*se.v.length)),Ls(se.v,be),be.length>be.l?be.slice(0,be.l):be)):ht(a,6,(se=c,Gd(Ke,ne=ne??tt(12+4*se.v.length)),Ls(se.v,ne),ne.length>ne.l?ne.slice(0,ne.l):ne))),!0;case"n":return c.v==(0|c.v)&&-1e3<c.v&&c.v<1e3?p?ht(a,13,(W=c,Kd(Ke,J=J??tt(8)),N5(W.v,J),J)):ht(a,2,(W=c,Gd(Ke,G=G??tt(12)),N5(W.v,G),G)):p?ht(a,16,(B=c,Kd(Ke,Z=Z??tt(12)),am(B.v,Z),Z)):ht(a,5,(B=c,Gd(Ke,U=U??tt(16)),am(B.v,U),U)),!0;case"b":return Ke.t="b",p?ht(a,15,(M=c,Kd(Ke,N=N??tt(5)),N.write_shift(1,M.v?1:0),N)):ht(a,4,(M=c,Gd(Ke,P=P??tt(9)),P.write_shift(1,M.v?1:0),P)),!0;case"e":return Ke.t="e",p?ht(a,14,(b=c,Kd(Ke,T=T??tt(8)),T.write_shift(1,b.v),T.write_shift(2,0),T.write_shift(1,0),T)):ht(a,3,(b=c,Gd(Ke,S=S??tt(9)),S.write_shift(1,b.v),S)),!0}return p?ht(a,12,Kd(Ke,st=st??tt(4))):ht(a,1,Gd(Ke,it=it??tt(8))),!0}function qne(a,c){var u,f;c&&c["!merges"]&&(ht(a,177,(u=c["!merges"].length,(f=f??tt(4)).write_shift(4,u),f)),c["!merges"].forEach(function(m){ht(a,176,Kne(m))}),ht(a,178))}function Jne(a,c){c&&c["!cols"]&&(ht(a,390),c["!cols"].forEach(function(u,f){u&&ht(a,60,function(m,v,p){p==null&&(p=tt(18));var w=GS(m,v);return p.write_shift(-4,m),p.write_shift(-4,m),p.write_shift(4,256*(w.width||10)),p.write_shift(4,0),m=0,v.hidden&&(m|=1),typeof w.width=="number"&&(m|=2),v.level&&(m|=v.level<<8),p.write_shift(2,m),p}(f,u))}),ht(a,391))}function Qne(a,c){var u;c&&c["!ref"]&&(ht(a,648),ht(a,649,(u=un(c["!ref"]),(c=tt(24)).write_shift(4,4),c.write_shift(4,1),om(u,c),c)),ht(a,650))}function Zne(a,c,u){c["!links"].forEach(function(f){var m,v;f[1].Target&&(m=Vn(u,-1,f[1].Target.replace(/#.*$/,""),zr.HLINK),ht(a,494,(v=m,f=tt(50+4*((m=f)[1].Target.length+(m[1].Tooltip||"").length)),om({s:Ii(m[0]),e:Ii(m[0])},f),YR("rId"+v,f),Ls(((v=m[1].Target.indexOf("#"))==-1?"":m[1].Target.slice(v+1))||"",f),Ls(m[1].Tooltip||"",f),Ls("",f),f.slice(0,f.l))))}),delete c["!links"]}function eie(a,c,u){ht(a,133),ht(a,137,function(f,m){m==null&&(m=tt(30));var v=924;return(((f||{}).Views||[])[0]||{}).RTL&&(v|=32),m.write_shift(2,v),m.write_shift(4,0),m.write_shift(4,0),m.write_shift(4,0),m.write_shift(1,0),m.write_shift(1,0),m.write_shift(2,0),m.write_shift(2,100),m.write_shift(2,0),m.write_shift(2,0),m.write_shift(2,0),m.write_shift(4,0),m}(u)),ht(a,138),ht(a,134)}function tie(a,c){var u,f;c["!protect"]&&ht(a,535,(u=c["!protect"],(f=f??tt(66)).write_shift(2,u.password?fA(u.password):0),f.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(m){m[1]?f.write_shift(4,u[m[0]]==null||u[m[0]]?0:1):f.write_shift(4,u[m[0]]!=null&&u[m[0]]?0:1)}),f))}function rie(a,c,u,f){var m=ga(),b=u.SheetNames[a],v=u.Sheets[b]||{},p=b;try{u&&u.Workbook&&(p=u.Workbook.Sheets[a].CodeName||p)}catch{}var w,S,b=un(v["!ref"]||"A1");if(16383<b.e.c||1048575<b.e.r){if(c.WTF)throw new Error("Range "+(v["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");b.e.c=Math.min(b.e.c,16383),b.e.r=Math.min(b.e.c,1048575)}return v["!links"]=[],v["!comments"]=[],ht(m,129),(u.vbaraw||v["!outline"])&&ht(m,147,function(T,P,M){M==null&&(M=tt(84+4*T.length));var N=192;P&&(P.above&&(N&=-65),P.left&&(N&=-129)),M.write_shift(1,N);for(var U=1;U<3;++U)M.write_shift(1,0);return TS({auto:1},M),M.write_shift(-4,-1),M.write_shift(-4,-1),k5(T,M),M.slice(0,M.l)}(p,v["!outline"])),ht(m,148,Yne(b)),eie(m,0,u.Workbook),Jne(m,v),function(T,P,M){var N,U=un(P["!ref"]||"A1"),B=[];ht(T,145);var Z=Array.isArray(P),G=U.e.r;P["!rows"]&&(G=Math.max(U.e.r,P["!rows"].length-1));for(var W=U.s.r;W<=G;++W){N=Ui(W),Gne(T,P,U,W);var J=!1;if(W<=U.e.r)for(var ne=U.s.c;ne<=U.e.c;++ne){W===U.s.r&&(B[ne]=gi(ne)),se=B[ne]+N;var se=Z?(P[W]||[])[ne]:P[se];se?J=Xne(T,se,W,ne,M,P,J):J=!1}}ht(T,146)}(m,v,c),tie(m,v),function(T,P,M,N){if(P["!autofilter"]){var Z=P["!autofilter"],U=typeof Z.ref=="string"?Z.ref:Wr(Z.ref);M.Workbook||(M.Workbook={Sheets:[]}),M.Workbook.Names||(M.Workbook.Names=[]);var B=M.Workbook.Names,Z=Vo(U);Z.s.r==Z.e.r&&(Z.e.r=Vo(P["!ref"]).e.r,U=Wr(Z));for(var G=0;G<B.length;++G){var W=B[G];if(W.Name=="_xlnm._FilterDatabase"&&W.Sheet==N){W.Ref="'"+M.SheetNames[N]+"'!"+U;break}}G==B.length&&B.push({Name:"_xlnm._FilterDatabase",Sheet:N,Ref:"'"+M.SheetNames[N]+"'!"+U}),ht(T,161,om(un(U))),ht(T,162)}}(m,v,u,a),qne(m,v),Zne(m,v,f),v["!margins"]&&ht(m,476,(w=v["!margins"],S==null&&(S=tt(48)),t0(w),rH.forEach(function(T){am(w[T],S)}),S)),c&&!c.ignoreEC&&c.ignoreEC!=null||Qne(m,v),b=m,c=a,f=f,0<(v=v)["!comments"].length&&(c=Vn(f,-1,"../drawings/vmlDrawing"+(c+1)+".vml",zr.VML),ht(b,551,YR("rId"+c)),v["!legacy"]=c),ht(m,130),m.end()}function nie(a,c,u,f,m,v){var p=v||{"!type":"chart"};if(!a)return v;var w,S=0,b=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(a.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(P){var M=function(N){var U,B=[],Z=N.match(/^<c:numCache>/);(N.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(W){W=W.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/),W&&(B[+W[1]]=Z?+W[2]:W[2])});var G=Sn((N.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(N.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(W){U=W.replace(/<.*?>/g,"")}),[B,G,U]}(P);T.s.r=T.s.c=0,T.e.c=S,w=gi(S),M[0].forEach(function(N,U){p[w+Ui(U)]={t:"n",v:N,z:M[1]},b=U}),T.e.r<b&&(T.e.r=b),++S}),0<S&&(p["!ref"]=Wr(T)),p}var TA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],iie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],sie=[],oie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function nH(a,c){for(var u=0;u!=a.length;++u)for(var f=a[u],m=0;m!=c.length;++m){var v=c[m];if(f[v[0]]==null)f[v[0]]=v[1];else switch(v[2]){case"bool":typeof f[v[0]]=="string"&&(f[v[0]]=di(f[v[0]]));break;case"int":typeof f[v[0]]=="string"&&(f[v[0]]=parseInt(f[v[0]],10))}}}function iH(a,c){for(var u=0;u!=c.length;++u){var f=c[u];if(a[f[0]]==null)a[f[0]]=f[1];else switch(f[2]){case"bool":typeof a[f[0]]=="string"&&(a[f[0]]=di(a[f[0]]));break;case"int":typeof a[f[0]]=="string"&&(a[f[0]]=parseInt(a[f[0]],10))}}}function sH(a){iH(a.WBProps,TA),iH(a.CalcPr,oie),nH(a.WBView,iie),nH(a.Sheets,sie),mm.date1904=di(a.WBProps.date1904)}var aie="][*?/\\".split("");function oH(a,c){if(31<a.length)throw new Error("Sheet names cannot exceed 31 chars");var u=!0;return aie.forEach(function(f){if(a.indexOf(f)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),u}function aH(a){if(!a||!a.SheetNames||!a.Sheets)throw new Error("Invalid Workbook");if(!a.SheetNames.length)throw new Error("Workbook is empty");var c,u,f,m=a.Workbook&&a.Workbook.Sheets||[];c=a.SheetNames,u=m,f=!!a.vbaraw,c.forEach(function(p,w){oH(p);for(var S=0;S<w;++S)if(p==c[S])throw new Error("Duplicate Sheet Name: "+p);if(f){var b=u&&u[w]&&u[w].CodeName||p;if(b.charCodeAt(0)==95&&22<b.length)throw new Error("Bad Code Name: Worksheet"+b)}});for(var v=0;v<a.SheetNames.length;++v)(function(p,w){if(p&&p["!ref"]){var S=un(p["!ref"]);if(S.e.c<S.s.c||S.e.r<S.s.r)throw new Error("Bad range ("+w+"): "+p["!ref"])}})(a.Sheets[a.SheetNames[v]],(a.SheetNames[v],v))}var lie=/<\w+:workbook/;function lH(a){var c=[fi];c[c.length]=Nt("workbook",null,{xmlns:Ud[0],"xmlns:r":Ts.r});var u=a.Workbook&&0<(a.Workbook.Names||[]).length,f={codeName:"ThisWorkbook"};a.Workbook&&a.Workbook.WBProps&&(TA.forEach(function(w){a.Workbook.WBProps[w[0]]!=null&&a.Workbook.WBProps[w[0]]!=w[1]&&(f[w[0]]=a.Workbook.WBProps[w[0]])}),a.Workbook.WBProps.CodeName&&(f.codeName=a.Workbook.WBProps.CodeName,delete f.CodeName)),c[c.length]=Nt("workbookPr",null,f);var m=a.Workbook&&a.Workbook.Sheets||[],v=0;if(m[0]&&m[0].Hidden){for(c[c.length]="<bookViews>",v=0;v!=a.SheetNames.length&&m[v]&&m[v].Hidden;++v);v==a.SheetNames.length&&(v=0),c[c.length]='<workbookView firstSheet="'+v+'" activeTab="'+v+'"/>',c[c.length]="</bookViews>"}for(c[c.length]="<sheets>",v=0;v!=a.SheetNames.length;++v){var p={name:Bn(a.SheetNames[v].slice(0,31))};if(p.sheetId=""+(v+1),p["r:id"]="rId"+(v+1),m[v])switch(m[v].Hidden){case 1:p.state="hidden";break;case 2:p.state="veryHidden"}c[c.length]=Nt("sheet",null,p)}return c[c.length]="</sheets>",u&&(c[c.length]="<definedNames>",a.Workbook&&a.Workbook.Names&&a.Workbook.Names.forEach(function(w){var S={name:w.Name};w.Comment&&(S.comment=w.Comment),w.Sheet!=null&&(S.localSheetId=""+w.Sheet),w.Hidden&&(S.hidden="1"),w.Ref&&(c[c.length]=Nt("definedName",Bn(w.Ref),S))}),c[c.length]="</definedNames>"),2<c.length&&(c[c.length]="</workbook>",c[1]=c[1].replace("/>",">")),c.join("")}function cie(a,c){var u={};return a.read_shift(4),u.ArchID=a.read_shift(4),a.l+=c-8,u}function uie(a,c){ht(a,143);for(var u,f=0;f!=c.SheetNames.length;++f){var m={Hidden:c.Workbook&&c.Workbook.Sheets&&c.Workbook.Sheets[f]&&c.Workbook.Sheets[f].Hidden||0,iTabID:f+1,strRelID:"rId"+(f+1),name:c.SheetNames[f]};ht(a,156,(u=m,(m=(m=void 0)||tt(127)).write_shift(4,u.Hidden),m.write_shift(4,u.iTabID),YR(u.strRelID,m),Ls(u.name.slice(0,31),m),m.length>m.l?m.slice(0,m.l):m))}ht(a,144)}function hie(a,c){if(c.Workbook&&c.Workbook.Sheets){for(var u,f=c.Workbook.Sheets,m=0,v=-1,p=-1;m<f.length;++m)!f[m]||!f[m].Hidden&&v==-1?v=m:f[m].Hidden==1&&p==-1&&(p=m);v<p||(ht(a,135),ht(a,158,(c=v,(u=u||tt(29)).write_shift(-4,0),u.write_shift(-4,460),u.write_shift(4,28800),u.write_shift(4,17600),u.write_shift(4,500),u.write_shift(4,c),u.write_shift(4,c),u.write_shift(1,120),u.length>u.l?u.slice(0,u.l):u)),ht(a,136))}}function fie(a,c){var u=ga();return ht(u,131),ht(u,128,function(f){f=f||tt(127);for(var m=0;m!=4;++m)f.write_shift(4,0);return Ls("SheetJS",f),Ls(s.version,f),Ls(s.version,f),Ls("7262",f),f.length>f.l?f.slice(0,f.l):f}()),ht(u,153,function(f,m){m=m||tt(72);var v=0;return f&&f.filterPrivacy&&(v|=8),m.write_shift(4,v),m.write_shift(4,0),k5(f&&f.CodeName||"ThisWorkbook",m),m.slice(0,m.l)}(a.Workbook&&a.Workbook.WBProps||null)),hie(u,a),uie(u,a),ht(u,132),u.end()}function die(a,c,u){return(c.slice(-4)===".bin"?function(f,m){var v={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},p=[],w=!1;(m=m||{}).biff=12;var S=[],b=[[]];return b.SheetNames=[],b.XTI=[],pv[16]={n:"BrtFRTArchID$",f:cie},nh(f,function(T,P,M){switch(M){case 156:b.SheetNames.push(T.name),v.Sheets.push(T);break;case 153:v.WBProps=T;break;case 39:T.Sheet!=null&&(m.SID=T.Sheet),T.Ref=jo(T.Ptg,0,null,b,m),delete m.SID,delete T.Ptg,S.push(T);break;case 1036:break;case 357:case 358:case 355:case 667:b[0].length?b.push([M,T]):b[0]=[M,T],b[b.length-1].XTI=[];break;case 362:b.length===0&&(b[0]=[],b[0].XTI=[]),b[b.length-1].XTI=b[b.length-1].XTI.concat(T),b.XTI=b.XTI.concat(T);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:p.push(M),w=!0;break;case 36:p.pop(),w=!1;break;case 37:p.push(M),w=!0;break;case 38:p.pop(),w=!1;break;case 16:break;default:if(!P.T&&(!w||m.WTF&&p[p.length-1]!=37&&p[p.length-1]!=35))throw new Error("Unexpected record 0x"+M.toString(16))}},m),sH(v),v.Names=S,v.supbooks=b,v}:function(f,m){if(!f)throw new Error("Could not find file");var v={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},p=!1,w="xmlns",S={},b=0;if(f.replace(po,function(T,P){var M=Pr(T);switch(Yc(M[0])){case"<?xml":break;case"<workbook":T.match(lie)&&(w="xmlns"+T.match(/<(\w+):/)[1]),v.xmlns=M[w];break;case"</workbook>":break;case"<fileVersion":delete M[0],v.AppVersion=M;break;case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":TA.forEach(function(N){if(M[N[0]]!=null)switch(N[2]){case"bool":v.WBProps[N[0]]=di(M[N[0]]);break;case"int":v.WBProps[N[0]]=parseInt(M[N[0]],10);break;default:v.WBProps[N[0]]=M[N[0]]}}),M.codeName&&(v.WBProps.CodeName=Qn(M.codeName));break;case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete M[0],v.WBView.push(M);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(M.state){case"hidden":M.Hidden=1;break;case"veryHidden":M.Hidden=2;break;default:M.Hidden=0}delete M.state,M.name=Sn(Qn(M.name)),delete M[0],v.Sheets.push(M);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":break;case"<definedNames>":case"<definedNames":p=!0;break;case"</definedNames>":p=!1;break;case"<definedName":(S={}).Name=Qn(M.name),M.comment&&(S.Comment=M.comment),M.localSheetId&&(S.Sheet=+M.localSheetId),di(M.hidden||"0")&&(S.Hidden=!0),b=P+T.length;break;case"</definedName>":S.Ref=Sn(Qn(f.slice(b,P))),v.Names.push(S);break;case"<definedName/>":break;case"<calcPr":case"<calcPr/>":delete M[0],v.CalcPr=M;break;case"</calcPr>":case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":p=!0;break;case"</ext>":p=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":p=!0;break;case"</AlternateContent>":p=!1;break;case"<revisionPtr":break;default:if(!p&&m.WTF)throw new Error("unrecognized "+M[0]+" in workbook")}return T}),Ud.indexOf(v.xmlns)===-1)throw new Error("Unknown Namespace: "+v.xmlns);return sH(v),v})(a,u)}function gie(a,c,u,f,m,v,p,w){return(c.slice(-4)===".bin"?function(S,b,T,P,M,N,U){if(!S)return S;var B=b||{};P=P||{"!id":{}};var Z,G,W,J,ne,se,be,De,Pe,je,it=B.dense?[]:{},st={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ke=!1,yt=!1,Wt=[];B.biff=12;var Ht=B["!row"]=0,At=!1,Pt=[],Tt={},ft=B.supbooks||M.supbooks||[[]];if(ft.sharedf=Tt,ft.arrayf=Pt,ft.SheetNames=M.SheetNames||M.Sheets.map(function(wt){return wt.name}),!B.supbooks&&(B.supbooks=ft,M.Names))for(var Qt=0;Qt<M.Names.length;++Qt)ft[0][Qt+1]=M.Names[Qt];var sr,wr=[],Gr=[],Yt=!1;return pv[16]={n:"BrtShortReal",f:tH},nh(S,function(wt,Mr,fn){if(!yt)switch(fn){case 148:Z=wt;break;case 0:G=wt,B.sheetRows&&B.sheetRows<=G.r&&(yt=!0),Pe=Ui(ne=G.r),B["!row"]=G.r,(wt.hidden||wt.hpt||wt.level!=null)&&(wt.hpt&&(wt.hpx=fm(wt.hpt)),Gr[wt.r]=wt);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(W={t:wt[2]},wt[2]){case"n":W.v=wt[1];break;case"s":De=fv[wt[1]],W.v=De.t,W.r=De.r;break;case"b":W.v=!!wt[1];break;case"e":W.v=wt[1],B.cellText!==!1&&(W.w=ih[W.v]);break;case"str":W.t="s",W.v=wt[1];break;case"is":W.t="s",W.v=wt[1].t}if((J=U.CellXf[wt[0].iStyleRef])&&z8(W,J.numFmtId,null,B,N,U),se=wt[0].c==-1?se+1:wt[0].c,B.dense?(it[ne]||(it[ne]=[]),it[ne][se]=W):it[gi(se)+Pe]=W,B.cellFormula){for(At=!1,Ht=0;Ht<Pt.length;++Ht){var rn=Pt[Ht];G.r>=rn[0].s.r&&G.r<=rn[0].e.r&&se>=rn[0].s.c&&se<=rn[0].e.c&&(W.F=Wr(rn[0]),At=!0)}!At&&3<wt.length&&(W.f=wt[3])}st.s.r>G.r&&(st.s.r=G.r),st.s.c>se&&(st.s.c=se),st.e.r<G.r&&(st.e.r=G.r),st.e.c<se&&(st.e.c=se),B.cellDates&&J&&W.t=="n"&&xi(D[J.numFmtId])&&(In=ye(W.v))&&(W.t="d",W.v=new Date(In.y,In.m-1,In.d,In.H,In.M,In.S,In.u)),sr&&(sr.type=="XLDAPR"&&(W.D=!0),sr=void 0);break;case 1:case 12:if(!B.sheetStubs||Ke)break;W={t:"z",v:void 0},se=wt[0].c==-1?se+1:wt[0].c,B.dense?(it[ne]||(it[ne]=[]),it[ne][se]=W):it[gi(se)+Pe]=W,st.s.r>G.r&&(st.s.r=G.r),st.s.c>se&&(st.s.c=se),st.e.r<G.r&&(st.e.r=G.r),st.e.c<se&&(st.e.c=se),sr&&(sr.type=="XLDAPR"&&(W.D=!0),sr=void 0);break;case 176:Wt.push(wt);break;case 49:sr=((B.xlmeta||{}).Cell||[])[wt-1];break;case 494:var In=P["!id"][wt.relId];for(In?(wt.Target=In.Target,wt.loc&&(wt.Target+="#"+wt.loc),wt.Rel=In):wt.relId==""&&(wt.Target="#"+wt.loc),ne=wt.rfx.s.r;ne<=wt.rfx.e.r;++ne)for(se=wt.rfx.s.c;se<=wt.rfx.e.c;++se)B.dense?(it[ne]||(it[ne]=[]),it[ne][se]||(it[ne][se]={t:"z",v:void 0}),it[ne][se].l=wt):(be=Fr({c:se,r:ne}),it[be]||(it[be]={t:"z",v:void 0}),it[be].l=wt);break;case 426:if(!B.cellFormula)break;Pt.push(wt),(je=B.dense?it[ne][se]:it[gi(se)+Pe]).f=jo(wt[1],0,{r:G.r,c:se},ft,B),je.F=Wr(wt[0]);break;case 427:if(!B.cellFormula)break;Tt[Fr(wt[0].s)]=wt[1],(je=B.dense?it[ne][se]:it[gi(se)+Pe]).f=jo(wt[1],0,{r:G.r,c:se},ft,B);break;case 60:if(!B.cellStyles)break;for(;wt.e>=wt.s;)wr[wt.e--]={width:wt.w/256,hidden:!!(1&wt.flags),level:wt.level},Yt||(Yt=!0,mA(wt.w/256)),Cf(wr[wt.e+1]);break;case 161:it["!autofilter"]={ref:Wr(wt)};break;case 476:it["!margins"]=wt;break;case 147:M.Sheets[T]||(M.Sheets[T]={}),wt.name&&(M.Sheets[T].CodeName=wt.name),(wt.above||wt.left)&&(it["!outline"]={above:wt.above,left:wt.left});break;case 137:M.Views||(M.Views=[{}]),M.Views[0]||(M.Views[0]={}),wt.RTL&&(M.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:Ke=!0;break;case 36:Ke=!1;break;case 37:Ke=!0;break;case 38:Ke=!1;break;default:if(!Mr.T&&(!Ke||B.WTF))throw new Error("Unexpected record 0x"+fn.toString(16))}},B),delete B.supbooks,delete B["!row"],!it["!ref"]&&(st.s.r<2e6||Z&&(0<Z.e.r||0<Z.e.c||0<Z.s.r||0<Z.s.c))&&(it["!ref"]=Wr(Z||st)),B.sheetRows&&it["!ref"]&&(S=un(it["!ref"]),B.sheetRows<=+S.e.r&&(S.e.r=B.sheetRows-1,S.e.r>st.e.r&&(S.e.r=st.e.r),S.e.r<S.s.r&&(S.s.r=S.e.r),S.e.c>st.e.c&&(S.e.c=st.e.c),S.e.c<S.s.c&&(S.s.c=S.e.c),it["!fullref"]=it["!ref"],it["!ref"]=Wr(S))),0<Wt.length&&(it["!merges"]=Wt),0<wr.length&&(it["!cols"]=wr),0<Gr.length&&(it["!rows"]=Gr),it}:Bne)(a,f,u,m,v,p,w)}function mie(a,c,u,f,m,v){return c.slice(-4)===".bin"?function(p,w,S,b,T){if(!p)return p;b=b||{"!id":{}};var P={"!type":"chart","!drawel":null,"!rel":""},M=!1;return nh(p,function(N,U,B){switch(B){case 550:P["!rel"]=N;break;case 651:T.Sheets[S]||(T.Sheets[S]={}),N.name&&(T.Sheets[S].CodeName=N.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:M=!0;break;case 36:M=!1;break;case 37:break;case 38:break;default:if(!(0<U.T)){if(!(U.T<0)){if(!M||w.WTF)throw new Error("Unexpected record 0x"+B.toString(16))}}}},w),b["!id"][P["!rel"]]&&(P["!drawel"]=b["!id"][P["!rel"]]),P}(a,f,u,m,v):function(p,w,S,b){if(!p)return p;S=S||{"!id":{}};var T={"!type":"chart","!drawel":null,"!rel":""},P=p.match(G8);return P&&EA(P[0],0,b,w),(p=p.match(/drawing r:id="(.*?)"/))&&(T["!rel"]=p[1]),S["!id"][T["!rel"]]&&(T["!drawel"]=S["!id"][T["!rel"]]),T}(a,u,m,v)}function pie(a,c,u,f){return(c.slice(-4)===".bin"?function(m,v,p){var w,S={NumberFmt:[]};for(w in D)S.NumberFmt[w]=D[w];S.CellXf=[],S.Fonts=[];var b=[],T=!1;return nh(m,function(P,M,N){switch(N){case 44:S.NumberFmt[P[0]]=P[1],Nr(P[1],P[0]);break;case 43:S.Fonts.push(P),P.color.theme!=null&&v&&v.themeElements&&v.themeElements.clrScheme&&(P.color.rgb=BS(v.themeElements.clrScheme[P.color.theme].rgb,P.color.tint||0));break;case 1025:case 45:case 46:break;case 47:b[b.length-1]==617&&S.CellXf.push(P);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:T=!0;break;case 36:T=!1;break;case 37:b.push(N),T=!0;break;case 38:b.pop(),T=!1;break;default:if(0<M.T)b.push(N);else if(M.T<0)b.pop();else if(!T||p.WTF&&b[b.length-1]!=37)throw new Error("Unexpected record 0x"+N.toString(16))}}),S}:Xre)(a,u,f)}function vie(a,c,u){return c.slice(-4)===".bin"?(f=u,v=!(m=[]),nh(a,function(p,w,S){switch(S){case 159:m.Count=p[0],m.Unique=p[1];break;case 19:m.push(p);break;case 160:return 1;case 35:v=!0;break;case 36:v=!1;break;default:if(w.T,!v||f.WTF)throw new Error("Unexpected record 0x"+S.toString(16))}}),m):function(p,w){var S=[],b="";if(!p)return S;if(p=p.match(Nre)){b=p[2].replace(Dre,"").split(Lre);for(var T=0;T!=b.length;++T){var P=hA(b[T].trim(),w);P!=null&&(S[S.length]=P)}p=Pr(p[1]),S.Count=p.count,S.Unique=p.uniqueCount}return S}(a,u);var f,m,v}function wie(a,c,u){return c.slice(-4)===".bin"?(f=u,m=[],v=[],w=!(p={}),nh(a,function(S,b,T){switch(T){case 632:v.push(S);break;case 635:p=S;break;case 637:p.t=S.t,p.h=S.h,p.r=S.r;break;case 636:if(p.author=v[p.iauthor],delete p.iauthor,f.sheetRows&&p.rfx&&f.sheetRows<=p.rfx.r)break;p.t||(p.t=""),delete p.rfx,m.push(p);break;case 3072:break;case 35:w=!0;break;case 36:w=!1;break;case 37:case 38:break;default:if(!b.T&&(!w||f.WTF))throw new Error("Unexpected record 0x"+T.toString(16))}}),m):function(S,b){if(S.match(/<(?:\w+:)?comments *\/>/))return[];var T=[],P=[],M=S.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);return M&&M[1]&&M[1].split(/<\/\w*:?author>/).forEach(function(N){N===""||N.trim()===""||(N=N.match(/<(?:\w+:)?author[^>]*>(.*)/))&&T.push(N[1])}),(S=S.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/))&&S[1]&&S[1].split(/<\/\w*:?comment>/).forEach(function(N){var U,B;N===""||N.trim()===""||(U=N.match(/<(?:\w+:)?comment[^>]*>/))&&(U={author:(B=Pr(U[0])).authorId&&T[B.authorId]||"sheetjsghost",ref:B.ref,guid:B.guid},B=Ii(B.ref),b.sheetRows&&b.sheetRows<=B.r||(N=!!(N=N.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/))&&!!N[1]&&hA(N[1])||{r:"",t:"",h:""},U.r=N.r,N.r=="<t></t>"&&(N.t=N.h=""),U.t=(N.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),b.cellHTML&&(U.h=N.h),P.push(U)))}),P}(a,u);var f,m,v,p,w}function yie(a,c){return c.slice(-4)===".bin"?(u=[],nh(a,function(f,m,v){if(v===63)u.push(f);else if(!m.T)throw new Error("Unexpected record 0x"+v.toString(16))}),u):function(f){var m=[];if(!f)return m;var v=1;return(f.match(po)||[]).forEach(function(p){var w=Pr(p);switch(w[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete w[0],w.i?v=w.i:w.i=v,m.push(w)}}),m}(a);var u}function Cie(a,c,u,f){if(u.slice(-4)===".bin")return function(m,v){if(!m)return m;var p=v||{},w=!1;nh(m,function(S,b,T){switch(T){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:w=!0;break;case 36:w=!1;break;default:if(!b.T&&(!w||p.WTF))throw new Error("Unexpected record 0x"+T.toString(16))}},p)}(a,f)}function Sie(a,c,u){return c.slice(-4)===".bin"?(f={Types:[],Cell:[],Value:[]},m=u||{},p=!(v=[]),w=2,nh(a,function(S,b,T){switch(T){case 335:f.Types.push({name:S.name});break;case 51:S.forEach(function(P){w==1?f.Cell.push({type:f.Types[P[0]-1].name,index:P[1]}):w==0&&f.Value.push({type:f.Types[P[0]-1].name,index:P[1]})});break;case 337:w=S?1:0;break;case 338:w=2;break;case 35:v.push(T),p=!0;break;case 36:v.pop(),p=!1;break;default:if(!b.T&&(!p||m.WTF&&v[v.length-1]!=35))throw new Error("Unexpected record 0x"+T.toString(16))}}),f):function(S,b){var T={Types:[],Cell:[],Value:[]};if(!S)return T;var P,M=!1,N=2;return S.replace(po,function(U){var B=Pr(U);switch(Yc(B[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":T.Types.push({name:B.name});break;case"</metadataType>":break;case"<futureMetadata":for(var Z=0;Z<T.Types.length;++Z)T.Types[Z].name==B.name&&(P=T.Types[Z]);break;case"</futureMetadata>":case"<bk>":case"</bk>":break;case"<rc":N==1?T.Cell.push({type:T.Types[B.t-1].name,index:+B.v}):N==0&&T.Value.push({type:T.Types[B.t-1].name,index:+B.v});break;case"</rc>":break;case"<cellMetadata":N=1;break;case"</cellMetadata>":N=2;break;case"<valueMetadata":N=0;break;case"</valueMetadata>":N=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":M=!0;break;case"</ext>":M=!1;break;case"<rvb":if(!P)break;P.offsets||(P.offsets=[]),P.offsets.push(+B.i);break;default:if(!M&&b.WTF)throw new Error("unrecognized "+B[0]+" in metadata")}return U}),T}(a,u);var f,m,v,p,w}var gv,cH=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,uH=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ec(a,c){var u=a.split(/\s+/),f=[];if(f[0]=u[0],u.length===1)return f;var m,v,p,w=a.match(cH);if(w)for(p=0;p!=w.length;++p)(v=(m=w[p].match(uH))[1].indexOf(":"))===-1?f[m[1]]=m[2].slice(1,m[2].length-1):f[m[1].slice(0,6)==="xmlns:"?"xmlns"+m[1].slice(6):m[1].slice(v+1)]=m[2].slice(1,m[2].length-1);return f}function bie(a,c,u){if(a.t!=="z"){if(!u||u.cellText!==!1)try{a.t==="e"?a.w=a.w||ih[a.v]:c==="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=_e(a.v):a.w=Ee(a.v):a.w=(f=c||"General",m=a.v,(f=gv[f]||Sn(f))==="General"?Ee(m):Lr(f,m))}catch(p){if(u.WTF)throw p}var f,m;try{var v=gv[c]||c||"General";u.cellNF&&(a.z=v),u.cellDates&&a.t=="n"&&xi(v)&&(v=ye(a.v))&&(a.t="d",a.v=new Date(v.y,v.m-1,v.d,v.H,v.M,v.S,v.u))}catch(p){if(u.WTF)throw p}}}function _A(a,c){var u=c||{};ot();var f,m=E(kR(a)),v=(m=u.type=="binary"||u.type=="array"||u.type=="base64"?n!==void 0?n.utils.decode(65001,x(m)):Qn(m):m).slice(0,1024).toLowerCase(),p=!1;if((1023&(v=v.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&v.indexOf(","),1023&v.indexOf(";"))){var w=ke(u);return w.type="string",cm.to_workbook(m,w)}if(v.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ce){0<=v.indexOf("<"+Ce)&&(p=!0)}),p)return function(Ce,gt){if(Ce=Ce.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi),!Ce||Ce.length==0)throw new Error("Invalid HTML: could not find <table>");if(Ce.length==1)return wf(dH(Ce[0],gt),gt);var Ge=BA();return Ce.forEach(function(Ze,We){VA(Ge,dH(Ze,gt),"Sheet"+(We+1))}),Ge}(m,u);gv={"General Number":"General","General Date":D[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":D[15],"Short Date":D[14],"Long Time":D[19],"Medium Time":D[18],"Short Time":D[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:D[2],Standard:D[4],Percent:D[10],Scientific:D[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var S,b=[],T,P={},M=[],N=u.dense?[]:{},U="",B={},Z={},G=ec('<Data ss:Type="String">'),W=0,J=0,ne=0,se={s:{r:2e6,c:2e6},e:{r:0,c:0}},be={},De={},Pe="",je=0,it=[],st={},Ke={},yt=0,Wt=[],Ht=[],At={},Pt=[],Tt=!1,ft=[],Qt=[],sr={},wr=0,Gr=0,Yt={Sheets:[],WBProps:{date1904:!1}},wt={};Y1.lastIndex=0,m=m.replace(/<!--([\s\S]*?)-->/gm,"");for(var Mr,fn,rn,In,zi="";f=Y1.exec(m);)switch(f[3]=(zi=f[3]).toLowerCase()){case"data":if(zi=="data"){if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break}if(b[b.length-1][1])break;f[1]==="/"?function(Ce,gt,Ge,Ze,We,nt,xt,cr,qt,$t){var er="General",fr=Ze.StyleID,dr={};$t=$t||{};var Mt=[],Et=0;for((fr=fr===void 0&&cr?cr.StyleID:fr)===void 0&&xt&&(fr=xt.StyleID);nt[fr]!==void 0&&(nt[fr].nf&&(er=nt[fr].nf),nt[fr].Interior&&Mt.push(nt[fr].Interior),nt[fr].Parent);)fr=nt[fr].Parent;switch(Ge.Type){case"Boolean":Ze.t="b",Ze.v=di(Ce);break;case"String":Ze.t="s",Ze.r=d5(Sn(Ce)),Ze.v=-1<Ce.indexOf("<")?Sn(gt||Ce).replace(/<.*?>/g,""):Ze.r;break;case"DateTime":Ce.slice(-1)!="Z"&&(Ce+="Z"),Ze.v=(ue(Ce)-new Date(Date.UTC(1899,11,30)))/864e5,Ze.v!=Ze.v?Ze.v=Sn(Ce):Ze.v<60&&(Ze.v=Ze.v-1),er&&er!="General"||(er="yyyy-mm-dd");case"Number":Ze.v===void 0&&(Ze.v=+Ce),Ze.t||(Ze.t="n");break;case"Error":Ze.t="e",Ze.v=V5[Ce],$t.cellText!==!1&&(Ze.w=Ce);break;default:Ce==""&&gt==""?Ze.t="z":(Ze.t="s",Ze.v=d5(gt||Ce))}if(bie(Ze,er,$t),$t.cellFormula!==!1)if(Ze.Formula)Ge=Sn(Ze.Formula),Ge.charCodeAt(0)==61&&(Ge=Ge.slice(1)),Ze.f=gm(Ge,We),delete Ze.Formula,Ze.ArrayRange=="RC"?Ze.F=gm("RC:RC",We):Ze.ArrayRange&&(Ze.F=gm(Ze.ArrayRange,We),qt.push([un(Ze.F),Ze.F]));else for(Et=0;Et<qt.length;++Et)We.r>=qt[Et][0].s.r&&We.r<=qt[Et][0].e.r&&We.c>=qt[Et][0].s.c&&We.c<=qt[Et][0].e.c&&(Ze.F=qt[Et][1]);$t.cellStyles&&(Mt.forEach(function(mr){!dr.patternType&&mr.patternType&&(dr.patternType=mr.patternType)}),Ze.s=dr),Ze.StyleID!==void 0&&(Ze.ixfe=Ze.StyleID)}(m.slice(W,f.index),Pe,G,b[b.length-1][0]=="comment"?At:B,{c:J,r:ne},be,Pt[J],Z,ft,u):(Pe="",G=ec(f[0]),W=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(0<Ht.length&&(B.c=Ht),(!u.sheetRows||u.sheetRows>ne)&&B.v!==void 0&&(u.dense?(N[ne]||(N[ne]=[]),N[ne][J]=B):N[gi(J)+Ui(ne)]=B),B.HRef&&(B.l={Target:Sn(B.HRef)},B.HRefScreenTip&&(B.l.Tooltip=B.HRefScreenTip),delete B.HRef,delete B.HRefScreenTip),(B.MergeAcross||B.MergeDown)&&(wr=J+(0|parseInt(B.MergeAcross,10)),Gr=ne+(0|parseInt(B.MergeDown,10)),it.push({s:{c:J,r:ne},e:{c:wr,r:Gr}})),u.sheetStubs)if(B.MergeAcross||B.MergeDown){for(var Te=J;Te<=wr;++Te)for(var Pn=ne;Pn<=Gr;++Pn)(J<Te||ne<Pn)&&(u.dense?(N[Pn]||(N[Pn]=[]),N[Pn][Te]={t:"z"}):N[gi(Te)+Ui(Pn)]={t:"z"});J=wr+1}else++J;else B.MergeAcross?J=wr+1:++J;else(J=(B=function(Ce){var gt={};if(Ce.split(/\s+/).length===1)return gt;var Ge,Ze,We,nt=Ce.match(cH);if(nt)for(We=0;We!=nt.length;++We)(Ze=(Ge=nt[We].match(uH))[1].indexOf(":"))===-1?gt[Ge[1]]=Ge[2].slice(1,Ge[2].length-1):gt[Ge[1].slice(0,6)==="xmlns:"?"xmlns"+Ge[1].slice(6):Ge[1].slice(Ze+1)]=Ge[2].slice(1,Ge[2].length-1);return gt}(f[0])).Index?+B.Index-1:J)<se.s.c&&(se.s.c=J),J>se.e.c&&(se.e.c=J),f[0].slice(-2)==="/>"&&++J,Ht=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(ne<se.s.r&&(se.s.r=ne),ne>se.e.r&&(se.e.r=ne),f[0].slice(-2)==="/>"&&(Z=ec(f[0])).Index&&(ne=+Z.Index-1),J=0,++ne):((Z=ec(f[0])).Index&&(ne=+Z.Index-1),sr={},Z.AutoFitHeight!="0"&&!Z.Height||(sr.hpx=parseInt(Z.Height,10),sr.hpt=ov(sr.hpx),Qt[ne]=sr),Z.Hidden=="1"&&(sr.hidden=!0,Qt[ne]=sr));break;case"worksheet":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"));M.push(U),se.s.r<=se.e.r&&se.s.c<=se.e.c&&(N["!ref"]=Wr(se),u.sheetRows&&u.sheetRows<=se.e.r&&(N["!fullref"]=N["!ref"],se.e.r=u.sheetRows-1,N["!ref"]=Wr(se))),it.length&&(N["!merges"]=it),0<Pt.length&&(N["!cols"]=Pt),0<Qt.length&&(N["!rows"]=Qt),P[U]=N}else se={s:{r:2e6,c:2e6},e:{r:0,c:0}},ne=J=0,b.push([f[3],!1]),S=ec(f[0]),U=Sn(S.Name),N=u.dense?[]:{},it=[],ft=[],Qt=[],wt={name:U,Hidden:0},Yt.Sheets.push(wt);break;case"table":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else{if(f[0].slice(-2)=="/>")break;b.push([f[3],!1]),Tt=!(Pt=[])}break;case"style":f[1]==="/"?(fn=be,rn=De,(In=u).cellStyles&&(!rn.Interior||(In=rn.Interior).Pattern&&(In.patternType=Kre[In.Pattern]||In.Pattern)),fn[rn.ID]=rn):De=ec(f[0]);break;case"numberformat":De.nf=Sn(ec(f[0]).Format||"General"),gv[De.nf]&&(De.nf=gv[De.nf]);for(var Tn=0;Tn!=392&&D[Tn]!=De.nf;++Tn);if(Tn==392){for(Tn=57;Tn!=392;++Tn)if(D[Tn]==null){Nr(De.nf,Tn);break}}break;case"column":if(b[b.length-1][0]!=="table")break;if((T=ec(f[0])).Hidden&&(T.hidden=!0,delete T.Hidden),T.Width&&(T.wpx=parseInt(T.Width,10)),!Tt&&10<T.wpx){Tt=!0,So=g8;for(var _s=0;_s<Pt.length;++_s)Pt[_s]&&Cf(Pt[_s])}Tt&&Cf(T),Pt[T.Index-1||Pt.length]=T;for(var Cl=0;Cl<+T.Span;++Cl)Pt[Pt.length]=ke(T);break;case"namedrange":if(f[1]==="/")break;Yt.Names||(Yt.Names=[]);var fe=Pr(f[0]),qe={Name:fe.Name,Ref:gm(fe.RefersTo.slice(1),{r:0,c:0})};0<Yt.Sheets.length&&(qe.Sheet=Yt.Sheets.length-1),Yt.Names.push(qe);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?Pe+=m.slice(je,f.index):je=f.index+f[0].length;break;case"interior":if(!u.cellStyles)break;De.Interior=ec(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?(rn=st,fe=zi,qe=m.slice(yt,f.index),rn[fe=(J5=J5||Gc(tA))[fe]||fe]=qe):yt=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else b.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"));(Mr=At).t=Mr.v||"",Mr.t=Mr.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),Mr.v=Mr.w=Mr.ixfe=void 0,Ht.push(At)}else b.push([f[3],!1]),At={a:(S=ec(f[0])).Author};break;case"autofilter":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&(Mr=ec(f[0]),N["!autofilter"]={ref:gm(Mr.Range).replace(/\$/g,"")},b.push([f[3],!0]));break;case"name":break;case"datavalidation":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((S=b.pop())[0]!==f[3])throw new Error("Bad state: "+S.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&b.push([f[3],!0]);break;case"null":break;default:if(b.length==0&&f[3]=="document"||b.length==0&&f[3]=="uof")return TH(m,u);var Se=!0;switch(b[b.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:Se=!1}break;case"componentoptions":switch(f[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:Se=!1}break;case"excelworkbook":switch(f[3]){case"date1904":Yt.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:Se=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":case"height":case"width":break;default:Se=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(m.slice(yt,f.index)){case"SheetHidden":wt.Hidden=1;break;case"SheetVeryHidden":wt.Hidden=2}else yt=f.index+f[0].length;break;case"header":N["!margins"]||t0(N["!margins"]={},"xlml"),isNaN(+Pr(f[0]).Margin)||(N["!margins"].header=+Pr(f[0]).Margin);break;case"footer":N["!margins"]||t0(N["!margins"]={},"xlml"),isNaN(+Pr(f[0]).Margin)||(N["!margins"].footer=+Pr(f[0]).Margin);break;case"pagemargins":var ze=Pr(f[0]);N["!margins"]||t0(N["!margins"]={},"xlml"),isNaN(+ze.Top)||(N["!margins"].top=+ze.Top),isNaN(+ze.Left)||(N["!margins"].left=+ze.Left),isNaN(+ze.Right)||(N["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(N["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":Yt.Views||(Yt.Views=[]),Yt.Views[0]||(Yt.Views[0]={}),Yt.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":break;case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":break;case"nosummaryrowsbelowdetail":N["!outline"]||(N["!outline"]={}),N["!outline"].above=!0;break;case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":N["!outline"]||(N["!outline"]={}),N["!outline"].left=!0;break;case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;default:Se=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:Se=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:Se=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:Se=!1}break;case"querytable":switch(f[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:Se=!1}break;case"datavalidation":switch(f[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:Se=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:Se=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:Se=!1}break;case"smarttags":break;default:Se=!1}if(Se||f[3].match(/!\[CDATA/))break;if(!b[b.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+b.join("|");if(b[b.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?function(Ce,gt,Ge,Ze){var We=Ze;switch((Ge[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":We=di(Ze);break;case"i2":case"int":We=parseInt(Ze,10);break;case"r4":case"float":We=parseFloat(Ze);break;case"date":case"dateTime.tz":We=ue(Ze);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+Ge[0])}Ce[Sn(gt)]=We}(Ke,zi,Wt,m.slice(yt,f.index)):yt=(Wt=f).index+f[0].length;break}if(u.WTF)throw"Unrecognized tag: "+f[3]+"|"+b.join("|")}return w={},u.bookSheets||u.bookProps||(w.Sheets=P),w.SheetNames=M,w.Workbook=Yt,w.SSF=ke(D),w.Props=st,w.Custprops=Ke,w}function RA(a,c){switch(MA(c=c||{}),c.type||"base64"){case"base64":return _A(z(a),c);case"binary":case"buffer":case"file":return _A(a,c);case"array":return _A(Re(a),c)}}function xie(a,c){var u,f,m,v,p,w,S,b=[];return a.Props&&b.push((u=a.Props,f=c,m=[],ai(tA).map(function(T){for(var P=0;P<ml.length;++P)if(ml[P][1]==T)return ml[P];for(P=0;P<qd.length;++P)if(qd[P][1]==T)return qd[P];throw T}).forEach(function(T){var P;u[T[1]]!=null&&(P=(f&&f.Props&&f.Props[T[1]]!=null?f.Props:u)[T[1]],typeof(P=T[2]==="date"?new Date(P).toISOString().replace(/\.\d*Z/,"Z"):P)=="number"?P=String(P):P===!0||P===!1?P=P?"1":"0":P instanceof Date&&(P=new Date(P).toISOString().replace(/\.\d*Z/,"")),m.push(Qs(tA[T[1]]||T[1],P)))}),Nt("DocumentProperties",m.join(""),{xmlns:$a.o}))),a.Custprops&&b.push((v=a.Props,p=a.Custprops,w=["Worksheets","SheetNames"],a="CustomDocumentProperties",S=[],v&&ai(v).forEach(function(T){if(Object.prototype.hasOwnProperty.call(v,T)){for(var P=0;P<ml.length;++P)if(T==ml[P][1])return;for(P=0;P<qd.length;++P)if(T==qd[P][1])return;for(P=0;P<w.length;++P)if(T==w[P])return;var M="string",N=typeof(N=v[T])=="number"?(M="float",String(N)):N===!0||N===!1?(M="boolean",N?"1":"0"):String(N);S.push(Nt(u5(T),N,{"dt:dt":M}))}}),p&&ai(p).forEach(function(T){var P,M;Object.prototype.hasOwnProperty.call(p,T)&&(v&&Object.prototype.hasOwnProperty.call(v,T)||(P="string",M=typeof(M=p[T])=="number"?(P="float",String(M)):M===!0||M===!1?(P="boolean",M?"1":"0"):M instanceof Date?(P="dateTime.tz",M.toISOString()):String(M),S.push(Nt(u5(T),M,{"dt:dt":P}))))}),"<"+a+' xmlns="'+$a.o+'">'+S.join("")+"</"+a+">")),b.join("")}function hH(a){return Nt("NamedRange",null,{"ss:Name":a.Name,"ss:RefersTo":"="+yA(a.Ref,{r:0,c:0})})}function Eie(a,c,u,f,m,v,p){if(!a||a.v==null&&a.f==null)return"";var w={};if(a.f&&(w["ss:Formula"]="="+Bn(yA(a.f,p))),a.F&&a.F.slice(0,c.length)==c&&(c=Ii(a.F.slice(c.length+1)),w["ss:ArrayRange"]="RC:R"+(c.r==p.r?"":"["+(c.r-p.r)+"]")+"C"+(c.c==p.c?"":"["+(c.c-p.c)+"]")),a.l&&a.l.Target&&(w["ss:HRef"]=Bn(a.l.Target),a.l.Tooltip&&(w["x:HRefScreenTip"]=Bn(a.l.Tooltip))),u["!merges"])for(var S=u["!merges"],b=0;b!=S.length;++b)S[b].s.c==p.c&&S[b].s.r==p.r&&(S[b].e.c>S[b].s.c&&(w["ss:MergeAcross"]=S[b].e.c-S[b].s.c),S[b].e.r>S[b].s.r&&(w["ss:MergeDown"]=S[b].e.r-S[b].s.r));var T="",P="";switch(a.t){case"z":if(!f.sheetStubs)return"";break;case"n":T="Number",P=String(a.v);break;case"b":T="Boolean",P=a.v?"1":"0";break;case"e":T="Error",P=ih[a.v];break;case"d":T="DateTime",P=new Date(a.v).toISOString(),a.z==null&&(a.z=a.z||D[14]);break;case"s":T="String",P=((a.v||"")+"").replace(OR,function(M){return AR[M]}).replace(h5,function(M){return"&#x"+M.charCodeAt(0).toString(16).toUpperCase()+";"})}return u=bf(f.cellXfs,a,f),w["ss:StyleID"]="s"+(21+u),w["ss:Index"]=p.c+1,u=a.v!=null?P:"",u=a.t=="z"?"":'<Data ss:Type="'+T+'">'+u+"</Data>",0<(a.c||[]).length&&(u+=a.c.map(function(M){var N=Nt("ss:Data",(M.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Nt("Comment",N,{"ss:Author":M.a})}).join("")),Nt("Cell",u,w)}function Tie(a,c){if(!a["!ref"])return"";var u=un(a["!ref"]),f=a["!merges"]||[],m=0,v=[];a["!cols"]&&a["!cols"].forEach(function(Z,ne){Cf(Z);var W=!!Z.width,J=GS(ne,Z),ne={"ss:Index":ne+1};W&&(ne["ss:Width"]=iv(J.width)),Z.hidden&&(ne["ss:Hidden"]="1"),v.push(Nt("Column",null,ne))});for(var p,w,S=Array.isArray(a),b=u.s.r;b<=u.e.r;++b){for(var T=[(p=b,w=(a["!rows"]||[])[b],p='<Row ss:Index="'+(p+1)+'"',w&&(w.hpt&&!w.hpx&&(w.hpx=fm(w.hpt)),w.hpx&&(p+=' ss:AutoFitHeight="0" ss:Height="'+w.hpx+'"'),w.hidden&&(p+=' ss:Hidden="1"')),p+">")],P=u.s.c;P<=u.e.c;++P){for(var M,N,U,B=!1,m=0;m!=f.length;++m)if(!(f[m].s.c>P||f[m].s.r>b||f[m].e.c<P||f[m].e.r<b)){f[m].s.c==P&&f[m].s.r==b||(B=!0);break}B||(N=Fr(M={r:b,c:P}),U=S?(a[b]||[])[P]:a[N],T.push(Eie(U,N,a,c,0,0,M)))}T.push("</Row>"),2<T.length&&v.push(T.join(""))}return v.join("")}function _ie(a,c,u){var f=[],v=u.SheetNames[a],m=u.Sheets[v],v=m?function(p,w,S){if(!p||!((S||{}).Workbook||{}).Names)return"";for(var b=S.Workbook.Names,T=[],P=0;P<b.length;++P){var M=b[P];M.Sheet==w&&(M.Name.match(/^_xlfn\./)||T.push(hH(M)))}return T.join("")}(m,a,u):"";return 0<v.length&&f.push("<Names>"+v+"</Names>"),0<(v=m?Tie(m,c):"").length&&f.push("<Table>"+v+"</Table>"),f.push(function(p,w,S){if(!p)return"";var b=[];if(p["!margins"]&&(b.push("<PageSetup>"),p["!margins"].header&&b.push(Nt("Header",null,{"x:Margin":p["!margins"].header})),p["!margins"].footer&&b.push(Nt("Footer",null,{"x:Margin":p["!margins"].footer})),b.push(Nt("PageMargins",null,{"x:Bottom":p["!margins"].bottom||"0.75","x:Left":p["!margins"].left||"0.7","x:Right":p["!margins"].right||"0.7","x:Top":p["!margins"].top||"0.75"})),b.push("</PageSetup>")),S&&S.Workbook&&S.Workbook.Sheets&&S.Workbook.Sheets[w])if(S.Workbook.Sheets[w].Hidden)b.push(Nt("Visible",S.Workbook.Sheets[w].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var T=0;T<w&&(!S.Workbook.Sheets[T]||S.Workbook.Sheets[T].Hidden);++T);T==w&&b.push("<Selected/>")}return((((S||{}).Workbook||{}).Views||[])[0]||{}).RTL&&b.push("<DisplayRightToLeft/>"),p["!protect"]&&(b.push(Qs("ProtectContents","True")),p["!protect"].objects&&b.push(Qs("ProtectObjects","True")),p["!protect"].scenarios&&b.push(Qs("ProtectScenarios","True")),p["!protect"].selectLockedCells==null||p["!protect"].selectLockedCells?p["!protect"].selectUnlockedCells==null||p["!protect"].selectUnlockedCells||b.push(Qs("EnableSelection","UnlockedCells")):b.push(Qs("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(P){p["!protect"][P[0]]&&b.push("<"+P[1]+"/>")})),b.length==0?"":Nt("WorksheetOptions",b.join(""),{xmlns:$a.x})}(m,a,u)),f.join("")}function Rie(a,c){c=c||{},a.SSF||(a.SSF=ke(D)),a.SSF&&(ot(),Ve(a.SSF),c.revssf=eh(a.SSF),c.revssf[a.SSF[65535]]=0,c.ssf=a.SSF,c.cellXfs=[],bf(c.cellXfs,{},{revssf:{General:0}}));var u=[];u.push(xie(a,c)),u.push(""),u.push(""),u.push("");for(var f,m=0;m<a.SheetNames.length;++m)u.push(Nt("Worksheet",_ie(m,c,a),{"ss:Name":Bn(a.SheetNames[m])}));return u[2]=(f=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'],c.cellXfs.forEach(function(v,p){var w=[];w.push(Nt("NumberFormat",null,{"ss:Format":Bn(D[v.numFmtId])})),p={"ss:ID":"s"+(21+p)},f.push(Nt("Style",w.join(""),p))}),Nt("Styles",f.join(""))),u[3]=function(v){if(!((v||{}).Workbook||{}).Names)return"";for(var p=v.Workbook.Names,w=[],S=0;S<p.length;++S){var b=p[S];b.Sheet==null&&(b.Name.match(/^_xlfn\./)||w.push(hH(b)))}return Nt("Names",w.join(""))}(a),fi+Nt("Workbook",u.join(""),{xmlns:$a.ss,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:ss":$a.ss,"xmlns:dt":$a.dt,"xmlns:html":$a.html})}function Aie(a){var c={},u=a.content;return u.l=28,c.AnsiUserType=u.read_shift(0,"lpstr-ansi"),c.AnsiClipboardFormat=L5(u,1),u.length-u.l<=4?c:(a=u.read_shift(4),a==0||40<a?c:(u.l-=4,c.Reserved1=u.read_shift(0,"lpstr-ansi"),u.length-u.l<=4||(a=u.read_shift(4))!==1907505652?c:(c.UnicodeClipboardFormat=L5(u,2),(a=u.read_shift(4))==0||40<a?c:(u.l-=4,void(c.Reserved2=u.read_shift(0,"lpwstr"))))))}var Oie=[60,1084,2066,2165,2175];function Qc(a,c,u){if(a.t!=="z"&&a.XF){var f,m=0;try{m=a.z||a.XF.numFmtId||0,c.cellNF&&(a.z=D[m])}catch(v){if(c.WTF)throw v}if(!c||c.cellText!==!1)try{a.t==="e"?a.w=a.w||ih[a.v]:m===0||m=="General"?a.t==="n"?(0|a.v)===a.v?a.w=a.v.toString(10):a.w=_e(a.v):a.w=Ee(a.v):a.w=Lr(m,a.v,{date1904:!!u,dateNF:c&&c.dateNF})}catch(v){if(c.WTF)throw v}c.cellDates&&m&&a.t=="n"&&xi(D[m]||String(m))&&(f=ye(a.v))&&(a.t="d",a.v=new Date(f.y,f.m-1,f.d,f.H,f.M,f.S,f.u))}}function KS(a,c,u){return{v:a,ixfe:c,t:u}}function Iie(a,c){var u={opts:{}},f={};function m(We){return!(We<8)&&We<64&&be[We-8]||J1[We]}function v(We,nt,xt){if(!(1<Tt||xt.sheetRows&&We.r>=xt.sheetRows)){var cr,qt,$t;if(xt.cellStyles&&nt.XF&&nt.XF.data&&(qt=xt,($t=(cr=nt).XF.data)&&$t.patternType&&qt&&qt.cellStyles&&(cr.s={},cr.s.patternType=$t.patternType,(qt=nv(m($t.icvFore)))&&(cr.s.fgColor={rgb:qt}),(qt=nv(m($t.icvBack)))&&(cr.s.bgColor={rgb:qt}))),delete nt.ixfe,delete nt.XF,W=Fr(p=We),N&&N.s&&N.e||(N={s:{r:0,c:0},e:{r:0,c:0}}),We.r<N.s.r&&(N.s.r=We.r),We.c<N.s.c&&(N.s.c=We.c),We.r+1>N.e.r&&(N.e.r=We.r+1),We.c+1>N.e.c&&(N.e.c=We.c+1),xt.cellFormula&&nt.f){for(var er=0;er<ne.length;++er)if(!(ne[er][0].s.c>We.c||ne[er][0].s.r>We.r||ne[er][0].e.c<We.c||ne[er][0].e.r<We.r)){nt.F=Wr(ne[er][0]),ne[er][0].s.c==We.c&&ne[er][0].s.r==We.r||delete nt.f,nt.f&&(nt.f=""+jo(ne[er][1],0,We,Ht,je));break}}xt.dense?(P[We.r]||(P[We.r]=[]),P[We.r][We.c]=nt):P[W]=nt}}var p,w,S,b,T,P=c.dense?[]:{},M={},N={},U=null,B=[],Z="",G={},W="",J={},ne=[],se=[],be=[],De={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Pe={},je={enc:!1,sbcch:0,snames:[],sharedf:J,arrayf:ne,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!c&&!!c.cellStyles,WTF:!!c&&!!c.wtf};c.password&&(je.password=c.password);var it=[],st=[],Ke=[],yt=[],Wt=!1,Ht=[];Ht.SheetNames=je.snames,Ht.sharedf=je.sharedf,Ht.arrayf=je.arrayf,Ht.names=[],Ht.XTI=[];var At,Pt=0,Tt=0,ft=0,Qt=[],sr=[];je.codepage=1200,y(1200);for(var wr=!1;a.l<a.length-1;){var Gr=a.l,Yt=a.read_shift(2);if(Yt===0&&Pt===10)break;var wt=a.l===a.length?0:a.read_shift(2),Mr=AA[Yt];if(Mr&&Mr.f){if(c.bookSheets&&Pt===133&&Yt!==133)break;if(Pt=Yt,Mr.r===2||Mr.r==12){var fn=a.read_shift(2);if(wt-=2,!je.enc&&fn!==Yt&&((255&fn)<<8|fn>>8)!==Yt)throw new Error("rt mismatch: "+fn+"!="+Yt);Mr.r==12&&(a.l+=10,wt-=10)}var rn,In,zi,Te={},Te=Yt===10?Mr.f(a,wt,je):function(We,nt,xt,cr,qt){var $t=cr,er=[],fr=xt.slice(xt.l,xt.l+$t);if(qt.enc&&qt.enc.insitu&&0<fr.length)switch(We){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:qt.enc.insitu(fr)}er.push(fr),xt.l+=$t;for(var dr=rh(xt,xt.l),Mt=AA[dr],Et=0;Mt!=null&&-1<Oie.indexOf(dr);)$t=rh(xt,xt.l+2),Et=xt.l+4,dr==2066?Et+=4:dr!=2165&&dr!=2175||(Et+=12),fr=xt.slice(Et,xt.l+4+$t),er.push(fr),xt.l+=4+$t,Mt=AA[dr=rh(xt,xt.l)];var mr=Be(er);Zs(mr,0);var Kt=0;mr.lens=[];for(var Ot=0;Ot<er.length;++Ot)mr.lens.push(Kt),Kt+=er[Ot].length;if(mr.length<cr)throw"XLS Record 0x"+We.toString(16)+" Truncated: "+mr.length+" < "+cr;return nt.f(mr,mr.length,qt)}(Yt,Mr,a,wt,je);if(Tt!=0||[9,521,1033,2057].indexOf(Pt)!==-1)switch(Yt){case 34:u.opts.Date1904=De.WBProps.date1904=Te;break;case 134:u.opts.WriteProtect=!0;break;case 47:if(je.enc||(a.l=0),je.enc=Te,!c.password)throw new Error("File is password-protected");if(Te.valid==null)throw new Error("Encryption scheme unsupported");if(!Te.valid)throw new Error("Password is incorrect");break;case 92:je.lastuser=Te;break;case 66:var Pn=Number(Te);switch(Pn){case 21010:Pn=1200;break;case 32768:Pn=1e4;break;case 32769:Pn=1252}y(je.codepage=Pn),wr=!0;break;case 317:je.rrtabid=Te;break;case 25:je.winlocked=Te;break;case 439:u.opts.RefreshAll=Te;break;case 12:u.opts.CalcCount=Te;break;case 16:u.opts.CalcDelta=Te;break;case 17:u.opts.CalcIter=Te;break;case 13:u.opts.CalcMode=Te;break;case 14:u.opts.CalcPrecision=Te;break;case 95:u.opts.CalcSaveRecalc=Te;break;case 15:je.CalcRefMode=Te;break;case 2211:u.opts.FullCalc=Te;break;case 129:Te.fDialog&&(P["!type"]="dialog"),Te.fBelow||((P["!outline"]||(P["!outline"]={})).above=!0),Te.fRight||((P["!outline"]||(P["!outline"]={})).left=!0);break;case 224:se.push(Te);break;case 430:Ht.push([Te]),Ht[Ht.length-1].XTI=[];break;case 35:case 547:Ht[Ht.length-1].push(Te);break;case 24:case 536:At={Name:Te.Name,Ref:jo(Te.rgce,0,null,Ht,je)},0<Te.itab&&(At.Sheet=Te.itab-1),Ht.names.push(At),Ht[0]||(Ht[0]=[],Ht[0].XTI=[]),Ht[Ht.length-1].push(Te),Te.Name=="_xlnm._FilterDatabase"&&0<Te.itab&&Te.rgce&&Te.rgce[0]&&Te.rgce[0][0]&&Te.rgce[0][0][0]=="PtgArea3d"&&(sr[Te.itab-1]={ref:Wr(Te.rgce[0][0][1][2])});break;case 22:je.ExternCount=Te;break;case 23:Ht.length==0&&(Ht[0]=[],Ht[0].XTI=[]),Ht[Ht.length-1].XTI=Ht[Ht.length-1].XTI.concat(Te),Ht.XTI=Ht.XTI.concat(Te);break;case 2196:if(je.biff<8)break;At!=null&&(At.Comment=Te[1]);break;case 18:P["!protect"]=Te;break;case 19:Te!==0&&je.WTF&&console.error("Password verifier: "+Te);break;case 133:M[Te.pos]=Te,je.snames.push(Te.name);break;case 10:if(--Tt)break;N.e&&(0<N.e.r&&0<N.e.c&&(N.e.r--,N.e.c--,P["!ref"]=Wr(N),c.sheetRows&&c.sheetRows<=N.e.r&&(Tn=N.e.r,N.e.r=c.sheetRows-1,P["!fullref"]=P["!ref"],P["!ref"]=Wr(N),N.e.r=Tn),N.e.r++,N.e.c++),0<it.length&&(P["!merges"]=it),0<st.length&&(P["!objects"]=st),0<Ke.length&&(P["!cols"]=Ke),0<yt.length&&(P["!rows"]=yt),De.Sheets.push(Pe)),Z===""?G=P:f[Z]=P,P=c.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(je.biff===8&&(je.biff={9:2,521:3,1033:4}[Yt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Te.BIFFVer]||8),je.biffguess=Te.BIFFVer==0,Te.BIFFVer==0&&Te.dt==4096&&(je.biff=5,wr=!0,y(je.codepage=28591)),je.biff==8&&Te.BIFFVer==0&&Te.dt==16&&(je.biff=2),Tt++)break;var Tn,P=c.dense?[]:{};je.biff<8&&!wr&&(wr=!0,y(je.codepage=c.codepage||1252)),je.biff<5||Te.BIFFVer==0&&Te.dt==4096?(Z===""&&(Z="Sheet1"),N={s:{r:0,c:0},e:{r:0,c:0}},Tn={pos:a.l-wt,name:Z},M[Tn.pos]=Tn,je.snames.push(Z)):Z=(M[Gr]||{name:""}).name,Te.dt==32&&(P["!type"]="chart"),Te.dt==64&&(P["!type"]="macro"),it=[],st=[],je.arrayf=ne=[],Ke=[],Wt=!(yt=[]),Pe={Hidden:(M[Gr]||{hs:0}).hs,name:Z};break;case 515:case 3:case 2:P["!type"]=="chart"&&(c.dense?(P[Te.r]||[])[Te.c]:P[Fr({c:Te.c,r:Te.r})])&&++Te.c,fe={ixfe:Te.ixfe,XF:se[Te.ixfe]||{},v:Te.val,t:"n"},0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c);break;case 5:case 517:fe={ixfe:Te.ixfe,XF:se[Te.ixfe],v:Te.val,t:Te.t},0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c);break;case 638:fe={ixfe:Te.ixfe,XF:se[Te.ixfe],v:Te.rknum,t:"n"},0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c);break;case 189:for(var _s=Te.c;_s<=Te.C;++_s){var Cl=Te.rkrec[_s-Te.c][0],fe={ixfe:Cl,XF:se[Cl],v:Te.rkrec[_s-Te.c][1],t:"n"};0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:_s,r:Te.r},fe,c)}break;case 6:case 518:case 1030:if(Te.val=="String"){U=Te;break}(fe=KS(Te.val,Te.cell.ixfe,Te.tt)).XF=se[fe.ixfe],c.cellFormula&&(!((qe=Te.formula)&&qe[0]&&qe[0][0]&&qe[0][0][0]=="PtgExp")||J[zi=Fr({r:rn=qe[0][0][1][0],c:In=qe[0][0][1][1]})]?fe.f=""+jo(Te.formula,0,Te.cell,Ht,je):fe.F=((c.dense?(P[rn]||[])[In]:P[zi])||{}).F),0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v(Te.cell,fe,c),U=Te;break;case 7:case 519:if(!U)throw new Error("String record expects Formula");(fe=KS(U.val=Te,U.cell.ixfe,"s")).XF=se[fe.ixfe],c.cellFormula&&(fe.f=""+jo(U.formula,0,U.cell,Ht,je)),0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v(U.cell,fe,c),U=null;break;case 33:case 545:ne.push(Te);var qe=Fr(Te[0].s),Se=c.dense?(P[Te[0].s.r]||[])[Te[0].s.c]:P[qe];if(c.cellFormula&&Se){if(!U||!qe||!Se)break;Se.f=""+jo(Te[1],0,Te[0],Ht,je),Se.F=Wr(Te[0])}break;case 1212:if(!c.cellFormula)break;if(W){if(!U)break;J[Fr(U.cell)]=Te[0],((Se=c.dense?(P[U.cell.r]||[])[U.cell.c]:P[Fr(U.cell)])||{}).f=""+jo(Te[0],0,p,Ht,je)}break;case 253:fe=KS(B[Te.isst].t,Te.ixfe,"s"),B[Te.isst].h&&(fe.h=B[Te.isst].h),fe.XF=se[fe.ixfe],0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c);break;case 513:c.sheetStubs&&(fe={ixfe:Te.ixfe,XF:se[Te.ixfe],t:"z"},0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c));break;case 190:if(c.sheetStubs)for(var ze=Te.c;ze<=Te.C;++ze){var Ce=Te.ixfe[ze-Te.c];fe={ixfe:Ce,XF:se[Ce],t:"z"},0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:ze,r:Te.r},fe,c)}break;case 214:case 516:case 4:(fe=KS(Te.val,Te.ixfe,"s")).XF=se[fe.ixfe],0<ft&&(fe.z=Qt[fe.ixfe>>8&63]),Qc(fe,c,u.opts.Date1904),v({c:Te.c,r:Te.r},fe,c);break;case 0:case 512:Tt===1&&(N=Te);break;case 252:B=Te;break;case 1054:if(je.biff==4){Qt[ft++]=Te[1];for(var gt=0;gt<ft+163&&D[gt]!=Te[1];++gt);163<=gt&&Nr(Te[1],ft+163)}else Nr(Te[1],Te[0]);break;case 30:Qt[ft++]=Te;for(var Ge=0;Ge<ft+163&&D[Ge]!=Te;++Ge);163<=Ge&&Nr(Te,ft+163);break;case 229:it=it.concat(Te);break;case 93:st[Te.cmo[0]]=je.lastobj=Te;break;case 438:je.lastobj.TxO=Te;break;case 127:je.lastobj.ImData=Te;break;case 440:for(S=Te[0].s.r;S<=Te[0].e.r;++S)for(w=Te[0].s.c;w<=Te[0].e.c;++w)(Se=c.dense?(P[S]||[])[w]:P[Fr({c:w,r:S})])&&(Se.l=Te[1]);break;case 2048:for(S=Te[0].s.r;S<=Te[0].e.r;++S)for(w=Te[0].s.c;w<=Te[0].e.c;++w)(Se=c.dense?(P[S]||[])[w]:P[Fr({c:w,r:S})])&&Se.l&&(Se.l.Tooltip=Te[1]);break;case 28:if(je.biff<=5&&2<=je.biff)break;Se=c.dense?(P[Te[0].r]||[])[Te[0].c]:P[Fr(Te[0])];var Ze=st[Te[2]];Se||(Se=c.dense?(P[Te[0].r]||(P[Te[0].r]=[]),P[Te[0].r][Te[0].c]={t:"z"}):P[Fr(Te[0])]={t:"z"},N.e.r=Math.max(N.e.r,Te[0].r),N.s.r=Math.min(N.s.r,Te[0].r),N.e.c=Math.max(N.e.c,Te[0].c),N.s.c=Math.min(N.s.c,Te[0].c)),Se.c||(Se.c=[]),Ze={a:Te[1],t:Ze.TxO.t},Se.c.push(Ze);break;case 2173:se[Te.ixfe],Te.ext.forEach(function(nt){nt[0]});break;case 125:if(!je.cellStyles)break;for(;Te.e>=Te.s;)Ke[Te.e--]={width:Te.w/256,level:Te.level||0,hidden:!!(1&Te.flags)},Wt||(Wt=!0,mA(Te.w/256)),Cf(Ke[Te.e+1]);break;case 520:Ze={},Te.level!=null&&((yt[Te.r]=Ze).level=Te.level),Te.hidden&&((yt[Te.r]=Ze).hidden=!0),Te.hpt&&((yt[Te.r]=Ze).hpt=Te.hpt,Ze.hpx=fm(Te.hpt));break;case 38:case 39:case 40:case 41:P["!margins"]||t0(P["!margins"]={}),P["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Yt]]=Te;break;case 161:P["!margins"]||t0(P["!margins"]={}),P["!margins"].header=Te.header,P["!margins"].footer=Te.footer;break;case 574:Te.RTL&&(De.Views[0].RTL=!0);break;case 146:be=Te;break;case 2198:T=Te;break;case 140:b=Te;break;case 442:Z?Pe.CodeName=Te||Pe.name:De.WBProps.CodeName=Te||"ThisWorkbook"}}else Mr||console.error("Missing Info for XLS Record 0x"+Yt.toString(16)),a.l+=wt}return u.SheetNames=ai(M).sort(function(We,nt){return Number(We)-Number(nt)}).map(function(We){return M[We].name}),c.bookSheets||(u.Sheets=f),!u.SheetNames.length&&G["!ref"]?(u.SheetNames.push("Sheet1"),u.Sheets&&(u.Sheets.Sheet1=G)):u.Preamble=G,u.Sheets&&sr.forEach(function(We,nt){u.Sheets[u.SheetNames[nt]]["!autofilter"]=We}),u.Strings=B,u.SSF=ke(D),je.enc&&(u.Encryption=je.enc),T&&(u.Themes=T),u.Metadata={},b!==void 0&&(u.Metadata.Country=b),0<Ht.names.length&&(De.Names=Ht.names),u.Workbook=De,u}var mv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function XS(a,c){var u,f,m,v,p;if(MA(c=c||{}),C(),c.codepage&&g(c.codepage),a.FullPaths){if(Zt.find(a,"/encryption"))throw new Error("File is password-protected");u=Zt.find(a,"!CompObj"),m=Zt.find(a,"/Workbook")||Zt.find(a,"/Book")}else{switch(c.type){case"base64":a=me(z(a));break;case"binary":a=me(a);break;case"buffer":break;case"array":Array.isArray(a)||(a=Array.prototype.slice.call(a))}Zs(a,0),m={content:a}}if(u&&Aie(u),c.bookProps&&!c.bookSheets)f={};else{var w=q?"buffer":"array";if(m&&m.content)f=Iie(m.content,c);else if((m=Zt.find(a,"PerfectOffice_MAIN"))&&m.content)f=e0.to_workbook(m.content,(c.type=w,c));else{if(!(m=Zt.find(a,"NativeContent_MAIN"))||!m.content)throw(m=Zt.find(a,"MN0"))&&m.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");f=e0.to_workbook(m.content,(c.type=w,c))}c.bookVBA&&a.FullPaths&&Zt.find(a,"/_VBA_PROJECT_CUR/VBA/dir")&&(f.vbaraw=(v=a,p=Zt.utils.cfb_new({root:"R"}),v.FullPaths.forEach(function(S,b){S.slice(-1)!=="/"&&S.match(/_VBA_PROJECT_CUR/)&&(S=S.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,""),Zt.utils.cfb_add(p,S,v.FileIndex[b].content))}),Zt.write(p)))}return w={},a.FullPaths&&function(S,b,T){var P=Zt.find(S,"/!DocumentSummaryInformation");if(P&&0<P.size)try{var M,N=lL(P,qR,mv.DSI);for(M in N)b[M]=N[M]}catch(G){if(T.WTF)throw G}var U=Zt.find(S,"/!SummaryInformation");if(U&&0<U.size)try{var B,Z=lL(U,JR,mv.SI);for(B in Z)b[B]==null&&(b[B]=Z[B])}catch(G){if(T.WTF)throw G}b.HeadingPairs&&b.TitlesOfParts&&(K5(b.HeadingPairs,b.TitlesOfParts,b,T),delete b.HeadingPairs,delete b.TitlesOfParts)}(a,w,c),f.Props=f.Custprops=w,c.bookFiles&&(f.cfb=a),f}function Pie(a,v){var u,f,m=v||{},v=Zt.utils.cfb_new({root:"R"}),p="/Workbook";switch(m.bookType||"xls"){case"xls":m.bookType="biff8";case"xla":m.bookType||(m.bookType="xla");case"biff8":p="/Workbook",m.biff=8;break;case"biff5":p="/Book",m.biff=5;break;default:throw new Error("invalid type "+m.bookType+" for XLS CFB")}return Zt.utils.cfb_add(v,p,fH(a,m)),m.biff==8&&(a.Props||a.Custprops)&&function(w,S){var b,T=[],P=[],M=[],N=0,U=Wd(qR,"n"),B=Wd(JR,"n");if(w.Props)for(b=ai(w.Props),N=0;N<b.length;++N)(Object.prototype.hasOwnProperty.call(U,b[N])?T:Object.prototype.hasOwnProperty.call(B,b[N])?P:M).push([b[N],w.Props[b[N]]]);if(w.Custprops)for(b=ai(w.Custprops),N=0;N<b.length;++N)Object.prototype.hasOwnProperty.call(w.Props||{},b[N])||(Object.prototype.hasOwnProperty.call(U,b[N])?T:Object.prototype.hasOwnProperty.call(B,b[N])?P:M).push([b[N],w.Custprops[b[N]]]);for(var Z=[],N=0;N<M.length;++N)-1<oL.indexOf(M[N][0])||-1<Y5.indexOf(M[N][0])||M[N][1]!=null&&Z.push(M[N]);P.length&&Zt.utils.cfb_add(S,"/SummaryInformation",cL(P,mv.SI,B,JR)),(T.length||Z.length)&&Zt.utils.cfb_add(S,"/DocumentSummaryInformation",cL(T,mv.DSI,U,qR,Z.length?Z:null,mv.UDI))}(a,v),m.biff==8&&a.vbaraw&&(u=v,(f=Zt.read(a.vbaraw,{type:typeof a.vbaraw=="string"?"binary":"buffer"})).FullPaths.forEach(function(w,S){S==0||(w=w.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/")).slice(-1)!=="/"&&Zt.utils.cfb_add(u,w,f.FileIndex[S].content)})),v}var pv={0:{f:function(a,c){var u={},f=a.l+c;u.r=a.read_shift(4),a.l+=4;var m=a.read_shift(2);return a.l+=1,c=a.read_shift(1),a.l=f,7&c&&(u.level=7&c),16&c&&(u.hidden=!0),32&c&&(u.hpt=m/20),u}},1:{f:function(a){return[gl(a)]}},2:{f:function(a){return[gl(a),KR(a),"n"]}},3:{f:function(a){return[gl(a),a.read_shift(1),"e"]}},4:{f:function(a){return[gl(a),a.read_shift(1),"b"]}},5:{f:function(a){return[gl(a),yo(a),"n"]}},6:{f:function(a){return[gl(a),wo(a),"str"]}},7:{f:function(a){return[gl(a),a.read_shift(4),"s"]}},8:{f:function(a,c,u){var f=a.l+c,m=gl(a);m.r=u["!row"];var v=[m,wo(a),"str"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=jo(c,0,m,u.supbooks,u)):a.l=f,v}},9:{f:function(a,c,u){var f=a.l+c,m=gl(a);m.r=u["!row"];var v=[m,yo(a),"n"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=jo(c,0,m,u.supbooks,u)):a.l=f,v}},10:{f:function(a,c,u){var f=a.l+c,m=gl(a);m.r=u["!row"];var v=[m,a.read_shift(1),"b"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=jo(c,0,m,u.supbooks,u)):a.l=f,v}},11:{f:function(a,c,u){var f=a.l+c,m=gl(a);m.r=u["!row"];var v=[m,a.read_shift(1),"e"];return u.cellFormula?(a.l+=2,c=zS(a,f-a.l,u),v[3]=jo(c,0,m,u.supbooks,u)):a.l=f,v}},12:{f:function(a){return[Yd(a)]}},13:{f:function(a){return[Yd(a),KR(a),"n"]}},14:{f:function(a){return[Yd(a),a.read_shift(1),"e"]}},15:{f:function(a){return[Yd(a),a.read_shift(1),"b"]}},16:{f:tH},17:{f:function(a){return[Yd(a),wo(a),"str"]}},18:{f:function(a){return[Yd(a),a.read_shift(4),"s"]}},19:{f:UR},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(a,p,w){var f=a.l+p;a.l+=4,a.l+=1;var m=a.read_shift(4),v=cre(a),p=Rne(a,0,w),w=zR(a);return a.l=f,p={Name:v,Ptg:p},m<268435455&&(p.Sheet=m),w&&(p.Comment=w),p}},40:{},42:{},43:{f:function(a,c,u){var f={};f.sz=a.read_shift(2)/20;var m,v=(v=(m=a).read_shift(1),m.l++,{fBold:1&v,fItalic:2&v,fUnderline:4&v,fStrikeout:8&v,fOutline:16&v,fShadow:32&v,fCondense:64&v,fExtend:128&v});switch(v.fItalic&&(f.italic=1),v.fCondense&&(f.condense=1),v.fExtend&&(f.extend=1),v.fShadow&&(f.shadow=1),v.fOutline&&(f.outline=1),v.fStrikeout&&(f.strike=1),a.read_shift(2)===700&&(f.bold=1),a.read_shift(2)){case 1:f.vertAlign="superscript";break;case 2:f.vertAlign="subscript"}switch((v=a.read_shift(1))!=0&&(f.underline=v),0<(v=a.read_shift(1))&&(f.family=v),0<(v=a.read_shift(1))&&(f.charset=v),a.l++,f.color=function(p){var w={},S=p.read_shift(1)>>>1,b=p.read_shift(1),T=p.read_shift(2,"i"),P=p.read_shift(1),M=p.read_shift(1),N=p.read_shift(1);switch(p.l++,S){case 0:w.auto=1;break;case 1:w.index=b;var U=J1[b];U&&(w.rgb=nv(U));break;case 2:w.rgb=nv([P,M,N]);break;case 3:w.theme=b}return T!=0&&(w.tint=0<T?T/32767:T/32768),w}(a),a.read_shift(1)){case 1:f.scheme="major";break;case 2:f.scheme="minor"}return f.name=wo(a),f}},44:{f:function(a,c){return[a.read_shift(2),wo(a)]}},45:{f:Qre},46:{f:Js},47:{f:function(a,m){var u=a.l+m,f=a.read_shift(2),m=a.read_shift(2);return a.l=u,{ixfe:f,numFmtId:m}}},48:{},49:{f:function(a){return a.read_shift(4,"i")}},50:{},51:{f:function(a){for(var c=[],u=a.read_shift(4);0<u--;)c.push([a.read_shift(4),a.read_shift(4)]);return c}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OL},62:{f:function(a){return[gl(a),UR(a),"is"]}},63:{f:function(a){var c={};c.i=a.read_shift(4);var u={};return u.r=a.read_shift(4),u.c=a.read_shift(4),c.r=Fr(u),2&(a=a.read_shift(1))&&(c.l="1"),8&a&&(c.a="1"),c}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(a){var c=a.read_shift(2);return a.l+=28,{RTL:32&c}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(a,c){var u={},f=a[a.l];return++a.l,u.above=!(64&f),u.left=!(128&f),a.l+=18,u.name=lre(a),u}},148:{f:YS,p:16},151:{f:function(){}},152:{},153:{f:function(a,c){var u={},f=a.read_shift(4);return u.defaultThemeVersion=a.read_shift(4),0<(a=8<c?wo(a):"").length&&(u.CodeName=a),u.autoCompressPictures=!!(65536&f),u.backupFile=!!(64&f),u.checkCompatibility=!!(4096&f),u.date1904=!!(1&f),u.filterPrivacy=!!(8&f),u.hidePivotFieldList=!!(1024&f),u.promptedSolutions=!!(16&f),u.publishItems=!!(2048&f),u.refreshAllConnections=!!(262144&f),u.saveExternalLinkValues=!!(128&f),u.showBorderUnselectedTables=!!(4&f),u.showInkAnnotation=!!(32&f),u.showObjects=["all","placeholders","none"][f>>13&3],u.showPivotChartFilter=!!(32768&f),u.updateLinks=["userSet","never","always"][f>>8&3],u}},154:{},155:{},156:{f:function(a,c){var u={};return u.Hidden=a.read_shift(4),u.iTabID=a.read_shift(4),u.strRelID=GR(a),u.name=wo(a),u}},157:{},158:{},159:{T:1,f:function(a){return[a.read_shift(4),a.read_shift(4)]}},160:{T:-1},161:{T:1,f:Xd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pm},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(a,c){return{flags:a.read_shift(4),version:a.read_shift(4),name:wo(a)}}},336:{T:-1},337:{f:function(a){return a.l+=4,a.read_shift(4)!=0},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:GR},357:{},358:{},359:{},360:{T:1},361:{},362:{f:RL},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(a,v,u){var f=a.l+v,m=D5(a),v=a.read_shift(1);return(m=[m])[2]=v,u.cellFormula?(u=_ne(a,f-a.l,u),m[1]=u):a.l=f,m}},427:{f:function(a,m,u){var f=a.l+m,m=[Xd(a)];return u.cellFormula&&(u=Ane(a,f-a.l,u),m[1]=u),a.l=f,m}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(a){var c={};return rH.forEach(function(u){c[u]=yo(a)}),c}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(a,w){var u=a.l+w,f=Xd(a),m=zR(a),v=wo(a),p=wo(a),w=wo(a);return a.l=u,w={rfx:f,relId:m,loc:v,display:w},p&&(w.Tooltip=p),w}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:GR},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ge},633:{T:1},634:{T:-1},635:{T:1,f:function(a){var c={};c.iauthor=a.read_shift(4);var u=Xd(a);return c.rfx=u.s,c.ref=Fr(u.s),a.l+=16,c}},636:{T:-1},637:{f:ore},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(a,c){return a.l+=10,{name:wo(a)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},AA={6:{f:SA},10:{f:yf},12:{f:us},13:{f:us},14:{f:ns},15:{f:ns},16:{f:yo},17:{f:ns},18:{f:ns},19:{f:us},20:{f:EL},21:{f:EL},23:{f:RL},24:{f:_L},25:{f:ns},26:{},27:{},28:{f:function(a,c,u){return function(f,m){if(!(m.biff<8)){var v=f.read_shift(2),p=f.read_shift(2),w=f.read_shift(2),S=f.read_shift(2),b=Qd(f,0,m);return m.biff<8&&f.read_shift(1),[{r:v,c:p},b,S,w]}}(a,u)}},29:{},34:{f:ns},35:{f:TL},38:{f:yo},39:{f:yo},40:{f:yo},41:{f:yo},42:{f:ns},43:{f:ns},47:{f:function(a,c,u){var f={Type:8<=u.biff?a.read_shift(2):0};return f.Type?zre(a,c-2,f):(c=a,u.biff,a=u,u=f,c={key:us(c),verificationBytes:us(c)},a.password&&(c.verifier=fA(a.password)),u.valid=c.verificationBytes===c.verifier,u.valid&&(u.insitu=Ure(a.password))),f}},49:{f:function(a,c,u){var f={dyHeight:a.read_shift(2),fl:a.read_shift(2)};switch(u&&u.biff||8){case 2:break;case 3:case 4:a.l+=2;break;default:a.l+=10}return f.name=ev(a,0,u),f}},51:{f:us},60:{},61:{f:function(a){return{Pos:[a.read_shift(2),a.read_shift(2)],Dim:[a.read_shift(2),a.read_shift(2)],Flags:a.read_shift(2),CurTab:a.read_shift(2),FirstTab:a.read_shift(2),Selected:a.read_shift(2),TabRatio:a.read_shift(2)}}},64:{f:ns},65:{f:function(){}},66:{f:us},77:{},80:{},81:{},82:{},85:{f:us},89:{},90:{},91:{},92:{f:function(a,c,m){if(m.enc)return a.l+=c,"";var f=a.l,m=Qd(a,0,m);return a.read_shift(c+f-a.l),m}},93:{f:function(a,c,u){return u&&u.biff<8?function(f,m,v){f.l+=4;var p=f.read_shift(2),w=f.read_shift(2),S=f.read_shift(2);f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=2,f.l+=6,m-=36;var b=[];return b.push((Sre[p]||vo)(f,m,v)),{cmo:[w,p,S],ft:b}}(a,c,u):{cmo:u=yL(a),ft:function(f,m){for(var v=f.l+m,p=[];f.l<v;){var w=f.read_shift(2);f.l-=2;try{p.push(wre[w](f,v-f.l))}catch{return f.l=v,p}}return f.l!=v&&(f.l=v),p}(a,c-22,u[1])}}},94:{},95:{f:ns},96:{},97:{},99:{f:ns},125:{f:OL},128:{f:function(a){if(a.l+=4,(a=[a.read_shift(2),a.read_shift(2)])[0]!==0&&a[0]--,a[1]!==0&&a[1]--,7<a[0]||7<a[1])throw new Error("Bad Gutters: "+a.join("|"));return a}},129:{f:function(a,c,u){return{fDialog:16&(c=u&&u.biff==8||c==2?a.read_shift(2):(a.l+=c,0)),fBelow:64&c,fRight:128&c}}},130:{f:us},131:{f:ns},132:{f:ns},133:{f:function(a,c,u){var f=a.read_shift(4),m=3&a.read_shift(1),v=a.read_shift(1);switch(v){case 0:v="Worksheet";break;case 1:v="Macrosheet";break;case 2:v="Chartsheet";break;case 6:v="VBAModule"}return u=ev(a,0,u),{pos:f,hs:m,dt:v,name:u=u.length===0?"Sheet1":u}}},134:{},140:{f:function(a){var c=[0,0],u=a.read_shift(2);return c[0]=B5[u]||u,u=a.read_shift(2),c[1]=B5[u]||u,c}},141:{f:us},144:{},146:{f:function(a){for(var c=a.read_shift(2),u=[];0<c--;)u.push(mL(a));return u}},151:{},152:{},153:{},154:{},155:{},156:{f:us},157:{},158:{},160:{f:Ere},161:{f:function(a,c){var u={};return c<32||(a.l+=16,u.header=yo(a),u.footer=yo(a),a.l+=2),u}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(a,c){for(var u=a.l+c-2,f=a.read_shift(2),m=a.read_shift(2),v=[];a.l<u;)v.push(pL(a));if(a.l!==u)throw new Error("MulRK read error");if(c=a.read_shift(2),v.length!=c-m+1)throw new Error("MulRK length mismatch");return{r:f,c:m,C:c,rkrec:v}}},190:{f:function(a,c){for(var u=a.l+c-2,f=a.read_shift(2),m=a.read_shift(2),v=[];a.l<u;)v.push(a.read_shift(2));if(a.l!==u)throw new Error("MulBlank read error");if(c=a.read_shift(2),v.length!=c-m+1)throw new Error("MulBlank length mismatch");return{r:f,c:m,C:c,ixfe:v}}},193:{f:yf},197:{},198:{},199:{},200:{},201:{},202:{f:ns},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:us},220:{},221:{f:ns},222:{},224:{f:function(a,c,u){var f,m,v,p={};return p.ifnt=a.read_shift(2),p.numFmtId=a.read_shift(2),p.flags=a.read_shift(2),p.fStyle=p.flags>>2&1,c-=6,p.data=(f=a,p.fStyle,m=u,v={},c=f.read_shift(4),a=f.read_shift(4),u=f.read_shift(4),f=f.read_shift(2),v.patternType=hre[u>>26],m.cellStyles&&(v.alc=7&c,v.fWrap=c>>3&1,v.alcV=c>>4&7,v.fJustLast=c>>7&1,v.trot=c>>8&255,v.cIndent=c>>16&15,v.fShrinkToFit=c>>20&1,v.iReadOrder=c>>22&2,v.fAtrNum=c>>26&1,v.fAtrFnt=c>>27&1,v.fAtrAlc=c>>28&1,v.fAtrBdr=c>>29&1,v.fAtrPat=c>>30&1,v.fAtrProt=c>>31&1,v.dgLeft=15&a,v.dgRight=a>>4&15,v.dgTop=a>>8&15,v.dgBottom=a>>12&15,v.icvLeft=a>>16&127,v.icvRight=a>>23&127,v.grbitDiag=a>>30&3,v.icvTop=127&u,v.icvBottom=u>>7&127,v.icvDiag=u>>14&127,v.dgDiag=u>>21&15,v.icvFore=127&f,v.icvBack=f>>7&127,v.fsxButton=f>>14&1),v),p}},225:{f:function(a,c){return c===0||a.read_shift(2),1200}},226:{f:yf},227:{},229:{f:function(a,c){for(var u=[],f=a.read_shift(2);f--;)u.push(OS(a));return u}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(a,c){for(var u=a.l+c,c=a.read_shift(4),f=a.read_shift(4),m=[],v=0;v!=f&&a.l<u;++v)m.push(function(w){var S=o;o=1200;var b,T=w.read_shift(2),P=4&(B=w.read_shift(1)),M=8&B,N=1+(1&B),U=0,B={};return M&&(U=w.read_shift(2)),P&&(b=w.read_shift(4)),N=N==2?"dbcs-cont":"sbcs-cont",N=T===0?"":w.read_shift(T,N),M&&(w.l+=4*U),P&&(w.l+=b),B.t=N,M||(B.raw="<t>"+B.t+"</t>",B.r=B.t),o=S,B}(a));return m.Count=c,m.Unique=f,m}},253:{f:function(a){var c=qc(a);return c.isst=a.read_shift(4),c}},255:{f:function(a,c){var u={};return u.dsst=a.read_shift(2),a.l+=c-2,u}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:uL},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:ns},353:{f:yf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(a,v,u){var f=a.l+v,m=a.read_shift(2),v=a.read_shift(2);if((u.sbcch=v)==1025||v==14849)return[v,m];if(v<1||255<v)throw new Error("Unexpected SupBook type: "+v);for(var u=Jd(a,v),p=[];f>a.l;)p.push(tv(a));return[v,m,u,p]}},431:{f:ns},432:{},433:{},434:{},437:{},438:{f:function(a,c,u){var f=a.l,m="";try{a.l+=4;var v=(u.lastobj||{cmo:[0,0]}).cmo[1];[0,5,7,11,12,14].indexOf(v)==-1?a.l+=6:function(b){var T=b.read_shift(1);b.l++;var P=b.read_shift(2);b.l+=2}(a);var p=a.read_shift(2);a.read_shift(2),us(a),v=a.read_shift(2),a.l+=v;for(var w=1;w<a.lens.length-1;++w){if(a.l-f!=a.lens[w])throw new Error("TxO: bad continue record");var S=a[a.l];if((m+=Jd(a,a.lens[w+1]-a.lens[w]-1)).length>=(S?p:2*p))break}if(m.length!==p&&m.length!==2*p)throw new Error("cchText: "+p+" != "+m.length);return a.l=f+c,{t:m}}catch{return a.l=f+c,{t:m}}}},439:{f:ns},440:{f:function(a,c){var u=OS(a);return a.l+=16,[u,function(f,m){var v=f.l+m;if((P=f.read_shift(4))!==2)throw new Error("Unrecognized streamVersion: "+P);m=f.read_shift(2),f.l+=2;var p,w,S,b,T,P="";16&m&&(p=AS(f,f.l)),128&m&&(w=AS(f,f.l)),(257&m)==257&&(S=AS(f,f.l)),(257&m)==1&&(M=pre(f,f.l)),8&m&&(P=AS(f,f.l)),32&m&&(b=f.read_shift(16)),64&m&&(T=rA(f)),f.l=v;var M=w||S||M||"";return M&&P&&(M+="#"+P),M=M||"#"+P,M={Target:M=2&m&&M.charAt(0)=="/"&&M.charAt(1)!="/"?"file://"+M:M},b&&(M.guid=b),T&&(M.time=T),p&&(M.Tooltip=p),M}(a,c-24)]}},441:{},442:{f:tv},443:{},444:{f:us},445:{},446:{},448:{f:yf},449:{f:function(a){return a.read_shift(2),a.read_shift(4)},r:2},450:{f:yf},512:{f:SL},513:{f:xre},515:{f:function(a,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),u=qc(a),a=yo(a),u.val=a,u}},516:{f:function(a,c,u){return u.biffguess&&u.biff==2&&(u.biff=5),a.l,c=qc(a),u.biff==2&&a.l++,u=tv(a,a.l,u),c.val=u,c}},517:{f:xL},519:{f:WA},520:{f:function(a){var c={};c.r=a.read_shift(2),c.c=a.read_shift(2),c.cnt=a.read_shift(2)-c.c;var u=a.read_shift(2);a.l+=4;var f=a.read_shift(1);return a.l+=3,7&f&&(c.level=7&f),32&f&&(c.hidden=!0),64&f&&(c.hpt=u/20),c}},523:{},545:{f:AL},549:{f:CL},566:{},574:{f:function(a,c,u){return u&&2<=u.biff&&u.biff<5?{}:{RTL:64&a.read_shift(2)}}},638:{f:function(f){var c=f.read_shift(2),u=f.read_shift(2),f=pL(f);return{r:c,c:u,ixfe:f[0],rknum:f[1]}}},659:{},1048:{},1054:{f:function(a,c,u){return[a.read_shift(2),Qd(a,0,u)]}},1084:{},1212:{f:function(a,c,u){var f=wL(a);a.l++;var m=a.read_shift(1);return[function(v,p,w){var S,b=v.l+p,T=v.read_shift(2),P=hv(v,T,w);return T==65535?[[],vo(v,p-2)]:(p!==T+2&&(S=uv(v,b-T-2,P,w)),[P,S])}(a,c-=8,u),m,f]}},2048:{f:function(a,c){return a.read_shift(2),[OS(a),a.read_shift((c-10)/2,"dbcs-cont").replace(lt,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:IS},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:yf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(a){a.l+=2;var c={cxfs:0,crc:0};return c.cxfs=a.read_shift(2),c.crc=a.read_shift(4),c},r:12},2173:{f:function(a,c){a.l,a.l+=2,c=a.read_shift(2),a.l+=2;for(var u=a.read_shift(2),f=[];0<u--;)f.push(dne(a,a.l));return{ixfe:c,ext:f}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:ns,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(a,c,u){if(!(u.biff<8)){var f=a.read_shift(2),m=a.read_shift(2);return[Jd(a,f,u),Jd(a,m,u)]}a.l+=c},r:12},2197:{},2198:{f:function(a,c,u){var f=a.l+c;if(a.read_shift(4)!==124226)if(u.cellStyles){var m,v=a.slice(a.l);a.l=f;try{m=vf(v,{type:"array"})}catch{return}if(c=Br(m,"theme/theme/theme1.xml",!0),c)return T8(c,u)}else a.l=f},r:12},2199:{},2200:{},2201:{},2202:{f:function(a){return[a.read_shift(4)!==0,a.read_shift(4)!==0,a.read_shift(4)]},r:12},2203:{f:yf},2204:{},2205:{},2206:{},2207:{},2211:{f:function(a){var c,u,f=(u=(c=a).read_shift(2),f=c.read_shift(2),c.l+=8,{type:u,flags:f});if(f.type!=2211)throw new Error("Invalid Future Record "+f.type);return a.read_shift(4)!==0}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:us},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(a,c,u){var f={area:!1};return u.biff!=5?a.l+=c:(c=a.read_shift(1),a.l+=3,16&c&&(f.area=!0)),f}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(a){for(var c=a.read_shift(2),u=[];0<c--;)u.push(mL(a));return u}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:SL},1:{},2:{f:function(a){var c=qc(a);return++a.l,a=a.read_shift(2),c.t="n",c.val=a,c}},3:{f:function(a){var c=qc(a);return++a.l,a=yo(a),c.t="n",c.val=a,c}},4:{f:function(a,c,u){u.biffguess&&u.biff==5&&(u.biff=2);var f=qc(a);return++a.l,u=Qd(a,0,u),f.t="str",f.val=u,f}},5:{f:xL},7:{f:function(a){var c=a.read_shift(1);return c===0?(a.l++,""):a.read_shift(c,"sbcs-cont")}},8:{},9:{f:IS},11:{},22:{f:us},30:{f:vm},31:{},32:{},33:{f:AL},36:{},37:{f:CL},50:{f:function(a,c){a.l+=6,a.l+=2,a.l+=1,a.l+=3,a.l+=1,a.l+=c-13}},62:{},52:{},67:{},68:{f:us},69:{},86:{},126:{},127:{f:function(a){var c=a.read_shift(2),f=a.read_shift(2),u=a.read_shift(4),f={fmt:c,env:f,len:u,data:a.slice(a.l,a.l+u)};return a.l+=u,f}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(a,v,p){var f=a.l+v,m=qc(a),v=a.read_shift(2),p=Jd(a,v,p);return a.l=f,m.t="str",m.val=p,m}},223:{},234:{},354:{},421:{},518:{f:SA},521:{f:IS},536:{f:_L},547:{f:TL},561:{},579:{},1030:{f:SA},1033:{f:IS},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Dt(a,c,u,f){var m=c;isNaN(m)||(c=f||(u||[]).length||0,(f=a.next(4)).write_shift(2,m),f.write_shift(2,c),0<c&&BR(u)&&a.push(u))}function vv(a,c,u){return(a=a||tt(7)).write_shift(2,c),a.write_shift(2,u),a.write_shift(2,0),a.write_shift(1,0),a}function Fie(a,c,u,f){if(c.v!=null)switch(c.t){case"d":case"n":var m=c.t=="d"?hi(ue(c.v)):c.v;return void(m==(0|m)&&0<=m&&m<65536?Dt(a,2,(T=u,P=f,M=m,vv(N=tt(9),T,P),N.write_shift(2,M),N)):Dt(a,3,(M=u,N=f,m=m,vv(b=tt(15),M,N),b.write_shift(8,m,"f"),b)));case"b":case"e":return void Dt(a,5,(b=u,v=f,p=c.v,w=c.t,vv(S=tt(9),b,v),hL(p,w||"b",S),S));case"s":case"str":return void Dt(a,4,(v=u,p=f,w=(c.v||"").slice(0,255),vv(S=tt(8+2*w.length),v,p),S.write_shift(1,w.length),S.write_shift(w.length,w,"sbcs"),S.l<S.length?S.slice(0,S.l):S))}var v,p,w,S,b,T,P,M,N;Dt(a,1,vv(null,u,f))}function Mie(a,c){for(var u=c||{},c=ga(),f=0,m=0;m<a.SheetNames.length;++m)a.SheetNames[m]==u.sheet&&(f=m);if(f==0&&u.sheet&&a.SheetNames[0]!=u.sheet)throw new Error("Sheet not found: "+u.sheet);return Dt(c,u.biff==4?1033:u.biff==3?521:9,nA(0,16,u)),function(v,p,w){var S,b,T=Array.isArray(p),P=un(p["!ref"]||"A1"),M=[];if(255<P.e.c||16383<P.e.r){if(w.WTF)throw new Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");P.e.c=Math.min(P.e.c,255),P.e.r=Math.min(P.e.c,16383),S=Wr(P)}for(var N=P.s.r;N<=P.e.r;++N){b=Ui(N);for(var U=P.s.c;U<=P.e.c;++U){N===P.s.r&&(M[U]=gi(U)),S=M[U]+b;var B=T?(p[N]||[])[U]:p[S];B&&Fie(v,B,N,U)}}}(c,a.Sheets[a.SheetNames[f]],u),Dt(c,10),c.end()}function kie(a,c,u){var f,m;Dt(a,49,(m=(f={sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"}).name||"Arial",(a=tt((u=(a=u)&&a.biff==5)?15+m.length:16+2*m.length)).write_shift(2,20*(f.sz||12)),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,m.length),u||a.write_shift(1,1),a.write_shift((u?1:2)*m.length,m,u?"sbcs":"utf16le"),a))}function Nie(a,c,u){c&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var m,v,p,w,S=f[0];S<=f[1];++S)c[S]!=null&&Dt(a,1054,(m=S,v=c[S],w=void 0,p=(p=u)&&p.biff==5,(w=w||tt(p?3+v.length:5+2*v.length)).write_shift(2,m),w.write_shift(p?1:2,v.length),p||w.write_shift(1,1),w.write_shift((p?1:2)*v.length,v,p?"sbcs":"utf16le"),(w=w.length>w.l?w.slice(0,w.l):w).l==null&&(w.l=w.length),w))})}function Die(a,c){for(var u=0;u<c["!links"].length;++u){var f=c["!links"][u];Dt(a,440,bre(f)),f[1].Tooltip&&Dt(a,2048,function(m){var v=m[1].Tooltip,p=tt(10+2*(v.length+1));p.write_shift(2,2048),m=Ii(m[0]),p.write_shift(2,m.r),p.write_shift(2,m.r),p.write_shift(2,m.c),p.write_shift(2,m.c);for(var w=0;w<v.length;++w)p.write_shift(2,v.charCodeAt(w));return p.write_shift(2,0),p}(f))}delete c["!links"]}function Lie(a,c){var u;c&&(u=0,c.forEach(function(f,m){var v;++u<=256&&f&&Dt(a,125,(v=GS(m,f),f=m,(m=tt(12)).write_shift(2,f),m.write_shift(2,f),m.write_shift(2,256*v.width),m.write_shift(2,0),f=0,v.hidden&&(f|=1),m.write_shift(1,f),f=v.level||0,m.write_shift(1,f),m.write_shift(2,0),m))}))}function Hie(a,c,u,f,m){var v,p,w,S,b,T,P,M,N,U,B,Z=16+bf(m.cellXfs,c,m);if(c.v!=null||c.bf)if(c.bf)Dt(a,6,Tne(c,u,f,0,Z));else switch(c.t){case"d":case"n":var G=c.t=="d"?hi(ue(c.v)):c.v;Dt(a,515,(T=u,P=f,M=G,N=Z,U=tt(14),Zd(T,P,N,U),am(M,U),U));break;case"b":case"e":Dt(a,517,(G=u,T=f,P=c.v,N=Z,M=c.t,U=tt(8),Zd(G,T,N,U),hL(P,M,U),U));break;case"s":case"str":m.bookSST?(B=xA(m.Strings,c.v,m.revStrings),Dt(a,253,(v=u,p=f,w=B,S=Z,b=tt(10),Zd(v,p,S,b),b.write_shift(4,w),b))):Dt(a,516,(B=u,v=f,p=(c.v||"").slice(0,255),S=Z,w=tt(+(b=!(w=m)||w.biff==8)+8+(1+b)*p.length),Zd(B,v,S,w),w.write_shift(2,p.length),b&&w.write_shift(1,1),w.write_shift((1+b)*p.length,p,b?"utf16le":"sbcs"),w));break;default:Dt(a,513,Zd(u,f,Z))}else Dt(a,513,Zd(u,f,Z))}function $ie(a,c,u){var f,m,v=ga(),J=u.SheetNames[a],p=u.Sheets[J]||{},w=(u||{}).Workbook||{},S=(w.Sheets||[])[a]||{},b=Array.isArray(p),T=c.biff==8,P=[],M=un(p["!ref"]||"A1"),N=T?65536:16384;if(255<M.e.c||M.e.r>=N){if(c.WTF)throw new Error("Range "+(p["!ref"]||"A1")+" exceeds format limit A1:IV16384");M.e.c=Math.min(M.e.c,255),M.e.r=Math.min(M.e.c,N-1)}Dt(v,2057,nA(0,16,c)),Dt(v,13,pl(1)),Dt(v,12,pl(100)),Dt(v,15,Wo(!0)),Dt(v,17,Wo(!1)),Dt(v,16,am(.001)),Dt(v,95,Wo(!0)),Dt(v,42,Wo(!1)),Dt(v,43,Wo(!1)),Dt(v,130,pl(1)),Dt(v,128,(u=[0,0],(a=tt(8)).write_shift(4,0),a.write_shift(2,u[0]?u[0]+1:0),a.write_shift(2,u[1]?u[1]+1:0),a)),Dt(v,131,Wo(!1)),Dt(v,132,Wo(!1)),T&&Lie(v,p["!cols"]),Dt(v,512,(N=M,(u=tt(2*(a=(u=c).biff!=8&&u.biff?2:4)+6)).write_shift(a,N.s.r),u.write_shift(a,N.e.r+1),u.write_shift(2,N.s.c),u.write_shift(2,N.e.c+1),u.write_shift(2,0),u)),T&&(p["!links"]=[]);for(var U=M.s.r;U<=M.e.r;++U){m=Ui(U);for(var B=M.s.c;B<=M.e.c;++B){U===M.s.r&&(P[B]=gi(B)),f=P[B]+m;var Z=b?(p[U]||[])[B]:p[f];Z&&(Hie(v,Z,U,B,c),T&&Z.l&&p["!links"].push([f,Z.l]))}}var G,W,J=S.CodeName||S.name||J;return T&&Dt(v,574,(w=(w.Views||[])[0],W=tt(18),G=1718,w&&w.RTL&&(G|=64),W.write_shift(2,G),W.write_shift(4,0),W.write_shift(4,64),W.write_shift(4,0),W.write_shift(4,0),W)),T&&(p["!merges"]||[]).length&&Dt(v,229,function(ne){var se=tt(2+8*ne.length);se.write_shift(2,ne.length);for(var be=0;be<ne.length;++be)vL(ne[be],se);return se}(p["!merges"])),T&&Die(v,p),Dt(v,442,fL(J)),T&&(G=v,W=p,(J=tt(19)).write_shift(4,2151),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,3),J.write_shift(1,1),J.write_shift(4,0),Dt(G,2151,J),(J=tt(39)).write_shift(4,2152),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,3),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(2,1),J.write_shift(4,4),J.write_shift(2,0),vL(un(W["!ref"]||"A1"),J),J.write_shift(4,4),Dt(G,2152,J)),Dt(v,10),v.end()}function Bie(a,c,u){var f=ga(),w=(a||{}).Workbook||{},m=w.Sheets||[],v=w.WBProps||{},p=u.biff==8,w=u.biff==5;Dt(f,2057,nA(0,5,u)),u.bookType=="xla"&&Dt(f,135),Dt(f,225,p?pl(1200):null),Dt(f,193,function(G,W){W=W||tt(G);for(var J=0;J<G;++J)W.write_shift(1,0);return W}(2)),w&&Dt(f,191),w&&Dt(f,192),Dt(f,226),Dt(f,92,function(G){var W=!G||G.biff==8,J=tt(W?112:54);for(J.write_shift(G.biff==8?2:1,7),W&&J.write_shift(1,0),J.write_shift(4,859007059),J.write_shift(4,5458548|(W?0:536870912));J.l<J.length;)J.write_shift(1,W?0:32);return J}(u)),Dt(f,66,pl(p?1200:1252)),p&&Dt(f,353,pl(0)),p&&Dt(f,448),Dt(f,317,function(G){for(var W=tt(2*G),J=0;J<G;++J)W.write_shift(2,J+1);return W}(a.SheetNames.length)),p&&a.vbaraw&&Dt(f,211),p&&a.vbaraw&&Dt(f,442,fL(v.CodeName||"ThisWorkbook")),Dt(f,156,pl(17)),Dt(f,25,Wo(!1)),Dt(f,18,Wo(!1)),Dt(f,19,pl(0)),p&&Dt(f,431,Wo(!1)),p&&Dt(f,444,pl(0)),Dt(f,61,((w=tt(18)).write_shift(2,0),w.write_shift(2,0),w.write_shift(2,29280),w.write_shift(2,17600),w.write_shift(2,56),w.write_shift(2,0),w.write_shift(2,0),w.write_shift(2,1),w.write_shift(2,500),w)),Dt(f,64,Wo(!1)),Dt(f,141,pl(0)),Dt(f,34,Wo(((v=a).Workbook&&v.Workbook.WBProps&&di(v.Workbook.WBProps.date1904)?"true":"false")=="true")),Dt(f,14,Wo(!0)),p&&Dt(f,439,Wo(!1)),Dt(f,218,pl(0)),kie(f,0,u),Nie(f,a.SSF,u),function(G,W){for(var J=0;J<16;++J)Dt(G,224,bL({numFmtId:0,style:!0},0,W));W.cellXfs.forEach(function(ne){Dt(G,224,bL(ne,0,W))})}(f,u),p&&Dt(f,352,Wo(!1)),w=f.end(),v=ga(),p&&Dt(v,140,((Z=Z||tt(4)).write_shift(2,1),Z.write_shift(2,1),Z)),p&&u.Strings&&function(G,W,J){var ne=(J||[]).length||0;if(ne<=8224)return Dt(G,W,J,ne);if(!isNaN(W)){for(var se=J.parts||[],be=0,De=0,Pe=0;Pe+(se[be]||8224)<=8224;)Pe+=se[be]||8224,be++;var je=G.next(4);for(je.write_shift(2,W),je.write_shift(2,Pe),G.push(J.slice(De,De+Pe)),De+=Pe;De<ne;){for((je=G.next(4)).write_shift(2,60),Pe=0;Pe+(se[be]||8224)<=8224;)Pe+=se[be]||8224,be++;je.write_shift(2,Pe),G.push(J.slice(De,De+Pe)),De+=Pe}}}(v,252,yre(u.Strings)),Dt(v,10);for(var f=v.end(),S=ga(),b=0,T=0,T=0;T<a.SheetNames.length;++T)b+=(p?12:11)+(p?2:1)*a.SheetNames[T].length;var P,M,N,U,B=w.length+b+f.length;for(T=0;T<a.SheetNames.length;++T)Dt(S,133,(P={pos:B,hs:(m[T]||{}).Hidden||0,dt:0,name:a.SheetNames[T]},U=N=void 0,N=!(M=u)||8<=M.biff?2:1,(U=tt(8+N*P.name.length)).write_shift(4,P.pos),U.write_shift(1,P.hs||0),U.write_shift(1,P.dt),U.write_shift(1,P.name.length),8<=M.biff&&U.write_shift(1,1),U.write_shift(N*P.name.length,P.name,M.biff<8?"sbcs":"utf16le"),(M=U.slice(0,U.l)).l=U.l,M)),B+=c[T].length;var Z=S.end();if(b!=Z.length)throw new Error("BS8 "+b+" != "+Z.length);return v=[],w.length&&v.push(w),Z.length&&v.push(Z),f.length&&v.push(f),Be(v)}function fH(a,c){for(var u=0;u<=a.SheetNames.length;++u){var f=a.Sheets[a.SheetNames[u]];f&&f["!ref"]&&255<Vo(f["!ref"]).e.c&&typeof console<"u"&&console.error&&console.error("Worksheet '"+a.SheetNames[u]+"' extends beyond column IV (255).  Data may be lost.")}var m=c||{};switch(m.biff||2){case 8:case 5:return function(v,p){var w=p||{},S=[];v&&!v.SSF&&(v.SSF=ke(D)),v&&v.SSF&&(ot(),Ve(v.SSF),w.revssf=eh(v.SSF),w.revssf[v.SSF[65535]]=0,w.ssf=v.SSF),w.Strings=[],w.Strings.Count=0,w.Strings.Unique=0,kA(w),w.cellXfs=[],bf(w.cellXfs,{},{revssf:{General:0}}),v.Props||(v.Props={});for(var b=0;b<v.SheetNames.length;++b)S[S.length]=$ie(b,w,v);return S.unshift(Bie(v,S,w)),Be(S)}(a,c);case 4:case 3:case 2:return Mie(a,c)}throw new Error("invalid type "+m.bookType+" for BIFF")}function dH(a,c){var u=c||{},f=u.dense?[]:{},m=(a=a.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!m)throw new Error("Invalid HTML: could not find <table>");for(var v,c=a.match(/<\/table/i),M=m.index,p=c&&c.index||a.length,w=Qe(a.slice(M,p),/(:?<tr[^>]*>)/i,"<tr>"),S=-1,b=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},P=[],M=0;M<w.length;++M){var N=w[M].trim(),U=N.slice(0,3).toLowerCase();if(U!="<tr"){if(U=="<td"||U=="<th")for(var B=N.split(/<\/t[dh]>/i),p=0;p<B.length;++p){var Z=B[p].trim();if(Z.match(/<t[dh]/i)){for(var G=Z,W=0;G.charAt(0)=="<"&&-1<(W=G.indexOf(">"));)G=G.slice(W+1);for(var J=0;J<P.length;++J){var ne=P[J];ne.s.c==b&&ne.s.r<S&&S<=ne.e.r&&(b=ne.e.c+1,J=-1)}var se=Pr(Z.slice(0,Z.indexOf(">"))),be=se.colspan?+se.colspan:1;(1<(v=+se.rowspan)||1<be)&&P.push({s:{r:S,c:b},e:{r:S+(v||1)-1,c:b+be-1}}),Z=se.t||se["data-t"]||"",G.length&&(G=p5(G),T.s.r>S&&(T.s.r=S),T.e.r<S&&(T.e.r=S),T.s.c>b&&(T.s.c=b),T.e.c<b&&(T.e.c=b),G.length&&(se={t:"s",v:G},u.raw||!G.trim().length||Z=="s"||(G==="TRUE"?se={t:"b",v:!0}:G==="FALSE"?se={t:"b",v:!1}:isNaN($e(G))?isNaN(ie(G).getDate())||(se={t:"d",v:ue(G)},(se=u.cellDates?se:{t:"n",v:hi(se.v)}).z=u.dateNF||D[14]):se={t:"n",v:$e(G)}),u.dense?(f[S]||(f[S]=[]),f[S][b]=se):f[Fr({r:S,c:b})]=se)),b+=be}}}else{if(++S,u.sheetRows&&u.sheetRows<=S){--S;break}b=0}}return f["!ref"]=Wr(T),P.length&&(f["!merges"]=P),f}function gH(a,c,u,f){for(var m=a["!merges"]||[],v=[],p=c.s.c;p<=c.e.c;++p){for(var w,S,b,T,P=0,M=0,N=0;N<m.length;++N)if(!(m[N].s.r>u||m[N].s.c>p||m[N].e.r<u||m[N].e.c<p)){if(m[N].s.r<u||m[N].s.c<p){P=-1;break}P=m[N].e.r-m[N].s.r+1,M=m[N].e.c-m[N].s.c+1;break}P<0||(w=Fr({r:u,c:p}),b=(S=f.dense?(a[u]||[])[p]:a[w])&&S.v!=null&&(S.h||IR(S.w||(Xc(S),S.w)||""))||"",T={},1<P&&(T.rowspan=P),1<M&&(T.colspan=M),f.editable?b='<span contenteditable="true">'+b+"</span>":S&&(T["data-t"]=S&&S.t||"z",S.v!=null&&(T["data-v"]=S.v),S.z!=null&&(T["data-z"]=S.z),S.l&&(S.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+S.l.Target+'">'+b+"</a>")),T.id=(f.id||"sjs")+"-"+w,v.push(Nt("td",b,T)))}return"<tr>"+v.join("")+"</tr>"}var mH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pH="</body></html>";function vH(a,c,u){return[].join("")+"<table"+(u&&u.id?' id="'+u.id+'"':"")+">"}function wH(a,m){var u=m||{},f=u.header!=null?u.header:mH,m=u.footer!=null?u.footer:pH,v=[f],p=Vo(a["!ref"]);u.dense=Array.isArray(a),v.push(vH(0,0,u));for(var w=p.s.r;w<=p.e.r;++w)v.push(gH(a,p,w,u));return v.push("</table>"+m),v.join("")}function yH(a,c,u){var f=u||{},m=0,v=0;f.origin!=null&&(typeof f.origin=="number"?m=f.origin:(m=(u=typeof f.origin=="string"?Ii(f.origin):f.origin).r,v=u.c));var p=c.getElementsByTagName("tr"),w=Math.min(f.sheetRows||1e7,p.length),S={s:{r:0,c:0},e:{r:m,c:v}};a["!ref"]&&(c=Vo(a["!ref"]),S.s.r=Math.min(S.s.r,c.s.r),S.s.c=Math.min(S.s.c,c.s.c),S.e.r=Math.max(S.e.r,c.e.r),S.e.c=Math.max(S.e.c,c.e.c),m==-1&&(S.e.r=m=c.e.r+1));var b,T,P=[],M=0,N=a["!rows"]||(a["!rows"]=[]),U=0,B=0,Z=0,G=0;for(a["!cols"]||(a["!cols"]=[]);U<p.length&&B<w;++U){var W=p[U];if(SH(W)){if(f.display)continue;N[B]={hidden:!0}}for(var J=W.children,Z=G=0;Z<J.length;++Z){var ne=J[Z];if(!f.display||!SH(ne)){for(var se=ne.hasAttribute("data-v")?ne.getAttribute("data-v"):ne.hasAttribute("v")?ne.getAttribute("v"):p5(ne.innerHTML),be=ne.getAttribute("data-z")||ne.getAttribute("z"),M=0;M<P.length;++M){var De=P[M];De.s.c==G+v&&De.s.r<B+m&&B+m<=De.e.r&&(G=De.e.c+1-v,M=-1)}T=+ne.getAttribute("colspan")||1,(1<(b=+ne.getAttribute("rowspan")||1)||1<T)&&P.push({s:{r:B+m,c:G+v},e:{r:B+m+(b||1)-1,c:G+v+(T||1)-1}});var Pe={t:"s",v:se},je=ne.getAttribute("data-t")||ne.getAttribute("t")||"";se!=null&&(se.length==0?Pe.t=je||"z":f.raw||se.trim().length==0||je=="s"||(se==="TRUE"?Pe={t:"b",v:!0}:se==="FALSE"?Pe={t:"b",v:!1}:isNaN($e(se))?isNaN(ie(se).getDate())||(Pe={t:"d",v:ue(se)},(Pe=f.cellDates?Pe:{t:"n",v:hi(Pe.v)}).z=f.dateNF||D[14]):Pe={t:"n",v:$e(se)})),Pe.z===void 0&&be!=null&&(Pe.z=be);var it="",st=ne.getElementsByTagName("A");if(st&&st.length)for(var Ke=0;Ke<st.length&&(!st[Ke].hasAttribute("href")||(it=st[Ke].getAttribute("href")).charAt(0)=="#");++Ke);it&&it.charAt(0)!="#"&&(Pe.l={Target:it}),f.dense?(a[B+m]||(a[B+m]=[]),a[B+m][G+v]=Pe):a[Fr({c:G+v,r:B+m})]=Pe,S.e.c<G+v&&(S.e.c=G+v),G+=T}}++B}return P.length&&(a["!merges"]=(a["!merges"]||[]).concat(P)),S.e.r=Math.max(S.e.r,B-1+m),a["!ref"]=Wr(S),w<=B&&(a["!fullref"]=Wr((S.e.r=p.length-U+B-1+m,S))),a}function CH(a,c){return yH((c||{}).dense?[]:{},a,c)}function SH(a){var u,c="",u=(u=a).ownerDocument.defaultView&&typeof u.ownerDocument.defaultView.getComputedStyle=="function"?u.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null;return(c=(c=u?u(a).getPropertyValue("display"):c)||a.style&&a.style.display)==="none"}var bH={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function xH(a,c){var u=c||{},f,m,v,p,w,S=kR(a),b=[],T={name:""},P="",M=0,N={},U=[],B=u.dense?[]:{},Z={value:""},G="",W=0,J=[],ne=-1,se=-1,be={s:{r:1e6,c:1e7},e:{r:0,c:0}},De=0,Pe={},je=[],it={},st=[],Ke=1,yt=1,Wt=[],Ht={Names:[]},At={},Pt=["",""],Tt=[],ft={},Qt="",sr=0,wr=!1,Gr=!1,Yt=0;for(Y1.lastIndex=0,S=S.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Y1.exec(S);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(be.e.c>=be.s.c&&be.e.r>=be.s.r?B["!ref"]=Wr(be):B["!ref"]="A1:A1",0<u.sheetRows&&u.sheetRows<=be.e.r&&(B["!fullref"]=B["!ref"],be.e.r=u.sheetRows-1,B["!ref"]=Wr(be)),je.length&&(B["!merges"]=je),st.length&&(B["!rows"]=st),v.name=v.||v.name,typeof JSON<"u"&&JSON.stringify(v),U.push(v.name),N[v.name]=B,Gr=!1):p[0].charAt(p[0].length-2)!=="/"&&(v=Pr(p[0],!1),ne=se=-1,be.s.r=be.s.c=1e7,be.e.r=be.e.c=0,B=u.dense?[]:{},je=[],st=[],Gr=!0);break;case"table-row-group":p[1]==="/"?--De:++De;break;case"table-row":case"":if(p[1]==="/"){ne+=Ke,Ke=1;break}if((wt=Pr(p[0],!1)).?ne=wt.-1:ne==-1&&(ne=0),(Ke=+wt["number-rows-repeated"]||1)<10)for(Yt=0;Yt<Ke;++Yt)0<De&&(st[ne+Yt]={level:De});se=-1;break;case"covered-table-cell":p[1]!=="/"&&++se,u.sheetStubs&&(u.dense?(B[ne]||(B[ne]=[]),B[ne][se]={t:"z"}):B[Fr({r:ne,c:se})]={t:"z"}),G="",J=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++se,Z=Pr(p[0],!1),yt=parseInt(Z["number-columns-repeated"]||"1",10),w={t:"z",v:null},Z.formula&&u.cellFormula!=0&&(w.f=U8(Sn(Z.formula))),(Z.||Z["value-type"])=="string"&&(w.t="s",w.v=Sn(Z["string-value"]||""),u.dense?(B[ne]||(B[ne]=[]),B[ne][se]=w):B[Fr({r:ne,c:se})]=w),se+=yt-1;else if(p[1]!=="/"){G="",W=0,J=[],yt=1;var wt=Ke?ne+Ke-1:ne;if(++se>be.e.c&&(be.e.c=se),se<be.s.c&&(be.s.c=se),ne<be.s.r&&(be.s.r=ne),wt>be.e.r&&(be.e.r=wt),Tt=[],ft={},w={t:(Z=Pr(p[0],!1)).||Z["value-type"],v:null},u.cellFormula)if(Z.formula&&(Z.formula=Sn(Z.formula)),Z["number-matrix-columns-spanned"]&&Z["number-matrix-rows-spanned"]&&(it={s:{r:ne,c:se},e:{r:ne+(parseInt(Z["number-matrix-rows-spanned"],10)||0)-1,c:se+(parseInt(Z["number-matrix-columns-spanned"],10)||0)-1}},w.F=Wr(it),Wt.push([it,w.F])),Z.formula)w.f=U8(Z.formula);else for(Yt=0;Yt<Wt.length;++Yt)ne>=Wt[Yt][0].s.r&&ne<=Wt[Yt][0].e.r&&se>=Wt[Yt][0].s.c&&se<=Wt[Yt][0].e.c&&(w.F=Wt[Yt][1]);switch((Z["number-columns-spanned"]||Z["number-rows-spanned"])&&(it={s:{r:ne,c:se},e:{r:ne+(parseInt(Z["number-rows-spanned"],10)||0)-1,c:se+(parseInt(Z["number-columns-spanned"],10)||0)-1}},je.push(it)),Z["number-columns-repeated"]&&(yt=parseInt(Z["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=di(Z["boolean-value"]);break;case"float":case"percentage":case"currency":w.t="n",w.v=parseFloat(Z.value);break;case"date":w.t="d",w.v=ue(Z["date-value"]),u.cellDates||(w.t="n",w.v=hi(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=function(rn){var In=0,zi=0,Te=!1,Pn=rn.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Pn)throw new Error("|"+rn+"| is not an ISO8601 Duration");for(var Tn=1;Tn!=Pn.length;++Tn)if(Pn[Tn]){switch(zi=1,3<Tn&&(Te=!0),Pn[Tn].slice(Pn[Tn].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Pn[Tn].slice(Pn[Tn].length-1));case"D":zi*=24;case"H":zi*=60;case"M":if(!Te)throw new Error("Unsupported ISO Duration Field: M");zi*=60}In+=zi*parseInt(Pn[Tn],10)}return In}(Z["time-value"])/86400,u.cellDates&&(w.t="d",w.v=ee(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(Z.);break;default:if(w.t!=="string"&&w.t!=="text"&&w.t)throw new Error("Unsupported value type "+w.t);w.t="s",Z["string-value"]!=null&&(G=Sn(Z["string-value"]),J=[])}}else{if(wr=!1,w.t==="s"&&(w.v=G||"",J.length&&(w.R=J),wr=W==0),At.Target&&(w.l=At),0<Tt.length&&(w.c=Tt,Tt=[]),G&&u.cellText!==!1&&(w.w=G),wr&&(w.t="z",delete w.v),(!wr||u.sheetStubs)&&!(u.sheetRows&&u.sheetRows<=ne))for(var Mr=0;Mr<Ke;++Mr){if(yt=parseInt(Z["number-columns-repeated"]||"1",10),u.dense)for(B[ne+Mr]||(B[ne+Mr]=[]),B[ne+Mr][se]=Mr==0?w:ke(w);0<--yt;)B[ne+Mr][se+yt]=ke(w);else for(B[Fr({r:ne+Mr,c:se})]=w;0<--yt;)B[Fr({r:ne+Mr,c:se+yt})]=ke(w);be.e.c<=se&&(be.e.c=se)}se+=(yt=parseInt(Z["number-columns-repeated"]||"1",10))-1,yt=0,w={},G="",J=[]}At={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f;ft.t=G,J.length&&(ft.R=J),ft.a=Qt,Tt.push(ft)}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!1]);G=Qt="",W=sr=0,J=[];break;case"creator":p[1]==="/"?Qt=S.slice(sr,p.index):sr=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&b.push([p[3],!1]);G="",W=0,J=[];break;case"scientific-number":case"currency-symbol":case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(Pe[T.name]=P,(f=b.pop())[0]!==p[3])throw"Bad state: "+f}else p[0].charAt(p[0].length-2)!=="/"&&(P="",T=Pr(p[0],!1),b.push([p[3],!0]));break;case"script":case"libraries":case"automatic-styles":break;case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":break;case"number":switch(b[b.length-1][0]){case"time-style":case"date-style":m=Pr(p[0],!1),P+=bH[p[3]][m.style==="long"?1:0]}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(b[b.length-1][0]){case"time-style":case"date-style":m=Pr(p[0],!1),P+=bH[p[3]][m.style==="long"?1:0]}break;case"boolean-style":case"boolean":case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(b[b.length-1][0]){case"number-style":case"date-style":case"time-style":P+=S.slice(M,p.index)}else M=p.index+p[0].length;break;case"named-range":Pt=bA((m=Pr(p[0],!1))["cell-range-address"]);var fn={Name:m.name,Ref:Pt[0]+"!"+Pt[1]};Gr&&(fn.Sheet=U.length),Ht.Names.push(fn);break;case"text-content":case"text-properties":case"embedded-text":break;case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":break;case"p":case"":if(-1<["master-styles"].indexOf(b[b.length-1][0]))break;p[1]!=="/"||Z&&Z["string-value"]?(Pr(p[0],!1),W=p.index+p[0].length):(fn=(fn=S.slice(W,p.index)).replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(rn,In){return Array(parseInt(In,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),fn=[Sn(fn.replace(/<[^>]*>/g,""))],G=(0<G.length?G+`
`:"")+fn[0]);break;case"s":break;case"database-range":if(p[1]==="/")break;try{N[(Pt=bA(Pr(p[0])["target-range-address"]))[0]]["!autofilter"]={ref:Pt[1]}}catch{}break;case"date":case"object":break;case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":break;case"a":if(p[1]!=="/"){if(!(At=Pr(p[0],!1)).href)break;At.Target=Sn(At.href),delete At.href,At.Target.charAt(0)=="#"&&-1<At.Target.indexOf(".")?(Pt=bA(At.Target.slice(1)),At.Target="#"+Pt[0]+"!"+Pt[1]):At.Target.match(/^\.\.[\\\/]/)&&(At.Target=At.Target.slice(3))}break;case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(u.WTF)throw new Error(p)}}return a={Sheets:N,SheetNames:U,Workbook:Ht},u.bookSheets&&delete a.Sheets,a}function EH(a,c){c=c||{},vt(a,"META-INF/manifest.xml")&&function(f,m){for(var v,p,w=kR(f);v=Y1.exec(w);)switch(v[3]){case"manifest":break;case"file-entry":if((p=Pr(v[0],!1)).path=="/"&&p.type!==fre)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(m&&m.WTF)throw v}}(Er(a,"META-INF/manifest.xml"),c);var u=Br(a,"content.xml");if(!u)throw new Error("Missing content.xml in ODS / UOF file");return c=xH(Qn(u),c),vt(a,"meta.xml")&&(c.Props=z5(Er(a,"meta.xml"))),c}function TH(a,c){return xH(a,c)}var Vie=function(){var a=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),c="<office:document-styles "+G1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+a+"</office:document-styles>";return function(){return fi+c}}(),_H=function(){function a(u,f,m){var v=[];v.push('      <table:table table:name="'+Bn(f.SheetNames[m])+`" table:style-name="ta1">
`);var p=0,w=0,S=Vo(u["!ref"]||"A1"),b=u["!merges"]||[],T=0,P=Array.isArray(u);if(u["!cols"])for(w=0;w<=S.e.c;++w)v.push("        <table:table-column"+(u["!cols"][w]?' table:style-name="co'+u["!cols"][w].ods+'"':"")+`></table:table-column>
`);for(var M="",N=u["!rows"]||[],p=0;p<S.s.r;++p)M=N[p]?' table:style-name="ro'+N[p].ods+'"':"",v.push("        <table:table-row"+M+`></table:table-row>
`);for(;p<=S.e.r;++p){for(M=N[p]?' table:style-name="ro'+N[p].ods+'"':"",v.push("        <table:table-row"+M+`>
`),w=0;w<S.s.c;++w)v.push(c);for(;w<=S.e.c;++w){for(var U=!1,B={},Z="",T=0;T!=b.length;++T)if(!(b[T].s.c>w||b[T].s.r>p||b[T].e.c<w||b[T].e.r<p)){b[T].s.c==w&&b[T].s.r==p||(U=!0),B["table:number-columns-spanned"]=b[T].e.c-b[T].s.c+1,B["table:number-rows-spanned"]=b[T].e.r-b[T].s.r+1;break}if(U)v.push(`          <table:covered-table-cell/>
`);else{var G=Fr({r:p,c:w}),W=P?(u[p]||[])[w]:u[G];if(W&&W.f&&(B["table:formula"]=Bn(("of:="+W.f.replace(wA,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),W.F&&W.F.slice(0,G.length)==G&&(J=Vo(W.F),B["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,B["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1)),W){switch(W.t){case"b":Z=W.v?"TRUE":"FALSE",B["office:value-type"]="boolean",B["office:boolean-value"]=W.v?"true":"false";break;case"n":Z=W.w||String(W.v||0),B["office:value-type"]="float",B["office:value"]=W.v||0;break;case"s":case"str":Z=W.v==null?"":W.v,B["office:value-type"]="string";break;case"d":Z=W.w||ue(W.v).toISOString(),B["office:value-type"]="date",B["office:date-value"]=ue(W.v).toISOString(),B["table:style-name"]="ce1";break;default:v.push(c);continue}var J,G=Bn(Z).replace(/  +/g,function(se){return'<text:s text:c="'+se.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");W.l&&W.l.Target&&(G=Nt("text:a",G,{"xlink:href":(J=(J=(J=W.l.Target).charAt(0)=="#"?"#"+J.slice(1).replace(/\./,"!"):J).charAt(0)!="#"&&!J.match(/^\w+:/)?"../"+J:J).replace(/&/g,"&amp;")})),v.push("          "+Nt("table:table-cell",Nt("text:p",G,{}),B)+`
`)}else v.push(c)}}v.push(`        </table:table-row>
`)}return v.push(`      </table:table>
`),v.join("")}var c=`          <table:table-cell />
`;return function(u,f){var m=[fi],v=G1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=G1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(m.push("<office:document"+v+p+`>
`),m.push(U5().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+v+`>
`),function(S,b){S.push(` <office:automatic-styles>
`),S.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),S.push(`   <number:month number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:day number:style="long"/>
`),S.push(`   <number:text>/</number:text>
`),S.push(`   <number:year/>
`),S.push(`  </number:date-style>
`);var T=0;b.SheetNames.map(function(M){return b.Sheets[M]}).forEach(function(M){if(M&&M["!cols"]){for(var N=0;N<M["!cols"].length;++N)if(M["!cols"][N]){var U=M["!cols"][N];if(U.width==null&&U.wpx==null&&U.wch==null)continue;Cf(U),U.ods=T,U=M["!cols"][N].wpx+"px",S.push('  <style:style style:name="co'+T+`" style:family="table-column">
`),S.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+U+`"/>
`),S.push(`  </style:style>
`),++T}}});var P=0;b.SheetNames.map(function(M){return b.Sheets[M]}).forEach(function(M){if(M&&M["!rows"])for(var N,U=0;U<M["!rows"].length;++U)M["!rows"][U]&&(M["!rows"][U].ods=P,N=M["!rows"][U].hpx+"px",S.push('  <style:style style:name="ro'+P+`" style:family="table-row">
`),S.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+N+`"/>
`),S.push(`  </style:style>
`),++P)}),S.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),S.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),S.push(`  </style:style>
`),S.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),S.push(` </office:automatic-styles>
`)}(m,u),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var w=0;w!=u.SheetNames.length;++w)m.push(a(u.Sheets[u.SheetNames[w]],u,w));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),f.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}}();function RH(a,c){if(c.bookType=="fods")return _H(a,c);var u=dl(),f=[],m=[];return Ir(u,"mimetype","application/vnd.oasis.opendocument.spreadsheet"),Ir(u,"content.xml",_H(a,c)),f.push(["content.xml","text/xml"]),m.push(["content.xml","ContentFile"]),Ir(u,"styles.xml",Vie(a,c)),f.push(["styles.xml","text/xml"]),m.push(["styles.xml","StylesFile"]),Ir(u,"meta.xml",fi+U5()),f.push(["meta.xml","text/xml"]),m.push(["meta.xml","MetadataFile"]),Ir(u,"manifest.rdf",function(v){var p=[fi];p.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var w=0;w!=v.length;++w)p.push(j5(v[w][0],v[w][1])),p.push([`  <rdf:Description rdf:about="">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+v[w][0]+`"/>
`,`  </rdf:Description>
`].join(""));return p.push(j5("","Document","pkg")),p.push("</rdf:RDF>"),p.join("")}(m)),f.push(["manifest.rdf","application/rdf+xml"]),Ir(u,"META-INF/manifest.xml",function(v){var p=[fi];p.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),p.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var w=0;w<v.length;++w)p.push('  <manifest:file-entry manifest:full-path="'+v[w][0]+'" manifest:media-type="'+v[w][1]+`"/>
`);return p.push("</manifest:manifest>"),p.join("")}(f)),u}function oh(a){return new DataView(a.buffer,a.byteOffset,a.byteLength)}function OA(a){return typeof TextDecoder<"u"?new TextDecoder().decode(a):Qn(Re(a))}function AH(a){return typeof TextEncoder<"u"?new TextEncoder().encode(a):me(Kc(a))}function xf(a){var c=a.reduce(function(m,v){return m+v.length},0),u=new Uint8Array(c),f=0;return a.forEach(function(m){u.set(m,f),f+=m.length}),u}function OH(a){return 16843009*((a=(858993459&(a-=a>>1&1431655765))+(a>>2&858993459))+(a>>4)&252645135)>>>24}function wv(a,c){var u=c?c[0]:0,f=127&a[u];return 128<=a[u++]&&(f|=(127&a[u])<<7,a[u++]<128||(f|=(127&a[u])<<14,a[u++]<128||(f|=(127&a[u])<<21,a[u++]<128||(f+=(127&a[u])*Math.pow(2,28),++u,a[u++]<128||(f+=(127&a[u])*Math.pow(2,35),++u,a[u++]<128||(f+=(127&a[u])*Math.pow(2,42),++u,a[u++])))))),c&&(c[0]=u),f}function bn(a){var c=new Uint8Array(7);c[0]=127&a;var u=1;return 127<a&&(c[u-1]|=128,c[u]=a>>7&127,++u,a<=16383||(c[u-1]|=128,c[u]=a>>14&127,++u,a<=2097151||(c[u-1]|=128,c[u]=a>>21&127,++u,a<=268435455||(c[u-1]|=128,c[u]=a/256>>>21&127,++u,a<=34359738367||(c[u-1]|=128,c[u]=a/65536>>>21&127,++u,a<=4398046511103||(c[u-1]|=128,c[u]=a/16777216>>>21&127,++u)))))),c.slice(0,u)}function Ei(a){var c=0,u=127&a[0];return 128<=a[c++]&&(u|=(127&a[1])<<7,a[c++]<128||(u|=(127&a[2])<<14,a[c++]<128||(u|=(127&a[3])<<21,a[+c]<128||(u|=(127&a[4])<<28)))),u}function hn(a){for(var c=[],u=[0];u[0]<a.length;){var f,m=u[0],v=wv(a,u),p=7&v,w=0;if((v=Math.floor(v/8))==0)break;switch(p){case 0:for(var S=u[0];128<=a[u[0]++];);f=a.slice(S,u[0]);break;case 5:w=4,f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 1:w=8,f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 2:w=wv(a,u),f=a.slice(u[0],u[0]+w),u[0]+=w;break;case 3:case 4:default:throw new Error("PB Type ".concat(p," for Field ").concat(v," at offset ").concat(m))}var b={data:f,type:p};c[v]==null?c[v]=[b]:c[v].push(b)}return c}function Pi(a){var c=[];return a.forEach(function(u,f){f!=0&&u.forEach(function(m){m.data&&(c.push(bn(8*f+m.type)),m.type==2&&c.push(bn(m.data.length)),c.push(m.data))})}),xf(c)}function IA(a,c){return(a==null?void 0:a.map(function(u){return c(u.data)}))||[]}function vl(a){for(var c=[],u=[0];u[0]<a.length;){var f=wv(a,u),m=hn(a.slice(u[0],u[0]+f));u[0]+=f;var v={id:Ei(m[1][0].data),messages:[]};m[2].forEach(function(S){var w=hn(S.data),S=Ei(w[3][0].data);v.messages.push({meta:w,data:a.slice(u[0],u[0]+S)}),u[0]+=S}),(f=m[3])!=null&&f[0]&&(v.merge=0<Ei(m[3][0].data)>>>0),c.push(v)}return c}function r0(a){var c=[];return a.forEach(function(u){var f=[[],[{data:bn(u.id),type:0}],[]];u.merge!=null&&(f[3]=[{data:bn(+!!u.merge),type:0}]);var m=[];u.messages.forEach(function(v){m.push(v.data),v.meta[3]=[{type:0,data:bn(v.data.length)}],f[2].push({data:Pi(v.meta),type:2})}),u=Pi(f),c.push(bn(u.length)),c.push(u),m.forEach(function(v){return c.push(v)})}),xf(c)}function wl(a){for(var c=[],u=0;u<a.length;){var f=a[u++],m=a[u]|a[u+1]<<8|a[u+2]<<16;u+=3,c.push(function(v,p){if(v!=0)throw new Error("Unexpected Snappy chunk type ".concat(v));for(var w=[0],S=wv(p,w),b=[];w[0]<p.length;){var T=3&p[w[0]];if(T!=0){var P=0,M=0;if(T==1?(M=4+(p[w[0]]>>2&7),P=(224&p[w[0]++])<<3,P|=p[w[0]++]):(M=1+(p[w[0]++]>>2),T==2?(P=p[w[0]]|p[w[0]+1]<<8,w[0]+=2):(P=(p[w[0]]|p[w[0]+1]<<8|p[w[0]+2]<<16|p[w[0]+3]<<24)>>>0,w[0]+=4)),b=[xf(b)],P==0)throw new Error("Invalid offset 0");if(P>b[0].length)throw new Error("Invalid offset beyond length");if(P<=M)for(b.push(b[0].slice(-P)),M-=P;M>=b[b.length-1].length;)b.push(b[b.length-1]),M-=b[b.length-1].length;b.push(b[0].slice(-P,-P+M))}else T=p[w[0]++]>>2,T<60?++T:(P=T-59,T=p[w[0]],1<P&&(T|=p[w[0]+1]<<8),2<P&&(T|=p[w[0]+2]<<16),3<P&&(T|=p[w[0]+3]<<24),T>>>=0,T++,w[0]+=P),b.push(p.slice(w[0],w[0]+T)),w[0]+=T}if((v=xf(b)).length!=S)throw new Error("Unexpected length: ".concat(v.length," != ").concat(S));return v}(f,a.slice(u,u+m))),u+=m}if(u!==a.length)throw new Error("data is not a valid framed stream!");return xf(c)}function n0(a){for(var c=[],u=0;u<a.length;){var f=Math.min(a.length-u,268435455),m=new Uint8Array(4);c.push(m);var v=bn(f),p=v.length;c.push(v),f<=60?(p++,c.push(new Uint8Array([f-1<<2]))):f<=256?(p+=2,c.push(new Uint8Array([240,f-1&255]))):f<=65536?(p+=3,c.push(new Uint8Array([244,f-1&255,f-1>>8&255]))):f<=16777216?(p+=4,c.push(new Uint8Array([248,f-1&255,f-1>>8&255,f-1>>16&255]))):f<=4294967296&&(p+=5,c.push(new Uint8Array([252,f-1&255,f-1>>8&255,f-1>>16&255,f-1>>>24&255]))),c.push(a.slice(u,u+f)),p+=f,m[0]=0,m[1]=255&p,m[2]=p>>8&255,m[3]=p>>16&255,u+=f}return xf(c)}function Wie(a,c,u){var f,m=oh(a),v=m.getUint32(8,!0),p=12,w=-1,S=-1,b=NaN,T=NaN,P=new Date(2001,0,1);switch(1&v&&(b=function(M,N){for(var U=(127&M[N+15])<<7|M[N+14]>>1,B=1&M[N+14],Z=N+13;N<=Z;--Z)B=256*B+M[Z];return(128&M[N+15]?-B:B)*Math.pow(10,U-6176)}(a,p),p+=16),2&v&&(T=m.getFloat64(p,!0),p+=8),4&v&&(P.setTime(P.getTime()+1e3*m.getFloat64(p,!0)),p+=8),8&v&&(S=m.getUint32(p,!0),p+=4),16&v&&(w=m.getUint32(p,!0),p+=4),a[1]){case 0:break;case 2:f={t:"n",v:b};break;case 3:f={t:"s",v:c[S]};break;case 5:f={t:"d",v:P};break;case 6:f={t:"b",v:0<T};break;case 7:f={t:"n",v:T/86400};break;case 8:f={t:"e",v:0};break;case 9:if(!(-1<w))throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&v," : ").concat(a.slice(0,4)));f={t:"s",v:u[w]};break;case 10:f={t:"n",v:b};break;default:throw new Error("Unsupported cell type ".concat(a[1]," : ").concat(31&v," : ").concat(a.slice(0,4)))}return f}function PA(a,c){var u=new Uint8Array(32),f=oh(u),m=12,v=0;switch(u[0]=5,a.t){case"n":u[1]=2,function(p,w,S){var b=Math.floor(S==0?0:Math.LOG10E*Math.log(Math.abs(S)))+6176-16,T=S/Math.pow(10,b-6176);p[w+15]|=b>>7,p[w+14]|=(127&b)<<1;for(var P=0;1<=T;++P,T/=256)p[w+P]=255&T;p[w+15]|=0<=S?0:128}(u,m,a.v),v|=1,m+=16;break;case"b":u[1]=6,f.setFloat64(m,a.v?1:0,!0),v|=2,m+=8;break;case"s":if(c.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));u[1]=3,f.setUint32(m,c.indexOf(a.v),!0),v|=8,m+=4;break;default:throw"unsupported cell type "+a.t}return f.setUint32(8,v,!0),u.slice(0,m)}function FA(a,c){var u=new Uint8Array(32),f=oh(u),m=12,v=0;switch(u[0]=3,a.t){case"n":u[2]=2,f.setFloat64(m,a.v,!0),v|=32,m+=8;break;case"b":u[2]=6,f.setFloat64(m,a.v?1:0,!0),v|=32,m+=8;break;case"s":if(c.indexOf(a.v)==-1)throw new Error("Value ".concat(a.v," missing from SST!"));u[2]=3,f.setUint32(m,c.indexOf(a.v),!0),v|=16,m+=4;break;default:throw"unsupported cell type "+a.t}return f.setUint32(4,v,!0),u.slice(0,m)}function jie(a,c,u){switch(a[0]){case 0:case 1:case 2:case 3:return function(f,m,v,p){var w,S=oh(f),b=S.getUint32(4,!0),T=(1<p?12:8)+4*OH(b&(1<p?3470:398)),P=-1,M=-1,N=NaN,U=new Date(2001,0,1);switch(512&b&&(P=S.getUint32(T,!0),T+=4),T+=4*OH(b&(1<p?12288:4096)),16&b&&(M=S.getUint32(T,!0),T+=4),32&b&&(N=S.getFloat64(T,!0),T+=8),64&b&&(U.setTime(U.getTime()+1e3*S.getFloat64(T,!0)),T+=8),f[2]){case 0:break;case 2:w={t:"n",v:N};break;case 3:w={t:"s",v:m[M]};break;case 5:w={t:"d",v:U};break;case 6:w={t:"b",v:0<N};break;case 7:w={t:"n",v:N/86400};break;case 8:w={t:"e",v:0};break;case 9:if(-1<P)w={t:"s",v:v[P]};else if(-1<M)w={t:"s",v:m[M]};else{if(isNaN(N))throw new Error("Unsupported cell type ".concat(f.slice(0,4)));w={t:"n",v:N}}break;default:throw new Error("Unsupported cell type ".concat(f.slice(0,4)))}return w}(a,c,u,a[0]);case 5:return Wie(a,c,u);default:throw new Error("Unsupported payload version ".concat(a[0]))}}function eo(a){return wv(hn(a)[1][0].data)}function IH(a,f){var f=hn(f.data),u=Ei(f[1][0].data),f=f[3],m=[];return(f||[]).forEach(function(v){var p=hn(v.data),w=Ei(p[1][0].data)>>>0;switch(u){case 1:m[w]=OA(p[3][0].data);break;case 8:var b=hn(a[eo(p[9][0].data)][0].data),S=a[eo(b[1][0].data)][0],b=Ei(S.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));S=hn(S.data),m[w]=S[3].map(function(T){return OA(T.data)}).join("")}}),m}function Uie(a,m){var u=hn(m.data),f=(m=u==null?void 0:u[7])!=null&&m[0]?0<Ei(u[7][0].data)>>>0?1:0:-1,m=IA(u[5],function(v){return function(p,w){var S,b,T,P=hn(p),M=Ei(P[1][0].data)>>>0,N=Ei(P[2][0].data)>>>0,U=((p=(U=P[8])==null?void 0:U[0])==null?void 0:p.data)&&0<Ei(P[8][0].data)||!1;if((p=(p=P[7])==null?void 0:p[0])!=null&&p.data&&w!=0)b=(S=(S=P[7])==null?void 0:S[0])==null?void 0:S.data,T=(S=(S=P[6])==null?void 0:S[0])==null?void 0:S.data;else{if((S=(S=P[4])==null?void 0:S[0])==null||!S.data||w==1)throw"NUMBERS Tile missing ".concat(w," cell storage");b=(w=(w=P[4])==null?void 0:w[0])==null?void 0:w.data,T=(P=(P=P[3])==null?void 0:P[0])==null?void 0:P.data}for(var B=U?4:1,Z=oh(b),G=[],W=0;W<b.length/2;++W){var J=Z.getUint16(2*W,!0);J<65535&&G.push([W,J])}if(G.length!=N)throw"Expected ".concat(N," cells, found ").concat(G.length);for(var ne=[],W=0;W<G.length-1;++W)ne[G[W][0]]=T.subarray(G[W][1]*B,G[W+1][1]*B);return 1<=G.length&&(ne[G[G.length-1][0]]=T.subarray(G[G.length-1][1]*B)),{R:M,cells:ne}}(v,f)});return{nrows:Ei(u[4][0].data)>>>0,data:m.reduce(function(v,p){return v[p.R]||(v[p.R]=[]),p.cells.forEach(function(w,S){if(v[p.R][S])throw new Error("Duplicate cell r=".concat(p.R," c=").concat(S));v[p.R][S]=w}),v},[])}}function zie(a,m){var u={"!ref":"A1"},f=a[eo(hn(m.data)[2][0].data)],m=Ei(f[0].meta[1][0].data);if(m!=6001)throw new Error("6000 unexpected reference to ".concat(m));return function(v,S,w){var P=hn(S.data);if((S={s:{r:0,c:0},e:{r:0,c:0}}).e.r=(Ei(P[6][0].data)>>>0)-1,S.e.r<0)throw new Error("Invalid row varint ".concat(P[6][0].data));if(S.e.c=(Ei(P[7][0].data)>>>0)-1,S.e.c<0)throw new Error("Invalid col varint ".concat(P[7][0].data));w["!ref"]=Wr(S);var S=hn(P[4][0].data),b=IH(v,v[eo(S[4][0].data)][0]),T=(P=S[17])!=null&&P[0]?IH(v,v[eo(S[17][0].data)][0]):[],P=hn(S[3][0].data),M=0;if(P[1].forEach(function(U){var B=hn(U.data),U=v[eo(B[2][0].data)][0],B=Ei(U.meta[1][0].data);if(B!=6002)throw new Error("6001 unexpected reference to ".concat(B));U=Uie(0,U),U.data.forEach(function(Z,G){Z.forEach(function(W,J){J=Fr({r:M+G,c:J}),W=jie(W,b,T),W&&(w[J]=W)})}),M+=U.nrows}),(P=S[13])!=null&&P[0]){if(P=v[eo(S[13][0].data)][0],S=Ei(P.meta[1][0].data),S!=6144)throw new Error("Expected merge type 6144, found ".concat(S));w["!merges"]=(P=hn(P.data))==null?void 0:P[1].map(function(U){var B=hn(U.data),U=oh(hn(B[1][0].data)[1][0].data),B=oh(hn(B[2][0].data)[1][0].data);return{s:{r:U.getUint16(0,!0),c:U.getUint16(2,!0)},e:{r:U.getUint16(0,!0)+B.getUint16(0,!0)-1,c:U.getUint16(2,!0)+B.getUint16(2,!0)-1}}})}}(a,f[0],u),u}function Gie(a,c){var u=BA(),f=hn(c.data);if((c=f[2])!=null&&c[0])throw new Error("Keynote presentations are not supported");if(IA(f[1],eo).forEach(function(m){a[m].forEach(function(v){var p,w,S,b;Ei(v.meta[1][0].data)==2&&(w=a,v=hn((S=v).data),b={name:(S=v[1])!=null&&S[0]?OA(v[1][0].data):"",sheets:[]},IA(v[2],eo).forEach(function(T){w[T].forEach(function(P){Ei(P.meta[1][0].data)==6e3&&b.sheets.push(zie(w,P))})}),(p=b).sheets.forEach(function(T,P){VA(u,T,P==0?p.name:p.name+"_"+P,!0)}))})}),u.SheetNames.length==0)throw new Error("Empty NUMBERS file");return u}function PH(a){var c={},u=[];if(a.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),a.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var v,p;try{v=wl(m.content)}catch(w){return console.log("?? "+m.content.length+" "+(w.message||w))}try{p=vl(v)}catch(w){return console.log("## "+(w.message||w))}p.forEach(function(w){c[w.id]=w.messages,u.push(w.id)})}}),!u.length)throw new Error("File has no messages");if((a=(a=(a=(a=c==null?void 0:c[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])!=null&&a[0].data&&Ei(c[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var f=((a=(a=(a=(a=c==null?void 0:c[1])==null?void 0:a[0])==null?void 0:a.meta)==null?void 0:a[1])==null?void 0:a[0].data)&&Ei(c[1][0].meta[1][0].data)==1&&c[1][0];if(f||u.forEach(function(m){c[m].forEach(function(v){if(Ei(v.meta[1][0].data)>>>0==1){if(f)throw new Error("Document has multiple roots");f=v}})}),!f)throw new Error("Cannot find Document root");return Gie(c,f)}function Yie(a,c){if(!c||!c.numbers)throw new Error("Must pass a `numbers` option -- check the README");var u=a.Sheets[a.SheetNames[0]];1<a.SheetNames.length&&console.error("The Numbers writer currently writes only the first table");var f=Vo(u["!ref"]);f.s.r=f.s.c=0;var m=!1;9<f.e.c&&(m=!0,f.e.c=9),49<f.e.r&&(m=!0,f.e.r=49),m&&console.error("The Numbers writer is currently limited to ".concat(Wr(f)));var v=ZS(u,{range:f,header:1}),p=["~Sh33tJ5~"];v.forEach(function(At){return At.forEach(function(Pt){typeof Pt=="string"&&p.push(Pt)})});var w={},S=[],b=Zt.read(c.numbers,{type:"base64"});b.FileIndex.map(function(At,Pt){return[At,b.FullPaths[Pt]]}).forEach(function(At){var Pt=At[0],Tt=At[1];Pt.type==2&&Pt.name.match(/\.iwa/)&&vl(wl(Pt.content)).forEach(function(ft){S.push(ft.id),w[ft.id]={deps:[],location:Tt,type:Ei(ft.messages[0].meta[1][0].data)}})}),S.sort(function(At,Pt){return At-Pt});var T=S.filter(function(At){return 1<At}).map(function(At){return[At,bn(At)]});b.FileIndex.map(function(At,Pt){return[At,b.FullPaths[Pt]]}).forEach(function(At){var Pt=At[0];At[1],Pt.name.match(/\.iwa/)&&vl(wl(Pt.content)).forEach(function(Tt){Tt.messages.forEach(function(ft){T.forEach(function(Qt){Tt.messages.some(function(sr){return Ei(sr.meta[1][0].data)!=11006&&function(wr,Gr){e:for(var Yt=0;Yt<=wr.length-Gr.length;++Yt){for(var wt=0;wt<Gr.length;++wt)if(wr[Yt+wt]!=Gr[wt])continue e;return!0}return!1}(sr.data,Qt[1])})&&w[Qt[0]].deps.push(Tt.id)})})})});for(var P,M=Zt.find(b,w[1].location),N=vl(wl(M.content)),U=0;U<N.length;++U){var B=N[U];B.id==1&&(P=B)}for(var Z=eo(hn(P.messages[0].data)[1][0].data),N=vl(wl((M=Zt.find(b,w[Z].location)).content)),U=0;U<N.length;++U)(B=N[U]).id==Z&&(P=B);var it=hn(P.messages[0].data);for(it[1]=[{type:2,data:AH(a.SheetNames[0])}],P.messages[0].data=Pi(it),M.content=n0(r0(N)),M.size=M.content.length,Z=eo(it[2][0].data),N=vl(wl((M=Zt.find(b,w[Z].location)).content)),U=0;U<N.length;++U)(B=N[U]).id==Z&&(P=B);for(Z=eo(hn(P.messages[0].data)[2][0].data),N=vl(wl((M=Zt.find(b,w[Z].location)).content)),U=0;U<N.length;++U)(B=N[U]).id==Z&&(P=B);m=hn(P.messages[0].data),m[6][0].data=bn(f.e.r+1),m[7][0].data=bn(f.e.c+1);for(var G=eo(m[46][0].data),c=Zt.find(b,w[G].location),W=vl(wl(c.content)),J=0;J<W.length&&W[J].id!=G;++J);if(W[J].id!=G)throw"Bad ColumnRowUIDMapArchive";var ne=hn(W[J].messages[0].data);ne[1]=[],ne[2]=[],ne[3]=[];for(var se=0;se<=f.e.c;++se)ne[1].push({type:2,data:Pi([[],[{type:0,data:bn(se+420690)}],[{type:0,data:bn(se+420690)}]])}),ne[2].push({type:0,data:bn(se)}),ne[3].push({type:0,data:bn(se)});ne[4]=[],ne[5]=[],ne[6]=[];for(var be=0;be<=f.e.r;++be)ne[4].push({type:2,data:Pi([[],[{type:0,data:bn(be+726270)}],[{type:0,data:bn(be+726270)}]])}),ne[5].push({type:0,data:bn(be)}),ne[6].push({type:0,data:bn(be)});if(W[J].messages[0].data=Pi(ne),c.content=n0(r0(W)),c.size=c.content.length,delete m[46],a=hn(m[4][0].data),a[7][0].data=bn(f.e.r+1),it=eo(hn(a[1][0].data)[2][0].data),(W=vl(wl((c=Zt.find(b,w[it].location)).content)))[0].id!=it)throw"Bad HeaderStorageBucket";for(var De=hn(W[0].messages[0].data),be=0;be<v.length;++be){var Pe=hn(De[2][0].data);Pe[1][0].data=bn(be),Pe[4][0].data=bn(v[be].length),De[2][be]={type:De[2][0].type,data:Pi(Pe)}}W[0].messages[0].data=Pi(De),c.content=n0(r0(W)),c.size=c.content.length;var je,it=eo(a[2][0].data);if((W=vl(wl((c=Zt.find(b,w[it].location)).content)))[0].id!=it)throw"Bad HeaderStorageBucket";for(De=hn(W[0].messages[0].data),se=0;se<=f.e.c;++se)(Pe=hn(De[2][0].data))[1][0].data=bn(se),Pe[4][0].data=bn(f.e.r+1),De[2][se]={type:De[2][0].type,data:Pi(Pe)};W[0].messages[0].data=Pi(De),c.content=n0(r0(W)),c.size=c.content.length,u["!merges"]&&(Wt=function(At){for(var Pt=927262;Pt<2e6;++Pt)if(!w[Pt])return w[Pt]=At,Pt;throw new Error("Too many messages")}({type:6144,deps:[Z],location:w[Z].location}),je=[[],[]],u["!merges"].forEach(function(At){je[1].push({type:2,data:Pi([[],[{type:2,data:Pi([[],[{type:5,data:new Uint8Array(new Uint16Array([At.s.r,At.s.c]).buffer)}]])}],[{type:2,data:Pi([[],[{type:5,data:new Uint8Array(new Uint16Array([At.e.r-At.s.r+1,At.e.c-At.s.c+1]).buffer)}]])}]])})}),a[13]=[{type:2,data:Pi([[],[{type:0,data:bn(Wt)}]])}],N.push({id:Wt,messages:[(yt=6144,Wt=Pi(je),{meta:[[],[{type:0,data:bn(yt)}]],data:Wt})]}));var st=eo(a[4][0].data);(function(){for(var At,Pt=Zt.find(b,w[st].location),Tt=vl(wl(Pt.content)),ft=0;ft<Tt.length;++ft){var Qt=Tt[ft];Qt.id==st&&(At=Qt)}var sr=hn(At.messages[0].data);sr[3]=[],p.forEach(function(wr,Gr){sr[3].push({type:2,data:Pi([[],[{type:0,data:bn(Gr)}],[{type:0,data:bn(1)}],[{type:2,data:AH(wr)}]])})}),At.messages[0].data=Pi(sr),Pt.content=n0(r0(Tt)),Pt.size=Pt.content.length})();var Ke=hn(a[3][0].data),yt=Ke[1][0];delete Ke[2];var yt,Wt,Wt=hn(yt.data),Ht=eo(Wt[2][0].data);return function(){for(var At,Pt=Zt.find(b,w[Ht].location),Tt=vl(wl(Pt.content)),ft=0;ft<Tt.length;++ft){var Qt=Tt[ft];Qt.id==Ht&&(At=Qt)}var sr=hn(At.messages[0].data);delete sr[6],delete Ke[7];var wr=new Uint8Array(sr[5][0].data);sr[5]=[];for(var Gr=0,Yt=0;Yt<=f.e.r;++Yt){var wt=hn(wr);Gr+=function(Mr,fn,rn){var In,zi;if((In=Mr[6])==null||!In[0]||(zi=Mr[7])==null||!zi[0])throw"Mutation only works on post-BNC storages!";if((zi=(zi=Mr[8])==null?void 0:zi[0])!=null&&zi.data&&0<Ei(Mr[8][0].data))throw"Math only works with normal offsets";for(var Te,Pn,Tn=0,_s=oh(Mr[7][0].data),Cl=0,fe=[],qe=oh(Mr[4][0].data),Se=0,ze=[],Ce=0;Ce<fn.length;++Ce)if(fn[Ce]!=null){switch(_s.setUint16(2*Ce,Cl,!0),qe.setUint16(2*Ce,Se,!0),typeof fn[Ce]){case"string":Te=PA({t:"s",v:fn[Ce]},rn),Pn=FA({t:"s",v:fn[Ce]},rn);break;case"number":Te=PA({t:"n",v:fn[Ce]},rn),Pn=FA({t:"n",v:fn[Ce]},rn);break;case"boolean":Te=PA({t:"b",v:fn[Ce]},rn),Pn=FA({t:"b",v:fn[Ce]},rn);break;default:throw new Error("Unsupported value "+fn[Ce])}fe.push(Te),Cl+=Te.length,ze.push(Pn),Se+=Pn.length,++Tn}else _s.setUint16(2*Ce,65535,!0),qe.setUint16(2*Ce,65535);for(Mr[2][0].data=bn(Tn);Ce<Mr[7][0].data.length/2;++Ce)_s.setUint16(2*Ce,65535,!0),qe.setUint16(2*Ce,65535,!0);return Mr[6][0].data=xf(fe),Mr[3][0].data=xf(ze),Tn}(wt,v[Yt],p),wt[1][0].data=bn(Yt),sr[5].push({data:Pi(wt),type:2})}sr[1]=[{type:0,data:bn(f.e.c+1)}],sr[2]=[{type:0,data:bn(f.e.r+1)}],sr[3]=[{type:0,data:bn(Gr)}],sr[4]=[{type:0,data:bn(f.e.r+1)}],At.messages[0].data=Pi(sr),Pt.content=n0(r0(Tt)),Pt.size=Pt.content.length}(),yt.data=Pi(Wt),a[3][0].data=Pi(Ke),m[4][0].data=Pi(a),P.messages[0].data=Pi(m),M.content=n0(r0(N)),M.size=M.content.length,b}function FH(a){return function(c){for(var u=0;u!=a.length;++u){var f=a[u];c[f[0]]===void 0&&(c[f[0]]=f[1]),f[2]==="n"&&(c[f[0]]=Number(c[f[0]]))}}}function MA(a){FH([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(a)}function kA(a){FH([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(a)}function Kie(a,c){if(!a)return 0;try{a=c.map(function(u){return u.id||(u.id=u.strRelID),[u.name,a["!id"][u.id].Target,(u=a["!id"][u.id].Type,-1<zr.WS.indexOf(u)?"sheet":zr.CS&&u==zr.CS?"chart":zr.DS&&u==zr.DS?"dialog":zr.MS&&u==zr.MS?"macro":u&&u.length?u:"sheet")]})}catch{return null}return a&&a.length!==0?a:null}function Xie(a,c,u,f,m,v,p,w,S,b,T,P){try{v[f]=Z1(Br(a,u,!0),c);var M=Er(a,c);switch(w){case"sheet":B=gie(M,c,m,S,v[f],b,T,P);break;case"chart":if(!(B=mie(M,c,m,S,v[f],b))||!B["!drawel"])break;var U=Ha(B["!drawel"].Target,c),N=Q1(U),W=Ha((W=Br(a,U,!0),N=Z1(Br(a,N,!0),U),W?(W=(W.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1],N["!id"][W].Target):"??"),U),U=Q1(W),B=nie(Br(a,W,!0),0,0,Z1(Br(a,U,!0),W),0,B);break;case"macro":G=c,v[f],G.slice(-4),B={"!type":"macro"};break;case"dialog":G=c,v[f],G.slice(-4),B={"!type":"dialog"};break;default:throw new Error("Unrecognized sheet type "+w)}p[f]=B;var Z=[];v&&v[f]&&ai(v[f]).forEach(function(J){var ne,se,be,De,Pe,je,it="";if(v[f][J].Type==zr.CMNT){it=Ha(v[f][J].Target,c);var st=wie(Er(a,it,!0),it,S);if(!st||!st.length)return;A8(B,st,!1)}v[f][J].Type==zr.TCMNT&&(it=Ha(v[f][J].Target,c),Z=Z.concat((ne=Er(a,it,!0),se=S,De=!(be=[]),Pe={},je=0,ne.replace(po,function(Ke,yt){var Wt=Pr(Ke);switch(Yc(Wt[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":break;case"<threadedComment":Pe={author:Wt.personId,guid:Wt.id,ref:Wt.ref,T:1};break;case"</threadedComment>":Pe.t!=null&&be.push(Pe);break;case"<text>":case"<text":je=yt+Ke.length;break;case"</text>":Pe.t=ne.slice(je,yt).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":De=!0;break;case"</mentions>":De=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":De=!0;break;case"</ext>":De=!1;break;default:if(!De&&se.WTF)throw new Error("unrecognized "+Wt[0]+" in threaded comments")}return Ke}),be)))}),Z&&Z.length&&A8(B,Z,!0,S.people||[])}catch(J){if(S.WTF)throw J}var G,W}function yl(a){return a.charAt(0)=="/"?a.slice(1):a}function MH(a,c){if(ot(),MA(c=c||{}),vt(a,"META-INF/manifest.xml")||vt(a,"objectdata.xml"))return EH(a,c);if(vt(a,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(a.FileIndex)return PH(a);var u=Zt.utils.cfb_new();return mn(a).forEach(function(Tt){Ir(u,Tt,function(Qt,sr,wr){return ut(gr(Qt,sr))}(a,Tt))}),PH(u)}if(!vt(a,"[Content_Types].xml"))throw vt(a,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):vt(a,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var f,m,v=mn(a),p=function(Tt){var ft=ZR();if(!Tt||!Tt.match)return ft;var Qt={};if((Tt.match(po)||[]).forEach(function(sr){var wr=Pr(sr);switch(wr[0].replace(Gte,"<")){case"<?xml":break;case"<Types":ft.xmlns=wr["xmlns"+(wr[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":Qt[wr.Extension]=wr.ContentType;break;case"<Override":ft[QR[wr.ContentType]]!==void 0&&ft[QR[wr.ContentType]].push(wr.PartName)}}),ft.xmlns!==Ts.CT)throw new Error("Unknown Namespace: "+ft.xmlns);return ft.calcchain=0<ft.calcchains.length?ft.calcchains[0]:"",ft.sst=0<ft.strs.length?ft.strs[0]:"",ft.style=0<ft.styles.length?ft.styles[0]:"",ft.defaults=Qt,delete ft.calcchains,ft}(Br(a,"[Content_Types].xml")),Pe=!1;if(p.workbooks.length===0&&Er(a,m="xl/workbook.xml",!0)&&p.workbooks.push(m),p.workbooks.length===0){if(!Er(a,m="xl/workbook.bin",!0))throw new Error("Could not find workbook");p.workbooks.push(m),Pe=!0}p.workbooks[0].slice(-3)=="bin"&&(Pe=!0);var w={},S={};if(!c.bookSheets&&!c.bookProps){if(fv=[],p.sst)try{fv=vie(Er(a,yl(p.sst)),p.sst,c)}catch(Tt){if(c.WTF)throw Tt}c.cellStyles&&p.themes.length&&(U=Br(a,p.themes[0].replace(/^\//,""),!0)||"",p.themes[0],w=T8(U,c)),p.style&&(S=pie(Er(a,yl(p.style)),p.style,w,c))}p.links.map(function(Tt){try{return Z1(Br(a,Q1(yl(Tt))),Tt),Cie(Er(a,yl(Tt)),0,Tt,c)}catch{}});var b,T,P,M=die(Er(a,yl(p.workbooks[0])),p.workbooks[0],c),N={},U="";p.coreprops.length&&((U=Er(a,yl(p.coreprops[0]),!0))&&(N=z5(U)),p.extprops.length!==0&&(U=Er(a,yl(p.extprops[0]),!0))&&(B=c,P={},T=(T=N)||{},b=Qn(b=U),qd.forEach(function(Tt){var ft=(b.match(z1(Tt[0]))||[])[1];switch(Tt[2]){case"string":ft&&(T[Tt[1]]=Sn(ft));break;case"bool":T[Tt[1]]=ft==="true";break;case"raw":var Qt=b.match(new RegExp("<"+Tt[0]+"[^>]*>([\\s\\S]*?)</"+Tt[0]+">"));Qt&&0<Qt.length&&(P[Tt[1]]=Qt[1])}}),P.HeadingPairs&&P.TitlesOfParts&&K5(P.HeadingPairs,P.TitlesOfParts,T,B)));var B={};c.bookSheets&&!c.bookProps||p.custprops.length!==0&&(U=Br(a,yl(p.custprops[0]),!0))&&(B=function(Tt,ft){var Qt={},sr="",wr=Tt.match(gre);if(wr)for(var Gr=0;Gr!=wr.length;++Gr){var Yt=wr[Gr],wt=Pr(Yt);switch(wt[0]){case"<?xml":case"<Properties":break;case"<property":sr=Sn(wt.name);break;case"</property>":sr=null;break;default:if(Yt.indexOf("<vt:")===0){var Mr=Yt.split(">"),fn=Mr[0].slice(4),rn=Mr[1];switch(fn){case"lpstr":case"bstr":case"lpwstr":Qt[sr]=Sn(rn);break;case"bool":Qt[sr]=di(rn);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":Qt[sr]=parseInt(rn,10);break;case"r4":case"r8":case"decimal":Qt[sr]=parseFloat(rn);break;case"filetime":case"date":Qt[sr]=ue(rn);break;case"cy":case"error":Qt[sr]=Sn(rn);break;default:if(fn.slice(-1)=="/")break;ft.WTF&&typeof console<"u"&&console.warn("Unexpected",Yt,fn,Mr)}}else if(Yt.slice(0,2)!=="</"&&ft.WTF)throw new Error(Yt)}}return Qt}(U,c));var Z={};if((c.bookSheets||c.bookProps)&&(M.Sheets?f=M.Sheets.map(function(Tt){return Tt.name}):N.Worksheets&&0<N.SheetNames.length&&(f=N.SheetNames),c.bookProps&&(Z.Props=N,Z.Custprops=B),c.bookSheets&&f!==void 0&&(Z.SheetNames=f),c.bookSheets?Z.SheetNames:c.bookProps))return Z;f={},U={},c.bookDeps&&p.calcchain&&(U=yie(Er(a,yl(p.calcchain)),p.calcchain));var G,W,J=0,ne={},se=M.Sheets;N.Worksheets=se.length,N.SheetNames=[];for(var be=0;be!=se.length;++be)N.SheetNames[be]=se[be].name;var De=Pe?"bin":"xml",Pe=p.workbooks[0].lastIndexOf("/"),je=(p.workbooks[0].slice(0,Pe+1)+"_rels/"+p.workbooks[0].slice(Pe+1)+".rels").replace(/^\//,"");vt(a,je)||(je="xl/_rels/workbook."+De+".rels");var it,st,Ke,yt=Z1(Br(a,je,!0),je.replace(/_rels.*/,"s5s"));1<=(p.metadata||[]).length&&(c.xlmeta=Sie(Er(a,yl(p.metadata[0])),p.metadata[0],c)),1<=(p.people||[]).length&&(c.people=(Pe=Er(a,yl(p.people[0])),it=c,Ke=!(st=[]),Pe.replace(po,function(Tt){var ft=Pr(Tt);switch(Yc(ft[0])){case"<?xml":case"<personList":case"</personList>":break;case"<person":st.push({name:ft.displayname,id:ft.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":Ke=!0;break;case"</ext>":Ke=!1;break;default:if(!Ke&&it.WTF)throw new Error("unrecognized "+ft[0]+" in threaded comments")}return Tt}),st)),yt=yt&&Kie(yt,M.Sheets);var Wt=Er(a,"xl/worksheets/sheet.xml",!0)?1:0;e:for(J=0;J!=N.Worksheets;++J){var Ht="sheet";if(yt&&yt[J]?(G="xl/"+yt[J][1].replace(/[\/]?xl\//,""),vt(a,G)||(G=yt[J][1]),vt(a,G)||(G=je.replace(/_rels\/.*$/,"")+yt[J][1]),Ht=yt[J][2]):G=(G="xl/worksheets/sheet"+(J+1-Wt)+"."+De).replace(/sheet0\./,"sheet."),W=G.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),c&&c.sheets!=null)switch(typeof c.sheets){case"number":if(J!=c.sheets)continue e;break;case"string":if(N.SheetNames[J].toLowerCase()!=c.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(c.sheets)){for(var At=!1,Pt=0;Pt!=c.sheets.length;++Pt)typeof c.sheets[Pt]=="number"&&c.sheets[Pt]==J&&(At=1),typeof c.sheets[Pt]=="string"&&c.sheets[Pt].toLowerCase()==N.SheetNames[J].toLowerCase()&&(At=1);if(!At)continue e}}Xie(a,G,W,N.SheetNames[J],J,ne,f,Ht,c,M,w,S)}return Z={Directory:p,Workbook:M,Props:N,Custprops:B,Deps:U,Sheets:f,SheetNames:N.SheetNames,Strings:fv,Styles:S,Themes:w,SSF:ke(D)},c&&c.bookFiles&&(a.files?(Z.keys=v,Z.files=a.files):(Z.keys=[],Z.files={},a.FullPaths.forEach(function(Tt,ft){Tt=Tt.replace(/^Root Entry[\/]/,""),Z.keys.push(Tt),Z.files[Tt]=a.FileIndex[ft]}))),c&&c.bookVBA&&(0<p.vba.length?Z.vbaraw=Er(a,yl(p.vba[0]),!0):p.defaults&&p.defaults.bin===pne&&(Z.vbaraw=Er(a,"xl/vbaProject.bin",!0))),Z}function qie(a,c){var u,f=c||{},m="Workbook",v=Zt.find(a,m);try{if(m="/!DataSpaces/Version",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(p=v.content,(u={}).id=p.read_shift(0,"lpp4"),u.R=sh(p,4),u.U=sh(p,4),u.W=sh(p,4),m="/!DataSpaces/DataSpaceMap",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);var p=Vre(v.content);if(p.length!==1||p[0].comps.length!==1||p[0].comps[0].t!==0||p[0].name!=="StrongEncryptionDataSpace"||p[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+m);if(m="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(p=function(w){var S=[];w.l+=4;for(var b=w.read_shift(4);0<b--;)S.push(w.read_shift(0,"lpp4"));return S}(v.content),p.length!=1||p[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+m);if(m="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);Wre(v.content)}catch{}if(m="/EncryptionInfo",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(c=jre(v.content),m="/EncryptedPackage",!(v=Zt.find(a,m))||!v.content)throw new Error("ECMA-376 Encrypted file missing "+m);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],v.content,f.password||"",f);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],v.content,f.password||"",f);throw new Error("File is password-protected")}function Jie(a,c){return(c.bookType=="ods"?RH:c.bookType=="numbers"?Yie:c.bookType=="xlsb"?function(u,f){dm=1024,u&&!u.SSF&&(u.SSF=ke(D)),u&&u.SSF&&(ot(),Ve(u.SSF),f.revssf=eh(u.SSF),f.revssf[u.SSF[65535]]=0,f.ssf=u.SSF),f.rels={},f.wbrels={},f.Strings=[],f.Strings.Count=0,f.Strings.Unique=0,dv?f.revStrings=new Map:(f.revStrings={},f.revStrings.foo=[],delete f.revStrings.foo);var m=f.bookType=="xlsb"?"bin":"xml",v=-1<I8.indexOf(f.bookType),p=ZR();kA(f=f||{});var w=dl(),S="",b=0;if(f.cellXfs=[],bf(f.cellXfs,{},{revssf:{General:0}}),u.Props||(u.Props={}),Ir(w,S="docProps/core.xml",G5(u.Props,f)),p.coreprops.push(S),Vn(f.rels,2,S,zr.CORE_PROPS),S="docProps/app.xml",!u.Props||!u.Props.SheetNames)if(u.Workbook&&u.Workbook.Sheets){for(var T=[],P=0;P<u.SheetNames.length;++P)(u.Workbook.Sheets[P]||{}).Hidden!=2&&T.push(u.SheetNames[P]);u.Props.SheetNames=T}else u.Props.SheetNames=u.SheetNames;for(u.Props.Worksheets=u.Props.SheetNames.length,Ir(w,S,X5(u.Props)),p.extprops.push(S),Vn(f.rels,3,S,zr.EXT_PROPS),u.Custprops!==u.Props&&0<ai(u.Custprops||{}).length&&(Ir(w,S="docProps/custom.xml",q5(u.Custprops)),p.custprops.push(S),Vn(f.rels,4,S,zr.CUST_PROPS)),b=1;b<=u.SheetNames.length;++b){var M,N,U,B={"!id":{}},Z=u.Sheets[u.SheetNames[b-1]];Ir(w,S="xl/worksheets/sheet"+b+"."+m,function(G,W,J,ne,se){return(W.slice(-4)===".bin"?rie:eH)(G,J,ne,se)}(b-1,S,f,u,B)),p.sheets.push(S),Vn(f.wbrels,-1,"worksheets/sheet"+b+"."+m,zr.WS[0]),Z&&(M=Z["!comments"],N=!1,U="",M&&0<M.length&&(Ir(w,U="xl/comments"+b+"."+m,function(G,W,J){return(W.slice(-4)===".bin"?mne:O8)(G)}(M,U)),p.comments.push(U),Vn(B,-1,"../comments"+b+"."+m,zr.CMNT),N=!0),Z["!legacy"]&&N&&Ir(w,"xl/drawings/vmlDrawing"+b+".vml",R8(b,Z["!comments"])),delete Z["!comments"],delete Z["!legacy"]),B["!id"].rId1&&Ir(w,Q1(S),lm(B))}return f.Strings!=null&&0<f.Strings.length&&(Ir(w,S="xl/sharedStrings."+m,function(G,W,J){return(W.slice(-4)===".bin"?Bre:s8)(G,J)}(f.Strings,S,f)),p.strs.push(S),Vn(f.wbrels,-1,"sharedStrings."+m,zr.SST)),Ir(w,S="xl/workbook."+m,function(G,W,J){return(W.slice(-4)===".bin"?fie:lH)(G)}(u,S)),p.workbooks.push(S),Vn(f.rels,1,S,zr.WB),Ir(w,S="xl/theme/theme1.xml",pA(u.Themes,f)),p.themes.push(S),Vn(f.wbrels,-1,"theme/theme1.xml",zr.THEME),Ir(w,S="xl/styles."+m,function(G,W,J){return(W.slice(-4)===".bin"?nne:S8)(G,J)}(u,S,f)),p.styles.push(S),Vn(f.wbrels,-1,"styles."+m,zr.STY),u.vbaraw&&v&&(Ir(w,S="xl/vbaProject.bin",u.vbaraw),p.vba.push(S),Vn(f.wbrels,-1,"vbaProject.bin",zr.VBA)),Ir(w,S="xl/metadata."+m,function(G){return(G.slice(-4)===".bin"?gne:_8)()}(S)),p.metadata.push(S),Vn(f.wbrels,-1,"metadata."+m,zr.XLMETA),Ir(w,"[Content_Types].xml",W5(p,f)),Ir(w,"_rels/.rels",lm(f.rels)),Ir(w,"xl/_rels/workbook."+m+".rels",lm(f.wbrels)),delete f.revssf,delete f.ssf,w}:kH)(a,c)}function kH(a,c){dm=1024,a&&!a.SSF&&(a.SSF=ke(D)),a&&a.SSF&&(ot(),Ve(a.SSF),c.revssf=eh(a.SSF),c.revssf[a.SSF[65535]]=0,c.ssf=a.SSF),c.rels={},c.wbrels={},c.Strings=[],c.Strings.Count=0,c.Strings.Unique=0,dv?c.revStrings=new Map:(c.revStrings={},c.revStrings.foo=[],delete c.revStrings.foo);var u="xml",f=-1<I8.indexOf(c.bookType),m=ZR();kA(c=c||{});var v=dl(),p="",w=0;if(c.cellXfs=[],bf(c.cellXfs,{},{revssf:{General:0}}),a.Props||(a.Props={}),p="docProps/core.xml",Ir(v,p,G5(a.Props,c)),m.coreprops.push(p),Vn(c.rels,2,p,zr.CORE_PROPS),p="docProps/app.xml",!a.Props||!a.Props.SheetNames)if(a.Workbook&&a.Workbook.Sheets){for(var S=[],b=0;b<a.SheetNames.length;++b)(a.Workbook.Sheets[b]||{}).Hidden!=2&&S.push(a.SheetNames[b]);a.Props.SheetNames=S}else a.Props.SheetNames=a.SheetNames;a.Props.Worksheets=a.Props.SheetNames.length,Ir(v,p,X5(a.Props)),m.extprops.push(p),Vn(c.rels,3,p,zr.EXT_PROPS),a.Custprops!==a.Props&&0<ai(a.Custprops||{}).length&&(Ir(v,p="docProps/custom.xml",q5(a.Custprops)),m.custprops.push(p),Vn(c.rels,4,p,zr.CUST_PROPS));var T,P=["SheetJ5"];for(c.tcid=0,w=1;w<=a.SheetNames.length;++w){var M,N,U,B,Z={"!id":{}},G=a.Sheets[a.SheetNames[w-1]];Ir(v,p="xl/worksheets/sheet"+w+"."+u,eH(w-1,c,a,Z)),m.sheets.push(p),Vn(c.wbrels,-1,"worksheets/sheet"+w+"."+u,zr.WS[0]),G&&(N=!1,U="",(M=G["!comments"])&&0<M.length&&(B=!1,M.forEach(function(W){W[1].forEach(function(J){J.T==1&&(B=!0)})}),B&&(Ir(v,U="xl/threadedComments/threadedComment"+w+"."+u,function(W,J,ne){var se=[fi,Nt("ThreadedComments",null,{xmlns:Ts.TCMNT}).replace(/[\/]>/,">")];return W.forEach(function(be){var De="";(be[1]||[]).forEach(function(Pe,je){var it;Pe.T?(Pe.a&&J.indexOf(Pe.a)==-1&&J.push(Pe.a),it={ref:be[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+ne.tcid++).slice(-12)+"}"},je==0?De=it.id:it.parentId=De,Pe.ID=it.id,Pe.a&&(it.personId="{54EE7950-7262-4200-6969-"+("000000000000"+J.indexOf(Pe.a)).slice(-12)+"}"),se.push(Nt("threadedComment",Qs("text",Pe.t||""),it))):delete Pe.ID})}),se.push("</ThreadedComments>"),se.join("")}(M,P,c)),m.threadedcomments.push(U),Vn(Z,-1,"../threadedComments/threadedComment"+w+"."+u,zr.TCMNT)),Ir(v,U="xl/comments"+w+"."+u,O8(M)),m.comments.push(U),Vn(Z,-1,"../comments"+w+"."+u,zr.CMNT),N=!0),G["!legacy"]&&N&&Ir(v,"xl/drawings/vmlDrawing"+w+".vml",R8(w,G["!comments"])),delete G["!comments"],delete G["!legacy"]),Z["!id"].rId1&&Ir(v,Q1(p),lm(Z))}return c.Strings!=null&&0<c.Strings.length&&(Ir(v,p="xl/sharedStrings.xml",s8(c.Strings,c)),m.strs.push(p),Vn(c.wbrels,-1,"sharedStrings.xml",zr.SST)),Ir(v,p="xl/workbook.xml",lH(a)),m.workbooks.push(p),Vn(c.rels,1,p,zr.WB),Ir(v,p="xl/theme/theme1.xml",pA(a.Themes,c)),m.themes.push(p),Vn(c.wbrels,-1,"theme/theme1.xml",zr.THEME),Ir(v,p="xl/styles.xml",S8(a,c)),m.styles.push(p),Vn(c.wbrels,-1,"styles.xml",zr.STY),a.vbaraw&&f&&(Ir(v,p="xl/vbaProject.bin",a.vbaraw),m.vba.push(p),Vn(c.wbrels,-1,"vbaProject.bin",zr.VBA)),Ir(v,p="xl/metadata.xml",_8()),m.metadata.push(p),Vn(c.wbrels,-1,"metadata.xml",zr.XLMETA),1<P.length&&(Ir(v,p="xl/persons/person.xml",(f=P,T=[fi,Nt("personList",null,{xmlns:Ts.TCMNT,"xmlns:x":Ud[0]}).replace(/[\/]>/,">")],f.forEach(function(W,J){T.push(Nt("person",null,{displayName:W,id:"{54EE7950-7262-4200-6969-"+("000000000000"+J).slice(-12)+"}",userId:W,providerId:"None"}))}),T.push("</personList>"),T.join(""))),m.people.push(p),Vn(c.wbrels,-1,"persons/person.xml",zr.PEOPLE)),Ir(v,"[Content_Types].xml",W5(m,c)),Ir(v,"_rels/.rels",lm(c.rels)),Ir(v,"xl/_rels/workbook.xml.rels",lm(c.wbrels)),delete c.revssf,delete c.ssf,v}function NA(a,c){var u="";switch((c||{}).type||"base64"){case"buffer":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];case"base64":u=z(a.slice(0,12));break;case"binary":u=a;break;case"array":return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7]];default:throw new Error("Unrecognized type "+(c&&c.type||"undefined"))}return[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3),u.charCodeAt(4),u.charCodeAt(5),u.charCodeAt(6),u.charCodeAt(7)]}function NH(a,c){var u=0;e:for(;u<a.length;)switch(a.charCodeAt(u)){case 10:case 13:case 32:++u;break;case 60:return RA(a.slice(u),c);default:break e}return cm.to_workbook(a,c)}function DA(a,c,u,f){return f?(u.type="string",cm.to_workbook(a,u)):cm.to_workbook(c,u)}function qS(a,c){C();var u=c||{};if(typeof ArrayBuffer<"u"&&a instanceof ArrayBuffer)return qS(new Uint8Array(a),((u=ke(u)).type="array",u));typeof Uint8Array<"u"&&a instanceof Uint8Array&&!u.type&&(u.type=typeof Deno<"u"?"buffer":"array");var f,m,v,p,w,S=a,b=!1;if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),mm={},u.dateNF&&(mm.dateNF=u.dateNF),u.type||(u.type=q&&Buffer.isBuffer(a)?"buffer":"base64"),u.type=="file"&&(u.type=q?"buffer":"binary",S=function(P){if(Ur!==void 0)return Ur.readFileSync(P);if(typeof Deno<"u")return Deno.readFileSync(P);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var M=File(P);M.open("r"),M.encoding="binary";var N=M.read();return M.close(),N}catch(U){if(!U.message||!U.message.match(/onstruct/))throw U}throw new Error("Cannot access file "+P)}(a),typeof Uint8Array>"u"||q||(u.type="array")),u.type=="string"&&(b=!0,u.type="binary",u.codepage=65001,S=(T=a).match(/[^\x00-\x7F]/)?Kc(T):T),u.type=="array"&&typeof Uint8Array<"u"&&a instanceof Uint8Array&&typeof ArrayBuffer<"u"){var T=new ArrayBuffer(3),T=new Uint8Array(T);if(T.foo="bar",!T.foo)return(u=ke(u)).type="array",qS(Ie(S),u)}switch((f=NA(S,u))[0]){case 208:if(f[1]===207&&f[2]===17&&f[3]===224&&f[4]===161&&f[5]===177&&f[6]===26&&f[7]===225)return p=Zt.read(S,u),w=u,(Zt.find(p,"EncryptedPackage")?qie:XS)(p,w);break;case 9:if(f[1]<=8)return XS(S,u);break;case 60:return RA(S,u);case 73:if(f[1]===73&&f[2]===42&&f[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(f[1]===68)return function(P,M){var N=M||{},U=!!N.WTF;N.WTF=!0;try{var B=DL.to_workbook(P,N);return N.WTF=U,B}catch(Z){if(N.WTF=U,!Z.message.match(/SYLK bad record ID/)&&U)throw Z;return cm.to_workbook(P,M)}}(S,u);break;case 84:if(f[1]===65&&f[2]===66&&f[3]===76)return HL.to_workbook(S,u);break;case 80:return f[1]===75&&f[2]<9&&f[3]<9?(v=w=S,(m=(m=u)||{}).type||(m.type=q&&Buffer.isBuffer(w)?"buffer":"base64"),MH(vf(v,m),m)):DA(a,S,u,b);case 239:return f[3]===60?RA(S,u):DA(a,S,u,b);case 255:if(f[1]===254)return v=S,(m=u).type=="base64"&&(v=z(v)),v=n.utils.decode(1200,v.slice(2),"str"),m.type="binary",NH(v,m);if(f[1]===0&&f[2]===2&&f[3]===0)return e0.to_workbook(S,u);break;case 0:if(f[1]===0&&(2<=f[2]&&f[3]===0||f[2]===0&&(f[3]===8||f[3]===9)))return e0.to_workbook(S,u);break;case 3:case 131:case 139:case 140:return iA.to_workbook(S,u);case 123:if(f[1]===92&&f[2]===114&&f[3]===116)return f8.to_workbook(S,u);break;case 10:case 13:case 32:return function(P,M){var N="",U=NA(P,M);switch(M.type){case"base64":N=z(P);break;case"binary":N=P;break;case"buffer":N=P.toString("binary");break;case"array":N=ve(P);break;default:throw new Error("Unrecognized type "+M.type)}return U[0]==239&&U[1]==187&&U[2]==191&&(N=Qn(N)),M.type="binary",NH(N,M)}(S,u);case 137:if(f[1]===80&&f[2]===78&&f[3]===71)throw new Error("PNG Image File is not a spreadsheet")}return-1<Tre.indexOf(f[0])&&f[2]<=12&&f[3]<=31?iA.to_workbook(S,u):DA(a,S,u,b)}function DH(a,c){return c=c||{},c.type="file",qS(a,c)}function LH(a,c){switch(c.type){case"base64":case"binary":break;case"buffer":case"array":c.type="";break;case"file":return da(c.file,Zt.write(a,{type:q?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");default:throw new Error("Unrecognized type "+c.type)}return Zt.write(a,c)}function HH(a,c){var u={},f=q?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(c.compression&&(u.compression="DEFLATE"),c.password)u.type=f;else switch(c.type){case"base64":u.type="base64";break;case"binary":u.type="string";break;case"string":throw new Error("'string' output type invalid for '"+c.bookType+"' files");case"buffer":case"file":u.type=f;break;default:throw new Error("Unrecognized type "+c.type)}if(a=a.FullPaths?Zt.write(a,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[u.type]||u.type,compression:!!c.compression}):a.generate(u),typeof Deno<"u"&&typeof a=="string"){if(c.type=="binary"||c.type=="base64")return a;a=new Uint8Array(de(a))}return c.password&&typeof encrypt_agile<"u"?LH(encrypt_agile(a,c.password),c):c.type==="file"?da(c.file,a):c.type=="string"?Qn(a):a}function Zc(a,c,u){var f=(u=u||"")+a;switch(c.type){case"base64":return H(Kc(f));case"binary":return Kc(f);case"string":return a;case"file":return da(c.file,f,"utf8");case"buffer":return q?re(f,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(f):Zc(f,{type:"binary"}).split("").map(function(m){return m.charCodeAt(0)})}throw new Error("Unrecognized type "+c.type)}function JS(a,c){switch(c.type){case"string":case"base64":case"binary":for(var u="",f=0;f<a.length;++f)u+=String.fromCharCode(a[f]);return c.type=="base64"?H(u):c.type=="string"?Qn(u):u;case"file":return da(c.file,a);case"buffer":return a;default:throw new Error("Unrecognized type "+c.type)}}function LA(a,c){C(),aH(a);var u,f=ke(c||{});return f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),f.type!="array"?(u=a,c=ke((c=f)||{}),HH(kH(u,c),c)):(f.type="binary",a=LA(a,f),f.type="array",de(a))}function QS(a,c){C(),aH(a);var u=ke(c||{});if(u.cellStyles&&(u.cellNF=!0,u.sheetStubs=!0),u.type=="array")return u.type="binary",c=QS(a,u),u.type="array",de(c);var f,m,v,p=0;if(u.sheet&&(p=typeof u.sheet=="number"?u.sheet:a.SheetNames.indexOf(u.sheet),!a.SheetNames[p]))throw new Error("Sheet not found: "+u.sheet+" : "+typeof u.sheet);switch(u.bookType||"xlsb"){case"xml":case"xlml":return Zc(Rie(a,u),u);case"slk":case"sylk":return Zc(DL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"htm":case"html":return Zc(wH(a.Sheets[a.SheetNames[p]],u),u);case"txt":return function(w,S){switch(S.type){case"base64":return H(w);case"binary":case"string":return w;case"file":return da(S.file,w,"binary");case"buffer":return q?re(w,"binary"):w.split("").map(function(b){return b.charCodeAt(0)})}throw new Error("Unrecognized type "+S.type)}(jH(a.Sheets[a.SheetNames[p]],u),u);case"csv":return Zc($A(a.Sheets[a.SheetNames[p]],u),u,"\uFEFF");case"dif":return Zc(HL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"dbf":return JS(iA.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"prn":return Zc(cm.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"rtf":return Zc(f8.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"eth":return Zc(jL.from_sheet(a.Sheets[a.SheetNames[p]],u),u);case"fods":return Zc(RH(a,u),u);case"wk1":return JS(e0.sheet_to_wk1(a.Sheets[a.SheetNames[p]],u),u);case"wk3":return JS(e0.book_to_wk3(a,u),u);case"biff2":u.biff||(u.biff=2);case"biff3":u.biff||(u.biff=3);case"biff4":return u.biff||(u.biff=4),JS(fH(a,u),u);case"biff5":u.biff||(u.biff=5);case"biff8":case"xla":case"xls":return u.biff||(u.biff=8),LH(Pie(a,v=(v=u)||{}),v);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return f=a,v=ke((m=u)||{}),av=new Qie(m),HH(Jie(f,v),v);default:throw new Error("Unrecognized bookType |"+u.bookType+"|")}}function HA(a){var c;a.bookType||((c=a.file.slice(a.file.lastIndexOf(".")).toLowerCase()).match(/^\.[a-z]+$/)&&(a.bookType=c.slice(1)),a.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[a.bookType]||a.bookType)}function $H(a,c,u){return u=u||{},u.type="file",u.file=c,HA(u),QS(a,u)}function BH(a,c,u,f,m,v,p,w){var S=Ui(u),b=w.defval,T=w.raw||!Object.prototype.hasOwnProperty.call(w,"raw"),P=!0,M=m===1?[]:{};if(m!==1)if(Object.defineProperty)try{Object.defineProperty(M,"__rowNum__",{value:u,enumerable:!1})}catch{M.__rowNum__=u}else M.__rowNum__=u;if(!p||a[u])for(var N=c.s.c;N<=c.e.c;++N){var U=p?a[u][N]:a[f[N]+S];if(U!==void 0&&U.t!==void 0){var B=U.v;switch(U.t){case"z":if(B==null)break;continue;case"e":B=B==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+U.t)}if(v[N]!=null){if(B==null)if(U.t=="e"&&B===null)M[v[N]]=null;else if(b!==void 0)M[v[N]]=b;else{if(!T||B!==null)continue;M[v[N]]=null}else M[v[N]]=T&&(U.t!=="n"||U.t==="n"&&w.rawNumbers!==!1)?B:Xc(U,B,w);B!=null&&(P=!1)}}else b!==void 0&&v[N]!=null&&(M[v[N]]=b)}return{row:M,isempty:P}}function ZS(a,c){if(a==null||a["!ref"]==null)return[];var u,f={t:"n",v:0},m=0,v=1,p=[],w="",S={s:{r:0,c:0},e:{r:0,c:0}},b=c||{},T=b.range!=null?b.range:a["!ref"];switch(b.header===1?m=1:b.header==="A"?m=2:Array.isArray(b.header)?m=3:b.header==null&&(m=0),typeof T){case"string":S=un(T);break;case"number":(S=un(a["!ref"])).s.r=T;break;default:S=T}0<m&&(v=0);var P=Ui(S.s.r),M=[],N=[],U=0,B=0,Z=Array.isArray(a),G=S.s.r,W=0,J={};Z&&!a[G]&&(a[G]=[]);for(var ne,se=b.skipHidden&&a["!cols"]||[],be=b.skipHidden&&a["!rows"]||[],W=S.s.c;W<=S.e.c;++W)if(!(se[W]||{}).hidden)switch(M[W]=gi(W),f=Z?a[G][W]:a[M[W]+P],m){case 1:p[W]=W-S.s.c;break;case 2:p[W]=M[W];break;case 3:p[W]=b.header[W-S.s.c];break;default:if(w=u=Xc(f=f??{w:"__EMPTY",t:"s"},null,b),B=J[u]||0){for(;w=u+"_"+B++,J[w];);J[u]=B,J[w]=1}else J[u]=1;p[W]=w}for(G=S.s.r+v;G<=S.e.r;++G)(be[G]||{}).hidden||(ne=BH(a,S,G,M,m,p,Z,b)).isempty!==!1&&(m===1?b.blankrows===!1:!b.blankrows)||(N[U++]=ne.row);return N.length=U,N}var VH=/"/g;function WH(a,c,u,f,m,v,p,w){for(var S=!0,b=[],T="",P=Ui(u),M=c.s.c;M<=c.e.c;++M)if(f[M]){var N=w.dense?(a[u]||[])[M]:a[f[M]+P];if(N==null)T="";else if(N.v!=null){S=!1,T=""+(w.rawNumbers&&N.t=="n"?N.v:Xc(N,null,w));for(var U,B=0;B!==T.length;++B)if((U=T.charCodeAt(B))===m||U===v||U===34||w.forceQuotes){T='"'+T.replace(VH,'""')+'"';break}T=="ID"&&(T='"ID"')}else N.f==null||N.F?T="":(S=!1,0<=(T="="+N.f).indexOf(",")&&(T='"'+T.replace(VH,'""')+'"'));b.push(T)}return w.blankrows===!1&&S?null:b.join(p)}function $A(a,c){var u=[],f=c??{};if(a==null||a["!ref"]==null)return"";var m=un(a["!ref"]),v=f.FS!==void 0?f.FS:",",p=v.charCodeAt(0),w=f.RS!==void 0?f.RS:`
`,S=w.charCodeAt(0),b=new RegExp((v=="|"?"\\|":v)+"+$"),T="",P=[];f.dense=Array.isArray(a);for(var M=f.skipHidden&&a["!cols"]||[],N=f.skipHidden&&a["!rows"]||[],U=m.s.c;U<=m.e.c;++U)(M[U]||{}).hidden||(P[U]=gi(U));for(var B=0,Z=m.s.r;Z<=m.e.r;++Z)(N[Z]||{}).hidden||(T=WH(a,m,Z,P,p,S,v,f))!=null&&(!(T=f.strip?T.replace(b,""):T)&&f.blankrows===!1||u.push((B++?w:"")+T));return delete f.dense,u.join("")}function jH(a,c){return(c=c||{}).FS="	",c.RS=`
`,a=$A(a,c),n===void 0||c.type=="string"?a:(a=n.utils.encode(1200,a,"str"),""+a)}function UH(T,c,u){var f,m=u||{},v=+!m.skipHeader,p=T||{},w=0,S=0;m.origin!=null&&(typeof m.origin=="number"?w=m.origin:(b=typeof m.origin=="string"?Ii(m.origin):m.origin,w=b.r,S=b.c));var b,T={s:{c:0,r:0},e:{c:S,r:w+c.length-1+v}};p["!ref"]?(b=un(p["!ref"]),T.e.c=Math.max(T.e.c,b.e.c),T.e.r=Math.max(T.e.r,b.e.r),w==-1&&(w=b.e.r+1,T.e.r=w+c.length-1+v)):w==-1&&(w=0,T.e.r=c.length-1+v);var P=m.header||[],M=0;c.forEach(function(U,B){ai(U).forEach(function(ne){(M=P.indexOf(ne))==-1&&(P[M=P.length]=ne);var G=U[ne],W="z",J="",ne=Fr({c:S+M,r:w+B+v});f=eb(p,ne),!G||typeof G!="object"||G instanceof Date?(typeof G=="number"?W="n":typeof G=="boolean"?W="b":typeof G=="string"?W="s":G instanceof Date?(W="d",m.cellDates||(W="n",G=hi(G)),J=m.dateNF||D[14]):G===null&&m.nullError&&(W="e",G=0),f?(f.t=W,f.v=G,delete f.w,delete f.R,J&&(f.z=J)):p[ne]=f={t:W,v:G},J&&(f.z=J)):p[ne]=G})}),T.e.c=Math.max(T.e.c,S+P.length-1);var N=Ui(w);if(v)for(M=0;M<P.length;++M)p[gi(M+S)+N]={t:"s",v:P[M]};return p["!ref"]=Wr(T),p}function eb(a,c,u){return typeof c!="string"?eb(a,Fr(typeof c!="number"?c:{r:c,c:u||0})):Array.isArray(a)?(u=Ii(c),a[u.r]||(a[u.r]=[]),a[u.r][u.c]||(a[u.r][u.c]={t:"z"})):a[c]||(a[c]={t:"z"})}function BA(){return{SheetNames:[],Sheets:{}}}function VA(a,c,u,f){var m=1;if(!u)for(;m<=65535&&a.SheetNames.indexOf(u="Sheet"+m)!=-1;++m,u=void 0);if(!u||65535<=a.SheetNames.length)throw new Error("Too many worksheets");if(f&&0<=a.SheetNames.indexOf(u)){var f=u.match(/(^.*?)(\d+)$/),m=f&&+f[2]||0,v=f&&f[1]||u;for(++m;m<=65535&&a.SheetNames.indexOf(u=v+m)!=-1;++m);}if(oH(u),0<=a.SheetNames.indexOf(u))throw new Error("Worksheet with name |"+u+"| already exists!");return a.SheetNames.push(u),a.Sheets[u]=c,u}function zH(a,c,u){return c?(a.l={Target:c},u&&(a.l.Tooltip=u)):delete a.l,a}var tb,WA={encode_col:gi,encode_row:Ui,encode_cell:Fr,encode_range:Wr,decode_col:jR,decode_row:WR,split_cell:function(a){return a.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Ii,decode_range:Vo,format_cell:Xc,sheet_add_aoa:M5,sheet_add_json:UH,sheet_add_dom:yH,aoa_to_sheet:sm,json_to_sheet:function(a,c){return UH(null,a,c)},table_to_sheet:CH,table_to_book:function(a,c){return wf(CH(a,c),c)},sheet_to_csv:$A,sheet_to_txt:jH,sheet_to_json:ZS,sheet_to_html:wH,sheet_to_formulae:function(a){var c,u="",f="";if(a==null||a["!ref"]==null)return[];for(var m,v=un(a["!ref"]),p=[],w=[],S=Array.isArray(a),b=v.s.c;b<=v.e.c;++b)p[b]=gi(b);for(var T=v.s.r;T<=v.e.r;++T)for(m=Ui(T),b=v.s.c;b<=v.e.c;++b)if(u=p[b]+m,f="",(c=S?(a[T]||[])[b]:a[u])!==void 0){if(c.F!=null){if(u=c.F,!c.f)continue;f=c.f,u.indexOf(":")==-1&&(u=u+":"+u)}if(c.f!=null)f=c.f;else{if(c.t=="z")continue;if(c.t=="n"&&c.v!=null)f=""+c.v;else if(c.t=="b")f=c.v?"TRUE":"FALSE";else if(c.w!==void 0)f="'"+c.w;else{if(c.v===void 0)continue;f=c.t=="s"?"'"+c.v:""+c.v}}w[w.length]=u+"="+f}return w},sheet_to_row_object_array:ZS,sheet_get_cell:eb,book_new:BA,book_append_sheet:VA,book_set_sheet_visibility:function(a,c,u){switch(a.Workbook||(a.Workbook={}),a.Workbook.Sheets||(a.Workbook.Sheets=[]),c=function(f,m){if(typeof m=="number"){if(0<=m&&f.SheetNames.length>m)return m;throw new Error("Cannot find sheet # "+m)}if(typeof m!="string")throw new Error("Cannot find sheet |"+m+"|");if(-1<(f=f.SheetNames.indexOf(m)))return f;throw new Error("Cannot find sheet name |"+m+"|")}(a,c),a.Workbook.Sheets[c]||(a.Workbook.Sheets[c]={}),u){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+u)}a.Workbook.Sheets[c].Hidden=u},cell_set_number_format:function(a,c){return a.z=c,a},cell_set_hyperlink:zH,cell_set_internal_link:function(a,c,u){return zH(a,"#"+c,u)},cell_add_comment:function(a,c,u){a.c||(a.c=[]),a.c.push({t:c,a:u||"SheetJS"})},sheet_set_array_formula:function(a,c,u,f){for(var m=typeof c!="string"?c:un(c),v=typeof c=="string"?c:Wr(c),p=m.s.r;p<=m.e.r;++p)for(var w=m.s.c;w<=m.e.c;++w){var S=eb(a,p,w);S.t="n",S.F=v,delete S.v,p==m.s.r&&w==m.s.c&&(S.f=u,f&&(S.D=!0))}return a},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function GH(a){tb=a}var vm={to_json:function(a,c){var u=tb({objectMode:!0});if(a==null||a["!ref"]==null)return u.push(null),u;var f,m={t:"n",v:0},v=0,p=1,w=[],S="",b={s:{r:0,c:0},e:{r:0,c:0}},T=c||{},P=T.range!=null?T.range:a["!ref"];switch(T.header===1?v=1:T.header==="A"?v=2:Array.isArray(T.header)&&(v=3),typeof P){case"string":b=un(P);break;case"number":(b=un(a["!ref"])).s.r=P;break;default:b=P}0<v&&(p=0);var M=Ui(b.s.r),N=[],U=0,B=Array.isArray(a),Z=b.s.r,G=0,W={};B&&!a[Z]&&(a[Z]=[]);for(var J=T.skipHidden&&a["!cols"]||[],ne=T.skipHidden&&a["!rows"]||[],G=b.s.c;G<=b.e.c;++G)if(!(J[G]||{}).hidden)switch(N[G]=gi(G),m=B?a[Z][G]:a[N[G]+M],v){case 1:w[G]=G-b.s.c;break;case 2:w[G]=N[G];break;case 3:w[G]=T.header[G-b.s.c];break;default:if(S=f=Xc(m=m??{w:"__EMPTY",t:"s"},null,T),U=W[f]||0){for(;S=f+"_"+U++,W[S];);W[f]=U,W[S]=1}else W[f]=1;w[G]=S}return Z=b.s.r+p,u._read=function(){for(;Z<=b.e.r;)if(!(ne[Z-1]||{}).hidden){var se=BH(a,b,Z,N,v,w,B,T);if(++Z,se.isempty===!1||(v===1?T.blankrows!==!1:T.blankrows))return void u.push(se.row)}return u.push(null)},u},to_html:function(a,m){var u=tb(),f=m||{},m=f.header!=null?f.header:mH,v=f.footer!=null?f.footer:pH;u.push(m);var p=Vo(a["!ref"]);f.dense=Array.isArray(a),u.push(vH(0,0,f));var w=p.s.r,S=!1;return u._read=function(){if(w>p.e.r)return S||(S=!0,u.push("</table>"+v)),u.push(null);for(;w<=p.e.r;){u.push(gH(a,p,w,f)),++w;break}},u},to_csv:function(a,c){var u=tb(),f=c??{};if(a==null||a["!ref"]==null)return u.push(null),u;var m=un(a["!ref"]),v=f.FS!==void 0?f.FS:",",p=v.charCodeAt(0),w=f.RS!==void 0?f.RS:`
`,S=w.charCodeAt(0),b=new RegExp((v=="|"?"\\|":v)+"+$"),T="",P=[];f.dense=Array.isArray(a);for(var M=f.skipHidden&&a["!cols"]||[],N=f.skipHidden&&a["!rows"]||[],U=m.s.c;U<=m.e.c;++U)(M[U]||{}).hidden||(P[U]=gi(U));var B=m.s.r,Z=!1,G=0;return u._read=function(){if(!Z)return Z=!0,u.push("\uFEFF");for(;B<=m.e.r;)if(++B,!(N[B-1]||{}).hidden&&(T=WH(a,m,B-1,P,p,S,v,f),T!=null&&((T=f.strip?T.replace(b,""):T)||f.blankrows!==!1)))return u.push((G++?w:"")+T);return u.push(null)},u},set_readable:GH},pn=function(){function a(c,u,f){return this instanceof a?(this.tagName=c,this._attributes=u||{},this._children=f||[],this._prefix="",this):new a(c,u,f)}return a.prototype.createElement=function(){return new a(arguments)},a.prototype.children=function(){return this._children},a.prototype.append=function(c){return this._children.push(c),this},a.prototype.prefix=function(c){return arguments.length==0?this._prefix:(this._prefix=c,this)},a.prototype.attr=function(c,u){if(u==null)return delete this._attributes[c],this;if(arguments.length==0)return this._attributes;if(typeof c=="string"&&arguments.length==1)return this._attributes.attr[c];if(typeof c=="object"&&arguments.length==1)for(var f in c)this._attributes[f]=c[f];else arguments.length==2&&typeof c=="string"&&(this._attributes[c]=u);return this},a.prototype.escapeAttributeValue=function(c){return'"'+c.replace(/\"/g,"&quot;")+'"'},a.prototype.toXml=function(c){var u=(c=c||this)._prefix;if(u+="<"+c.tagName,c._attributes)for(var f in c._attributes)u+=" "+f+"="+this.escapeAttributeValue(""+c._attributes[f]);if(c._children&&0<c._children.length){u+=">";for(var m=0;m<c._children.length;m++)u+=this.toXml(c._children[m]);u+="</"+c.tagName+">"}else u+="/>";return u},a}(),Qie=function(a){var c,u=164,f={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},m={};for(c in f)m[f[c]]=c;var v={};return{initialize:function(p){this.$fonts=pn("fonts").attr("count",0).attr("x14ac:knownFonts","1"),this.$fills=pn("fills").attr("count",0),this.$borders=pn("borders").attr("count",0),this.$numFmts=pn("numFmts").attr("count",0),this.$cellStyleXfs=pn("cellStyleXfs"),this.$xf=pn("xf").attr("numFmtId",0).attr("fontId",0).attr("fillId",0).attr("borderId",0),this.$cellXfs=pn("cellXfs").attr("count",0),this.$cellStyles=pn("cellStyles").append(pn("cellStyle").attr("name","Normal").attr("xfId",0).attr("builtinId",0)),this.$dxfs=pn("dxfs").attr("count","0"),this.$tableStyles=pn("tableStyles").attr("count","0").attr("defaultTableStyle","TableStyleMedium9").attr("defaultPivotStyle","PivotStyleMedium4"),this.$styles=pn("styleSheet").attr("xmlns:mc","http://schemas.openxmlformats.org/markup-compatibility/2006").attr("xmlns:x14ac","http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac").attr("xmlns","http://schemas.openxmlformats.org/spreadsheetml/2006/main").attr("mc:Ignorable","x14ac").prefix('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>').append(this.$numFmts).append(this.$fonts).append(this.$fills).append(this.$borders).append(this.$cellStyleXfs.append(this.$xf)).append(this.$cellXfs).append(this.$cellStyles).append(this.$dxfs).append(this.$tableStyles);var w=p.defaultCellStyle||{};return w.font||(w.font={name:"Calibri",sz:"11"}),w.font.name||(w.font.name="Calibri"),w.font.sz||(w.font.sz=11),w.fill||(w.fill={patternType:"none",fgColor:{}}),w.border||(w.border={}),w.numFmt||(w.numFmt=0),this.defaultStyle=w,p=JSON.parse(JSON.stringify(w)),p.fill={patternType:"gray125",fgColor:{}},this.addStyles([w,p]),this},addStyle:function(p){var w=JSON.stringify(p),S=v[w];return S==null?(S=this._addXf(p),v[w]=S):S=v[w],S},addStyles:function(p){var w=this;return p.map(function(S){return w.addStyle(S)})},_duckTypeStyle:function(p){return typeof p=="object"&&(p.patternFill||p.fgColor)?{fill:p}:p.font||p.numFmt||p.border||p.fill?p:this._getStyleCSS(p)},_getStyleCSS:function(p){return p},_addXf:function(p){var w=this._addFont(p.font),S=this._addFill(p.fill),b=this._addBorder(p.border),T=this._addNumFmt(p.numFmt),P=pn("xf").attr("numFmtId",T).attr("fontId",w).attr("fillId",S).attr("borderId",b).attr("xfId","0");return 0<w&&P.attr("applyFont","1"),0<S&&P.attr("applyFill","1"),0<b&&P.attr("applyBorder","1"),0<T&&P.attr("applyNumberFormat","1"),p.alignment&&(T=pn("alignment"),p.alignment.horizontal&&T.attr("horizontal",p.alignment.horizontal),p.alignment.vertical&&T.attr("vertical",p.alignment.vertical),p.alignment.indent&&T.attr("indent",p.alignment.indent),p.alignment.readingOrder&&T.attr("readingOrder",p.alignment.readingOrder),p.alignment.wrapText&&T.attr("wrapText",p.alignment.wrapText),p.alignment.textRotation!=null&&T.attr("textRotation",p.alignment.textRotation),P.append(T).attr("applyAlignment",1)),this.$cellXfs.append(P),P=+this.$cellXfs.children().length,this.$cellXfs.attr("count",P),P-1},_addFont:function(p){if(!p)return 0;var w=pn("font").append(pn("sz").attr("val",p.sz||this.defaultStyle.font.sz)).append(pn("name").attr("val",p.name||this.defaultStyle.font.name));return p.bold&&w.append(pn("b")),p.underline&&w.append(pn("u")),p.italic&&w.append(pn("i")),p.strike&&w.append(pn("strike")),p.outline&&w.append(pn("outline")),p.shadow&&w.append(pn("shadow")),p.vertAlign&&w.append(pn("vertAlign").attr("val",p.vertAlign)),p.color&&(p.color.theme?(w.append(pn("color").attr("theme",p.color.theme)),p.color.tint&&w.append(pn("tint").attr("theme",p.color.tint))):p.color.rgb&&w.append(pn("color").attr("rgb",p.color.rgb))),this.$fonts.append(w),w=this.$fonts.children().length,this.$fonts.attr("count",w),w-1},_addNumFmt:function(p){if(!p)return 0;if(typeof p=="string"){var w=m[p];if(0<=w)return w}return/^[0-9]+$/.exec(p)?p:(p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),p=pn("numFmt").attr("numFmtId",++u).attr("formatCode",p),this.$numFmts.append(p),p=this.$numFmts.children().length,this.$numFmts.attr("count",p),u)},_addFill:function(p){if(!p)return 0;var w,S=pn("patternFill").attr("patternType",p.patternType||"solid");return p.fgColor&&(w=pn("fgColor"),p.fgColor.rgb?(p.fgColor.rgb.length==6&&(p.fgColor.rgb="FF"+p.fgColor.rgb),w.attr("rgb",p.fgColor.rgb),S.append(w)):p.fgColor.theme&&(w.attr("theme",p.fgColor.theme),p.fgColor.tint&&w.attr("tint",p.fgColor.tint),S.append(w)),p.bgColor||(p.bgColor={indexed:"64"})),p.bgColor&&(p=pn("bgColor").attr(p.bgColor),S.append(p)),S=pn("fill").append(S),this.$fills.append(S),S=this.$fills.children().length,this.$fills.attr("count",S),S-1},_getSubBorder:function(p,w){var S=pn(p);return w&&(S.attr("style",w.style||"medium"),w.color&&(p=pn("color"),w.color.auto?p.attr("auto",w.color.auto):w.color.rgb?p.attr("rgb",w.color.rgb):(w.color.theme||w.color.tint)&&(p.attr("theme",w.color.theme||"1"),p.attr("tint",w.color.tint||"0")),S.append(p))),S},_addBorder:function(p){if(!p)return 0;var w=this,S=pn("border").attr("diagonalUp",p.diagonalUp).attr("diagonalDown",p.diagonalDown);["left","right","top","bottom","diagonal"].forEach(function(T){S.append(w._getSubBorder(T,p[T]))}),this.$borders.append(S);var b=this.$borders.children().length;return this.$borders.attr("count",b),b-1},toXml:function(){return this.$styles.toXml()}}.initialize(a||{})};XS!==void 0&&(s.parse_xlscfb=XS),s.parse_zip=MH,s.read=qS,s.readFile=DH,s.readFileSync=DH,s.write=QS,s.writeFile=$H,s.writeFileSync=$H,s.writeFileAsync=function(a,c,u,f){var m=u||{};return m.type="file",m.file=a,HA(m),m.type="buffer",f instanceof Function||(f=u),Ur.writeFile(a,QS(c,m),f)},s.utils=WA,s.writeXLSX=LA,s.writeFileXLSX=function(a,c,u){return(u=u||{}).type="file",u.file=c,HA(u),LA(a,u)},s.SSF=It,vm!==void 0&&(s.stream=vm),Zt!==void 0&&(s.CFB=Zt),typeof O2>"u"||((vm=w4)||{}).Readable&&GH(vm.Readable)}if(i(e),typeof window<"u"&&!window.XLSX)try{window.XLSX=r}catch{}})(xP,xP.exports);var wce=xP.exports;const Tf=JF(wce);var Rv=function(t){return t&&t.Math===Math&&t},Ns=Rv(typeof globalThis=="object"&&globalThis)||Rv(typeof window=="object"&&window)||Rv(typeof self=="object"&&self)||Rv(typeof kw=="object"&&kw)||Rv(typeof kw=="object"&&kw)||function(){return this}()||Function("return this")(),XM={},go=function(t){try{return!!t()}catch{return!0}},yce=go,Yl=!yce(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Cce=go,v_=!Cce(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Sce=v_,yb=Function.prototype.call,$o=Sce?yb.bind(yb):function(){return yb.apply(yb,arguments)},mY={},pY={}.propertyIsEnumerable,vY=Object.getOwnPropertyDescriptor,bce=vY&&!pY.call({1:2},1);mY.f=bce?function(e){var r=vY(this,e);return!!r&&r.enumerable}:pY;var w_=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},wY=v_,yY=Function.prototype,EP=yY.call,xce=wY&&yY.bind.bind(EP,EP),ls=wY?xce:function(t){return function(){return EP.apply(t,arguments)}},CY=ls,Ece=CY({}.toString),Tce=CY("".slice),jg=function(t){return Tce(Ece(t),8,-1)},_ce=ls,Rce=go,Ace=jg,y4=Object,Oce=_ce("".split),Ice=Rce(function(){return!y4("z").propertyIsEnumerable(0)})?function(t){return Ace(t)==="String"?Oce(t,""):y4(t)}:y4,y_=function(t){return t==null},Pce=y_,Fce=TypeError,DC=function(t){if(Pce(t))throw new Fce("Can't call method on "+t);return t},Mce=Ice,kce=DC,LC=function(t){return Mce(kce(t))},C4=typeof document=="object"&&document.all,bs=typeof C4>"u"&&C4!==void 0?function(t){return typeof t=="function"||t===C4}:function(t){return typeof t=="function"},Nce=bs,Bc=function(t){return typeof t=="object"?t!==null:Nce(t)},S4=Ns,Dce=bs,Lce=function(t){return Dce(t)?t:void 0},b1=function(t,e){return arguments.length<2?Lce(S4[t]):S4[t]&&S4[t][e]},Hce=ls,HC=Hce({}.isPrototypeOf),$ce=Ns,m$=$ce.navigator,p$=m$&&m$.userAgent,C_=p$?String(p$):"",SY=Ns,b4=C_,v$=SY.process,w$=SY.Deno,y$=v$&&v$.versions||w$&&w$.version,C$=y$&&y$.v8,_c,FE;C$&&(_c=C$.split("."),FE=_c[0]>0&&_c[0]<4?1:+(_c[0]+_c[1]));!FE&&b4&&(_c=b4.match(/Edge\/(\d+)/),(!_c||_c[1]>=74)&&(_c=b4.match(/Chrome\/(\d+)/),_c&&(FE=+_c[1])));var Bce=FE,S$=Bce,Vce=go,Wce=Ns,jce=Wce.String,qM=!!Object.getOwnPropertySymbols&&!Vce(function(){var t=Symbol("symbol detection");return!jce(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&S$&&S$<41}),Uce=qM,bY=Uce&&!Symbol.sham&&typeof Symbol.iterator=="symbol",zce=b1,Gce=bs,Yce=HC,Kce=bY,Xce=Object,JM=Kce?function(t){return typeof t=="symbol"}:function(t){var e=zce("Symbol");return Gce(e)&&Yce(e.prototype,Xce(t))},qce=String,S_=function(t){try{return qce(t)}catch{return"Object"}},Jce=bs,Qce=S_,Zce=TypeError,La=function(t){if(Jce(t))return t;throw new Zce(Qce(t)+" is not a function")},eue=La,tue=y_,$C=function(t,e){var r=t[e];return tue(r)?void 0:eue(r)},x4=$o,E4=bs,T4=Bc,rue=TypeError,nue=function(t,e){var r,i;if(e==="string"&&E4(r=t.toString)&&!T4(i=x4(r,t))||E4(r=t.valueOf)&&!T4(i=x4(r,t))||e!=="string"&&E4(r=t.toString)&&!T4(i=x4(r,t)))return i;throw new rue("Can't convert object to primitive value")},xY={exports:{}},QM=!1,b$=Ns,iue=Object.defineProperty,ZM=function(t,e){try{iue(b$,t,{value:e,configurable:!0,writable:!0})}catch{b$[t]=e}return e},sue=Ns,oue=ZM,x$="__core-js_shared__",E$=xY.exports=sue[x$]||oue(x$,{});(E$.versions||(E$.versions=[])).push({version:"3.39.0",mode:"global",copyright:" 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.39.0/LICENSE",source:"https://github.com/zloirock/core-js"});var ek=xY.exports,T$=ek,EY=function(t,e){return T$[t]||(T$[t]=e||{})},aue=DC,lue=Object,x1=function(t){return lue(aue(t))},cue=ls,uue=x1,hue=cue({}.hasOwnProperty),Kl=Object.hasOwn||function(e,r){return hue(uue(e),r)},fue=ls,due=0,gue=Math.random(),mue=fue(1 .toString),TY=function(t){return"Symbol("+(t===void 0?"":t)+")_"+mue(++due+gue,36)},pue=Ns,vue=EY,_$=Kl,wue=TY,yue=qM,Cue=bY,Rp=pue.Symbol,_4=vue("wks"),Sue=Cue?Rp.for||Rp:Rp&&Rp.withoutSetter||wue,Vc=function(t){return _$(_4,t)||(_4[t]=yue&&_$(Rp,t)?Rp[t]:Sue("Symbol."+t)),_4[t]},bue=$o,R$=Bc,A$=JM,xue=$C,Eue=nue,Tue=Vc,_ue=TypeError,Rue=Tue("toPrimitive"),Aue=function(t,e){if(!R$(t)||A$(t))return t;var r=xue(t,Rue),i;if(r){if(e===void 0&&(e="default"),i=bue(r,t,e),!R$(i)||A$(i))return i;throw new _ue("Can't convert object to primitive value")}return e===void 0&&(e="number"),Eue(t,e)},Oue=Aue,Iue=JM,_Y=function(t){var e=Oue(t,"string");return Iue(e)?e:e+""},Pue=Ns,O$=Bc,TP=Pue.document,Fue=O$(TP)&&O$(TP.createElement),tk=function(t){return Fue?TP.createElement(t):{}},Mue=Yl,kue=go,Nue=tk,RY=!Mue&&!kue(function(){return Object.defineProperty(Nue("div"),"a",{get:function(){return 7}}).a!==7}),Due=Yl,Lue=$o,Hue=mY,$ue=w_,Bue=LC,Vue=_Y,Wue=Kl,jue=RY,I$=Object.getOwnPropertyDescriptor;XM.f=Due?I$:function(e,r){if(e=Bue(e),r=Vue(r),jue)try{return I$(e,r)}catch{}if(Wue(e,r))return $ue(!Lue(Hue.f,e,r),e[r])};var cf={},Uue=Yl,zue=go,AY=Uue&&zue(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Gue=Bc,Yue=String,Kue=TypeError,xs=function(t){if(Gue(t))return t;throw new Kue(Yue(t)+" is not an object")},Xue=Yl,que=RY,Jue=AY,Cb=xs,P$=_Y,Que=TypeError,R4=Object.defineProperty,Zue=Object.getOwnPropertyDescriptor,A4="enumerable",O4="configurable",I4="writable";cf.f=Xue?Jue?function(e,r,i){if(Cb(e),r=P$(r),Cb(i),typeof e=="function"&&r==="prototype"&&"value"in i&&I4 in i&&!i[I4]){var s=Zue(e,r);s&&s[I4]&&(e[r]=i.value,i={configurable:O4 in i?i[O4]:s[O4],enumerable:A4 in i?i[A4]:s[A4],writable:!1})}return R4(e,r,i)}:R4:function(e,r,i){if(Cb(e),r=P$(r),Cb(i),que)try{return R4(e,r,i)}catch{}if("get"in i||"set"in i)throw new Que("Accessors not supported");return"value"in i&&(e[r]=i.value),e};var ehe=Yl,the=cf,rhe=w_,E1=ehe?function(t,e,r){return the.f(t,e,rhe(1,r))}:function(t,e,r){return t[e]=r,t},OY={exports:{}},_P=Yl,nhe=Kl,IY=Function.prototype,ihe=_P&&Object.getOwnPropertyDescriptor,rk=nhe(IY,"name"),she=rk&&(function(){}).name==="something",ohe=rk&&(!_P||_P&&ihe(IY,"name").configurable),ahe={EXISTS:rk,PROPER:she,CONFIGURABLE:ohe},lhe=ls,che=bs,RP=ek,uhe=lhe(Function.toString);che(RP.inspectSource)||(RP.inspectSource=function(t){return uhe(t)});var hhe=RP.inspectSource,fhe=Ns,dhe=bs,F$=fhe.WeakMap,ghe=dhe(F$)&&/native code/.test(String(F$)),mhe=EY,phe=TY,M$=mhe("keys"),nk=function(t){return M$[t]||(M$[t]=phe(t))},ik={},vhe=ghe,PY=Ns,whe=Bc,yhe=E1,P4=Kl,F4=ek,Che=nk,She=ik,k$="Object already initialized",AP=PY.TypeError,bhe=PY.WeakMap,ME,qy,kE,xhe=function(t){return kE(t)?qy(t):ME(t,{})},Ehe=function(t){return function(e){var r;if(!whe(e)||(r=qy(e)).type!==t)throw new AP("Incompatible receiver, "+t+" required");return r}};if(vhe||F4.state){var tu=F4.state||(F4.state=new bhe);tu.get=tu.get,tu.has=tu.has,tu.set=tu.set,ME=function(t,e){if(tu.has(t))throw new AP(k$);return e.facade=t,tu.set(t,e),e},qy=function(t){return tu.get(t)||{}},kE=function(t){return tu.has(t)}}else{var ym=Che("state");She[ym]=!0,ME=function(t,e){if(P4(t,ym))throw new AP(k$);return e.facade=t,yhe(t,ym,e),e},qy=function(t){return P4(t,ym)?t[ym]:{}},kE=function(t){return P4(t,ym)}}var FY={set:ME,get:qy,has:kE,enforce:xhe,getterFor:Ehe},sk=ls,The=go,_he=bs,Sb=Kl,OP=Yl,Rhe=ahe.CONFIGURABLE,Ahe=hhe,MY=FY,Ohe=MY.enforce,Ihe=MY.get,N$=String,I2=Object.defineProperty,Phe=sk("".slice),Fhe=sk("".replace),Mhe=sk([].join),khe=OP&&!The(function(){return I2(function(){},"length",{value:8}).length!==8}),Nhe=String(String).split("String"),Dhe=OY.exports=function(t,e,r){Phe(N$(e),0,7)==="Symbol("&&(e="["+Fhe(N$(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Sb(t,"name")||Rhe&&t.name!==e)&&(OP?I2(t,"name",{value:e,configurable:!0}):t.name=e),khe&&r&&Sb(r,"arity")&&t.length!==r.arity&&I2(t,"length",{value:r.arity});try{r&&Sb(r,"constructor")&&r.constructor?OP&&I2(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var i=Ohe(t);return Sb(i,"source")||(i.source=Mhe(Nhe,typeof e=="string"?e:"")),t};Function.prototype.toString=Dhe(function(){return _he(this)&&Ihe(this).source||Ahe(this)},"toString");var kY=OY.exports,Lhe=bs,Hhe=cf,$he=kY,Bhe=ZM,ok=function(t,e,r,i){i||(i={});var s=i.enumerable,n=i.name!==void 0?i.name:e;if(Lhe(r)&&$he(r,n,i),i.global)s?t[e]=r:Bhe(e,r);else{try{i.unsafe?t[e]&&(s=!0):delete t[e]}catch{}s?t[e]=r:Hhe.f(t,e,{value:r,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return t},NY={},Vhe=Math.ceil,Whe=Math.floor,jhe=Math.trunc||function(e){var r=+e;return(r>0?Whe:Vhe)(r)},Uhe=jhe,BC=function(t){var e=+t;return e!==e||e===0?0:Uhe(e)},zhe=BC,Ghe=Math.max,Yhe=Math.min,Khe=function(t,e){var r=zhe(t);return r<0?Ghe(r+e,0):Yhe(r,e)},Xhe=BC,qhe=Math.min,Jhe=function(t){var e=Xhe(t);return e>0?qhe(e,9007199254740991):0},Qhe=Jhe,T1=function(t){return Qhe(t.length)},Zhe=LC,efe=Khe,tfe=T1,D$=function(t){return function(e,r,i){var s=Zhe(e),n=tfe(s);if(n===0)return!t&&-1;var o=efe(i,n),l;if(t&&r!==r){for(;n>o;)if(l=s[o++],l!==l)return!0}else for(;n>o;o++)if((t||o in s)&&s[o]===r)return t||o||0;return!t&&-1}},rfe={includes:D$(!0),indexOf:D$(!1)},nfe=ls,M4=Kl,ife=LC,sfe=rfe.indexOf,ofe=ik,L$=nfe([].push),DY=function(t,e){var r=ife(t),i=0,s=[],n;for(n in r)!M4(ofe,n)&&M4(r,n)&&L$(s,n);for(;e.length>i;)M4(r,n=e[i++])&&(~sfe(s,n)||L$(s,n));return s},ak=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],afe=DY,lfe=ak,cfe=lfe.concat("length","prototype");NY.f=Object.getOwnPropertyNames||function(e){return afe(e,cfe)};var LY={};LY.f=Object.getOwnPropertySymbols;var ufe=b1,hfe=ls,ffe=NY,dfe=LY,gfe=xs,mfe=hfe([].concat),pfe=ufe("Reflect","ownKeys")||function(e){var r=ffe.f(gfe(e)),i=dfe.f;return i?mfe(r,i(e)):r},H$=Kl,vfe=pfe,wfe=XM,yfe=cf,HY=function(t,e,r){for(var i=vfe(e),s=yfe.f,n=wfe.f,o=0;o<i.length;o++){var l=i[o];!H$(t,l)&&!(r&&H$(r,l))&&s(t,l,n(e,l))}},Cfe=go,Sfe=bs,bfe=/#|\.prototype\./,VC=function(t,e){var r=Efe[xfe(t)];return r===_fe?!0:r===Tfe?!1:Sfe(e)?Cfe(e):!!e},xfe=VC.normalize=function(t){return String(t).replace(bfe,".").toLowerCase()},Efe=VC.data={},Tfe=VC.NATIVE="N",_fe=VC.POLYFILL="P",Rfe=VC,bb=Ns,Afe=XM.f,Ofe=E1,Ife=ok,Pfe=ZM,Ffe=HY,Mfe=Rfe,si=function(t,e){var r=t.target,i=t.global,s=t.stat,n,o,l,h,d,g;if(i?o=bb:s?o=bb[r]||Pfe(r,{}):o=bb[r]&&bb[r].prototype,o)for(l in e){if(d=e[l],t.dontCallGetSet?(g=Afe(o,l),h=g&&g.value):h=o[l],n=Mfe(i?l:r+(s?".":"#")+l,t.forced),!n&&h!==void 0){if(typeof d==typeof h)continue;Ffe(d,h)}(t.sham||h&&h.sham)&&Ofe(d,"sham",!0),Ife(o,l,d,t)}},kfe=v_,$Y=Function.prototype,$$=$Y.apply,B$=$Y.call,b_=typeof Reflect=="object"&&Reflect.apply||(kfe?B$.bind($$):function(){return B$.apply($$,arguments)}),Nfe=ls,Dfe=La,BY=function(t,e,r){try{return Nfe(Dfe(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},Lfe=Bc,Hfe=function(t){return Lfe(t)||t===null},$fe=Hfe,Bfe=String,Vfe=TypeError,Wfe=function(t){if($fe(t))return t;throw new Vfe("Can't set "+Bfe(t)+" as a prototype")},jfe=BY,Ufe=Bc,zfe=DC,Gfe=Wfe,VY=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=jfe(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(s,n){return zfe(s),Gfe(n),Ufe(s)&&(t?r(s,n):s.__proto__=n),s}}():void 0),Yfe=cf.f,Kfe=function(t,e,r){r in t||Yfe(t,r,{configurable:!0,get:function(){return e[r]},set:function(i){e[r]=i}})},Xfe=bs,qfe=Bc,V$=VY,Jfe=function(t,e,r){var i,s;return V$&&Xfe(i=e.constructor)&&i!==r&&qfe(s=i.prototype)&&s!==r.prototype&&V$(t,s),t},Qfe=Vc,Zfe=Qfe("toStringTag"),WY={};WY[Zfe]="z";var ede=String(WY)==="[object z]",tde=ede,rde=bs,P2=jg,nde=Vc,ide=nde("toStringTag"),sde=Object,ode=P2(function(){return arguments}())==="Arguments",ade=function(t,e){try{return t[e]}catch{}},jY=tde?P2:function(t){var e,r,i;return t===void 0?"Undefined":t===null?"Null":typeof(r=ade(e=sde(t),ide))=="string"?r:ode?P2(e):(i=P2(e))==="Object"&&rde(e.callee)?"Arguments":i},lde=jY,cde=String,x_=function(t){if(lde(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return cde(t)},ude=x_,hde=function(t,e){return t===void 0?arguments.length<2?"":e:ude(t)},fde=Bc,dde=E1,gde=function(t,e){fde(e)&&"cause"in e&&dde(t,"cause",e.cause)},mde=ls,UY=Error,pde=mde("".replace),vde=function(t){return String(new UY(t).stack)}("zxcasd"),zY=/\n\s*at [^:]*:[^\n]*/,wde=zY.test(vde),yde=function(t,e){if(wde&&typeof t=="string"&&!UY.prepareStackTrace)for(;e--;)t=pde(t,zY,"");return t},Cde=go,Sde=w_,bde=!Cde(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",Sde(1,7)),t.stack!==7):!0}),xde=E1,Ede=yde,Tde=bde,W$=Error.captureStackTrace,_de=function(t,e,r,i){Tde&&(W$?W$(t,e):xde(t,"stack",Ede(r,i)))},j$=b1,Rde=Kl,U$=E1,Ade=HC,z$=VY,G$=HY,Y$=Kfe,Ode=Jfe,Ide=hde,Pde=gde,Fde=_de,Mde=Yl,kde=function(t,e,r,i){var s="stackTraceLimit",n=i?2:1,o=t.split("."),l=o[o.length-1],h=j$.apply(null,o);if(h){var d=h.prototype;if(Rde(d,"cause")&&delete d.cause,!r)return h;var g=j$("Error"),y=e(function(C,x){var _=Ide(i?x:C,void 0),E=i?new h(C):new h;return _!==void 0&&U$(E,"message",_),Fde(E,y,E.stack,2),this&&Ade(d,this)&&Ode(E,this,y),arguments.length>n&&Pde(E,arguments[n]),E});y.prototype=d,l!=="Error"?z$?z$(y,g):G$(y,g,{name:!0}):Mde&&s in h&&(Y$(y,h,s),Y$(y,h,"prepareStackTrace")),G$(y,h);try{d.name!==l&&U$(d,"name",l),d.constructor=y}catch{}return y}},GY=si,Nde=Ns,Yu=b_,YY=kde,IP="WebAssembly",K$=Nde[IP],NE=new Error("e",{cause:7}).cause!==7,Ug=function(t,e){var r={};r[t]=YY(t,e,NE),GY({global:!0,constructor:!0,arity:1,forced:NE},r)},lk=function(t,e){if(K$&&K$[t]){var r={};r[t]=YY(IP+"."+t,e,NE),GY({target:IP,stat:!0,constructor:!0,arity:1,forced:NE},r)}};Ug("Error",function(t){return function(r){return Yu(t,this,arguments)}});Ug("EvalError",function(t){return function(r){return Yu(t,this,arguments)}});Ug("RangeError",function(t){return function(r){return Yu(t,this,arguments)}});Ug("ReferenceError",function(t){return function(r){return Yu(t,this,arguments)}});Ug("SyntaxError",function(t){return function(r){return Yu(t,this,arguments)}});Ug("TypeError",function(t){return function(r){return Yu(t,this,arguments)}});Ug("URIError",function(t){return function(r){return Yu(t,this,arguments)}});lk("CompileError",function(t){return function(r){return Yu(t,this,arguments)}});lk("LinkError",function(t){return function(r){return Yu(t,this,arguments)}});lk("RuntimeError",function(t){return function(r){return Yu(t,this,arguments)}});var Dde=jg,KY=Array.isArray||function(e){return Dde(e)==="Array"},Lde=Yl,Hde=KY,$de=TypeError,Bde=Object.getOwnPropertyDescriptor,Vde=Lde&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),XY=Vde?function(t,e){if(Hde(t)&&!Bde(t,"length").writable)throw new $de("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},Wde=TypeError,jde=9007199254740991,qY=function(t){if(t>jde)throw Wde("Maximum allowed index exceeded");return t},Ude=si,zde=x1,Gde=T1,Yde=XY,Kde=qY,Xde=go,qde=Xde(function(){return[].push.call({length:4294967296},1)!==4294967297}),Jde=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Qde=qde||!Jde();Ude({target:"Array",proto:!0,arity:1,forced:Qde},{push:function(e){var r=zde(this),i=Gde(r),s=arguments.length;Kde(i+s);for(var n=0;n<s;n++)r[i]=arguments[n],i++;return Yde(r,i),i}});var k4=ls,xb=Set.prototype,Ku={Set,add:k4(xb.add),has:k4(xb.has),remove:k4(xb.delete),proto:xb},Zde=Ku.has,zg=function(t){return Zde(t),t},e0e=$o,Gg=function(t,e,r){for(var i=r?t:t.iterator,s=t.next,n,o;!(n=e0e(s,i)).done;)if(o=e(n.value),o!==void 0)return o},JY=ls,t0e=Gg,QY=Ku,r0e=QY.Set,ZY=QY.proto,n0e=JY(ZY.forEach),eK=JY(ZY.keys),i0e=eK(new r0e).next,WC=function(t,e,r){return r?t0e({iterator:eK(t),next:i0e},e):n0e(t,e)},tK=Ku,s0e=WC,o0e=tK.Set,a0e=tK.add,ck=function(t){var e=new o0e;return s0e(t,function(r){a0e(e,r)}),e},l0e=BY,c0e=Ku,jC=l0e(c0e.proto,"size","get")||function(t){return t.size},Xu=function(t){return{iterator:t,next:t.next,done:!1}},X$=La,rK=xs,q$=$o,u0e=BC,h0e=Xu,J$="Invalid size",f0e=RangeError,d0e=TypeError,g0e=Math.max,nK=function(t,e){this.set=t,this.size=g0e(e,0),this.has=X$(t.has),this.keys=X$(t.keys)};nK.prototype={getIterator:function(){return h0e(rK(q$(this.keys,this.set)))},includes:function(t){return q$(this.has,this.set,t)}};var Yg=function(t){rK(t);var e=+t.size;if(e!==e)throw new d0e(J$);var r=u0e(e);if(r<0)throw new f0e(J$);return new nK(t,r)},m0e=zg,iK=Ku,p0e=ck,v0e=jC,w0e=Yg,y0e=WC,C0e=Gg,S0e=iK.has,Q$=iK.remove,b0e=function(e){var r=m0e(this),i=w0e(e),s=p0e(r);return v0e(r)<=i.size?y0e(r,function(n){i.includes(n)&&Q$(s,n)}):C0e(i.getIterator(),function(n){S0e(r,n)&&Q$(s,n)}),s},x0e=b1,Z$=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},Kg=function(t){var e=x0e("Set");try{new e()[t](Z$(0));try{return new e()[t](Z$(-1)),!1}catch{return!0}}catch{return!1}},E0e=si,T0e=b0e,_0e=Kg;E0e({target:"Set",proto:!0,real:!0,forced:!_0e("difference")},{difference:T0e});var R0e=zg,uk=Ku,A0e=jC,O0e=Yg,I0e=WC,P0e=Gg,F0e=uk.Set,e9=uk.add,M0e=uk.has,k0e=function(e){var r=R0e(this),i=O0e(e),s=new F0e;return A0e(r)>i.size?P0e(i.getIterator(),function(n){M0e(r,n)&&e9(s,n)}):I0e(r,function(n){i.includes(n)&&e9(s,n)}),s},N0e=si,D0e=go,L0e=k0e,H0e=Kg,$0e=!H0e("intersection")||D0e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});N0e({target:"Set",proto:!0,real:!0,forced:$0e},{intersection:L0e});var B0e=$o,t9=xs,V0e=$C,_1=function(t,e,r){var i,s;t9(t);try{if(i=V0e(t,"return"),!i){if(e==="throw")throw r;return r}i=B0e(i,t)}catch(n){s=!0,i=n}if(e==="throw")throw r;if(s)throw i;return t9(i),r},W0e=zg,j0e=Ku.has,U0e=jC,z0e=Yg,G0e=WC,Y0e=Gg,K0e=_1,X0e=function(e){var r=W0e(this),i=z0e(e);if(U0e(r)<=i.size)return G0e(r,function(n){if(i.includes(n))return!1},!0)!==!1;var s=i.getIterator();return Y0e(s,function(n){if(j0e(r,n))return K0e(s,"normal",!1)})!==!1},q0e=si,J0e=X0e,Q0e=Kg;q0e({target:"Set",proto:!0,real:!0,forced:!Q0e("isDisjointFrom")},{isDisjointFrom:J0e});var Z0e=zg,ege=jC,tge=WC,rge=Yg,nge=function(e){var r=Z0e(this),i=rge(e);return ege(r)>i.size?!1:tge(r,function(s){if(!i.includes(s))return!1},!0)!==!1},ige=si,sge=nge,oge=Kg;ige({target:"Set",proto:!0,real:!0,forced:!oge("isSubsetOf")},{isSubsetOf:sge});var age=zg,lge=Ku.has,cge=jC,uge=Yg,hge=Gg,fge=_1,dge=function(e){var r=age(this),i=uge(e);if(cge(r)<i.size)return!1;var s=i.getIterator();return hge(s,function(n){if(!lge(r,n))return fge(s,"normal",!1)})!==!1},gge=si,mge=dge,pge=Kg;gge({target:"Set",proto:!0,real:!0,forced:!pge("isSupersetOf")},{isSupersetOf:mge});var vge=zg,hk=Ku,wge=ck,yge=Yg,Cge=Gg,Sge=hk.add,bge=hk.has,xge=hk.remove,Ege=function(e){var r=vge(this),i=yge(e).getIterator(),s=wge(r);return Cge(i,function(n){bge(r,n)?xge(s,n):Sge(s,n)}),s},Tge=si,_ge=Ege,Rge=Kg;Tge({target:"Set",proto:!0,real:!0,forced:!Rge("symmetricDifference")},{symmetricDifference:_ge});var Age=zg,Oge=Ku.add,Ige=ck,Pge=Yg,Fge=Gg,Mge=function(e){var r=Age(this),i=Pge(e).getIterator(),s=Ige(r);return Fge(i,function(n){Oge(s,n)}),s},kge=si,Nge=Mge,Dge=Kg;kge({target:"Set",proto:!0,real:!0,forced:!Dge("union")},{union:Nge});var Lge=HC,Hge=TypeError,$ge=function(t,e){if(Lge(e,t))return t;throw new Hge("Incorrect invocation")},Bge=go,Vge=!Bge(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Wge=Kl,jge=bs,Uge=x1,zge=nk,Gge=Vge,r9=zge("IE_PROTO"),PP=Object,Yge=PP.prototype,sK=Gge?PP.getPrototypeOf:function(t){var e=Uge(t);if(Wge(e,r9))return e[r9];var r=e.constructor;return jge(r)&&e instanceof r?r.prototype:e instanceof PP?Yge:null},n9=kY,Kge=cf,Xge=function(t,e,r){return r.get&&n9(r.get,e,{getter:!0}),r.set&&n9(r.set,e,{setter:!0}),Kge.f(t,e,r)},qge=Yl,Jge=cf,Qge=w_,oK=function(t,e,r){qge?Jge.f(t,e,Qge(0,r)):t[e]=r},aK={},Zge=DY,eme=ak,tme=Object.keys||function(e){return Zge(e,eme)},rme=Yl,nme=AY,ime=cf,sme=xs,ome=LC,ame=tme;aK.f=rme&&!nme?Object.defineProperties:function(e,r){sme(e);for(var i=ome(r),s=ame(r),n=s.length,o=0,l;n>o;)ime.f(e,l=s[o++],i[l]);return e};var lme=b1,lK=lme("document","documentElement"),cme=xs,ume=aK,i9=ak,hme=ik,fme=lK,dme=tk,gme=nk,s9=">",o9="<",FP="prototype",MP="script",cK=gme("IE_PROTO"),N4=function(){},uK=function(t){return o9+MP+s9+t+o9+"/"+MP+s9},a9=function(t){t.write(uK("")),t.close();var e=t.parentWindow.Object;return t=null,e},mme=function(){var t=dme("iframe"),e="java"+MP+":",r;return t.style.display="none",fme.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(uK("document.F=Object")),r.close(),r.F},Eb,F2=function(){try{Eb=new ActiveXObject("htmlfile")}catch{}F2=typeof document<"u"?document.domain&&Eb?a9(Eb):mme():a9(Eb);for(var t=i9.length;t--;)delete F2[FP][i9[t]];return F2()};hme[cK]=!0;var hK=Object.create||function(e,r){var i;return e!==null?(N4[FP]=cme(e),i=new N4,N4[FP]=null,i[cK]=e):i=F2(),r===void 0?i:ume.f(i,r)},pme=go,vme=bs,wme=Bc,l9=sK,yme=ok,Cme=Vc,kP=Cme("iterator"),fK=!1,_g,D4,L4;[].keys&&(L4=[].keys(),"next"in L4?(D4=l9(l9(L4)),D4!==Object.prototype&&(_g=D4)):fK=!0);var Sme=!wme(_g)||pme(function(){var t={};return _g[kP].call(t)!==t});Sme&&(_g={});vme(_g[kP])||yme(_g,kP,function(){return this});var dK={IteratorPrototype:_g,BUGGY_SAFARI_ITERATORS:fK},bme=si,xme=Ns,Eme=$ge,Tme=xs,_me=bs,Rme=sK,Ame=Xge,Ome=oK,Ime=go,fk=Kl,Pme=Vc,Vu=dK.IteratorPrototype,Fme=Yl,H4="constructor",gK="Iterator",c9=Pme("toStringTag"),mK=TypeError,$4=xme[gK],pK=!_me($4)||$4.prototype!==Vu||!Ime(function(){$4({})}),dk=function(){if(Eme(this,Vu),Rme(this)===Vu)throw new mK("Abstract class Iterator not directly constructable")},vK=function(t,e){Fme?Ame(Vu,t,{configurable:!0,get:function(){return e},set:function(r){if(Tme(this),this===Vu)throw new mK("You can't redefine this property");fk(this,t)?this[t]=r:Ome(this,t,r)}}):Vu[t]=e};fk(Vu,c9)||vK(c9,gK);(pK||!fk(Vu,H4)||Vu[H4]===Object)&&vK(H4,dk);dk.prototype=Vu;bme({global:!0,constructor:!0,forced:pK},{Iterator:dk});var Mme=ok,kme=function(t,e,r){for(var i in e)Mme(t,i,e[i],r);return t},Nme=function(t,e){return{value:t,done:e}},Dme=$o,Lme=hK,Hme=E1,$me=kme,Bme=Vc,wK=FY,Vme=$C,Wme=dK.IteratorPrototype,B4=Nme,V4=_1,jme=Bme("toStringTag"),yK="IteratorHelper",CK="WrapForValidIterator",Ume=wK.set,SK=function(t){var e=wK.getterFor(t?CK:yK);return $me(Lme(Wme),{next:function(){var i=e(this);if(t)return i.nextHandler();try{var s=i.done?void 0:i.nextHandler();return B4(s,i.done)}catch(n){throw i.done=!0,n}},return:function(){var r=e(this),i=r.iterator;if(r.done=!0,t){var s=Vme(i,"return");return s?Dme(s,i):B4(void 0,!0)}if(r.inner)try{V4(r.inner.iterator,"normal")}catch(n){return V4(i,"throw",n)}return i&&V4(i,"normal"),B4(void 0,!0)}})},zme=SK(!0),bK=SK(!1);Hme(bK,jme,"Iterator Helper");var gk=function(t,e){var r=function(s,n){n?(n.iterator=s.iterator,n.next=s.next):n=s,n.type=e?CK:yK,n.nextHandler=t,n.counter=0,n.done=!1,Ume(this,n)};return r.prototype=e?zme:bK,r},Gme=xs,Yme=_1,xK=function(t,e,r,i){try{return i?e(Gme(r)[0],r[1]):e(r)}catch(s){Yme(t,"throw",s)}},Kme=si,Xme=$o,qme=La,EK=xs,Jme=Xu,Qme=gk,Zme=xK,epe=QM,tpe=Qme(function(){for(var t=this.iterator,e=this.predicate,r=this.next,i,s,n;;){if(i=EK(Xme(r,t)),s=this.done=!!i.done,s)return;if(n=i.value,Zme(t,e,[n,this.counter++],!0))return n}});Kme({target:"Iterator",proto:!0,real:!0,forced:epe},{filter:function(e){return EK(this),qme(e),new tpe(Jme(this),{predicate:e})}});var rpe=jg,npe=ls,ipe=function(t){if(rpe(t)==="Function")return npe(t)},u9=ipe,spe=La,ope=v_,ape=u9(u9.bind),TK=function(t,e){return spe(t),e===void 0?t:ope?ape(t,e):function(){return t.apply(e,arguments)}},_K={},lpe=Vc,cpe=_K,upe=lpe("iterator"),hpe=Array.prototype,fpe=function(t){return t!==void 0&&(cpe.Array===t||hpe[upe]===t)},dpe=jY,h9=$C,gpe=y_,mpe=_K,ppe=Vc,vpe=ppe("iterator"),mk=function(t){if(!gpe(t))return h9(t,vpe)||h9(t,"@@iterator")||mpe[dpe(t)]},wpe=$o,ype=La,Cpe=xs,Spe=S_,bpe=mk,xpe=TypeError,Epe=function(t,e){var r=arguments.length<2?bpe(t):e;if(ype(r))return Cpe(wpe(r,t));throw new xpe(Spe(t)+" is not iterable")},Tpe=TK,_pe=$o,Rpe=xs,Ape=S_,Ope=fpe,Ipe=T1,f9=HC,Ppe=Epe,Fpe=mk,d9=_1,Mpe=TypeError,M2=function(t,e){this.stopped=t,this.result=e},g9=M2.prototype,R1=function(t,e,r){var i=r&&r.that,s=!!(r&&r.AS_ENTRIES),n=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),l=!!(r&&r.INTERRUPTED),h=Tpe(e,i),d,g,y,C,x,_,E,R=function(F){return d&&d9(d,"normal",F),new M2(!0,F)},I=function(F){return s?(Rpe(F),l?h(F[0],F[1],R):h(F[0],F[1])):l?h(F,R):h(F)};if(n)d=t.iterator;else if(o)d=t;else{if(g=Fpe(t),!g)throw new Mpe(Ape(t)+" is not iterable");if(Ope(g)){for(y=0,C=Ipe(t);C>y;y++)if(x=I(t[y]),x&&f9(g9,x))return x;return new M2(!1)}d=Ppe(t,g)}for(_=n?t.next:d.next;!(E=_pe(_,d)).done;){try{x=I(E.value)}catch(F){d9(d,"throw",F)}if(typeof x=="object"&&x&&f9(g9,x))return x}return new M2(!1)},kpe=si,Npe=R1,Dpe=La,Lpe=xs,Hpe=Xu;kpe({target:"Iterator",proto:!0,real:!0},{forEach:function(e){Lpe(this),Dpe(e);var r=Hpe(this),i=0;Npe(r,function(s){e(s,i++)},{IS_RECORD:!0})}});var $pe=$o,Bpe=La,RK=xs,Vpe=Xu,Wpe=gk,jpe=xK,Upe=Wpe(function(){var t=this.iterator,e=RK($pe(this.next,t)),r=this.done=!!e.done;if(!r)return jpe(t,this.mapper,[e.value,this.counter++],!0)}),zpe=function(e){return RK(this),Bpe(e),new Upe(Vpe(this),{mapper:e})},Gpe=si,Ype=zpe,Kpe=QM;Gpe({target:"Iterator",proto:!0,real:!0,forced:Kpe},{map:Ype});var Xpe=ls,pk=Xpe([].slice),qpe=TypeError,AK=function(t,e){if(t<e)throw new qpe("Not enough arguments");return t},Jpe=C_,Qpe=/(?:ipad|iphone|ipod).*applewebkit/i.test(Jpe),Av=Ns,Zpe=C_,e1e=jg,Tb=function(t){return Zpe.slice(0,t.length)===t},OK=function(){return Tb("Bun/")?"BUN":Tb("Cloudflare-Workers")?"CLOUDFLARE":Tb("Deno/")?"DENO":Tb("Node.js/")?"NODE":Av.Bun&&typeof Bun.version=="string"?"BUN":Av.Deno&&typeof Deno.version=="object"?"DENO":e1e(Av.process)==="process"?"NODE":Av.window&&Av.document?"BROWSER":"REST"}(),t1e=OK,r1e=t1e==="NODE",nl=Ns,n1e=b_,i1e=TK,m9=bs,s1e=Kl,IK=go,p9=lK,o1e=pk,v9=tk,a1e=AK,l1e=Qpe,c1e=r1e,NP=nl.setImmediate,DP=nl.clearImmediate,u1e=nl.process,W4=nl.Dispatch,h1e=nl.Function,w9=nl.MessageChannel,f1e=nl.String,j4=0,ry={},y9="onreadystatechange",Jy,o0,U4,z4;IK(function(){Jy=nl.location});var vk=function(t){if(s1e(ry,t)){var e=ry[t];delete ry[t],e()}},G4=function(t){return function(){vk(t)}},C9=function(t){vk(t.data)},S9=function(t){nl.postMessage(f1e(t),Jy.protocol+"//"+Jy.host)};(!NP||!DP)&&(NP=function(e){a1e(arguments.length,1);var r=m9(e)?e:h1e(e),i=o1e(arguments,1);return ry[++j4]=function(){n1e(r,void 0,i)},o0(j4),j4},DP=function(e){delete ry[e]},c1e?o0=function(t){u1e.nextTick(G4(t))}:W4&&W4.now?o0=function(t){W4.now(G4(t))}:w9&&!l1e?(U4=new w9,z4=U4.port2,U4.port1.onmessage=C9,o0=i1e(z4.postMessage,z4)):nl.addEventListener&&m9(nl.postMessage)&&!nl.importScripts&&Jy&&Jy.protocol!=="file:"&&!IK(S9)?(o0=S9,nl.addEventListener("message",C9,!1)):y9 in v9("script")?o0=function(t){p9.appendChild(v9("script"))[y9]=function(){p9.removeChild(this),vk(t)}}:o0=function(t){setTimeout(G4(t),0)});var PK={set:NP,clear:DP},d1e=si,g1e=Ns,b9=PK.clear;d1e({global:!0,bind:!0,enumerable:!0,forced:g1e.clearImmediate!==b9},{clearImmediate:b9});var FK=Ns,m1e=b_,p1e=bs,v1e=OK,w1e=C_,y1e=pk,C1e=AK,S1e=FK.Function,b1e=/MSIE .\./.test(w1e)||v1e==="BUN"&&function(){var t=FK.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),x1e=function(t,e){var r=e?2:1;return b1e?function(i,s){var n=C1e(arguments.length,1)>r,o=p1e(i)?i:S1e(i),l=n?y1e(arguments,r):[],h=n?function(){m1e(o,this,l)}:o;return e?t(h,s):t(h)}:t},E1e=si,MK=Ns,x9=PK.set,T1e=x1e,E9=MK.setImmediate?T1e(x9,!1):x9;E1e({global:!0,bind:!0,enumerable:!0,forced:MK.setImmediate!==E9},{setImmediate:E9});/*! @license DOMPurify 3.2.3 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.3/LICENSE */const{entries:kK,setPrototypeOf:T9,isFrozen:_1e,getPrototypeOf:R1e,getOwnPropertyDescriptor:A1e}=Object;let{freeze:aa,seal:Gl,create:NK}=Object,{apply:LP,construct:HP}=typeof Reflect<"u"&&Reflect;aa||(aa=function(e){return e});Gl||(Gl=function(e){return e});LP||(LP=function(e,r,i){return e.apply(r,i)});HP||(HP=function(e,r){return new e(...r)});const _b=ll(Array.prototype.forEach),_9=ll(Array.prototype.pop),Ov=ll(Array.prototype.push),k2=ll(String.prototype.toLowerCase),Y4=ll(String.prototype.toString),R9=ll(String.prototype.match),Iv=ll(String.prototype.replace),O1e=ll(String.prototype.indexOf),I1e=ll(String.prototype.trim),mc=ll(Object.prototype.hasOwnProperty),zo=ll(RegExp.prototype.test),Pv=P1e(TypeError);function ll(t){return function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return LP(t,e,i)}}function P1e(t){return function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return HP(t,r)}}function ln(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:k2;T9&&T9(t,null);let i=e.length;for(;i--;){let s=e[i];if(typeof s=="string"){const n=r(s);n!==s&&(_1e(e)||(e[i]=n),s=n)}t[s]=!0}return t}function F1e(t){for(let e=0;e<t.length;e++)mc(t,e)||(t[e]=null);return t}function K0(t){const e=NK(null);for(const[r,i]of kK(t))mc(t,r)&&(Array.isArray(i)?e[r]=F1e(i):i&&typeof i=="object"&&i.constructor===Object?e[r]=K0(i):e[r]=i);return e}function Fv(t,e){for(;t!==null;){const i=A1e(t,e);if(i){if(i.get)return ll(i.get);if(typeof i.value=="function")return ll(i.value)}t=R1e(t)}function r(){return null}return r}const A9=aa(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),K4=aa(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),X4=aa(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M1e=aa(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),q4=aa(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),k1e=aa(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),O9=aa(["#text"]),I9=aa(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),J4=aa(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),P9=aa(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Rb=aa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),N1e=Gl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),D1e=Gl(/<%[\w\W]*|[\w\W]*%>/gm),L1e=Gl(/\$\{[\w\W]*}/gm),H1e=Gl(/^data-[\-\w.\u00B7-\uFFFF]+$/),$1e=Gl(/^aria-[\-\w]+$/),DK=Gl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),B1e=Gl(/^(?:\w+script|data):/i),V1e=Gl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LK=Gl(/^html$/i),W1e=Gl(/^[a-z][.\w]*(-[.\w]+)+$/i);var F9=Object.freeze({__proto__:null,ARIA_ATTR:$1e,ATTR_WHITESPACE:V1e,CUSTOM_ELEMENT:W1e,DATA_ATTR:H1e,DOCTYPE_NAME:LK,ERB_EXPR:D1e,IS_ALLOWED_URI:DK,IS_SCRIPT_OR_DATA:B1e,MUSTACHE_EXPR:N1e,TMPLIT_EXPR:L1e});const Mv={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},j1e=function(){return typeof window>"u"?null:window},U1e=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const s="data-tt-policy-suffix";r&&r.hasAttribute(s)&&(i=r.getAttribute(s));const n="dompurify"+(i?"#"+i:"");try{return e.createPolicy(n,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}},M9=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function HK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j1e();const e=Oe=>HK(Oe);if(e.version="3.2.3",e.removed=[],!t||!t.document||t.document.nodeType!==Mv.document)return e.isSupported=!1,e;let{document:r}=t;const i=r,s=i.currentScript,{DocumentFragment:n,HTMLTemplateElement:o,Node:l,Element:h,NodeFilter:d,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:y,DOMParser:C,trustedTypes:x}=t,_=h.prototype,E=Fv(_,"cloneNode"),R=Fv(_,"remove"),I=Fv(_,"nextSibling"),F=Fv(_,"childNodes"),H=Fv(_,"parentNode");if(typeof o=="function"){const Oe=r.createElement("template");Oe.content&&Oe.content.ownerDocument&&(r=Oe.content.ownerDocument)}let z,q="";const{implementation:re,createNodeIterator:Y,createDocumentFragment:oe,getElementsByTagName:me}=r,{importNode:de}=i;let Re=M9();e.isSupported=typeof kK=="function"&&typeof H=="function"&&re&&re.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Ie,ERB_EXPR:Be,TMPLIT_EXPR:lt,DATA_ATTR:pt,ARIA_ATTR:Ct,IS_SCRIPT_OR_DATA:ct,ATTR_WHITESPACE:Ue,CUSTOM_ELEMENT:Je}=F9;let{IS_ALLOWED_URI:Fe}=F9,A=null;const O=ln({},[...A9,...K4,...X4,...q4,...O9]);let k=null;const L=ln({},[...I9,...J4,...P9,...Rb]);let D=Object.seal(NK(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,Q=null,pe=!0,ye=!0,j=!1,X=!0,te=!1,we=!0,ce=!1,_e=!1,Ee=!1,he=!1,Ae=!1,Ne=!1,Le=!0,Xe=!1;const Ft="user-content-";let St=!0,zt=!1,kr={},xr=null;const ir=ln({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let hr=null;const Hn=ln({},["audio","video","img","source","image","track"]);let xi=null;const qs=ln({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),oi="http://www.w3.org/1998/Math/MathML",Jn="http://www.w3.org/2000/svg",$n="http://www.w3.org/1999/xhtml";let Lr=$n,Nr=!1,Ve=null;const ot=ln({},[oi,Jn,$n],Y4);let It=ln({},["mi","mo","mn","ms","mtext"]),ar=ln({},["annotation-xml"]);const Oi=ln({},["title","style","font","a","script"]);let Ur=null;const Bo=["application/xhtml+xml","text/html"],Zt="text/html";let ji=null,da=null;const ai=r.createElement("form"),Wd=function(ie){return ie instanceof RegExp||ie instanceof Function},Gc=function(){let ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(da&&da===ie)){if((!ie||typeof ie!="object")&&(ie={}),ie=K0(ie),Ur=Bo.indexOf(ie.PARSER_MEDIA_TYPE)===-1?Zt:ie.PARSER_MEDIA_TYPE,ji=Ur==="application/xhtml+xml"?Y4:k2,A=mc(ie,"ALLOWED_TAGS")?ln({},ie.ALLOWED_TAGS,ji):O,k=mc(ie,"ALLOWED_ATTR")?ln({},ie.ALLOWED_ATTR,ji):L,Ve=mc(ie,"ALLOWED_NAMESPACES")?ln({},ie.ALLOWED_NAMESPACES,Y4):ot,xi=mc(ie,"ADD_URI_SAFE_ATTR")?ln(K0(qs),ie.ADD_URI_SAFE_ATTR,ji):qs,hr=mc(ie,"ADD_DATA_URI_TAGS")?ln(K0(Hn),ie.ADD_DATA_URI_TAGS,ji):Hn,xr=mc(ie,"FORBID_CONTENTS")?ln({},ie.FORBID_CONTENTS,ji):ir,K=mc(ie,"FORBID_TAGS")?ln({},ie.FORBID_TAGS,ji):{},Q=mc(ie,"FORBID_ATTR")?ln({},ie.FORBID_ATTR,ji):{},kr=mc(ie,"USE_PROFILES")?ie.USE_PROFILES:!1,pe=ie.ALLOW_ARIA_ATTR!==!1,ye=ie.ALLOW_DATA_ATTR!==!1,j=ie.ALLOW_UNKNOWN_PROTOCOLS||!1,X=ie.ALLOW_SELF_CLOSE_IN_ATTR!==!1,te=ie.SAFE_FOR_TEMPLATES||!1,we=ie.SAFE_FOR_XML!==!1,ce=ie.WHOLE_DOCUMENT||!1,he=ie.RETURN_DOM||!1,Ae=ie.RETURN_DOM_FRAGMENT||!1,Ne=ie.RETURN_TRUSTED_TYPE||!1,Ee=ie.FORCE_BODY||!1,Le=ie.SANITIZE_DOM!==!1,Xe=ie.SANITIZE_NAMED_PROPS||!1,St=ie.KEEP_CONTENT!==!1,zt=ie.IN_PLACE||!1,Fe=ie.ALLOWED_URI_REGEXP||DK,Lr=ie.NAMESPACE||$n,It=ie.MATHML_TEXT_INTEGRATION_POINTS||It,ar=ie.HTML_INTEGRATION_POINTS||ar,D=ie.CUSTOM_ELEMENT_HANDLING||{},ie.CUSTOM_ELEMENT_HANDLING&&Wd(ie.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(D.tagNameCheck=ie.CUSTOM_ELEMENT_HANDLING.tagNameCheck),ie.CUSTOM_ELEMENT_HANDLING&&Wd(ie.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(D.attributeNameCheck=ie.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),ie.CUSTOM_ELEMENT_HANDLING&&typeof ie.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(D.allowCustomizedBuiltInElements=ie.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),te&&(ye=!1),Ae&&(he=!0),kr&&(A=ln({},O9),k=[],kr.html===!0&&(ln(A,A9),ln(k,I9)),kr.svg===!0&&(ln(A,K4),ln(k,J4),ln(k,Rb)),kr.svgFilters===!0&&(ln(A,X4),ln(k,J4),ln(k,Rb)),kr.mathMl===!0&&(ln(A,q4),ln(k,P9),ln(k,Rb))),ie.ADD_TAGS&&(A===O&&(A=K0(A)),ln(A,ie.ADD_TAGS,ji)),ie.ADD_ATTR&&(k===L&&(k=K0(k)),ln(k,ie.ADD_ATTR,ji)),ie.ADD_URI_SAFE_ATTR&&ln(xi,ie.ADD_URI_SAFE_ATTR,ji),ie.FORBID_CONTENTS&&(xr===ir&&(xr=K0(xr)),ln(xr,ie.FORBID_CONTENTS,ji)),St&&(A["#text"]=!0),ce&&ln(A,["html","head","body"]),A.table&&(ln(A,["tbody"]),delete K.tbody),ie.TRUSTED_TYPES_POLICY){if(typeof ie.TRUSTED_TYPES_POLICY.createHTML!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof ie.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Pv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');z=ie.TRUSTED_TYPES_POLICY,q=z.createHTML("")}else z===void 0&&(z=U1e(x,s)),z!==null&&typeof q=="string"&&(q=z.createHTML(""));aa&&aa(ie),da=ie}},eh=ln({},[...K4,...X4,...M1e]),th=ln({},[...q4,...k1e]),hi=function(ie){let Me=H(ie);(!Me||!Me.tagName)&&(Me={namespaceURI:Lr,tagName:"template"});const Qe=k2(ie.tagName),bt=k2(Me.tagName);return Ve[ie.namespaceURI]?ie.namespaceURI===Jn?Me.namespaceURI===$n?Qe==="svg":Me.namespaceURI===oi?Qe==="svg"&&(bt==="annotation-xml"||It[bt]):!!eh[Qe]:ie.namespaceURI===oi?Me.namespaceURI===$n?Qe==="math":Me.namespaceURI===Jn?Qe==="math"&&ar[bt]:!!th[Qe]:ie.namespaceURI===$n?Me.namespaceURI===Jn&&!ar[bt]||Me.namespaceURI===oi&&!It[bt]?!1:!th[Qe]&&(Oi[Qe]||!eh[Qe]):!!(Ur==="application/xhtml+xml"&&Ve[ie.namespaceURI]):!1},Js=function(ie){Ov(e.removed,{element:ie});try{H(ie).removeChild(ie)}catch{R(ie)}},pf=function(ie,Me){try{Ov(e.removed,{attribute:Me.getAttributeNode(ie),from:Me})}catch{Ov(e.removed,{attribute:null,from:Me})}if(Me.removeAttribute(ie),ie==="is")if(he||Ae)try{Js(Me)}catch{}else try{Me.setAttribute(ie,"")}catch{}},jd=function(ie){let Me=null,Qe=null;if(Ee)ie="<remove></remove>"+ie;else{const vt=R9(ie,/^[\r\n\t ]+/);Qe=vt&&vt[0]}Ur==="application/xhtml+xml"&&Lr===$n&&(ie='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+ie+"</body></html>");const bt=z?z.createHTML(ie):ie;if(Lr===$n)try{Me=new C().parseFromString(bt,Ur)}catch{}if(!Me||!Me.documentElement){Me=re.createDocument(Lr,"template",null);try{Me.documentElement.innerHTML=Nr?q:bt}catch{}}const ut=Me.body||Me.documentElement;return ie&&Qe&&ut.insertBefore(r.createTextNode(Qe),ut.childNodes[0]||null),Lr===$n?me.call(Me,ce?"html":"body")[0]:ce?Me.documentElement:ut},ee=function(ie){return Y.call(ie.ownerDocument||ie,ie,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},ge=function(ie){return ie instanceof y&&(typeof ie.nodeName!="string"||typeof ie.textContent!="string"||typeof ie.removeChild!="function"||!(ie.attributes instanceof g)||typeof ie.removeAttribute!="function"||typeof ie.setAttribute!="function"||typeof ie.namespaceURI!="string"||typeof ie.insertBefore!="function"||typeof ie.hasChildNodes!="function")},ae=function(ie){return typeof l=="function"&&ie instanceof l};function le(Oe,ie,Me){_b(Oe,Qe=>{Qe.call(e,ie,Me,da)})}const ue=function(ie){let Me=null;if(le(Re.beforeSanitizeElements,ie,null),ge(ie))return Js(ie),!0;const Qe=ji(ie.nodeName);if(le(Re.uponSanitizeElement,ie,{tagName:Qe,allowedTags:A}),ie.hasChildNodes()&&!ae(ie.firstElementChild)&&zo(/<[/\w]/g,ie.innerHTML)&&zo(/<[/\w]/g,ie.textContent)||ie.nodeType===Mv.progressingInstruction||we&&ie.nodeType===Mv.comment&&zo(/<[/\w]/g,ie.data))return Js(ie),!0;if(!A[Qe]||K[Qe]){if(!K[Qe]&&ke(Qe)&&(D.tagNameCheck instanceof RegExp&&zo(D.tagNameCheck,Qe)||D.tagNameCheck instanceof Function&&D.tagNameCheck(Qe)))return!1;if(St&&!xr[Qe]){const bt=H(ie)||ie.parentNode,ut=F(ie)||ie.childNodes;if(ut&&bt){const vt=ut.length;for(let gr=vt-1;gr>=0;--gr){const Er=E(ut[gr],!0);Er.__removalCount=(ie.__removalCount||0)+1,bt.insertBefore(Er,I(ie))}}}return Js(ie),!0}return ie instanceof h&&!hi(ie)||(Qe==="noscript"||Qe==="noembed"||Qe==="noframes")&&zo(/<\/no(script|embed|frames)/i,ie.innerHTML)?(Js(ie),!0):(te&&ie.nodeType===Mv.text&&(Me=ie.textContent,_b([Ie,Be,lt],bt=>{Me=Iv(Me,bt," ")}),ie.textContent!==Me&&(Ov(e.removed,{element:ie.cloneNode()}),ie.textContent=Me)),le(Re.afterSanitizeElements,ie,null),!1)},ve=function(ie,Me,Qe){if(Le&&(Me==="id"||Me==="name")&&(Qe in r||Qe in ai))return!1;if(!(ye&&!Q[Me]&&zo(pt,Me))){if(!(pe&&zo(Ct,Me))){if(!k[Me]||Q[Me]){if(!(ke(ie)&&(D.tagNameCheck instanceof RegExp&&zo(D.tagNameCheck,ie)||D.tagNameCheck instanceof Function&&D.tagNameCheck(ie))&&(D.attributeNameCheck instanceof RegExp&&zo(D.attributeNameCheck,Me)||D.attributeNameCheck instanceof Function&&D.attributeNameCheck(Me))||Me==="is"&&D.allowCustomizedBuiltInElements&&(D.tagNameCheck instanceof RegExp&&zo(D.tagNameCheck,Qe)||D.tagNameCheck instanceof Function&&D.tagNameCheck(Qe))))return!1}else if(!xi[Me]){if(!zo(Fe,Iv(Qe,Ue,""))){if(!((Me==="src"||Me==="xlink:href"||Me==="href")&&ie!=="script"&&O1e(Qe,"data:")===0&&hr[ie])){if(!(j&&!zo(ct,Iv(Qe,Ue,"")))){if(Qe)return!1}}}}}}return!0},ke=function(ie){return ie!=="annotation-xml"&&R9(ie,Je)},Ye=function(ie){le(Re.beforeSanitizeAttributes,ie,null);const{attributes:Me}=ie;if(!Me||ge(ie))return;const Qe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k,forceKeepAttr:void 0};let bt=Me.length;for(;bt--;){const ut=Me[bt],{name:vt,namespaceURI:gr,value:Er}=ut,Br=ji(vt);let mn=vt==="value"?Er:I1e(Er);if(Qe.attrName=Br,Qe.attrValue=mn,Qe.keepAttr=!0,Qe.forceKeepAttr=void 0,le(Re.uponSanitizeAttribute,ie,Qe),mn=Qe.attrValue,Xe&&(Br==="id"||Br==="name")&&(pf(vt,ie),mn=Ft+mn),we&&zo(/((--!?|])>)|<\/(style|title)/i,mn)){pf(vt,ie);continue}if(Qe.forceKeepAttr||(pf(vt,ie),!Qe.keepAttr))continue;if(!X&&zo(/\/>/i,mn)){pf(vt,ie);continue}te&&_b([Ie,Be,lt],dl=>{mn=Iv(mn,dl," ")});const Ir=ji(ie.nodeName);if(ve(Ir,Br,mn)){if(z&&typeof x=="object"&&typeof x.getAttributeType=="function"&&!gr)switch(x.getAttributeType(Ir,Br)){case"TrustedHTML":{mn=z.createHTML(mn);break}case"TrustedScriptURL":{mn=z.createScriptURL(mn);break}}try{gr?ie.setAttributeNS(gr,vt,mn):ie.setAttribute(vt,mn),ge(ie)?Js(ie):_9(e.removed)}catch{}}}le(Re.afterSanitizeAttributes,ie,null)},$e=function Oe(ie){let Me=null;const Qe=ee(ie);for(le(Re.beforeSanitizeShadowDOM,ie,null);Me=Qe.nextNode();)le(Re.uponSanitizeShadowNode,Me,null),ue(Me),Ye(Me),Me.content instanceof n&&Oe(Me.content);le(Re.afterSanitizeShadowDOM,ie,null)};return e.sanitize=function(Oe){let ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=null,Qe=null,bt=null,ut=null;if(Nr=!Oe,Nr&&(Oe="<!-->"),typeof Oe!="string"&&!ae(Oe))if(typeof Oe.toString=="function"){if(Oe=Oe.toString(),typeof Oe!="string")throw Pv("dirty is not a string, aborting")}else throw Pv("toString is not a function");if(!e.isSupported)return Oe;if(_e||Gc(ie),e.removed=[],typeof Oe=="string"&&(zt=!1),zt){if(Oe.nodeName){const Er=ji(Oe.nodeName);if(!A[Er]||K[Er])throw Pv("root node is forbidden and cannot be sanitized in-place")}}else if(Oe instanceof l)Me=jd("<!---->"),Qe=Me.ownerDocument.importNode(Oe,!0),Qe.nodeType===Mv.element&&Qe.nodeName==="BODY"||Qe.nodeName==="HTML"?Me=Qe:Me.appendChild(Qe);else{if(!he&&!te&&!ce&&Oe.indexOf("<")===-1)return z&&Ne?z.createHTML(Oe):Oe;if(Me=jd(Oe),!Me)return he?null:Ne?q:""}Me&&Ee&&Js(Me.firstChild);const vt=ee(zt?Oe:Me);for(;bt=vt.nextNode();)ue(bt),Ye(bt),bt.content instanceof n&&$e(bt.content);if(zt)return Oe;if(he){if(Ae)for(ut=oe.call(Me.ownerDocument);Me.firstChild;)ut.appendChild(Me.firstChild);else ut=Me;return(k.shadowroot||k.shadowrootmode)&&(ut=de.call(i,ut,!0)),ut}let gr=ce?Me.outerHTML:Me.innerHTML;return ce&&A["!doctype"]&&Me.ownerDocument&&Me.ownerDocument.doctype&&Me.ownerDocument.doctype.name&&zo(LK,Me.ownerDocument.doctype.name)&&(gr="<!DOCTYPE "+Me.ownerDocument.doctype.name+`>
`+gr),te&&_b([Ie,Be,lt],Er=>{gr=Iv(gr,Er," ")}),z&&Ne?z.createHTML(gr):gr},e.setConfig=function(){let Oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gc(Oe),_e=!0},e.clearConfig=function(){da=null,_e=!1},e.isValidAttribute=function(Oe,ie,Me){da||Gc({});const Qe=ji(Oe),bt=ji(ie);return ve(Qe,bt,Me)},e.addHook=function(Oe,ie){typeof ie=="function"&&Ov(Re[Oe],ie)},e.removeHook=function(Oe){return _9(Re[Oe])},e.removeHooks=function(Oe){Re[Oe]=[]},e.removeAllHooks=function(){Re=M9()},e}var z1e=HK();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var $K;function mt(){return $K.apply(null,arguments)}function G1e(t){$K=t}function Dc(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function pg(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function wk(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Rn(t,e))return!1;return!0}function ba(t){return t===void 0}function tf(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function UC(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function BK(t,e){var r=[],i,s=t.length;for(i=0;i<s;++i)r.push(e(t[i],i));return r}function id(t,e){for(var r in e)Rn(e,r)&&(t[r]=e[r]);return Rn(e,"toString")&&(t.toString=e.toString),Rn(e,"valueOf")&&(t.valueOf=e.valueOf),t}function qu(t,e,r,i){return cX(t,e,r,i,!0).utc()}function Y1e(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Kr(t){return t._pf==null&&(t._pf=Y1e()),t._pf}var $P;Array.prototype.some?$P=Array.prototype.some:$P=function(t){var e=Object(this),r=e.length>>>0,i;for(i=0;i<r;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function yk(t){var e=null,r=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Kr(t),r=$P.call(e.parsedDateParts,function(s){return s!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function E_(t){var e=qu(NaN);return t!=null?id(Kr(e),t):Kr(e).userInvalidated=!0,e}var k9=mt.momentProperties=[],Q4=!1;function Ck(t,e){var r,i,s,n=k9.length;if(ba(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),ba(e._i)||(t._i=e._i),ba(e._f)||(t._f=e._f),ba(e._l)||(t._l=e._l),ba(e._strict)||(t._strict=e._strict),ba(e._tzm)||(t._tzm=e._tzm),ba(e._isUTC)||(t._isUTC=e._isUTC),ba(e._offset)||(t._offset=e._offset),ba(e._pf)||(t._pf=Kr(e)),ba(e._locale)||(t._locale=e._locale),n>0)for(r=0;r<n;r++)i=k9[r],s=e[i],ba(s)||(t[i]=s);return t}function zC(t){Ck(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Q4===!1&&(Q4=!0,mt.updateOffset(this),Q4=!1)}function Lc(t){return t instanceof zC||t!=null&&t._isAMomentObject!=null}function VK(t){mt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Xl(t,e){var r=!0;return id(function(){if(mt.deprecationHandler!=null&&mt.deprecationHandler(null,t),r){var i=[],s,n,o,l=arguments.length;for(n=0;n<l;n++){if(s="",typeof arguments[n]=="object"){s+=`
[`+n+"] ";for(o in arguments[0])Rn(arguments[0],o)&&(s+=o+": "+arguments[0][o]+", ");s=s.slice(0,-2)}else s=arguments[n];i.push(s)}VK(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var N9={};function WK(t,e){mt.deprecationHandler!=null&&mt.deprecationHandler(t,e),N9[t]||(VK(e),N9[t]=!0)}mt.suppressDeprecationWarnings=!1;mt.deprecationHandler=null;function Ju(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function K1e(t){var e,r;for(r in t)Rn(t,r)&&(e=t[r],Ju(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function BP(t,e){var r=id({},t),i;for(i in e)Rn(e,i)&&(pg(t[i])&&pg(e[i])?(r[i]={},id(r[i],t[i]),id(r[i],e[i])):e[i]!=null?r[i]=e[i]:delete r[i]);for(i in t)Rn(t,i)&&!Rn(e,i)&&pg(t[i])&&(r[i]=id({},r[i]));return r}function Sk(t){t!=null&&this.set(t)}var VP;Object.keys?VP=Object.keys:VP=function(t){var e,r=[];for(e in t)Rn(t,e)&&r.push(e);return r};var X1e={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function q1e(t,e,r){var i=this._calendar[t]||this._calendar.sameElse;return Ju(i)?i.call(e,r):i}function ju(t,e,r){var i=""+Math.abs(t),s=e-i.length,n=t>=0;return(n?r?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+i}var bk=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Ab=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Z4={},Vp={};function Tr(t,e,r,i){var s=i;typeof i=="string"&&(s=function(){return this[i]()}),t&&(Vp[t]=s),e&&(Vp[e[0]]=function(){return ju(s.apply(this,arguments),e[1],e[2])}),r&&(Vp[r]=function(){return this.localeData().ordinal(s.apply(this,arguments),t)})}function J1e(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Q1e(t){var e=t.match(bk),r,i;for(r=0,i=e.length;r<i;r++)Vp[e[r]]?e[r]=Vp[e[r]]:e[r]=J1e(e[r]);return function(s){var n="",o;for(o=0;o<i;o++)n+=Ju(e[o])?e[o].call(s,t):e[o];return n}}function N2(t,e){return t.isValid()?(e=jK(e,t.localeData()),Z4[e]=Z4[e]||Q1e(e),Z4[e](t)):t.localeData().invalidDate()}function jK(t,e){var r=5;function i(s){return e.longDateFormat(s)||s}for(Ab.lastIndex=0;r>=0&&Ab.test(t);)t=t.replace(Ab,i),Ab.lastIndex=0,r-=1;return t}var Z1e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function eve(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(bk).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var tve="Invalid date";function rve(){return this._invalidDate}var nve="%d",ive=/\d{1,2}/;function sve(t){return this._ordinal.replace("%d",t)}var ove={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ave(t,e,r,i){var s=this._relativeTime[r];return Ju(s)?s(t,e,r,i):s.replace(/%d/i,t)}function lve(t,e){var r=this._relativeTime[t>0?"future":"past"];return Ju(r)?r(e):r.replace(/%s/i,e)}var D9={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ql(t){return typeof t=="string"?D9[t]||D9[t.toLowerCase()]:void 0}function xk(t){var e={},r,i;for(i in t)Rn(t,i)&&(r=ql(i),r&&(e[r]=t[i]));return e}var cve={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uve(t){var e=[],r;for(r in t)Rn(t,r)&&e.push({unit:r,priority:cve[r]});return e.sort(function(i,s){return i.priority-s.priority}),e}var UK=/\d/,fl=/\d\d/,zK=/\d{3}/,Ek=/\d{4}/,T_=/[+-]?\d{6}/,bi=/\d\d?/,GK=/\d\d\d\d?/,YK=/\d\d\d\d\d\d?/,__=/\d{1,3}/,Tk=/\d{1,4}/,R_=/[+-]?\d{1,6}/,A1=/\d+/,A_=/[+-]?\d+/,hve=/Z|[+-]\d\d:?\d\d/gi,O_=/Z|[+-]\d\d(?::?\d\d)?/gi,fve=/[+-]?\d+(\.\d{1,3})?/,GC=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,O1=/^[1-9]\d?/,_k=/^([1-9]\d|\d)/,DE;DE={};function nr(t,e,r){DE[t]=Ju(e)?e:function(i,s){return i&&r?r:e}}function dve(t,e){return Rn(DE,t)?DE[t](e._strict,e._locale):new RegExp(gve(t))}function gve(t){return zh(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,i,s,n){return r||i||s||n}))}function zh(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Hl(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function gn(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Hl(e)),r}var WP={};function ri(t,e){var r,i=e,s;for(typeof t=="string"&&(t=[t]),tf(e)&&(i=function(n,o){o[e]=gn(n)}),s=t.length,r=0;r<s;r++)WP[t[r]]=i}function YC(t,e){ri(t,function(r,i,s,n){s._w=s._w||{},e(r,s._w,s,n)})}function mve(t,e,r){e!=null&&Rn(WP,t)&&WP[t](e,r._a,r,t)}function I_(t){return t%4===0&&t%100!==0||t%400===0}var No=0,Hh=1,ku=2,ks=3,Ac=4,$h=5,ig=6,pve=7,vve=8;Tr("Y",0,0,function(){var t=this.year();return t<=9999?ju(t,4):"+"+t});Tr(0,["YY",2],0,function(){return this.year()%100});Tr(0,["YYYY",4],0,"year");Tr(0,["YYYYY",5],0,"year");Tr(0,["YYYYYY",6,!0],0,"year");nr("Y",A_);nr("YY",bi,fl);nr("YYYY",Tk,Ek);nr("YYYYY",R_,T_);nr("YYYYYY",R_,T_);ri(["YYYYY","YYYYYY"],No);ri("YYYY",function(t,e){e[No]=t.length===2?mt.parseTwoDigitYear(t):gn(t)});ri("YY",function(t,e){e[No]=mt.parseTwoDigitYear(t)});ri("Y",function(t,e){e[No]=parseInt(t,10)});function ny(t){return I_(t)?366:365}mt.parseTwoDigitYear=function(t){return gn(t)+(gn(t)>68?1900:2e3)};var KK=I1("FullYear",!0);function wve(){return I_(this.year())}function I1(t,e){return function(r){return r!=null?(XK(this,t,r),mt.updateOffset(this,e),this):Qy(this,t)}}function Qy(t,e){if(!t.isValid())return NaN;var r=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return i?r.getUTCSeconds():r.getSeconds();case"Minutes":return i?r.getUTCMinutes():r.getMinutes();case"Hours":return i?r.getUTCHours():r.getHours();case"Date":return i?r.getUTCDate():r.getDate();case"Day":return i?r.getUTCDay():r.getDay();case"Month":return i?r.getUTCMonth():r.getMonth();case"FullYear":return i?r.getUTCFullYear():r.getFullYear();default:return NaN}}function XK(t,e,r){var i,s,n,o,l;if(!(!t.isValid()||isNaN(r))){switch(i=t._d,s=t._isUTC,e){case"Milliseconds":return void(s?i.setUTCMilliseconds(r):i.setMilliseconds(r));case"Seconds":return void(s?i.setUTCSeconds(r):i.setSeconds(r));case"Minutes":return void(s?i.setUTCMinutes(r):i.setMinutes(r));case"Hours":return void(s?i.setUTCHours(r):i.setHours(r));case"Date":return void(s?i.setUTCDate(r):i.setDate(r));case"FullYear":break;default:return}n=r,o=t.month(),l=t.date(),l=l===29&&o===1&&!I_(n)?28:l,s?i.setUTCFullYear(n,o,l):i.setFullYear(n,o,l)}}function yve(t){return t=ql(t),Ju(this[t])?this[t]():this}function Cve(t,e){if(typeof t=="object"){t=xk(t);var r=uve(t),i,s=r.length;for(i=0;i<s;i++)this[r[i].unit](t[r[i].unit])}else if(t=ql(t),Ju(this[t]))return this[t](e);return this}function Sve(t,e){return(t%e+e)%e}var is;Array.prototype.indexOf?is=Array.prototype.indexOf:is=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Rk(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=Sve(e,12);return t+=(e-r)/12,r===1?I_(t)?29:28:31-r%7%2}Tr("M",["MM",2],"Mo",function(){return this.month()+1});Tr("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Tr("MMMM",0,0,function(t){return this.localeData().months(this,t)});nr("M",bi,O1);nr("MM",bi,fl);nr("MMM",function(t,e){return e.monthsShortRegex(t)});nr("MMMM",function(t,e){return e.monthsRegex(t)});ri(["M","MM"],function(t,e){e[Hh]=gn(t)-1});ri(["MMM","MMMM"],function(t,e,r,i){var s=r._locale.monthsParse(t,i,r._strict);s!=null?e[Hh]=s:Kr(r).invalidMonth=t});var bve="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),qK="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),JK=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,xve=GC,Eve=GC;function Tve(t,e){return t?Dc(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||JK).test(e)?"format":"standalone"][t.month()]:Dc(this._months)?this._months:this._months.standalone}function _ve(t,e){return t?Dc(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[JK.test(e)?"format":"standalone"][t.month()]:Dc(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Rve(t,e,r){var i,s,n,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)n=qu([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(n,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(n,"").toLocaleLowerCase();return r?e==="MMM"?(s=is.call(this._shortMonthsParse,o),s!==-1?s:null):(s=is.call(this._longMonthsParse,o),s!==-1?s:null):e==="MMM"?(s=is.call(this._shortMonthsParse,o),s!==-1?s:(s=is.call(this._longMonthsParse,o),s!==-1?s:null)):(s=is.call(this._longMonthsParse,o),s!==-1?s:(s=is.call(this._shortMonthsParse,o),s!==-1?s:null))}function Ave(t,e,r){var i,s,n;if(this._monthsParseExact)return Rve.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(s=qu([2e3,i]),r&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!r&&!this._monthsParse[i]&&(n="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[i]=new RegExp(n.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(r&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!r&&this._monthsParse[i].test(t))return i}}function QK(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=gn(e);else if(e=t.localeData().monthsParse(e),!tf(e))return t}var r=e,i=t.date();return i=i<29?i:Math.min(i,Rk(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,i):t._d.setMonth(r,i),t}function ZK(t){return t!=null?(QK(this,t),mt.updateOffset(this,!0),this):Qy(this,"Month")}function Ove(){return Rk(this.year(),this.month())}function Ive(t){return this._monthsParseExact?(Rn(this,"_monthsRegex")||eX.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Rn(this,"_monthsShortRegex")||(this._monthsShortRegex=xve),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Pve(t){return this._monthsParseExact?(Rn(this,"_monthsRegex")||eX.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Rn(this,"_monthsRegex")||(this._monthsRegex=Eve),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function eX(){function t(h,d){return d.length-h.length}var e=[],r=[],i=[],s,n,o,l;for(s=0;s<12;s++)n=qu([2e3,s]),o=zh(this.monthsShort(n,"")),l=zh(this.months(n,"")),e.push(o),r.push(l),i.push(l),i.push(o);e.sort(t),r.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Fve(t,e,r,i,s,n,o){var l;return t<100&&t>=0?(l=new Date(t+400,e,r,i,s,n,o),isFinite(l.getFullYear())&&l.setFullYear(t)):l=new Date(t,e,r,i,s,n,o),l}function Zy(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function LE(t,e,r){var i=7+e-r,s=(7+Zy(t,0,i).getUTCDay()-e)%7;return-s+i-1}function tX(t,e,r,i,s){var n=(7+r-i)%7,o=LE(t,i,s),l=1+7*(e-1)+n+o,h,d;return l<=0?(h=t-1,d=ny(h)+l):l>ny(t)?(h=t+1,d=l-ny(t)):(h=t,d=l),{year:h,dayOfYear:d}}function eC(t,e,r){var i=LE(t.year(),e,r),s=Math.floor((t.dayOfYear()-i-1)/7)+1,n,o;return s<1?(o=t.year()-1,n=s+Gh(o,e,r)):s>Gh(t.year(),e,r)?(n=s-Gh(t.year(),e,r),o=t.year()+1):(o=t.year(),n=s),{week:n,year:o}}function Gh(t,e,r){var i=LE(t,e,r),s=LE(t+1,e,r);return(ny(t)-i+s)/7}Tr("w",["ww",2],"wo","week");Tr("W",["WW",2],"Wo","isoWeek");nr("w",bi,O1);nr("ww",bi,fl);nr("W",bi,O1);nr("WW",bi,fl);YC(["w","ww","W","WW"],function(t,e,r,i){e[i.substr(0,1)]=gn(t)});function Mve(t){return eC(t,this._week.dow,this._week.doy).week}var kve={dow:0,doy:6};function Nve(){return this._week.dow}function Dve(){return this._week.doy}function Lve(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Hve(t){var e=eC(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Tr("d",0,"do","day");Tr("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Tr("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Tr("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Tr("e",0,0,"weekday");Tr("E",0,0,"isoWeekday");nr("d",bi);nr("e",bi);nr("E",bi);nr("dd",function(t,e){return e.weekdaysMinRegex(t)});nr("ddd",function(t,e){return e.weekdaysShortRegex(t)});nr("dddd",function(t,e){return e.weekdaysRegex(t)});YC(["dd","ddd","dddd"],function(t,e,r,i){var s=r._locale.weekdaysParse(t,i,r._strict);s!=null?e.d=s:Kr(r).invalidWeekday=t});YC(["d","e","E"],function(t,e,r,i){e[i]=gn(t)});function $ve(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Bve(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Ak(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Vve="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),rX="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Wve="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),jve=GC,Uve=GC,zve=GC;function Gve(t,e){var r=Dc(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Ak(r,this._week.dow):t?r[t.day()]:r}function Yve(t){return t===!0?Ak(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Kve(t){return t===!0?Ak(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Xve(t,e,r){var i,s,n,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)n=qu([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(n,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(n,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(n,"").toLocaleLowerCase();return r?e==="dddd"?(s=is.call(this._weekdaysParse,o),s!==-1?s:null):e==="ddd"?(s=is.call(this._shortWeekdaysParse,o),s!==-1?s:null):(s=is.call(this._minWeekdaysParse,o),s!==-1?s:null):e==="dddd"?(s=is.call(this._weekdaysParse,o),s!==-1||(s=is.call(this._shortWeekdaysParse,o),s!==-1)?s:(s=is.call(this._minWeekdaysParse,o),s!==-1?s:null)):e==="ddd"?(s=is.call(this._shortWeekdaysParse,o),s!==-1||(s=is.call(this._weekdaysParse,o),s!==-1)?s:(s=is.call(this._minWeekdaysParse,o),s!==-1?s:null)):(s=is.call(this._minWeekdaysParse,o),s!==-1||(s=is.call(this._weekdaysParse,o),s!==-1)?s:(s=is.call(this._shortWeekdaysParse,o),s!==-1?s:null))}function qve(t,e,r){var i,s,n;if(this._weekdaysParseExact)return Xve.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(s=qu([2e3,1]).day(i),r&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(n="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[i]=new RegExp(n.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(r&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(r&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!r&&this._weekdaysParse[i].test(t))return i}}function Jve(t){if(!this.isValid())return t!=null?this:NaN;var e=Qy(this,"Day");return t!=null?(t=$ve(t,this.localeData()),this.add(t-e,"d")):e}function Qve(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Zve(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Bve(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function ewe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ok.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Rn(this,"_weekdaysRegex")||(this._weekdaysRegex=jve),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function twe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ok.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Rn(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Uve),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function rwe(t){return this._weekdaysParseExact?(Rn(this,"_weekdaysRegex")||Ok.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Rn(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=zve),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ok(){function t(g,y){return y.length-g.length}var e=[],r=[],i=[],s=[],n,o,l,h,d;for(n=0;n<7;n++)o=qu([2e3,1]).day(n),l=zh(this.weekdaysMin(o,"")),h=zh(this.weekdaysShort(o,"")),d=zh(this.weekdays(o,"")),e.push(l),r.push(h),i.push(d),s.push(l),s.push(h),s.push(d);e.sort(t),r.sort(t),i.sort(t),s.sort(t),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Ik(){return this.hours()%12||12}function nwe(){return this.hours()||24}Tr("H",["HH",2],0,"hour");Tr("h",["hh",2],0,Ik);Tr("k",["kk",2],0,nwe);Tr("hmm",0,0,function(){return""+Ik.apply(this)+ju(this.minutes(),2)});Tr("hmmss",0,0,function(){return""+Ik.apply(this)+ju(this.minutes(),2)+ju(this.seconds(),2)});Tr("Hmm",0,0,function(){return""+this.hours()+ju(this.minutes(),2)});Tr("Hmmss",0,0,function(){return""+this.hours()+ju(this.minutes(),2)+ju(this.seconds(),2)});function nX(t,e){Tr(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}nX("a",!0);nX("A",!1);function iX(t,e){return e._meridiemParse}nr("a",iX);nr("A",iX);nr("H",bi,_k);nr("h",bi,O1);nr("k",bi,O1);nr("HH",bi,fl);nr("hh",bi,fl);nr("kk",bi,fl);nr("hmm",GK);nr("hmmss",YK);nr("Hmm",GK);nr("Hmmss",YK);ri(["H","HH"],ks);ri(["k","kk"],function(t,e,r){var i=gn(t);e[ks]=i===24?0:i});ri(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});ri(["h","hh"],function(t,e,r){e[ks]=gn(t),Kr(r).bigHour=!0});ri("hmm",function(t,e,r){var i=t.length-2;e[ks]=gn(t.substr(0,i)),e[Ac]=gn(t.substr(i)),Kr(r).bigHour=!0});ri("hmmss",function(t,e,r){var i=t.length-4,s=t.length-2;e[ks]=gn(t.substr(0,i)),e[Ac]=gn(t.substr(i,2)),e[$h]=gn(t.substr(s)),Kr(r).bigHour=!0});ri("Hmm",function(t,e,r){var i=t.length-2;e[ks]=gn(t.substr(0,i)),e[Ac]=gn(t.substr(i))});ri("Hmmss",function(t,e,r){var i=t.length-4,s=t.length-2;e[ks]=gn(t.substr(0,i)),e[Ac]=gn(t.substr(i,2)),e[$h]=gn(t.substr(s))});function iwe(t){return(t+"").toLowerCase().charAt(0)==="p"}var swe=/[ap]\.?m?\.?/i,owe=I1("Hours",!0);function awe(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var sX={calendar:X1e,longDateFormat:Z1e,invalidDate:tve,ordinal:nve,dayOfMonthOrdinalParse:ive,relativeTime:ove,months:bve,monthsShort:qK,week:kve,weekdays:Vve,weekdaysMin:Wve,weekdaysShort:rX,meridiemParse:swe},_i={},kv={},tC;function lwe(t,e){var r,i=Math.min(t.length,e.length);for(r=0;r<i;r+=1)if(t[r]!==e[r])return r;return i}function L9(t){return t&&t.toLowerCase().replace("_","-")}function cwe(t){for(var e=0,r,i,s,n;e<t.length;){for(n=L9(t[e]).split("-"),r=n.length,i=L9(t[e+1]),i=i?i.split("-"):null;r>0;){if(s=P_(n.slice(0,r).join("-")),s)return s;if(i&&i.length>=r&&lwe(n,i)>=r-1)break;r--}e++}return tC}function uwe(t){return!!(t&&t.match("^[^/\\\\]*$"))}function P_(t){var e=null,r;if(_i[t]===void 0&&typeof iE<"u"&&iE&&iE.exports&&uwe(t))try{e=tC._abbr,r=require,r("./locale/"+t),Sd(e)}catch{_i[t]=null}return _i[t]}function Sd(t,e){var r;return t&&(ba(e)?r=uf(t):r=Pk(t,e),r?tC=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),tC._abbr}function Pk(t,e){if(e!==null){var r,i=sX;if(e.abbr=t,_i[t]!=null)WK("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=_i[t]._config;else if(e.parentLocale!=null)if(_i[e.parentLocale]!=null)i=_i[e.parentLocale]._config;else if(r=P_(e.parentLocale),r!=null)i=r._config;else return kv[e.parentLocale]||(kv[e.parentLocale]=[]),kv[e.parentLocale].push({name:t,config:e}),null;return _i[t]=new Sk(BP(i,e)),kv[t]&&kv[t].forEach(function(s){Pk(s.name,s.config)}),Sd(t),_i[t]}else return delete _i[t],null}function hwe(t,e){if(e!=null){var r,i,s=sX;_i[t]!=null&&_i[t].parentLocale!=null?_i[t].set(BP(_i[t]._config,e)):(i=P_(t),i!=null&&(s=i._config),e=BP(s,e),i==null&&(e.abbr=t),r=new Sk(e),r.parentLocale=_i[t],_i[t]=r),Sd(t)}else _i[t]!=null&&(_i[t].parentLocale!=null?(_i[t]=_i[t].parentLocale,t===Sd()&&Sd(t)):_i[t]!=null&&delete _i[t]);return _i[t]}function uf(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return tC;if(!Dc(t)){if(e=P_(t),e)return e;t=[t]}return cwe(t)}function fwe(){return VP(_i)}function Fk(t){var e,r=t._a;return r&&Kr(t).overflow===-2&&(e=r[Hh]<0||r[Hh]>11?Hh:r[ku]<1||r[ku]>Rk(r[No],r[Hh])?ku:r[ks]<0||r[ks]>24||r[ks]===24&&(r[Ac]!==0||r[$h]!==0||r[ig]!==0)?ks:r[Ac]<0||r[Ac]>59?Ac:r[$h]<0||r[$h]>59?$h:r[ig]<0||r[ig]>999?ig:-1,Kr(t)._overflowDayOfYear&&(e<No||e>ku)&&(e=ku),Kr(t)._overflowWeeks&&e===-1&&(e=pve),Kr(t)._overflowWeekday&&e===-1&&(e=vve),Kr(t).overflow=e),t}var dwe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gwe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mwe=/Z|[+-]\d\d(?::?\d\d)?/,Ob=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],eO=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],pwe=/^\/?Date\((-?\d+)/i,vwe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wwe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function oX(t){var e,r,i=t._i,s=dwe.exec(i)||gwe.exec(i),n,o,l,h,d=Ob.length,g=eO.length;if(s){for(Kr(t).iso=!0,e=0,r=d;e<r;e++)if(Ob[e][1].exec(s[1])){o=Ob[e][0],n=Ob[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(s[3]){for(e=0,r=g;e<r;e++)if(eO[e][1].exec(s[3])){l=(s[2]||" ")+eO[e][0];break}if(l==null){t._isValid=!1;return}}if(!n&&l!=null){t._isValid=!1;return}if(s[4])if(mwe.exec(s[4]))h="Z";else{t._isValid=!1;return}t._f=o+(l||"")+(h||""),kk(t)}else t._isValid=!1}function ywe(t,e,r,i,s,n){var o=[Cwe(t),qK.indexOf(e),parseInt(r,10),parseInt(i,10),parseInt(s,10)];return n&&o.push(parseInt(n,10)),o}function Cwe(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Swe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function bwe(t,e,r){if(t){var i=rX.indexOf(t),s=new Date(e[0],e[1],e[2]).getDay();if(i!==s)return Kr(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function xwe(t,e,r){if(t)return wwe[t];if(e)return 0;var i=parseInt(r,10),s=i%100,n=(i-s)/100;return n*60+s}function aX(t){var e=vwe.exec(Swe(t._i)),r;if(e){if(r=ywe(e[4],e[3],e[2],e[5],e[6],e[7]),!bwe(e[1],r,t))return;t._a=r,t._tzm=xwe(e[8],e[9],e[10]),t._d=Zy.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Kr(t).rfc2822=!0}else t._isValid=!1}function Ewe(t){var e=pwe.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(oX(t),t._isValid===!1)delete t._isValid;else return;if(aX(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:mt.createFromInputFallback(t)}mt.createFromInputFallback=Xl("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function sp(t,e,r){return t??e??r}function Twe(t){var e=new Date(mt.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Mk(t){var e,r,i=[],s,n,o;if(!t._d){for(s=Twe(t),t._w&&t._a[ku]==null&&t._a[Hh]==null&&_we(t),t._dayOfYear!=null&&(o=sp(t._a[No],s[No]),(t._dayOfYear>ny(o)||t._dayOfYear===0)&&(Kr(t)._overflowDayOfYear=!0),r=Zy(o,0,t._dayOfYear),t._a[Hh]=r.getUTCMonth(),t._a[ku]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=s[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[ks]===24&&t._a[Ac]===0&&t._a[$h]===0&&t._a[ig]===0&&(t._nextDay=!0,t._a[ks]=0),t._d=(t._useUTC?Zy:Fve).apply(null,i),n=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[ks]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==n&&(Kr(t).weekdayMismatch=!0)}}function _we(t){var e,r,i,s,n,o,l,h,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(n=1,o=4,r=sp(e.GG,t._a[No],eC(Ci(),1,4).year),i=sp(e.W,1),s=sp(e.E,1),(s<1||s>7)&&(h=!0)):(n=t._locale._week.dow,o=t._locale._week.doy,d=eC(Ci(),n,o),r=sp(e.gg,t._a[No],d.year),i=sp(e.w,d.week),e.d!=null?(s=e.d,(s<0||s>6)&&(h=!0)):e.e!=null?(s=e.e+n,(e.e<0||e.e>6)&&(h=!0)):s=n),i<1||i>Gh(r,n,o)?Kr(t)._overflowWeeks=!0:h!=null?Kr(t)._overflowWeekday=!0:(l=tX(r,i,s,n,o),t._a[No]=l.year,t._dayOfYear=l.dayOfYear)}mt.ISO_8601=function(){};mt.RFC_2822=function(){};function kk(t){if(t._f===mt.ISO_8601){oX(t);return}if(t._f===mt.RFC_2822){aX(t);return}t._a=[],Kr(t).empty=!0;var e=""+t._i,r,i,s,n,o,l=e.length,h=0,d,g;for(s=jK(t._f,t._locale).match(bk)||[],g=s.length,r=0;r<g;r++)n=s[r],i=(e.match(dve(n,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&Kr(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),h+=i.length),Vp[n]?(i?Kr(t).empty=!1:Kr(t).unusedTokens.push(n),mve(n,i,t)):t._strict&&!i&&Kr(t).unusedTokens.push(n);Kr(t).charsLeftOver=l-h,e.length>0&&Kr(t).unusedInput.push(e),t._a[ks]<=12&&Kr(t).bigHour===!0&&t._a[ks]>0&&(Kr(t).bigHour=void 0),Kr(t).parsedDateParts=t._a.slice(0),Kr(t).meridiem=t._meridiem,t._a[ks]=Rwe(t._locale,t._a[ks],t._meridiem),d=Kr(t).era,d!==null&&(t._a[No]=t._locale.erasConvertYear(d,t._a[No])),Mk(t),Fk(t)}function Rwe(t,e,r){var i;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(i=t.isPM(r),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Awe(t){var e,r,i,s,n,o,l=!1,h=t._f.length;if(h===0){Kr(t).invalidFormat=!0,t._d=new Date(NaN);return}for(s=0;s<h;s++)n=0,o=!1,e=Ck({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[s],kk(e),yk(e)&&(o=!0),n+=Kr(e).charsLeftOver,n+=Kr(e).unusedTokens.length*10,Kr(e).score=n,l?n<i&&(i=n,r=e):(i==null||n<i||o)&&(i=n,r=e,o&&(l=!0));id(t,r||e)}function Owe(t){if(!t._d){var e=xk(t._i),r=e.day===void 0?e.date:e.day;t._a=BK([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),Mk(t)}}function Iwe(t){var e=new zC(Fk(lX(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function lX(t){var e=t._i,r=t._f;return t._locale=t._locale||uf(t._l),e===null||r===void 0&&e===""?E_({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),Lc(e)?new zC(Fk(e)):(UC(e)?t._d=e:Dc(r)?Awe(t):r?kk(t):Pwe(t),yk(t)||(t._d=null),t))}function Pwe(t){var e=t._i;ba(e)?t._d=new Date(mt.now()):UC(e)?t._d=new Date(e.valueOf()):typeof e=="string"?Ewe(t):Dc(e)?(t._a=BK(e.slice(0),function(r){return parseInt(r,10)}),Mk(t)):pg(e)?Owe(t):tf(e)?t._d=new Date(e):mt.createFromInputFallback(t)}function cX(t,e,r,i,s){var n={};return(e===!0||e===!1)&&(i=e,e=void 0),(r===!0||r===!1)&&(i=r,r=void 0),(pg(t)&&wk(t)||Dc(t)&&t.length===0)&&(t=void 0),n._isAMomentObject=!0,n._useUTC=n._isUTC=s,n._l=r,n._i=t,n._f=e,n._strict=i,Iwe(n)}function Ci(t,e,r,i){return cX(t,e,r,i,!1)}var Fwe=Xl("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ci.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:E_()}),Mwe=Xl("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Ci.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:E_()});function uX(t,e){var r,i;if(e.length===1&&Dc(e[0])&&(e=e[0]),!e.length)return Ci();for(r=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](r))&&(r=e[i]);return r}function kwe(){var t=[].slice.call(arguments,0);return uX("isBefore",t)}function Nwe(){var t=[].slice.call(arguments,0);return uX("isAfter",t)}var Dwe=function(){return Date.now?Date.now():+new Date},Nv=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Lwe(t){var e,r=!1,i,s=Nv.length;for(e in t)if(Rn(t,e)&&!(is.call(Nv,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<s;++i)if(t[Nv[i]]){if(r)return!1;parseFloat(t[Nv[i]])!==gn(t[Nv[i]])&&(r=!0)}return!0}function Hwe(){return this._isValid}function $we(){return Wc(NaN)}function F_(t){var e=xk(t),r=e.year||0,i=e.quarter||0,s=e.month||0,n=e.week||e.isoWeek||0,o=e.day||0,l=e.hour||0,h=e.minute||0,d=e.second||0,g=e.millisecond||0;this._isValid=Lwe(e),this._milliseconds=+g+d*1e3+h*6e4+l*1e3*60*60,this._days=+o+n*7,this._months=+s+i*3+r*12,this._data={},this._locale=uf(),this._bubble()}function D2(t){return t instanceof F_}function jP(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Bwe(t,e,r){var i=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),n=0,o;for(o=0;o<i;o++)gn(t[o])!==gn(e[o])&&n++;return n+s}function hX(t,e){Tr(t,0,0,function(){var r=this.utcOffset(),i="+";return r<0&&(r=-r,i="-"),i+ju(~~(r/60),2)+e+ju(~~r%60,2)})}hX("Z",":");hX("ZZ","");nr("Z",O_);nr("ZZ",O_);ri(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=Nk(O_,t)});var Vwe=/([\+\-]|\d\d)/gi;function Nk(t,e){var r=(e||"").match(t),i,s,n;return r===null?null:(i=r[r.length-1]||[],s=(i+"").match(Vwe)||["-",0,0],n=+(s[1]*60)+gn(s[2]),n===0?0:s[0]==="+"?n:-n)}function Dk(t,e){var r,i;return e._isUTC?(r=e.clone(),i=(Lc(t)||UC(t)?t.valueOf():Ci(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),mt.updateOffset(r,!1),r):Ci(t).local()}function UP(t){return-Math.round(t._d.getTimezoneOffset())}mt.updateOffset=function(){};function Wwe(t,e,r){var i=this._offset||0,s;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Nk(O_,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(s=UP(this)),this._offset=t,this._isUTC=!0,s!=null&&this.add(s,"m"),i!==t&&(!e||this._changeInProgress?gX(this,Wc(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,mt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:UP(this)}function jwe(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Uwe(t){return this.utcOffset(0,t)}function zwe(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(UP(this),"m")),this}function Gwe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Nk(hve,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Ywe(t){return this.isValid()?(t=t?Ci(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Kwe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Xwe(){if(!ba(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Ck(t,this),t=lX(t),t._a?(e=t._isUTC?qu(t._a):Ci(t._a),this._isDSTShifted=this.isValid()&&Bwe(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function qwe(){return this.isValid()?!this._isUTC:!1}function Jwe(){return this.isValid()?this._isUTC:!1}function fX(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Qwe=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Zwe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Wc(t,e){var r=t,i=null,s,n,o;return D2(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:tf(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(i=Qwe.exec(t))?(s=i[1]==="-"?-1:1,r={y:0,d:gn(i[ku])*s,h:gn(i[ks])*s,m:gn(i[Ac])*s,s:gn(i[$h])*s,ms:gn(jP(i[ig]*1e3))*s}):(i=Zwe.exec(t))?(s=i[1]==="-"?-1:1,r={y:a0(i[2],s),M:a0(i[3],s),w:a0(i[4],s),d:a0(i[5],s),h:a0(i[6],s),m:a0(i[7],s),s:a0(i[8],s)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=eye(Ci(r.from),Ci(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),n=new F_(r),D2(t)&&Rn(t,"_locale")&&(n._locale=t._locale),D2(t)&&Rn(t,"_isValid")&&(n._isValid=t._isValid),n}Wc.fn=F_.prototype;Wc.invalid=$we;function a0(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function H9(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function eye(t,e){var r;return t.isValid()&&e.isValid()?(e=Dk(e,t),t.isBefore(e)?r=H9(t,e):(r=H9(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function dX(t,e){return function(r,i){var s,n;return i!==null&&!isNaN(+i)&&(WK(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=r,r=i,i=n),s=Wc(r,i),gX(this,s,t),this}}function gX(t,e,r,i){var s=e._milliseconds,n=jP(e._days),o=jP(e._months);t.isValid()&&(i=i??!0,o&&QK(t,Qy(t,"Month")+o*r),n&&XK(t,"Date",Qy(t,"Date")+n*r),s&&t._d.setTime(t._d.valueOf()+s*r),i&&mt.updateOffset(t,n||o))}var tye=dX(1,"add"),rye=dX(-1,"subtract");function mX(t){return typeof t=="string"||t instanceof String}function nye(t){return Lc(t)||UC(t)||mX(t)||tf(t)||sye(t)||iye(t)||t===null||t===void 0}function iye(t){var e=pg(t)&&!wk(t),r=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,n,o=i.length;for(s=0;s<o;s+=1)n=i[s],r=r||Rn(t,n);return e&&r}function sye(t){var e=Dc(t),r=!1;return e&&(r=t.filter(function(i){return!tf(i)&&mX(t)}).length===0),e&&r}function oye(t){var e=pg(t)&&!wk(t),r=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,n;for(s=0;s<i.length;s+=1)n=i[s],r=r||Rn(t,n);return e&&r}function aye(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function lye(t,e){arguments.length===1&&(arguments[0]?nye(arguments[0])?(t=arguments[0],e=void 0):oye(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||Ci(),i=Dk(r,this).startOf("day"),s=mt.calendarFormat(this,i)||"sameElse",n=e&&(Ju(e[s])?e[s].call(this,r):e[s]);return this.format(n||this.localeData().calendar(s,this,Ci(r)))}function cye(){return new zC(this)}function uye(t,e){var r=Lc(t)?t:Ci(t);return this.isValid()&&r.isValid()?(e=ql(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function hye(t,e){var r=Lc(t)?t:Ci(t);return this.isValid()&&r.isValid()?(e=ql(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function fye(t,e,r,i){var s=Lc(t)?t:Ci(t),n=Lc(e)?e:Ci(e);return this.isValid()&&s.isValid()&&n.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(s,r):!this.isBefore(s,r))&&(i[1]===")"?this.isBefore(n,r):!this.isAfter(n,r))):!1}function dye(t,e){var r=Lc(t)?t:Ci(t),i;return this.isValid()&&r.isValid()?(e=ql(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(i=r.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function gye(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function mye(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function pye(t,e,r){var i,s,n;if(!this.isValid())return NaN;if(i=Dk(t,this),!i.isValid())return NaN;switch(s=(i.utcOffset()-this.utcOffset())*6e4,e=ql(e),e){case"year":n=L2(this,i)/12;break;case"month":n=L2(this,i);break;case"quarter":n=L2(this,i)/3;break;case"second":n=(this-i)/1e3;break;case"minute":n=(this-i)/6e4;break;case"hour":n=(this-i)/36e5;break;case"day":n=(this-i-s)/864e5;break;case"week":n=(this-i-s)/6048e5;break;default:n=this-i}return r?n:Hl(n)}function L2(t,e){if(t.date()<e.date())return-L2(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(r,"months"),s,n;return e-i<0?(s=t.clone().add(r-1,"months"),n=(e-i)/(i-s)):(s=t.clone().add(r+1,"months"),n=(e-i)/(s-i)),-(r+n)||0}mt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";mt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function vye(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function wye(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?N2(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ju(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",N2(r,"Z")):N2(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function yye(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,i,s,n;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",n=e+'[")]',this.format(r+i+s+n)}function Cye(t){t||(t=this.isUtc()?mt.defaultFormatUtc:mt.defaultFormat);var e=N2(this,t);return this.localeData().postformat(e)}function Sye(t,e){return this.isValid()&&(Lc(t)&&t.isValid()||Ci(t).isValid())?Wc({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function bye(t){return this.from(Ci(),t)}function xye(t,e){return this.isValid()&&(Lc(t)&&t.isValid()||Ci(t).isValid())?Wc({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Eye(t){return this.to(Ci(),t)}function pX(t){var e;return t===void 0?this._locale._abbr:(e=uf(t),e!=null&&(this._locale=e),this)}var vX=Xl("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function wX(){return this._locale}var HE=1e3,Wp=60*HE,$E=60*Wp,yX=(365*400+97)*24*$E;function jp(t,e){return(t%e+e)%e}function CX(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-yX:new Date(t,e,r).valueOf()}function SX(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-yX:Date.UTC(t,e,r)}function Tye(t){var e,r;if(t=ql(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?SX:CX,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=jp(e+(this._isUTC?0:this.utcOffset()*Wp),$E);break;case"minute":e=this._d.valueOf(),e-=jp(e,Wp);break;case"second":e=this._d.valueOf(),e-=jp(e,HE);break}return this._d.setTime(e),mt.updateOffset(this,!0),this}function _ye(t){var e,r;if(t=ql(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?SX:CX,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=$E-jp(e+(this._isUTC?0:this.utcOffset()*Wp),$E)-1;break;case"minute":e=this._d.valueOf(),e+=Wp-jp(e,Wp)-1;break;case"second":e=this._d.valueOf(),e+=HE-jp(e,HE)-1;break}return this._d.setTime(e),mt.updateOffset(this,!0),this}function Rye(){return this._d.valueOf()-(this._offset||0)*6e4}function Aye(){return Math.floor(this.valueOf()/1e3)}function Oye(){return new Date(this.valueOf())}function Iye(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Pye(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Fye(){return this.isValid()?this.toISOString():null}function Mye(){return yk(this)}function kye(){return id({},Kr(this))}function Nye(){return Kr(this).overflow}function Dye(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Tr("N",0,0,"eraAbbr");Tr("NN",0,0,"eraAbbr");Tr("NNN",0,0,"eraAbbr");Tr("NNNN",0,0,"eraName");Tr("NNNNN",0,0,"eraNarrow");Tr("y",["y",1],"yo","eraYear");Tr("y",["yy",2],0,"eraYear");Tr("y",["yyy",3],0,"eraYear");Tr("y",["yyyy",4],0,"eraYear");nr("N",Lk);nr("NN",Lk);nr("NNN",Lk);nr("NNNN",Yye);nr("NNNNN",Kye);ri(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,i){var s=r._locale.erasParse(t,i,r._strict);s?Kr(r).era=s:Kr(r).invalidEra=t});nr("y",A1);nr("yy",A1);nr("yyy",A1);nr("yyyy",A1);nr("yo",Xye);ri(["y","yy","yyy","yyyy"],No);ri(["yo"],function(t,e,r,i){var s;r._locale._eraYearOrdinalRegex&&(s=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[No]=r._locale.eraYearOrdinalParse(t,s):e[No]=parseInt(t,10)});function Lye(t,e){var r,i,s,n=this._eras||uf("en")._eras;for(r=0,i=n.length;r<i;++r){switch(typeof n[r].since){case"string":s=mt(n[r].since).startOf("day"),n[r].since=s.valueOf();break}switch(typeof n[r].until){case"undefined":n[r].until=1/0;break;case"string":s=mt(n[r].until).startOf("day").valueOf(),n[r].until=s.valueOf();break}}return n}function Hye(t,e,r){var i,s,n=this.eras(),o,l,h;for(t=t.toUpperCase(),i=0,s=n.length;i<s;++i)if(o=n[i].name.toUpperCase(),l=n[i].abbr.toUpperCase(),h=n[i].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(l===t)return n[i];break;case"NNNN":if(o===t)return n[i];break;case"NNNNN":if(h===t)return n[i];break}else if([o,l,h].indexOf(t)>=0)return n[i]}function $ye(t,e){var r=t.since<=t.until?1:-1;return e===void 0?mt(t.since).year():mt(t.since).year()+(e-t.offset)*r}function Bye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].name;return""}function Vye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].narrow;return""}function Wye(){var t,e,r,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),i[t].since<=r&&r<=i[t].until||i[t].until<=r&&r<=i[t].since)return i[t].abbr;return""}function jye(){var t,e,r,i,s=this.localeData().eras();for(t=0,e=s.length;t<e;++t)if(r=s[t].since<=s[t].until?1:-1,i=this.clone().startOf("day").valueOf(),s[t].since<=i&&i<=s[t].until||s[t].until<=i&&i<=s[t].since)return(this.year()-mt(s[t].since).year())*r+s[t].offset;return this.year()}function Uye(t){return Rn(this,"_erasNameRegex")||Hk.call(this),t?this._erasNameRegex:this._erasRegex}function zye(t){return Rn(this,"_erasAbbrRegex")||Hk.call(this),t?this._erasAbbrRegex:this._erasRegex}function Gye(t){return Rn(this,"_erasNarrowRegex")||Hk.call(this),t?this._erasNarrowRegex:this._erasRegex}function Lk(t,e){return e.erasAbbrRegex(t)}function Yye(t,e){return e.erasNameRegex(t)}function Kye(t,e){return e.erasNarrowRegex(t)}function Xye(t,e){return e._eraYearOrdinalRegex||A1}function Hk(){var t=[],e=[],r=[],i=[],s,n,o,l,h,d=this.eras();for(s=0,n=d.length;s<n;++s)o=zh(d[s].name),l=zh(d[s].abbr),h=zh(d[s].narrow),e.push(o),t.push(l),r.push(h),i.push(o),i.push(l),i.push(h);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Tr(0,["gg",2],0,function(){return this.weekYear()%100});Tr(0,["GG",2],0,function(){return this.isoWeekYear()%100});function M_(t,e){Tr(0,[t,t.length],0,e)}M_("gggg","weekYear");M_("ggggg","weekYear");M_("GGGG","isoWeekYear");M_("GGGGG","isoWeekYear");nr("G",A_);nr("g",A_);nr("GG",bi,fl);nr("gg",bi,fl);nr("GGGG",Tk,Ek);nr("gggg",Tk,Ek);nr("GGGGG",R_,T_);nr("ggggg",R_,T_);YC(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,i){e[i.substr(0,2)]=gn(t)});YC(["gg","GG"],function(t,e,r,i){e[i]=mt.parseTwoDigitYear(t)});function qye(t){return bX.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Jye(t){return bX.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Qye(){return Gh(this.year(),1,4)}function Zye(){return Gh(this.isoWeekYear(),1,4)}function eCe(){var t=this.localeData()._week;return Gh(this.year(),t.dow,t.doy)}function tCe(){var t=this.localeData()._week;return Gh(this.weekYear(),t.dow,t.doy)}function bX(t,e,r,i,s){var n;return t==null?eC(this,i,s).year:(n=Gh(t,i,s),e>n&&(e=n),rCe.call(this,t,e,r,i,s))}function rCe(t,e,r,i,s){var n=tX(t,e,r,i,s),o=Zy(n.year,0,n.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Tr("Q",0,"Qo","quarter");nr("Q",UK);ri("Q",function(t,e){e[Hh]=(gn(t)-1)*3});function nCe(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Tr("D",["DD",2],"Do","date");nr("D",bi,O1);nr("DD",bi,fl);nr("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});ri(["D","DD"],ku);ri("Do",function(t,e){e[ku]=gn(t.match(bi)[0])});var xX=I1("Date",!0);Tr("DDD",["DDDD",3],"DDDo","dayOfYear");nr("DDD",__);nr("DDDD",zK);ri(["DDD","DDDD"],function(t,e,r){r._dayOfYear=gn(t)});function iCe(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Tr("m",["mm",2],0,"minute");nr("m",bi,_k);nr("mm",bi,fl);ri(["m","mm"],Ac);var sCe=I1("Minutes",!1);Tr("s",["ss",2],0,"second");nr("s",bi,_k);nr("ss",bi,fl);ri(["s","ss"],$h);var oCe=I1("Seconds",!1);Tr("S",0,0,function(){return~~(this.millisecond()/100)});Tr(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Tr(0,["SSS",3],0,"millisecond");Tr(0,["SSSS",4],0,function(){return this.millisecond()*10});Tr(0,["SSSSS",5],0,function(){return this.millisecond()*100});Tr(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Tr(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Tr(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Tr(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});nr("S",__,UK);nr("SS",__,fl);nr("SSS",__,zK);var sd,EX;for(sd="SSSS";sd.length<=9;sd+="S")nr(sd,A1);function aCe(t,e){e[ig]=gn(("0."+t)*1e3)}for(sd="S";sd.length<=9;sd+="S")ri(sd,aCe);EX=I1("Milliseconds",!1);Tr("z",0,0,"zoneAbbr");Tr("zz",0,0,"zoneName");function lCe(){return this._isUTC?"UTC":""}function cCe(){return this._isUTC?"Coordinated Universal Time":""}var Rt=zC.prototype;Rt.add=tye;Rt.calendar=lye;Rt.clone=cye;Rt.diff=pye;Rt.endOf=_ye;Rt.format=Cye;Rt.from=Sye;Rt.fromNow=bye;Rt.to=xye;Rt.toNow=Eye;Rt.get=yve;Rt.invalidAt=Nye;Rt.isAfter=uye;Rt.isBefore=hye;Rt.isBetween=fye;Rt.isSame=dye;Rt.isSameOrAfter=gye;Rt.isSameOrBefore=mye;Rt.isValid=Mye;Rt.lang=vX;Rt.locale=pX;Rt.localeData=wX;Rt.max=Mwe;Rt.min=Fwe;Rt.parsingFlags=kye;Rt.set=Cve;Rt.startOf=Tye;Rt.subtract=rye;Rt.toArray=Iye;Rt.toObject=Pye;Rt.toDate=Oye;Rt.toISOString=wye;Rt.inspect=yye;typeof Symbol<"u"&&Symbol.for!=null&&(Rt[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Rt.toJSON=Fye;Rt.toString=vye;Rt.unix=Aye;Rt.valueOf=Rye;Rt.creationData=Dye;Rt.eraName=Bye;Rt.eraNarrow=Vye;Rt.eraAbbr=Wye;Rt.eraYear=jye;Rt.year=KK;Rt.isLeapYear=wve;Rt.weekYear=qye;Rt.isoWeekYear=Jye;Rt.quarter=Rt.quarters=nCe;Rt.month=ZK;Rt.daysInMonth=Ove;Rt.week=Rt.weeks=Lve;Rt.isoWeek=Rt.isoWeeks=Hve;Rt.weeksInYear=eCe;Rt.weeksInWeekYear=tCe;Rt.isoWeeksInYear=Qye;Rt.isoWeeksInISOWeekYear=Zye;Rt.date=xX;Rt.day=Rt.days=Jve;Rt.weekday=Qve;Rt.isoWeekday=Zve;Rt.dayOfYear=iCe;Rt.hour=Rt.hours=owe;Rt.minute=Rt.minutes=sCe;Rt.second=Rt.seconds=oCe;Rt.millisecond=Rt.milliseconds=EX;Rt.utcOffset=Wwe;Rt.utc=Uwe;Rt.local=zwe;Rt.parseZone=Gwe;Rt.hasAlignedHourOffset=Ywe;Rt.isDST=Kwe;Rt.isLocal=qwe;Rt.isUtcOffset=Jwe;Rt.isUtc=fX;Rt.isUTC=fX;Rt.zoneAbbr=lCe;Rt.zoneName=cCe;Rt.dates=Xl("dates accessor is deprecated. Use date instead.",xX);Rt.months=Xl("months accessor is deprecated. Use month instead",ZK);Rt.years=Xl("years accessor is deprecated. Use year instead",KK);Rt.zone=Xl("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jwe);Rt.isDSTShifted=Xl("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Xwe);function uCe(t){return Ci(t*1e3)}function hCe(){return Ci.apply(null,arguments).parseZone()}function TX(t){return t}var An=Sk.prototype;An.calendar=q1e;An.longDateFormat=eve;An.invalidDate=rve;An.ordinal=sve;An.preparse=TX;An.postformat=TX;An.relativeTime=ave;An.pastFuture=lve;An.set=K1e;An.eras=Lye;An.erasParse=Hye;An.erasConvertYear=$ye;An.erasAbbrRegex=zye;An.erasNameRegex=Uye;An.erasNarrowRegex=Gye;An.months=Tve;An.monthsShort=_ve;An.monthsParse=Ave;An.monthsRegex=Pve;An.monthsShortRegex=Ive;An.week=Mve;An.firstDayOfYear=Dve;An.firstDayOfWeek=Nve;An.weekdays=Gve;An.weekdaysMin=Kve;An.weekdaysShort=Yve;An.weekdaysParse=qve;An.weekdaysRegex=ewe;An.weekdaysShortRegex=twe;An.weekdaysMinRegex=rwe;An.isPM=iwe;An.meridiem=awe;function BE(t,e,r,i){var s=uf(),n=qu().set(i,e);return s[r](n,t)}function _X(t,e,r){if(tf(t)&&(e=t,t=void 0),t=t||"",e!=null)return BE(t,e,r,"month");var i,s=[];for(i=0;i<12;i++)s[i]=BE(t,i,r,"month");return s}function $k(t,e,r,i){typeof t=="boolean"?(tf(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,tf(e)&&(r=e,e=void 0),e=e||"");var s=uf(),n=t?s._week.dow:0,o,l=[];if(r!=null)return BE(e,(r+n)%7,i,"day");for(o=0;o<7;o++)l[o]=BE(e,(o+n)%7,i,"day");return l}function fCe(t,e){return _X(t,e,"months")}function dCe(t,e){return _X(t,e,"monthsShort")}function gCe(t,e,r){return $k(t,e,r,"weekdays")}function mCe(t,e,r){return $k(t,e,r,"weekdaysShort")}function pCe(t,e,r){return $k(t,e,r,"weekdaysMin")}Sd("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=gn(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});mt.lang=Xl("moment.lang is deprecated. Use moment.locale instead.",Sd);mt.langData=Xl("moment.langData is deprecated. Use moment.localeData instead.",uf);var lh=Math.abs;function vCe(){var t=this._data;return this._milliseconds=lh(this._milliseconds),this._days=lh(this._days),this._months=lh(this._months),t.milliseconds=lh(t.milliseconds),t.seconds=lh(t.seconds),t.minutes=lh(t.minutes),t.hours=lh(t.hours),t.months=lh(t.months),t.years=lh(t.years),this}function RX(t,e,r,i){var s=Wc(e,r);return t._milliseconds+=i*s._milliseconds,t._days+=i*s._days,t._months+=i*s._months,t._bubble()}function wCe(t,e){return RX(this,t,e,1)}function yCe(t,e){return RX(this,t,e,-1)}function $9(t){return t<0?Math.floor(t):Math.ceil(t)}function CCe(){var t=this._milliseconds,e=this._days,r=this._months,i=this._data,s,n,o,l,h;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=$9(zP(r)+e)*864e5,e=0,r=0),i.milliseconds=t%1e3,s=Hl(t/1e3),i.seconds=s%60,n=Hl(s/60),i.minutes=n%60,o=Hl(n/60),i.hours=o%24,e+=Hl(o/24),h=Hl(AX(e)),r+=h,e-=$9(zP(h)),l=Hl(r/12),r%=12,i.days=e,i.months=r,i.years=l,this}function AX(t){return t*4800/146097}function zP(t){return t*146097/4800}function SCe(t){if(!this.isValid())return NaN;var e,r,i=this._milliseconds;if(t=ql(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,r=this._months+AX(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(zP(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function hf(t){return function(){return this.as(t)}}var OX=hf("ms"),bCe=hf("s"),xCe=hf("m"),ECe=hf("h"),TCe=hf("d"),_Ce=hf("w"),RCe=hf("M"),ACe=hf("Q"),OCe=hf("y"),ICe=OX;function PCe(){return Wc(this)}function FCe(t){return t=ql(t),this.isValid()?this[t+"s"]():NaN}function Xg(t){return function(){return this.isValid()?this._data[t]:NaN}}var MCe=Xg("milliseconds"),kCe=Xg("seconds"),NCe=Xg("minutes"),DCe=Xg("hours"),LCe=Xg("days"),HCe=Xg("months"),$Ce=Xg("years");function BCe(){return Hl(this.days()/7)}var Ah=Math.round,Ap={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function VCe(t,e,r,i,s){return s.relativeTime(e||1,!!r,t,i)}function WCe(t,e,r,i){var s=Wc(t).abs(),n=Ah(s.as("s")),o=Ah(s.as("m")),l=Ah(s.as("h")),h=Ah(s.as("d")),d=Ah(s.as("M")),g=Ah(s.as("w")),y=Ah(s.as("y")),C=n<=r.ss&&["s",n]||n<r.s&&["ss",n]||o<=1&&["m"]||o<r.m&&["mm",o]||l<=1&&["h"]||l<r.h&&["hh",l]||h<=1&&["d"]||h<r.d&&["dd",h];return r.w!=null&&(C=C||g<=1&&["w"]||g<r.w&&["ww",g]),C=C||d<=1&&["M"]||d<r.M&&["MM",d]||y<=1&&["y"]||["yy",y],C[2]=e,C[3]=+t>0,C[4]=i,VCe.apply(null,C)}function jCe(t){return t===void 0?Ah:typeof t=="function"?(Ah=t,!0):!1}function UCe(t,e){return Ap[t]===void 0?!1:e===void 0?Ap[t]:(Ap[t]=e,t==="s"&&(Ap.ss=e-1),!0)}function zCe(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,i=Ap,s,n;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(i=Object.assign({},Ap,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),s=this.localeData(),n=WCe(this,!r,i,s),r&&(n=s.pastFuture(+this,n)),s.postformat(n)}var tO=Math.abs;function Cm(t){return(t>0)-(t<0)||+t}function k_(){if(!this.isValid())return this.localeData().invalidDate();var t=tO(this._milliseconds)/1e3,e=tO(this._days),r=tO(this._months),i,s,n,o,l=this.asSeconds(),h,d,g,y;return l?(i=Hl(t/60),s=Hl(i/60),t%=60,i%=60,n=Hl(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=l<0?"-":"",d=Cm(this._months)!==Cm(l)?"-":"",g=Cm(this._days)!==Cm(l)?"-":"",y=Cm(this._milliseconds)!==Cm(l)?"-":"",h+"P"+(n?d+n+"Y":"")+(r?d+r+"M":"")+(e?g+e+"D":"")+(s||i||t?"T":"")+(s?y+s+"H":"")+(i?y+i+"M":"")+(t?y+o+"S":"")):"P0D"}var Cn=F_.prototype;Cn.isValid=Hwe;Cn.abs=vCe;Cn.add=wCe;Cn.subtract=yCe;Cn.as=SCe;Cn.asMilliseconds=OX;Cn.asSeconds=bCe;Cn.asMinutes=xCe;Cn.asHours=ECe;Cn.asDays=TCe;Cn.asWeeks=_Ce;Cn.asMonths=RCe;Cn.asQuarters=ACe;Cn.asYears=OCe;Cn.valueOf=ICe;Cn._bubble=CCe;Cn.clone=PCe;Cn.get=FCe;Cn.milliseconds=MCe;Cn.seconds=kCe;Cn.minutes=NCe;Cn.hours=DCe;Cn.days=LCe;Cn.weeks=BCe;Cn.months=HCe;Cn.years=$Ce;Cn.humanize=zCe;Cn.toISOString=k_;Cn.toString=k_;Cn.toJSON=k_;Cn.locale=pX;Cn.localeData=wX;Cn.toIsoString=Xl("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",k_);Cn.lang=vX;Tr("X",0,0,"unix");Tr("x",0,0,"valueOf");nr("x",A_);nr("X",fve);ri("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});ri("x",function(t,e,r){r._d=new Date(gn(t))});//! moment.js
mt.version="2.30.1";G1e(Ci);mt.fn=Rt;mt.min=kwe;mt.max=Nwe;mt.now=Dwe;mt.utc=qu;mt.unix=uCe;mt.months=fCe;mt.isDate=UC;mt.locale=Sd;mt.invalid=E_;mt.duration=Wc;mt.isMoment=Lc;mt.weekdays=gCe;mt.parseZone=hCe;mt.localeData=uf;mt.isDuration=D2;mt.monthsShort=dCe;mt.weekdaysMin=pCe;mt.defineLocale=Pk;mt.updateLocale=hwe;mt.locales=fwe;mt.weekdaysShort=mCe;mt.normalizeUnits=ql;mt.relativeTimeRounding=jCe;mt.relativeTimeThreshold=UCe;mt.calendarFormat=aye;mt.prototype=Rt;mt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function GCe(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function B9(t,e){const r=e.length;let i=0;for(;i<r;)t.push(e[i]),i+=1}function H2(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,i=t[0].length;for(let s=0;s<r;s++)for(let n=0;n<i;n++)e[n]||(e[n]=[]),e[n][s]=t[s][n];return e}function ha(t,e,r,i){let s=-1,n=t,o=r;Array.isArray(t)||(n=Array.from(t));const l=n.length;for(s+=1;s<l;)o=e(o,n[s],s,n),s+=1;return o}function Ad(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length,n=[];let o=-1;for(;r<s;){const l=i[r];e(l,r,i)&&(o+=1,n[o]=l),r+=1}return n}function on(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length,n=[];let o=-1;for(;r<s;){const l=i[r];o+=1,n[o]=e(l,r,i),r+=1}return n}function xe(t,e){let r=0,i=t;Array.isArray(t)||(i=Array.from(t));const s=i.length;for(;r<s&&e(i[r],r,i)!==!1;)r+=1;return t}function IX(t){const e=[];return xe(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function V9(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[i,...s]=[...e];let n=i;return xe(s,o=>{n=n.filter(l=>!o.includes(l))}),n}function W9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ln(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return ha(t,(n,o,l)=>{const h=o.replace(/\r?\n\s*/g,""),d=r[l]?r[l]:"";return n+h+d},"").trim()}function as(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function rr(t){return typeof t<"u"}function Ai(t){return typeof t>"u"}function Zi(t){return t===null||t===""||Ai(t)}function YCe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const $w="length",iy=t=>parseInt(t,16),j9=t=>parseInt(t,10),VE=(t,e,r)=>t.substr(e,r),sy=t=>t.codePointAt(0)-65,GP=t=>`${t}`.replace(/\-/g,""),KCe=t=>iy(VE(GP(t),iy("12"),sy("F")))/(iy(VE(GP(t),sy("B"),~~![][$w]))||9),XCe=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let U9=!1;const z9={invalid:()=>Ln`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ln`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ln`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},G9={invalid:()=>Ln`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ln`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ln`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function qCe(t,e){const r=!Zi(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",s="15.0.0";let n,o="invalid",l="invalid";t=GP(t||"");const h=JCe(t);if(r||i||h)if(h){const d=mt("16/12/2024","DD/MM/YYYY"),g=Math.floor(d.toDate().getTime()/864e5),y=KCe(t);n=mt((y+1)*864e5,"x").format("MMMM DD, YYYY"),g>y?(o="expired",l="expired"):(o="valid",l="valid")}else i?(o="non_commercial",l="valid"):(o="invalid",l="invalid");else o="missing",l="missing";if(XCe()&&(o="valid",l="valid"),!U9&&o!=="valid"&&(z9[o]({keyValidityDate:n,hotVersion:s})&&console[o==="non_commercial"?"info":"warn"](z9[o]({keyValidityDate:n,hotVersion:s})),U9=!0),l!=="valid"&&e.parentNode&&G9[l]({keyValidityDate:n,hotVersion:s})){const g=document.createElement("div");g.className="handsontable hot-display-license-info",g.innerHTML=G9[l]({keyValidityDate:n,hotVersion:s}),e.parentNode.insertBefore(g,e.nextSibling)}}function JCe(t){let e=[][$w],r=e;if(t[$w]!==sy("Z"))return!1;for(let i="",s="B<H4P+".split(""),n=sy(s.shift());n;n=sy(s.shift()||"A"))--n<""[$w]?r=r|(j9(`${j9(iy(i)+(iy(VE(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=VE(t,n,n?s[$w]===1?9:8:6);return r===e}function Hc(t){return t[0].toUpperCase()+t.substr(1)}function PX(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function FX(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function MX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,i)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[i]===void 0?"":e[i])}function Y9(t){return Bk(`${t}`,{ALLOWED_TAGS:[]})}function Bk(t,e){return z1e.sanitize(t,e)}const P1=t=>["tabindex",t],QCe=()=>["role","treegrid"],Hu=()=>["role","presentation"],ZCe=()=>["role","gridcell"],eSe=()=>["role","rowheader"],kX=()=>["role","rowgroup"],tSe=()=>["role","columnheader"],YP=()=>["role","row"],rSe=()=>["role","menu"],nSe=()=>["role","menuitem"],iSe=()=>["role","menuitemcheckbox"],sSe=()=>["role","combobox"],NX=()=>["role","listbox"],oSe=()=>["role","option"],aSe=()=>["role","checkbox"],lSe=()=>["scope","col"],cSe=()=>["scope","row"],uSe=()=>["type","text"],WE=t=>["aria-label",t],Ld=()=>["aria-hidden","true"],hSe=()=>["aria-disabled","true"],fSe=()=>["aria-multiselectable","true"],DX=t=>["aria-haspopup",t],LX=t=>["aria-rowcount",t],N_=t=>["aria-colcount",t],HX=t=>["aria-rowindex",t],Vk=t=>["aria-colindex",t],jl=t=>["aria-expanded",t],dSe=t=>["aria-sort",t],K9=()=>["aria-readonly","true"],X9=()=>["aria-invalid","true"],$X=t=>["aria-checked",t],Wk=()=>["aria-selected","true"],gSe=()=>["aria-autocomplete","list"],mSe=t=>["aria-controls",t],pSe=t=>["aria-activedescendant",t],vSe=t=>["aria-live",t],wSe=t=>["aria-relevant",t],ySe=t=>["aria-setsize",t],CSe=t=>["aria-posinset",t];function SSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,i=null,s=t;for(;s!==null;){if(r===e){i=s;break}s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:(r+=1,s=s.parentNode)}return i}function bSe(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function xSe(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function a1(t){return xSe(t)&&t.parent}function Rg(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:s}=Node;let n=t;for(;n!=null&&n!==r;){const{nodeType:o,nodeName:l}=n;if(o===i&&(e.includes(l)||e.includes(n)))return n;const{host:h}=n;h&&o===s?n=h:n=n.parentNode}return null}function Ib(t,e,r){const i=[];let s=t;for(;s&&(s=Rg(s,e,r),!(!s||r&&!r.contains(s)));)i.push(s),s.host&&s.nodeType===Node.DOCUMENT_FRAGMENT_NODE?s=s.host:s=s.parentNode;const n=i.length;return n?i[n-1]:null}function ESe(t,e){const r={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!r.element;){if(typeof e=="string"&&i.classList.contains(e))r.element=i,r.classNames.push(e);else if(e instanceof RegExp){const s=Array.from(i.classList).filter(n=>e.test(n));s.length&&(r.element=i,r.classNames.push(...s))}i=i.parentElement}return r}function vg(t,e){let r=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);r!==null;){if(i.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function TSe(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function l0(t,e,r){const i=r.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function BX(t){return!t||!t.length?[]:t.filter(e=>!!e)}function VX(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],i=[];return i.push(...t.filter(s=>{const n=s instanceof RegExp;return n&&e&&r.push(s),!n})),{regexFree:i,regexes:r}}function Rr(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function at(t,e){typeof e=="string"&&(e=e.split(" ")),e=BX(e),e.length>0&&t.classList.add(...e)}function _r(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:i}=VX(e,!0);r=BX(r),r.length>0&&t.classList.remove(...r),i.forEach(s=>{t.classList.forEach(n=>{s.test(n)&&t.classList.remove(n)})})}function Or(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function F1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:i}=VX(e,!0);r.forEach(s=>{s!==""&&t.removeAttribute(s)}),i.forEach(s=>{t.getAttributeNames().forEach(n=>{s.test(n)&&t.removeAttribute(n)})})}function WX(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)WX(e[r])}}function Uu(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const _Se=/(<(.*)>|&(.*);)/;function M1(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;_Se.test(e)?t.innerHTML=r?Bk(e):e:Ag(t,e)}function Ag(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(Uu(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function l1(t){const e=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return l1(i.host.impl);if(i.host)return l1(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(r.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function zs(t){const e=t.ownerDocument,r=e.defaultView,i=e.documentElement;let s=t,n,o,l;for(n=s.offsetLeft,o=s.offsetTop,l=s;(s=s.offsetParent)&&!(s===e.body||!("offsetLeft"in s));)n+=s.offsetLeft,o+=s.offsetTop,l=s;return l&&l.style.position==="fixed"&&(n+=r.pageXOffset||i.scrollLeft,o+=r.pageYOffset||i.scrollTop),{left:n,top:o}}function jX(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function jk(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Uk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?jX(e):t.scrollTop}function UX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?jk(e):t.scrollLeft}function jE(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const i=["auto","scroll"];let s=t.parentNode;for(;s&&s.style&&e.body!==s;){let{overflow:n,overflowX:o,overflowY:l}=s.style;if([n,o,l].includes("scroll"))return s;if({overflow:n,overflowX:o,overflowY:l}=r.getComputedStyle(s),i.includes(n)||i.includes(o)||i.includes(l)||s.clientHeight<=s.scrollHeight+1&&(i.includes(l)||i.includes(n))||s.clientWidth<=s.scrollWidth+1&&(i.includes(o)||i.includes(n)))return s;s=s.parentNode}return r}function RSe(t){return t.scrollHeight-t.clientHeight}function ASe(t){return t.scrollWidth-t.clientWidth}function c1(t){const e=t.ownerDocument,r=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const s=r.getComputedStyle(i),n=["scroll","hidden","auto"],o=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),h=s.getPropertyValue("overflow-x");if(n.includes(o)||n.includes(l)||n.includes(h))return i;i=i.parentNode}return r}function UE(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const s=r.getComputedStyle(t);if(s[e]!==""&&s[e]!==void 0)return s[e]}function os(t){return t.offsetWidth}function es(t){return t.offsetHeight}function oy(t){return t.clientHeight||t.innerHeight}function zX(t){return t.clientWidth||t.innerWidth}function GX(t){return t.selectionStart?t.selectionStart:0}function OSe(t){return t.selectionEnd?t.selectionEnd:0}function q9(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function D_(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const s=t.parentNode,n=s.style.display;s.style.display="block",t.setSelectionRange(e,r),s.style.display=n}}}let rO;function ISe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const i=e.offsetWidth;r.style.overflow="scroll";let s=e.offsetWidth;return i===s&&(s=r.clientWidth),(t.body||t.documentElement).removeChild(r),i-s}function co(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return rO===void 0&&(rO=ISe(t)),rO}function PSe(t){return t.offsetWidth!==t.clientWidth}function FSe(t){return t.offsetHeight!==t.clientHeight}function zk(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function L_(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function $2(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function YX(t){return $2(t)&&t.hasAttribute("data-hot-input")===!1}function KX(t){return!t.parentNode}function MSe(t,e){new IntersectionObserver((i,s)=>{i.forEach(n=>{n.isIntersecting&&t.offsetParent!==null&&(e(),s.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function XX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,s=i.createRange(),n=i.defaultView.getSelection();Or(t,"contenteditable",!0),r&&Or(t,...Ld()),e&&at(t,"invisibleSelection"),s.selectNodeContents(t),n.removeAllRanges(),n.addRange(s)}function qX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&_r(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function kSe(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;XX(t,r),e(),qX(t,r)}function ci(t){return typeof t=="function"}function Gk(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,i;function s(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return r&&clearTimeout(r),r=setTimeout(()=>{i=t.apply(this,o)},e),i}return s}function JX(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return t.apply(this,r.concat(o))}}function NSe(t){const e=t.length;function r(i){return function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];const h=i.concat(o);let d;return h.length>=e?d=t.apply(this,h):d=r(h),d}}return r([])}function KP(t,e,r,i,s,n,o,l){return rr(l)?t.call(e,r,i,s,n,o,l):rr(o)?t.call(e,r,i,s,n,o):rr(n)?t.call(e,r,i,s,n):rr(s)?t.call(e,r,i,s):rr(i)?t.call(e,r,i):rr(r)?t.call(e,r):t.call(e)}var DSe=ls,J9=KY,LSe=bs,Q9=jg,HSe=x_,Z9=DSe([].push),$Se=function(t){if(LSe(t))return t;if(J9(t)){for(var e=t.length,r=[],i=0;i<e;i++){var s=t[i];typeof s=="string"?Z9(r,s):(typeof s=="number"||Q9(s)==="Number"||Q9(s)==="String")&&Z9(r,HSe(s))}var n=r.length,o=!0;return function(l,h){if(o)return o=!1,h;if(J9(this))return h;for(var d=0;d<n;d++)if(r[d]===l)return h}}},BSe=si,QX=b1,ZX=b_,VSe=$o,KC=ls,eq=go,eB=bs,tB=JM,tq=pk,WSe=$Se,jSe=qM,USe=String,bd=QX("JSON","stringify"),Pb=KC(/./.exec),rB=KC("".charAt),zSe=KC("".charCodeAt),GSe=KC("".replace),YSe=KC(1 .toString),KSe=/[\uD800-\uDFFF]/g,nB=/^[\uD800-\uDBFF]$/,iB=/^[\uDC00-\uDFFF]$/,sB=!jSe||eq(function(){var t=QX("Symbol")("stringify detection");return bd([t])!=="[null]"||bd({a:t})!=="{}"||bd(Object(t))!=="{}"}),oB=eq(function(){return bd("\uDF06\uD834")!=='"\\udf06\\ud834"'||bd("\uDEAD")!=='"\\udead"'}),XSe=function(t,e){var r=tq(arguments),i=WSe(e);if(!(!eB(i)&&(t===void 0||tB(t))))return r[1]=function(s,n){if(eB(i)&&(n=VSe(i,this,USe(s),n)),!tB(n))return n},ZX(bd,null,r)},qSe=function(t,e,r){var i=rB(r,e-1),s=rB(r,e+1);return Pb(nB,t)&&!Pb(iB,s)||Pb(iB,t)&&!Pb(nB,i)?"\\u"+YSe(zSe(t,0),16):t};bd&&BSe({target:"JSON",stat:!0,arity:3,forced:sB||oB},{stringify:function(e,r,i){var s=tq(arguments),n=ZX(sB?XSe:bd,null,s);return oB&&typeof n=="string"?GSe(n,KSe,qSe):n}});function rC(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Zr(t,(r,i)=>{i!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[i]=rC(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[i]=[rC(r[0])]:e[i]=[]:e[i]=null)})),e}function Qu(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Cs(t,e,r){const i=Array.isArray(r);return Zr(e,(s,n)=>{(i===!1||r.includes(n))&&(t[n]=s)}),t}function H_(t,e){Zr(e,(r,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),H_(t[i],e[i])):t[i]=e[i]})}function la(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function zu(t){const e={};return Zr(t,(r,i)=>{e[i]=r}),e}function qn(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return xe(r,s=>{t.MIXINS.push(s.MIXIN_NAME),Zr(s,(n,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof n=="function")t.prototype[o]=n;else{const l=function(g,y){const C=`_${g}`,x=_=>{let E=_;return(Array.isArray(E)||Qr(E))&&(E=la(E)),E};return function(){return this[C]===void 0&&(this[C]=x(y)),this[C]}},h=function(g){const y=`_${g}`;return function(C){this[y]=C}};Object.defineProperty(t.prototype,o,{get:l(o,n),set:h(o),configurable:!0})}})}),t}function Yk(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Qr(t){return Object.prototype.toString.call(t)==="[object Object]"}function ff(t,e,r,i){i.value=r,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Zr(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function JSe(t,e){const r=e.split(".");let i=t;return Zr(r,s=>{if(i=i[s],i===void 0)return i=void 0,!1}),i}function nO(t,e,r){const i=e.split(".");let s=t;i.forEach((n,o)=>{o!==i.length-1?(vs(s,n)||(s[n]={}),s=s[n]):s[n]=r})}function Kk(t){if(!Qr(t))return 0;const e=function(r){let i=0;return Qr(r)?Zr(r,(s,n)=>{n!=="__children"&&(i+=e(s))}):i+=1,i};return e(t)}function il(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,i={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[r]},set(s){this._touched=!0,this[r]=s},enumerable:!0,configurable:!0}),i}function vs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zE(t){return window.requestAnimationFrame(t)}function GE(t){window.cancelAnimationFrame(t)}function rq(){return"ontouchstart"in window}function QSe(){return typeof window<"u"}let Sm;function ZSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Sm||(typeof Intl=="object"?Sm=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Sm=(r,i)=>`${r}`.localeCompare(i):Sm=(r,i)=>r===i?0:r>i?-1:1,Sm)}const Pl=t=>{const e={value:!1};return e.test=(r,i)=>{e.value=t(r,i)},e},Hd={chrome:Pl((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:Pl(t=>/CriOS/.test(t)),edge:Pl(t=>/Edge/.test(t)),edgeWebKit:Pl(t=>/EdgiOS/.test(t)),firefox:Pl(t=>/Firefox/.test(t)),firefoxWebKit:Pl(t=>/FxiOS/.test(t)),mobile:Pl(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:Pl((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},XC={mac:Pl(t=>/^Mac/.test(t)),win:Pl(t=>/^Win/.test(t)),linux:Pl(t=>/^Linux/.test(t)),ios:Pl(t=>/iPhone|iPad|iPod/i.test(t))};function ebe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zr(Hd,r=>{let{test:i}=r;return void i(t,e)})}function tbe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zr(XC,e=>{let{test:r}=e;return void r(t)})}QSe()&&(ebe(),tbe());function nq(){return Hd.chrome.value}function rbe(){return Hd.chromeWebKit.value}function iO(){return Hd.firefox.value}function nbe(){return Hd.firefoxWebKit.value}function iq(){return Hd.safari.value}function ibe(){return Hd.edge.value}function od(){return Hd.mobile.value}function sq(){return XC.ios.value}function oq(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&XC.mac.value}function aB(){return XC.win.value}function lB(){return XC.mac.value}const yr={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:iO()?182:174,AUDIO_MUTE:iO()?181:173,AUDIO_UP:iO()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},sbe=[yr.ALT,yr.ARROW_DOWN,yr.ARROW_LEFT,yr.ARROW_RIGHT,yr.ARROW_UP,yr.AUDIO_DOWN,yr.AUDIO_MUTE,yr.AUDIO_UP,yr.BACKSPACE,yr.CAPS_LOCK,yr.DELETE,yr.END,yr.ENTER,yr.ESCAPE,yr.F1,yr.F2,yr.F3,yr.F4,yr.F5,yr.F6,yr.F7,yr.F8,yr.F9,yr.F10,yr.F11,yr.F12,yr.F13,yr.F14,yr.F15,yr.F16,yr.F17,yr.F18,yr.F19,yr.HOME,yr.INSERT,yr.MEDIA_NEXT,yr.MEDIA_PLAY_PAUSE,yr.MEDIA_PREV,yr.MEDIA_STOP,yr.NULL,yr.NUM_LOCK,yr.PAGE_DOWN,yr.PAGE_UP,yr.PAUSE,yr.SCROLL_LOCK,yr.SHIFT,yr.TAB];function obe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function aq(t){return sbe.includes(t)}function abe(t){return[yr.CONTROL,yr.COMMAND_LEFT,yr.COMMAND_RIGHT,yr.COMMAND_FIREFOX].includes(t)}function qC(t,e){const r=e.split("|");let i=!1;return xe(r,s=>{if(t===yr[s])return i=!0,!1}),i}function jc(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Q0(t){return t.isImmediatePropagationEnabled===!1}function Og(t){return t.button===2}function Xk(t){return t.button===0}function lbe(t){return t instanceof TouchEvent}function cbe(t,e){const r={x:t.offsetX,y:t.offsetY};let i=t.target;if(!(e instanceof HTMLElement)||i!==e&&i.contains(e))return r;for(;i!==e;)r.x+=i.offsetLeft,r.y+=i.offsetTop,i=i.offsetParent;return r}function Nn(){rr(console)&&console.warn(...arguments)}function qk(){rr(console)&&console.error(...arguments)}const Z0=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],sO=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),oO=new Map([[]]);var ube=T1,hbe=function(t,e,r){for(var i=0,s=arguments.length>2?r:ube(e),n=new t(s);s>i;)n[i]=e[i++];return n},fbe=Ns,dbe=function(t,e){var r=fbe[t],i=r&&r.prototype;return i&&i[e]},gbe=Vc,mbe=hK,pbe=cf.f,XP=gbe("unscopables"),qP=Array.prototype;qP[XP]===void 0&&pbe(qP,XP,{configurable:!0,value:mbe(null)});var $_=function(t){qP[XP][t]=!0},vbe=si,wbe=ls,ybe=La,Cbe=LC,Sbe=hbe,bbe=dbe,xbe=$_,Ebe=Array,Tbe=wbe(bbe("Array","sort"));vbe({target:"Array",proto:!0},{toSorted:function(e){e!==void 0&&ybe(e);var r=Cbe(this),i=Sbe(Ebe,r);return Tbe(i,e)}});xbe("toSorted");var _be=si,Rbe=R1,Abe=La,Obe=xs,Ibe=Xu;_be({target:"Iterator",proto:!0,real:!0},{find:function(e){Obe(this),Abe(e);var r=Ibe(this),i=0;return Rbe(r,function(s,n){if(e(s,i++))return n(s)},{IS_RECORD:!0,INTERRUPTED:!0}).result}});function Pbe(t,e){lq(t,e),e.add(t)}function aO(t,e,r){lq(t,e),e.set(t,r)}function lq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cB(t,e,r){return t.set(YE(t,e),r),r}function ro(t,e){return t.get(YE(t,e))}function YE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Fbe=100;var ja=new WeakMap,op=new WeakMap,lO=new WeakMap,cO=new WeakSet;class uB{constructor(){Pbe(this,cO),aO(this,ja,new Map),aO(this,op,new Map),aO(this,lO,new Set),Z0.forEach(e=>YE(cO,this,hB).call(this,e))}getHooks(e){var r;return(r=ro(ja,this).get(e))!==null&&r!==void 0?r:[]}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ro(ja,this).has(e)||(YE(cO,this,hB).call(this,e),Z0.push(e));const s=ro(ja,this).get(e);if(s.find(d=>d.callback===r))return;const n=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,l=!!i.initialHook;let h=!1;if(l){const d=s.find(g=>g.initialHook);d&&(d.callback=r,h=!0)}if(!h){s.push({callback:r,orderIndex:n,runOnce:o,initialHook:l,skip:!1});let d=ro(lO,this).has(e);!d&&n!==0&&(d=!0,ro(lO,this).add(e)),d&&s.length>1&&ro(ja,this).set(e,s.toSorted((g,y)=>g.orderIndex-y.orderIndex))}}has(e){return ro(ja,this).has(e)&&ro(ja,this).get(e).length>0}remove(e,r){if(!ro(ja,this).has(e))return!1;const i=ro(ja,this).get(e),s=i.find(n=>n.callback===r);if(s){let n=ro(op,this).get(e);return s.skip=!0,n+=1,n>Fbe&&(ro(ja,this).set(e,i.filter(o=>!o.skip)),n=0),ro(op,this).set(e,n),!0}return!1}destroy(){ro(ja,this).clear(),ro(op,this).clear(),cB(ja,this,null),cB(op,this,null)}}function hB(t){ro(ja,this).set(t,[]),ro(op,this).set(t,0)}function Mbe(t,e,r){return(e=kbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kbe(t){var e=Nbe(t,"string");return typeof e=="symbol"?e:e+""}function Nbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dbe=Ln`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Xt{constructor(){Mbe(this,"globalBucket",new uB)}static getSingleton(){return Hbe()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new uB),e.pluginHookBucket):this.globalBucket}add(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?xe(r,n=>this.add(e,n,i)):(sO.has(e)&&Nn(MX(Dbe,{hookName:e,removedInVersion:sO.get(e)})),oO.has(e)&&Nn(oO.get(e)),this.getBucket(i).add(e,r,{orderIndex:s,runOnce:!1})),this}once(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(r)?xe(r,n=>this.once(e,n,i)):this.getBucket(i).add(e,r,{orderIndex:s,runOnce:!0}),this}addAsFixed(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(r)?xe(r,s=>this.addAsFixed(e,s,i)):this.getBucket(i).add(e,r,{initialHook:!0}),this}remove(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,r)}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(r).has(e)}run(e,r,i,s,n,o,l,h){{const d=this.getBucket().getHooks(r),g=d?d.length:0;let y=0;if(g)for(;y<g;){if(!d[y]||d[y].skip){y+=1;continue}const C=KP(d[y].callback,e,i,s,n,o,l,h);C!==void 0&&(i=C),d[y]&&d[y].runOnce&&this.remove(r,d[y].callback),y+=1}}{const d=this.getBucket(e).getHooks(r),g=d?d.length:0;let y=0;if(g)for(;y<g;){if(!d[y]||d[y].skip){y+=1;continue}const C=KP(d[y].callback,e,i,s,n,o,l,h);C!==void 0&&(i=C),d[y]&&d[y].runOnce&&this.remove(r,d[y].callback,e),y+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Z0.push(e)}deregister(e){this.isRegistered(e)&&Z0.splice(Z0.indexOf(e),1)}isDeprecated(e){return oO.has(e)||sO.has(e)}isRegistered(e){return Z0.indexOf(e)>=0}getRegistered(){return Z0}}const Lbe=new Xt;function Hbe(){return Lbe}const uO=new Map;function Uc(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";uO.has(t)||uO.set(t,new Map);const e=uO.get(t);function r(l,h){e.set(l,h)}function i(l){return e.get(l)}function s(l){return e.has(l)}function n(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:i,hasItem:s,getNames:n,getValues:o}}const JP=new WeakMap,{register:$be,getItem:cq,hasItem:uq,getNames:hXe,getValues:fXe}=Uc("editors");function Bbe(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new r(i)),e[i.guid]},Xt.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function hq(t,e){let r;if(typeof t=="function")JP.get(t)||za(null,t),r=JP.get(t);else if(typeof t=="string")r=cq(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function QP(t){if(typeof t=="function")return t;if(!uq(t))throw Error(`No registered editor found under "${t}" name`);return cq(t).getConstructor()}function za(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new Bbe(e);typeof t=="string"&&$be(t,r),JP.set(e,r)}function Vbe(t,e,r){return(e=Wbe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wbe(t){var e=jbe(t,"string");return typeof e=="symbol"?e:e+""}function jbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $c{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Vbe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function n(o){i.call(this,Ube(o))}return this.context.eventListeners.push({element:e,event:r,callback:i,callbackProxy:n,options:s,eventManager:this}),e.addEventListener(r,n,s),()=>{this.removeEventListener(e,r,i)}}removeEventListener(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,n=this.context.eventListeners.length,o;for(;n;)if(n-=1,o=this.context.eventListeners[n],o.event===r&&o.element===e){if(i&&i!==o.callback||s&&o.eventManager!==this)continue;this.context.eventListeners.splice(n,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const i=this.context.eventListeners[r];e&&i.eventManager!==this||(this.context.eventListeners.splice(r,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let i=e.document,s=e;i||(i=e.ownerDocument?e.ownerDocument:e,s=i.defaultView);const n={bubbles:!0,cancelable:r!=="mousemove",view:s,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(r,n.bubbles,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function Ube(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),jc(this)},t}function zbe(t,e){Gbe(t,e),e.add(t)}function Gbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c0(t,e,r){return(e=Ybe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ybe(t){var e=Kbe(t,"string");return typeof e=="symbol"?e:e+""}function Kbe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function fB(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var hO=new WeakSet;class ZP{constructor(e,r,i){zbe(this,hO),c0(this,"hot",void 0),c0(this,"tableMeta",void 0),c0(this,"selection",void 0),c0(this,"eventManager",void 0),c0(this,"destroyed",!1),c0(this,"activeEditor",void 0),c0(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=i,this.eventManager=new $c(e),this.hot.addHook("afterDocumentKeyDown",s=>fB(hO,this,Xbe).call(this,s)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",s=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",s)}),this.hot.view._wt.update("onCellDblClick",(s,n,o)=>fB(hO,this,qbe).call(this,s,n,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:i,col:s}=r,n=this.hot.runHooks("modifyGetCellCoords",i,s,!1,"meta");let o=i,l=s;if(Array.isArray(n)&&([o,l]=n),this.cellProperties=this.hot.getCellMeta(o,l),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(i,s,!0);if(h){const d=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(l),y=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),l);this.activeEditor=hq(d,this.hot),this.activeEditor.prepare(i,s,g,h,y,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const s=this.hot.getSelectedRangeLast();let n=this.hot.runHooks("beforeBeginEditing",s.highlight.row,s.highlight.col,e,r,i);if(r instanceof MouseEvent&&typeof n!="boolean"&&(n=this.hot.selection.getLayerLevel()===0&&s.isSingle()),n===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,i){this.activeEditor?this.activeEditor.finishEditing(e,r,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:i,col:s}=e.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,l=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(s));return!(this.cellProperties.readOnly||!r||l)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function Xbe(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Q0(t))return;const{keyCode:r}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!aq(r)&&!abe(r)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function qbe(t,e){e.isCell()&&this.openEditor(null,t,!0)}const dB=new WeakMap;ZP.getInstance=function(t,e,r){let i=dB.get(t);return i||(i=new ZP(t,e,r),dB.set(t,i)),i};function Jbe(t,e){fq(t,e),e.add(t)}function Dv(t,e,r){fq(t,e),e.set(t,r)}function fq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ti(t,e){return t.get(kh(t,e))}function Lv(t,e,r){return t.set(kh(t,e),r),r}function kh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Up=Object.freeze({CELL:"cell",MIXED:"mixed"});var Ws=new WeakMap,Fb=new WeakMap,Mb=new WeakMap,kb=new WeakMap,Nb=new WeakMap,zf=new WeakSet;class Qbe{constructor(e){var r=this;Jbe(this,zf),Dv(this,Ws,void 0),Dv(this,Fb,void 0),Dv(this,Mb,1),Dv(this,kb,null),Dv(this,Nb,new Map);const i=e.getSettings();Lv(Ws,this,e),Lv(Fb,this,i.imeFastEdit?Up.MIXED:Up.CELL),Ti(Ws,this).addHook("afterUpdateSettings",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return kh(zf,r,exe).call(r,...n)}),Ti(Ws,this).addHook("afterSelection",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return kh(zf,r,gB).call(r,...n)}),Ti(Ws,this).addHook("afterSelectionFocusSet",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return kh(zf,r,gB).call(r,...n)}),Ti(Ws,this).addHook("afterSelectionEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return kh(zf,r,Zbe).call(r,...n)})}getFocusMode(){return Ti(Fb,this)}setFocusMode(e){Object.values(Up).includes(e)?Lv(Fb,this,e):Nn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Ti(Mb,this)}setRefocusDelay(e){Lv(Mb,this,e)}setRefocusElementGetter(e){Lv(kb,this,e)}getRefocusElement(){var e;return typeof Ti(kb,this)=="function"?Ti(kb,this).call(this):(e=Ti(Ws,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=i=>{var s,n;const o=(s=Ti(Ws,this).getSelectedRangeLast())===null||s===void 0?void 0:s.highlight;if(!o)return;let l=Ti(Ws,this).runHooks("modifyFocusedElement",o.row,o.col,i);l instanceof HTMLElement||(l=i),l&&!((n=Ti(Ws,this).getActiveEditor())!==null&&n!==void 0&&n.isOpened())&&l.focus({preventScroll:!0})};e?r(e):kh(zf,this,Jk).call(this,i=>r(i))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ti(Mb,this);Ti(Ws,this).getSettings().imeFastEdit&&!((e=Ti(Ws,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&(Ti(Nb,this).has(r)||Ti(Nb,this).set(r,Gk(()=>{var i;(i=this.getRefocusElement())===null||i===void 0||i.select()},r)),Ti(Nb,this).get(r)())}}function Jk(t){var e;const r=(e=Ti(Ws,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!Ti(Ws,this).selection.isCellVisible(r)){t(null);return}const i=Ti(Ws,this).getCell(r.row,r.col,!0);i===null?Ti(Ws,this).addHookOnce("afterScroll",()=>{t(Ti(Ws,this).getCell(r.row,r.col,!0))}):t(i)}function gB(){kh(zf,this,Jk).call(this,t=>{const{activeElement:e}=Ti(Ws,this).rootDocument;e&&YX(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Zbe(){kh(zf,this,Jk).call(this,t=>{this.getFocusMode()===Up.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function exe(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Up.MIXED:Up.CELL)}var txe=Bc,rxe=jg,nxe=Vc,ixe=nxe("match"),sxe=function(t){var e;return txe(t)&&((e=t[ixe])!==void 0?!!e:rxe(t)==="RegExp")},oxe=xs,axe=function(){var t=oxe(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},lxe=$o,cxe=Kl,uxe=HC,hxe=axe,mB=RegExp.prototype,fxe=function(t){var e=t.flags;return e===void 0&&!("flags"in mB)&&!cxe(t,"flags")&&uxe(mB,t)?lxe(hxe,t):e},Qk=ls,dxe=x1,gxe=Math.floor,fO=Qk("".charAt),mxe=Qk("".replace),dO=Qk("".slice),pxe=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,vxe=/\$([$&'`]|\d{1,2})/g,wxe=function(t,e,r,i,s,n){var o=r+t.length,l=i.length,h=vxe;return s!==void 0&&(s=dxe(s),h=pxe),mxe(n,h,function(d,g){var y;switch(fO(g,0)){case"$":return"$";case"&":return t;case"`":return dO(e,0,r);case"'":return dO(e,o);case"<":y=s[dO(g,1,-1)];break;default:var C=+g;if(C===0)return d;if(C>l){var x=gxe(C/10);return x===0?d:x<=l?i[x-1]===void 0?fO(g,1):i[x-1]+fO(g,1):d}y=i[C-1]}return y===void 0?"":y})},yxe=si,Cxe=$o,Zk=ls,pB=DC,Sxe=bs,bxe=y_,xxe=sxe,Hv=x_,Exe=$C,Txe=fxe,_xe=wxe,Rxe=Vc,Axe=Rxe("replace"),Oxe=TypeError,gO=Zk("".indexOf);Zk("".replace);var vB=Zk("".slice),Ixe=Math.max;yxe({target:"String",proto:!0},{replaceAll:function(e,r){var i=pB(this),s,n,o,l,h,d,g,y,C,x,_=0,E="";if(!bxe(e)){if(s=xxe(e),s&&(n=Hv(pB(Txe(e))),!~gO(n,"g")))throw new Oxe("`.replaceAll` does not allow non-global regexes");if(o=Exe(e,Axe),o)return Cxe(o,e,i,r)}for(l=Hv(i),h=Hv(e),d=Sxe(r),d||(r=Hv(r)),g=h.length,y=Ixe(1,g),C=gO(l,h);C!==-1;)x=d?Hv(r(h,C,l)):_xe(h,l,C,[],void 0,r),E+=vB(l,_,C)+x,_=C+g,C=C+y>l.length?-1:gO(l,h,C+y);return _<l.length&&(E+=vB(l,_)),E}});var Pxe=si,Fxe=R1,Mxe=La,kxe=xs,Nxe=Xu,Dxe=TypeError;Pxe({target:"Iterator",proto:!0,real:!0},{reduce:function(e){kxe(this),Mxe(e);var r=Nxe(this),i=arguments.length<2,s=i?void 0:arguments[1],n=0;if(Fxe(r,function(o){i?(i=!1,s=o):s=e(s,o,n),n++},{IS_RECORD:!0}),i)throw new Dxe("Reduce of empty iterator with no initial value");return s}});const dq={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Lxe=new RegExp(Object.keys(dq).map(t=>`(${t})`).join("|"),"gi");function Hxe(t){return(t&&t.nodeName||"")==="TABLE"}function wB(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),i=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],s=t.getData(...i),n=s.length,o=n>0?s[0].length:0,l=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],g=r?1:0,y=e?1:0;for(let C=0;C<n;C+=1){const x=e&&C===0,_=[];for(let R=0;R<o;R+=1){const I=!x&&r&&R===0;let F="";if(x)F=`<th>${t.getColHeader(R-g)}</th>`;else if(I)F=`<th>${t.getRowHeader(C-y)}</th>`;else{const H=s[C][R],{hidden:z,rowspan:q,colspan:re}=t.getCellMeta(C-y,R-g);if(!z){const Y=[];if(q&&Y.push(`rowspan="${q}"`),re&&Y.push(`colspan="${re}"`),Zi(H))F=`<td ${Y.join(" ")}></td>`;else{const oe=H.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");F=`<td ${Y.join(" ")}>${oe}</td>`}}}_.push(F)}const E=["<tr>",..._,"</tr>"].join("");x?h.splice(1,0,E):d.splice(-1,0,E)}return l.splice(1,0,h.join(""),d.join("")),l.join("")}function yB(t){const e=t.length,r=["<table>"];for(let i=0;i<e;i+=1){const s=t[i],n=s.length,o=[];i===0&&r.push("<tbody>");for(let l=0;l<n;l+=1){const h=s[l],d=Zi(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,g=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(g.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${d}</td>`)}r.push("<tr>",...o,"</tr>"),i+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function $xe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},i=e.createDocumentFragment(),s=e.createElement("div");i.appendChild(s);let n=t;if(typeof n=="string"){const H=n.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,z=>{const q=z.match(/<td\b[^>]*?>/g)[0],re=/<p.*?>/g,Y=z.substring(q.length,z.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(re,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${q}${Y}</td>`});s.insertAdjacentHTML("afterbegin",`${H}`),n=s.querySelector("table")}if(!n||!Hxe(n))return;const o=s.querySelector('meta[name$="enerator"]'),l=n.querySelector("tbody th")!==null,h=n.querySelector("tr"),d=h?Array.from(h.cells).reduce((H,z)=>H+z.colSpan,0)-(l?1:0):0,g=n.tFoot&&Array.from(n.tFoot.rows)||[],y=[];let C=!1,x=0,_=0;if(n.tHead){const H=Array.from(n.tHead.rows).filter(z=>{const q=z.querySelector("td")!==null;return q&&y.push(z),!q});x=H.length,C=x>0,x>1?r.nestedHeaders=Array.from(H).reduce((z,q)=>{const re=Array.from(q.cells).reduce((Y,oe,me)=>{if(l&&me===0)return Y;const{colSpan:de,innerHTML:Re}=oe,Ie=de>1?{label:Re,colspan:de}:Re;return Y.push(Ie),Y},[]);return z.push(re),z},[]):C&&(r.colHeaders=Array.from(H[0].children).reduce((z,q,re)=>(l&&re===0||z.push(q.innerHTML),z),[]))}y.length&&(r.fixedRowsTop=y.length),g.length&&(r.fixedRowsBottom=g.length);const E=[...y,...Array.from(n.tBodies).reduce((H,z)=>(H.push(...Array.from(z.rows)),H),[]),...g];_=E.length;const R=new Array(_);for(let H=0;H<_;H++)R[H]=new Array(d);const I=[],F=[];for(let H=0;H<_;H++){const z=E[H],q=Array.from(z.cells),re=q.length;for(let Y=0;Y<re;Y++){const oe=q[Y],{nodeName:me,innerHTML:de,rowSpan:Re,colSpan:Ie}=oe,Be=R[H].findIndex(lt=>lt===void 0);if(me==="TD"){if(Re>1||Ie>1){for(let ct=H;ct<H+Re;ct++)if(ct<_)for(let Ue=Be;Ue<Be+Ie;Ue++)R[ct][Ue]=null;const pt=oe.getAttribute("style");pt&&pt.includes("mso-ignore:colspan")||I.push({col:Be,row:H,rowspan:Re,colspan:Ie})}let lt="";o&&/excel/gi.test(o.content)?lt=de.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):lt=de.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[H][Be]=lt.replace(Lxe,pt=>dq[pt])}else F.push(de)}}return I.length&&(r.mergeCells=I),F.length&&(r.rowHeaders=F),R.length&&(r.data=R),r}function na(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(s=>`\\${s}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Bxe(t){return na(t,[","])}function pr(t,e,r){let i=-1;for(typeof e=="function"?(r=e,e=t):i=t-1;++i<=e&&r(i)!==!1;);}function CB(t,e,r){let i=t+1;for(typeof e=="function"&&(r=e,e=0);--i>=e&&r(i)!==!1;);}function gq(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function vn(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const eF="asc",Vxe="desc",SB=new Map([[eF,[-1,1]],[Vxe,[1,-1]]]),Wxe=t=>`The priority '${t}' is already declared in a map.`,jxe=t=>`The priority '${t}' is not a number.`;function Uxe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=ci(t)?t:Wxe,e=ci(e)?e:jxe;function i(n,o){if(!na(n))throw new Error(e(n));if(r.has(n))throw new Error(t(n));r.set(n,o)}function s(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:eF;const[o,l]=SB.get(n)||SB.get(eF);return[...r].sort((h,d)=>h[0]<d[0]?o:l).map(h=>h[1])}return{addItem:i,getItems:s}}const zxe=t=>`The id '${t}' is already declared in a map.`;function B_(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ci(t)?t:zxe;function r(d,g){if(h(d))throw new Error(t(d));e.set(d,g)}function i(d){return e.delete(d)}function s(){e.clear()}function n(d){const[g]=l().find(y=>{let[C,x]=y;return d===x?C:!1})||[null];return g}function o(d){return e.get(d)}function l(){return[...e]}function h(d){return e.has(d)}return{addItem:r,clear:s,getId:n,getItem:o,getItems:l,hasItem:h,removeItem:i}}const Gxe=t=>`'${t}' value is already declared in a unique set.`;function Yxe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ci(t)?t:Gxe;function r(n){if(e.has(n))throw new Error(t(n));e.add(n)}function i(){return[...e]}function s(){e.clear()}return{addItem:r,clear:s,getItems:i}}const eN=t=>`There is already registered "${t}" plugin.`,Kxe=t=>`There is already registered plugin on priority "${t}".`,Xxe=t=>`The priority "${t}" is not a number.`,mq=Uxe({errorPriorityExists:Kxe,errorPriorityNaN:Xxe}),pq=Yxe({errorItemExists:eN}),tF=B_({errorIdExists:eN});function vq(){return[...mq.getItems(),...pq.getItems()]}function tN(t){const e=Hc(t);return tF.getItem(e)}function qxe(t){return!!tN(t)}function wn(t,e,r){[t,e,r]=Qxe(t,e,r),tN(t)===void 0&&Jxe(t,e,r)}function Jxe(t,e,r){const i=Hc(t);if(tF.hasItem(i))throw new Error(eN(i));r===void 0?pq.addItem(i):mq.addItem(r,i),tF.addItem(i,e)}function Qxe(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:Zxe,getItem:e2e,hasItem:wq,getNames:dXe,getValues:gXe}=Uc("renderers");function rF(t){if(typeof t=="function")return t;if(!wq(t))throw Error(`No registered renderer found under "${t}" name`);return e2e(t)}function Rl(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Zxe(t,e)}const{register:t2e,getItem:r2e,hasItem:yq,getNames:mXe,getValues:pXe}=Uc("validators");function n2e(t){if(typeof t=="function")return t;if(!yq(t))throw Error(`No registered validator found under "${t}" name`);return r2e(t)}function ap(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),t2e(t,e)}var i2e=si,s2e=x1,o2e=T1,a2e=BC,l2e=$_;i2e({target:"Array",proto:!0},{at:function(e){var r=s2e(this),i=o2e(r),s=a2e(e),n=s>=0?s:i+s;return n<0||n>=i?void 0:r[n]}});l2e("at");var c2e=si,u2e=ls,h2e=DC,f2e=BC,d2e=x_,g2e=go,m2e=u2e("".charAt),p2e=g2e(function(){return"".at(-2)!=="\uD842"});c2e({target:"String",proto:!0,forced:p2e},{at:function(e){var r=d2e(h2e(this)),i=r.length,s=f2e(e),n=s>=0?s:i+s;return n<0||n>=i?void 0:m2e(r,n)}});function $v(t,e,r){return(e=v2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v2e(t){var e=w2e(t,"string");return typeof e=="symbol"?e:e+""}function w2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y2e{constructor(){$v(this,"count",0),$v(this,"startColumn",null),$v(this,"endColumn",null),$v(this,"startPosition",null),$v(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:s,viewportWidth:n,columnWidth:o}=r,l=s>0?n+1:n;i>=s&&i+o<=s+l&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:i,viewportWidth:s,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:l,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===l-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const _=d[this.endColumn]+g-d[this.startColumn-1];if(_<=s&&(this.startColumn-=1),_>=s)break}this.startPosition=(r=d[this.startColumn])!==null&&r!==void 0?r:null;const y=o>0?s+1:s,C=i+s-y,x=this.startColumn===null?0:e.getColumnWidth(this.startColumn);C<-1*n||i>d.at(-1)||-1*i-s>-1*x?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Bv(t,e,r){return(e=C2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function C2e(t){var e=S2e(t,"string");return typeof e=="symbol"?e:e+""}function S2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class b2e{constructor(){Bv(this,"count",0),Bv(this,"startRow",null),Bv(this,"endRow",null),Bv(this,"startPosition",null),Bv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:s,innerViewportHeight:n,rowHeight:o}=r;i>=s&&i+o<=n&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:i,viewportHeight:s,horizontalScrollbarHeight:n,totalRows:o,needReverse:l,startPositions:h,rowHeight:d}=e;if(this.endRow===o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const C=h[this.endRow]+d-h[this.startRow-1];if(C<=s-n&&(this.startRow-=1),C>=s-n)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null;const g=i+s-n,y=this.startRow===null?0:e.getRowHeight(this.startRow);g<y||i>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vv(t,e,r){return(e=x2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x2e(t){var e=E2e(t,"string");return typeof e=="symbol"?e:e+""}function E2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cq{constructor(){Vv(this,"count",0),Vv(this,"startColumn",null),Vv(this,"endColumn",null),Vv(this,"startPosition",null),Vv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:i,zeroBasedScrollOffset:s,viewportWidth:n}=r;i<=s&&(this.startColumn=e);const o=s>0?n+1:n;i>=s&&i<=s+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:i,viewportWidth:s,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:l,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===l-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const x=d[this.endColumn]+g-d[this.startColumn-1];if(this.startColumn-=1,x>s)break}this.startPosition=(r=d[this.startColumn])!==null&&r!==void 0?r:null;const y=o>0?s+1:s;i+s-y<-1*n||i>d.at(-1)+g||-1*i-s>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,l<this.endColumn&&(this.endColumn=l-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Wv(t,e,r){return(e=T2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T2e(t){var e=_2e(t,"string");return typeof e=="symbol"?e:e+""}function _2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sq{constructor(){Wv(this,"count",0),Wv(this,"startRow",null),Wv(this,"endRow",null),Wv(this,"startPosition",null),Wv(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:i,zeroBasedScrollOffset:s,innerViewportHeight:n}=r;i<=s&&(this.startRow=e),i>=s&&i<=n&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:i,viewportHeight:s,horizontalScrollbarHeight:n,totalRows:o,needReverse:l,startPositions:h,rowHeight:d}=e;if(this.endRow===o-1&&l)for(this.startRow=this.endRow;this.startRow>0;){const y=h[this.endRow]+d-h[this.startRow-1];if(this.startRow-=1,y>=s-n)break}this.startPosition=(r=h[this.startRow])!==null&&r!==void 0?r:null,i+s-n<0||i>h.at(-1)+d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function jv(t,e,r){return(e=R2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R2e(t){var e=A2e(t,"string");return typeof e=="symbol"?e:e+""}function A2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O2e{constructor(){jv(this,"count",0),jv(this,"startColumn",0),jv(this,"endColumn",0),jv(this,"startPosition",0),jv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Uv(t,e,r){return(e=I2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I2e(t){var e=P2e(t,"string");return typeof e=="symbol"?e:e+""}function P2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F2e{constructor(){Uv(this,"count",0),Uv(this,"startRow",0),Uv(this,"endRow",0),Uv(this,"startPosition",0),Uv(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}function bB(t,e,r){return(e=M2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M2e(t){var e=k2e(t,"string");return typeof e=="symbol"?e:e+""}function k2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N2e extends Cq{constructor(){super(...arguments),bB(this,"columnStartOffset",0),bB(this,"columnEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalColumns:s,startPositions:n}=e;if(this.startColumn!==null&&typeof i=="function"){const o=this.startColumn,l=this.endColumn;i(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-l}this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=n[this.startColumn])!==null&&r!==void 0?r:null,s<this.endColumn&&(this.endColumn=s-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function xB(t,e,r){return(e=D2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D2e(t){var e=L2e(t,"string");return typeof e=="symbol"?e:e+""}function L2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H2e extends Sq{constructor(){super(...arguments),xB(this,"rowStartOffset",0),xB(this,"rowEndOffset",0)}finalize(e){var r;super.finalize(e);const{overrideFn:i,totalRows:s,startPositions:n}=e;if(this.startRow!==null&&typeof i=="function"){const o=this.startRow,l=this.endRow;i(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-l}this.startRow<0&&(this.startRow=0),this.startPosition=(r=n[this.startRow])!==null&&r!==void 0?r:null,s<this.endRow&&(this.endRow=s-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function EB(t,e,r){return(e=$2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $2e(t){var e=B2e(t,"string");return typeof e=="symbol"?e:e+""}function B2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class bq{constructor(e){EB(this,"calculationTypes",[]),EB(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[i,s]=r;this.calculationResults.set(i,s),s.initialize(e)})}_process(e,r){this.calculationTypes.forEach(i=>{let[,s]=i;return s.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,i]=r;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function rc(t,e,r){return(e=V2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V2e(t){var e=W2e(t,"string");return typeof e=="symbol"?e:e+""}function W2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const u1=50;class j2e extends bq{constructor(e){let{calculationTypes:r,viewportWidth:i,scrollOffset:s,totalColumns:n,columnWidthFn:o,overrideFn:l,inlineStartOffset:h}=e;super(r),rc(this,"viewportWidth",0),rc(this,"scrollOffset",0),rc(this,"zeroBasedScrollOffset",0),rc(this,"totalColumns",0),rc(this,"columnWidthFn",null),rc(this,"columnWidth",0),rc(this,"overrideFn",null),rc(this,"inlineStartOffset",0),rc(this,"totalCalculatedWidth",0),rc(this,"startPositions",[]),rc(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalColumns=n,this.columnWidthFn=o,this.overrideFn=l,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?u1:r}}function Sl(t,e,r){return(e=U2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U2e(t){var e=z2e(t,"string");return typeof e=="symbol"?e:e+""}function z2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class G2e extends bq{constructor(e){let{calculationTypes:r,viewportHeight:i,scrollOffset:s,totalRows:n,defaultRowHeight:o,rowHeightFn:l,overrideFn:h,horizontalScrollbarHeight:d}=e;super(r),Sl(this,"viewportHeight",0),Sl(this,"scrollOffset",0),Sl(this,"zeroBasedScrollOffset",0),Sl(this,"totalRows",0),Sl(this,"rowHeightFn",null),Sl(this,"rowHeight",0),Sl(this,"overrideFn",null),Sl(this,"horizontalScrollbarHeight",0),Sl(this,"innerViewportHeight",0),Sl(this,"totalCalculatedHeight",0),Sl(this,"startPositions",[]),Sl(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=s,this.zeroBasedScrollOffset=Math.max(s,0),this.totalRows=n,this.rowHeightFn=l,this.overrideFn=h,this.horizontalScrollbarHeight=d??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?this.defaultHeight:r}}function Y2e(t,e,r){K2e(t,e),e.set(t,r)}function K2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TB(t,e,r){return(e=X2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X2e(t){var e=q2e(t,"string");return typeof e=="symbol"?e:e+""}function q2e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bm(t,e){return t.get(xq(t,e))}function _B(t,e,r){return t.set(xq(t,e),r),r}function xq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ch=new WeakMap;class Ig{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;TB(this,"row",null),TB(this,"col",null),Y2e(this,ch,!1),_B(ch,this,i),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:i,countRowHeaders:s,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-n||this.col<-s||this.row>=r||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return bm(ch,this)}isSouthEastOf(e){return this.row>=e.row&&(bm(ch,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(bm(ch,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(bm(ch,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(bm(ch,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Ig&&_B(ch,this,e.isRtl()),this}clone(){return new Ig(this.row,this.col,bm(ch,this))}toObject(){return{row:this.row,col:this.col}}}function J2e(t,e,r){Q2e(t,e),e.set(t,r)}function Q2e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mO(t,e,r){return(e=Z2e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z2e(t){var e=eEe(t,"string");return typeof e=="symbol"?e:e+""}function eEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bl(t,e){return t.get(Eq(t,e))}function tEe(t,e,r){return t.set(Eq(t,e),r),r}function Eq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pa=new WeakMap;class JC{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;mO(this,"highlight",null),mO(this,"from",null),mO(this,"to",null),J2e(this,pa,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=i.clone(),tEe(pa,this,s)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:i}=e,s=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return s.row<=r&&n.row>=r&&s.col<=i&&n.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner(),n=this.getDirection(),o=e.getOuterTopStartCorner(),l=e.getOuterBottomEndCorner(),h=Math.min(i.row,o.row),d=Math.min(i.col,o.col),g=Math.max(s.row,l.row),y=Math.max(s.col,l.col),C=this._createCellCoords(h,d),x=this._createCellCoords(g,y);return this.from=C,this.to=x,this.setDirection(n),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return bl(pa,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return bl(pa,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return bl(pa,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return bl(pa,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return bl(pa,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return bl(pa,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return bl(pa,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return bl(pa,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Ig))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},s=[];return r.top===i.top&&s.push("top"),r.right===i.right&&s.push(bl(pa,this)?"left":"right"),r.bottom===i.bottom&&s.push("bottom"),r.left===i.left&&s.push(bl(pa,this)?"right":"left"),s}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=r.row;s++)for(let n=e.col;n<=r.col;n++)!(this.from.row===s&&this.from.col===n)&&!(this.to.row===s&&this.to.col===n)&&i.push(this._createCellCoords(s,n));return i}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=[];for(let s=e.row;s<=r.row;s++)for(let n=e.col;n<=r.col;n++)e.row===s&&e.col===n?i.push(e):r.row===s&&r.col===n?i.push(r):i.push(this._createCellCoords(s,n));return i}forAll(e){const r=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let s=r.row;s<=i.row;s++)for(let n=r.col;n<=i.col;n++)if(e(s,n)===!1)return}clone(){return new JC(this.highlight,this.from,this.to,bl(pa,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Ig(e,r,bl(pa,this))}}function ru(t,e,r){rEe(t,e),e.set(t,r)}function rEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e){return t.get(Tq(t,e))}function _f(t,e,r){return t.set(Tq(t,e),r),r}function Tq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xl=new WeakMap,pO=new WeakMap,$s=new WeakMap,xm=new WeakMap,Db=new WeakMap,nc=new WeakMap,vO=new WeakMap,zv=new WeakMap,u0=new WeakMap,nu=new WeakMap;let _q=class{constructor(e,r,i,s,n,o){let l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ru(this,xl,void 0),ru(this,pO,void 0),ru(this,$s,void 0),ru(this,xm,void 0),ru(this,Db,void 0),ru(this,nc,void 0),ru(this,vO,void 0),ru(this,zv,void 0),ru(this,u0,[null,null]),ru(this,nu,[null,null]),_f(xl,this,i),_f(pO,this,r),_f($s,this,n),_f(xm,this,o),_f(Db,this,l),_f(nc,this,s),_f(vO,this,e),this.registerEvents()}registerEvents(){vr(nc,this).addEventListener(vr($s,this).holder,"contextmenu",i=>this.onContextMenu(i)),vr(nc,this).addEventListener(vr($s,this).TABLE,"mouseover",i=>this.onMouseOver(i)),vr(nc,this).addEventListener(vr($s,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{vr(nc,this).addEventListener(vr($s,this).holder,"touchstart",i=>this.onTouchStart(i)),vr(nc,this).addEventListener(vr($s,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),vr(nc,this).addEventListener(vr($s,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||vr(xl,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,vr(xl,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{vr(nc,this).addEventListener(vr($s,this).holder,"mouseup",i=>this.onMouseUp(i)),vr(nc,this).addEventListener(vr($s,this).holder,"mousedown",i=>this.onMouseDown(i))};od()?e():(rq()&&e(),r())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(vr(zv,this)&&i){const[s,n]=[i.row,vr(zv,this).from.row],[o,l]=[i.col,vr(zv,this).from.col];return s===n&&o===l}return!1}parentCell(e){const r={},i=vr($s,this).TABLE,s=Ib(e,["TD","TH"],i);return s?(r.coords=vr($s,this).getCoords(s),r.TD=s):Rr(e,"wtBorder")&&Rr(e,"current")?(r.coords=vr(xm,this).getFocusSelection().cellRange.highlight,r.TD=vr($s,this).getCell(r.coords)):Rr(e,"wtBorder")&&Rr(e,"area")&&vr(xm,this).getAreaSelection().cellRange&&(r.coords=vr(xm,this).getAreaSelection().cellRange.to,r.TD=vr($s,this).getCell(r.coords)),r}onMouseDown(e){const r=vr(pO,this).rootDocument.activeElement,i=JX(SSe,e.target),s=e.target;if(!["TD","TH"].includes(r.nodeName)&&(s===r||i(0)===r||i(1)===r))return;const n=this.parentCell(s);Rr(s,"corner")?vr(xl,this).getSetting("onCellCornerMouseDown",e,s):n.TD&&vr(xl,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,n.coords,n.TD),(e.button===0||this.touchApplied)&&n.TD&&(vr(nu,this)[0]=n.TD,clearTimeout(vr(u0,this)[0]),vr(u0,this)[0]=setTimeout(()=>{vr(nu,this)[0]=null},1e3))}onContextMenu(e){if(vr(xl,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!vr(xl,this).has("onCellMouseOver"))return;const r=vr($s,this).TABLE,i=Ib(e.target,["TD","TH"],r),s=vr(Db,this)||this;i&&i!==s.lastMouseOver&&vg(i,r)&&(s.lastMouseOver=i,this.callListener("onCellMouseOver",e,vr($s,this).getCoords(i),i))}onMouseOut(e){if(!vr(xl,this).has("onCellMouseOut"))return;const r=vr($s,this).TABLE,i=Ib(e.target,["TD","TH"],r),s=Ib(e.relatedTarget,["TD","TH"],r),n=vr(Db,this)||this;i&&i!==s&&vg(i,r)&&(this.callListener("onCellMouseOut",e,vr($s,this).getCoords(i),i),s===null&&(n.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&vr(xl,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===vr(nu,this)[0]&&r.TD===vr(nu,this)[1]?(Rr(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),vr(nu,this)[0]=null,vr(nu,this)[1]=null):r.TD===vr(nu,this)[0]&&(vr(nu,this)[1]=r.TD,clearTimeout(vr(u0,this)[1]),vr(u0,this)[1]=setTimeout(()=>{vr(nu,this)[1]=null},500)))}onTouchStart(e){_f(zv,this,vr(xm,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const i=e.target,s=(r=this.parentCell(i))===null||r===void 0?void 0:r.coords,n=rr(s)&&s.row>=0&&s.col>=0;if(e.cancelable&&n&&vr(xl,this).getSetting("isDataViewInstance")){const l=["A","BUTTON","INPUT"];sq()&&(rbe()||nbe())&&this.selectedCellWasTouched(i)&&!l.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,i,s){const n=vr(xl,this).getSettingPure(e);n&&n(r,i,s,vr(vO,this).call(this))}destroy(){clearTimeout(vr(u0,this)[0]),clearTimeout(vr(u0,this)[1]),vr(nc,this).destroy()}};function wO(t,e,r){return(e=nEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nEe(t){var e=iEe(t,"string");return typeof e=="symbol"?e:e+""}function iEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sEe{constructor(e,r,i){wO(this,"offset",void 0),wO(this,"total",void 0),wO(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function yO(t,e,r){return(e=oEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oEe(t){var e=aEe(t,"string");return typeof e=="symbol"?e:e+""}function aEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lEe{constructor(e,r,i){yO(this,"offset",void 0),yO(this,"total",void 0),yO(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const cEe=0,KE=1,XE=2;function Lb(t,e,r){return(e=uEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uEe(t){var e=hEe(t,"string");return typeof e=="symbol"?e:e+""}function hEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RB{constructor(){Lb(this,"currentSize",0),Lb(this,"nextSize",0),Lb(this,"currentOffset",0),Lb(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function CO(t,e,r){return(e=fEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fEe(t){var e=dEe(t,"string");return typeof e=="symbol"?e:e+""}function dEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gEe{constructor(){CO(this,"size",new RB),CO(this,"workingSpace",cEe),CO(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof RB}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=KE,e.workingSpace=XE,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=XE,e.workingSpace=KE,this.sharedSize=e.getViewSize()}}function Em(t,e,r){return(e=mEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function mEe(t){var e=pEe(t,"string");return typeof e=="symbol"?e:e+""}function pEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rq{constructor(e,r,i){Em(this,"rootNode",void 0),Em(this,"nodesPool",void 0),Em(this,"sizeSet",new gEe),Em(this,"childNodeType",void 0),Em(this,"visualIndex",0),Em(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=i.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let i=0;if(this.isSharedViewSet()){let s=e.firstElementChild;for(;s;){if(s.tagName===this.childNodeType)i+=1;else if(r.isPlaceOn(KE))break;s=s.nextElementSibling}}else i=e.childElementCount;return i}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,i=this.isSharedViewSet(),{nextSize:s}=r.getViewSize();let n=this.getRenderedChildCount();for(;n<s;){const l=this.nodesPool();!i||i&&r.isPlaceOn(XE)?e.appendChild(l):e.insertBefore(l,e.firstChild),n+=1}const o=i&&r.isPlaceOn(KE);for(;n>s;)e.removeChild(o?e.firstChild:e.lastChild),n-=1}render(){const{rootNode:e,sizeSet:r}=this;let i=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(XE)&&(i+=r.sharedSize.nextSize);let s=e.childNodes[i];if(s.tagName!==this.childNodeType){const n=this.nodesPool();e.replaceChild(n,s),s=n}this.collectedNodes.push(s),this.visualIndex+=1}end(){}}class Aq extends Rq{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function vEe(t,e,r){return(e=wEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wEe(t){var e=yEe(t,"string");return typeof e=="symbol"?e:e+""}function yEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CEe{constructor(e){vEe(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Gv(t,e,r){return(e=SEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function SEe(t){var e=bEe(t,"string");return typeof e=="symbol"?e:e+""}function bEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QC{constructor(e,r){Gv(this,"nodesPool",null),Gv(this,"nodeType",void 0),Gv(this,"rootNode",void 0),Gv(this,"table",null),Gv(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new CEe(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function AB(t,e,r){return(e=xEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xEe(t){var e=EEe(t,"string");return typeof e=="symbol"?e:e+""}function EEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TEe extends QC{constructor(){super("TH"),AB(this,"orderViews",new WeakMap),AB(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Aq(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:i,rows:s,cells:n}=this.table;for(let o=0;o<e;o++){const l=this.table.renderedRowToSource(o),h=s.getRenderedNode(o);this.sourceRowIndex=l;const d=this.obtainOrderView(h),g=n.obtainOrderView(h);d.appendView(g).setSize(i).setOffset(this.table.renderedColumnToSource(0)).start();for(let y=0;y<i;y++){d.render();const C=d.getCurrentNode();C.className="",C.removeAttribute("style"),F1(C,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Or(C,[eSe(),cSe(),Vk(y+1),P1(-1)]),r[y](l,C,y)}d.end()}}}class _Ee extends QC{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:s}=this.table,n=s+r;for(let l=0,h=e;l<h;l++){for(i=this.rootNode.childNodes[l],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let l=e;l<o;l++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&Uu(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Or(this.rootNode,[kX()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:i,columnsToRender:s,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&Or(o,[YP(),HX(r+1)]);for(let l=-1*n;l<s;l+=1){const h=this.table.renderedColumnToSource(l),d=o.childNodes[l+n];d.className="",d.removeAttribute("style"),F1(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Or(d,[Vk(l+1+this.table.rowHeadersCount),P1(-1),tSe(),...l>=0?[lSe()]:[YP()]]),i[r](h,d,r)}}}}let OB=!1;class REe extends QC{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,i=e+r;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!OB&&e>1e3&&(OB=!0,Nn(Ln`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let s=0;s<r;s++){const n=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getHeaderWidth(n);this.rootNode.childNodes[s].style.width=`${o}px`}for(let s=0;s<e;s++){const n=this.table.renderedColumnToSource(s),o=this.table.columnUtils.getWidth(n);this.rootNode.childNodes[s+r].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&at(i,"rowHeader")}}function AEe(t,e,r){return(e=OEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OEe(t){var e=IEe(t,"string");return typeof e=="symbol"?e:e+""}function IEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hb={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let IB=!1;class PEe extends QC{constructor(e){super("TR",e),AEe(this,"orderView",void 0),this.orderView=new Rq(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!IB&&e>1e3&&(IB=!0,Nn(Ln`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Or(this.rootNode,[kX()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let s=0;s<e;s++){this.orderView.render();const n=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(s);if(this.table.isAriaEnabled()){var r,i;Or(n,[YP(),HX(o+((r=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}_r(n,[Hb.rowEven,Hb.rowOdd]),(o+1)%2===0?at(n,Hb.rowEven):at(n,Hb.rowOdd)}this.orderView.end()}}function PB(t,e,r){return(e=FEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FEe(t){var e=MEe(t,"string");return typeof e=="symbol"?e:e+""}function MEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kEe extends QC{constructor(){super("TD"),PB(this,"orderViews",new WeakMap),PB(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new Aq(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:i,rowHeaders:s}=this.table;for(let l=0;l<e;l++){const h=this.table.renderedRowToSource(l),d=i.getRenderedNode(l);this.sourceRowIndex=h;const g=this.obtainOrderView(d),y=s.obtainOrderView(d);g.prependView(y).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let C=0;C<r;C++){g.render();const x=g.getCurrentNode(),_=this.table.renderedColumnToSource(C);if(Rr(x,"hide")||(x.className=""),x.removeAttribute("style"),x.removeAttribute("dir"),F1(x,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,_,x),this.table.isAriaEnabled()){var n,o;Or(x,[...x.hasAttribute("role")?[]:[ZCe()],P1(-1),Vk(_+((n=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&n!==void 0?n:0)+1)])}}g.end()}}}function ds(t,e,r){return(e=NEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NEe(t){var e=DEe(t,"string");return typeof e=="symbol"?e:e+""}function DEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LEe{constructor(e){let{cellRenderer:r,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};ds(this,"rootNode",void 0),ds(this,"rootDocument",void 0),ds(this,"rowHeaders",null),ds(this,"columnHeaders",null),ds(this,"colGroup",null),ds(this,"rows",null),ds(this,"cells",null),ds(this,"rowFilter",null),ds(this,"columnFilter",null),ds(this,"rowUtils",null),ds(this,"columnUtils",null),ds(this,"rowsToRender",0),ds(this,"columnsToRender",0),ds(this,"rowHeaderFunctions",[]),ds(this,"rowHeadersCount",0),ds(this,"columnHeaderFunctions",[]),ds(this,"columnHeadersCount",0),ds(this,"cellRenderer",void 0),ds(this,"activeOverlayName",void 0),ds(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:i,rows:s,cells:n}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),i.setTable(this),s.setTable(this),n.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=i,this.rows=s,this.cells=n}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let i=0;i<e;i++){const s=r.getRenderedNode(i),n=this.rowUtils;if(s.firstChild){const o=this.renderedRowToSource(i),l=n.getHeightByOverlayName(o,this.activeOverlayName),d=this.stylesHandler.areCellsBorderBox()?0:1;l?s.firstChild.style.height=`${l-d}px`:s.firstChild.style.height=""}}}}class HEe{constructor(){let{TABLE:e,THEAD:r,COLGROUP:i,TBODY:s,rowUtils:n,columnUtils:o,cellRenderer:l,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new LEe(e,{cellRenderer:l,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new TEe,columnHeaders:new _Ee(r),colGroup:new REe(i),rows:new PEe(s),cells:new kEe}),this.renderer.setAxisUtils(n,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function SO(t,e,r){return(e=$Ee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Ee(t){var e=BEe(t,"string");return typeof e=="symbol"?e:e+""}function BEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class VEe{constructor(e,r){SO(this,"dataAccessObject",void 0),SO(this,"wtSettings",void 0),SO(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=r}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let r=this.dataAccessObject.stylesHandler.getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(r=r?Math.max(r,i):i),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const i=e.getSetting("rowHeaders").length,s=e.getSetting("defaultColumnWidth");for(let n=0;n<i;n++){let o=Array.isArray(r)?r[n]:r;o=o??s,this.headerWidths.set(n,o)}}}}function FB(t,e,r){return(e=WEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WEe(t){var e=jEe(t,"string");return typeof e=="symbol"?e:e+""}function jEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class UEe{constructor(e,r){FB(this,"dataAccessObject",void 0),FB(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(r=r===void 0?i:Math.max(r,i)),r}getHeightByOverlayName(e,r){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const s=this.dataAccessObject.wtViewport.oversizedRows[e];return s!==void 0&&(i=i===void 0?s:Math.max(i,s)),i}}function iu(t,e,r){return(e=zEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zEe(t){var e=GEe(t,"string");return typeof e=="symbol"?e:e+""}function GEe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class k1{constructor(e,r,i,s,n){iu(this,"wtSettings",null),iu(this,"domBindings",void 0),iu(this,"TBODY",null),iu(this,"THEAD",null),iu(this,"COLGROUP",null),iu(this,"hasTableHeight",!0),iu(this,"hasTableWidth",!0),iu(this,"isTableVisible",!1),iu(this,"tableOffset",0),iu(this,"holderOffset",0),this.domBindings=i,this.isMaster=n==="master",this.name=n,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=s,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,WX(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new UEe(this.dataAccessObject,this.wtSettings),this.columnUtils=new VEe(this.dataAccessObject,this.wtSettings),this.tableRenderer=new HEe({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Rr(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",r&&r.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Or(i,[Hu()]),i}createHider(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Rr(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",r&&r.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Or(i,[Hu()]),i}createHolder(e){const r=e.parentNode;let i;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Rr(r,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",r&&r.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Or(i.parentNode,[Hu()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Or(i,[Hu()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:i,wtViewport:s}=this.dataAccessObject,n=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),l=r.getSetting("rowHeaders"),h=l.length,d=r.getSetting("columnHeaders"),g=d.length;let y=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=zs(this.holder),y=s.createCalculators(y),h&&!r.getSetting("fixedColumnsStart"))){const x=i.inlineStartOverlay.getScrollPosition(),_=this.correctHeaderWidth;this.correctHeaderWidth=x!==0,_!==this.correctHeaderWidth&&(y=!1)}if(y)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=zs(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const x=n>0?this.getFirstRenderedRow():0,_=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new lEe(x,n,g),this.columnFilter=new sEe(_,o,h);let E=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const R={};this.wtSettings.getSetting("beforeDraw",!0,R),E=R.skipRender!==!0}E&&(this.tableRenderer.setHeaderContentRenderers(l,d),(this.is(Nu)||this.is(xd))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Nu))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||s.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Nu)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let C=!1;return this.isMaster&&(C=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(C=i.bottomOverlay.resetFixedPosition()||C),C=i.inlineStartOverlay.resetFixedPosition()||C,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),C?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(y),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const s=this.dataAccessObject.stylesHandler.getDefaultRowHeight();let n,o,l;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,n=this.getColumnHeaderHeight(i),o=this.getColumnHeader(r,i),o&&(l=oy(o),(!n&&s<l||n<l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),Array.isArray(h)?h[i]!==null&&h[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(h[i]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,s=e.getSetting("columnHeaders");for(let n=0,o=s.length;n<o;n++)if(i[n]){if(!r[n]||r[n].childNodes.length===0)return;r[n].childNodes[0].style.height=`${i[n]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Nu))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let s=0;s<i;s++){const n=this.rowFilter.renderedToSource(s);r.oversizedRows&&r.oversizedRows[n]&&(r.oversizedRows[n]=void 0)}}}getCell(e){let r=e.row,i=e.col;const s=this.wtSettings.getSetting("onModifyGetCellCoords",r,i,!this.isMaster,"render");if(s&&Array.isArray(s)&&([r,i]=s),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const n=this.getRow(r);if(!n&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,i=null;if(e<0){var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var n;r=(n=this.rowFilter)===null||n===void 0?void 0:n.sourceToRendered(e),i=this.TBODY}return r!==void 0&&i!==void 0?i.childNodes.length<r+1?!1:i.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[r];return i==null?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(s=>{const n=s.childNodes[i];n&&r.push(n)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(r>=i)return;const s=this.rowFilter.sourceToRendered(e),n=s<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):s,l=(s<0?this.THEAD:this.TBODY).childNodes[n];return l==null?void 0:l.childNodes[r]}getRowHeaders(e){const r=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let s=0;s<i;s++){const n=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=n==null?void 0:n.childNodes[s];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=Rg(r,["TD","TH"])),r===null)return null;const i=r.parentNode,s=i.parentNode;let n=TSe(i),o=r.cellIndex;l0(Mg,r,this.wtRootElement)||l0(Pg,r,this.wtRootElement)?s.nodeName==="THEAD"&&(n-=s.childNodes.length):l0(xd,r,this.wtRootElement)||l0(Nu,r,this.wtRootElement)?n=this.wtSettings.getSetting("totalRows")-s.childNodes.length+n:s===this.THEAD?n=this.rowFilter.visibleColHeadedRowToSourceRow(n):n=this.rowFilter.renderedToSource(n),l0(Mg,r,this.wtRootElement)||l0(Fg,r,this.wtRootElement)||l0(xd,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o);const l=this.wtSettings.getSetting("onModifyGetCoordsElement",n,o);return l&&Array.isArray(l)&&([n,o]=l),this.wot.createCellCoords(n,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=oy(this.TBODY)-1,s=this.wot.stylesHandler.areCellsBorderBox(),n=s?es:oy,o=s?0:1,l=s?1:0;let h,d,g,y,C;if(!(r===i&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,g=this.rowFilter.renderedToSource(e),h=this.getRowHeight(g),y=this.getTrForRow(g),C=y.querySelector("th");const x=g===0?l:0;C?d=n(C):d=n(y)-o,(!h&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<d-x||h<d)&&(s||(d+=1),this.dataAccessObject.wtViewport.oversizedRows[g]=d)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return os(this.TABLE)}getHeight(){return es(this.TABLE)}getTotalWidth(){const e=os(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=es(this.hider);return e!==0?e:this.getHeight()}isVisible(){return l1(this.TABLE)}_modifyRowHeaderWidth(e){let r=ci(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const YEe="stickyRowsBottom",rN={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ff(rN,"MIXIN_NAME",YEe,{writable:!1,enumerable:!1});const KEe="stickyColumnsStart",V_={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ff(V_,"MIXIN_NAME",KEe,{writable:!1,enumerable:!1});class nN extends k1{constructor(e,r,i,s){super(e,r,i,s,xd)}}qn(nN,rN);qn(nN,V_);const Pg="top",Nu="bottom",Fg="inline_start",Mg="top_inline_start_corner",xd="bottom_inline_start_corner",Oq=[Pg,Nu,Fg,Mg,xd],XEe=new Map([[Pg,`ht_clone_${Pg}`],[Nu,`ht_clone_${Nu}`],[Fg,`ht_clone_${Fg} ht_clone_left`],[Mg,`ht_clone_${Mg} ht_clone_top_left_corner`],[xd,`ht_clone_${xd} ht_clone_bottom_left_corner`]]);function qEe(t,e){JEe(t,e),e.add(t)}function JEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QEe(t,e,r){return(e=ZEe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZEe(t){var e=eTe(t,"string");return typeof e=="symbol"?e:e+""}function eTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $b(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yv=new WeakSet;class tTe{constructor(e){qEe(this,Yv),QEe(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,i){if(e.col<0||e.row<0)return!1;const s=this.scrollViewportHorizontally(e.col,r),n=this.scrollViewportVertically(e.row,i);return s||n}scrollViewportHorizontally(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i)return!1;const n=il(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,n),!Number.isInteger(e)||e<0||e>s)return!1;r=n.value;const{fixedColumnsStart:o,inlineStartOverlay:l}=this.dataAccessObject,h=r==="auto";if(h&&e<o)return!1;const d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();let y=!1;return(h&&(e<d||e>g)||!h)&&(y=l.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():r==="end")),y}scrollViewportVertically(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i)return!1;const n=il(r);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,n),!Number.isInteger(e)||e<0||e>s)return!1;r=n.value;const{fixedRowsBottom:o,fixedRowsTop:l,topOverlay:h}=this.dataAccessObject,d=r==="auto";if(d&&(e<l||e>s-o-1))return!1;const g=this.getFirstVisibleRow(),y=this.getLastVisibleRow();let C=!1;return(d&&(e<g||e>y)||!d)&&(C=h.scrollTo(e,d?e>=this.getLastPartiallyVisibleRow():r==="bottom")),C}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return $b(Yv,this,kB).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return $b(Yv,this,kB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return $b(Yv,this,MB).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return $b(Yv,this,MB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function MB(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:i,wtViewport:s,totalColumns:n,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const l=e.getSetting("rtlMode");let h=null;if(l){const g=i.TABLE.getBoundingClientRect(),C=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(g.right-C)}else h=zs(i.wtRootElement).left;const d=Math.abs(UX(o,o));if(h>d){const g=zX(o);let y=s.getRowHeaderWidth();for(let C=1;C<=n;C++)if(y+=r.sumCellSizes(C-1,C),h+y-d>=g){t=C-2;break}}}return t}function kB(t){const{topOverlay:e,wtTable:r,wtViewport:i,totalRows:s,rootWindow:n}=this.dataAccessObject;if(e.mainTableScrollableElement===n){const o=zs(r.wtRootElement),l=Uk(n,n);if(o.top>l){const h=oy(n);let d=i.getColumnHeaderHeight();for(let g=1;g<=s;g++)if(d+=e.sumCellSizes(g-1,g),o.top+d-l>=h){t=g-2;break}}}return t}function El(t,e,r){return(e=rTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rTe(t){var e=nTe(t,"string");return typeof e=="symbol"?e:e+""}function nTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iN{get eventManager(){return new $c(this)}constructor(e,r){El(this,"wtTable",void 0),El(this,"wtScroll",void 0),El(this,"wtViewport",void 0),El(this,"wtOverlays",void 0),El(this,"selectionManager",void 0),El(this,"wtEvent",void 0),El(this,"guid",`wt_${PX()}`),El(this,"drawInterrupted",!1),El(this,"drawn",!1),El(this,"activeOverlayName","master"),El(this,"domBindings",void 0),El(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new tTe(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;r<i;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,i){Ag(i,e[r])}])}}createCellCoords(e,r){return new Ig(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,i){return new JC(e,r,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),s=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<s&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<s)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,i){return this.wtScroll.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this.wtScroll.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this.wtScroll.scrollViewportVertically(e,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function NB(t,e,r){return(e=iTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iTe(t){var e=sTe(t,"string");return typeof e=="symbol"?e:e+""}function sTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oTe extends iN{constructor(e,r,i){super(e,r),NB(this,"cloneSource",void 0),NB(this,"cloneOverlay",void 0);const s=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),s,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new _q(s,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function aTe(t,e,r){return(e=lTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lTe(t){var e=cTe(t,"string");return typeof e=="symbol"?e:e+""}function cTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZC{constructor(e,r,i,s,n){aTe(this,"wtSettings",null),ff(this,"wot",e,{writable:!1}),this.domBindings=n,this.facadeGetter=r,this.wtSettings=s;const{TABLE:o,hider:l,spreader:h,holder:d,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=l,this.spreader=h,this.holder=d,this.wtRootElement=g,this.trimmingContainer=c1(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=c1(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=jE(e.TABLE)}getRelativeCellPosition(e,r,i){if(this.clone.wtTable.holder.contains(e)===!1){Nn(`The provided element is not a child of the ${this.type} overlay`);return}const s=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),l=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(h),top:h.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop};let y=null;return s?y=this.getRelativeCellPositionWithinWindow(o,n,g,d):y=this.getRelativeCellPositionWithinHolder(o,l,n,g,d),y}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,i,s){const n=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,l=0;if(!r)o=s.start;else{let h=n.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(n.left+n.width+co())),o=h<=0?-1*h:0}return e?l=this.clone.wtTable.TABLE.getBoundingClientRect().top-n.top:l=s.top,{start:i.start+o,top:i.top+l}}getRelativeCellPositionWithinHolder(e,r,i,s,n){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let l=0,h=0;if(i||(l=o.horizontal-n.start),r){const d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(h=o.vertical-n.top);return{start:s.start-l,top:s.top-h}}makeClone(){if(Oq.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,n=i.createElement("div"),o=i.createElement("table"),l=e.wtRootElement.parentNode;n.className=`${XEe.get(this.type)} handsontable`,n.setAttribute("dir",this.isRtl()?"rtl":"ltr"),n.style.position="absolute",n.style.top=0,n.style.overflow="visible",this.isRtl()?n.style.right=0:n.style.left=0,r.getSetting("ariaTags")&&Or(n,[Hu()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),n.appendChild(o),l.appendChild(n);const d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===Pg||d==="vertical"&&this.type===Fg?this.mainTableScrollableElement=s:s.getComputedStyle(l).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=jE(e.TABLE),new oTe(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const r=this.clone.cloneSource;r.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),r.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,i=e.style,s=r.style,n=e.parentNode.style;[i,s,n].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class uTe extends ZC{constructor(e,r,i,s,n,o){super(e,r,xd,i,s),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new nN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const n=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${n}px`,r.style.bottom=`${o}px`}else L_(r),this.repositionOverlay();let i=es(this.clone.wtTable.TABLE);const s=os(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),r.style.height=`${i}px`,r.style.width=`${s}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let n=0;r.hasVerticalScroll()||(n+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(n+=co(i)),s.style.bottom=`${n}px`}}const hTe="calculatedColumns",W_={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ff(W_,"MIXIN_NAME",hTe,{writable:!1,enumerable:!1});class sN extends k1{constructor(e,r,i,s){super(e,r,i,s,Nu)}}qn(sN,rN);qn(sN,W_);function fTe(t,e,r){return(e=dTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dTe(t){var e=gTe(t,"string");return typeof e=="symbol"?e:e+""}function gTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mTe extends ZC{constructor(e,r,i,s){super(e,r,Nu,i,s),fTe(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new sN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let i=0;const s=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!s||s!=="vertical")?(i=this.getOverlayOffset(),r.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i}=this.domBindings,s=this.clone.wtTable.holder.parentNode;let n=0;r.hasVerticalScroll()||(n+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(n+=co(i)),s.style.bottom=`${n}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let i=!1;return this.mainTableScrollableElement===r?(r.scrollTo(jk(r),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:i,stylesHandler:s}=this.wot,n=s.getDefaultRowHeight();let o=e,l=0;for(;o<r;){const h=i.getRowHeight(o);l+=h===void 0?n:h,o+=1}return l}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let d=r.getWorkspaceWidth();r.hasVerticalScroll()&&(d-=co(i)),d=Math.min(d,e.wtRootElement.scrollWidth),o.width=`${d}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let h=es(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),o.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let i=this.getTableParentOffset();const n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&n.offsetHeight!==n.clientHeight&&(o=co(this.domBindings.rootDocument)),r?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uk(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight(),o=s-n,l=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-l+s,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==r,s=this.wtSettings.getSetting("columnHeaders");let n=!1;if((i||r===0)&&s.length>0){const o=this.wot.wtTable.holder.parentNode,l=Rr(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(at(o,"innerBorderBottom"),n=!l):(_r(o,"innerBorderBottom"),n=l)}return n}}const pTe="calculatedRows",oN={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ff(oN,"MIXIN_NAME",pTe,{writable:!1,enumerable:!1});class aN extends k1{constructor(e,r,i,s){super(e,r,i,s,Fg)}}qn(aN,oN);qn(aN,V_);const vTe="localHooks",mo={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,i,s,n,o){if(this._localHooks[t]){const l=this._localHooks[t].length;for(let h=0;h<l;h++)KP(this._localHooks[t][h],this,e,r,i,s,n,o)}},clearLocalHooks(){return this._localHooks={},this}};ff(mo,"MIXIN_NAME",vTe,{writable:!1,enumerable:!1});let Iq=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};qn(Iq,mo);const Pq="active-header",lN="header",cN="area",qE="focus",wTe="fill",yTe="row",CTe="column",STe="custom-selection",uN=t=>{const e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const r=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),s=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:r,height:r,borderWidth:i,borderStyle:"solid",borderColor:s})};var bTe=$_;bTe("flat");function xTe(t,e){Fq(t,e),e.add(t)}function DB(t,e,r){Fq(t,e),e.set(t,r)}function Fq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ni(t,e){return t.get(ay(t,e))}function LB(t,e,r){return t.set(ay(t,e),r),r}function ay(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fc=new WeakMap,Oo=new WeakMap,Bb=new WeakSet;class ETe{constructor(){xTe(this,Bb),DB(this,fc,void 0),DB(this,Oo,void 0)}setActiveOverlay(e){return LB(Oo,this,e),this}setActiveSelection(e){return LB(fc,this,e),this}scan(){const e=Ni(fc,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="area"?this.scanCellsRange(i=>r.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i)),this.scanCellsRange(i=>r.add(i))):e==="fill"?this.scanCellsRange(i=>r.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanRowsInHeadersRange(i=>r.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>r.add(i)),this.scanRowsInCellsRange(i=>r.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>r.add(i)),this.scanColumnsInCellsRange(i=>r.add(i))),r}scanColumnsInHeadersRange(e){const[r,i,s,n]=Ni(fc,this).getCorners(),{wtTable:o}=Ni(Oo,this),l=o.getRenderedColumnsCount(),h=o.getColumnHeadersCount();let d=0;for(let g=-o.getRowHeadersCount();g<l;g++){const y=o.columnFilter.renderedToSource(g);if(!(y<i||y>n)){for(let C=-h;C<0;C++){if(C<r||C>s)continue;const x=C+h;let _=o.getColumnHeader(y,x);const E=Ni(Oo,this).getSetting("onBeforeHighlightingColumnHeader",y,x,{selectionType:Ni(fc,this).settings.selectionType,columnCursor:d,selectionWidth:n-i+1});E!==null&&(E!==y&&(_=o.getColumnHeader(E,x)),e(_))}d+=1}}}scanRowsInHeadersRange(e){const[r,i,s,n]=Ni(fc,this).getCorners(),{wtTable:o}=Ni(Oo,this),l=o.getRenderedRowsCount(),h=o.getRowHeadersCount();let d=0;for(let g=-o.getColumnHeadersCount();g<l;g++){const y=o.rowFilter.renderedToSource(g);if(!(y<r||y>s)){for(let C=-h;C<0;C++){if(C<i||C>n)continue;const x=C+h;let _=o.getRowHeader(y,x);const E=Ni(Oo,this).getSetting("onBeforeHighlightingRowHeader",y,x,{selectionType:Ni(fc,this).settings.selectionType,rowCursor:d,selectionHeight:s-r+1});E!==null&&(E!==y&&(_=o.getRowHeader(E,x)),e(_))}d+=1}}}scanCellsRange(e){const{wtTable:r}=Ni(Oo,this);ay(Bb,this,TTe).call(this,(i,s)=>{const n=r.getCell(Ni(Oo,this).createCellCoords(i,s)),o=Ni(Oo,this).getSetting("onAfterDrawSelection",i,s,Ni(fc,this).settings.layerLevel);typeof o=="string"&&at(n,o),e(n)})}scanRowsInCellsRange(e){const[r,,i]=Ni(fc,this).getCorners(),{wtTable:s}=Ni(Oo,this);ay(Bb,this,HB).call(this,(n,o)=>{if(n>=r&&n<=i){const l=s.getCell(Ni(Oo,this).createCellCoords(n,o));e(l)}})}scanColumnsInCellsRange(e){const[,r,,i]=Ni(fc,this).getCorners(),{wtTable:s}=Ni(Oo,this);ay(Bb,this,HB).call(this,(n,o)=>{if(o>=r&&o<=i){const l=s.getCell(Ni(Oo,this).createCellCoords(n,o));e(l)}})}}function TTe(t){let[e,r,i,s]=Ni(fc,this).getCorners();if(e<0&&i<0||r<0&&s<0)return;const{wtTable:n}=Ni(Oo,this),o=e!==i||r!==s;if(r=Math.max(r,0),s=Math.max(s,0),e=Math.max(e,0),i=Math.max(i,0),o){if(r=Math.max(r,n.getFirstRenderedColumn()),s=Math.min(s,n.getLastRenderedColumn()),e=Math.max(e,n.getFirstRenderedRow()),i=Math.min(i,n.getLastRenderedRow()),s<r||i<e)return}else if(!(n.getCell(Ni(Oo,this).createCellCoords(e,r))instanceof HTMLElement))return;for(let l=e;l<=i;l+=1)for(let h=r;h<=s;h+=1)t(l,h)}function HB(t){const{wtTable:e}=Ni(Oo,this),r=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let s=0;s<r;s+=1){const n=e.rowFilter.renderedToSource(s);for(let o=0;o<i;o+=1)t(n,e.columnFilter.renderedToSource(o))}}class $B{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=uN(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,i=this.main.childNodes.length;r<i;r++){const s=this.main.childNodes[r];this.eventManager.addEventListener(s,"mouseenter",n=>this.onMouseEnter(n,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),jc(e);const i=this,s=this.wot.rootDocument.body,n=r.getBoundingClientRect();r.style.display="none";function o(h){if(h.clientY<Math.floor(n.top)||h.clientY>Math.ceil(n.top+n.height)||h.clientX<Math.floor(n.left)||h.clientX>Math.ceil(n.left+n.width))return!0}function l(h){o(h)&&(i.eventManager.removeEventListener(s,"mousemove",l),r.style.display="block")}this.eventManager.addEventListener(s,"mousemove",l)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const i=["top","start","bottom","end","corner"];let s=this.main.style;s.position="absolute",s.top=0,s.left=0;for(let l=0;l<5;l++){const h=i[l],d=r.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(d.className+=" hidden"),s=d.style,s.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,s.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,s.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),od()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:n}=this.wot;let o=n.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,i=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const s={position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${parseInt(i/1.5,10)}px`};Zr(s,(o,l)=>{this.selectionHandles.styles.bottomHitArea[l]=o,this.selectionHandles.styles.topHitArea[l]=o});const n={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Zr(n,(o,l)=>{this.selectionHandles.styles.bottom[l]=o,this.selectionHandles.styles.top[l]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||r!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,i,s,n,o){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:g,bottom:y,bottomHitArea:C}=this.selectionHandles.styles,x=parseInt(d.borderWidth,10),_=parseInt(d.width,10),E=parseInt(g.width,10),R=this.wot.wtTable.getWidth(),I=this.wot.wtTable.getHeight();d.top=`${parseInt(i-_-1,10)}px`,d[h]=`${parseInt(s-_-1,10)}px`,g.top=`${parseInt(i-E/4*3,10)}px`,g[h]=`${parseInt(s-E/4*3,10)}px`;const F=Math.min(parseInt(s+n,10),R-_-x*2),H=Math.min(parseInt(s+n-E/4,10),R-E-x*2);y[h]=`${F}px`,C[h]=`${H}px`;const z=Math.min(parseInt(i+o,10),I-_-x*2),q=Math.min(parseInt(i+o-E/4,10),I-E-x*2);y.top=`${z}px`,C.top=`${q}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",g.display="block",this.isPartRange(e,r)?(y.display="none",C.display="none"):(y.display="block",C.display="block")):(d.display="none",y.display="none",g.display="none",C.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",g.zIndex="9999"):(d.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let[r,i,s,n]=e;if(r<0&&s<0||i<0&&n<0){this.disappear();return}const{wtTable:o,rootDocument:l,rootWindow:h}=this.wot,d=r!==s||i!==n,g=o.getFirstRenderedRow(),y=o.getLastRenderedRow(),C=o.getFirstRenderedColumn(),x=o.getLastRenderedColumn();let _;if(d){if(i=Math.max(i,C),n=Math.min(n,x),r=Math.max(r,g),s=Math.min(s,y),n<i||s<r){this.disappear();return}_=o.getCell(this.wot.createCellCoords(r,i))}else if(_=o.getCell(this.wot.createCellCoords(r,i)),!(_ instanceof HTMLElement)){this.disappear();return}const E=d?o.getCell(this.wot.createCellCoords(s,n)):_,R=zs(_),I=d?zs(E):R,F=zs(o.TABLE),H=R.top,z=R.left,q=this.wot.wtSettings.getSetting("rtlMode");let re=0,Y=0;if(q){const ct=os(o.TABLE),Ue=os(_),Je=h.innerWidth-F.left-ct;Y=z+Ue-I.left,re=h.innerWidth-z-Ue-Je-1}else Y=I.left+os(E)-z,re=z-F.left-1;if(this.isEntireColumnSelected(r,s)){const ct=r,Ue=this.getDimensionsFromHeader("columns",i,n,ct,F);let Je=null;Ue&&([Je,re,Y]=Ue),Je&&(_=Je)}let oe=H-F.top-1,me=I.top+es(E)-H;if(this.isEntireRowSelected(i,n)){const ct=i,Ue=this.getDimensionsFromHeader("rows",r,s,ct,F);let Je=null;Ue&&([Je,oe,me]=Ue),Je&&(_=Je)}const de=h.getComputedStyle(_);parseInt(de.borderTopWidth,10)>0&&(oe+=1,me=me>0?me-1:0),parseInt(de[q?"borderRightWidth":"borderLeftWidth"],10)>0&&(re+=1,Y=Y>0?Y-1:0);const Re=q?"right":"left";this.topStyle.top=`${oe}px`,this.topStyle[Re]=`${re}px`,this.topStyle.width=`${Y}px`,this.topStyle.display="block",this.startStyle.top=`${oe}px`,this.startStyle[Re]=`${re}px`,this.startStyle.height=`${me}px`,this.startStyle.display="block";const Ie=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${oe+me-Ie}px`,this.bottomStyle[Re]=`${re}px`,this.bottomStyle.width=`${Y}px`,this.bottomStyle.display="block",this.endStyle.top=`${oe}px`,this.endStyle[Re]=`${re+Y-Ie}px`,this.endStyle.height=`${me+1}px`,this.endStyle.display="block";let Be=this.settings.border.cornerVisible;Be=typeof Be=="function"?Be(this.settings.layerLevel):Be;const lt=this.wot.getSetting("onModifyGetCellCoords",s,n,!1,"render");let[pt,Ct]=[s,n];if(lt&&Array.isArray(lt)&&([,,pt,Ct]=lt),od()||!Be||this.isPartRange(pt,Ct))this.cornerStyle.display="none";else{this.cornerStyle.top=`${oe+me+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[Re]=`${re+Y+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ct=c1(o.TABLE);const Ue=ct===h;Ue&&(ct=l.documentElement);const Je=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Fe=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),A=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(n===this.wot.getSetting("totalColumns")-1){const O=Ue?E.getBoundingClientRect().left:E.offsetLeft;let k=!1,L=0;q?(L=O-parseInt(this.cornerDefaultStyle.width,10)/2,k=L<0):(L=O+os(E)+parseInt(this.cornerDefaultStyle.width,10)/2,k=L>=zX(ct)),k&&(this.cornerStyle[Re]=`${Math.floor(re+Y+this.cornerCenterPointOffset-Fe-Je)}px`,this.cornerStyle[q?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(Ue?E.getBoundingClientRect().top:E.offsetTop)+es(E)+parseInt(this.cornerDefaultStyle.height,10)/2>=oy(ct)&&(this.cornerStyle.top=`${Math.floor(oe+me+this.cornerCenterPointOffset-A-Je)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}od()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(s,n,oe,re,Y,me)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,i,s,n){const{wtTable:o}=this.wot,l=o.wtRootElement.parentNode;let h=null,d=null,g=null,y=null,C=null,x=null,_=null,E=null;switch(e){case"rows":h=function(){return o.getRowHeader(...arguments)},d=function(){return es(...arguments)},g="ht__selection--rows",x="top";break;case"columns":h=function(){return o.getColumnHeader(...arguments)},d=function(){return os(...arguments)},g="ht__selection--columns",x="left";break}if(l.classList.contains(g)){const R=this.wot.getSetting("columnHeaders").length;if(_=h(r,R-s),E=h(i,R-s),!_||!E)return!1;const I=zs(_),F=zs(E);return _&&E&&(y=I[x]-n[x]-1,C=F[x]+d(E)-I[x]),[_,y,C]}return!1}changeBorderStyle(e,r){const i=this[e].style,s=r[e];!s||s.hide?at(this[e],"hidden"):(Rr(this[e],"hidden")&&_r(this[e],"hidden"),i.backgroundColor=s.color,(e==="top"||e==="bottom")&&(i.height=`${s.width}px`),(e==="start"||e==="end")&&(i.width=`${s.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},i=this[e].style;i.backgroundColor=r.color,i.width=`${r.width}px`,i.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?at(this[e],"hidden"):_r(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",od()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _Te(t,e){Mq(t,e),e.add(t)}function Tm(t,e,r){Mq(t,e),e.set(t,r)}function Mq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qr(t,e){return t.get(hN(t,e))}function BB(t,e,r){return t.set(hN(t,e),r),r}function hN(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Io=new WeakMap,xa=new WeakMap,bO=new WeakMap,Bw=new WeakMap,xO=new WeakMap,h0=new WeakMap,VB=new WeakSet;class RTe{constructor(e){_Te(this,VB),Tm(this,Io,void 0),Tm(this,xa,void 0),Tm(this,bO,new ETe),Tm(this,Bw,new WeakMap),Tm(this,xO,new WeakSet),Tm(this,h0,new Map),BB(xa,this,e)}setActiveOverlay(e){return BB(Io,this,e),qr(bO,this).setActiveOverlay(qr(Io,this)),qr(Bw,this).has(qr(Io,this))||qr(Bw,this).set(qr(Io,this),new Set),this}getFocusSelection(){return qr(xa,this)!==null?qr(xa,this).getFocus():null}getAreaSelection(){return qr(xa,this)!==null?qr(xa,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(qr(h0,this).has(e)){const i=qr(h0,this).get(e);if(i.has(qr(Io,this)))return i.get(qr(Io,this));const s=new $B(qr(Io,this),e.settings);return i.set(qr(Io,this),s),s}const r=new $B(qr(Io,this),e.settings);return qr(h0,this).set(e,new Map([[qr(Io,this),r]])),r}getBorderInstances(e){var r,i;return Array.from((r=(i=qr(h0,this).get(e))===null||i===void 0?void 0:i.values())!==null&&r!==void 0?r:[])}destroyBorders(e){qr(h0,this).get(e).forEach(r=>r.destroy()),qr(h0,this).delete(e)}render(e){if(qr(xa,this)===null)return;e&&hN(VB,this,ATe).call(this);const r=Array.from(qr(xa,this)),i=new Map,s=new Map;for(let n=0;n<r.length;n++){const o=r[n],{className:l,headerAttributes:h,createLayers:d,selectionType:g}=o.settings;qr(xO,this).has(o)||(qr(xO,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const y=this.getBorderInstance(o);if(o.isEmpty()){y==null||y.disappear();continue}l&&qr(bO,this).setActiveSelection(o).scan().forEach(_=>{if(i.has(_)){const E=i.get(_);E.has(l)&&d===!0?E.set(l,E.get(l)+1):E.set(l,1)}else i.set(_,new Map([[l,1]]));h&&(s.has(_)||s.set(_,[]),_.nodeName==="TH"&&s.get(_).push(...h))});const C=o.getCorners();qr(Io,this).getSetting("onBeforeDrawBorders",C,g),y==null||y.appear(C)}i.forEach((n,o)=>{var l;const h=Array.from(n).map(d=>{let[g,y]=d;return y===1?g:[g,...Array.from({length:y-1},(C,x)=>`${g}-${x+1}`)]}).flat();h.forEach(d=>qr(Bw,this).get(qr(Io,this)).add(d)),at(o,h),o.nodeName==="TD"&&Array.isArray((l=qr(xa,this).options)===null||l===void 0?void 0:l.cellAttributes)&&Or(o,qr(xa,this).options.cellAttributes)}),Array.from(s.keys()).forEach(n=>{Or(n,[...s.get(n)])})}}function ATe(){const t=qr(Bw,this).get(qr(Io,this)),e=qr(Io,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var i,s;const n=qr(Io,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((i=qr(xa,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=qr(xa,this).options.cellAttributes.map(l=>l[0])),Array.isArray((s=qr(xa,this).options)===null||s===void 0?void 0:s.headerAttributes)&&(o=[...o,...qr(xa,this).options.headerAttributes.map(l=>l[0])]);for(let l=0,h=n.length;l<h;l++)_r(n[l],r),F1(n[l],o)}),t.clear()}class OTe extends ZC{constructor(e,r,i,s){super(e,r,Fg,i,s)}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new aN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode,s=this.wtSettings.getSetting("preventOverflow");let n=0;this.trimmingContainer===r&&(!s||s!=="horizontal")?(n=this.getOverlayOffset()*(this.isRtl()?-1:1),zk(i,`${n}px`,"0px")):(n=this.getScrollPosition(),L_(i));const o=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let i=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,jX(r)),i=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const i=this.wtSettings.getSetting("defaultColumnWidth");let s=e,n=0;for(;s<r;)n+=this.wot.wtTable.getColumnWidth(s)||i,s+=1;return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="vertical"){let d=r.getWorkspaceHeight();r.hasHorizontalScroll()&&(d-=co(i)),d=Math.min(d,e.wtRootElement.scrollHeight),o.height=`${d}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const h=os(this.clone.wtTable.TABLE);o.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=uN(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:i}=this,s=i.getSetting("rowHeaders"),n=i.getSetting("fixedColumnsStart"),l=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=n===0&&s.length>0&&!Rr(l.parentNode,"innerBorderInlineStart")?1:0;let d=this.getTableParentOffset(),g=0;if(r){const y=this.wot.wtTable.getColumnWidth(e),C=this.wot.wtViewport.getViewportWidth();y>C&&(r=!1)}return r&&l.offsetWidth!==l.clientWidth&&(g=co(this.domBindings.rootDocument)),r?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=h):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=g,ASe(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(UX(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const s=this.wot.wtTable.getTotalWidth(),n=this.clone.wtTable.getTotalWidth(),o=s-n;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,i=this.wot.wtTable.holder.parentNode,s=r.getSetting("rowHeaders"),n=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),l=r.getSetting("preventOverflow")==="vertical";o?_r(i,"emptyRows"):at(i,"emptyRows");let h=!1;if(!l){if(n&&!s.length)at(i,"innerBorderLeft innerBorderInlineStart");else if(!n&&s.length){const d=Rr(i,"innerBorderInlineStart");e?(at(i,"innerBorderLeft innerBorderInlineStart"),h=!d):(_r(i,"innerBorderLeft innerBorderInlineStart"),h=d)}}return h}}const ITe="stickyRowsTop",fN={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ff(fN,"MIXIN_NAME",ITe,{writable:!1,enumerable:!1});class dN extends k1{constructor(e,r,i,s){super(e,r,i,s,Mg)}}qn(dN,fN);qn(dN,V_);function WB(t,e,r){return(e=PTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PTe(t){var e=FTe(t,"string");return typeof e=="symbol"?e:e+""}function FTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class MTe extends ZC{constructor(e,r,i,s,n,o){super(e,r,Mg,i,s),WB(this,"topOverlay",void 0),WB(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new dN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),n=this.topOverlay.getOverlayOffset();zk(e,`${s}px`,`${n}px`)}else L_(e);let r=es(this.clone.wtTable.TABLE);const i=os(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${i}px`,!1}}class gN extends k1{constructor(e,r,i,s){super(e,r,i,s,Pg)}}qn(gN,fN);qn(gN,W_);function kTe(t,e,r){return(e=NTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NTe(t){var e=DTe(t,"string");return typeof e=="symbol"?e:e+""}function DTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LTe extends ZC{constructor(e,r,i,s){super(e,r,Pg,i,s),kTe(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new gN(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let s=0,n=!1;if(this.trimmingContainer===r&&(!i||i!=="vertical")){const{wtTable:l}=this.wot,h=l.hider.getBoundingClientRect(),d=Math.ceil(h.bottom),g=e.offsetHeight;n=d===g,s=this.getOverlayOffset(),zk(e,"0px",`${s}px`)}else s=this.getScrollPosition(),L_(e);const o=this.adjustHeaderBordersPosition(s,n);return this.adjustElementsSize(),o}setScrollPosition(e){const r=this.domBindings.rootWindow;let i=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(jk(r),e),i=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,i=!0),i}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const i=this.wot.stylesHandler.getDefaultRowHeight();let s=e,n=0;for(;s<r;){const o=this.wot.wtTable.getRowHeight(s);n+=o===void 0?i:o,s+=1}return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:i,rootWindow:s}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==s||l==="horizontal"){let d=r.getWorkspaceWidth();r.hasVerticalScroll()&&(d-=co(i)),d=Math.min(d,e.wtRootElement.scrollWidth),o.width=`${d}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let h=es(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),o.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=uN(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(r.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:i,wtSettings:s}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,l=s.getSetting("columnHeaders"),d=s.getSetting("fixedRowsTop")===0&&l.length>0&&!Rr(o.parentNode,"innerBorderTop")?1:0;let g=this.getTableParentOffset(),y=0;if(r){const C=this.wot.wtTable.getRowHeight(e),x=this.wot.wtViewport.getViewportHeight();C>x&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(y=co(this.domBindings.rootDocument)),r){const C=s.getSetting("fixedRowsBottom"),x=s.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=i.wtViewport.getViewportHeight()-this.sumCellSizes(x-C,x),g+=1,g+=d}else g+=this.sumCellSizes(s.getSetting("fixedRowsTop"),e);return g+=y,RSe(this.mainTableScrollableElement)===g-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Uk(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const s=this.wot.wtTable.getTotalHeight(),n=this.clone.wtTable.getTotalHeight(),o=s-n;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,s=this.wot.wtTable.holder.parentNode,n=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";n?_r(s,"emptyColumns"):at(s,"emptyColumns");let l=!1;if(!r&&!o){const h=i.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==h,g=i.getSetting("columnHeaders");if((d||h===0)&&g.length>0){const y=Rr(s,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(at(s,"innerBorderTop"),l=!y):(_r(s,"innerBorderTop"),l=y)}}return l}}function Vb(t,e,r){HTe(t,e),e.set(t,r)}function HTe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uh(t,e,r){return(e=$Te(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Te(t){var e=BTe(t,"string");return typeof e=="symbol"?e:e+""}function BTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function f0(t,e,r){return t.set(kq(t,e),r),r}function hh(t,e){return t.get(kq(t,e))}function kq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _m=new WeakMap,Wb=new WeakMap,Rm=new WeakMap,jb=new WeakMap;class VTe{constructor(e,r,i,s,n,o){uh(this,"wot",null),Vb(this,_m,[]),uh(this,"topOverlay",null),uh(this,"bottomOverlay",null),uh(this,"inlineStartOverlay",null),uh(this,"topInlineStartCornerOverlay",null),uh(this,"bottomInlineStartCornerOverlay",null),uh(this,"browserLineHeight",void 0),uh(this,"wtSettings",null),Vb(this,Wb,!1),Vb(this,Rm,0),Vb(this,jb,null),uh(this,"resizeObserver",new ResizeObserver(g=>{zE(()=>{!Array.isArray(g)||!g.length||(f0(Rm,this,hh(Rm,this)+1),hh(Rm,this)===100&&(Nn("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),hh(jb,this)!==null&&clearTimeout(hh(jb,this)),f0(jb,this,setTimeout(()=>{f0(Rm,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=s,this.domBindings=i,this.facadeGetter=r,this.wtTable=o;const{rootDocument:l,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=n,this.scrollbarSize=co(l);const d=h.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?o.holder:jE(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...hh(_m,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,i=e.getComputedStyle(r.body),s=parseInt(i.lineHeight,10),n=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=s||n}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new LTe(...e),this.bottomOverlay=new mTe(...e),this.inlineStartOverlay=new OTe(...e),this.topInlineStartCornerOverlay=new MTe(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new uTe(...e,this.bottomOverlay,this.inlineStartOverlay),f0(_m,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){f0(Wb,this,hh(_m,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),hh(_m,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),hh(_m,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:s}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",y=>this.onKeyDown(y)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",y=>this.onTableScroll(y),{passive:!0}),i!==s&&this.eventManager.addEventListener(s,"scroll",y=>this.onTableScroll(y),{passive:!0});const n=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,l=this.wtSettings.getSetting("preventWheel"),h={passive:o};(l||n||!nq())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",y=>this.onCloneWheel(y,l),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(y=>{if(y&&y.needFullRender){const{holder:C}=y.clone.wtTable;this.eventManager.addEventListener(C,"wheel",x=>this.onCloneWheel(x,l),h)}});let g;this.eventManager.addEventListener(r,"resize",()=>{zE(()=>{clearTimeout(g),this.wtSettings.getSetting("onWindowResize"),g=setTimeout(()=>{f0(Rm,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,n=e.target;this.keyPressed&&(s!==r&&n!==r&&!e.target.contains(s)||i!==r&&n!==r&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:i}=this.domBindings,s=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target,l=n!==i&&o!==i&&!o.contains(n),h=s!==i&&o!==i&&!o.contains(s);if(this.keyPressed&&(l||h)||this.scrollableElement===i)return;const d=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==i&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=qC(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,r+=r*this.browserLineHeight);const s=this.scrollVertically(r),n=this.scrollHorizontally(i);return s||n}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,i=this.inlineStartOverlay.clone.wtTable.holder,[s,n]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==s||this.lastScrollX!==e.scrollX,this.verticalScrolling=i.scrollTop!==n||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=s;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=s)}this.verticalScrolling&&(i.scrollTop=n),this.refreshAll()}syncScrollWithMaster(){if(!hh(Wb,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),f0(Wb,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=jE(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,i=e.clientHeight,s=r!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return s&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=i),s}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:i}=this.domBindings,s=this.scrollableElement===i,n=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),l=e.getRowHeaderWidth(),d=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,g=l+this.inlineStartOverlay.sumCellSizes(0,n),C=r.hider.style,x=()=>s?!1:this.scrollableElement.scrollTop>Math.max(0,d-r.holder.clientHeight),_=()=>s?!1:this.scrollableElement.scrollLeft>Math.max(0,g-r.holder.clientWidth),E=x()?1:0,R=_()?1:0;C.width=`${g+R}px`,C.height=`${d+E}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return xe(r,s=>{s&&s.clone&&s.clone.wtTable.TABLE.contains(e)&&(i=s.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];xe(r,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function jB(t,e,r){return(e=WTe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WTe(t){var e=jTe(t,"string");return typeof e=="symbol"?e:e+""}function jTe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let UTe=class{constructor(e){jB(this,"settings",{}),jB(this,"defaults",Object.freeze(this.getDefaults())),Zr(this.defaults,(r,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(r===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,i)=>{const s=this.getSetting("data",e,r);Ag(i,s??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?Zr(e,(i,s)=>{this.settings[s]=i}):this.settings[e]=r,this}getSetting(e,r,i,s,n){return typeof this.settings[e]=="function"?this.settings[e](r,i,s,n):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};class mN extends k1{constructor(e,r,i,s){super(e,r,i,s,"master")}alignOverlaysWithTrimmingContainer(){const e=c1(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,s=UE(e,"height",r),n=UE(e,"overflow",r),o=this.holder.style,{scrollWidth:l,scrollHeight:h}=e;let d=e.offsetWidth,g=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(n)){const C=e.cloneNode(!1);C.style.overflow="auto",C.style.position="absolute",e.nextElementSibling?i.insertBefore(C,e.nextElementSibling):i.appendChild(C);const x=parseInt(r.getComputedStyle(C).height,10);i.removeChild(C),x===0&&(g=0)}g=Math.min(g,h),o.height=s==="auto"?"auto":`${g}px`,d=Math.min(d,l),o.width=`${d}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:g>0,this.hasTableWidth=d>0}this.isTableVisible=l1(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,i="master",n=e.getSetting("columnHeaders").length;if(n&&!r.hasOversizedColumnHeadersMarked[i]){const l=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let d=0;d<n;d++)for(let g=-1*l;g<h;g++)this.markIfOversizedColumnHeader(g);r.hasOversizedColumnHeadersMarked[i]=!0}}}qn(mN,oN);qn(mN,W_);class zTe{constructor(e,r,i,s,n){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new F2e:new H2e],["fullyVisible",()=>new b2e],["partiallyVisible",()=>new Sq]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new O2e:new N2e],["fullyVisible",()=>new y2e],["partiallyVisible",()=>new Cq]]),this.eventManager=s,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return r===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=es(r)>0&&r.clientHeight>0?r.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let s;if(i===r){const n=this.wtSettings.getSetting("totalColumns");s=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,n)>s&&(s=e.documentElement.clientWidth)}else s=i.clientWidth;return s}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,r){let i=0,s=e;for(;s<r;)i+=this.wtTable.getColumnWidth(s),s+=1;return i}getWorkspaceOffset(){return zs(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=es(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let s=0,n=r.length;s<n;s++)i?(this.rowHeaderWidth+=os(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let s=this.getViewportHeight(),n,o;this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=r.getSetting("fixedRowsTop"),d=r.getSetting("fixedRowsBottom"),g=r.getSetting("totalRows");return h&&l>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,h),l+=o,s-=o),d&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(g-d,g),s-=o),i.holder.clientHeight===i.holder.offsetHeight?n=0:n=co(this.domBindings.rootDocument),new G2e({calculationTypes:e.map(y=>[y,this.rowsCalculatorTypes.get(y)()]),viewportHeight:s,scrollOffset:l,totalRows:r.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:y=>i.getRowHeight(y),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:n})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:i}=this;let s=this.getViewportWidth(),n=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&n>=0){const l=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);n+=l,s-=l}return i.holder.clientWidth!==i.holder.offsetWidth&&(s-=co(this.domBindings.rootDocument)),new j2e({calculationTypes:e.map(l=>[l,this.columnsCalculatorTypes.get(l)()]),viewportWidth:s,scrollOffset:n,totalColumns:r.getSetting("totalColumns"),columnWidthFn:l=>i.getColumnWidth(l),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,i=this.createRowsCalculator(),s=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const n=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(n)}if(e&&!r.getSetting("renderAllColumns")){const n=s.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(n)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=s.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=s.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:s,endRow:n,rowStartOffset:o,rowEndOffset:l}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(o,d)),i=Math.min(h,i+Math.min(l,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(h,i+Math.ceil(l/2))),r<s||r===s&&r>0?!1:!(i>n||i===n&&i<h)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:i}=e;if(r===null&&i===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:s,endColumn:n,columnStartOffset:o,columnEndOffset:l}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(r=Math.max(0,r-Math.min(o,d)),i=Math.min(h,i+Math.min(l,d))):d==="auto"&&(r=Math.max(0,r-Math.ceil(o/2)),i=Math.min(h,i+Math.ceil(l/2))),r<s||r===s&&r>0?!1:!(i>n||i===n&&i<h)}resetHasOversizedColumnHeadersMarked(){Zr(this.hasOversizedColumnHeadersMarked,(e,r,i)=>{i[r]=void 0})}}function GTe(t,e){Nq(t,e),e.add(t)}function d0(t,e,r){Nq(t,e),e.set(t,r)}function Nq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wi(t,e){return t.get(xc(t,e))}function bc(t,e,r){return t.set(xc(t,e),r),r}function xc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const UB=23;var Cu=new WeakMap,Nh=new WeakMap,pN=new WeakMap,nF=new WeakMap,Vf=new WeakMap,Vw=new WeakMap,nC=new WeakMap,_u=new WeakSet;class YTe{constructor(e){GTe(this,_u),d0(this,Cu,void 0),d0(this,Nh,void 0),d0(this,pN,void 0),d0(this,nF,void 0),d0(this,Vf,!0),d0(this,Vw,{}),d0(this,nC,{}),bc(Nh,this,e.rootTable.parentElement.parentElement),bc(nF,this,e.rootDocument)}isClassicTheme(){return wi(Vf,this)}getCSSVariableValue(e){var r;if(wi(Vf,this))return null;if(wi(Vw,this)[`--ht-${e}`])return wi(Vw,this)[`--ht-${e}`];const i=(r=xc(_u,this,JTe).call(this,`--ht-${e}`))!==null&&r!==void 0?r:xc(_u,this,Dq).call(this,`--ht-${e}`);if(i!==null)return wi(Vw,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var r;return(r=wi(nC,this))===null||r===void 0?void 0:r.td[e]}getDefaultRowHeight(){if(wi(Vf,this))return UB;const e=xc(_u,this,KTe).call(this);return!e&&Rr(wi(Nh,this),"ht-wrapper")?(Nn(`The "${wi(Cu,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. Import the correct CSS files in order to use that theme.`),bc(Vf,this,!0),this.useTheme(),UB):e}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){xc(_u,this,zB).call(this),bc(Vf,this,!0),bc(Cu,this,e||void 0);return}e&&e!==wi(Cu,this)&&(wi(Cu,this)&&xc(_u,this,QTe).call(this),bc(Cu,this,e),bc(Vf,this,!1),xc(_u,this,XTe).call(this),xc(_u,this,zB).call(this))}getThemeName(){return wi(Cu,this)}removeClassNames(){Rr(wi(Nh,this),wi(Cu,this))&&_r(wi(Nh,this),wi(Cu,this))}}function KTe(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),r=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(r)?null:t+2*e+r}function XTe(){_r(wi(Nh,this),/ht-theme-.*/g),at(wi(Nh,this),wi(Cu,this))}function zB(){this.isClassicTheme()||bc(pN,this,getComputedStyle(wi(Nh,this)));const t=xc(_u,this,qTe).call(this,["box-sizing","border-bottom-width"]);wi(nC,this).td={...wi(nC,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function qTe(t){const e=wi(nF,this),r=wi(Nh,this),i=e.createElement("table"),s=e.createElement("tbody"),n=e.createElement("tr"),o=e.createElement("tr"),l=e.createElement("td");o.appendChild(l),s.appendChild(n),s.appendChild(o),i.appendChild(s),r.appendChild(i);const h=getComputedStyle(l),d={};return t.forEach(g=>{d[g]=h.getPropertyValue(g)}),r.removeChild(i),d}function JTe(t){const e=Math.ceil(parseFloat(xc(_u,this,Dq).call(this,t)));return Number.isNaN(e)?null:e}function Dq(t){const e=wi(pN,this).getPropertyValue(t);return e===""?null:e}function QTe(){bc(nC,this,{}),bc(Vw,this,{}),bc(Vf,this,!0)}class ZTe extends iN{constructor(e,r){super(e,new UTe(r)),this.stylesHandler=new YTe(this.domBindings);const i=this.wtSettings.getSetting("facade",this);this.wtTable=new mN(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new zTe(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new RTe(this.wtSettings.getSetting("selections")),this.wtEvent=new _q(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new VTe(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],i=[];Zr(e,(s,n)=>{this.wtSettings.getSetting(n).length&&i.push(s),r.push(s)}),_r(this.wtTable.wtRootElement.parentNode,r),at(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var r;if(!Oq.includes(e))return null;const i=e.replace(/_([a-z])/g,s=>s[1].toUpperCase());return(r=this.wtOverlays[`${i}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class vN{constructor(e){e instanceof iN?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const i=new vN(r);return()=>i},this._wot=new ZTe(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,i){return this._wot.createCellRange(e,r,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,i){return this._wot.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wot.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wot.scrollViewportVertically(e,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,i,s,n){return this._wot.wtSettings.getSetting(e,r,i,s,n)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function GB(t){let{isShiftKey:e,isLeftClick:r,isRightClick:i,coords:s,selection:n,controller:o,cellCoordsFactory:l}=t;const h=n.isSelected()?n.getSelectedRange().current():null,d=n.isSelectedByCorner(),g=n.isSelectedByRowHeader();if(n.markSource("mouse"),e&&h)s.row>=0&&s.col>=0&&!o.cell?n.setRangeEnd(s):(d||g)&&s.row>=0&&s.col>=0&&!o.cell?n.setRangeEnd(l(s.row,s.col)):d&&s.row<0&&!o.column?n.setRangeEnd(l(h.to.row,s.col)):g&&s.col<0&&!o.row?n.setRangeEnd(l(s.row,h.to.col)):(!d&&!g&&s.col<0||d&&s.col<0)&&!o.row?n.selectRows(Math.max(h.from.row,0),s.row,s.col):(!d&&!g&&s.row<0||g&&s.row<0)&&!o.column&&n.selectColumns(Math.max(h.from.col,0),s.col,s.row);else{const y=!n.inInSelection(s),C=r||i&&y;s.row<0&&s.col>=0&&!o.column?C&&n.selectColumns(s.col,s.col,s.row):s.col<0&&s.row>=0&&!o.row?C&&n.selectRows(s.row,s.row,s.col):s.col>=0&&s.row>=0&&!o.cell?C&&n.setRangeStart(s):s.col<0&&s.row<0&&n.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}n.markEndSource()}function e_e(t){let{isLeftClick:e,coords:r,selection:i,controller:s,cellCoordsFactory:n}=t;if(!e)return;const o=i.isSelectedByRowHeader(),l=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),l&&!s.column?i.setRangeEnd(n(d-1,r.col)):o&&!s.row?i.setRangeEnd(n(r.row,h-1)):s.cell||i.setRangeEnd(r),i.markEndSource()}const t_e=new Map([["mousedown",GB],["mouseover",e_e],["touchstart",GB]]);function YB(t,e){let{coords:r,selection:i,controller:s,cellCoordsFactory:n}=e;t_e.get(t.type)({coords:r,selection:i,controller:s,cellCoordsFactory:n,isShiftKey:t.shiftKey,isLeftClick:Xk(t)||t.type==="touchstart",isRightClick:Og(t)})}const Lq=new WeakMap,wN=Symbol("rootInstance");function r_e(t){Lq.set(t,!0)}function n_e(t){return t===wN}function B2(t){return Lq.has(t)}function i_e(t,e){Hq(t,e),e.add(t)}function g0(t,e,r){Hq(t,e),e.set(t,r)}function Hq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rf(t,e,r){return(e=s_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s_e(t){var e=o_e(t,"string");return typeof e=="symbol"?e:e+""}function o_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bs(t,e){return t.get(zp(t,e))}function Tl(t,e,r){return t.set(zp(t,e),r),r}function zp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var EO=new WeakMap,Ub=new WeakMap,zb=new WeakMap,fh=new WeakMap,ic=new WeakMap,TO=new WeakMap,_O=new WeakMap,Ww=new WeakSet;class a_e{constructor(e){i_e(this,Ww),Rf(this,"hot",void 0),Rf(this,"eventManager",void 0),Rf(this,"settings",void 0),Rf(this,"THEAD",void 0),Rf(this,"TBODY",void 0),Rf(this,"_wt",void 0),Rf(this,"activeWt",void 0),g0(this,EO,0),g0(this,Ub,0),Rf(this,"postponedAdjustElementsSize",!1),g0(this,zb,!1),g0(this,fh,void 0),g0(this,ic,void 0),g0(this,TO,0),g0(this,_O,0),this.hot=e,this.eventManager=new $c(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!this.hot.forceFullRender),zp(Ww,this,c_e).call(this),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const i=this._wt.getCell(e,r);return i<0?null:i}scrollViewport(e,r,i){return this._wt.scrollViewport(e,r,i)}scrollViewportHorizontally(e,r){return this._wt.scrollViewportHorizontally(e,r)}scrollViewportVertically(e,r){return this._wt.scrollViewportVertically(e,r)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),at(e,"handsontable"),Tl(ic,this,r.createElement("TABLE")),at(Bs(ic,this),"htCore"),this.hot.getSettings().tableClassName&&at(Bs(ic,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Or(Bs(ic,this),[Hu()]),Or(e,[QCe(),LX(-1),N_(this.hot.countCols()),fSe()])),this.THEAD=r.createElement("THEAD"),Bs(ic,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Bs(ic,this).appendChild(this.TBODY),this.hot.table=Bs(ic,this),this.hot.container.insertBefore(Bs(ic,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:i,rootWindow:s}=this.hot,n=r.documentElement;this.eventManager.addEventListener(e,"mousedown",l=>{Tl(zb,this,!0),this.isTextSelectionAllowed(l.target)||(q9(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Tl(zb,this,!1)}),this.eventManager.addEventListener(e,"mousemove",l=>{Bs(zb,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&q9(s),l.preventDefault())}),this.eventManager.addEventListener(n,"keyup",l=>{i.isInProgress()&&!l.shiftKey&&i.finish()}),this.eventManager.addEventListener(n,"mouseup",l=>{i.isInProgress()&&Xk(l)&&i.finish(),Tl(fh,this,!1);const h=YX(r.activeElement);$2(r.activeElement)&&!h||(h||!i.isSelected()&&!i.isSelectedByAnyHeader()&&!e.contains(l.target)&&!Og(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(n,"contextmenu",l=>{i.isInProgress()&&Og(l)&&(i.finish(),Tl(fh,this,!1))}),this.eventManager.addEventListener(n,"touchend",()=>{i.isInProgress()&&i.finish(),Tl(fh,this,!1)}),this.eventManager.addEventListener(n,"mousedown",l=>{const h=l.target,d=l.x||l.clientX,g=l.y||l.clientY;let y=l.target;if(Bs(fh,this)||!e||!this.hot.view)return;const{holder:C}=this._wt.wtTable;if(y===C){const _=co(r);if(r.elementFromPoint(d+_,g)!==C||r.elementFromPoint(d,g+_)!==C)return}else for(;y!==n;){if(y===null){if(l.isTargetWebComponent)break;return}if(y===e)return;y=y.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(h):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=a1(s);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=a1(o);this.eventManager.addEventListener(Bs(ic,this),"selectstart",l=>{this.settings.fragmentSelection||$2(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,i))}translateFromRenderableToVisualIndex(e,r){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,s=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return i===null&&(i=e),s===null&&(s=r),[i,s]}countRenderableIndexes(e,r){const i=Math.min(e.getNotTrimmedIndexesLength(),r),s=e.getNearestNotHiddenIndex(i-1,-1);return s===null?0:e.getRenderableFromVisualIndex(s)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,i,s){if(isNaN(e)||e<0)return 0;const n=i.getNearestNotHiddenIndex(e,r),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let l=0;return r<0?l=o+1:r>0&&(l=s-o),l}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let i=0;for(let s=e;s<=r;s++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(s)!==null&&(i+=1);return i}countRenderableRowsInRange(e,r){let i=0;for(let s=e;s<=r;s++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(s)!==null&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&at(i,e)}removeClassNameFromLicenseElement(e){var r;const i=(r=this.hot.rootElement.parentNode)===null||r===void 0?void 0:r.querySelector(".hot-display-license-info");i&&_r(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Bs(ic,this),isDataViewInstance:()=>B2(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(n,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(n,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const n=[];return this.hot.hasRowHeaders()&&n.push((o,l)=>{const h=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(h,l)}),this.hot.runHooks("afterGetRowHeaderRenderers",n),Tl(Ub,this,n.length),this.hot.getSettings().ariaTags&&zp(Ww,this,$q).call(this)===this.hot.countCols()&&zp(Ww,this,l_e).call(this,Bs(Ub,this)),n},columnHeaders:()=>{const n=[];return this.hot.hasColHeaders()&&n.push((o,l)=>{const h=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(h,l)}),this.hot.runHooks("afterGetColumnHeaderRenderers",n),Tl(EO,this,n.length),n},columnWidth:n=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n);return this.hot.getColWidth(o===null?n:o)},rowHeight:n=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(n);return this.hot.getRowHeight(o===null?n:o)},rowHeightByOverlayName:(n,o)=>{const l=this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),h=l===null?n:l;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,o)},cellRenderer:(n,o,l)=>{const[h,d]=this.translateFromRenderableToVisualIndex(n,o),g=this.hot.runHooks("modifyGetCellCoords",h,d,!1,"meta");let y=h,C=d;Array.isArray(g)&&([y,C]=g);const x=this.hot.getCellMeta(y,C),_=this.hot.colToProp(C);let E=this.hot.getDataAtRowProp(y,_);this.hot.hasHook("beforeValueRender")&&(E=this.hot.runHooks("beforeValueRender",E,x)),this.hot.runHooks("beforeRenderer",l,h,d,_,E,x),this.hot.getCellRenderer(x)(this.hot,l,h,d,_,E,x),this.hot.runHooks("afterRenderer",l,h,d,_,E,x)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&l1(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,Tl(fh,this,!0),this.hot.runHooks("beforeOnCellMouseDown",n,d,l,g),!Q0(n)&&(YB(n,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(y,C)=>this.hot._createCellCoords(y,C)}),this.hot.runHooks("afterOnCellMouseDown",n,d,l),this.activeWt=this._wt)},onCellContextMenu:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,Tl(fh,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",n,d,l),!Q0(n)&&(this.hot.runHooks("afterOnCellContextMenu",n,d,l),this.activeWt=this._wt)},onCellMouseOut:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",n,d,l),!Q0(n)&&(this.hot.runHooks("afterOnCellMouseOut",n,d,l),this.activeWt=this._wt)},onCellMouseOver:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o),g={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",n,d,l,g),!Q0(n)&&(Bs(fh,this)&&YB(n,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(y,C)=>this.hot._createCellCoords(y,C)}),this.hot.runHooks("afterOnCellMouseOver",n,d,l),this.activeWt=this._wt)},onCellMouseUp:(n,o,l,h)=>{const d=this.translateFromRenderableToVisualCoords(o);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",n,d,l),!(Q0(n)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",n,d,l),this.activeWt=this._wt)},onCellCornerMouseDown:n=>{n.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",n)},onCellCornerDblClick:n=>{n.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",n)},beforeDraw:(n,o)=>this.beforeRender(n,o),onDraw:n=>this.afterRender(n),onBeforeViewportScrollVertically:(n,o)=>{const l=this.hot.rowIndexMapper,h=n<0;let d=n;return!h&&(d=l.getVisualFromRenderableIndex(n),d===null)?n:(d=this.hot.runHooks("beforeViewportScrollVertically",d,o),this.hot.runHooks("beforeViewportScroll"),h?d:l.getRenderableFromVisualIndex(d))},onBeforeViewportScrollHorizontally:(n,o)=>{const l=this.hot.columnIndexMapper,h=n<0;let d=n;return!h&&(d=l.getVisualFromRenderableIndex(n),d===null)?n:(d=this.hot.runHooks("beforeViewportScrollHorizontally",d,o),this.hot.runHooks("beforeViewportScroll"),h?d:l.getRenderableFromVisualIndex(d))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(n,o,l)=>{const h=this.hot.rowIndexMapper,d=n<0;let g=n;d||(g=h.getVisualFromRenderableIndex(n));const y=this.hot.runHooks("beforeHighlightingRowHeader",g,o,l);return d?y:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1))},onBeforeHighlightingColumnHeader:(n,o,l)=>{const h=this.hot.columnIndexMapper,d=n<0;let g=n;d||(g=h.getVisualFromRenderableIndex(n));const y=this.hot.runHooks("beforeHighlightingColumnHeader",g,o,l);return d?y:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1))},onAfterDrawSelection:(n,o,l)=>{let h;const[d,g]=this.translateFromRenderableToVisualIndex(n,o),y=this.hot.selection.getSelectedRange();if(y.size()>0){const x=y.peekByIndex(l??0);h=[x.from.row,x.from.col,x.to.row,x.to.col]}return this.hot.runHooks("afterDrawSelection",d,g,h,l)},onBeforeDrawBorders:(n,o)=>{const[l,h,d,g]=n,y=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(l),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",y,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:n=>this.hot.runHooks("modifyRowHeaderWidth",n),onModifyGetCellCoords:(n,o,l,h)=>{const d=this.hot.rowIndexMapper,g=this.hot.columnIndexMapper,y=o>=0?g.getVisualFromRenderableIndex(o):o,C=n>=0?d.getVisualFromRenderableIndex(n):n,x=this.hot.runHooks("modifyGetCellCoords",C,y,l,h);if(Array.isArray(x)){const[_,E,R,I]=x;return[_>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(_,1)):_,E>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(E,1)):E,R>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(R,-1)):R,I>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(I,-1)):I]}},onModifyGetCoordsElement:(n,o)=>{const l=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=o>=0?h.getVisualFromRenderableIndex(o):o,g=n>=0?l.getVisualFromRenderableIndex(n):n,y=this.hot.runHooks("modifyGetCoordsElement",g,d);if(Array.isArray(y)){const[C,x]=y;return[C>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(C,1)):C,x>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(x,1)):x]}},viewportRowCalculatorOverride:n=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const l=this.countRenderableRows(),h=n.startRow,d=n.endRow;if(typeof o=="number")n.startRow=Math.max(h-o,0),n.endRow=Math.min(d+o,l-1);else if(o==="auto"){const g=Math.max(1,Math.ceil(d/l*12));n.startRow=Math.max(h-g,0),n.endRow=Math.min(d+g,l-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",n)},viewportColumnCalculatorOverride:n=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const l=this.countRenderableColumns(),h=n.startColumn,d=n.endColumn;if(typeof o=="number"&&(n.startColumn=Math.max(h-o,0),n.endColumn=Math.min(d+o,l-1)),o==="auto"){const g=Math.max(1,Math.ceil(d/l*6));n.startColumn=Math.max(h-g,0),n.endColumn=Math.min(d+g,l-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",n)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const n=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||n}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new vN(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:i,height:s}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,s),this.eventManager.addEventListener(r,"mousedown",n=>{n.target===r&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",n=>{n.target===r&&n.which===3&&n.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if($2(e))return!0;const r=vg(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Bs(fh,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const i=r.firstChild;if(!Rr(i,"relative")){Uu(r),this.appendRowHeader(e,r);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:s}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,s),n.appendChild(o),r.appendChild(n)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const n=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Rr(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,s),o.className="",at(o,["relative",...n()])):(Uu(r),this.appendColHeader(e,r,i,s))}else{const{rootDocument:o}=this.hot,l=o.createElement("div"),h=o.createElement("span"),d=n();l.classList.add("relative",...d),h.className="colHeader",this.settings.ariaTags&&(Or(l,...Hu()),Or(h,...Hu())),this.updateCellHeader(h,e,i,s),l.appendChild(h),r.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,r,s)}updateCellHeader(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,n=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Rr(e,"colHeader")?n=o.wtTable.columnFilter.sourceToRendered(r):Rr(e,"rowHeader")&&(n=o.wtTable.rowFilter.sourceToRendered(r))),n>-1?M1(e,i(r,s)):(Ag(e,""),at(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,r){Tl(TO,this,e),Tl(_O,this,r)}getLastSize(){return{width:Bs(TO,this),height:Bs(_O,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(r??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(r??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,r=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(r??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Bs(EO,this)}getRowHeadersCount(){return Bs(Ub,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function $q(){return parseInt(this.hot.rootElement.getAttribute(N_()[0]),10)}function l_e(t){const e=zp(Ww,this,$q).call(this)+t;Or(this.hot.rootElement,...N_(e))}function c_e(){const t=this.hot.rootElement;this.hasVerticalScroll()?at(t,"htHasScrollY"):_r(t,"htHasScrollY"),this.hasHorizontalScroll()?at(t,"htHasScrollX"):_r(t,"htHasScrollX")}var u_e=si,h_e=R1,f_e=La,d_e=xs,g_e=Xu;u_e({target:"Iterator",proto:!0,real:!0},{every:function(e){d_e(this),f_e(e);var r=g_e(this),i=0;return!h_e(r,function(s,n){if(!e(s,i++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});const m_e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",KB=m_e.length;function p_e(t){let e=t+1,r="",i;for(;e>0;)i=(e-1)%KB,r=String.fromCharCode(65+i)+r,e=parseInt((e-i)/KB,10);return r}function Bq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((s,n)=>{Array.isArray(s)?s.forEach((o,l)=>{i.push([n+e,l,o])}):Object.keys(s).forEach(o=>{i.push([n+e,o,s[o]])})}),i}function Vq(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Qr(t[0])&&(e=Kk(t[0]))),e}function v_e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function w_e(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Kv(t,e,r){return(e=y_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y_e(t){var e=C_e(t,"string");return typeof e=="symbol"?e:e+""}function C_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S_e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Kv(this,"hot",void 0),Kv(this,"data",void 0),Kv(this,"dataType","array"),Kv(this,"colToProp",()=>{}),Kv(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return xe(this.data,(i,s)=>{const n=this.getAtCell(s,e);r.push(n)}),r}getAtRow(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const n=r===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let l=null,h=null;if(l=this.modifyRowData(e),Array.isArray(l))h=[],n?l.forEach((d,g)=>{h[g]=this.getAtPhysicalCell(e,g,l)}):pr(r,i,d=>{h[d-r]=this.getAtPhysicalCell(e,d,l)});else if(Qr(l)||ci(l))if(s?h=[]:h={},!n||s){const g=this.countFirstRowKeys()-1;pr(0,g,y=>{const C=this.colToProp(y);if(y>=(r||0)&&y<=(i||g)&&!Number.isInteger(C)){const x=this.getAtPhysicalCell(e,C,l);s?h.push(x):o?nO(h,C,x):h[C]=x}})}else Zr(l,(d,g)=>{const y=this.getAtPhysicalCell(e,g,l);o?nO(h,g,y):h[g]=y});return h}setAtCell(e,r,i){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const s=il(i);this.hot.runHooks("modifySourceData",e,r,s,"set"),s.isTouched()&&(i=s.value)}Number.isInteger(r)?this.data[e][r]=i:nO(this.data[e],r,i)}}getAtPhysicalCell(e,r,i){let s=null;if(i)if(typeof r=="string"){const{dataDotNotation:n}=this.hot.getSettings();s=n?JSe(i,r):i[r]}else typeof r=="function"?s=r(i):s=i[r];if(this.hot.hasHook("modifySourceData")){const n=il(s);this.hot.runHooks("modifySourceData",e,r,n,"get"),n.isTouched()&&(s=n.value)}return s}getAtCell(e,r){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=!1,n=null,o=null,l=null,h=null;e===null||r===null?(s=!0,n=0,l=this.countRows()-1):(n=Math.min(e.row,r.row),o=Math.min(e.col,r.col),l=Math.max(e.row,r.row),h=Math.max(e.col,r.col));const d=[];return pr(n,l,g=>{d.push(s?this.getAtRow(g,void 0,void 0,i):this.getAtRow(g,o,h,i))}),d}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Vq(this.data)}destroy(){this.data=null,this.hot=null}}var b_e=si,x_e=R1,E_e=La,T_e=xs,__e=Xu;b_e({target:"Iterator",proto:!0,real:!0},{some:function(e){T_e(this),E_e(e);var r=__e(this),i=0;return x_e(r,function(s,n){if(e(s,i++))return n()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}});function XB(t,e,r){return(e=R_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function R_e(t){var e=A_e(t,"string");return typeof e=="symbol"?e:e+""}function A_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qg{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;XB(this,"indexedValues",[]),XB(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ci(this.initValueOrFn)?pr(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):pr(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}qn(qg,mo);function yN(t,e,r,i){const s=r.length?r[0]:void 0;return[...t.slice(0,s),...r.map((n,o)=>ci(i)?i(n,o):i),...s===void 0?[]:t.slice(s)]}function CN(t,e){return Ad(t,(r,i)=>e.includes(i)===!1)}class $d extends qg{insert(e,r){this.indexedValues=yN(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=CN(this.indexedValues,e),super.remove(e)}}class j_ extends $d{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ha(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}function SN(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function iC(t,e){return Ad(t,r=>e.includes(r)===!1)}function bN(t,e){return on(t,r=>r-e.filter(i=>i<r).length)}function xN(t,e){const r=e[0],i=e.length;return on(t,s=>s>=r?s+i:s)}function O_e(t,e,r){return(e=I_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I_e(t){var e=P_e(t,"string");return typeof e=="symbol"?e:e+""}function P_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class U_ extends qg{constructor(){super(...arguments),O_e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=iC(this.orderOfIndexes,[e]),ci(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=yN(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=xN(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=CN(this.indexedValues,e),this.orderOfIndexes=iC(this.orderOfIndexes,e),this.orderOfIndexes=bN(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class eS extends $d{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ha(this.getValues(),(e,r,i)=>(r&&e.push(i),e),[])}}const qB=new Map([["indexesSequence",{getListWithInsertedItems:SN,getListWithRemovedItems:iC}],["physicallyIndexed",{getListWithInsertedItems:yN,getListWithRemovedItems:CN}]]),Wq=t=>{if(qB.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return qB.get(t)};class jq extends qg{constructor(){super(e=>e)}insert(e,r){const i=xN(this.indexedValues,r);this.indexedValues=SN(i,e,r),super.insert(e,r)}remove(e){const r=iC(this.indexedValues,e);this.indexedValues=bN(r,e),super.remove(e)}}const JB=new Map([["hiding",j_],["index",qg],["linkedPhysicalIndexToValue",U_],["physicalIndexToValue",$d],["trimming",eS]]);function F_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!JB.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(JB.get(t))(e)}function M_e(t,e,r){return(e=k_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k_e(t){var e=N_e(t,"string");return typeof e=="symbol"?e:e+""}function N_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EN{constructor(){M_e(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)))}unregister(e){const r=this.collection.get(e);rr(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r))}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return Ai(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(i=>{i.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}qn(EN,mo);function RO(t,e,r){return(e=D_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D_e(t){var e=L_e(t,"string");return typeof e=="symbol"?e:e+""}function L_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QB extends EN{constructor(e,r){super(),RO(this,"mergedValuesCache",[]),RO(this,"aggregationFunction",void 0),RO(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=on(this.get(),n=>n.getValues()),i=[],s=rr(r[0])&&r[0].length||0;for(let n=0;n<s;n+=1){const o=[];for(let l=0;l<this.getLength();l+=1)o.push(r[l][n]);i.push(o)}return on(i,this.aggregationFunction)}getMergedValueAtIndex(e,r){const i=this.getMergedValues(r)[e];return rr(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function H_e(t,e,r){$_e(t,e),e.set(t,r)}function $_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function B_e(t,e,r){return t.set(Uq(t,e),r),r}function V_e(t,e){return t.get(Uq(t,e))}function Uq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var AO=new WeakMap;class zq{constructor(){H_e(this,AO,[])}subscribe(e){return this.addLocalHook("change",e),this._write(V_e(AO,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){B_e(AO,this,e)}}qn(zq,mo);function ZB(t,e){const r=[];let i=0,s=0;for(;i<t.length&&s<e.length;i++,s++)t[i]!==e[s]&&r.push({op:"replace",index:s,oldValue:t[i],newValue:e[s]});for(;i<e.length;i++)r.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;s<t.length;s++)r.push({op:"remove",index:s,oldValue:t[s],newValue:void 0});return r}function Xv(t,e,r){W_e(t,e),e.set(t,r)}function W_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _l(t,e){return t.get(Gq(t,e))}function Gb(t,e,r){return t.set(Gq(t,e),r),r}function Gq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yb=new WeakMap,qv=new WeakMap,Kb=new WeakMap,Xb=new WeakMap,qb=new WeakMap;class j_e{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xv(this,Yb,new Set),Xv(this,qv,[]),Xv(this,Kb,[]),Xv(this,Xb,!1),Xv(this,qb,!1),Gb(qb,this,e??!1)}createObserver(){const e=new zq;return _l(Yb,this).add(e),e.addLocalHook("unsubscribe",()=>{_l(Yb,this).delete(e)}),e._writeInitialChanges(ZB(_l(qv,this),_l(Kb,this))),e}emit(e){let r=_l(Kb,this);(!_l(Xb,this)||_l(qv,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(_l(qb,this)):Gb(qv,this,new Array(e.length).fill(_l(qb,this))),_l(Xb,this)||(Gb(Xb,this,!0),r=_l(qv,this)));const i=ZB(r,e);_l(Yb,this).forEach(s=>s._write(i)),Gb(Kb,this,e)}}function Go(t,e,r){return(e=U_e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U_e(t){var e=z_e(t,"string");return typeof e=="symbol"?e:e+""}function z_e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class iF{constructor(){Go(this,"indexesSequence",new jq),Go(this,"trimmingMapsCollection",new QB(e=>e.some(r=>r===!0),!1)),Go(this,"hidingMapsCollection",new QB(e=>e.some(r=>r===!0),!1)),Go(this,"variousMapsCollection",new EN),Go(this,"hidingChangesObservable",new j_e({initialIndexValue:!1})),Go(this,"notTrimmedIndexesCache",[]),Go(this,"notHiddenIndexesCache",[]),Go(this,"isBatched",!1),Go(this,"indexesSequenceChanged",!1),Go(this,"indexesChangeSource",void 0),Go(this,"trimmedIndexesChanged",!1),Go(this,"hiddenIndexesChanged",!1),Go(this,"renderablePhysicalIndexesCache",[]),Go(this,"fromPhysicalToVisualIndexesCache",new Map),Go(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,i){return this.registerMap(e,F_e(r,i))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof eS?this.trimmingMapsCollection.register(e,r):r instanceof j_?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const i=this.getNumberOfIndexes();return i>0&&r.init(i),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return rr(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return rr(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return rr(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return rr(r)?r:null}getNearestNotHiddenIndex(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=n.findIndex(l=>l>e):o=n.reverse().findIndex(l=>l<e),o===-1?i?this.getNearestNotHiddenIndex(e,-r,!1):null:n[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(s=>s+e);this.removeIndexes(i)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const i=on(e,d=>this.getPhysicalFromVisualIndex(d)),s=this.getNotTrimmedIndexesLength(),n=e.length,o=iC(this.getIndexesSequence(),i),l=o.filter(d=>this.isTrimmed(d)===!1);let h=o.indexOf(l[l.length-1])+1;if(r+n<s){const d=l[r];h=o.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(SN(o,h,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const i=this.getNotTrimmedIndexes()[e],s=rr(i)?i:this.getNumberOfIndexes(),n=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),o=on(new Array(r).fill(s),(l,h)=>l+h);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(n,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(n,o),this.hidingMapsCollection.insertToEvery(n,o),this.variousMapsCollection.insertToEvery(n,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(i,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const i=this.getPhysicalFromRenderableIndex(r),s=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(s,r)}}}qn(iF,mo);function G_e(t,e){return Zr(e,(r,i)=>{Ai(t[i])&&(t[i]=r)}),t}function Yq(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function Kq(t){rr(t)&&qk(Ln`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Y_e(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:K_e,getValues:X_e}=Uc("phraseFormatters");function q_e(t,e){K_e(t,e)}function J_e(){return X_e()}q_e("pluralize",Y_e);const Xq="ContextMenu:items",$r=Xq,TN=`${$r}.noItems`,_N=`${$r}.insertRowAbove`,RN=`${$r}.insertRowBelow`,AN=`${$r}.insertColumnOnTheLeft`,ON=`${$r}.insertColumnOnTheRight`,IN=`${$r}.removeRow`,PN=`${$r}.removeColumn`,FN=`${$r}.undo`,MN=`${$r}.redo`,JE=`${$r}.readOnly`,kN=`${$r}.clearColumn`,NN=`${$r}.copy`,DN=`${$r}.copyWithHeaders`,LN=`${$r}.copyWithGroupHeaders`,HN=`${$r}.copyHeadersOnly`,$N=`${$r}.cut`,BN=`${$r}.freezeColumn`,VN=`${$r}.unfreezeColumn`,WN=`${$r}.mergeCells`,jN=`${$r}.unmergeCells`,UN=`${$r}.addComment`,zN=`${$r}.editComment`,GN=`${$r}.removeComment`,YN=`${$r}.readOnlyComment`,KN=`${$r}.align`,XN=`${$r}.align.left`,qN=`${$r}.align.center`,JN=`${$r}.align.right`,QN=`${$r}.align.justify`,ZN=`${$r}.align.top`,eD=`${$r}.align.middle`,tD=`${$r}.align.bottom`,rD=`${$r}.borders`,nD=`${$r}.borders.top`,iD=`${$r}.borders.right`,sD=`${$r}.borders.bottom`,oD=`${$r}.borders.left`,aD=`${$r}.borders.remove`,lD=`${$r}.nestedHeaders.insertChildRow`,cD=`${$r}.nestedHeaders.detachFromParent`,uD=`${$r}.hideColumn`,hD=`${$r}.showColumn`,fD=`${$r}.hideRow`,dD=`${$r}.showRow`,fa="Filters:",Wi=`${fa}conditions`,z_=`${Wi}.none`,gD=`${Wi}.isEmpty`,mD=`${Wi}.isNotEmpty`,pD=`${Wi}.isEqualTo`,vD=`${Wi}.isNotEqualTo`,wD=`${Wi}.beginsWith`,yD=`${Wi}.endsWith`,CD=`${Wi}.contains`,SD=`${Wi}.doesNotContain`,Q_e=`${Wi}.byValue`,bD=`${Wi}.greaterThan`,xD=`${Wi}.greaterThanOrEqualTo`,ED=`${Wi}.lessThan`,TD=`${Wi}.lessThanOrEqualTo`,_D=`${Wi}.isBetween`,RD=`${Wi}.isNotBetween`,AD=`${Wi}.after`,OD=`${Wi}.before`,ID=`${Wi}.today`,PD=`${Wi}.tomorrow`,FD=`${Wi}.yesterday`,MD=`${fa}labels.filterByCondition`,kD=`${fa}labels.filterByValue`,ND=`${fa}labels.conjunction`,G_=`${fa}labels.disjunction`,QE=`${fa}values.blankCells`,DD=`${fa}buttons.selectAll`,LD=`${fa}buttons.clear`,HD=`${fa}buttons.ok`,$D=`${fa}buttons.cancel`,BD=`${fa}buttons.placeholder.search`,VD=`${fa}buttons.placeholder.value`,WD=`${fa}buttons.placeholder.secondValue`,jD="CheckboxRenderer:",UD=`${jD}checked`,zD=`${jD}unchecked`,Z_e=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:UD,CHECKBOX_RENDERER_NAMESPACE:jD,CHECKBOX_UNCHECKED:zD,CONTEXTMENU_ITEMS_ADD_COMMENT:UN,CONTEXTMENU_ITEMS_ALIGNMENT:KN,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:tD,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:qN,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:QN,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:XN,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:eD,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:JN,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ZN,CONTEXTMENU_ITEMS_BORDERS:rD,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:sD,CONTEXTMENU_ITEMS_BORDERS_LEFT:oD,CONTEXTMENU_ITEMS_BORDERS_RIGHT:iD,CONTEXTMENU_ITEMS_BORDERS_TOP:nD,CONTEXTMENU_ITEMS_CLEAR_COLUMN:kN,CONTEXTMENU_ITEMS_COPY:NN,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:HN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:LN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:DN,CONTEXTMENU_ITEMS_CUT:$N,CONTEXTMENU_ITEMS_EDIT_COMMENT:zN,CONTEXTMENU_ITEMS_FREEZE_COLUMN:BN,CONTEXTMENU_ITEMS_HIDE_COLUMN:uD,CONTEXTMENU_ITEMS_HIDE_ROW:fD,CONTEXTMENU_ITEMS_INSERT_LEFT:AN,CONTEXTMENU_ITEMS_INSERT_RIGHT:ON,CONTEXTMENU_ITEMS_MERGE_CELLS:WN,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:cD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:lD,CONTEXTMENU_ITEMS_NO_ITEMS:TN,CONTEXTMENU_ITEMS_READ_ONLY:JE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:YN,CONTEXTMENU_ITEMS_REDO:MN,CONTEXTMENU_ITEMS_REMOVE_BORDERS:aD,CONTEXTMENU_ITEMS_REMOVE_COLUMN:PN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:GN,CONTEXTMENU_ITEMS_REMOVE_ROW:IN,CONTEXTMENU_ITEMS_ROW_ABOVE:_N,CONTEXTMENU_ITEMS_ROW_BELOW:RN,CONTEXTMENU_ITEMS_SHOW_COLUMN:hD,CONTEXTMENU_ITEMS_SHOW_ROW:dD,CONTEXTMENU_ITEMS_UNDO:FN,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:VN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:jN,CONTEXT_MENU_ITEMS_NAMESPACE:Xq,FILTERS_BUTTONS_CANCEL:$D,FILTERS_BUTTONS_CLEAR:LD,FILTERS_BUTTONS_OK:HD,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:BD,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:WD,FILTERS_BUTTONS_PLACEHOLDER_VALUE:VD,FILTERS_BUTTONS_SELECT_ALL:DD,FILTERS_CONDITIONS_AFTER:AD,FILTERS_CONDITIONS_BEFORE:OD,FILTERS_CONDITIONS_BEGINS_WITH:wD,FILTERS_CONDITIONS_BETWEEN:_D,FILTERS_CONDITIONS_BY_VALUE:Q_e,FILTERS_CONDITIONS_CONTAINS:CD,FILTERS_CONDITIONS_EMPTY:gD,FILTERS_CONDITIONS_ENDS_WITH:yD,FILTERS_CONDITIONS_EQUAL:pD,FILTERS_CONDITIONS_GREATER_THAN:bD,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:xD,FILTERS_CONDITIONS_LESS_THAN:ED,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:TD,FILTERS_CONDITIONS_NAMESPACE:Wi,FILTERS_CONDITIONS_NONE:z_,FILTERS_CONDITIONS_NOT_BETWEEN:RD,FILTERS_CONDITIONS_NOT_CONTAIN:SD,FILTERS_CONDITIONS_NOT_EMPTY:mD,FILTERS_CONDITIONS_NOT_EQUAL:vD,FILTERS_CONDITIONS_TODAY:ID,FILTERS_CONDITIONS_TOMORROW:PD,FILTERS_CONDITIONS_YESTERDAY:FD,FILTERS_DIVS_FILTER_BY_CONDITION:MD,FILTERS_DIVS_FILTER_BY_VALUE:kD,FILTERS_LABELS_CONJUNCTION:ND,FILTERS_LABELS_DISJUNCTION:G_,FILTERS_NAMESPACE:fa,FILTERS_VALUES_BLANK_CELLS:QE},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const qq={languageCode:"en-US",[TN]:"No available options",[_N]:"Insert row above",[RN]:"Insert row below",[AN]:"Insert column left",[ON]:"Insert column right",[IN]:["Remove row","Remove rows"],[PN]:["Remove column","Remove columns"],[FN]:"Undo",[MN]:"Redo",[JE]:"Read only",[kN]:"Clear column",[KN]:"Alignment",[XN]:"Left",[qN]:"Center",[JN]:"Right",[QN]:"Justify",[ZN]:"Top",[eD]:"Middle",[tD]:"Bottom",[BN]:"Freeze column",[VN]:"Unfreeze column",[rD]:"Borders",[nD]:"Top",[iD]:"Right",[sD]:"Bottom",[oD]:"Left",[aD]:"Remove border(s)",[UN]:"Add comment",[zN]:"Edit comment",[GN]:"Delete comment",[YN]:"Read-only comment",[WN]:"Merge cells",[jN]:"Unmerge cells",[NN]:"Copy",[DN]:["Copy with header","Copy with headers"],[LN]:["Copy with group header","Copy with group headers"],[HN]:["Copy header only","Copy headers only"],[$N]:"Cut",[lD]:"Insert child row",[cD]:"Detach from parent",[uD]:["Hide column","Hide columns"],[hD]:["Show column","Show columns"],[fD]:["Hide row","Hide rows"],[dD]:["Show row","Show rows"],[z_]:"None",[gD]:"Is empty",[mD]:"Is not empty",[pD]:"Is equal to",[vD]:"Is not equal to",[wD]:"Begins with",[yD]:"Ends with",[CD]:"Contains",[SD]:"Does not contain",[bD]:"Greater than",[xD]:"Greater than or equal to",[ED]:"Less than",[TD]:"Less than or equal to",[_D]:"Is between",[RD]:"Is not between",[AD]:"After",[OD]:"Before",[ID]:"Today",[PD]:"Tomorrow",[FD]:"Yesterday",[QE]:"Blank cells",[MD]:"Filter by condition",[kD]:"Filter by value",[ND]:"And",[G_]:"Or",[DD]:"Select all",[LD]:"Clear",[HD]:"OK",[$D]:"Cancel",[BD]:"Search",[VD]:"Value",[WD]:"Second value",[UD]:"Checked",[zD]:"Unchecked"},eRe=Z_e,sF=qq.languageCode,{register:tRe,getItem:Jq,hasItem:rRe,getValues:nRe}=Uc("languagesDictionaries");Qq(qq);function Qq(t,e){let r=t,i=e;return Qr(t)&&(i=t,r=i.languageCode),iRe(r,i),tRe(r,la(i)),la(i)}function iRe(t,e){t!==sF&&G_e(e,Jq(sF))}function Zq(t){return GD(t)?la(Jq(t)):null}function GD(t){return rRe(t)}function sRe(){return nRe()}function eJ(t,e,r){const i=Zq(t);if(i===null)return null;const s=i[e];if(Ai(s))return null;const n=oRe(s,r);return Array.isArray(n)?n[0]:n}function oRe(t,e){let r=t;return xe(J_e(),i=>{r=i(t,e)}),r}function aRe(t){let e=Yq(t);return GD(e)||(e=sF,Kq(t)),e}function lRe(t,e,r){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class df extends Iq{constructor(e,r){super(e,null),lRe(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:i}=e,s=this.getNearestNotHiddenCoords(r,1),n=this.getNearestNotHiddenCoords(i,-1);return s===null||n===null?null:((s.row>n.row||s.col>n.col)&&(s=r,n=i),this.settings.createCellRange(s,s,n))}getNearestNotHiddenCoords(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const s=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(s===null)return null;const n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return n===null?null:this.settings.createCellCoords(s,n)}getNearestNotHiddenIndex(e,r,i){return r<0?r:e.getNearestNotHiddenIndex(r,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,s=e.getHorizontalDirection()==="W-E"?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((n===null||n.col===null||n.row===null)&&(o=this.getNearestNotHiddenCoords(r,i,s)),o!==null&&e.overlaps(o)){const l=e.highlight.clone();if(l.row>=0&&(l.row=o.row),l.col>=0&&(l.col=o.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(l);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(l)}return this.settings.selectionType==="focus"&&n!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const i=this.settings.visualToRenderableCoords(e),s=this.settings.visualToRenderableCoords(r);return i.row===null||i.col===null||s.row===null||s.col===null?null:this.settings.createCellRange(i,i,s)}}function OO(t){let{activeHeaderClassName:e,...r}=t;return new df({className:e,...r,selectionType:Pq})}function hRe(t){let{areaCornerVisible:e,...r}=t;return new df({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:cN})}function fRe(t){let{...e}=t;return new df({className:"highlight",...e,selectionType:cN})}function dRe(t){let{columnClassName:e,...r}=t;return new df({className:e,...r,selectionType:CTe})}function gRe(t){let{cellCornerVisible:e,...r}=t;return new df({className:"current",headerAttributes:[Wk()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:qE})}function mRe(t){let{border:e,visualCellRange:r,...i}=t;return new df({...e,...i,selectionType:STe},r)}function pRe(t){let{...e}=t;return new df({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:wTe})}function eV(t){let{headerClassName:e,...r}=t;return new df({className:e,...r,selectionType:lN})}function vRe(t){let{rowClassName:e,...r}=t;return new df({className:e,...r,selectionType:yTe})}function wRe(t,e){yRe(t,e),e.add(t)}function yRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function va(t,e,r){return(e=CRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CRe(t){var e=SRe(t,"string");return typeof e=="symbol"?e:e+""}function SRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var su=new WeakSet;class bRe{constructor(e){wRe(this,su),va(this,"options",void 0),va(this,"layerLevel",0),va(this,"focus",void 0),va(this,"fill",void 0),va(this,"layeredAreas",new Map),va(this,"areas",new Map),va(this,"rowHeaders",new Map),va(this,"columnHeaders",new Map),va(this,"activeRowHeaders",new Map),va(this,"activeColumnHeaders",new Map),va(this,"activeCornerHeaders",new Map),va(this,"rowHighlights",new Map),va(this,"columnHighlights",new Map),va(this,"customSelections",[]),this.options=e,this.focus=gRe(e),this.fill=pRe(e)}isEnabledFor(e,r){let i=e;e===qE&&(i="current");let s=this.options.disabledCellSelection(r.row,r.col);return typeof s=="string"&&(s=[s]),s===!1||Array.isArray(s)&&!s.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return dh(su,this,gh).call(this,this.layeredAreas,hRe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return dh(su,this,gh).call(this,this.areas,fRe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return dh(su,this,gh).call(this,this.rowHeaders,eV)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return dh(su,this,gh).call(this,this.columnHeaders,eV)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return dh(su,this,gh).call(this,this.activeRowHeaders,OO)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return dh(su,this,gh).call(this,this.activeColumnHeaders,OO)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return dh(su,this,gh).call(this,this.activeCornerHeaders,OO)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return dh(su,this,gh).call(this,this.rowHighlights,vRe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return dh(su,this,gh).call(this,this.columnHighlights,dRe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(mRe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),xe(this.areas.values(),e=>void e.clear()),xe(this.layeredAreas.values(),e=>void e.clear()),xe(this.rowHeaders.values(),e=>void e.clear()),xe(this.columnHeaders.values(),e=>void e.clear()),xe(this.activeRowHeaders.values(),e=>void e.clear()),xe(this.activeColumnHeaders.values(),e=>void e.clear()),xe(this.activeCornerHeaders.values(),e=>void e.clear()),xe(this.rowHighlights.values(),e=>void e.clear()),xe(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function gh(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const i=e({layerLevel:r,...this.options});return t.set(r,i),i}function tV(t,e,r){return(e=xRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xRe(t){var e=ERe(t,"string");return typeof e=="symbol"?e:e+""}function ERe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TRe{constructor(e){tV(this,"ranges",[]),tV(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _Re(t,e){tJ(t,e),e.add(t)}function IO(t,e,r){tJ(t,e),e.set(t,r)}function tJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yn(t,e){return t.get(ms(t,e))}function Jb(t,e,r){return t.set(ms(t,e),r),r}function ms(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qb=new WeakMap,li=new WeakMap,Fc=new WeakMap,Os=new WeakSet;class oF{constructor(e,r){_Re(this,Os),IO(this,Qb,void 0),IO(this,li,void 0),IO(this,Fc,{x:0,y:0}),Jb(Qb,this,e),Jb(li,this,r)}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=yn(li,this).createCellCoords(e,r);let n=yn(Qb,this).current().highlight;const o=yn(li,this).visualToRenderableCoords(n);let l=0,h=0;if(this.runLocalHooks("beforeTransformStart",s),o.row!==null&&o.col!==null){const{width:d,height:g}=ms(Os,this,rJ).call(this),{row:y,col:C}=ms(Os,this,nV).call(this,n),x=yn(li,this).fixedRowsBottom(),_=yn(li,this).minSpareRows(),E=yn(li,this).minSpareCols(),R=yn(li,this).autoWrapRow(),I=yn(li,this).autoWrapCol(),F=yn(li,this).createCellCoords(y+s.row,C+s.col);if(F.row>=g){const q=il(i&&_>0&&x===0),re=F.col+1,Y=yn(li,this).createCellCoords(F.row-g,re>=d?re-d:re);this.runLocalHooks("beforeColumnWrap",q,ms(Os,this,Am).call(this,Y),re>=d),q.value?this.runLocalHooks("insertRowRequire",yn(li,this).countRenderableRows()):I&&F.assign(Y)}else if(F.row<0){const q=il(I),re=F.col-1,Y=yn(li,this).createCellCoords(g+F.row,re<0?d+re:re);this.runLocalHooks("beforeColumnWrap",q,ms(Os,this,Am).call(this,Y),re<0),I&&F.assign(Y)}if(F.col>=d){const q=il(i&&E>0),re=F.row+1,Y=yn(li,this).createCellCoords(re>=g?re-g:re,F.col-d);this.runLocalHooks("beforeRowWrap",q,ms(Os,this,Am).call(this,Y),re>=g),q.value?this.runLocalHooks("insertColRequire",yn(li,this).countRenderableColumns()):R&&F.assign(Y)}else if(F.col<0){const q=il(R),re=F.row-1,Y=yn(li,this).createCellCoords(re<0?g+re:re,d+F.col);this.runLocalHooks("beforeRowWrap",q,ms(Os,this,Am).call(this,Y),re<0),R&&F.assign(Y)}const{rowDir:H,colDir:z}=ms(Os,this,rV).call(this,F);l=H,h=z,n=ms(Os,this,Am).call(this,F)}return this.runLocalHooks("afterTransformStart",n,l,h),n}transformEnd(e,r){const i=yn(li,this).createCellCoords(e,r),s=yn(Qb,this).current(),n=yn(li,this).visualToRenderableCoords(s.highlight),o=ms(Os,this,PO).call(this,s.to.row,s.from.row),l=ms(Os,this,FO).call(this,s.to.col,s.from.col),h=s.to.clone();let d=0,g=0;if(this.runLocalHooks("beforeTransformEnd",i),n.row!==null&&n.col!==null&&o!==null&&l!==null){const{row:y,col:C}=ms(Os,this,nV).call(this,s.highlight),x=yn(li,this).createCellCoords(o+i.row,l+i.col),_=s.getTopStartCorner(),E=s.getTopEndCorner(),R=s.getBottomEndCorner();if(i.col<0&&l>=C&&x.col<C){const z=x.col-C;x.col=ms(Os,this,FO).call(this,_.col,E.col)+z}else if(i.col>0&&l<=C&&x.col>C){const z=ms(Os,this,FO).call(this,E.col,_.col),q=Math.max(x.col-z,1);x.col=z+q}if(i.row<0&&o>=y&&x.row<y){const z=x.row-y;x.row=ms(Os,this,PO).call(this,_.row,R.row)+z}else if(i.row>0&&o<=y&&x.row>y){const z=ms(Os,this,PO).call(this,R.row,_.row),q=Math.max(x.row-z,1);x.row=z+q}const{rowDir:I,colDir:F}=ms(Os,this,rV).call(this,x);d=I,g=F;const H=ms(Os,this,Am).call(this,x);i.row===0&&i.col!==0?h.col=H.col:i.row!==0&&i.col===0?h.row=H.row:(h.row=H.row,h.col=H.col)}return this.runLocalHooks("afterTransformEnd",h,d,g),h}setOffsetSize(e){let{x:r,y:i}=e;Jb(Fc,this,{x:r,y:i})}resetOffsetSize(){Jb(Fc,this,{x:0,y:0})}}function rV(t){const{width:e,height:r}=ms(Os,this,rJ).call(this);let i=0,s=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=r&&(i=1,t.row=r-1),t.col<0?(s=-1,t.col=0):t.col>0&&t.col>=e&&(s=1,t.col=e-1),{rowDir:i,colDir:s}}function rJ(){return{width:yn(Fc,this).x+yn(li,this).countRenderableColumns(),height:yn(Fc,this).y+yn(li,this).countRenderableRows()}}function PO(t,e){const r=yn(li,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:yn(Fc,this).y+r}function FO(t,e){const r=yn(li,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:yn(Fc,this).x+r}function nV(t){const{row:e,col:r}=yn(li,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return yn(li,this).createCellCoords(yn(Fc,this).y+e,yn(Fc,this).x+r)}function Am(t){const e=t.clone();return e.col=t.col-yn(Fc,this).x,e.row=t.row-yn(Fc,this).y,yn(li,this).renderableToVisualCoords(e)}qn(oF,mo);const Y_=0,K_=1,nJ=2,YD=3,RRe=[YD,nJ],ARe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],MO=Symbol("root"),iV=Symbol("child");function h1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:MO;if(e!==MO&&e!==iV)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),i=e===MO;let s=Y_;if(r){const n=t[0];t.length===0?s=K_:i&&n instanceof JC?s=YD:i&&Array.isArray(n)?s=h1(n,iV):t.length>=2&&t.length<=4&&!t.some((l,h)=>!ARe[h].includes(typeof l))&&(s=nJ)}return s}function sC(t){let{createCellCoords:e,createCellRange:r,keepDirection:i=!1,propToCol:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!RRe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(n){const o=t===YD;let l=o?n.from.row:n[0],h=o?n.from.col:n[1],d=o?n.to.row:n[2],g=o?n.to.col:n[3];if(typeof s=="function"&&(typeof h=="string"&&(h=s(h)),typeof g=="string"&&(g=s(g))),Ai(d)&&(d=l),Ai(g)&&(g=h),!i){const x=l,_=h,E=d,R=g;l=Math.min(x,E),h=Math.min(_,R),d=Math.max(x,E),g=Math.max(_,R)}const y=e(l,h),C=e(d,g);return r(y,y,C)}}function ORe(t){const e=h1(t.getSelected());if(e===Y_||e===K_)return[];const r=sC(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;xe(t.getSelected(),o=>{const{from:l,to:h}=r(o),d=Math.max(l.col,0),g=h.col-d+1;xe(Array.from(new Array(g),(y,C)=>d+C),y=>{i.has(y)||i.add(y)})});const s=Array.from(i).sort((o,l)=>o-l);return ha(s,(o,l,h,d)=>(h!==0&&l===d[h-1]+1?o[o.length-1][1]+=1:o.push([l,1]),o),[])}function IRe(t){const e=h1(t.getSelected());if(e===Y_||e===K_)return[];const r=sC(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;xe(t.getSelected(),o=>{const{from:l,to:h}=r(o),d=Math.max(l.row,0),g=h.row-d+1;xe(Array.from(new Array(g),(y,C)=>d+C),y=>{i.has(y)||i.add(y)})});const s=Array.from(i).sort((o,l)=>o-l);return ha(s,(o,l,h,d)=>(h!==0&&l===d[h-1]+1?o[o.length-1][1]+=1:o.push([l,1]),o),[])}function Om(t,e,r){PRe(t,e),e.set(t,r)}function PRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function m0(t,e,r){return(e=FRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FRe(t){var e=MRe(t,"string");return typeof e=="symbol"?e:e+""}function MRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mi(t,e){return t.get(iJ(t,e))}function ou(t,e,r){return t.set(iJ(t,e),r),r}function iJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _o=new WeakMap,p0=new WeakMap,Zb=new WeakMap,Jv=new WeakMap,ex=new WeakMap,Qv=new WeakMap;class sJ{constructor(e,r){var i=this;m0(this,"settings",void 0),m0(this,"tableProps",void 0),m0(this,"inProgress",!1),m0(this,"selectedRange",new TRe((s,n,o)=>this.tableProps.createCellRange(s,n,o))),m0(this,"highlight",void 0),Om(this,_o,void 0),Om(this,p0,void 0),m0(this,"selectedByRowHeader",new Set),m0(this,"selectedByColumnHeader",new Set),Om(this,Zb,!1),Om(this,Jv,!1),Om(this,ex,"unknown"),Om(this,Qv,-1),this.settings=e,this.tableProps=r,this.highlight=new bRe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Wk()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(s,n)=>this.tableProps.isDisabledCellSelection(s,n),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),createCellRange:(s,n,o)=>this.tableProps.createCellRange(s,n,o)}),ou(_o,this,new oF(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),ou(p0,this,new oF(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const s=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)},visualToRenderableCoords:s=>this.tableProps.visualToRenderableCoords(s),renderableToVisualCoords:s=>this.tableProps.renderableToVisualCoords(s),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(s,n)=>this.tableProps.createCellCoords(s,n),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),mi(_o,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...n)}),mi(_o,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...n)}),mi(_o,this).addLocalHook("beforeTransformEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...n)}),mi(_o,this).addLocalHook("afterTransformEnd",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...n)}),mi(_o,this).addLocalHook("insertRowRequire",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...n)}),mi(_o,this).addLocalHook("insertColRequire",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("insertColRequire",...n)}),mi(_o,this).addLocalHook("beforeRowWrap",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...n)}),mi(_o,this).addLocalHook("beforeColumnWrap",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...n)}),mi(p0,this).addLocalHook("beforeTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...n)}),mi(p0,this).addLocalHook("afterTransformStart",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...n)})}getSelectedRange(){return this.selectedRange}markSource(e){ou(ex,this,e)}markEndSource(){ou(ex,this,"unknown")}getSelectionSource(){return mi(ex,this)}setExpectedLayers(e){ou(Qv,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,ou(Qv,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const n=this.settings.selectionMode==="multiple",o=Ai(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,l=e.clone();ou(Zb,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,l),(!n||n&&!o&&Ai(r))&&this.selectedRange.clear(),this.selectedRange.add(l).current().setHighlight(s.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),i=this.tableProps.countRows(),s=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||s>0)&&(i===0&&r.col<0&&!n||s===0&&r.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const h=o.getHorizontalDirection(),d=o.getVerticalDirection(),g=this.isMultiple();o.setTo(r),g&&(h!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),g&&(d!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const l=mi(Qv,this)===-1||this.selectedRange.size()===mi(Qv,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),s=this.tableProps.countCols();r<this.highlight.layerLevel&&(xe(this.highlight.getAreas(),_=>void _.clear()),xe(this.highlight.getLayeredAreas(),_=>void _.clear()),xe(this.highlight.getRowHeaders(),_=>void _.clear()),xe(this.highlight.getColumnHeaders(),_=>void _.clear()),xe(this.highlight.getActiveRowHeaders(),_=>void _.clear()),xe(this.highlight.getActiveColumnHeaders(),_=>void _.clear()),xe(this.highlight.getActiveCornerHeaders(),_=>void _.clear()),xe(this.highlight.getRowHighlights(),_=>void _.clear()),xe(this.highlight.getColumnHighlights(),_=>void _.clear())),this.highlight.useLayerLevel(r);const n=this.highlight.createArea(),o=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),x=this.highlight.createColumnHighlight();if(n.clear(),o.clear(),l.clear(),h.clear(),d.clear(),g.clear(),y.clear(),C.clear(),x.clear(),this.highlight.isEnabledFor(cN,e.highlight)&&(this.isMultiple()||r>=1)&&(n.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const _=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(_.from).commit().syncWith(_),this.highlight.createLayeredArea().add(_.from).commit().syncWith(_),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(lN,e.highlight)){if(!e.isSingleHeader()){const R=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),I=this.tableProps.createCellCoords(e.to.row,-1),F=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),H=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(l.add(R).commit(),h.add(F).commit(),C.add(R).commit(),x.add(F).commit()):(l.add(R).add(I).commit(),h.add(F).add(H).commit(),C.add(R).add(I).commit(),x.add(F).add(H).commit())}const _=!mi(Jv,this)&&this.isEntireRowSelected()&&(s>0&&s===e.getWidth()||s===0&&this.isSelectedByRowHeader()),E=!mi(Jv,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());_&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),E&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),_&&E&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const i=this.highlight.getFocus();i.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(qE,r.highlight)&&i.add(r.highlight).commit().syncWith(r),this.inProgress||(ou(Zb,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?mi(_o,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):mi(_o,this).resetOffsetSize(),this.setRangeStart(mi(_o,this).transformStart(e,r,i))}transformEnd(e,r){this.settings.navigableHeaders?mi(_o,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):mi(_o,this).resetOffsetSize(),this.setRangeEnd(mi(_o,this).transformEnd(e,r))}transformFocus(e,r){const i=this.selectedRange.current(),{row:s,col:n}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,n-1),l=this.tableProps.countRenderableRowsInRange(0,s-1);i.highlight.isHeader()?mi(p0,this).setOffsetSize({x:n<0?Math.abs(n):-o,y:s<0?Math.abs(s):-l}):mi(p0,this).setOffsetSize({x:n<0?0:-o,y:s<0?0:-l});const h=mi(p0,this).transformStart(e,r);this.setRangeFocus(h.normalize())}shiftRows(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:s,to:n,highlight:o}=i,l=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=d?-1:0,y=d?0:r;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(vn(s.row+y,g,l-1),s.col),x=this.tableProps.createCellCoords(vn(n.row+r,g,l-1),n.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(vn(o.row+r,0,l-1),o.col)):this.setRangeStartOnly(C,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:s,to:n,highlight:o}=i,l=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=h?-1:0,y=h?0:r;this.getSelectedRange().pop();const C=this.tableProps.createCellCoords(s.row,vn(s.col+y,g,l-1)),x=this.tableProps.createCellCoords(n.row,vn(n.col+r,g,l-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(C,!0,this.tableProps.createCellCoords(o.row,vn(o.col+r,0,l-1))):this.setRangeStartOnly(C,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(x),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=il(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&mi(Zb,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=s=>{const{col:n}=s.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),l=this.tableProps.countCols();return(o>0&&n<0||o===0)&&s.getWidth()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>r(s));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=s=>{const{row:n}=s.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),l=this.tableProps.countRows();return(o>0&&n<0||o===0)&&s.getHeight()===l};if(e===-1)return Array.from(this.selectedRange).some(s=>r(s));const i=this.selectedRange.peekByIndex(e);return i?r(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const n=this.tableProps.countRows(),o=this.tableProps.countCols(),l=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),d=i?-h:0,g=r?-l:0;if(d===0&&g===0&&(n===0||o===0))return;let y=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:C,disableHeadersHighlight:x}=s;ou(Jv,this,x),C&&Number.isInteger(C==null?void 0:C.row)&&Number.isInteger(C==null?void 0:C.col)&&(y=this.tableProps.createCellCoords(vn(C.row,d,n-1),vn(C.col,g,o-1)));const _=this.tableProps.createCellCoords(d,g),E=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(_,void 0,y),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(E),this.finish(),ou(Jv,this,!1)}selectCells(e){var r=this;const i=h1(e);if(i===K_)return!1;if(i===Y_)throw new Error(Ln`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const s=sC(i,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},l=!e.some(h=>{const d=s(h),g=d.isValid(o);return!(g&&!d.containsHeaders()||g&&d.containsHeaders()&&d.isSingleHeader())});return l&&(this.clear(),this.setExpectedLayers(e.length),xe(e,h=>{const{from:d,to:g}=s(h);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),l}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=typeof e=="string"?this.tableProps.propToCol(e):e,n=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),l=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),d=h===0?0:-h,g=this.tableProps.createCellCoords(d,s),y=this.tableProps.createCellCoords(o-1,n),C=this.tableProps.createCellRange(g,g,y).isValid({countRows:o,countCols:l,countRowHeaders:0,countColHeaders:h});if(C){let x=0,_=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(x=vn(i.row,d,o-1),_=vn(i.col,Math.min(s,n),Math.max(s,n))):(x=vn(i,d,o-1),_=s);const E=this.tableProps.createCellCoords(x,_),R=h===0?0:vn(E.row,d,-1),I=o-1,F=this.tableProps.createCellCoords(R,s),H=this.tableProps.createCellCoords(I,n);this.runLocalHooks("beforeSelectColumns",F,H,E),F.row=R,H.row=I,this.setRangeStartOnly(F,void 0,E),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(H),this.runLocalHooks("afterSelectColumns",F,H,E),this.finish()}return C}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),l=o===0?0:-o,h=this.tableProps.createCellCoords(e,l),d=this.tableProps.createCellCoords(r,n-1),g=this.tableProps.createCellRange(h,h,d).isValid({countRows:s,countCols:n,countRowHeaders:o,countColHeaders:0});if(g){let y=0,C=0;Number.isInteger(i==null?void 0:i.row)&&Number.isInteger(i==null?void 0:i.col)?(y=vn(i.row,Math.min(e,r),Math.max(e,r)),C=vn(i.col,l,n-1)):(y=e,C=vn(i,l,n-1));const x=this.tableProps.createCellCoords(y,C),_=o===0?0:vn(x.col,l,-1),E=n-1,R=this.tableProps.createCellCoords(e,_),I=this.tableProps.createCellCoords(r,E);this.runLocalHooks("beforeSelectRows",R,I,x),R.col=_,I.col=E,this.setRangeStartOnly(R,void 0,x),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(I),this.runLocalHooks("afterSelectRows",R,I,x),this.finish()}return g}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:s,to:n,highlight:o}=i;this.clear(),o.assign({row:vn(o.row,-1/0,e-1),col:vn(o.col,-1/0,r-1)}),s.assign({row:vn(s.row,-1/0,e-1),col:vn(s.col,-1/0,r-1)}),n.assign({row:vn(n.row,0,e-1),col:vn(n.col,0,r-1)}),this.selectedRange.ranges.push(i),this.highlight.getFocus().add(o).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(s=>{s.commit()}),!this.isSelected())return;const r=this.getLayerLevel(),i=this.selectedRange.current();this.highlight.isEnabledFor(qE,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let s=0;s<this.selectedRange.size();s+=1){this.highlight.useLayerLevel(s);const n=this.highlight.createArea(),o=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),C=this.highlight.createRowHighlight(),x=this.highlight.createColumnHighlight();n.commit(),o.commit(),l.commit(),h.commit(),d.commit(),g.commit(),y.commit(),C.commit(),x.commit()}this.highlight.useLayerLevel(r)}}qn(sJ,mo);const sV=/^(\r\n|\n\r|\r|\n)/,kRe=/^[^\t\r\n]+/,oV=/^\t/;function NRe(t){const e=[[""]];if(t.length===0)return e;let r=0,i=0,s;for(;t.length>0&&s!==t.length;)if(s=t.length,t.match(oV))t=t.replace(oV,""),r+=1,e[i][r]="";else if(t.match(sV))t=t.replace(sV,""),r=0,i+=1,e[i]=[""];else{let n="";if(t.startsWith('"')){let o=0,l=!0;for(;l;){const h=t.slice(0,1);h==='"'&&(o+=1),n+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(l=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const o=t.match(kRe);n=o?o[0]:"",t=t.slice(n.length)}e[i][r]=n}return e}function ly(t){let e,r,i,s,n="",o;for(e=0,r=t.length;e<r;e+=1){for(s=t[e].length,i=0;i<s;i+=1)i>0&&(n+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?n+=`"${o.replace(/"/g,'""')}"`:n+=o:o==null?n+="":n+=o;e!==r-1&&(n+=`
`)}return n}function v0(t,e,r){return(e=DRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function DRe(t){var e=LRe(t,"string");return typeof e=="symbol"?e:e+""}function LRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Op{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,i){v0(this,"hot",void 0),v0(this,"metaManager",void 0),v0(this,"tableMeta",void 0),v0(this,"dataSource",void 0),v0(this,"duckSchema",void 0),v0(this,"colToPropCache",void 0),v0(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,r){let s=0,n=0,o=!1;if(typeof r=="function"){const l=Kk(e);s=l>0?l:this.countFirstRowKeys(),o=!0}else{const l=this.tableMeta.maxCols;s=Math.min(l,r.length)}for(i=0;i<s;i++){const l=o?r(i):r[i];if(Qr(l)){if(typeof l.data<"u"){const h=o?n:i;this.colToPropCache[h]=l.data,this.propToColCache.set(l.data,h)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Vq(this.dataSource)}recursiveDuckColumns(e,r,i){let s=r,n=i,o;return typeof s>"u"&&(s=0,n=""),typeof e=="object"&&!Array.isArray(e)&&Zr(e,(l,h)=>{l===null?(o=n+h,this.colToPropCache.push(o),this.propToColCache.set(o,s),s+=1):s=this.recursiveDuckColumns(l,s,`${h}.`)}),s}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&rr(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(rr(r))return this.hot.toVisualColumn(r);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?rC(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=this.hot.countSourceRows();let o=n,l=0,h=e;if((typeof h!="number"||h>=n)&&(h=n),h<this.hot.countRows()&&(o=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,r,i)===!1||o===null)return{delta:0};const g=this.tableMeta.maxRows,y=this.getSchema().length,C=[];for(;l<r&&n+l<g;){let _=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?_=la(this.getSchema()):(_=[],pr(y-1,()=>_.push(null))):this.hot.dataType==="function"?_=this.tableMeta.dataSchema(h+l):(_={},H_(_,this.getSchema())),C.push(_),l+=1}this.hot.rowIndexMapper.insertIndexes(h,l),s==="below"&&(o=Math.min(o+1,n)),this.spliceData(o,0,C);const x=this.hot.toVisualRow(o);return this.hot.countSourceRows()===C.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),l>0&&(e==null?this.metaManager.createRow(null,l):i!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",x,l,i),this.hot.forceFullRender=!0,{delta:l,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:s="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const n=this.dataSource,o=this.tableMeta.maxCols,l=this.hot.countSourceCols();let h=e;if((typeof h!="number"||h>=l)&&(h=l),this.hot.runHooks("beforeCreateCol",h,r,i)===!1)return{delta:0};let g=l;h<this.hot.countCols()&&(g=this.hot.toPhysicalColumn(h));const y=this.hot.countSourceRows();let C=this.hot.countCols(),x=0,_=g;s==="end"&&(_=Math.min(_+1,l));const E=_;for(;x<r&&C<o;){if(typeof h!="number"||h>=C)if(y>0)for(let I=0;I<y;I+=1)typeof n[I]>"u"&&(n[I]=[]),n[I].push(null);else n.push([null]);else for(let I=0;I<y;I++)n[I].splice(_,0,null);x+=1,_+=1,C+=1}this.hot.columnIndexMapper.insertIndexes(h,x),x>0&&(e==null?this.metaManager.createColumn(null,x):i!=="auto"&&this.metaManager.createColumn(E,r));const R=this.hot.toVisualColumn(E);return this.hot.runHooks("afterCreateCol",R,x,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:x,startPhysicalIndex:E}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,s=Number.isInteger(e)?e:-r;const n=this.visualRowsToPhysical(s,r),o=this.hot.countSourceRows();if(s=(o+s)%o,this.hot.runHooks("beforeRemoveRow",s,n.length,n,i)===!1)return!1;const h=n.length;if(this.filterData(s,h,n),s<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);const g=rr(this.tableMeta.columns)||rr(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&g===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return n.slice(0).sort((g,y)=>y-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",s,h,n,i),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let s=typeof e!="number"?-r:e;s=(this.hot.countCols()+s)%this.hot.countCols();const n=this.visualColumnsToPhysical(s,r),o=n.slice(0).sort((y,C)=>C-y);if(this.hot.runHooks("beforeRemoveCol",s,r,n,i)===!1)return!1;let h=!0;const d=o.length,g=this.dataSource;for(let y=0;y<d;y++)h&&n[0]!==n[y]-y&&(h=!1);if(h)for(let y=0,C=this.hot.countSourceRows();y<C;y++)g[y].splice(n[0],r),y===0&&this.metaManager.removeColumn(n[0],r);else for(let y=0,C=this.hot.countSourceRows();y<C;y++)for(let x=0;x<d;x++)g[y].splice(o[x],1),y===0&&this.metaManager.removeColumn(o[x],1);return s<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",s,r,n,i),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,i){const s=this.hot.getDataAtCol(e),n=s.slice(r,r+i),o=s.slice(r+i);for(var l=arguments.length,h=new Array(l>3?l-3:0),d=3;d<l;d++)h[d-3]=arguments[d];B9(h,o);let g=0;for(;g<i;)h.push(null),g+=1;return GCe(h),this.hot.populateFromArray(r,e,h,null,null,"spliceCol"),n}spliceRow(e,r,i){const s=this.hot.getSourceDataAtRow(e),n=s.slice(r,r+i),o=s.slice(r+i);for(var l=arguments.length,h=new Array(l>3?l-3:0),d=3;d<l;d++)h[d-3]=arguments[d];B9(h,o);let g=0;for(;g<i;)h.push(null),g+=1;return this.hot.populateFromArray(e,r,[h],null,null,"spliceRow"),n}spliceData(e,r,i){if(this.hot.runHooks("beforeDataSplice",e,r,i)!==!1){const n=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,n.forEach(o=>this.dataSource.push(o))}}filterData(e,r,i){let s=this.hot.runHooks("filterData",e,r,i);Array.isArray(s)===!1&&(s=this.dataSource.filter((n,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,s)}get(e,r){const i=this.hot.toPhysicalRow(e);let s=this.dataSource[i];const n=this.hot.runHooks("modifyRowData",i);s=isNaN(n)?n:s;const{dataDotNotation:o}=this.hot.getSettings();let l=null;if(s&&s.hasOwnProperty&&vs(s,r))l=s[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let h=s;if(!h)return null;const d=r.split(".");for(let g=0,y=d.length;g<y;g++)if(h=h[d[g]],typeof h>"u")return null;l=h}else typeof r=="function"&&(l=r(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){const h=il(l);this.hot.runHooks("modifyData",i,this.propToCol(r),h,"get"),h.isTouched()&&(l=h.value)}return l}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,i){const s=this.hot.toPhysicalRow(e);let n=i,o=this.dataSource[s];const l=this.hot.runHooks("modifyRowData",s);if(o=isNaN(l)?l:o,this.hot.hasHook("modifyData")){const d=il(n);this.hot.runHooks("modifyData",s,this.propToCol(r),d,"set"),d.isTouched()&&(n=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(o&&o.hasOwnProperty&&vs(o,r))o[r]=n;else if(h&&typeof r=="string"&&r.indexOf(".")>-1){let d=o,g=0,y;const C=r.split(".");for(g=0,y=C.length-1;g<y;g++)typeof d[C[g]]>"u"&&(d[C[g]]={}),d=d[C[g]];d[C[g]]=n}else typeof r=="function"?r(this.dataSource.slice(s,s+1)[0],n):o[r]=n}visualRowsToPhysical(e,r){const i=this.hot.countSourceRows(),s=[];let n=(i+e)%i,o=r,l;for(;n<i&&o;)l=this.hot.toPhysicalRow(n),s.push(l),o-=1,n+=1;return s}visualColumnsToPhysical(e,r){const i=this.hot.countCols(),s=[];let n=(i+e)%i,o=r;for(;n<i&&o;){const l=this.hot.toPhysicalColumn(n);s.push(l),o-=1,n+=1}return s}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Op.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,i){const s=[];let n,o,l;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const g=i===Op.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,y=Math.min(Math.max(h-1,0),Math.max(e.row,r.row)),C=Math.min(Math.max(d-1,0),Math.max(e.col,r.col));for(n=Math.min(e.row,r.row);n<=y;n++){l=[];const x=n>=0?this.hot.toPhysicalRow(n):n;for(o=Math.min(e.col,r.col);o<=C&&x!==null;o++)l.push(g.call(this,n,this.colToProp(o)));x!==null&&s.push(l)}return s}getText(e,r){return ly(this.getRange(e,r,Op.DESTINATION_RENDERER))}getCopyableText(e,r){return ly(this.getRange(e,r,Op.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:HRe,getItem:$Re,hasItem:oJ,getNames:CXe,getValues:SXe}=Uc("cellTypes");function BRe(t){if(!oJ(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return $Re(t)}function dc(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:i,validator:s}=e;r&&za(t,r),i&&Rl(t,i),s&&ap(t,s),HRe(t,e)}function VRe(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!vs(e,t)}function X_(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?BRe(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Zr(e,(n,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!Qr(i))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const s={};Zr(i,(n,o)=>{if(VRe(o,r)){var l;s[o]=n,(l=t._automaticallyAssignedMetaProps)===null||l===void 0||l.add(o)}}),Cs(t,s)}function WRe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Qu(r,t);for(let i=0;i<e.length;i++)r.prototype[e[i]]=void 0;return r}function V2(t){return Number.isInteger(t)&&t>=0}function W2(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function tx(t){return t==null}const aJ=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,i;for(e=0,r=this.countRows();e<r;e++)if(i=this.getDataAtCell(e,t),Zi(i)===!1)return!1;return!0},isEmptyRow(t){let e,r,i,s;for(e=0,r=this.countCols();e<r;e++)if(i=this.getDataAtCell(t,e),Zi(i)===!1)return typeof i=="object"?(s=this.getCellMeta(t,e),Yk(this.getSchema()[s.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function aV(t,e,r){return(e=jRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jRe(t){var e=URe(t,"string");return typeof e=="symbol"?e:e+""}function URe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zRe(){return class{}}class GRe{constructor(e){aV(this,"metaCtor",zRe()),aV(this,"meta",void 0),this.meta=this.metaCtor.prototype,Cs(this.meta,aJ()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Cs(this.meta,e),X_(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function YRe(t,e,r){return(e=KRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KRe(t){var e=XRe(t,"string");return typeof e=="symbol"?e:e+""}function XRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qRe{constructor(e){YRe(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Cs(this.meta,e),X_(this.meta,e,e)}}function rx(t,e,r){return(e=JRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function JRe(t){var e=QRe(t,"string");return typeof e=="symbol"?e:e+""}function QRe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZE{constructor(e){rx(this,"valueFactory",void 0),rx(this,"data",[]),rx(this,"index",[]),rx(this,"holes",new Set),this.valueFactory=e}obtain(e){W2(()=>V2(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let i;if(r>=0)i=this.data[r],i===void 0&&(i=this.valueFactory(e),this.data[r]=i);else if(i=this.valueFactory(e),this.holes.size>0){const s=this.holes.values().next().value;this.holes.delete(s),this.data[s]=i,this.index[e]=s}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;W2(()=>V2(e)||tx(e),"Expecting an unsigned number or null/undefined argument.");const i=[],s=this.data.length;for(let o=0;o<r;o++)i.push(s+o),this.data.push(void 0);const n=tx(e)?this.index.length:e;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;W2(()=>V2(e)||tx(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(tx(e)?this.index.length-r:e,r);for(let s=0;s<i.length;s++){const n=i[s];typeof n=="number"&&this.holes.add(n)}}size(){return this.data.length-this.holes.size}values(){return Ad(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const s=this._getKeyByStorageIndex(i);s!==-1&&e.push([s,this.data[i]])}let r=0;return{next:()=>{if(r<e.length){const i=e[r];return r+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function lV(t,e,r){return(e=ZRe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZRe(t){var e=eAe(t,"string");return typeof e=="symbol"?e:e+""}function eAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const tAe=["data","width"];class rAe{constructor(e){lV(this,"globalMeta",void 0),lV(this,"metas",new ZE(()=>this._createMeta())),this.globalMeta=e,this.metas=new ZE(()=>this._createMeta())}updateMeta(e,r){const i=this.getMeta(e);Cs(i,r),X_(i,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return WRe(this.globalMeta.getMetaConstructor(),tAe).prototype}}function cV(t,e,r){return(e=nAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nAe(t){var e=iAe(t,"string");return typeof e=="symbol"?e:e+""}function iAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sAe{constructor(e){cV(this,"columnMeta",void 0),cV(this,"metas",new ZE(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,i){const s=this.getMeta(e,r);Cs(s,i),X_(s,i)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,r)}getMeta(e,r,i){const s=this.metas.obtain(e).obtain(r);return i===void 0?s:s[i]}setMeta(e,r,i,s){var n;const o=this.metas.obtain(e).obtain(r);(n=o._automaticallyAssignedMetaProps)===null||n===void 0||n.delete(i),o[i]=s}removeMeta(e,r,i){const s=this.metas.obtain(e).obtain(r);delete s[i]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let i=0;i<r.length;i++)rr(r[i])&&e.push(...r[i].values());return e}getMetasAtRow(e){W2(()=>V2(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new ZE(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class lJ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new GRe(e),this.tableMeta=new qRe(this.globalMeta),this.columnMeta=new rAe(this.globalMeta),this.cellMeta=new sAe(this.columnMeta),i.forEach(s=>new s(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,i){let{visualRow:s,visualColumn:n}=i;const o=this.cellMeta.getMeta(e,r);return o.visualRow=s,o.visualCol=n,o.row=e,o.col=r,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,r,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,i)}setCellMeta(e,r,i,s){this.cellMeta.setMeta(e,r,i,s)}updateCellMeta(e,r,i){this.cellMeta.updateMeta(e,r,i)}removeCellMeta(e,r,i){this.cellMeta.removeMeta(e,r,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}qn(lJ,mo);function uV(t,e,r,i){const{hotInstance:s,dataMap:n,dataSource:o,internalSource:l,source:h,metaManager:d,firstRun:g}=i,y=Hc(l),C=s.getSettings();Array.isArray(C.dataSchema)?s.dataType="array":ci(C.dataSchema)?s.dataType="function":s.dataType="object",n&&n.destroy(),t=s.runHooks(`before${y}`,t,g,h);const x=new Op(s,t,d);if(e(x),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const _=x.getSchema();t=[];let E,R=0,I=0;for(R=0,I=C.startRows;R<I;R++)if((s.dataType==="object"||s.dataType==="function")&&C.dataSchema)E=la(_),t.push(E);else if(s.dataType==="array")E=la(_[0]),t.push(E);else{E=[];for(let F=0,H=C.startCols;F<H;F++)E.push(null);t.push(E)}}else throw new Error(`${l} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(s.dataType="array"),C.data=t,x.dataSource=t,o.data=t,o.dataType=s.dataType,o.colToProp=x.colToProp.bind(x),o.propToCol=x.propToCol.bind(x),o.countCachedColumns=x.countCachedColumns.bind(x),r(x),s.runHooks(`after${y}`,t,g,h),g||(s.runHooks("afterChange",null,l),s.render()),s.getSettings().ariaTags&&Or(s.rootElement,[LX(-1),N_(s.countCols()+(s.view?s.countRowHeaders():0))])}function hV(t,e,r){return(e=oAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oAe(t){var e=aAe(t,"string");return typeof e=="symbol"?e:e+""}function aAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lAe{constructor(e){hV(this,"metaManager",void 0),hV(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),Xt.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:i,col:s}=e;if((r=this.metaSyncMemo.get(i))!==null&&r!==void 0&&r.has(s))return;const{visualRow:n,visualCol:o}=e,l=this.metaManager.hot,h=l.colToProp(o);e.prop=h,l.runHooks("beforeGetCellMeta",n,o,e);const d=vs(e,"type")?e.type:null;let g=ci(e.cells)?e.cells(i,s,h):null;if(d)if(g){var y;g.type=(y=g.type)!==null&&y!==void 0?y:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,s,g),l.runHooks("afterGetCellMeta",n,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(s)}}function cAe(t,e,r){uAe(t,e),e.set(t,r)}function uAe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kO(t,e,r){return(e=hAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function hAe(t){var e=fAe(t,"string");return typeof e=="symbol"?e:e+""}function fAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dAe(t,e){return t.get(gAe(t,e))}function gAe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fV=new WeakMap;class mAe{constructor(e){kO(this,"metaManager",void 0),kO(this,"usageTracker",new Set),kO(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),cAe(this,fV,(r,i,s)=>{if(!s)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:i,target:s,onChange:n}=e,o=typeof s=="string",l=o?s:r,h=`_${l}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[l],n?(this.installPropWatcher(r,h,n),o&&this.installPropWatcher(s,h,n)):i&&(this.installPropWatcher(r,h,dAe(fV,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,i){const s=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(n){const o=!s.usageTracker.has(e);s.usageTracker.add(e),i.call(s,e,n,o),this[r]=n},enumerable:!0,configurable:!0})}}const cJ="gridDefault",Bd="editorManager.handlingEditor",pAe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},vAe="hooksRefRegisterer",uJ={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){xe(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Zr(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ff(uJ,"MIXIN_NAME",vAe,{writable:!1,enumerable:!1});function sc(t,e,r){return(e=wAe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wAe(t){var e=yAe(t,"string");return typeof e=="symbol"?e:e+""}function yAe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const CAe="base",Xi=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class N1{static get EDITOR_TYPE(){return CAe}constructor(e){sc(this,"hot",void 0),sc(this,"state",Xi.VIRGIN),sc(this,"_opened",!1),sc(this,"_fullEditMode",!1),sc(this,"_closeCallback",null),sc(this,"TD",null),sc(this,"row",null),sc(this,"col",null),sc(this,"prop",null),sc(this,"originalValue",null),sc(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,i,s,n,o){this.TD=s,this.row=e,this.col=r,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=this.isOpened()?this.state:Xi.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let i,s,n,o;if(r){const h=this.hot.getSelectedLast();i=Math.max(Math.min(h[0],h[2]),0),s=Math.max(Math.min(h[1],h[3]),0),n=Math.max(h[0],h[2]),o=Math.max(h[1],h[3])}else[i,s,n,o]=[this.row,this.col,null,null];const l=this.hot.runHooks("modifyGetCellCoords",i,s,!1,"meta");Array.isArray(l)&&([i,s]=l),this.hot.populateFromArray(i,s,e,n,o,"edit")}beginEditing(e,r){if(this.state!==Xi.VIRGIN)return;const i=this.hot,s=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),n=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=Xi.EDITING,this.isInFullEditMode()){const h=typeof e=="string"?e:as(this.originalValue);this.setValue(h)}this.open(r),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),i.view.scrollViewport(i._createCellCoords(s,n))||(this.hot.removeHook("afterScroll",o),o())}finishEditing(e,r,i){let s;if(i){const n=this._closeCallback;this._closeCallback=o=>{n&&n(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Xi.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Xi.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const n=this.getValue();this.cellProperties.trimWhitespace?s=[[typeof n=="string"?String.prototype.trim.call(n||""):n]]:s=[[n]],this.state=Xi.WAITING,this.saveValue(s,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Xi.FINISHED,this.discardEditor(o)}):(this.state=Xi.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Xi.FINISHED,this.discardEditor()}discardEditor(e){this.state===Xi.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Xi.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Xi.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Xi.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:i,wtViewport:s}=this.hot.view._wt,n=this.hot.rootWindow,o=zs(r),l=os(r),h=zs(this.hot.rootElement),d=os(this.hot.rootElement),g=i.topOverlay.holder,y=i.inlineStartOverlay.holder,C=g!==n?g.scrollTop:0,x=y!==n?y.scrollLeft:0,_=n.innerWidth-h.left-d,{wtTable:E}=(e=i.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,R=E.name,I=["master","inline_start"].includes(R)?C:0,F=["master","top","bottom"].includes(R)?x:0,H=o.top===h.top?0:1;let z=o.top-h.top-H-I,q=0;this.hot.isRtl()?q=n.innerWidth-o.left-l-_-1+F:q=o.left-h.left-1-F,["top","top_inline_start_corner"].includes(R)&&(z+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(R)&&(q+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const re=this.hot.hasColHeaders(),Y=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),oe=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),de=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(re&&Y<=0||Y===de)&&(z+=1),oe<=0&&(q+=1);const Re=s.rowsRenderCalculator.startPosition,Ie=s.columnsRenderCalculator.startPosition,Be=Math.abs(i.inlineStartOverlay.getScrollPosition()),lt=i.topOverlay.getScrollPosition(),pt=co(this.hot.rootDocument);let Ct=r.offsetTop;if(["inline_start","master"].includes(R)&&(Ct+=Re-lt),["bottom","bottom_inline_start_corner"].includes(R)){const{wtViewport:pe,wtTable:ye}=i.bottomOverlay.clone;Ct+=pe.getWorkspaceHeight()-ye.getHeight()-pt}let ct=r.offsetLeft;this.hot.isRtl()?(ct>=0?ct=E.getWidth()-r.offsetLeft:ct=Math.abs(ct),ct+=Ie-Be-l):["top","master","bottom"].includes(R)&&(ct+=Ie-Be);const Ue=n.getComputedStyle(this.TD),Je=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Fe=parseInt(Ue[Je],10)>0?0:1,A=parseInt(Ue.borderTopWidth,10)>0?0:1,O=os(r)+Fe,k=es(r)+A,L=PSe(g)?pt:0,D=FSe(y)?pt:0,K=this.hot.view.maximumVisibleElementWidth(ct)-L+Fe,Q=Math.max(this.hot.view.maximumVisibleElementHeight(Ct)-D+A,this.hot.view.getDefaultRowHeight());return{top:z,start:q,height:k,maxHeight:Q,width:O,maxWidth:K}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}qn(N1,uJ);const SAe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const i=t._getEditorManager(),s=i.getActiveEditor();s.isInFullEditMode()&&s.state===Xi.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},bAe={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},xAe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},EAe={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},TAe={name:"editorOpen",callback(t,e,r){const i=t._getEditorManager(),s=t.getSelectedRangeLast(),{highlight:n}=s;if(t.selection.isMultiple()&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),l=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-l.row,-l.col):t.selection.transformFocus(l.row,l.col);return}n.isHeader()||(t.getSettings().enterBeginsEditing?i.cellProperties.readOnly?i.moveSelectionAfterEnter(e):i.openEditor(null,e,!0):i.moveSelectionAfterEnter(e),jc(e))}};function _Ae(){return[pAe,SAe,bAe,xAe,EAe,TAe]}const RAe={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},AAe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(i!==null){const s=t._createCellCoords(i,e.col),n=e.row-t.getFirstFullyVisibleRow(),o=Math.min(s.row-n,t.countRows()-1);t.selection.setRangeEnd(s),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},OAe={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},IAe={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},PAe={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,i.col,e)}},FAe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(t.countRows()-1,-1),h=s.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,n.col))}}},MAe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),l=s.clone();l.col=i.col,e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(n.row,o))}}},kAe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),l=r.getNearestNotHiddenIndex(o,1),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},NAe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},DAe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByColumnHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=s.clone();h.col=i.col,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(n.row,l))}}},LAe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:i,from:s,to:n}=t.getSelectedRangeLast(),o=i.isHeader()&&t.selection.isSelectedByRowHeader();if(i.isCell()||o){const l=r.getNearestNotHiddenIndex(0,1),h=s.clone();h.row=i.row,e.setRangeStart(h,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,n.col))}}},HAe={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:i}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,i.row,e)}},$Ae={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},BAe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),i=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(i!==null){const s=t._createCellCoords(i,e.col),n=e.row-t.getFirstFullyVisibleRow(),o=Math.max(s.row-n,0);t.selection.setRangeEnd(s),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function VAe(){return[RAe,AAe,OAe,IAe,PAe,FAe,MAe,kAe,NAe,DAe,LAe,HAe,$Ae,BAe]}const WAe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},jAe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=t.countVisibleRows()+r;i===t.countRows()-1?s=1:i+s>t.countRows()&&(s=t.countRows()-i-1),t.selection.transformStart(s,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},UAe={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-s.row,-s.col):t.selection.transformStart(-s.row,-s.col)}},zAe={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),i=t.getSelectedRangeLast(),s=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(s.row,s.col):t.selection.transformStart(s.row,s.col)}},GAe={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},YAe={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},KAe={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},XAe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,s=parseInt(t.getSettings().fixedRowsBottom,10),n=r.getNearestNotHiddenIndex(t.countRows()-s-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(n,o))}},qAe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},JAe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),s=t.getSelectedRangeLast().highlight.row,n=r.getNearestNotHiddenIndex(i,1);e.setRangeStart(t._createCellCoords(s,n))}},QAe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,i=t.getSelectedRangeLast().highlight.row;let s=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);s===null&&(s=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(i,s))}},ZAe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:i}=t.getSelectedRangeLast().highlight;let s=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);s===null&&(s=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(i,s))}},e4e={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},t4e={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:i}=t,s=parseInt(t.getSettings().fixedRowsTop,10),n=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(s,1),l=i.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(o,l))}},r4e={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},n4e={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:i}=t.getSelectedRangeLast().highlight;let s=-(t.countVisibleRows()+r);i===-r?s=-1:i+s<r&&(s=-(i+r)),t.selection.transformStart(s,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function i4e(){return[WAe,jAe,UAe,zAe,GAe,YAe,KAe,XAe,qAe,JAe,QAe,ZAe,e4e,t4e,r4e,n4e]}const s4e={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},o4e={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,s=t.getLastFullyVisibleRow()+1,n=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,i),l=t._createCellCoords(s,n);if(!t._createCellRange(o,o,l).includes(e)&&(e.row>=0||e.col>=0)){const d={};if(e.col>=0){const g=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-g,0)}if(e.row>=0){const g=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-g,0)}t.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},a4e={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},l4e={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},c4e={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:i}=e[e.length-1].highlight.normalize(),s=t.getDataAtCell(r,i),n=new Map;for(let o=0;o<e.length;o++)e[o].forAll((l,h)=>{if(l>=0&&h>=0&&(l!==r||h!==i)){const{readOnly:d}=t.getCellMeta(l,h);d||n.set(`${l}x${h}`,[l,h,s])}});t.setDataAtCell(Array.from(n.values()))}},u4e=[..._Ae(),...VAe(),...i4e(),s4e,o4e,a4e,l4e,c4e];function hJ(t){const e={};return u4e.forEach(r=>{let{name:i,callback:s}=r;e[i]=function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return s(t,...o)}}),e}function h4e(t){const e=t.getShortcutManager().addContext("editor"),r=hJ(t),i={group:Bd};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(s,n)=>r.editorCloseAndSaveByEnter(s,n)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(s,n)=>r.editorCloseAndSaveByEnter(s,n)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(s,n)=>r.editorCloseAndSave(s,n)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(s,n)=>r.editorCloseAndSaveByArrowKeys(s,n)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],i)}function f4e(t){const e=t.getShortcutManager().addContext("grid"),r=hJ(t),i={runOnlyIf:()=>{const{navigableHeaders:s}=t.getSettings();return rr(t.getSelected())&&(s||!s&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:cJ};e.addShortcuts([{keys:[["F2"]],callback:s=>r.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,n)=>r.editorOpen(s,n)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:Bd,runOnlyIf:()=>rr(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var s;return!((s=t.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var s,n;return!((s=t.getSelectedRangeLast())!==null&&s!==void 0&&s.highlight.isHeader())&&((n=t.getSelectedRangeLast())===null||n===void 0?void 0:n.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>r.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],i)}function d4e(t){[f4e,h4e].forEach(e=>e(t))}function g4e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,i=dV(t),s=dV(t);return i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),s.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(i),r.lastChild.after(s),{activate(){t._registerTimeout(()=>{i.tabIndex=0,s.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,s.tabIndex=-1},10)}}}function dV(t){const r=t.rootDocument.createElement("input");return r.type="text",r.name="__htFocusCatcher",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&Or(r,[Hu(),Ld()]),r}function m4e(t){const e=p4e(t);let r;const{activate:i,deactivate:s}=g4e(t,{onFocusFromTop(){var y;const C=(y=e(r))!==null&&y!==void 0?y:aF(t);C&&(t.runHooks("modifyFocusOnTabNavigation","from_above",C),t.selectCell(C.row,C.col)),t.listen()},onFocusFromBottom(){var y;const C=(y=e(r))!==null&&y!==void 0?y:lF(t);C&&(t.runHooks("modifyFocusOnTabNavigation","from_below",C),t.selectCell(C.row,C.col)),t.listen()}}),n={wrapped:!1,flipped:!1};let o=!0,l=!1,h=!1;t.addHook("afterListen",()=>s()),t.addHook("afterUnlisten",()=>i()),t.addHook("afterSelection",(y,C,x,_,E)=>{if(l&&(n.wrapped&&n.flipped||h)&&(h=!1,E.value=!0),o){var R;r=(R=t.getSelectedRangeLast())===null||R===void 0?void 0:R.highlight}}),t.addHook("beforeRowWrap",(y,C,x)=>{n.wrapped=!0,n.flipped=x});function d(){n.wrapped=!1,n.flipped=!1,t.deselectCell(),t.unlisten()}const g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:cJ,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{const{tabNavigation:y}=t.getSettings();l=!0,t.getSelectedRangeLast()&&!y&&(o=!1),y||(h=!0)},position:"before"},{...g,callback:y=>{const{tabNavigation:C,autoWrapRow:x}=t.getSettings();if(l=!1,o=!0,!C||!t.selection.isSelected()||x&&n.wrapped&&n.flipped||!x&&n.wrapped)return x&&n.wrapped&&n.flipped&&(r=y.shiftKey?aF(t):lF(t)),d(),!1;y.preventDefault()},position:"after"}])}function aF(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:i}=t.getSettings();let s=i&&t.countColHeaders()>0?-t.countColHeaders():0,n=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return s===0&&(s=e.getVisualFromRenderableIndex(s)),n===0&&(n=r.getVisualFromRenderableIndex(n)),s===null||n===null?null:t._createCellCoords(s,n)}function lF(t){var e,r;const{rowIndexMapper:i,columnIndexMapper:s}=t,{navigableHeaders:n}=t.getSettings();let o=i.getRenderableIndexesLength()-1,l=s.getRenderableIndexesLength()-1;if(o<0){if(!n||t.countColHeaders()===0)return null;o=-1}if(l<0){if(!n||t.countColHeaders()===0)return null;l=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=s.getVisualFromRenderableIndex(l))!==null&&r!==void 0?r:l)}function p4e(t){return e=>{if(!e)return null;const r=aF(t),i=lF(t);return e.col<r.col&&(e.col=r.col),e.col>i.col&&(e.col=i.col),e.row<r.row&&(e.row=r.row),e.row>i.row&&(e.row=i.row),e}}function v4e(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function w4e(){return()=>{}}function y4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function C4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function S4e(t){return e=>{t.scrollViewportTo(e.toObject())}}function b4e(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function x4e(t){return e=>{const r=t.selection.getSelectionSource(),{row:i,col:s}=e;if(i<0&&s>=0)t.scrollViewportTo({col:s});else if(s<0&&i>=0)t.scrollViewportTo({row:i});else{if(r==="mouse"&&(s===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:s})}}}function E4e(t){const{selection:e}=t;let r=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){r=!0},scrollTo(s){var n;if(r||i){r=!1;return}let o;e.isFocusSelectionChanged()?o=y4e(t):e.isSelectedByCorner()?o=w4e():e.isSelectedByRowHeader()?o=b4e(t):e.isSelectedByColumnHeader()?o=v4e(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=C4e(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=x4e(t):e.getSelectedRange().size()>1&&(o=S4e(t)),(n=o)===null||n===void 0||n(s)}}}const gV=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),nx=t=>t.map(e=>{const r=e.toLowerCase();return gV.has(r)?gV.get(r):r}).sort().join("+"),T4e=t=>t.split("+"),mV=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),NO=t=>{let{which:e,key:r}=t;if(mV.has(e))return mV.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:r.toLowerCase()},fJ=Symbol("shortcut-context");function dJ(t){return Qr(t)&&t.__kindOf===fJ}const _4e=t=>{const e=B_({errorIdExists:h=>`The "${h}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:h,callback:d,group:g,runOnlyIf:y=()=>!0,captureCtrl:C=!1,preventDefault:x=!0,stopPropagation:_=!1,relativeToGroup:E,position:R,forwardToContext:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ai(g))throw new Error("You need to define the shortcut's group.");if(ci(d)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(h)===!1)throw new Error(Ln`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const F={callback:d,group:g,runOnlyIf:y,captureCtrl:C,preventDefault:x,stopPropagation:_};rr(E)&&(F.relativeToGroup=E,F.position=R),dJ(I)&&(F.forwardToContext=I),h.forEach(H=>{const z=nx(H);if(e.hasItem(z)){const re=e.getItem(z);let Y=re.findIndex(oe=>oe.group===E);Y!==-1?R==="before"?Y-=1:Y+=1:Y=re.length,re.splice(Y,0,F)}else e.addItem(z,[F])})},i=function(h){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};h.forEach(g=>{Zr(d,(y,C)=>{Object.prototype.hasOwnProperty.call(g,C)===!1&&(g[C]=d[C])}),r(g)})},s=h=>{const d=nx(h);e.removeItem(d)};return{__kindOf:fJ,addShortcut:r,addShortcuts:i,getShortcuts:h=>{const d=nx(h),g=e.getItem(d);return rr(g)?g.slice():[]},hasShortcut:h=>{const d=nx(h);return e.hasItem(d)},removeShortcutsByKeys:s,removeShortcutsByGroup:h=>{e.getItems().forEach(g=>{let[y,C]=g;const x=C.filter(_=>_.group!==h);x.length===0?s(T4e(y)):(C.length=0,C.push(...x))})}}};function R4e(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const A4e=["meta","alt","shift","control"],Zv=R4e(),ew=[];let ix=0;function O4e(t,e,r,i,s){const n=x=>A4e.includes(x),o=function(x){let _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const E=[];return x.altKey&&E.push("alt"),_&&(x.ctrlKey||x.metaKey)?E.push("control/meta"):(x.ctrlKey&&E.push("control"),x.metaKey&&E.push("meta")),x.shiftKey&&E.push("shift"),E},l=x=>{if(e(x)===!1||r(x)===!1||x.keyCode===229||typeof x.key!="string"||Q0(x))return;const E=NO(x);let R=[];n(E)||(R=o(x));const I=[E].concat(R);!s(x,I)&&(lB()&&R.includes("meta")||!lB()&&R.includes("control"))&&s(x,[E].concat(o(x,!0))),i(x)},h=x=>{if(typeof x.key=="string"){const _=NO(x);n(_)&&Zv.press(_)}},d=x=>{if(typeof x.key=="string"){const _=NO(x);n(_)&&Zv.release(_)}},g=()=>{Zv.releaseAll()};return{mount:()=>{let x=t;for(ix+=1;x;)ix===1&&(x.document.documentElement.addEventListener("keydown",h),ew.push({event:"keydown",listener:h}),x.document.documentElement.addEventListener("keyup",d),ew.push({event:"keyup",listener:d})),x.document.documentElement.addEventListener("keydown",l),x.document.documentElement.addEventListener("blur",g),x=a1(x)},unmount:()=>{let x=t;for(ix-=1;x;){if(ix===0){for(let _=0;_<ew.length;_++){const{event:E,listener:R}=ew[_];x.document.documentElement.removeEventListener(E,R)}ew.length=0}x.document.documentElement.removeEventListener("keydown",l),x.document.documentElement.removeEventListener("blur",g),x=a1(x)}},isPressed:x=>Zv.isPressed(x),releasePressedKeys:()=>Zv.releaseAll()}}const I4e=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:i,afterKeyDown:s}=t;const n=B_({errorIdExists:_=>`The "${_}" context name is already registered.`});let o="grid";const l=_=>{const E=_4e(_);return n.addItem(_,E),E},h=()=>o,d=_=>n.getItem(_),g=_=>{if(!n.hasItem(_))throw new Error(Ln`You've tried to activate the "${_}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=_};let y=!1;const C=function(_,E){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const I=dJ(R)?R:d(R);let F=!1;if(!I.hasShortcut(E))return F;const H=I.getShortcuts(E);for(let z=0;z<H.length;z++){const{callback:q,runOnlyIf:re,preventDefault:Y,stopPropagation:oe,captureCtrl:me,forwardToContext:de}=H[z];if(re(_)===!0){if(y=me,F=q(_,E)===!1,y=!1,Y&&_.preventDefault(),oe&&(jc(_),_.stopPropagation()),F)break;de&&C(_,E,de)}}return F},x=O4e(e,r,i,s,C);return x.mount(),{addContext:l,getActiveContextName:h,getContext:d,setActiveContextName:g,isCtrlPressed:()=>!y&&(x.isPressed("control")||x.isPressed("meta")),releasePressedKeys:()=>x.releasePressedKeys(),destroy:()=>x.unmount()}};function pV(t){const{classNames:e}=ESe(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}let DO=null;const LO=new Map;function gJ(t,e){var r,i=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=this;const o=new $c(n);let l,h,d,g,y,C,x=!0;n_e(s)&&r_e(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const _=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",E=["rtl","ltr"].includes(_)?_:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",E),this.isRtl=function(){return E==="rtl"},this.isLtr=function(){return!n.isRtl()},this.getDirectionFactor=function(){return n.isLtr()?1:-1},e.language=aRe(e.language);const R=new lJ(n,e,[lAe,mAe]),I=R.getTableMeta(),F=R.getGlobalMeta(),H=B_();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),B2(this)&&(qCe(e.licenseKey,t),at(t,"ht-wrapper")),this.guid=`ht_${PX()}`,LO.set(this.guid,this),this.columnIndexMapper=new iF,this.rowIndexMapper=new iF,this.columnIndexMapper.addLocalHook("indexesSequenceChange",A=>{n.runHooks("afterColumnSequenceChange",A)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",A=>{n.runHooks("afterRowSequenceChange",A)}),h=new S_e(n),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const z=A=>{const{row:O,col:k}=A;return n._createCellCoords(O>=0?n.rowIndexMapper.getRenderableFromVisualIndex(O):O,k>=0?n.columnIndexMapper.getRenderableFromVisualIndex(k):k)},q=A=>{const{row:O,col:k}=A;return n._createCellCoords(O>=0?n.rowIndexMapper.getVisualFromRenderableIndex(O):O,k>=0?n.columnIndexMapper.getVisualFromRenderableIndex(k):k)},re=(A,O)=>{const k=O>A?1:-1,L=Math.min(A,O),D=Math.max(A,O),K=n.rowIndexMapper.getNearestNotHiddenIndex(A,k);return K===null||k===1&&K>D||k===-1&&K<L?null:K>=0?n.rowIndexMapper.getRenderableFromVisualIndex(K):K},Y=(A,O)=>{const k=O>A?1:-1,L=Math.min(A,O),D=Math.max(A,O),K=n.columnIndexMapper.getNearestNotHiddenIndex(A,k);return K===null||k===1&&K>D||k===-1&&K<L?null:K>=0?n.columnIndexMapper.getRenderableFromVisualIndex(K):K};let oe=new sJ(I,{rowIndexMapper:n.rowIndexMapper,columnIndexMapper:n.columnIndexMapper,countCols:()=>n.countCols(),countRows:()=>n.countRows(),propToCol:A=>l.propToCol(A),isEditorOpened:()=>n.getActiveEditor()?n.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return i.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return i.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>n.getShortcutManager(),createCellCoords:(A,O)=>n._createCellCoords(A,O),createCellRange:(A,O,k)=>n._createCellRange(A,O,k),visualToRenderableCoords:z,renderableToVisualCoords:q,findFirstNonHiddenRenderableRow:re,findFirstNonHiddenRenderableColumn:Y,isDisabledCellSelection:(A,O)=>A<0||O<0?n.getSettings().disableVisualSelection:n.getCellMeta(A,O).disableVisualSelection});this.selection=oe;const me=A=>{let{hiddenIndexesChanged:O}=A;O&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",me),this.rowIndexMapper.addLocalHook("cacheUpdated",me),this.selection.addLocalHook("afterSetRangeEnd",(A,O)=>{const k=il(!1),L=this.selection.getSelectedRange(),{from:D,to:K}=L.current(),Q=L.size()-1;this.runHooks("afterSelection",D.row,D.col,K.row,K.col,k,Q),this.runHooks("afterSelectionByProp",D.row,n.colToProp(D.col),K.row,n.colToProp(K.col),k,Q),O&&(!k.isTouched()||k.isTouched()&&!k.value)&&C.scrollTo(A);const pe=oe.isSelectedByRowHeader(),ye=oe.isSelectedByColumnHeader();pe&&ye?at(this.rootElement,["ht__selection--rows","ht__selection--columns"]):pe?(_r(this.rootElement,"ht__selection--columns"),at(this.rootElement,"ht__selection--rows")):ye?(_r(this.rootElement,"ht__selection--rows"),at(this.rootElement,"ht__selection--columns")):_r(this.rootElement,["ht__selection--rows","ht__selection--columns"]),oe.getSelectionSource()!=="shift"&&g.closeEditor(null),n.view.render(),g.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",A=>{this.runHooks("beforeSelectionFocusSet",A.row,A.col)}),this.selection.addLocalHook("afterSetFocus",A=>{const O=il(!1);this.runHooks("afterSelectionFocusSet",A.row,A.col,O),(!O.isTouched()||O.isTouched()&&!O.value)&&C.scrollTo(A),g.closeEditor(),n.view.render(),g.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",A=>{const O=A.length-1,{from:k,to:L}=A[O];this.runHooks("afterSelectionEnd",k.row,k.col,L.row,L.col,O),this.runHooks("afterSelectionEndByProp",k.row,n.colToProp(k.col),L.row,n.colToProp(L.col),O)}),this.selection.addLocalHook("afterIsMultipleSelection",A=>{const O=this.runHooks("afterIsMultipleSelection",A.value);A.value&&(A.value=O)}),this.selection.addLocalHook("afterDeselect",()=>{g.closeEditor(),n.view.render(),_r(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeSetRangeStart",...O)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeSetRangeStartOnly",...O)}).addLocalHook("beforeSetRangeEnd",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeSetRangeEnd",...O)}).addLocalHook("beforeSelectColumns",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeSelectColumns",...O)}).addLocalHook("afterSelectColumns",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("afterSelectColumns",...O)}).addLocalHook("beforeSelectRows",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeSelectRows",...O)}).addLocalHook("afterSelectRows",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("afterSelectRows",...O)}).addLocalHook("beforeModifyTransformStart",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("modifyTransformStart",...O)}).addLocalHook("afterModifyTransformStart",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("afterModifyTransformStart",...O)}).addLocalHook("beforeModifyTransformFocus",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("modifyTransformFocus",...O)}).addLocalHook("afterModifyTransformFocus",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("afterModifyTransformFocus",...O)}).addLocalHook("beforeModifyTransformEnd",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("modifyTransformEnd",...O)}).addLocalHook("afterModifyTransformEnd",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("afterModifyTransformEnd",...O)}).addLocalHook("beforeRowWrap",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeRowWrap",...O)}).addLocalHook("beforeColumnWrap",function(){for(var A=arguments.length,O=new Array(A),k=0;k<A;k++)O[k]=arguments[k];return i.runHooks("beforeColumnWrap",...O)}).addLocalHook("insertRowRequire",A=>this.alter("insert_row_above",A,1,"auto")).addLocalHook("insertColRequire",A=>this.alter("insert_col_start",A,1,"auto")),d={alter(A,O){var k,L;let D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,K=arguments.length>3?arguments[3]:void 0,Q=arguments.length>4?arguments[4]:void 0;const pe=ye=>{if(ye.length===0)return[];const j=[...ye];return j.sort((te,we)=>{let[ce]=te,[_e]=we;return ce===_e?0:ce>_e?1:-1}),ha(j,(te,we)=>{let[ce,_e]=we;const Ee=te[te.length-1],[he,Ae]=Ee,Ne=he+Ae;if(ce<=Ne){const Le=Math.max(_e-(Ne-ce),0);Ee[1]+=Le}else te.push([ce,_e]);return te},[j[0]])};switch(A){case"insert_row_below":case"insert_row_above":const ye=n.countSourceRows();if(I.maxRows===ye)return;const j=A==="insert_row_below"?"below":"above";O=(k=O)!==null&&k!==void 0?k:j==="below"?ye:0;const{delta:X,startPhysicalIndex:te}=l.createRow(O,D,{source:K,mode:j});oe.shiftRows(n.toVisualRow(te),X);break;case"insert_col_start":case"insert_col_end":const we=A==="insert_col_end"?"end":"start";O=(L=O)!==null&&L!==void 0?L:we==="end"?n.countSourceCols():0;const{delta:ce,startPhysicalIndex:_e}=l.createCol(O,D,{source:K,mode:we});if(ce){if(Array.isArray(I.colHeaders)){const Ae=[n.toVisualColumn(_e),0];Ae.length+=ce,Array.prototype.splice.apply(I.colHeaders,Ae)}oe.shiftColumns(n.toVisualColumn(_e),ce)}break;case"remove_row":const Ee=Ae=>{let Ne=0;xe(Ae,Le=>{let[Xe,Ft]=Le;const St=Zi(Xe)?n.countRows()-1:Math.max(Xe-Ne,0);if(Number.isInteger(Xe)&&(Xe=Math.max(Xe-Ne,0)),!l.removeRow(Xe,Ft,K))return;if(oe.isSelected()){const{row:hr}=n.getSelectedRangeLast().highlight;hr>=Xe&&hr<=Xe+Ft-1&&g.closeEditor(!0)}const kr=n.countRows();kr===0?oe.deselect():K==="ContextMenu.removeRow"?oe.refresh():oe.shiftRows(Xe,-Ft);const xr=I.fixedRowsTop;xr>=St+1&&(I.fixedRowsTop-=Math.min(Ft,xr-St));const ir=I.fixedRowsBottom;ir&&St>=kr-ir&&(I.fixedRowsBottom-=Math.min(Ft,ir)),Ne+=Ft})};Array.isArray(O)?Ee(pe(O)):Ee([[O,D]]);break;case"remove_col":const he=Ae=>{let Ne=0;xe(Ae,Le=>{let[Xe,Ft]=Le;const St=Zi(Xe)?n.countCols()-1:Math.max(Xe-Ne,0);let zt=n.toPhysicalColumn(St);if(Number.isInteger(Xe)&&(Xe=Math.max(Xe-Ne,0)),!l.removeCol(Xe,Ft,K))return;if(oe.isSelected()){const{col:hr}=n.getSelectedRangeLast().highlight;hr>=Xe&&hr<=Xe+Ft-1&&g.closeEditor(!0)}n.countCols()===0?oe.deselect():K==="ContextMenu.removeColumn"?oe.refresh():oe.shiftColumns(Xe,-Ft);const ir=I.fixedColumnsStart;ir>=St+1&&(I.fixedColumnsStart-=Math.min(Ft,ir-St)),Array.isArray(I.colHeaders)&&(typeof zt>"u"&&(zt=-1),I.colHeaders.splice(zt,Ft)),Ne+=Ft})};Array.isArray(O)?he(pe(O)):he([[O,D]]);break;default:throw new Error(`There is no such action "${A}"`)}n.view.render(),Q||d.adjustRowsAndCols()},adjustRowsAndCols(){const A=I.minRows,O=I.minSpareRows,k=I.minCols,L=I.minSpareCols;if(A){const D=n.countRows();D<A&&l.createRow(D,A-D,{source:"auto"})}if(O){const D=n.countEmptyRows(!0);if(D<O){const K=O-D,Q=Math.min(K,I.maxRows-n.countSourceRows());l.createRow(n.countRows(),Q,{source:"auto"})}}{let D;(k||L)&&(D=n.countEmptyCols(!0));let K=n.countCols();if(k&&!I.columns&&K<k){const Q=k-K;D+=Q,l.createCol(K,Q,{source:"auto"})}if(L&&!I.columns&&n.dataType==="array"&&D<L){K=n.countCols();const Q=L-D,pe=Math.min(Q,I.maxCols-K);l.createCol(K,pe,{source:"auto"})}}n.view&&n.view.adjustElementsSize()},populateFromArray(A,O,k,L,D){let K,Q,pe,ye;const j=[],X={},te=[],we=A.row,ce=A.col;if(Q=O.length,Q===0)return!1;let _e=0,Ee=0;switch(Qr(k)&&(_e=k.col-ce+1,Ee=k.row-we+1),D){case"shift_down":const he=H2(O),Ae=he.length,Ne=Math.max(Ae,_e),Le=n.getData().slice(we),Xe=H2(Le).slice(ce,ce+Ne);for(pe=0;pe<Ne;pe+=1)if(pe<Ae){for(K=0,Q=he[pe].length;K<Ee-Q;K+=1)he[pe].push(he[pe][K%Q]);pe<Xe.length?te.push(he[pe].concat(Xe[pe])):te.push(he[pe].concat(new Array(Le.length).fill(null)))}else te.push(he[pe%Ae].concat(Xe[pe]));n.populateFromArray(we,ce,H2(te));break;case"shift_right":const Ft=O.length,St=Math.max(Ft,Ee),zt=n.getData().slice(we).map(oi=>oi.slice(ce));for(K=0;K<St;K+=1)if(K<Ft){for(pe=0,ye=O[K].length;pe<_e-ye;pe+=1)O[K].push(O[K][pe%ye]);if(K<zt.length)for(let oi=0;oi<zt[K].length;oi+=1)O[K].push(zt[K][oi]);else O[K].push(...new Array(zt[0].length).fill(null))}else O.push(O[K%Q].slice(0,St).concat(zt[K]));n.populateFromArray(we,ce,O);break;case"overwrite":default:X.row=A.row,X.col=A.col;let kr=0,xr=0,ir=!0,hr;const Hn=function(Jn){let $n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Lr=O[Jn%O.length];return $n!==null?Lr[$n%Lr.length]:Lr},xi=O.length,qs=k?k.row-A.row+1:0;for(k?Q=qs:Q=Math.max(xi,qs),K=0;K<Q&&!(k&&X.row>k.row&&qs>xi||!I.allowInsertRow&&X.row>n.countRows()-1||X.row>=I.maxRows);K++){const oi=K-kr,Jn=Hn(oi).length,$n=k?k.col-A.col+1:0;if(k?ye=$n:ye=Math.max(Jn,$n),X.col=A.col,hr=n.getCellMeta(X.row,X.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&hr.skipRowOnPaste){kr+=1,X.row+=1,Q+=1;continue}for(xr=0,pe=0;pe<ye&&!(k&&X.col>k.col&&$n>Jn||!I.allowInsertColumn&&X.col>n.countCols()-1||X.col>=I.maxCols);pe++){if(hr=n.getCellMeta(X.row,X.col),(L==="CopyPaste.paste"||L==="Autofill.fill")&&hr.skipColumnOnPaste){xr+=1,X.col+=1,ye+=1;continue}if(hr.readOnly&&L!=="UndoRedo.undo"){X.col+=1;continue}const Lr=pe-xr;let Nr=Hn(oi,Lr),Ve=n.getDataAtCell(X.row,X.col);if(Nr!==null&&typeof Nr=="object")if(Array.isArray(Nr)&&Ve===null&&(Ve=[]),Ve===null||typeof Ve!="object")ir=!1;else{const ot=rC(Array.isArray(Ve)?Ve:Ve[0]||Ve),It=rC(Array.isArray(Nr)?Nr:Nr[0]||Nr);Yk(ot,It)||Array.isArray(ot)&&Array.isArray(It)?Nr=la(Nr):ir=!1}else Ve!==null&&typeof Ve=="object"&&(ir=!1);ir&&j.push([X.row,X.col,Nr]),ir=!0,X.col+=1}X.row+=1}n.setDataAtCell(j,null,null,L||"populateFromArray");break}}};function de(A){const O=Yq(A);GD(O)?(n.runHooks("beforeLanguageChange",O),F.language=O,n.runHooks("afterLanguageChange",O)):Kq(A)}function Re(A,O){const k=A==="className"?n.rootElement:n.table;if(x)at(k,O);else{let L=[],D=[];F[A]&&(L=Array.isArray(F[A])?F[A]:W9(F[A])),O&&(D=Array.isArray(O)?O:W9(O));const K=V9(L,D),Q=V9(D,L);K.length&&_r(k,K),Q.length&&at(k,Q)}F[A]=O}this.init=function(){h.setData(I.data),n.runHooks("beforeInit"),(od()||oq())&&at(n.rootElement,"mobile"),this.updateSettings(I,!0),this.view=new a_e(this);const A=I.themeName||pV(n.rootElement);n.useTheme(A),n.view.addClassNameToLicenseElement(n.getCurrentThemeName()),g=ZP.getInstance(n,I,oe),C=E4e(n),y=new Qbe(n),B2(this)&&m4e(n),n.runHooks("init"),this.forceFullRender=!0,this.view.render(),x&&n.rootElement.offsetParent===null&&MSe(n.rootElement,()=>{n.view._wt.wtOverlays.updateLastSpreaderSize(),n.render(),n.view.adjustElementsSize()}),typeof x=="object"&&(n.runHooks("afterChange",x[0],x[1]),x=!1),n.runHooks("afterInit")};function Ie(){let A=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,A=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&A===!1&&(A=!0,this.onQueueEmpty(this.valid))}}}function Be(A){const O=A.replace(",",".");return isNaN(parseFloat(O))===!1?parseFloat(O):A}function lt(A,O,k){if(!A.length){k();return}const L=n.getActiveEditor(),D=new Ie;let K=!0;D.onQueueEmpty=()=>{L&&K&&L.cancelChanges(),k()};for(let Q=A.length-1;Q>=0;Q--){const[pe,ye,,j]=A[Q],X=l.propToCol(ye);let te;Number.isInteger(X)?te=n.getCellMeta(pe,X):te={...Object.getPrototypeOf(I),...I},te.type==="numeric"&&typeof j=="string"&&Bxe(j)&&(A[Q][3]=Be(j)),n.getCellValidator(te)&&(D.addValidatorToQueue(),n.validateCell(A[Q][3],te,function(we,ce){return function(_e){if(typeof _e!="boolean")throw new Error("Validation error: result is not boolean");_e===!1&&ce.allowInvalid===!1&&(K=!1,A.splice(we,1),ce.valid=!0),D.removeValidatorFormQueue()}}(Q,te),O))}D.checkIfQueueIsEmpty()}function pt(A,O){for(let L=A.length-1;L>=0;L--){let D=!1;if(A[L]===null){A.splice(L,1);continue}if(!((A[L][2]===null||A[L][2]===void 0)&&(A[L][3]===null||A[L][3]===void 0))){if(I.allowInsertRow)for(;A[L][0]>n.countRows()-1;){const{delta:K}=l.createRow(void 0,void 0,{source:O});if(K===0){D=!0;break}}if(n.dataType==="array"&&(!I.columns||I.columns.length===0)&&I.allowInsertColumn)for(;l.propToCol(A[L][1])>n.countCols()-1;){const{delta:K}=l.createCol(void 0,void 0,{source:O});if(K===0){D=!0;break}}D||l.set(A[L][0],A[L][1],A[L][3])}}const k=A.length>0;if(n.forceFullRender=!0,k){d.adjustRowsAndCols(),n.runHooks("beforeChangeRender",A,O),g.closeEditor(),n.view.render(),g.prepareEditor(),n.view.adjustElementsSize(),n.runHooks("afterChange",A,O||"edit");const L=n.getActiveEditor();L&&rr(L.refreshValue)&&L.refreshValue()}else n.view.render()}this._createCellCoords=function(A,O){return n.view._wt.createCellCoords(A,O)},this._createCellRange=function(A,O,k){return n.view._wt.createCellRange(A,O,k)},this.validateCell=function(A,O,k,L){let D=n.getCellValidator(O);function K(Q){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||O.hidden===!0){k(Q);return}const ye=O.visualCol,j=O.visualRow,X=n.getCell(j,ye,!0);if(X&&X.nodeName!=="TH"){const te=n.rowIndexMapper.getRenderableFromVisualIndex(j),we=n.columnIndexMapper.getRenderableFromVisualIndex(ye);n.view._wt.getSetting("cellRenderer",te,we,X)}k(Q)}YCe(D)&&(D=function(Q){return function(pe,ye){ye(Q.test(pe))}}(D)),ci(D)?(A=n.runHooks("beforeValidate",A,O.visualRow,O.prop,L),n._registerImmediate(()=>{D.call(O,A,Q=>{n&&(Q=n.runHooks("afterValidate",Q,A,O.visualRow,O.prop,L),O.valid=Q,K(Q),n.runHooks("postAfterValidate",Q,A,O.visualRow,O.prop,L))})})):n._registerImmediate(()=>{O.valid=!0,K(O.valid,!1)})};function Ct(A,O,k){return Array.isArray(A)?A:[[A,O,k]]}function ct(A,O){const k=n.getActiveEditor(),L=n.runHooks("beforeChange",A,O||"edit"),D=A.filter(K=>K!==null);return L===!1||D.length===0?(k&&k.cancelChanges(),[]):D}this.setDataAtCell=function(A,O,k,L){const D=Ct(A,O,k),K=[];let Q=L,pe,ye,j;for(pe=0,ye=D.length;pe<ye;pe++){if(typeof D[pe]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof D[pe][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");D[pe][1]>=this.countCols()?j=D[pe][1]:j=l.colToProp(D[pe][1]),K.push([D[pe][0],j,h.getAtCell(this.toPhysicalRow(D[pe][0]),D[pe][1]),D[pe][2]])}!Q&&typeof A=="object"&&(Q=O);const X=ct(K,Q);n.runHooks("afterSetDataAtCell",X,Q),lt(X,Q,()=>{pt(X,Q)})},this.setDataAtRowProp=function(A,O,k,L){const D=Ct(A,O,k),K=[];let Q=L,pe,ye;for(pe=0,ye=D.length;pe<ye;pe++)K.push([D[pe][0],D[pe][1],h.getAtCell(this.toPhysicalRow(D[pe][0]),D[pe][1]),D[pe][2]]);!Q&&typeof A=="object"&&(Q=O);const j=ct(K,L);n.runHooks("afterSetDataAtRowProp",j,Q),lt(j,Q,()=>{pt(j,Q)})},this.listen=function(){n&&!n.isListening()&&(LO.forEach(A=>{n!==A&&A.unlisten()}),DO=n.guid,n.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(DO=null,n.runHooks("afterUnlisten"))},this.isListening=function(){return DO===n.guid},this.destroyEditor=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.closeEditor(A),n.view.render(),O&&oe.isSelected()&&g.prepareEditor()},this.populateFromArray=function(A,O,k,L,D,K,Q){if(!(typeof k=="object"&&typeof k[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const pe=typeof L=="number"?n._createCellCoords(L,D):null;return d.populateFromArray(n._createCellCoords(A,O),k,pe,K,Q)},this.spliceCol=function(A,O,k){for(var L=arguments.length,D=new Array(L>3?L-3:0),K=3;K<L;K++)D[K-3]=arguments[K];return l.spliceCol(A,O,k,...D)},this.spliceRow=function(A,O,k){for(var L=arguments.length,D=new Array(L>3?L-3:0),K=3;K<L;K++)D[K-3]=arguments[K];return l.spliceRow(A,O,k,...D)},this.getSelected=function(){if(oe.isSelected())return on(oe.getSelectedRange(),A=>{let{from:O,to:k}=A;return[O.row,O.col,k.row,k.col]})},this.getSelectedLast=function(){const A=this.getSelected();let O;return A&&A.length>0&&(O=A[A.length-1]),O},this.getSelectedRange=function(){if(oe.isSelected())return Array.from(oe.getSelectedRange())},this.getSelectedRangeLast=function(){const A=this.getSelectedRange();let O;return A&&A.length>0&&(O=A[A.length-1]),O},this.emptySelectedCells=function(A){if(!oe.isSelected()||this.countRows()===0||this.countCols()===0)return;const O=[];xe(oe.getSelectedRange(),k=>{if(k.isSingleHeader())return;const L=k.getTopStartCorner(),D=k.getBottomEndCorner();pr(L.row,D.row,K=>{pr(L.col,D.col,Q=>{this.getCellMeta(K,Q).readOnly||O.push([K,Q,null])})})}),O.length>0&&this.setDataAtCell(O,A)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const A=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(A,0),!this.isRenderSuspended()&&A===this.renderSuspendedCounter&&(this.renderCall?this.render():n.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||n.view.render())},this.batchRender=function(A){this.suspendRender();const O=A();return this.resumeRender(),O},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const O=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(O,0),(!this.isExecutionSuspended()&&O===this.executionSuspendedCounter||A)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const k=A();return this.resumeExecution(O),k},this.batch=function(A){this.suspendRender(),this.suspendExecution();const O=A();return this.resumeExecution(),this.resumeRender(),O},this.refreshDimensions=function(){if(!n.view)return;const{width:A,height:O}=n.view.getLastSize(),{width:k,height:L}=n.rootElement.getBoundingClientRect(),D=k!==A||L!==O;n.runHooks("beforeRefreshDimensions",{width:A,height:O},{width:k,height:L},D)!==!1&&((D||n.view._wt.wtOverlays.scrollableElement===n.rootWindow)&&(n.view.setLastSize(k,L),n.render()),n.runHooks("afterRefreshDimensions",{width:A,height:O},{width:k,height:L},D))},this.updateData=function(A,O){uV(A,k=>{l=k},k=>{l=k,n.columnIndexMapper.fitToLength(this.getInitialColumnCount()),n.rowIndexMapper.fitToLength(this.countSourceRows()),d.adjustRowsAndCols(),oe.refresh()},{hotInstance:n,dataMap:l,dataSource:h,internalSource:"updateData",source:O,metaManager:R,firstRun:x})},this.loadData=function(A,O){uV(A,k=>{l=k},()=>{R.clearCellsCache(),n.initIndexMappers(),d.adjustRowsAndCols(),oe.refresh(),x&&(x=[null,"loadData"])},{hotInstance:n,dataMap:l,dataSource:h,internalSource:"loadData",source:O,metaManager:R,firstRun:x})},this.getInitialColumnCount=function(){const A=I.columns;let O=0;if(Array.isArray(A))O=A.length;else if(ci(A))if(n.dataType==="array"){const k=this.countSourceCols();for(let L=0;L<k;L+=1)A(L)&&(O+=1)}else(n.dataType==="object"||n.dataType==="function")&&(O=l.colToPropCache.length);else if(rr(I.dataSchema)){const k=l.getSchema();O=Array.isArray(k)?k.length:Kk(k)}else O=this.countSourceCols();return O},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(A,O,k,L){return Ai(A)?l.getAll():l.getRange(n._createCellCoords(A,O),n._createCellCoords(k,L),l.DESTINATION_RENDERER)},this.getCopyableText=function(A,O,k,L){return l.getCopyableText(n._createCellCoords(A,O),n._createCellCoords(k,L))},this.getCopyableData=function(A,O){return l.getCopyable(A,l.colToProp(O))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const k=(x?n.loadData:n.updateData).bind(this);let L=!1,D,K;if(rr(A.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(rr(A.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(rr(A.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(D in A)D==="data"||(D==="language"?de(A.language):D==="className"?Re("className",A.className):D==="tableClassName"&&n.table?(Re("tableClassName",A.tableClassName),n.view._wt.wtOverlays.syncOverlayTableClassNames()):Xt.getSingleton().isRegistered(D)||Xt.getSingleton().isDeprecated(D)?ci(A[D])?Xt.getSingleton().addAsFixed(D,A[D],n):Array.isArray(A[D])&&Xt.getSingleton().add(D,A[D],n):!O&&vs(A,D)&&(F[D]=A[D]));A.data===void 0&&I.data===void 0?k(null,"updateSettings"):A.data!==void 0?k(A.data,"updateSettings"):A.columns!==void 0&&(l.createMap(),n.initIndexMappers());const Q=n.countCols(),pe=I.columns;if(pe&&ci(pe)&&(L=!0),(A.cell!==void 0||A.cells!==void 0||A.columns!==void 0)&&R.clearCache(),Q>0)for(D=0,K=0;D<Q;D++){if(pe){const X=L?pe(D):pe[K];X&&R.updateColumnMeta(K,X)}K+=1}rr(A.cell)&&Zr(A.cell,X=>{n.setCellMetaObject(X.row,X.col,X)}),n.runHooks("afterCellMetaReset");let ye=n.rootElement.style.height;ye!==""&&(ye=parseInt(n.rootElement.style.height,10));let j=A.height;if(ci(j)&&(j=j()),O&&n.rootElement.getAttribute("style")&&n.rootElement.setAttribute("data-initialstyle",n.rootElement.getAttribute("style")),j===null){const X=n.rootElement.getAttribute("data-initialstyle");X&&(X.indexOf("height")>-1||X.indexOf("overflow")>-1)?n.rootElement.setAttribute("style",X):(n.rootElement.style.height="",n.rootElement.style.overflow="")}else j!==void 0&&(n.rootElement.style.height=isNaN(j)?`${j}`:`${j}px`,n.rootElement.style.overflow="hidden");if(typeof A.width<"u"){let X=A.width;ci(X)&&(X=X()),n.rootElement.style.width=isNaN(X)?`${X}`:`${X}px`}if(!O){if(n.view){n.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),n.view._wt.exportSettingsAsClassNames();const X=n.getCurrentThemeName(),te=vs(A,"themeName");X&&te&&(n.view.getStylesHandler().removeClassNames(),n.view.removeClassNameFromLicenseElement(X));const we=te&&A.themeName||pV(n.rootElement);n.useTheme(we),n.view.addClassNameToLicenseElement(n.getCurrentThemeName())}n.runHooks("afterUpdateSettings",A)}d.adjustRowsAndCols(),n.view&&!x&&(n.forceFullRender=!0,n.view.render(),n.view._wt.wtOverlays.adjustElementsSize()),!O&&n.view&&(ye===""||j===""||j===void 0)&&ye!==j&&n.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const A=n.getSelectedLast();if(I.getValue){if(ci(I.getValue))return I.getValue.call(n);if(A)return n.getData()[A[0][0]][I.getValue]}else if(A)return n.getDataAtCell(A[0],A[1])},this.getSettings=function(){return I},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(A,O,k,L,D){d.alter(A,O,k,L,D)},this.getCell=function(A,O){let k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,L=O,D=A;if(O>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(O)))return null;L=this.columnIndexMapper.getRenderableFromVisualIndex(O)}if(A>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(A)))return null;D=this.rowIndexMapper.getRenderableFromVisualIndex(A)}return D===null||L===null||D===void 0||L===void 0?null:n.view.getCellAtCoords(n._createCellCoords(D,L),k)},this.getCoords=function(A){const O=this.view._wt.wtTable.getCoords(A);if(O===null)return null;const{row:k,col:L}=O;let D=k,K=L;return k>=0&&(D=this.rowIndexMapper.getVisualFromRenderableIndex(k)),L>=0&&(K=this.columnIndexMapper.getVisualFromRenderableIndex(L)),n._createCellCoords(D,K)},this.colToProp=function(A){return l.colToProp(A)},this.propToCol=function(A){return l.propToCol(A)},this.toVisualRow=A=>this.rowIndexMapper.getVisualFromPhysicalIndex(A),this.toVisualColumn=A=>this.columnIndexMapper.getVisualFromPhysicalIndex(A),this.toPhysicalRow=A=>this.rowIndexMapper.getPhysicalFromVisualIndex(A),this.toPhysicalColumn=A=>this.columnIndexMapper.getPhysicalFromVisualIndex(A),this.getDataAtCell=function(A,O){return l.get(A,l.colToProp(O))},this.getDataAtRowProp=function(A,O){return l.get(A,O)},this.getDataAtCol=function(A){const O=[],k=l.getRange(n._createCellCoords(0,A),n._createCellCoords(I.data.length-1,A),l.DESTINATION_RENDERER);for(let L=0;L<k.length;L+=1)for(let D=0;D<k[L].length;D+=1)O.push(k[L][D]);return O},this.getDataAtProp=function(A){const O=[],k=l.getRange(n._createCellCoords(0,l.propToCol(A)),n._createCellCoords(I.data.length-1,l.propToCol(A)),l.DESTINATION_RENDERER);for(let L=0;L<k.length;L+=1)for(let D=0;D<k[L].length;D+=1)O.push(k[L][D]);return O},this.getSourceData=function(A,O,k,L){let D;return A===void 0?D=h.getData():D=h.getByRange(n._createCellCoords(A,O),n._createCellCoords(k,L)),D},this.getSourceDataArray=function(A,O,k,L){let D;return A===void 0?D=h.getData(!0):D=h.getByRange(n._createCellCoords(A,O),n._createCellCoords(k,L),!0),D},this.getSourceDataAtCol=function(A){return h.getAtColumn(A)},this.setSourceDataAtCell=function(A,O,k,L){const D=Ct(A,O,k),K=this.hasHook("afterSetSourceDataAtCell"),Q=[];K&&xe(D,ye=>{let[j,X,te]=ye;Q.push([j,X,h.getAtCell(j,X),te])}),xe(D,ye=>{let[j,X,te]=ye;h.setAtCell(j,X,te)}),K&&this.runHooks("afterSetSourceDataAtCell",Q,L),this.render();const pe=n.getActiveEditor();pe&&rr(pe.refreshValue)&&pe.refreshValue()},this.getSourceDataAtRow=function(A){return h.getAtRow(A)},this.getSourceDataAtCell=function(A,O){return h.getAtCell(A,O)},this.getDataAtRow=function(A){return l.getRange(n._createCellCoords(A,0),n._createCellCoords(A,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(A,O,k,L){const D=A===void 0?[0,0,this.countRows(),this.countCols()]:[A,O,k,L],[K,Q]=D;let[,,pe,ye]=D,j=null,X=null;pe===void 0&&(pe=K),ye===void 0&&(ye=Q);let te="mixed";return pr(Math.max(Math.min(K,pe),0),Math.max(K,pe),we=>{let ce=!0;return pr(Math.max(Math.min(Q,ye),0),Math.max(Q,ye),_e=>(X=this.getCellMeta(we,_e).type,j?ce=j===X:j=X,ce)),te=ce?X:"mixed",ce}),te},this.removeCellMeta=function(A,O,k){const[L,D]=[this.toPhysicalRow(A),this.toPhysicalColumn(O)];let K=R.getCellMetaKeyValue(L,D,k);n.runHooks("beforeRemoveCellMeta",A,O,k,K)!==!1&&(R.removeCellMeta(L,D,k),n.runHooks("afterRemoveCellMeta",A,O,k,K)),K=null},this.spliceCellsMeta=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var k=arguments.length,L=new Array(k>2?k-2:0),D=2;D<k;D++)L[D-2]=arguments[D];if(L.length>0&&!Array.isArray(L[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");O>0&&R.removeRow(this.toPhysicalRow(A),O),L.length>0&&xe(L.reverse(),K=>{R.createRow(this.toPhysicalRow(A)),xe(K,(Q,pe)=>this.setCellMetaObject(A,pe,Q))}),n.render()},this.setCellMetaObject=function(A,O,k){typeof k=="object"&&Zr(k,(L,D)=>{this.setCellMeta(A,O,D,L)})},this.setCellMeta=function(A,O,k,L){if(n.runHooks("beforeSetCellMeta",A,O,k,L)===!1)return;let K=A,Q=O;A<this.countRows()&&(K=this.toPhysicalRow(A)),O<this.countCols()&&(Q=this.toPhysicalColumn(O)),R.setCellMeta(K,Q,k,L),n.runHooks("afterSetCellMeta",A,O,k,L)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(A,O){let k=this.toPhysicalRow(A),L=this.toPhysicalColumn(O);return k===null&&(k=A),L===null&&(L=O),R.getCellMeta(k,L,{visualRow:A,visualColumn:O})},this.getColumnMeta=function(A){return R.getColumnMeta(this.toPhysicalColumn(A))},this.getCellMetaAtRow=function(A){return R.getCellsMetaAtRow(A)},this.isColumnModificationAllowed=function(){return!(n.dataType==="object"||I.columns)},this.getCellRenderer=function(A,O){const k=typeof A=="number"?n.getCellMeta(A,O).renderer:A.renderer;return typeof k=="string"?rF(k):Ai(k)?rF("text"):k},this.getCellEditor=function(A,O){const k=typeof A=="number"?n.getCellMeta(A,O).editor:A.editor;return typeof k=="string"?QP(k):Ai(k)?QP("text"):k},this.getCellValidator=function(A,O){const k=typeof A=="number"?n.getCellMeta(A,O).validator:A.validator;return typeof k=="string"?n2e(k):k},this.validateCells=function(A){this._validateCells(A)},this.validateRows=function(A,O){if(!Array.isArray(A))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(O,A)},this.validateColumns=function(A,O){if(!Array.isArray(A))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(O,void 0,A)},this._validateCells=function(A,O,k){const L=new Ie;A&&(L.onQueueEmpty=A);let D=n.countRows()-1;for(;D>=0;){if(O!==void 0&&O.indexOf(D)===-1){D-=1;continue}let K=n.countCols()-1;for(;K>=0;){if(k!==void 0&&k.indexOf(K)===-1){K-=1;continue}L.addValidatorToQueue(),n.validateCell(n.getDataAtCell(D,K),n.getCellMeta(D,K),Q=>{if(typeof Q!="boolean")throw new Error("Validation error: result is not boolean");Q===!1&&(L.valid=!1),L.removeValidatorFormQueue()},"validateCells"),K-=1}D-=1}L.checkIfQueueIsEmpty()},this.getRowHeader=function(A){let O=I.rowHeaders,k=A;return k!==void 0&&(k=n.runHooks("modifyRowHeader",k)),k===void 0?(O=[],pr(n.countRows()-1,L=>{O.push(n.getRowHeader(L))})):Array.isArray(O)&&O[k]!==void 0?O=O[k]:ci(O)?O=O(k):O&&typeof O!="string"&&typeof O!="number"&&(O=k+1),O},this.hasRowHeaders=function(){return!!I.rowHeaders},this.hasColHeaders=function(){if(I.colHeaders!==void 0&&I.colHeaders!==null)return!!I.colHeaders;for(let A=0,O=n.countCols();A<O;A++)if(n.getColHeader(A))return!0;return!1},this.getColHeader=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const k=n.runHooks("modifyColHeader",A);if(k===void 0){const pe=[],ye=n.countCols();for(let j=0;j<ye;j++)pe.push(n.getColHeader(j));return pe}let L=I.colHeaders;const D=function(pe){const ye=[],j=n.countCols();let X=0;for(;X<j;X++)ci(I.columns)&&I.columns(X)&&ye.push(X);return ye[pe]},K=n.toPhysicalColumn(k),Q=D(K);return I.colHeaders===!1?L=null:I.columns&&ci(I.columns)&&I.columns(Q)&&I.columns(Q).title?L=I.columns(Q).title:I.columns&&I.columns[K]&&I.columns[K].title?L=I.columns[K].title:Array.isArray(I.colHeaders)&&I.colHeaders[K]!==void 0?L=I.colHeaders[K]:ci(I.colHeaders)?L=I.colHeaders(K):I.colHeaders&&typeof I.colHeaders!="string"&&typeof I.colHeaders!="number"&&(L=p_e(k)),L=n.runHooks("modifyColumnHeaderValue",L,A,O),L},this._getColWidthFromSettings=function(A){let O;if(A>=0&&(O=n.getCellMeta(0,A).width),(O===void 0||O===I.width)&&(O=I.colWidths),O!=null){switch(typeof O){case"object":O=O[A];break;case"function":O=O(A);break}typeof O=="string"&&(O=parseInt(O,10))}return O},this.getColWidth=function(A,O){let k=n._getColWidthFromSettings(A);return k=n.runHooks("modifyColWidth",k,A,O),k===void 0&&(k=u1),k},this._getRowHeightFromSettings=function(A){let O=I.rowHeights;if(O!=null){switch(typeof O){case"object":O=O[A];break;case"function":O=O(A);break}typeof O=="string"&&(O=parseInt(O,10))}return O},this.getRowHeight=function(A,O){let k=n._getRowHeightFromSettings(A);return k=n.runHooks("modifyRowHeight",k,A,O),k},this.countSourceRows=function(){return h.countRows()},this.countSourceCols=function(){return h.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const A=I.maxCols,O=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(A,O)},this.countRenderedRows=function(){return n.view._wt.drawn?n.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return n.view._wt.drawn?n.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return n.view._wt.drawn?n.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return n.view._wt.drawn?n.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=0;return CB(n.countRows()-1,k=>{if(n.isEmptyRow(k))O+=1;else if(A===!0)return!1}),O},this.countEmptyCols=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,O=0;return CB(n.countCols()-1,k=>{if(n.isEmptyCol(k))O+=1;else if(A===!0)return!1}),O},this.isEmptyRow=function(A){return I.isEmptyRow.call(n,A)},this.isEmptyCol=function(A){return I.isEmptyCol.call(n,A)},this.selectCell=function(A,O,k,L){let D=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Ai(A)||Ai(O)?!1:this.selectCells([[A,O,k,L]],D,K)},this.selectCells=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;O===!1&&C.suspend();const L=oe.selectCells(A);return L&&k&&n.listen(),C.resume(),L},this.selectColumns=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,k=arguments.length>2?arguments[2]:void 0;return oe.selectColumns(A,O,k)},this.selectRows=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,k=arguments.length>2?arguments[2]:void 0;return oe.selectRows(A,O,k)},this.deselectCell=function(){oe.deselect()},this.selectAll=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:A,k=arguments.length>2?arguments[2]:void 0;C.skipNextScrollCycle(),oe.selectAll(A,O,k)};const Ue=(A,O)=>A.getNearestNotHiddenIndex(O,1,!0);this.scrollViewportTo=function(A){var O;if(typeof A=="number"){var k;A={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(k=arguments[4])!==null&&k!==void 0?k:!0}}const{row:L,col:D,considerHiddenIndexes:K}=(O=A)!==null&&O!==void 0?O:{};let Q=L,pe=D;if(K===void 0||K){const X=Number.isInteger(L)&&L>=0,te=Number.isInteger(D)&&D>=0,we=X?Ue(this.rowIndexMapper,L):void 0,ce=te?Ue(this.columnIndexMapper,D):void 0;if(we===null||ce===null)return!1;Q=X?n.rowIndexMapper.getRenderableFromVisualIndex(we):L,pe=te?n.columnIndexMapper.getRenderableFromVisualIndex(ce):D}const ye=Number.isInteger(Q),j=Number.isInteger(pe);return ye&&Q>=0&&j&&pe>=0?n.view.scrollViewport(n._createCellCoords(Q,pe),A.horizontalSnap,A.verticalSnap):ye&&Q>=0&&(j&&pe<0||!j)?n.view.scrollViewportVertically(Q,A.verticalSnap):j&&pe>=0&&(ye&&Q<0||!ye)?n.view.scrollViewportHorizontally(pe,A.horizontalSnap):!1},this.scrollToFocusedCell=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",A);const{highlight:O}=this.getSelectedRangeLast();this.scrollViewportTo(O.toObject())?this.view.render():(this.removeHook("afterScroll",A),this._registerImmediate(()=>A()))},this.destroy=function(){if(n._clearTimeouts(),n._clearImmediates(),n.view&&n.view.destroy(),h&&h.destroy(),h=null,this.getShortcutManager().destroy(),R.clearCache(),LO.delete(this.guid),B2(n)){const A=this.rootDocument.querySelector(".hot-display-license-info");A&&A.parentNode.removeChild(A)}Uu(n.rootElement),o.destroy(),g&&g.destroy(),n.batchExecution(()=>{n.rowIndexMapper.unregisterAll(),n.columnIndexMapper.unregisterAll(),H.getItems().forEach(A=>{let[,O]=A;O.destroy()}),H.clear(),n.runHooks("afterDestroy")},!0),Xt.getSingleton().destroy(n),Zr(n,(A,O,k)=>{ci(A)?k[O]=Je(O):O!=="guid"&&(k[O]=null)}),n.isDestroyed=!0,l&&l.destroy(),l=null,d=null,oe=null,g=null,n=null};function Je(A){return()=>{throw new Error(`The "${A}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return n.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return n.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return n.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return n.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return n.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return n.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return n.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return n.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return n.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return n.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return n.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return n.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(A){const O=Hc(A);return O==="UndoRedo"?this.undoRedo:H.getItem(O)},this.getPluginName=function(A){return A===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:H.getId(A)},this.getInstance=function(){return n},this.addHook=function(A,O,k){Xt.getSingleton().add(A,O,n,k)},this.hasHook=function(A){return Xt.getSingleton().has(A,n)||Xt.getSingleton().has(A)},this.addHookOnce=function(A,O,k){Xt.getSingleton().once(A,O,n,k)},this.removeHook=function(A,O){Xt.getSingleton().remove(A,O,n)},this.runHooks=function(A,O,k,L,D,K,Q){return Xt.getSingleton().run(n,A,O,k,L,D,K,Q)},this.getTranslatedPhrase=function(A,O){return eJ(I.language,A,O)},this.toHTML=()=>wB(this),this.toTableElement=()=>{const A=this.rootDocument.createElement("div");return A.insertAdjacentHTML("afterbegin",wB(this)),A.firstElementChild},this.timeouts=[],this.useTheme=A=>{this.view.getStylesHandler().useTheme(A),this.runHooks("afterSetTheme",A,!!x)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(A){let O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=A;typeof k=="function"&&(k=setTimeout(k,O)),this.timeouts.push(k)},this._clearTimeouts=function(){xe(this.timeouts,A=>{clearTimeout(A)})},this.immediates=[],this._registerImmediate=function(A){this.immediates.push(setImmediate(A))},this._clearImmediates=function(){xe(this.immediates,A=>{clearImmediate(A)})},this._getEditorManager=function(){return g},this.isRtl=function(){return n.rootWindow.getComputedStyle(n.rootElement).direction==="rtl"},this.isLtr=function(){return!n.isRtl()},this.getDirectionFactor=function(){return n.isLtr()?1:-1};const Fe=I4e({handleEvent(){return n.isListening()},beforeKeyDown:A=>this.runHooks("beforeKeyDown",A),afterKeyDown:A=>{this.isDestroyed||n.runHooks("afterDocumentKeyDown",A)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",A=>{A.ctrlKey===!1&&A.metaKey===!1&&Fe.releasePressedKeys()}),this.getShortcutManager=function(){return Fe},this.getFocusManager=function(){return y},vq().forEach(A=>{const O=tN(A);H.addItem(A,new O(this))}),d4e(n),Fe.setActiveContextName("grid"),Xt.getSingleton().run(n,"construct")}function vV(t,e,r){t.addEventListener(e,r,!1)}function wV(t,e,r){t.removeEventListener(e,r,!1)}function sx(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function mJ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:y=>y.value,...e},i=t.body,s=t.createTextNode(""),n=t.createElement("span");let o;function l(){var y,C;s.textContent=r.textContent(o),n.style.position="absolute",n.style.fontSize=sx(o).fontSize,n.style.fontFamily=sx(o).fontFamily,n.style.whiteSpace="pre",i.appendChild(n);const x=parseInt(((y=sx(o))===null||y===void 0?void 0:y.paddingInlineStart)||0,10),_=parseInt(((C=sx(o))===null||C===void 0?void 0:C.paddingInlineEnd)||0,10),E=n.clientWidth+2+x+_;i.removeChild(n);const R=o.style;R.height=`${r.minHeight}px`,r.minWidth>E?R.width=`${r.minWidth}px`:E>r.maxWidth?R.width=`${r.maxWidth}px`:R.width=`${E}px`;const I=o.scrollHeight?o.scrollHeight-1:0;r.minHeight>I?R.height=`${r.minHeight}px`:r.maxHeight<I?(R.height=`${r.maxHeight}px`,R.overflowY="visible"):R.height=`${I}px`}function h(){t.defaultView.setTimeout(l,0)}function d(y){if(y&&y.minHeight)if(y.minHeight==="inherit")r.minHeight=o.clientHeight;else{const C=parseInt(y.minHeight,10);isNaN(C)||(r.minHeight=C)}if(y&&y.maxHeight)if(y.maxHeight==="inherit")r.maxHeight=o.clientHeight;else{const C=parseInt(y.maxHeight,10);isNaN(C)||(r.maxHeight=C)}if(y&&y.minWidth)if(y.minWidth==="inherit")r.minWidth=o.clientWidth;else{const C=parseInt(y.minWidth,10);isNaN(C)||(r.minWidth=C)}if(y&&y.maxWidth)if(y.maxWidth==="inherit")r.maxWidth=o.clientWidth;else{const C=parseInt(y.maxWidth,10);isNaN(C)||(r.maxWidth=C)}n.firstChild||(n.className="autoResize",n.style.display="inline-block",n.appendChild(s))}function g(y,C){let x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=y,d(C),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${r.minHeight}px`,o.style.minWidth=`${r.minWidth}px`,o.style.maxWidth=`${r.maxWidth}px`,o.style.overflowY="hidden"),x&&(vV(o,"input",l),vV(o,"keydown",h)),l()}return{init:g,resize:l,unObserve(){wV(o,"input",l),wV(o,"keydown",h)}}}function yV(t,e){const r=GX(e),i=e.value.split(`
`);let s=r,n=0;for(let o=0;o<i.length;o++){const l=i[o];o!==0&&(n+=i[o-1].length+1);const h=n+l.length;if(t==="home"?s=n:t==="end"&&(s=h),r<=h)break}D_(e,s)}function w0(t,e,r){return(e=P4e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P4e(t){var e=F4e(t,"string");return typeof e=="symbol"?e:e+""}function F4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const M4e="ht_editor_visible",ox="ht_editor_hidden",CV="textEditor",k4e="text";class Jg extends N1{static get EDITOR_TYPE(){return k4e}constructor(e){super(e),w0(this,"eventManager",new $c(this)),w0(this,"autoResize",mJ(this.hot.rootDocument)),w0(this,"TEXTAREA",void 0),w0(this,"textareaStyle",void 0),w0(this,"TEXTAREA_PARENT",void 0),w0(this,"textareaParentStyle",void 0),w0(this,"layerClass",void 0),this.eventManager=new $c(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),bSe(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,i,s,n,o){const l=this.state;if(super.prepare(e,r,i,s,n,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=o;h&&!this.isOpened()&&(this.TEXTAREA.value=""),l!==Xi.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Xi.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),D_(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Or(this.TEXTAREA,[["data-hot-input",""],P1(-1)]),at(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),at(this.TEXTAREA_PARENT,"handsontableInputHolder"),Rr(this.TEXTAREA_PARENT,this.layerClass)&&_r(this.TEXTAREA_PARENT,this.layerClass),at(this.TEXTAREA_PARENT,ox),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){ibe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",_r(this.TEXTAREA_PARENT,this.layerClass),at(this.TEXTAREA_PARENT,ox)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;pr(e.length-1,i=>{const s=e[i];if(Rr(s,"handsontableEditor"))return r=!0,!1}),Rr(this.TEXTAREA_PARENT,ox)&&_r(this.TEXTAREA_PARENT,ox),r?(this.layerClass=M4e,at(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),at(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Xi.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:i,width:s,maxWidth:n,height:o,maxHeight:l}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(s,n),minHeight:Math.min(o,l),maxWidth:n,maxHeight:l},!0)}bindEvents(){sq()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Xi.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Xi.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>rr(this.hot.getSelected()),group:CV},s=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(s(),!1),runOnlyIf:n=>!this.hot.selection.isMultiple()&&!n.altKey},{keys:[["Meta","Enter"]],callback:()=>(s(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(s(),!1)},{keys:[["Home"]],callback:(n,o)=>{let[l]=o;yV(l,this.TEXTAREA)}},{keys:[["End"]],callback:(n,o)=>{let[l]=o;yV(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(CV)}}const N4e="base";function tS(t,e,r,i,s,n,o){const l=o.ariaTags,h=[],d=[],g=[],y=[];o.className&&at(e,o.className),o.readOnly?(h.push(o.readOnlyCellClassName),l&&y.push(K9())):l&&g.push(K9()[0]),o.valid===!1&&o.invalidCellClassName?(h.push(o.invalidCellClassName),l&&y.push(X9())):(d.push(o.invalidCellClassName),l&&g.push(X9()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&h.push(o.noWordWrapClassName),!n&&o.placeholder&&h.push(o.placeholderCellClassName),_r(e,d),at(e,h),F1(e,g),Or(e,y)}tS.RENDERER_TYPE=N4e;const D4e="text";function gf(t,e,r,i,s,n,o){tS.apply(this,[t,e,r,i,s,n,o]);let l=n;if(!l&&o.placeholder&&(l=o.placeholder),l=as(l),o.trimWhitespace&&(l=l.trim()),o.rendererTemplate){Uu(e);const h=t.rootDocument.createElement("TEMPLATE");h.setAttribute("bind","{{}}"),h.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(h),h.model=t.getSourceDataAtRow(r),e.appendChild(h)}else Ag(e,l)}gf.RENDERER_TYPE=D4e;const L4e="text",pJ={CELL_TYPE:L4e,editor:Jg,renderer:gf};dc(pJ);sn.editors={BaseEditor:N1};function sn(t,e){const r=new gJ(t,e||{},wN);return r.init(),r}sn.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new gJ(t,e,wN)};sn.DefaultSettings=aJ();sn.hooks=Xt.getSingleton();sn.CellCoords=Ig;sn.CellRange=JC;sn.packageName="handsontable";sn.buildDate="16/12/2024 13:19:38";sn.version="15.0.0";sn.languages={dictionaryKeys:eRe,getLanguageDictionary:Zq,getLanguagesDictionaries:sRe,registerLanguageDictionary:Qq,getTranslatedPhrase:eJ};function cF(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,i=Array(e);r<e;r++)i[r]=t[r];return i}function H4e(t){if(Array.isArray(t))return cF(t)}function $4e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oC(t,e,r){return e=eT(e),G4e(t,vJ()?Reflect.construct(e,r||[],eT(t).constructor):e.apply(t,r))}function f1(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function SV(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,wJ(i.key),i)}}function d1(t,e,r){return e&&SV(t.prototype,e),r&&SV(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function B4e(t,e,r){return(e=wJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eT(t){return eT=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},eT(t)}function aC(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&uF(t,e)}function vJ(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vJ=function(){return!!t})()}function V4e(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function W4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bV(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,i)}return r}function j4e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?bV(Object(r),!0).forEach(function(i){B4e(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):bV(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}function U4e(t,e){if(t==null)return{};var r,i,s=z4e(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(i=0;i<n.length;i++)r=n[i],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(s[r]=t[r])}return s}function z4e(t,e){if(t==null)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;r[i]=t[i]}return r}function G4e(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $4e(t)}function uF(t,e){return uF=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},uF(t,e)}function Y4e(t){return H4e(t)||V4e(t)||X4e(t)||W4e()}function K4e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function wJ(t){var e=K4e(t,"string");return typeof e=="symbol"?e:e+""}function X4e(t,e){if(t){if(typeof t=="string")return cF(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cF(t,e):void 0}}var HO=null,q4e="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",J4e="The Handsontable instance bound to this component was destroyed and cannot be used properly.",tT="global",Q4e="hot-wrapper-editor-container";function Z4e(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function hF(t,e){var r=Cr.Children.toArray(t),i=Cr.Children.count(t),s=null;return i!==0&&(i===1&&r[0].props[e]?s=r[0]:s=r.find(function(n){return n.props[e]!==void 0})),s||null}function yJ(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function CJ(t,e){if(typeof t>"u"||e===null)return null;var r=bJ(e.props,!1);return r.className="".concat(Q4e," ").concat(r.className),UG.createPortal(Cr.createElement("div",Object.assign({},r),e),t.body)}function SJ(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:tT,i=hF(t,"hot-editor"),s=yJ(i);return i?Cr.cloneElement(i,{emitEditorInstance:function(o,l){e.get(s)||e.set(s,new Map);var h=e.get(s);h.set(l??tT,o)},editorColumnScope:r,isEditor:!0}):null}function eOe(t,e){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;r||(r=document),HO||(HO=r.createDocumentFragment());var n=s??r.createElement("DIV");HO.appendChild(n);var o=Cr.cloneElement(t,j4e({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:UG.createPortal(o,n,i),portalContainer:n}}function bJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function tOe(){return typeof window<"u"}var xJ=function(){function t(){f1(this,t)}return d1(t,null,[{key:"getSettings",value:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=i.prevProps,n=s===void 0?{}:s,o=i.isInit,l=o===void 0?!1:o,h=i.initOnlySettingKeys,d=h===void 0?[]:h,g=function(R){return!l&&d.includes(R)?n[R]===r[R]:!1},y={};if(r.settings){var C=r.settings;for(var x in C)C.hasOwnProperty(x)&&!g(x)&&(y[x]=C[x])}for(var _ in r)_!=="settings"&&_!=="children"&&!g(_)&&r.hasOwnProperty(_)&&(y[_]=r[_]);return y}}])}(),rOe=function(t){function e(){return f1(this,e),oC(this,e,arguments)}return aC(e,t),d1(e,[{key:"getSettingsProps",value:function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(s){return!i.internalProps.includes(s)}).reduce(function(s,n){return s[n]=i.props[n],s},{})}},{key:"getLocalEditorElement",value:function(){return SJ(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),s=this.getLocalEditorElement();this.columnSettings=xJ.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),s!==null&&(this.columnSettings.editor=this.props._getEditorClass(s,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),s=CJ(i,this.getLocalEditorElement());return Cr.createElement(Cr.Fragment,null,s)}}])}(Cr.Component),nOe=function(t){function e(){var r;return f1(this,e),r=oC(this,e,arguments),r.state={portals:[]},r}return aC(e,t),d1(e,[{key:"render",value:function(){return Cr.createElement(Cr.Fragment,null,this.state.portals)}}])}(Cr.Component),iOe="15.0.0";function sOe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var EJ={exports:{}},$O,xV;function oOe(){if(xV)return $O;xV=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return $O=t,$O}var BO,EV;function aOe(){if(EV)return BO;EV=1;var t=oOe();function e(){}function r(){}return r.resetWarningCache=e,BO=function(){function s(l,h,d,g,y,C){if(C!==t){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}s.isRequired=s;function n(){return s}var o={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:n,element:s,elementType:s,instanceOf:n,node:s,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:r,resetWarningCache:e};return o.PropTypes=o,o},BO}EJ.exports=aOe()();var lOe=EJ.exports,VO=sOe(lOe),KD=function(t){function e(){var r;return f1(this,e),r=oC(this,e,arguments),r.id=null,r.__hotInstance=null,r.hotElementRef=null,r.columnSettings=[],r.renderersPortalManager=null,r.portalCache=new Map,r.portalContainerCache=new Map,r.renderedCellCache=new Map,r.editorCache=new Map,r.componentRendererColumns=new Map,r}return aC(e,t),d1(e,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(J4e),null)},set:function(i){this.__hotInstance=i}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return tOe()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var s=this;return function(o,l,h,d,g,y,C){var x=s.getRenderedCellCache(),_=s.getPortalContainerCache(),E="".concat(h,"-").concat(d),R=o.guid,I="".concat(R,"-").concat(E),F="".concat(E,"-").concat(R);if(x.has(E)&&(l.innerHTML=x.get(E).innerHTML),l&&!l.getAttribute("ghost-table")){for(var H=s.portalCache.get(F),z=_.get(I);l.firstChild;)l.removeChild(l.firstChild);if(H&&z)l.appendChild(z);else{var q=eOe(i,{TD:l,row:h,col:d,prop:g,value:y,cellProperties:C,isRenderer:!0},l.ownerDocument,F,z),re=q.portal,Y=q.portalContainer;_.set(I,Y),l.appendChild(Y),s.portalCache.set(F,re)}}return x.set(E,l),l}}},{key:"getEditorClass",value:function(i){var s,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:tT,o=yJ(i),l=(s=this.getEditorCache().get(o))===null||s===void 0?void 0:s.get(n);return this.makeEditorClass(l)}},{key:"makeEditorClass",value:function(i){var s=function(n){function o(l){var h;return f1(this,o),h=oC(this,o,[l]),i.hotCustomEditorInstance=h,h.editorComponent=i,h}return aC(o,n),d1(o,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(sn.editors.BaseEditor);return Object.getOwnPropertyNames(sn.editors.BaseEditor.prototype).forEach(function(n){n!=="constructor"&&(s.prototype[n]=function(){for(var o,l=arguments.length,h=new Array(l),d=0;d<l;d++)h[d]=arguments[d];return(o=i[n]).call.apply(o,[i].concat(h))})}),s}},{key:"getGlobalRendererElement",value:function(){return hF(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return SJ(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],l=xJ.getSettings(this.props,{prevProps:n,isInit:s,initOnlySettingKeys:o}),h=this.getGlobalRendererElement(),d=this.getGlobalEditorElement();if(l.columns=this.columnSettings.length?this.columnSettings:l.columns,d)l.editor=this.getEditorClass(d,tT);else{var g;this.props.editor||(g=this.props.settings)!==null&&g!==void 0&&g.editor?l.editor=this.props.editor||this.props.settings.editor:l.editor=QP("text")}if(h)l.renderer=this.getRendererWrapper(h),this.componentRendererColumns.set("global",!0);else{var y;this.props.renderer||(y=this.props.settings)!==null&&y!==void 0&&y.renderer?l.renderer=this.props.renderer||this.props.settings.renderer:l.renderer=rF("text")}return l}},{key:"displayAutoSizeWarning",value:function(i){var s,n;this.hotInstance&&((s=this.hotInstance.getPlugin("autoRowSize"))!==null&&s!==void 0&&s.enabled||(n=this.hotInstance.getPlugin("autoColumnSize"))!==null&&n!==void 0&&n.enabled)&&this.componentRendererColumns.size>0&&Z4e(q4e)}},{key:"setHotColumnSettings",value:function(i,s){this.columnSettings[s]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:Y4e(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,s=this.createNewGlobalSettings(!0);this.hotInstance=new sn.Core(this.hotElementRef,s),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(s)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var s=this.createNewGlobalSettings(!1,i);this.updateHot(s),this.displayAutoSizeWarning(s)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,s=function(g){return g.type===rOe},n=Cr.Children.toArray(this.props.children),o=n.filter(function(d){return s(d)}).map(function(d,g){return Cr.cloneElement(d,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:g,_getChildElementByType:hF.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:d.props.children})}),l=bJ(this.props),h=CJ(this.getOwnerDocument(),this.getGlobalEditorElement());return Cr.createElement(Cr.Fragment,null,Cr.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},l),o),Cr.createElement(nOe,{ref:this.setRenderersPortalManagerRef.bind(this)}),h)}}],[{key:"version",get:function(){return iOe}}])}(Cr.Component);KD.propTypes={style:VO.object,id:VO.string,className:VO.string};var cOe=["children"],TJ=Cr.forwardRef(function(t,e){var r,i=t.children,s=U4e(t,cOe),n=typeof Cr.useId=="function"?Cr.useId():void 0,o=(r=s.id)!==null&&r!==void 0?r:n;return Cr.createElement(KD,Object.assign({id:o},s,{ref:e}),i)});TJ.version=KD.version;Cr.Component;const TV="handsontableEditor",uOe="handsontable";class XD extends Jg{static get EDITOR_TYPE(){return uOe}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),D_(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o);const l=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(d,g){const y=this.getSourceData(g.row,g.col);y!==void 0&&l.setValue(y),l.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Cs(h,o.handsontable),this.htOptions=h}beginEditing(e,r){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const s=this.htEditor.getValue();s!==void 0&&this.setValue(s)}super.finishEditing(e,r,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||this.htEditor.useTheme(e)})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:TV,relativeToGroup:Bd,position:"before"},s=(n,o)=>{const l=this.htEditor;if(n!==void 0&&(n<0||l.flipped&&n>l.countRows()-1?l.deselectCell():l.selectCell(n,0),l.getData().length))return o.preventDefault(),jc(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:n=>{const o=this.htEditor;let l,h;return!o.getSelectedLast()&&o.flipped?l=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(h=o.getSelectedLast()[0],l=Math.max(0,h-1)):(h=o.getSelectedLast()[0],l=h-1)),s(l,n)},preventDefault:!1},{keys:[["ArrowDown"]],callback:n=>{const o=this.htEditor;let l,h;if(!o.getSelectedLast()&&!o.flipped)l=0;else if(o.getSelectedLast()){if(o.flipped)l=o.getSelectedLast()[0]+1;else if(!o.flipped){const d=o.countRows()-1;h=o.getSelectedLast()[0],l=Math.min(d,h+1)}}return s(l,n)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(TV)}}function hOe(t,e,r){fOe(t,e),e.set(t,r)}function fOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ax(t,e,r){return(e=dOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dOe(t){var e=gOe(t,"string");return typeof e=="symbol"?e:e+""}function gOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _V(t,e){return t.get(mOe(t,e))}function mOe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const pOe="autocomplete";var WO=new WeakMap;class qD extends XD{constructor(){super(...arguments),ax(this,"query",null),ax(this,"strippedChoices",[]),ax(this,"rawChoices",[]),hOe(this,WO,this.hot.guid.slice(0,9)),ax(this,"sortByRelevance",function(e,r,i){const s=[],n=[],o=e.length;let l=r.length,h,d,g,y;if(o===0){for(g=0;g<l;g++)n.push(g);return n}for(g=0;g<l;g++){if(d=Y9(as(r[g])),i)y=d.indexOf(e);else{const C=this.cellProperties.locale;y=d.toLocaleLowerCase(C).indexOf(e.toLocaleLowerCase(C))}y!==-1&&(h=d.length-y-o,s.push({baseIndex:g,index:y,charsLeft:h,value:d}))}for(s.sort((C,x)=>{if(x.index===-1)return-1;if(C.index===-1)return 1;if(C.index<x.index)return-1;if(x.index<C.index)return 1;if(C.index===x.index){if(C.charsLeft<x.charsLeft)return-1;if(C.charsLeft>x.charsLeft)return 1}return 0}),g=0,l=s.length;g<l;g++)n.push(s[g].baseIndex);return n})}static get EDITOR_TYPE(){return pOe}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return rr(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),at(this.htContainer,"autocompleteEditor"),at(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Or(this.TEXTAREA,[uSe(),sSe(),DX("listbox"),gSe()])}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.hot.getSettings().ariaTags&&Or(this.TEXTAREA,[jl("false"),mSe(`${_V(WO,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,s=i==null?void 0:i.length,{row:n,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[os(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,autoRowSize:!0,renderer:(l,h,d,g,y,C,x)=>{gf(l,h,d,g,y,C,x);const{filteringCaseSensitive:_,allowHtml:E,locale:R}=this.cellProperties,I=this.query;let F=as(C),H,z;F&&!E&&(H=_===!0?F.indexOf(I):F.toLocaleLowerCase(R).indexOf(I.toLocaleLowerCase(R)),H!==-1&&(z=F.substr(H,I.length),F=F.replace(z,`<strong>${z}</strong>`))),r&&Or(h,[oSe(),...i?[ySe(s)]:[],...i?[CSe(i.indexOf(C)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${g}`]]),h.innerHTML=F},afterSelectionEnd:(l,h)=>{if(r){const d=this.htEditor.getCell(l,h,!0);Or(d,[Wk()]),Or(this.TEXTAREA,...pSe(d.id))}}}),r&&(Or(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Hu()),Or(this.htEditor.rootElement,[NX(),vSe("polite"),wSe("text"),["id",`${_V(WO,this)}-listbox-${n}-${o}`]]),Or(this.TEXTAREA,...jl("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Or(this.TEXTAREA,[jl("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=GX(this.TEXTAREA),i=OSe(this.TEXTAREA),s=this.cellProperties.sortByRelevance,n=this.cellProperties.filter;let o=null,l=null,h=e;s&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),h,this.cellProperties.filteringCaseSensitive));const d=Array.isArray(o)?o.length:0;if(n===!1)d&&(l=o[0]);else{const g=[];for(let y=0,C=h.length;y<C&&!(s&&d<=y);y++)d?g.push(h[o[y]]):g.push(h[y]);l=0,h=g}this.strippedChoices=h,h.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(H2([h])),h.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),D_(this.TEXTAREA,r,r===i?void 0:i)}flipDropdownIfNeeded(){const e=c1(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,i=this.cellProperties.preventOverflow;if(r||!r&&(i||i==="horizontal"))return!1;const s=zs(this.TEXTAREA),n=es(this.TEXTAREA),o=this.getHeight(),l=e.scrollTop,h=es(this.hot.view._wt.wtTable.THEAD),d=zs(e),g=s.top-d.top-h+l,y=e.scrollHeight-g-h-n,C=o>y&&g>y;return C?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(C?g:y,o),C}limitDropdownIfNeeded(e,r){if(r>e){let i=0,s=0,n=0,o=null;do n=this.htEditor.getRowHeight(s)||this.htEditor.view.getDefaultRowHeight(),i+=n,s+=1;while(i<e);o=i-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-o}px`),this.setDropdownHeight(i-n)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.htEditor.getSettings().width+co(this.hot.rootDocument)}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10),i=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:i},(n,o)=>o).reduce((n,o)=>n+this.htEditor.getRowHeight(o),0)+r+1}getWidth(){const e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),r=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+r}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,i=on(e,n=>as(n));return on(i,n=>r?n:Y9(n))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),i={row:r?r.from.row:-1};let s=!1;return e===yr.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(s=!0),e===yr.ARROW_UP&&i.row>-1&&(s=!0),s}onBeforeKeyDown(e){if(obe(e.keyCode)||e.keyCode===yr.BACKSPACE||e.keyCode===yr.DELETE||e.keyCode===yr.INSERT){let r=10;if(e.keyCode===yr.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}const vOe="checkbox";class _J extends N1{static get EDITOR_TYPE(){return vOe}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Rr(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright  2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const ad=()=>window,Nl=()=>window.document,fF=(t,e)=>window.setTimeout(t,e),Su=function(t,e,r,i){t.addEventListener(e,r,!!i)},mh=function(t,e,r,i){t.removeEventListener(e,r,!!i)},wOe=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ua=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},jO=function(t,e){Ua(t,e)||(t.className=t.className===""?e:t.className+" "+e)},UO=function(t,e){t.className=wOe((" "+t.className+" ").replace(" "+e+" "," "))},JD=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ya=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},yOe=function(t){let e=t.getDay();return e===0||e===6},COe=function(t){return t%4===0&&t%100!==0||t%400===0},RV=function(t,e){return[31,COe(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},lx=function(t){Ya(t)&&t.setHours(0,0,0,0)},cx=function(t,e){return t.getTime()===e.getTime()},rT=function(t,e,r){let i,s;for(i in e)s=t[i]!==void 0,s&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Ya(e[i])?r&&(t[i]=new Date(e[i].getTime())):JD(e[i])?r&&(t[i]=e[i].slice(0)):t[i]=rT({},e[i],r):(r||!s)&&(t[i]=e[i]);return t},AV=function(t,e,r){let i=Nl().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=rT(i,r),t.dispatchEvent(i)},OV=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},au={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},IV=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},SOe=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},bOe=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),i=t.getDay(),s=e,n=s-1,o=7,l=function(C){return(C+o-1)%o};t.setDate(r+n-l(i));let h=new Date(t.getFullYear(),0,s),d=24*60*60*1e3,g=(t.getTime()-h.getTime())/d;return 1+Math.round((g-n+l(h.getDay()))/o)},xOe=function(t,e,r,i,s){let n=new Date(i,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(n).isoWeek():bOe(n,s))+"</td>"},EOe=function(t,e,r,i){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},TOe=function(t){return"<tbody>"+t.join("")+"</tbody>"},_Oe=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+IV(t,e)+'">'+IV(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},ROe=function(t,e,r,i,s,n){let o,l,h,d=t._o,g=r===d.minYear,y=r===d.maxYear,C='<div id="'+n+'" class="pika-title" role="heading" aria-live="polite">',x,_,E=!0,R=!0;for(h=[],o=0;o<12;o++)h.push('<option value="'+(r===s?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(g&&o<d.minMonth||y&&o>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[o]+"</option>");for(x='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",JD(d.yearRange)?(o=d.yearRange[0],l=d.yearRange[1]+1):(o=r-d.yearRange,l=1+r+d.yearRange),h=[];o<l&&o<=d.maxYear;o++)o>=d.minYear&&h.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return _='<div class="pika-label">'+r+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?C+=_+x:C+=x+_,g&&(i===0||d.minMonth>=i)&&(E=!1),y&&(i===11||d.maxMonth<=i)&&(R=!1),e===0&&(C+='<button class="pika-prev'+(E?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(C+='<button class="pika-next'+(R?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),C+="</div>"},AOe=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+_Oe(t)+TOe(e)+"</table>"};function dF(t){let e=this,r=e.config(t);e._onMouseDown=function(s){if(!e._v)return;s=s||ad().event;let n=s.target||s.srcElement;if(n)if(Ua(n,"is-disabled")||(Ua(n,"pika-button")&&!Ua(n,"is-empty")&&!Ua(n.parentNode,"is-disabled")?(e.setDate(new Date(n.getAttribute("data-pika-year"),n.getAttribute("data-pika-month"),n.getAttribute("data-pika-day"))),r.bound&&fF(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):Ua(n,"pika-prev")?e.prevMonth():Ua(n,"pika-next")&&e.nextMonth()),Ua(n,"pika-select"))e._c=!0;else if(s.preventDefault)s.preventDefault();else return s.returnValue=!1,!1},e._onChange=function(s){s=s||ad().event;let n=s.target||s.srcElement;n&&(Ua(n,"pika-select-month")?e.gotoMonth(n.value):Ua(n,"pika-select-year")&&e.gotoYear(n.value))},e._onKeyChange=function(s){if(s=s||ad().event,e.isVisible())switch(s.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let s=this.moment(r.field.value,r.format,r.formatStrict);return s&&s.isValid()?s.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(s){let n;s.firedBy!==e&&(n=e._parseFieldValue(),Ya(n)&&e.setDate(n),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let s=Nl().activeElement;do if(Ua(s,"pika-single"))return;while(s=s.parentNode);e._c||(e._b=fF(function(){e.hide()},50)),e._c=!1},e._onClick=function(s){s=s||ad().event;let n=s.target||s.srcElement,o=n;if(n){!hasEventListeners&&Ua(n,"pika-select")&&(n.onchange||(n.setAttribute("onchange","return;"),Su(n,"change",e._onChange)));do if(Ua(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&n!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Nl().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),Su(e.el,"mousedown",e._onMouseDown,!0),Su(e.el,"touchend",e._onMouseDown,!0),Su(e.el,"change",e._onChange),r.keyboardInput&&Su(Nl(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Nl().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),Su(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let i=r.defaultDate;Ya(i)?r.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",Su(r.trigger,"click",e._onInputClick),Su(r.trigger,"focus",e._onInputFocus),Su(r.trigger,"blur",e._onInputBlur)):this.show()}dF.prototype={config:function(t){this._o||(this._o=rT({},au,!0));let e=rT(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,Ya(e.minDate)||(e.minDate=!1),Ya(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),JD(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||au.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ya(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ya(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",AV(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ya(t))return;let r=this._o.minDate,i=this._o.maxDate;Ya(r)&&t<r?t=r:Ya(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),lx(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),AV(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ya(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),s=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=s<r.getTime()||i.getTime()<s}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,s;t==="add"?s=new Date(r.valueOf()+i):t==="subtract"&&(s=new Date(r.valueOf()-i)),this.setDate(s)},adjustCalendars:function(){this.calendars[0]=OV(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=OV({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(lx(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=au.minDate,this._o.minYear=au.minYear,this._o.minMonth=au.minMonth,this._o.startRange=au.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(lx(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=au.maxDate,this._o.maxYear=au.maxYear,this._o.maxMonth=au.maxMonth,this._o.endRange=au.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,i=e.maxYear,s=e.minMonth,n=e.maxMonth,o="",l;this._y<=r&&(this._y=r,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=i&&(this._y=i,!isNaN(n)&&this._m>n&&(this._m=n));for(let h=0;h<e.numberOfMonths;h++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+ROe(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,l)+this.render(this.calendars[h].year,this.calendars[h].month,l)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&fF(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,i,s,n,o,l,h,d,g;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,i=ad().innerWidth||Nl().documentElement.clientWidth,s=ad().innerHeight||Nl().documentElement.clientHeight,n=Nl().body.scrollTop||Nl().documentElement.scrollTop,d=!0,g=!0,h=t.getBoundingClientRect(),o=h.left+ad().pageXOffset,l=h.bottom+ad().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,d=!1),(this._o.reposition&&l+r>s+n||this._o.position.indexOf("top")>-1&&l-r-t.offsetHeight>0)&&(l=l-r-t.offsetHeight,g=!1),o<0&&(o=0),l<0&&(l=0),this.el.style.left=o+"px",this.el.style.top=l+"px",jO(this.el,d?"left-aligned":"right-aligned"),jO(this.el,g?"bottom-aligned":"top-aligned"),UO(this.el,d?"right-aligned":"left-aligned"),UO(this.el,g?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let i=this._o,s=new Date,n=RV(t,e),o=new Date(t,e,1).getDay(),l=[],h=[];lx(s),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let d=e===0?11:e-1,g=e===11?0:e+1,y=e===0?t-1:t,C=e===11?t+1:t,x=RV(y,d),_=n+o,E=_;for(;E>7;)E-=7;_+=7-E;let R=!1;for(let I=0,F=0;I<_;I++){let H=new Date(t,e,1+(I-o)),z=Ya(this._d)?cx(H,this._d):!1,q=cx(H,s),re=i.events.indexOf(H.toDateString())!==-1,Y=I<o||I>=n+o,oe=1+(I-o),me=e,de=t,Re=i.startRange&&cx(i.startRange,H),Ie=i.endRange&&cx(i.endRange,H),Be=i.startRange&&i.endRange&&i.startRange<H&&H<i.endRange,lt=i.minDate&&H<i.minDate||i.maxDate&&H>i.maxDate||i.disableWeekends&&yOe(H)||i.disableDayFn&&i.disableDayFn(H);Y&&(I<o?(oe=x+oe,me=d,de=y):(oe=oe-n,me=g,de=C));let pt={day:oe,month:me,year:de,hasEvent:re,isSelected:z,isToday:q,isDisabled:lt,isEmpty:Y,isStartRange:Re,isEndRange:Ie,isInRange:Be,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&z&&(R=!0),h.push(SOe(pt)),++F===7&&(i.showWeekNumber&&h.unshift(xOe(this,I-o,e,t,i.firstWeekOfYearMinDays)),l.push(EOe(h,i.isRTL,i.pickWholeWeek,R)),h=[],F=0,R=!1)}return AOe(i,l,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),UO(this.el,"is-hidden"),this._o.bound&&(Su(Nl(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&mh(Nl(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),jO(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),mh(this.el,"mousedown",this._onMouseDown,!0),mh(this.el,"touchend",this._onMouseDown,!0),mh(this.el,"change",this._onChange),t.keyboardInput&&mh(Nl(),"keydown",this._onKeyChange),t.field&&(mh(t.field,"change",this._onInputChange),t.bound&&(mh(t.trigger,"click",this._onInputClick),mh(t.trigger,"focus",this._onInputFocus),mh(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function zO(t,e,r){return(e=OOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OOe(t){var e=IOe(t,"string");return typeof e=="symbol"?e:e+""}function IOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RJ="date",PV="dateEditor";class AJ extends Jg{constructor(){super(...arguments),zO(this,"defaultDateFormat","DD/MM/YYYY"),zO(this,"parentDestroyed",!1),zO(this,"$datePicker",null)}static get EDITOR_TYPE(){return RJ}init(){if(typeof mt!="function")throw new Error("You need to include moment.js to your project.");if(typeof dF!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,r)=>{r||(_r(this.datePicker,/ht-theme-.*/g),at(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),at(this.datePicker,"htDatepickerHolder");const e=this.hot.getCurrentThemeName();_r(this.datePicker,/ht-theme-.*/g),at(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",r=>{Rr(r.target,"pika-day")&&this.hideDatepicker(),r.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:PV})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const s=this.hot._getEditorManager();s.closeEditor(),this.hot.view.render(),s.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(PV),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),s=e?aq(e.keyCode):!1;let n;this.datePicker.style.display="block",this.$datePicker=new dF(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(mt),this.$datePicker._onInputFocus=function(){},this.originalValue?(n=this.originalValue,mt(n,r,!0).isValid()&&this.$datePicker.setMoment(mt(n,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!s&&!i&&this.setValue("")):this.cellProperties.defaultDate?(n=this.cellProperties.defaultDate,mt(n,r,!0).isValid()&&this.$datePicker.setMoment(mt(n,r),!0),!s&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&H_(r,this.cellProperties.datePickerConfig);const i=r.onSelect,s=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=n=>{let o=n;isNaN(o.getTime())||(o=mt(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),i&&i()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},r}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Xi.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{wtOverlays:n}=this.hot.view._wt,{wtTable:o}=(r=n.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,l=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),d=s.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),g=s.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=l&&this.row<=h&&this.col>=d&&this.col<=g){const y=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+y.top+es(this.TD)}px`;let C=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?C+=y.right-os(this.datePicker):C+=y.left,this.datePickerStyle.left=`${C}px`}else this.hideDatepicker()}}const POe="dropdown";class QD extends qD{static get EDITOR_TYPE(){return POe}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Xt.getSingleton().add("beforeValidate",function(t,e,r){const i=this.propToCol(r);if(Number.isInteger(i)){const s=this.getCellMeta(e,i);s.editor===QD&&s.strict===void 0&&(s.filter=!1,s.strict=!0)}});const FOe="numeric";class OJ extends Jg{static get EDITOR_TYPE(){return FOe}}function MOe(t,e,r){return(e=kOe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kOe(t){var e=NOe(t,"string");return typeof e=="symbol"?e:e+""}function NOe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const DOe="password";class IJ extends Jg{constructor(){super(...arguments),MOe(this,"autoResize",mJ(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return DOe}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,Uu(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const GO="ht_editor_visible",FV="selectEditor",LOe="select";class PJ extends N1{static get EDITOR_TYPE(){return LOe}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),r=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",r&&e.setAttribute(...Ld()),e.appendChild(this.hot.rootDocument.createTextNode("")),at(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Rr(this.selectWrapper,GO)&&_r(this.selectWrapper,GO),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o);const l=this.cellProperties.selectOptions;let h;typeof l=="function"?h=this.prepareOptions(l(this.row,this.col,this.prop)):h=this.prepareOptions(l),Uu(this.select),Zr(h,(d,g)=>{const y=this.hot.rootDocument.createElement("OPTION");y.value=g,M1(y,d),this.select.appendChild(y)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let i=0,s=e.length;i<s;i++)r[e[i]]=e[i];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Xi.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:i,height:s}=this.getEditedCellRect(),n=this.selectWrapper.style;n.height=`${s}px`,n.width=`${i}px`,n.top=`${e}px`,n[this.hot.isRtl()?"right":"left"]=`${r}px`,n.margin="0px",at(this.selectWrapper,GO)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),i={group:FV};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const s=this.select.selectedIndex-1;s>=0&&(this.select[s].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const s=this.select.selectedIndex+1;s<=this.select.length-1&&(this.select[s].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(FV)}}const HOe="time";class FJ extends Jg{static get EDITOR_TYPE(){return HOe}prepare(e,r,i,s,n,o){super.prepare(e,r,i,s,n,o),this.TEXTAREA.dir="ltr"}}function $Oe(){za(N1),za(qD),za(_J),za(AJ),za(QD),za(XD),za(OJ),za(IJ),za(PJ),za(Jg),za(FJ)}const BOe="html";function ZD(t,e,r,i,s,n,o){tS.apply(this,[t,e,r,i,s,n,o]),M1(e,n??"",!1)}ZD.RENDERER_TYPE=BOe;const VOe="autocomplete";function D1(t,e,r,i,s,n,o){const{rootDocument:l}=t,h=o.allowHtml?ZD:gf,d=l.createElement("DIV"),g=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",g&&d.setAttribute(...Ld()),d.appendChild(l.createTextNode("")),h.apply(this,[t,e,r,i,s,n,o]),e.firstChild||e.appendChild(l.createTextNode("")),e.insertBefore(d,e.firstChild),at(e,"htAutocomplete"),!t.acArrowListener){const y=new $c(t);t.acArrowListener=function(C){Rr(C.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,i),e)},y.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{y.destroy()})}}D1.RENDERER_TYPE=VOe;const WOe="dropdown";function e6(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}e6.RENDERER_TYPE=WOe;const MV=new WeakMap,kV=new WeakMap,jOe="htBadValue",g1="data-row",m1="data-col",UOe="checkboxRenderer",MJ="checkbox";Xt.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:i,type:s,row:n,column:o,prop:l}=e;if(s===MJ){if(i){const{value:h,property:d}=i;let g=r;if(h)g=typeof h=="function"?h(n,o,l,r):h;else if(d){const y=this.getDataAtRowProp(n,d);g=y!==null?y:r}t=g}return t}});function t6(t,e,r,i,s,n,o){const{rootDocument:l}=t,h=t.getSettings().ariaTags;tS.apply(this,[t,e,r,i,s,n,o]),zOe(t);let d=GOe(l);const g=o.label;let y=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),Uu(e),n===o.checkedTemplate||as(n).toLocaleLowerCase(o.locale)===as(o.checkedTemplate).toLocaleLowerCase(o.locale)?d.checked=!0:n===o.uncheckedTemplate||as(n).toLocaleLowerCase(o.locale)===as(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?d.checked=!1:Zi(n)?at(d,"noValue"):(d.style.display="none",at(d,jOe),y=!0),Or(d,[[g1,r],[m1,i]]),h&&Or(d,[WE(d.checked?t.getTranslatedPhrase(UD):t.getTranslatedPhrase(zD)),$X(d.checked),aSe()]),!y&&g){let E="";if(g.value)E=typeof g.value=="function"?g.value.call(this,r,i,s,n):g.value;else if(g.property){const I=t.getDataAtRowProp(r,g.property);E=I!==null?I:""}const R=YOe(l,E,g.separated!==!0);g.position==="before"?g.separated?(e.appendChild(R),e.appendChild(d)):(R.appendChild(d),d=R):(!g.position||g.position==="after")&&(g.separated?(e.appendChild(d),e.appendChild(R)):(R.insertBefore(d,R.firstChild),d=R))}(!g||g&&!g.separated)&&e.appendChild(d),y&&e.appendChild(l.createTextNode("#bad-value#")),MV.has(t)||(MV.set(t,!0),C());function C(){const R=t.getShortcutManager().getContext("grid"),I={group:UOe,relativeToGroup:Bd,position:"before"};R.addShortcuts([{keys:[["space"]],callback:()=>(x(),!_()),runOnlyIf:()=>{var F;return(F=t.getSelectedRangeLast())===null||F===void 0?void 0:F.highlight.isCell()}},{keys:[["enter"]],callback:()=>(x(),!_()),runOnlyIf:()=>{const F=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(F==null?void 0:F.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(x(!0),!_()),runOnlyIf:()=>{var F;return(F=t.getSelectedRangeLast())===null||F===void 0?void 0:F.highlight.isCell()}}],I)}function x(){let E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=t.getSelectedRange(),I=[],F=new Map;let H=[],z=0;if(R){for(let q=0;q<R.length;q++){const{row:re,col:Y}=R[q].getTopStartCorner(),{row:oe,col:me}=R[q].getBottomEndCorner();for(let de=re;de<=oe;de+=1)for(let Re=Y;Re<=me;Re+=1){const Ie=t.getCellMeta(de,Re);if(Ie.hidden)continue;const Be={checkedTemplate:Ie.checkedTemplate,uncheckedTemplate:Ie.uncheckedTemplate};if(Ie.type!=="checkbox"){E===!0&&!Ie.readOnly&&(F.has(I.length)?F.set(I.length,[...F.get(I.length),[de,Re,null]]):F.set(I.length,[[de,Re,null]]));continue}if(Ie.readOnly===!0)continue;typeof Ie.checkedTemplate>"u"&&(Ie.checkedTemplate=!0),typeof Ie.uncheckedTemplate>"u"&&(Ie.uncheckedTemplate=!1);const lt=t.getDataAtCell(de,Re);E===!1?[Ie.checkedTemplate,Ie.checkedTemplate.toString()].includes(lt)?H.push([de,Re,Ie.uncheckedTemplate,Be]):[Ie.uncheckedTemplate,Ie.uncheckedTemplate.toString(),null,void 0].includes(lt)&&H.push([de,Re,Ie.checkedTemplate,Be]):H.push([de,Re,Ie.uncheckedTemplate,Be]),z+=1}I.push(z),z=0}H.every(q=>{let[,,re]=q;return re===H[0][2]})?H=H.map(q=>{let[re,Y,oe]=q;return[re,Y,oe]}):H=H.map(q=>{let[re,Y,,oe]=q;return[re,Y,oe.checkedTemplate]}),H.length>0&&I.forEach((q,re)=>{let Y=H.splice(0,q);F.size&&F.has(re)&&(Y=[...Y,...F.get(re)]),t.setDataAtCell(Y)})}}function _(){const E=t.getSelectedRange();if(E){for(let R=0;R<E.length;R++){const I=E[R].getTopStartCorner(),F=E[R].getBottomEndCorner();for(let H=I.row;H<=F.row;H++)for(let z=I.col;z<=F.col;z++){if(t.getCellMeta(H,z).readOnly)continue;const re=t.getCell(H,z);if(re instanceof HTMLElement&&re.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}t6.RENDERER_TYPE=MJ;function zOe(t){let e=kV.get(t);if(!e){const{rootElement:r}=t;e=new $c(t),e.addEventListener(r,"click",i=>XOe(i,t)),e.addEventListener(r,"mouseup",i=>KOe(i,t)),e.addEventListener(r,"change",i=>qOe(i,t)),kV.set(t,e)}return e}function GOe(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function YOe(t,e,r){const i=t.createElement("label");return i.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,i.appendChild(t.createTextNode(e)),i.cloneNode(!0)}function KOe(t,e){const{target:r}=t;r6(r)&&(!r.hasAttribute(g1)||!r.hasAttribute(m1)||setTimeout(e.listen,10))}function XOe(t,e){const{target:r}=t;if(!r6(r)||!r.hasAttribute(g1)||!r.hasAttribute(m1))return;const i=parseInt(r.getAttribute(g1),10),s=parseInt(r.getAttribute(m1),10);e.getCellMeta(i,s).readOnly&&t.preventDefault()}function qOe(t,e){const{target:r}=t;if(!r6(r)||!r.hasAttribute(g1)||!r.hasAttribute(m1))return;const i=parseInt(r.getAttribute(g1),10),s=parseInt(r.getAttribute(m1),10),n=e.getCellMeta(i,s);if(!n.readOnly){let o=null;t.target.checked?o=n.uncheckedTemplate===void 0?!0:n.checkedTemplate:o=n.uncheckedTemplate===void 0?!1:n.uncheckedTemplate,e.setDataAtCell(i,s,o)}}function r6(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const JOe="handsontable";function n6(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}n6.RENDERER_TYPE=JOe;var QOe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ZOe(t){return t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var YO,NV;function eIe(){return NV||(NV=1,YO={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),YO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var KO,DV;function kJ(){if(DV)return KO;DV=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function r(h,d,g,y,C,x,_){if(!isNaN(+h))return+h;let E="",R=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(R!==h)return-1*r(R,d,g,y,C,x);for(let re=0;re<t.length;re++){let Y=t[re];if(E=h.replace(RegExp(`([0-9 ])(${Y.key})$`),"$1"),E!==h)return r(E,d,g,y,C,x)*Y.factor}if(E=h.replace("%",""),E!==h)return r(E,d,g,y,C,x)/100;let I=parseFloat(h);if(isNaN(I))return;let F=y(I);if(F&&F!=="."&&(E=h.replace(new RegExp(`${e(F)}$`),""),E!==h))return r(E,d,g,y,C,x);let H={};Object.keys(x).forEach(re=>{H[x[re]]=re});let z=Object.keys(H).sort().reverse(),q=z.length;for(let re=0;re<q;re++){let Y=z[re],oe=H[Y];if(E=h.replace(Y,""),E!==h){let me;switch(oe){case"thousand":me=Math.pow(10,3);break;case"million":me=Math.pow(10,6);break;case"billion":me=Math.pow(10,9);break;case"trillion":me=Math.pow(10,12);break}return r(E,d,g,y,C,x)*me}}}function i(h,d,g){let y=h.replace(g,"");return y=y.replace(new RegExp(`([0-9])${e(d.thousands)}([0-9])`,"g"),"$1$2"),y=y.replace(d.decimal,"."),y}function s(h,d,g="",y,C,x,_){if(h==="")return;if(h===C)return 0;let E=i(h,d,g);return r(E,d,g,y,C,x)}function n(h,d){if(!(h.indexOf(":")&&d.thousands!==":"))return!1;let y=h.split(":");if(y.length!==3)return!1;let C=+y[0],x=+y[1],_=+y[2];return!isNaN(C)&&!isNaN(x)&&!isNaN(_)}function o(h){let d=h.split(":"),g=+d[0],y=+d[1];return+d[2]+60*y+3600*g}function l(h,d){const g=o6();let y=g.currentDelimiters(),C=g.currentCurrency().symbol,x=g.currentOrdinal(),_=g.getZeroFormat(),E=g.currentAbbreviations(),R;if(typeof h=="string")n(h,y)?R=o(h):R=s(h,y,C,x,_,E);else if(typeof h=="number")R=h;else return;if(R!==void 0)return R}return KO={unformat:l},KO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var XO,LV;function i6(){if(LV)return XO;LV=1;let t=kJ();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,r=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],s=["prefix","infix","postfix"],n=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},d={output:{type:"string",validValues:r},base:{type:"string",validValues:["decimal","binary","general"],restriction:(R,I)=>I.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:R=>R.output==="byte"},characteristic:{type:"number",restriction:R=>R>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(R,I)=>I.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:s},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:R=>R>=0,message:"value must be positive"},{restriction:(R,I)=>!I.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:R=>R>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:n},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(R,I)=>I.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:R=>R.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function y(R,I){let F=C(R),H=_(I);return F&&H}function C(R){return t.unformat(R)!==void 0}function x(R,I,F,H=!1){let z=Object.keys(R).map(q=>{if(!I[q])return console.error(`${F} Invalid key: ${q}`),!1;let re=R[q],Y=I[q];if(typeof Y=="string"&&(Y={type:Y}),Y.type==="format"){if(!x(re,d,`[Validate ${q}]`,!0))return!1}else if(typeof re!==Y.type)return console.error(`${F} ${q} type mismatched: "${Y.type}" expected, "${typeof re}" provided`),!1;if(Y.restrictions&&Y.restrictions.length){let oe=Y.restrictions.length;for(let me=0;me<oe;me++){let{restriction:de,message:Re}=Y.restrictions[me];if(!de(re,R))return console.error(`${F} ${q} invalid value: ${Re}`),!1}}return Y.restriction&&!Y.restriction(re,R)?(console.error(`${F} ${q} invalid value: ${Y.message}`),!1):Y.validValues&&Y.validValues.indexOf(re)===-1?(console.error(`${F} ${q} invalid value: must be among ${JSON.stringify(Y.validValues)}, "${re}" provided`),!1):!(Y.children&&!x(re,Y.children,`[Validate ${q}]`))});return H||z.push(...Object.keys(I).map(q=>{let re=I[q];if(typeof re=="string"&&(re={type:re}),re.mandatory){let Y=re.mandatory;if(typeof Y=="function"&&(Y=Y(R)),Y&&R[q]===void 0)return console.error(`${F} Missing mandatory key "${q}"`),!1}return!0})),z.reduce((q,re)=>q&&re,!0)}function _(R){return x(R,d,"[Validate format]")}function E(R){return x(R,g,"[Validate language]")}return XO={validate:y,validateFormat:_,validateInput:C,validateLanguage:E},XO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function tIe(t,e){let r=t.match(/^{([^}]*)}/);return r?(e.prefix=r[1],t.slice(r[0].length)):t}function rIe(t,e){let r=t.match(/{([^}]*)}$/);return r?(e.postfix=r[1],t.slice(0,-r[0].length)):t}function nIe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function iIe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function sIe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function oIe(t,e){let r=t.match(/[1-9]+[0-9]*/);r&&(e.totalLength=+r[0])}function aIe(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function lIe(t,e){let r=t.split(".")[1];if(r){let i=r.match(/0+/);i&&(e.mantissa=i[0].length)}}function cIe(t,e){const r=t.split(".")[1];r&&(e.trimMantissa=r.indexOf("[")!==-1)}function uIe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function hIe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function fIe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function dIe(t,e){if(t.indexOf(".")!==-1){let r=t.split(".")[0];e.optionalCharacteristic=r.indexOf("0")===-1}}function gIe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function mIe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function pIe(t,e={}){return typeof t!="string"?t:(t=tIe(t,e),t=rIe(t,e),nIe(t,e),oIe(t,e),aIe(t,e),dIe(t,e),uIe(t,e),hIe(t,e),lIe(t,e),fIe(t,e),cIe(t,e),iIe(t,e),sIe(t,e),gIe(t,e),mIe(t,e),e)}var s6={parseFormat:pIe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var qO,HV;function o6(){if(HV)return qO;HV=1;const t=eIe(),e=i6(),r=s6;let i={},s,n={},o=null,l={};function h(g){s=g}function d(){return n[s]}return i.languages=()=>Object.assign({},n),i.currentLanguage=()=>s,i.currentBytes=()=>d().bytes||{},i.currentCurrency=()=>d().currency,i.currentAbbreviations=()=>d().abbreviations,i.currentDelimiters=()=>d().delimiters,i.currentOrdinal=()=>d().ordinal,i.currentDefaults=()=>Object.assign({},d().defaults,l),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().timeFormat),i.setDefaults=g=>{g=r.parseFormat(g),e.validateFormat(g)&&(l=g)},i.getZeroFormat=()=>o,i.setZeroFormat=g=>o=typeof g=="string"?g:null,i.hasZeroFormat=()=>o!==null,i.languageData=g=>{if(g){if(n[g])return n[g];throw new Error(`Unknown tag "${g}"`)}return d()},i.registerLanguage=(g,y=!1)=>{if(!e.validateLanguage(g))throw new Error("Invalid language data");n[g.languageTag]=g,y&&h(g.languageTag)},i.setLanguage=(g,y=t.languageTag)=>{if(!n[g]){let C=g.split("-")[0],x=Object.keys(n).find(_=>_.split("-")[0]===C);if(!n[x]){h(y);return}h(x);return}h(g)},i.registerLanguage(t),s=t.languageTag,qO=i,qO}function vIe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function wIe(t,e){t.forEach(r=>{let i;try{i=vIe(`../languages/${r}`)}catch{console.error(`Unable to load "${r}". No matching language file found.`)}i&&e.registerLanguage(i)})}var yIe=t=>({loadLanguagesInNode:e=>wIe(e,t)}),NJ={exports:{}};(function(t){(function(e){var r,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,n=Math.floor,o="[BigNumber Error] ",l=o+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,g=9007199254740991,y=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],C=1e7,x=1e9;function _(re){var Y,oe,me,de=L.prototype={constructor:L,toString:null,valueOf:null},Re=new L(1),Ie=20,Be=4,lt=-7,pt=21,Ct=-1e7,ct=1e7,Ue=!1,Je=1,Fe=0,A={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},O="0123456789abcdefghijklmnopqrstuvwxyz",k=!0;function L(j,X){var te,we,ce,_e,Ee,he,Ae,Ne,Le=this;if(!(Le instanceof L))return new L(j,X);if(X==null){if(j&&j._isBigNumber===!0){Le.s=j.s,!j.c||j.e>ct?Le.c=Le.e=null:j.e<Ct?Le.c=[Le.e=0]:(Le.e=j.e,Le.c=j.c.slice());return}if((he=typeof j=="number")&&j*0==0){if(Le.s=1/j<0?(j=-j,-1):1,j===~~j){for(_e=0,Ee=j;Ee>=10;Ee/=10,_e++);_e>ct?Le.c=Le.e=null:(Le.e=_e,Le.c=[j]);return}Ne=String(j)}else{if(!i.test(Ne=String(j)))return me(Le,Ne,he);Le.s=Ne.charCodeAt(0)==45?(Ne=Ne.slice(1),-1):1}(_e=Ne.indexOf("."))>-1&&(Ne=Ne.replace(".","")),(Ee=Ne.search(/e/i))>0?(_e<0&&(_e=Ee),_e+=+Ne.slice(Ee+1),Ne=Ne.substring(0,Ee)):_e<0&&(_e=Ne.length)}else{if(F(X,2,O.length,"Base"),X==10&&k)return Le=new L(j),pe(Le,Ie+Le.e+1,Be);if(Ne=String(j),he=typeof j=="number"){if(j*0!=0)return me(Le,Ne,he,X);if(Le.s=1/j<0?(Ne=Ne.slice(1),-1):1,L.DEBUG&&Ne.replace(/^0\.0*|\./,"").length>15)throw Error(l+j)}else Le.s=Ne.charCodeAt(0)===45?(Ne=Ne.slice(1),-1):1;for(te=O.slice(0,X),_e=Ee=0,Ae=Ne.length;Ee<Ae;Ee++)if(te.indexOf(we=Ne.charAt(Ee))<0){if(we=="."){if(Ee>_e){_e=Ae;continue}}else if(!ce&&(Ne==Ne.toUpperCase()&&(Ne=Ne.toLowerCase())||Ne==Ne.toLowerCase()&&(Ne=Ne.toUpperCase()))){ce=!0,Ee=-1,_e=0;continue}return me(Le,String(j),he,X)}he=!1,Ne=oe(Ne,X,10,Le.s),(_e=Ne.indexOf("."))>-1?Ne=Ne.replace(".",""):_e=Ne.length}for(Ee=0;Ne.charCodeAt(Ee)===48;Ee++);for(Ae=Ne.length;Ne.charCodeAt(--Ae)===48;);if(Ne=Ne.slice(Ee,++Ae)){if(Ae-=Ee,he&&L.DEBUG&&Ae>15&&(j>g||j!==n(j)))throw Error(l+Le.s*j);if((_e=_e-Ee-1)>ct)Le.c=Le.e=null;else if(_e<Ct)Le.c=[Le.e=0];else{if(Le.e=_e,Le.c=[],Ee=(_e+1)%d,_e<0&&(Ee+=d),Ee<Ae){for(Ee&&Le.c.push(+Ne.slice(0,Ee)),Ae-=d;Ee<Ae;)Le.c.push(+Ne.slice(Ee,Ee+=d));Ee=d-(Ne=Ne.slice(Ee)).length}else Ee-=Ae;for(;Ee--;Ne+="0");Le.c.push(+Ne)}}else Le.c=[Le.e=0]}L.clone=_,L.ROUND_UP=0,L.ROUND_DOWN=1,L.ROUND_CEIL=2,L.ROUND_FLOOR=3,L.ROUND_HALF_UP=4,L.ROUND_HALF_DOWN=5,L.ROUND_HALF_EVEN=6,L.ROUND_HALF_CEIL=7,L.ROUND_HALF_FLOOR=8,L.EUCLID=9,L.config=L.set=function(j){var X,te;if(j!=null)if(typeof j=="object"){if(j.hasOwnProperty(X="DECIMAL_PLACES")&&(te=j[X],F(te,0,x,X),Ie=te),j.hasOwnProperty(X="ROUNDING_MODE")&&(te=j[X],F(te,0,8,X),Be=te),j.hasOwnProperty(X="EXPONENTIAL_AT")&&(te=j[X],te&&te.pop?(F(te[0],-x,0,X),F(te[1],0,x,X),lt=te[0],pt=te[1]):(F(te,-x,x,X),lt=-(pt=te<0?-te:te))),j.hasOwnProperty(X="RANGE"))if(te=j[X],te&&te.pop)F(te[0],-x,-1,X),F(te[1],1,x,X),Ct=te[0],ct=te[1];else if(F(te,-x,x,X),te)Ct=-(ct=te<0?-te:te);else throw Error(o+X+" cannot be zero: "+te);if(j.hasOwnProperty(X="CRYPTO"))if(te=j[X],te===!!te)if(te)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Ue=te;else throw Ue=!te,Error(o+"crypto unavailable");else Ue=te;else throw Error(o+X+" not true or false: "+te);if(j.hasOwnProperty(X="MODULO_MODE")&&(te=j[X],F(te,0,9,X),Je=te),j.hasOwnProperty(X="POW_PRECISION")&&(te=j[X],F(te,0,x,X),Fe=te),j.hasOwnProperty(X="FORMAT"))if(te=j[X],typeof te=="object")A=te;else throw Error(o+X+" not an object: "+te);if(j.hasOwnProperty(X="ALPHABET"))if(te=j[X],typeof te=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(te))k=te.slice(0,10)=="0123456789",O=te;else throw Error(o+X+" invalid: "+te)}else throw Error(o+"Object expected: "+j);return{DECIMAL_PLACES:Ie,ROUNDING_MODE:Be,EXPONENTIAL_AT:[lt,pt],RANGE:[Ct,ct],CRYPTO:Ue,MODULO_MODE:Je,POW_PRECISION:Fe,FORMAT:A,ALPHABET:O}},L.isBigNumber=function(j){if(!j||j._isBigNumber!==!0)return!1;if(!L.DEBUG)return!0;var X,te,we=j.c,ce=j.e,_e=j.s;e:if({}.toString.call(we)=="[object Array]"){if((_e===1||_e===-1)&&ce>=-x&&ce<=x&&ce===n(ce)){if(we[0]===0){if(ce===0&&we.length===1)return!0;break e}if(X=(ce+1)%d,X<1&&(X+=d),String(we[0]).length==X){for(X=0;X<we.length;X++)if(te=we[X],te<0||te>=h||te!==n(te))break e;if(te!==0)return!0}}}else if(we===null&&ce===null&&(_e===null||_e===1||_e===-1))return!0;throw Error(o+"Invalid BigNumber: "+j)},L.maximum=L.max=function(){return K(arguments,-1)},L.minimum=L.min=function(){return K(arguments,1)},L.random=function(){var j=9007199254740992,X=Math.random()*j&2097151?function(){return n(Math.random()*j)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(te){var we,ce,_e,Ee,he,Ae=0,Ne=[],Le=new L(Re);if(te==null?te=Ie:F(te,0,x),Ee=s(te/d),Ue)if(crypto.getRandomValues){for(we=crypto.getRandomValues(new Uint32Array(Ee*=2));Ae<Ee;)he=we[Ae]*131072+(we[Ae+1]>>>11),he>=9e15?(ce=crypto.getRandomValues(new Uint32Array(2)),we[Ae]=ce[0],we[Ae+1]=ce[1]):(Ne.push(he%1e14),Ae+=2);Ae=Ee/2}else if(crypto.randomBytes){for(we=crypto.randomBytes(Ee*=7);Ae<Ee;)he=(we[Ae]&31)*281474976710656+we[Ae+1]*1099511627776+we[Ae+2]*4294967296+we[Ae+3]*16777216+(we[Ae+4]<<16)+(we[Ae+5]<<8)+we[Ae+6],he>=9e15?crypto.randomBytes(7).copy(we,Ae):(Ne.push(he%1e14),Ae+=7);Ae=Ee/7}else throw Ue=!1,Error(o+"crypto unavailable");if(!Ue)for(;Ae<Ee;)he=X(),he<9e15&&(Ne[Ae++]=he%1e14);for(Ee=Ne[--Ae],te%=d,Ee&&te&&(he=y[d-te],Ne[Ae]=n(Ee/he)*he);Ne[Ae]===0;Ne.pop(),Ae--);if(Ae<0)Ne=[_e=0];else{for(_e=-1;Ne[0]===0;Ne.splice(0,1),_e-=d);for(Ae=1,he=Ne[0];he>=10;he/=10,Ae++);Ae<d&&(_e-=d-Ae)}return Le.e=_e,Le.c=Ne,Le}}(),L.sum=function(){for(var j=1,X=arguments,te=new L(X[0]);j<X.length;)te=te.plus(X[j++]);return te},oe=function(){var j="0123456789";function X(te,we,ce,_e){for(var Ee,he=[0],Ae,Ne=0,Le=te.length;Ne<Le;){for(Ae=he.length;Ae--;he[Ae]*=we);for(he[0]+=_e.indexOf(te.charAt(Ne++)),Ee=0;Ee<he.length;Ee++)he[Ee]>ce-1&&(he[Ee+1]==null&&(he[Ee+1]=0),he[Ee+1]+=he[Ee]/ce|0,he[Ee]%=ce)}return he.reverse()}return function(te,we,ce,_e,Ee){var he,Ae,Ne,Le,Xe,Ft,St,zt,kr=te.indexOf("."),xr=Ie,ir=Be;for(kr>=0&&(Le=Fe,Fe=0,te=te.replace(".",""),zt=new L(we),Ft=zt.pow(te.length-kr),Fe=Le,zt.c=X(q(R(Ft.c),Ft.e,"0"),10,ce,j),zt.e=zt.c.length),St=X(te,we,ce,Ee?(he=O,j):(he=j,O)),Ne=Le=St.length;St[--Le]==0;St.pop());if(!St[0])return he.charAt(0);if(kr<0?--Ne:(Ft.c=St,Ft.e=Ne,Ft.s=_e,Ft=Y(Ft,zt,xr,ir,ce),St=Ft.c,Xe=Ft.r,Ne=Ft.e),Ae=Ne+xr+1,kr=St[Ae],Le=ce/2,Xe=Xe||Ae<0||St[Ae+1]!=null,Xe=ir<4?(kr!=null||Xe)&&(ir==0||ir==(Ft.s<0?3:2)):kr>Le||kr==Le&&(ir==4||Xe||ir==6&&St[Ae-1]&1||ir==(Ft.s<0?8:7)),Ae<1||!St[0])te=Xe?q(he.charAt(1),-xr,he.charAt(0)):he.charAt(0);else{if(St.length=Ae,Xe)for(--ce;++St[--Ae]>ce;)St[Ae]=0,Ae||(++Ne,St=[1].concat(St));for(Le=St.length;!St[--Le];);for(kr=0,te="";kr<=Le;te+=he.charAt(St[kr++]));te=q(te,Ne,he.charAt(0))}return te}}(),Y=function(){function j(we,ce,_e){var Ee,he,Ae,Ne,Le=0,Xe=we.length,Ft=ce%C,St=ce/C|0;for(we=we.slice();Xe--;)Ae=we[Xe]%C,Ne=we[Xe]/C|0,Ee=St*Ae+Ne*Ft,he=Ft*Ae+Ee%C*C+Le,Le=(he/_e|0)+(Ee/C|0)+St*Ne,we[Xe]=he%_e;return Le&&(we=[Le].concat(we)),we}function X(we,ce,_e,Ee){var he,Ae;if(_e!=Ee)Ae=_e>Ee?1:-1;else for(he=Ae=0;he<_e;he++)if(we[he]!=ce[he]){Ae=we[he]>ce[he]?1:-1;break}return Ae}function te(we,ce,_e,Ee){for(var he=0;_e--;)we[_e]-=he,he=we[_e]<ce[_e]?1:0,we[_e]=he*Ee+we[_e]-ce[_e];for(;!we[0]&&we.length>1;we.splice(0,1));}return function(we,ce,_e,Ee,he){var Ae,Ne,Le,Xe,Ft,St,zt,kr,xr,ir,hr,Hn,xi,qs,oi,Jn,$n,Lr=we.s==ce.s?1:-1,Nr=we.c,Ve=ce.c;if(!Nr||!Nr[0]||!Ve||!Ve[0])return new L(!we.s||!ce.s||(Nr?Ve&&Nr[0]==Ve[0]:!Ve)?NaN:Nr&&Nr[0]==0||!Ve?Lr*0:Lr/0);for(kr=new L(Lr),xr=kr.c=[],Ne=we.e-ce.e,Lr=_e+Ne+1,he||(he=h,Ne=E(we.e/d)-E(ce.e/d),Lr=Lr/d|0),Le=0;Ve[Le]==(Nr[Le]||0);Le++);if(Ve[Le]>(Nr[Le]||0)&&Ne--,Lr<0)xr.push(1),Xe=!0;else{for(qs=Nr.length,Jn=Ve.length,Le=0,Lr+=2,Ft=n(he/(Ve[0]+1)),Ft>1&&(Ve=j(Ve,Ft,he),Nr=j(Nr,Ft,he),Jn=Ve.length,qs=Nr.length),xi=Jn,ir=Nr.slice(0,Jn),hr=ir.length;hr<Jn;ir[hr++]=0);$n=Ve.slice(),$n=[0].concat($n),oi=Ve[0],Ve[1]>=he/2&&oi++;do{if(Ft=0,Ae=X(Ve,ir,Jn,hr),Ae<0){if(Hn=ir[0],Jn!=hr&&(Hn=Hn*he+(ir[1]||0)),Ft=n(Hn/oi),Ft>1)for(Ft>=he&&(Ft=he-1),St=j(Ve,Ft,he),zt=St.length,hr=ir.length;X(St,ir,zt,hr)==1;)Ft--,te(St,Jn<zt?$n:Ve,zt,he),zt=St.length,Ae=1;else Ft==0&&(Ae=Ft=1),St=Ve.slice(),zt=St.length;if(zt<hr&&(St=[0].concat(St)),te(ir,St,hr,he),hr=ir.length,Ae==-1)for(;X(Ve,ir,Jn,hr)<1;)Ft++,te(ir,Jn<hr?$n:Ve,hr,he),hr=ir.length}else Ae===0&&(Ft++,ir=[0]);xr[Le++]=Ft,ir[0]?ir[hr++]=Nr[xi]||0:(ir=[Nr[xi]],hr=1)}while((xi++<qs||ir[0]!=null)&&Lr--);Xe=ir[0]!=null,xr[0]||xr.splice(0,1)}if(he==h){for(Le=1,Lr=xr[0];Lr>=10;Lr/=10,Le++);pe(kr,_e+(kr.e=Le+Ne*d-1)+1,Ee,Xe)}else kr.e=Ne,kr.r=+Xe;return kr}}();function D(j,X,te,we){var ce,_e,Ee,he,Ae;if(te==null?te=Be:F(te,0,8),!j.c)return j.toString();if(ce=j.c[0],Ee=j.e,X==null)Ae=R(j.c),Ae=we==1||we==2&&(Ee<=lt||Ee>=pt)?z(Ae,Ee):q(Ae,Ee,"0");else if(j=pe(new L(j),X,te),_e=j.e,Ae=R(j.c),he=Ae.length,we==1||we==2&&(X<=_e||_e<=lt)){for(;he<X;Ae+="0",he++);Ae=z(Ae,_e)}else if(X-=Ee,Ae=q(Ae,_e,"0"),_e+1>he){if(--X>0)for(Ae+=".";X--;Ae+="0");}else if(X+=_e-he,X>0)for(_e+1==he&&(Ae+=".");X--;Ae+="0");return j.s<0&&ce?"-"+Ae:Ae}function K(j,X){for(var te,we,ce=1,_e=new L(j[0]);ce<j.length;ce++)we=new L(j[ce]),(!we.s||(te=I(_e,we))===X||te===0&&_e.s===X)&&(_e=we);return _e}function Q(j,X,te){for(var we=1,ce=X.length;!X[--ce];X.pop());for(ce=X[0];ce>=10;ce/=10,we++);return(te=we+te*d-1)>ct?j.c=j.e=null:te<Ct?j.c=[j.e=0]:(j.e=te,j.c=X),j}me=function(){var j=/^(-?)0([xbo])(?=\w[\w.]*$)/i,X=/^([^.]+)\.$/,te=/^\.([^.]+)$/,we=/^-?(Infinity|NaN)$/,ce=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(_e,Ee,he,Ae){var Ne,Le=he?Ee:Ee.replace(ce,"");if(we.test(Le))_e.s=isNaN(Le)?null:Le<0?-1:1;else{if(!he&&(Le=Le.replace(j,function(Xe,Ft,St){return Ne=(St=St.toLowerCase())=="x"?16:St=="b"?2:8,!Ae||Ae==Ne?Ft:Xe}),Ae&&(Ne=Ae,Le=Le.replace(X,"$1").replace(te,"0.$1")),Ee!=Le))return new L(Le,Ne);if(L.DEBUG)throw Error(o+"Not a"+(Ae?" base "+Ae:"")+" number: "+Ee);_e.s=null}_e.c=_e.e=null}}();function pe(j,X,te,we){var ce,_e,Ee,he,Ae,Ne,Le,Xe=j.c,Ft=y;if(Xe){e:{for(ce=1,he=Xe[0];he>=10;he/=10,ce++);if(_e=X-ce,_e<0)_e+=d,Ee=X,Ae=Xe[Ne=0],Le=n(Ae/Ft[ce-Ee-1]%10);else if(Ne=s((_e+1)/d),Ne>=Xe.length)if(we){for(;Xe.length<=Ne;Xe.push(0));Ae=Le=0,ce=1,_e%=d,Ee=_e-d+1}else break e;else{for(Ae=he=Xe[Ne],ce=1;he>=10;he/=10,ce++);_e%=d,Ee=_e-d+ce,Le=Ee<0?0:n(Ae/Ft[ce-Ee-1]%10)}if(we=we||X<0||Xe[Ne+1]!=null||(Ee<0?Ae:Ae%Ft[ce-Ee-1]),we=te<4?(Le||we)&&(te==0||te==(j.s<0?3:2)):Le>5||Le==5&&(te==4||we||te==6&&(_e>0?Ee>0?Ae/Ft[ce-Ee]:0:Xe[Ne-1])%10&1||te==(j.s<0?8:7)),X<1||!Xe[0])return Xe.length=0,we?(X-=j.e+1,Xe[0]=Ft[(d-X%d)%d],j.e=-X||0):Xe[0]=j.e=0,j;if(_e==0?(Xe.length=Ne,he=1,Ne--):(Xe.length=Ne+1,he=Ft[d-_e],Xe[Ne]=Ee>0?n(Ae/Ft[ce-Ee]%Ft[Ee])*he:0),we)for(;;)if(Ne==0){for(_e=1,Ee=Xe[0];Ee>=10;Ee/=10,_e++);for(Ee=Xe[0]+=he,he=1;Ee>=10;Ee/=10,he++);_e!=he&&(j.e++,Xe[0]==h&&(Xe[0]=1));break}else{if(Xe[Ne]+=he,Xe[Ne]!=h)break;Xe[Ne--]=0,he=1}for(_e=Xe.length;Xe[--_e]===0;Xe.pop());}j.e>ct?j.c=j.e=null:j.e<Ct&&(j.c=[j.e=0])}return j}function ye(j){var X,te=j.e;return te===null?j.toString():(X=R(j.c),X=te<=lt||te>=pt?z(X,te):q(X,te,"0"),j.s<0?"-"+X:X)}return de.absoluteValue=de.abs=function(){var j=new L(this);return j.s<0&&(j.s=1),j},de.comparedTo=function(j,X){return I(this,new L(j,X))},de.decimalPlaces=de.dp=function(j,X){var te,we,ce,_e=this;if(j!=null)return F(j,0,x),X==null?X=Be:F(X,0,8),pe(new L(_e),j+_e.e+1,X);if(!(te=_e.c))return null;if(we=((ce=te.length-1)-E(this.e/d))*d,ce=te[ce])for(;ce%10==0;ce/=10,we--);return we<0&&(we=0),we},de.dividedBy=de.div=function(j,X){return Y(this,new L(j,X),Ie,Be)},de.dividedToIntegerBy=de.idiv=function(j,X){return Y(this,new L(j,X),0,1)},de.exponentiatedBy=de.pow=function(j,X){var te,we,ce,_e,Ee,he,Ae,Ne,Le,Xe=this;if(j=new L(j),j.c&&!j.isInteger())throw Error(o+"Exponent not an integer: "+ye(j));if(X!=null&&(X=new L(X)),he=j.e>14,!Xe.c||!Xe.c[0]||Xe.c[0]==1&&!Xe.e&&Xe.c.length==1||!j.c||!j.c[0])return Le=new L(Math.pow(+ye(Xe),he?j.s*(2-H(j)):+ye(j))),X?Le.mod(X):Le;if(Ae=j.s<0,X){if(X.c?!X.c[0]:!X.s)return new L(NaN);we=!Ae&&Xe.isInteger()&&X.isInteger(),we&&(Xe=Xe.mod(X))}else{if(j.e>9&&(Xe.e>0||Xe.e<-1||(Xe.e==0?Xe.c[0]>1||he&&Xe.c[1]>=24e7:Xe.c[0]<8e13||he&&Xe.c[0]<=9999975e7)))return _e=Xe.s<0&&H(j)?-0:0,Xe.e>-1&&(_e=1/_e),new L(Ae?1/_e:_e);Fe&&(_e=s(Fe/d+2))}for(he?(te=new L(.5),Ae&&(j.s=1),Ne=H(j)):(ce=Math.abs(+ye(j)),Ne=ce%2),Le=new L(Re);;){if(Ne){if(Le=Le.times(Xe),!Le.c)break;_e?Le.c.length>_e&&(Le.c.length=_e):we&&(Le=Le.mod(X))}if(ce){if(ce=n(ce/2),ce===0)break;Ne=ce%2}else if(j=j.times(te),pe(j,j.e+1,1),j.e>14)Ne=H(j);else{if(ce=+ye(j),ce===0)break;Ne=ce%2}Xe=Xe.times(Xe),_e?Xe.c&&Xe.c.length>_e&&(Xe.c.length=_e):we&&(Xe=Xe.mod(X))}return we?Le:(Ae&&(Le=Re.div(Le)),X?Le.mod(X):_e?pe(Le,Fe,Be,Ee):Le)},de.integerValue=function(j){var X=new L(this);return j==null?j=Be:F(j,0,8),pe(X,X.e+1,j)},de.isEqualTo=de.eq=function(j,X){return I(this,new L(j,X))===0},de.isFinite=function(){return!!this.c},de.isGreaterThan=de.gt=function(j,X){return I(this,new L(j,X))>0},de.isGreaterThanOrEqualTo=de.gte=function(j,X){return(X=I(this,new L(j,X)))===1||X===0},de.isInteger=function(){return!!this.c&&E(this.e/d)>this.c.length-2},de.isLessThan=de.lt=function(j,X){return I(this,new L(j,X))<0},de.isLessThanOrEqualTo=de.lte=function(j,X){return(X=I(this,new L(j,X)))===-1||X===0},de.isNaN=function(){return!this.s},de.isNegative=function(){return this.s<0},de.isPositive=function(){return this.s>0},de.isZero=function(){return!!this.c&&this.c[0]==0},de.minus=function(j,X){var te,we,ce,_e,Ee=this,he=Ee.s;if(j=new L(j,X),X=j.s,!he||!X)return new L(NaN);if(he!=X)return j.s=-X,Ee.plus(j);var Ae=Ee.e/d,Ne=j.e/d,Le=Ee.c,Xe=j.c;if(!Ae||!Ne){if(!Le||!Xe)return Le?(j.s=-X,j):new L(Xe?Ee:NaN);if(!Le[0]||!Xe[0])return Xe[0]?(j.s=-X,j):new L(Le[0]?Ee:Be==3?-0:0)}if(Ae=E(Ae),Ne=E(Ne),Le=Le.slice(),he=Ae-Ne){for((_e=he<0)?(he=-he,ce=Le):(Ne=Ae,ce=Xe),ce.reverse(),X=he;X--;ce.push(0));ce.reverse()}else for(we=(_e=(he=Le.length)<(X=Xe.length))?he:X,he=X=0;X<we;X++)if(Le[X]!=Xe[X]){_e=Le[X]<Xe[X];break}if(_e&&(ce=Le,Le=Xe,Xe=ce,j.s=-j.s),X=(we=Xe.length)-(te=Le.length),X>0)for(;X--;Le[te++]=0);for(X=h-1;we>he;){if(Le[--we]<Xe[we]){for(te=we;te&&!Le[--te];Le[te]=X);--Le[te],Le[we]+=h}Le[we]-=Xe[we]}for(;Le[0]==0;Le.splice(0,1),--Ne);return Le[0]?Q(j,Le,Ne):(j.s=Be==3?-1:1,j.c=[j.e=0],j)},de.modulo=de.mod=function(j,X){var te,we,ce=this;return j=new L(j,X),!ce.c||!j.s||j.c&&!j.c[0]?new L(NaN):!j.c||ce.c&&!ce.c[0]?new L(ce):(Je==9?(we=j.s,j.s=1,te=Y(ce,j,0,3),j.s=we,te.s*=we):te=Y(ce,j,0,Je),j=ce.minus(te.times(j)),!j.c[0]&&Je==1&&(j.s=ce.s),j)},de.multipliedBy=de.times=function(j,X){var te,we,ce,_e,Ee,he,Ae,Ne,Le,Xe,Ft,St,zt,kr,xr,ir=this,hr=ir.c,Hn=(j=new L(j,X)).c;if(!hr||!Hn||!hr[0]||!Hn[0])return!ir.s||!j.s||hr&&!hr[0]&&!Hn||Hn&&!Hn[0]&&!hr?j.c=j.e=j.s=null:(j.s*=ir.s,!hr||!Hn?j.c=j.e=null:(j.c=[0],j.e=0)),j;for(we=E(ir.e/d)+E(j.e/d),j.s*=ir.s,Ae=hr.length,Xe=Hn.length,Ae<Xe&&(zt=hr,hr=Hn,Hn=zt,ce=Ae,Ae=Xe,Xe=ce),ce=Ae+Xe,zt=[];ce--;zt.push(0));for(kr=h,xr=C,ce=Xe;--ce>=0;){for(te=0,Ft=Hn[ce]%xr,St=Hn[ce]/xr|0,Ee=Ae,_e=ce+Ee;_e>ce;)Ne=hr[--Ee]%xr,Le=hr[Ee]/xr|0,he=St*Ne+Le*Ft,Ne=Ft*Ne+he%xr*xr+zt[_e]+te,te=(Ne/kr|0)+(he/xr|0)+St*Le,zt[_e--]=Ne%kr;zt[_e]=te}return te?++we:zt.splice(0,1),Q(j,zt,we)},de.negated=function(){var j=new L(this);return j.s=-j.s||null,j},de.plus=function(j,X){var te,we=this,ce=we.s;if(j=new L(j,X),X=j.s,!ce||!X)return new L(NaN);if(ce!=X)return j.s=-X,we.minus(j);var _e=we.e/d,Ee=j.e/d,he=we.c,Ae=j.c;if(!_e||!Ee){if(!he||!Ae)return new L(ce/0);if(!he[0]||!Ae[0])return Ae[0]?j:new L(he[0]?we:ce*0)}if(_e=E(_e),Ee=E(Ee),he=he.slice(),ce=_e-Ee){for(ce>0?(Ee=_e,te=Ae):(ce=-ce,te=he),te.reverse();ce--;te.push(0));te.reverse()}for(ce=he.length,X=Ae.length,ce-X<0&&(te=Ae,Ae=he,he=te,X=ce),ce=0;X;)ce=(he[--X]=he[X]+Ae[X]+ce)/h|0,he[X]=h===he[X]?0:he[X]%h;return ce&&(he=[ce].concat(he),++Ee),Q(j,he,Ee)},de.precision=de.sd=function(j,X){var te,we,ce,_e=this;if(j!=null&&j!==!!j)return F(j,1,x),X==null?X=Be:F(X,0,8),pe(new L(_e),j,X);if(!(te=_e.c))return null;if(ce=te.length-1,we=ce*d+1,ce=te[ce]){for(;ce%10==0;ce/=10,we--);for(ce=te[0];ce>=10;ce/=10,we++);}return j&&_e.e+1>we&&(we=_e.e+1),we},de.shiftedBy=function(j){return F(j,-g,g),this.times("1e"+j)},de.squareRoot=de.sqrt=function(){var j,X,te,we,ce,_e=this,Ee=_e.c,he=_e.s,Ae=_e.e,Ne=Ie+4,Le=new L("0.5");if(he!==1||!Ee||!Ee[0])return new L(!he||he<0&&(!Ee||Ee[0])?NaN:Ee?_e:1/0);if(he=Math.sqrt(+ye(_e)),he==0||he==1/0?(X=R(Ee),(X.length+Ae)%2==0&&(X+="0"),he=Math.sqrt(+X),Ae=E((Ae+1)/2)-(Ae<0||Ae%2),he==1/0?X="5e"+Ae:(X=he.toExponential(),X=X.slice(0,X.indexOf("e")+1)+Ae),te=new L(X)):te=new L(he+""),te.c[0]){for(Ae=te.e,he=Ae+Ne,he<3&&(he=0);;)if(ce=te,te=Le.times(ce.plus(Y(_e,ce,Ne,1))),R(ce.c).slice(0,he)===(X=R(te.c)).slice(0,he))if(te.e<Ae&&--he,X=X.slice(he-3,he+1),X=="9999"||!we&&X=="4999"){if(!we&&(pe(ce,ce.e+Ie+2,0),ce.times(ce).eq(_e))){te=ce;break}Ne+=4,he+=4,we=1}else{(!+X||!+X.slice(1)&&X.charAt(0)=="5")&&(pe(te,te.e+Ie+2,1),j=!te.times(te).eq(_e));break}}return pe(te,te.e+Ie+1,Be,j)},de.toExponential=function(j,X){return j!=null&&(F(j,0,x),j++),D(this,j,X,1)},de.toFixed=function(j,X){return j!=null&&(F(j,0,x),j=j+this.e+1),D(this,j,X)},de.toFormat=function(j,X,te){var we,ce=this;if(te==null)j!=null&&X&&typeof X=="object"?(te=X,X=null):j&&typeof j=="object"?(te=j,j=X=null):te=A;else if(typeof te!="object")throw Error(o+"Argument not an object: "+te);if(we=ce.toFixed(j,X),ce.c){var _e,Ee=we.split("."),he=+te.groupSize,Ae=+te.secondaryGroupSize,Ne=te.groupSeparator||"",Le=Ee[0],Xe=Ee[1],Ft=ce.s<0,St=Ft?Le.slice(1):Le,zt=St.length;if(Ae&&(_e=he,he=Ae,Ae=_e,zt-=_e),he>0&&zt>0){for(_e=zt%he||he,Le=St.substr(0,_e);_e<zt;_e+=he)Le+=Ne+St.substr(_e,he);Ae>0&&(Le+=Ne+St.slice(_e)),Ft&&(Le="-"+Le)}we=Xe?Le+(te.decimalSeparator||"")+((Ae=+te.fractionGroupSize)?Xe.replace(new RegExp("\\d{"+Ae+"}\\B","g"),"$&"+(te.fractionGroupSeparator||"")):Xe):Le}return(te.prefix||"")+we+(te.suffix||"")},de.toFraction=function(j){var X,te,we,ce,_e,Ee,he,Ae,Ne,Le,Xe,Ft,St=this,zt=St.c;if(j!=null&&(he=new L(j),!he.isInteger()&&(he.c||he.s!==1)||he.lt(Re)))throw Error(o+"Argument "+(he.isInteger()?"out of range: ":"not an integer: ")+ye(he));if(!zt)return new L(St);for(X=new L(Re),Ne=te=new L(Re),we=Ae=new L(Re),Ft=R(zt),_e=X.e=Ft.length-St.e-1,X.c[0]=y[(Ee=_e%d)<0?d+Ee:Ee],j=!j||he.comparedTo(X)>0?_e>0?X:Ne:he,Ee=ct,ct=1/0,he=new L(Ft),Ae.c[0]=0;Le=Y(he,X,0,1),ce=te.plus(Le.times(we)),ce.comparedTo(j)!=1;)te=we,we=ce,Ne=Ae.plus(Le.times(ce=Ne)),Ae=ce,X=he.minus(Le.times(ce=X)),he=ce;return ce=Y(j.minus(te),we,0,1),Ae=Ae.plus(ce.times(Ne)),te=te.plus(ce.times(we)),Ae.s=Ne.s=St.s,_e=_e*2,Xe=Y(Ne,we,_e,Be).minus(St).abs().comparedTo(Y(Ae,te,_e,Be).minus(St).abs())<1?[Ne,we]:[Ae,te],ct=Ee,Xe},de.toNumber=function(){return+ye(this)},de.toPrecision=function(j,X){return j!=null&&F(j,1,x),D(this,j,X,2)},de.toString=function(j){var X,te=this,we=te.s,ce=te.e;return ce===null?we?(X="Infinity",we<0&&(X="-"+X)):X="NaN":(j==null?X=ce<=lt||ce>=pt?z(R(te.c),ce):q(R(te.c),ce,"0"):j===10&&k?(te=pe(new L(te),Ie+ce+1,Be),X=q(R(te.c),te.e,"0")):(F(j,2,O.length,"Base"),X=oe(q(R(te.c),ce,"0"),10,j,we,!0)),we<0&&te.c[0]&&(X="-"+X)),X},de.valueOf=de.toJSON=function(){return ye(this)},de._isBigNumber=!0,re!=null&&L.set(re),L}function E(re){var Y=re|0;return re>0||re===Y?Y:Y-1}function R(re){for(var Y,oe,me=1,de=re.length,Re=re[0]+"";me<de;){for(Y=re[me++]+"",oe=d-Y.length;oe--;Y="0"+Y);Re+=Y}for(de=Re.length;Re.charCodeAt(--de)===48;);return Re.slice(0,de+1||1)}function I(re,Y){var oe,me,de=re.c,Re=Y.c,Ie=re.s,Be=Y.s,lt=re.e,pt=Y.e;if(!Ie||!Be)return null;if(oe=de&&!de[0],me=Re&&!Re[0],oe||me)return oe?me?0:-Be:Ie;if(Ie!=Be)return Ie;if(oe=Ie<0,me=lt==pt,!de||!Re)return me?0:!de^oe?1:-1;if(!me)return lt>pt^oe?1:-1;for(Be=(lt=de.length)<(pt=Re.length)?lt:pt,Ie=0;Ie<Be;Ie++)if(de[Ie]!=Re[Ie])return de[Ie]>Re[Ie]^oe?1:-1;return lt==pt?0:lt>pt^oe?1:-1}function F(re,Y,oe,me){if(re<Y||re>oe||re!==n(re))throw Error(o+(me||"Argument")+(typeof re=="number"?re<Y||re>oe?" out of range: ":" not an integer: ":" not a primitive number: ")+String(re))}function H(re){var Y=re.c.length-1;return E(re.e/d)==Y&&re.c[Y]%2!=0}function z(re,Y){return(re.length>1?re.charAt(0)+"."+re.slice(1):re)+(Y<0?"e":"e+")+Y}function q(re,Y,oe){var me,de;if(Y<0){for(de=oe+".";++Y;de+=oe);re=de+re}else if(me=re.length,++Y>me){for(de=oe,Y-=me;--Y;de+=oe);re+=de}else Y<me&&(re=re.slice(0,Y)+"."+re.slice(Y));return re}r=_(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(QOe)})(NJ);var DJ=NJ.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const pc=o6(),CIe=i6(),SIe=s6,bIe=DJ,to={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},rS={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:LJ,decimalSuffixes:nT}=pc.currentBytes(),a6={general:{scale:1024,suffixes:nT,marker:"bd"},binary:{scale:1024,suffixes:LJ,marker:"b"},decimal:{scale:1e3,suffixes:nT,marker:"d"}};function xIe(t,e={},r){if(typeof e=="string"&&(e=SIe.parseFormat(e)),!CIe.validateFormat(e))return"ERROR: invalid format";let s=e.prefix||"",n=e.postfix||"",o=EIe(t,e,r);return o=jIe(o,s),o=UIe(o,n),o}function EIe(t,e,r){switch(e.output){case"currency":return e=lp(e,pc.currentCurrencyDefaultFormat()),FIe(t,e,pc);case"percent":return e=lp(e,pc.currentPercentageDefaultFormat()),PIe(t,e,pc,r);case"byte":return e=lp(e,pc.currentByteDefaultFormat()),AIe(t,e,pc,r);case"time":return e=lp(e,pc.currentTimeDefaultFormat()),IIe(t);case"ordinal":return e=lp(e,pc.currentOrdinalDefaultFormat()),OIe(t,e,pc);case"number":default:return nS({instance:t,providedFormat:e,numbro:r})}}function TIe(t){let e=a6.decimal;return q_(t._value,e.suffixes,e.scale).suffix}function _Ie(t){let e=a6.binary;return q_(t._value,e.suffixes,e.scale).suffix}function RIe(t){let e=a6.general;return q_(t._value,e.suffixes,e.scale).suffix}function q_(t,e,r){let i=e[0],s=Math.abs(t);if(s>=r){for(let n=1;n<e.length;++n){let o=Math.pow(r,n),l=Math.pow(r,n+1);if(s>=o&&s<l){i=e[n],t=t/o;break}}i===e[0]&&(t=t/Math.pow(r,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function AIe(t,e,r,i){let s=e.base||"binary",n=Object.assign({},rS,e);const{binarySuffixes:o,decimalSuffixes:l}=r.currentBytes();let d={general:{scale:1024,suffixes:l||nT,marker:"bd"},binary:{scale:1024,suffixes:o||LJ,marker:"b"},decimal:{scale:1e3,suffixes:l||nT,marker:"d"}}[s],{value:g,suffix:y}=q_(t._value,d.suffixes,d.scale);return`${nS({instance:i(g),providedFormat:e,state:r,defaults:r.currentByteDefaultFormat()})}${n.spaceSeparated?" ":""}${y}`}function OIe(t,e,r){let i=r.currentOrdinal(),s=Object.assign({},rS,e),n=nS({instance:t,providedFormat:e,state:r}),o=i(t._value);return`${n}${s.spaceSeparated?" ":""}${o}`}function IIe(t){let e=Math.floor(t._value/60/60),r=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-r*60);return`${e}:${r<10?"0":""}${r}:${i<10?"0":""}${i}`}function PIe(t,e,r,i){let s=e.prefixSymbol,n=nS({instance:i(t._value*100),providedFormat:e,state:r}),o=Object.assign({},rS,e);return s?`%${o.spaceSeparated?" ":""}${n}`:`${n}${o.spaceSeparated?" ":""}%`}function FIe(t,e,r){const i=r.currentCurrency();let s=Object.assign({},e),n=Object.assign({},rS,s),o,l="",h=!!n.totalLength||!!n.forceAverage||n.average,d=s.currencyPosition||i.position,g=s.currencySymbol||i.symbol;const y=n.spaceSeparatedCurrency!==void 0?n.spaceSeparatedCurrency:n.spaceSeparated;s.lowPrecision===void 0&&(s.lowPrecision=!1),y&&(l=" "),d==="infix"&&(o=l+g+l);let C=nS({instance:t,providedFormat:s,state:r,decimalSeparator:o});return d==="prefix"&&(t._value<0&&n.negative==="sign"?C=`-${l}${g}${C.slice(1)}`:t._value>0&&n.forceSign?C=`+${l}${g}${C.slice(1)}`:C=g+l+C),(!d||d==="postfix")&&(l=!n.spaceSeparatedAbbreviation&&h?"":l,C=C+l+g),C}function MIe({value:t,forceAverage:e,lowPrecision:r=!0,abbreviations:i,spaceSeparated:s=!1,totalLength:n=0,roundingFunction:o=Math.round}){let l="",h=Math.abs(t),d=-1;if(e&&i[e]&&to[e]?(l=i[e],t=t/to[e]):h>=to.trillion||r&&o(h/to.trillion)===1?(l=i.trillion,t=t/to.trillion):h<to.trillion&&h>=to.billion||r&&o(h/to.billion)===1?(l=i.billion,t=t/to.billion):h<to.billion&&h>=to.million||r&&o(h/to.million)===1?(l=i.million,t=t/to.million):(h<to.million&&h>=to.thousand||r&&o(h/to.thousand)===1)&&(l=i.thousand,t=t/to.thousand),l&&(l=(s?" ":"")+l),n){let y=t<0,C=t.toString().split(".")[0],x=y?C.length-1:C.length;d=Math.max(n-x,0)}return{value:t,abbreviation:l,mantissaPrecision:d}}function kIe({value:t,characteristicPrecision:e}){let[r,i]=t.toExponential().split("e"),s=+r;if(!e)return{value:s,abbreviation:`e${i}`};let n=1;return n<e&&(s=s*Math.pow(10,e-n),i=+i-(e-n),i=i>=0?`+${i}`:i),{value:s,abbreviation:`e${i}`}}function ux(t){let e="";for(let r=0;r<t;r++)e+="0";return e}function NIe(t,e){let r=t.toString(),[i,s]=r.split("e"),[n,o=""]=i.split(".");if(+s>0)r=n+o+ux(s-o.length);else{let l=".";+n<0?l=`-0${l}`:l=`0${l}`;let h=(ux(-s-1)+Math.abs(n)+o).substr(0,e);h.length<e&&(h+=ux(e-h.length)),r=l+h}return+s>0&&e>0&&(r+=`.${ux(e)}`),r}function DIe(t,e,r=Math.round){return t.toString().indexOf("e")!==-1?NIe(t,e):new bIe(r(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function LIe(t,e,r,i,s,n){if(i===-1)return t;let o=DIe(e,i,n),[l,h=""]=o.toString().split(".");if(h.match(/^0+$/)&&(r||s))return l;let d=h.match(/0+$/);return s&&d?`${l}.${h.toString().slice(0,d.index)}`:o.toString()}function HIe(t,e,r,i){let s=t,[n,o]=s.toString().split(".");if(n.match(/^-?0$/)&&r)return o?`${n.replace("0","")}.${o}`:n.replace("0","");const l=e<0&&n.indexOf("-")===0;if(l&&(n=n.slice(1),s=s.slice(1)),n.length<i){let h=i-n.length;for(let d=0;d<h;d++)s=`0${s}`}return l&&(s=`-${s}`),s.toString()}function $Ie(t,e){let r=[],i=0;for(let s=t;s>0;s--)i===e&&(r.unshift(s),i=0),i++;return r}function BIe(t,e,r,i,s){let n=i.currentDelimiters(),o=n.thousands;s=s||n.decimal;let l=n.thousandsSize||3,h=t.toString(),d=h.split(".")[0],g=h.split(".")[1];const y=e<0&&d.indexOf("-")===0;return r&&(y&&(d=d.slice(1)),$Ie(d.length,l).forEach((x,_)=>{d=d.slice(0,x+_)+o+d.slice(x+_)}),y&&(d=`-${d}`)),g?h=d+s+g:h=d,h}function VIe(t,e){return t+e}function WIe(t,e,r){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:r==="sign"?t:`(${t.replace("-","")})`}function jIe(t,e){return e+t}function UIe(t,e){return t+e}function nS({instance:t,providedFormat:e,state:r=pc,decimalSeparator:i,defaults:s=r.currentDefaults()}){let n=t._value;if(n===0&&r.hasZeroFormat())return r.getZeroFormat();if(!isFinite(n))return n.toString();let o=Object.assign({},rS,s,e),l=o.totalLength,h=l?0:o.characteristic,d=o.optionalCharacteristic,g=o.forceAverage,y=o.lowPrecision,C=!!l||!!g||o.average,x=l?-1:C&&e.mantissa===void 0?0:o.mantissa,_=l?!1:e.optionalMantissa===void 0?x===-1:o.optionalMantissa,E=o.trimMantissa,R=o.thousandSeparated,I=o.spaceSeparated,F=o.negative,H=o.forceSign,z=o.exponential,q=o.roundingFunction,re="";if(C){let oe=MIe({value:n,forceAverage:g,lowPrecision:y,abbreviations:r.currentAbbreviations(),spaceSeparated:I,roundingFunction:q,totalLength:l});n=oe.value,re+=oe.abbreviation,l&&(x=oe.mantissaPrecision)}if(z){let oe=kIe({value:n,characteristicPrecision:h});n=oe.value,re=oe.abbreviation+re}let Y=LIe(n.toString(),n,_,x,E,q);return Y=HIe(Y,n,d,h),Y=BIe(Y,n,R,r,i),(C||z)&&(Y=VIe(Y,re)),(H||n<0)&&(Y=WIe(Y,n,F)),Y}function lp(t,e){if(!t)return e;let r=Object.keys(t);return r.length===1&&r[0]==="output"?e:t}var zIe=t=>({format:(...e)=>xIe(...e,t),getByteUnit:(...e)=>RIe(...e,t),getBinaryByteUnit:(...e)=>_Ie(...e,t),getDecimalByteUnit:(...e)=>TIe(...e,t),formatOrDefault:lp});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const rf=DJ;function GIe(t,e,r){let i=new rf(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new rf(s),t._value=i.plus(s).toNumber(),t}function HJ(t,e,r){let i=new rf(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new rf(s),t._value=i.minus(s).toNumber(),t}function YIe(t,e,r){let i=new rf(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new rf(s),t._value=i.times(s).toNumber(),t}function KIe(t,e,r){let i=new rf(t._value),s=e;return r.isNumbro(e)&&(s=e._value),s=new rf(s),t._value=i.dividedBy(s).toNumber(),t}function XIe(t,e,r){let i=e;return r.isNumbro(e)&&(i=e._value),t._value=i,t}function qIe(t,e,r){let i=r(t._value);return HJ(i,e,r),Math.abs(i._value)}var JIe=t=>({add:(e,r)=>GIe(e,r,t),subtract:(e,r)=>HJ(e,r,t),multiply:(e,r)=>YIe(e,r,t),divide:(e,r)=>KIe(e,r,t),set:(e,r)=>XIe(e,r,t),difference:(e,r)=>qIe(e,r,t),BigNumber:rf});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const QIe="2.5.0",Zu=o6(),ZIe=i6(),e3e=yIe(rs),t3e=kJ();let y0=zIe(rs),X0=JIe(rs);const r3e=s6;class $J{constructor(e){this._value=e}clone(){return rs(this._value)}format(e={}){return y0.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=r3e.parseFormat(e)),e=y0.formatOrDefault(e,Zu.currentCurrencyDefaultFormat()),e.output="currency",y0.format(this,e)}formatTime(e={}){return e.output="time",y0.format(this,e)}binaryByteUnits(){return y0.getBinaryByteUnit(this)}decimalByteUnits(){return y0.getDecimalByteUnit(this)}byteUnits(){return y0.getByteUnit(this)}difference(e){return X0.difference(this,e)}add(e){return X0.add(this,e)}subtract(e){return X0.subtract(this,e)}multiply(e){return X0.multiply(this,e)}divide(e){return X0.divide(this,e)}set(e){return X0.set(this,BJ(e))}value(){return this._value}valueOf(){return this._value}}function BJ(t){let e=t;return rs.isNumbro(t)?e=t._value:typeof t=="string"?e=rs.unformat(t):isNaN(t)&&(e=NaN),e}function rs(t){return new $J(BJ(t))}rs.version=QIe;rs.isNumbro=function(t){return t instanceof $J};rs.language=Zu.currentLanguage;rs.registerLanguage=Zu.registerLanguage;rs.setLanguage=Zu.setLanguage;rs.languages=Zu.languages;rs.languageData=Zu.languageData;rs.zeroFormat=Zu.setZeroFormat;rs.defaultFormat=Zu.currentDefaults;rs.setDefaults=Zu.setDefaults;rs.defaultCurrencyFormat=Zu.currentCurrencyDefaultFormat;rs.validate=ZIe.validate;rs.loadLanguagesInNode=e3e.loadLanguagesInNode;rs.unformat=t3e.unformat;rs.BigNumber=X0.BigNumber;var n3e=rs,C0=ZOe(n3e);const i3e="numeric";function VJ(t,e){if(na(t)){const r=e.numericFormat,i=r&&r.culture||"-",s=r&&r.pattern;if(typeof i<"u"&&!C0.languages()[i]){const n=i.replace("-",""),o=C0.allLanguages?C0.allLanguages[i]:C0[n];o&&C0.registerLanguage(o)}C0.setLanguage(i),t=C0(t).format(s||"0")}return t}function l6(t,e,r,i,s,n,o){let l=n;if(na(l)){const h=o.className||"",d=h.length?h.split(" "):[];l=VJ(l,o),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),o.className=d.join(" "),e.dir="ltr"}gf(t,e,r,i,s,l,o)}l6.RENDERER_TYPE=i3e;const s3e="password";function c6(t,e,r,i,s,n,o){gf.apply(this,[t,e,r,i,s,n,o]);const l=o.hashLength||e.innerHTML.length,h=o.hashSymbol||"*";let d="";pr(l-1,()=>{d+=h}),M1(e,d)}c6.RENDERER_TYPE=s3e;const o3e="select";function u6(t,e,r,i,s,n,o){gf.apply(this,[t,e,r,i,s,n,o])}u6.RENDERER_TYPE=o3e;const a3e="time";function h6(t,e,r,i,s,n,o){gf.apply(this,[t,e,r,i,s,n,o]),e.dir="ltr"}h6.RENDERER_TYPE=a3e;function l3e(){Rl(D1),Rl(tS),Rl(t6),Rl(e6),Rl(n6),Rl(ZD),Rl(l6),Rl(c6),Rl(u6),Rl(gf),Rl(h6)}const c3e="autocomplete";function J_(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,$V(r,e)):$V(r,e)(this.source):e(!0)}J_.VALIDATOR_TYPE=c3e;function $V(t,e){const r=t;return function(i){let s=!1;for(let n=0,o=i.length;n<o;n++)if(r===i[n]){s=!0;break}e(s)}}function u3e(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const h3e="date";function f6(t,e){const r=hq(RJ,this.instance);let i=t,s=!0;i==null&&(i="");let n=mt(i,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=mt(new Date(i)).isValid()||n;if(this.allowEmpty&&i===""&&(o=!0,n=!0),o||(s=!1),!o&&n&&(s=!0),o&&!n)if(this.correctFormat===!0){const l=f3e(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,l,"dateValidator"),s=!0}else s=!1;e(s)}f6.VALIDATOR_TYPE=h3e;function f3e(t,e){const r=mt(u3e(t)),i=mt(t,e),s=t.search(/[A-z]/g)>-1;let n;return r.isValid()&&r.format("x")===i.format("x")||!i.isValid()||s?n=r:n=i,n.format(e)}const d3e="dropdown";function d6(t,e){J_.apply(this,[t,e])}d6.VALIDATOR_TYPE=d3e;const g3e="numeric";function g6(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:na(t))}g6.VALIDATOR_TYPE=g3e;const m3e=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],p3e="time";function m6(t,e){const r=this.timeFormat||"h:mm:ss a";let i=!0,s=t;s===null&&(s=""),s=/^\d{3,}$/.test(s)?parseInt(s,10):s;const n=/^\d{1,2}$/.test(s);n&&(s+=":00");const o=mt(s,m3e,!0).isValid()?mt(s):mt(s,r);let l=o.isValid(),h=mt(s,r,!0).isValid()&&!n;if(this.allowEmpty&&s===""&&(l=!0,h=!0),l||(i=!1),!l&&h&&(i=!0),l&&!h)if(this.correctFormat===!0){const d=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;e(i)}m6.VALIDATOR_TYPE=p3e;function v3e(){ap(J_),ap(d6),ap(f6),ap(g6),ap(m6)}const w3e="autocomplete",y3e={CELL_TYPE:w3e,editor:qD,renderer:D1,validator:J_},C3e="checkbox",S3e={CELL_TYPE:C3e,editor:_J,renderer:t6},b3e="date";function WJ(t,e,r,i,s,n,o){D1.apply(this,[t,e,r,i,s,n,o])}WJ.RENDERER_TYPE=b3e;const x3e="date",E3e={CELL_TYPE:x3e,editor:AJ,renderer:WJ,validator:f6},T3e="dropdown",_3e={CELL_TYPE:T3e,editor:QD,renderer:e6,validator:d6},R3e="handsontable",A3e={CELL_TYPE:R3e,editor:XD,renderer:n6},O3e="numeric",I3e={CELL_TYPE:O3e,editor:OJ,renderer:l6,validator:g6,dataType:"number"},P3e="password",F3e={CELL_TYPE:P3e,editor:IJ,renderer:c6,copyable:!1},M3e="select",k3e={CELL_TYPE:M3e,editor:PJ,renderer:u6},N3e="time",D3e={CELL_TYPE:N3e,editor:FJ,renderer:h6,validator:m6};function L3e(){dc(y3e),dc(S3e),dc(E3e),dc(_3e),dc(A3e),dc(I3e),dc(F3e),dc(k3e),dc(pJ),dc(D3e)}function H3e(t,e){jJ(t,e),e.add(t)}function $3e(t,e,r){jJ(t,e),e.set(t,r)}function jJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Im(t,e,r){return(e=B3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B3e(t){var e=V3e(t,"string");return typeof e=="symbol"?e:e+""}function V3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pm(t,e){return t.get(UJ(t,e))}function UJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const BV=new Map([["plugin",qxe],["cell-type",oJ],["editor",uq],["renderer",wq],["validator",yq]]),zJ=Symbol("mainSetting"),W3e="base",hx=[];let lu=null;var S0=new WeakMap,VV=new WeakSet;class On{static get PLUGIN_KEY(){return W3e}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){H3e(this,VV),Im(this,"eventManager",new $c(this)),Im(this,"pluginName",null),Im(this,"pluginsInitializedCallbacks",[]),Im(this,"isPluginsReady",!1),Im(this,"enabled",!1),Im(this,"initialized",!1),$3e(this,S0,{}),ff(this,"hot",e,{writable:!1}),lu=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const s=[];if(r.forEach(n=>{const[o,l]=n.split(":");if(!BV.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);BV.get(o)(l)||s.push(` - ${l} (${o})`)}),s.length>0){const n=[`The ${this.pluginName} plugin requires the following modules:
`,`${s.join(`
`)}
`].join("");hx.push(n)}}if(lu||(lu=vq()),lu.indexOf("UndoRedo")>=0&&lu.splice(lu.indexOf("UndoRedo"),1),lu.indexOf(this.pluginName)>=0&&lu.splice(lu.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),lu.length===0){if(hx.length>0){const s=[`${hx.join(`
`)}
`,"You have to import and register them manually."].join("");throw hx.length=0,new Error(s)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(e===void 0)return r;const i=this.constructor.DEFAULT_SETTINGS;if((Array.isArray(r)||Qr(r))&&i[zJ]===e){var s;return Array.isArray(r)?r:(s=r[e])!==null&&s!==void 0?s:i[e]}if(Qr(r)){var n;return(n=r[e])!==null&&n!==void 0?n:i[e]}return i[e]}addHook(e,r,i){Pm(S0,this)[e]=Pm(S0,this)[e]||[];const s=Pm(S0,this)[e];this.hot.addHook(e,r,i),s.push(r),Pm(S0,this)[e]=s}removeHooks(e){xe(Pm(S0,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=Pm(S0,this);Zr(e,(r,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){xe(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=UJ(VV,this,j3e).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Zr(this,(r,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function j3e(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function b0(t,e,r){return(e=U3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function U3e(t){var e=z3e(t,"string");return typeof e=="symbol"?e:e+""}function z3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let GJ=class{constructor(e){b0(this,"hot",null),b0(this,"container",null),b0(this,"injected",!1),b0(this,"rows",[]),b0(this,"columns",[]),b0(this,"samples",null),b0(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),xe(this.rows,r=>{const{height:i}=r.table.getBoundingClientRect();e(r.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),xe(this.columns,r=>{const{width:i}=r.table.getBoundingClientRect();e(r.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{xe(i.strings,s=>{r.appendChild(this.createColElement(s.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,s),i.appendChild(s)),this.samples.forEach(n=>{xe(n.strings,o=>{const l=o.col,h=this.hot.getCellMeta(e,l),d=this.hot.getCellRenderer(h),g=r.createElement("td");g.setAttribute("ghost-table",1),d(this.hot,g,e,l,this.hot.colToProp(l),o.value,h),i.appendChild(g)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const s=e.createElement("th");i.push([-1,s]),r.appendChild(s)}this.samples.forEach(s=>{xe(s.strings,n=>{const o=n.col,l=e.createElement("th");i.push([o,l]),r.appendChild(l)})}),this.table.tHead.appendChild(r),xe(i,s=>{const[n,o]=s;this.hot.view.appendColHeader(n,o)})}createCol(e){const{rootDocument:r}=this.hot,i=r.createDocumentFragment();return this.samples.forEach(s=>{xe(s.strings,n=>{const o=n.row,l=this.hot.getCellMeta(o,e),h=this.hot.getCellRenderer(l),d=r.createElement("td"),g=r.createElement("tr");d.setAttribute("ghost-table",1),h(this.hot,d,o,e,this.hot.colToProp(e),n.value,l),g.appendChild(d),i.appendChild(g)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const i=this.hot.rootDocument.createElement("col");let s=0;r>=0&&e>=0&&(s=this.hot.getCellMeta(r,e).colspan);let n=this.hot.getColWidth(e);if(s>1)for(let o=e+1;o<e+s;o++)n+=this.hot.getColWidth(o);return i.style.width=`${n}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),n=r.createElement("thead"),o=r.createElement("tbody"),l=r.createElement("colgroup"),h=r.createElement("tr"),d=r.createElement("th");return this.isVertical()&&s.appendChild(l),this.isHorizontal()&&(h.appendChild(d),n.appendChild(h),s.style.tableLayout="auto",s.style.width="auto"),s.appendChild(n),this.isVertical()&&o.appendChild(h),s.appendChild(o),at(s,e),i.appendChild(s),{fragment:i,table:s,tHead:n,tBody:o,colGroup:l,tr:h,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,i=r.createDocumentFragment(),s=r.createElement("div"),n=`htGhostTable htAutoSize ${e.trim()}`;return at(s,n),i.appendChild(s),{fragment:i,container:s}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function fx(t,e,r){return(e=G3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G3e(t){var e=Y3e(t,"string");return typeof e=="symbol"?e:e+""}function Y3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Q_{static get SAMPLE_COUNT(){return 3}constructor(e){fx(this,"samples",null),fx(this,"dataFactory",null),fx(this,"customSampleCount",null),fx(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:Q_.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,i){const s=new Map,{from:n,to:o}=typeof i=="number"?{from:i,to:i}:i;return pr(n,o,l=>{const h=this.generateSample(e,r,l);s.set(l,h)}),s}generateSample(e,r,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const s=new Map,n=e==="row"?"col":"row",o=[];return pr(r.from,r.to,l=>{const h=e==="row"?this.dataFactory(i,l):this.dataFactory(l,i);if(h===!1)return;const{value:d,bundleSeed:g}=h,y=typeof g=="string"&&g.length>0;let C;y?C=g:Qr(d)?C=`${Object.keys(d).length}`:Array.isArray(d)?C=`${d.length}`:C=`${as(d).length}`,s.has(C)||s.set(C,{needed:this.getSampleCount(),strings:[]});const x=s.get(C);x.needed&&(!(o.indexOf(d)>-1)||this.allowDuplicates||y)&&(x.strings.push({value:d,[n]:l}),o.push(d),x.needed-=1)}),s}}function K3e(t,e){YJ(t,e),e.add(t)}function WV(t,e,r){YJ(t,e),e.set(t,r)}function YJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tw(t,e,r){return(e=X3e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function X3e(t){var e=q3e(t,"string");return typeof e=="symbol"?e:e+""}function q3e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sg(t,e){return t.get(Iu(t,e))}function p6(t,e,r){return t.set(Iu(t,e),r),r}function Iu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("modifyAutoColumnSizeSeed");const JO="autoColumnSize",J3e=10,Q3e="autoColumnSize";var cp=new WeakMap,p1=new WeakMap,bh=new WeakSet;class cy extends On{static get PLUGIN_KEY(){return JO}static get PLUGIN_PRIORITY(){return J3e}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),K3e(this,bh),tw(this,"ghostTable",new GJ(this.hot)),tw(this,"samplesGenerator",new Q_((r,i)=>{const s=this.hot.toPhysicalRow(r),n=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(n))return!1;const o=this.hot.getCellMeta(r,i);let l="";o.spanned||(l=this.hot.getDataAtCell(r,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,o,l)),{value:l,bundleSeed:h}})),tw(this,"inProgress",!1),tw(this,"measuredColumns",0),tw(this,"columnWidthsMap",new $d),WV(this,cp,[]),WV(this,p1,[]),this.hot.columnIndexMapper.registerMap(Q3e,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,i,s)=>Iu(bh,this,jV).call(this,r,i,s))}isEnabled(){return this.hot.getSettings()[JO]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Iu(bh,e,tPe).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Iu(bh,e,rPe).call(e,...s)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Iu(bh,e,iPe).call(e,...s)}),this.addHook("beforeRender",()=>Iu(bh,this,ePe).call(this)),this.addHook("modifyColWidth",(i,s)=>this.getColumnWidth(s,i)),this.addHook("init",()=>Iu(bh,this,nPe).call(this)),super.enablePlugin()}updatePlugin(){p6(p1,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,i)=>Iu(bh,this,jV).call(this,e,r,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const i=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:r},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,n=typeof r=="number"?{from:r,to:r}:r;pr(s.from,s.to,o=>{let l=this.hot.toPhysicalColumn(o);l===null&&(l=o),(i||this.columnWidthsMap.getValueAtIndex(l)===null&&!this.hot._getColWidthFromSettings(l))&&this.samplesGenerator.generateColumnSamples(o,n).forEach((d,g)=>this.ghostTable.addColumn(g,d))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,l)=>{const h=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(h,l)})},!0),this.measuredColumns=s.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countCols()-1;let n=null;this.inProgress=!0;const o=()=>{if(!this.hot){GE(n),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+cy.CALCULATION_STEP,s)},e,r),i=i+cy.CALCULATION_STEP+1,i<s?n=zE(o):(GE(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateColumnsWidth({from:0,to:l},e,r),i=l+1),i<s?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[JO];let r=cy.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Qr(e)&&(r=e.syncLimit,FX(r)?r=gq(i,r):r>>=0),Math.min(r,i)}getColumnWidth(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=r;return s===void 0&&(s=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof s=="number"&&(s=Math.max(s,u1))),s}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,s,n)=>{const o=sg(cp,this).length;return(o-1<n||sg(cp,this)[n]!==s)&&i.push(this.hot.toVisualColumn(n)),o-1<n?sg(cp,this).push(s):sg(cp,this)[n]=s,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Z3e(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const i=this.hot.toPhysicalColumn(r);i!==null&&(this.hot._getColWidthFromSettings(i)||this.samplesGenerator.generateColumnSamples(r,e).forEach((n,o)=>this.ghostTable.addColumn(o,n)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,i)=>{const s=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function ePe(){this.calculateVisibleColumnsWidth(),this.inProgress||(Iu(bh,this,Z3e).call(this,sg(p1,this)),p6(p1,this,[]))}function tPe(t,e){e||this.recalculateAllColumnsWidth()}function rPe(t){const e=t.reduce((r,i)=>{let[,s]=i;const n=this.hot.propToCol(s);return Number.isInteger(n)&&r.indexOf(n)===-1&&r.push(n),r},[]);sg(p1,this).push(...e)}function jV(t,e,r){let i=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function nPe(){p6(cp,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function iPe(t){const e=t.reduce((r,i)=>{var s;const n=(s=i.address)===null||s===void 0?void 0:s.col;if(Number.isInteger(n)){const o=this.hot.toVisualColumn(n);r.indexOf(o)===-1&&r.push(o)}return r},[]);sg(p1,this).push(...e)}const og={horizontal:"horizontal",vertical:"vertical"};function sPe(t,e,r){let i,s,n;return e[0]===t[0]&&e[1]<t[1]?(n="left",i=r(e[0],e[1]),s=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(n="right",i=r(e[0],t[3]+1),s=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(n="up",i=r(e[0],e[1]),s=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(n="down",i=r(t[2]+1,e[1]),s=r(e[2],e[3])),i&&i.normalize(),s&&s.normalize(),{directionOfDrag:n,startOfDragCoords:i,endOfDragCoords:s}}function oPe(t){const e={};return t===!0?(e.directions=Object.keys(og),e.autoInsertRow=!0):Qr(t)?(rr(t.autoInsertRow)?t.direction===og.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,rr(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(og)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function aPe(t,e){lPe(t,e),e.add(t)}function lPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fm(t,e,r){return(e=cPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cPe(t){var e=uPe(t,"string");return typeof e=="symbol"?e:e+""}function uPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("modifyAutofillRange");Xt.getSingleton().register("beforeAutofill");Xt.getSingleton().register("afterAutofill");const UV="autofill",hPe=20,fPe=["fillHandle"],dPe="insert_row_below",gPe=200;var Mm=new WeakSet;class mPe extends On{constructor(){super(...arguments),aPe(this,Mm),Fm(this,"addingStarted",!1),Fm(this,"mouseDownOnCellCorner",!1),Fm(this,"mouseDragOutside",!1),Fm(this,"handleDraggedCells",0),Fm(this,"directions",[]),Fm(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return UV}static get PLUGIN_PRIORITY(){return hPe}static get SETTING_KEYS(){return[UV,...fPe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>rw(Mm,this,vPe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>rw(Mm,this,pPe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>rw(Mm,this,wPe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:i}=e.getTopStartCorner(),{row:s,col:n}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:i,endRow:s,endCol:n}]),l=[],h=[],d=[];return xe(o,g=>{for(let y=g.startRow;y<=g.endRow;y+=1)l.indexOf(y)===-1&&l.push(y);for(let y=g.startCol;y<=g.endCol;y+=1)h.indexOf(y)===-1&&h.push(y)}),xe(l,g=>{const y=[];xe(h,C=>{y.push(this.hot.getCopyableData(g,C))}),d.push(y)}),d}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,i,s]=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.getSelectedRangeLast(),o=n.getTopStartCorner(),l=n.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[o.row,o.col,l.row,l.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(l.row,i),Math.max(l.col,s)],h),{directionOfDrag:g,startOfDragCoords:y,endOfDragCoords:C}=sPe(h,d,(x,_)=>this.hot._createCellCoords(x,_));if(y&&y.row>-1&&y.col>-1){const x=this.getSelectionData(),_=n.clone(),E=this.hot._createCellRange(y,y,C),R=this.hot.runHooks("beforeAutofill",x,_,E,g);if(R===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let I=R;const F=R;if(["up","left"].indexOf(g)>-1&&!(F.length===1&&F[0].length===0))if(I=[],g==="up"){const H=C.row-y.row+1,z=H%F.length;for(let q=0;q<H;q++)I.push(F[(q+(F.length-z))%F.length])}else{const H=C.col-y.col+1,z=H%F[0].length;for(let q=0;q<F.length;q++){I.push([]);for(let re=0;re<H;re++)I[q].push(F[q][(re+(F[q].length-z))%F[q].length])}}this.hot.populateFromArray(y.row,y.col,I,C.row,C.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",I,_,E,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),i=r.getBottomEndCorner();let s=e;if(this.directions.includes(og.vertical)&&this.directions.includes(og.horizontal)){const n=r.getTopStartCorner();(i.col<=e.col||n.col>=e.col)&&(s=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||n.row>e.row)&&(s=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(og.vertical))s=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(og.horizontal))s=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(s)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(dPe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},gPe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&r[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),i=this.hot.countRows();let s;for(let n=e[2]+1;n<i;n++){for(let h=e[1];h<=e[3];h++){const d=r[n][h];if(!Zi(d))return-1}const o=r[n][e[1]-1],l=r[n][e[3]+1];(!Zi(o)||!Zi(l))&&(s=n)}return s}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...on(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,i=zs(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+es(this.hot.table),s=zs(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+os(this.hot.table);return e.clientY>i&&e.clientX<=s}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>rw(Mm,this,yPe).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>rw(Mm,this,CPe).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=oPe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function pPe(){this.selectAdjacent()&&this.fillIn()}function vPe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function wPe(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function yPe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function CPe(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function SPe(t,e){KJ(t,e),e.add(t)}function bPe(t,e,r){KJ(t,e),e.set(t,r)}function KJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function km(t,e,r){return(e=xPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xPe(t){var e=EPe(t,"string");return typeof e=="symbol"?e:e+""}function EPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TPe(t,e,r){return t.set(Pu(t,e),r),r}function v6(t,e){return t.get(Pu(t,e))}function Pu(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const QO="autoRowSize",_Pe=40,RPe="autoRowSize";var lC=new WeakMap,xh=new WeakSet;class uy extends On{static get PLUGIN_KEY(){return QO}static get PLUGIN_PRIORITY(){return _Pe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),SPe(this,xh),km(this,"headerHeight",null),km(this,"ghostTable",new GJ(this.hot)),km(this,"samplesGenerator",new Q_((r,i)=>{const s=this.hot.toPhysicalRow(r),n=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(s)||this.hot.columnIndexMapper.isHidden(n)||r>=0&&i>=0&&this.hot.getCellMeta(r,i).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,i):r===-1&&(o=this.hot.getColHeader(i)),{value:o}})),km(this,"inProgress",!1),km(this,"measuredRows",0),km(this,"rowHeightsMap",new $d),bPe(this,lC,[]),this.hot.rowIndexMapper.registerMap(RPe,this.rowHeightsMap),this.addHook("beforeRowResize",(r,i,s)=>Pu(xh,this,zV).call(this,r,i,s))}isEnabled(){const e=this.hot.getSettings()[QO];return e===!0||Qr(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const r=this.getSetting("samplingRatio");r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pu(xh,e,IPe).call(e,...s)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pu(xh,e,PPe).call(e,...s)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Pu(xh,e,MPe).call(e,...s)}),this.addHook("beforeRender",()=>Pu(xh,this,OPe).call(this)),this.addHook("modifyRowHeight",(i,s)=>this.getRowHeight(s,i)),this.addHook("init",()=>Pu(xh,this,FPe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,i)=>Pu(xh,this,zV).call(this,e,r,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const i=this.hot.renderCall;this.calculateRowsHeight({from:e,to:r},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=typeof e=="number"?{from:e,to:e}:e,n=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,n);this.ghostTable.addColumnHeadersRow(o.get(-1))}pr(s.from,s.to,o=>{let l=this.hot.toPhysicalRow(o);l===null&&(l=o),(i||this.rowHeightsMap.getValueAtIndex(l)===null)&&this.samplesGenerator.generateRowSamples(o,n).forEach((d,g)=>this.ghostTable.addRow(g,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,l)=>{o<0?this.headerHeight=l:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),l)})},!0),this.measuredRows=s.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const s=this.hot.countRows()-1;let n=null;this.inProgress=!0;const o=()=>{if(!this.hot){GE(n),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+uy.CALCULATION_STEP,s)},e,r),i=i+uy.CALCULATION_STEP+1,i<s?n=zE(o):(GE(n),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},l=this.getSyncCalculationLimit();l>=0&&(this.calculateRowsHeight({from:0,to:l},e,r),i=l+1),i<s?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[QO];let r=uy.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Qr(e)&&(r=e.syncLimit,FX(r)?r=gq(i,r):r>>=0),Math.min(r,i)}getRowHeight(e,r){const i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let s=r;return i!==null&&i>(r||0)&&(s=i),s}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pr(Math.min(r,i),Math.max(r,i),s=>{this.rowHeightsMap.setValueAtIndex(s,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function APe(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((s,n)=>this.ghostTable.addRow(n,s))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,i)=>{const s=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(s,i)})},!0),this.ghostTable.clean())}function OPe(){this.calculateVisibleRowsHeight(),this.inProgress||(Pu(xh,this,APe).call(this,v6(lC,this)),TPe(lC,this,[]))}function zV(t,e,r){let i=t;return r&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function IPe(t,e){e||this.recalculateAllRowsHeight()}function PPe(t){const e=t.reduce((r,i)=>{let[s]=i;return r.indexOf(s)===-1&&r.push(s),r},[]);v6(lC,this).push(...e)}function FPe(){this.recalculateAllRowsHeight()}function MPe(t){const e=t.reduce((r,i)=>{var s;const n=(s=i.address)===null||s===void 0?void 0:s.row;if(Number.isInteger(n)){const o=this.hot.toVisualRow(n);r.indexOf(o)===-1&&r.push(o)}return r},[]);v6(lC,this).push(...e)}const{getListWithInsertedItems:kPe,getListWithRemovedItems:NPe}=Wq("physicallyIndexed");class DPe extends qg{constructor(){super(e=>e)}insert(e,r){const i=xN(this.indexedValues,r);this.indexedValues=kPe(i,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=NPe(this.indexedValues,e);this.indexedValues=bN(r,e),super.remove(e)}}const{getListWithInsertedItems:LPe,getListWithRemovedItems:HPe}=Wq("physicallyIndexed");class $Pe extends qg{constructor(){super(e=>e)}insert(e,r){this.indexedValues=LPe(this.indexedValues,e,r,(i,s)=>this.getNextValue(s)),super.insert(e,r)}remove(e){this.indexedValues=HPe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function BPe(t,e){VPe(t,e),e.add(t)}function VPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WPe(t,e,r){return(e=jPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jPe(t){var e=UPe(t,"string");return typeof e=="symbol"?e:e+""}function UPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zPe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const GV="bindRowsWithHeaders",GPe=210,YPe="loose",YV=new Map([["loose",DPe],["strict",$Pe]]);var KV=new WeakSet;class KPe extends On{constructor(){super(...arguments),BPe(this,KV),WPe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return GV}static get PLUGIN_PRIORITY(){return GPe}isEnabled(){return!!this.hot.getSettings()[GV]}enablePlugin(){var e;if(this.enabled)return;const r=(e=YV.get(this.getSetting()))!==null&&e!==void 0?e:YV.get(YPe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",i=>zPe(KV,this,XPe).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function XPe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function qPe(t,e){XJ(t,e),e.add(t)}function JPe(t,e,r){XJ(t,e),e.set(t,r)}function XJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XV(t,e,r){return(e=QPe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QPe(t){var e=ZPe(t,"string");return typeof e=="symbol"?e:e+""}function ZPe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qV(t,e){return t.get(Ip(t,e))}function ZO(t,e,r){return t.set(Ip(t,e),r),r}function Ip(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const j2="collapsibleColumns",eFe=290,tFe=["nestedHeaders"],Gp="collapsibleIndicator",JV=j2,QV=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Nm=new WeakMap,nw=new WeakSet;class rFe extends On{constructor(){super(...arguments),qPe(this,nw),XV(this,"nestedHeadersPlugin",null),XV(this,"headerStateManager",null),JPe(this,Nm,null)}static get PLUGIN_KEY(){return j2}static get PLUGIN_PRIORITY(){return eFe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[j2,...tFe]}isEnabled(){return!!this.hot.getSettings()[j2]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||Nn("You need to configure the Nested Headers plugin in order to use collapsible headers."),ZO(Nm,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Ip(nw,this,sFe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ip(nw,e,oFe).call(e,...s)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Ip(nw,e,nFe).call(e,...s)}),this.addHook("beforeOnCellMouseDown",(i,s,n)=>Ip(nw,this,iFe).call(this,i,s,n)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),ZO(Nm,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:s,isCollapsed:n,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,i))!==null&&e!==void 0?e:{};if(s)return n?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:JV,relativeToGroup:Bd,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JV)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,s=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,n=function(o){o&&o.parentNode.removeChild(o)};pr(0,e-1,o=>{const l=r.childNodes[o],h=i.childNodes[o],d=s?s.childNodes[o]:null;pr(0,l.childNodes.length-1,g=>{let y=l.childNodes[g].querySelector(`.${Gp}`);n(y),h&&h.childNodes[g]&&(y=h.childNodes[g].querySelector(`.${Gp}`),n(y)),s&&d&&d.childNodes[g]&&(y=d.childNodes[g].querySelector(`.${Gp}`),n(y))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(i=>{const{collapsible:s,origColspan:n,headerLevel:o,columnIndex:l,isCollapsed:h}=i;if(s===!0&&n>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:l}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!QV.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const i=Ad(e,x=>{let{row:_}=x;return _<0});let s=i.length>0;xe(i,x=>{var _;let{row:E,col:R}=x;const{collapsible:I,isCollapsed:F}=(_=this.headerStateManager.getHeaderSettings(E,R))!==null&&_!==void 0?_:{};if(!I||F&&r==="collapse"||!F&&r==="expand")return s=!1,!1});const n=[],o=[];s&&xe(i,x=>{let{row:_,col:E}=x;const{colspanCompensation:R,affectedColumns:I,rollbackModification:F}=this.headerStateManager.triggerNodeModification(r,_,E);R>0&&(o.push(...I),n.push(F))});const l=this.getCollapsedColumns();let h=[];r==="collapse"?h=IX([...l,...o]):r==="expand"&&(h=Ad(l,x=>!o.includes(x)));const d=QV.get(r);if(this.hot.runHooks(d.beforeHook,l,h,s)===!1){xe(n,x=>{x()});return}this.hot.batchExecution(()=>{xe(o,x=>{qV(Nm,this).setValueAtIndex(this.hot.toPhysicalColumn(x),d.hideColumn)})},!0);const y=this.getCollapsedColumns().length!==l.length,C=this.hot.getSelectedRangeLast();if(r==="collapse"&&y&&C){const{row:x,col:_}=C.highlight;if((this.hot.rowIndexMapper.isHidden(x)||this.hot.columnIndexMapper.isHidden(_))&&o.includes(_)){const R=x>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(x,1,!0):x,I=_>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(_,1,!0):_;R!==null&&I!==null&&this.hot.selectCell(R,I)}}this.hot.runHooks(d.afterHook,l,h,s,y),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return qV(Nm,this).getHiddenIndexes()}destroy(){ZO(Nm,this,null),super.destroy()}}function nFe(t,e,r){var i;const{collapsible:s,origColspan:n,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(r,t))!==null&&i!==void 0?i:{},l=s&&n>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=e.querySelector(`.${Gp}`);if(F1(e,[jl("")[0]]),l)d||(d=this.hot.rootDocument.createElement("div"),at(d,Gp),e.querySelector("div:first-child").appendChild(d)),_r(d,["collapsed","expanded"]),o?(at(d,"collapsed"),Ag(d,"+"),h&&Or(e,...jl(!1))):(at(d,"expanded"),Ag(d,"-"),h&&Or(e,...jl(!0))),h&&Or(d,...Ld());else{var g;(g=d)===null||g===void 0||g.remove()}}function iFe(t,e){Rr(t.target,Gp)&&(Rr(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Rr(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),jc(t))}function sFe(){this.updatePlugin()}function oFe(t,e){e||this.updatePlugin()}function x0(t,e,r){return(e=aFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aFe(t){var e=lFe(t,"string");return typeof e=="symbol"?e:e+""}function lFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cFe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],uFe=!1,hFe=!0,fFe=!0;class dFe{constructor(e,r){x0(this,"hot",void 0),x0(this,"sortingStates",new U_),x0(this,"sortEmptyCells",uFe),x0(this,"indicator",hFe),x0(this,"headerAction",fFe),x0(this,"compareFunctionFactory",void 0),x0(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){Qr(e)&&Zr(e,(r,i)=>{cFe.includes(i)&&(this[i]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[i]=r;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Qr(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[i,s]=r;return{column:this.hot.toVisualColumn(i),...s}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(rr(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function qJ(t,e,r){const i=e.locale;return function(s,n){const{sortEmptyCells:o}=r;return typeof s=="string"&&(s=s.toLocaleLowerCase(i)),typeof n=="string"&&(n=n.toLocaleLowerCase(i)),s===n?Wu:Zi(s)?Zi(n)?Wu:o&&t==="asc"?Hi:$i:Zi(n)?o&&t==="asc"?$i:Hi:isNaN(s)&&!isNaN(n)?t==="asc"?$i:Hi:!isNaN(s)&&isNaN(n)||(isNaN(s)||isNaN(n)||(s=parseFloat(s),n=parseFloat(n)),s<n)?t==="asc"?Hi:$i:s>n?t==="asc"?$i:Hi:Wu}}const JJ="default";function gFe(t,e,r){return function(i,s){const n=parseFloat(i),o=parseFloat(s),{sortEmptyCells:l}=r;if(n===o||isNaN(n)&&isNaN(o))return Wu;if(l){if(Zi(i))return t==="asc"?Hi:$i;if(Zi(s))return t==="asc"?$i:Hi}return isNaN(n)?$i:isNaN(o)?Hi:n<o?t==="asc"?Hi:$i:n>o?t==="asc"?$i:Hi:Wu}}const mFe="numeric";function pFe(t,e,r){const i=e.checkedTemplate,s=e.uncheckedTemplate,{sortEmptyCells:n}=r;return function(o,l){const h=Zi(o),d=Zi(l),g=h?s:o,y=d?s:l,C=g===s||g===i,x=y===s||y===i;if(n===!1){if(h&&d===!1)return $i;if(h===!1&&d)return Hi}return C===!1&&x?t==="asc"?Hi:$i:C&&x===!1?t==="asc"?$i:Hi:C===!1&&x===!1?qJ(t,e,r)(o,l):g===s&&y===i?t==="asc"?Hi:$i:g===i&&y===s?t==="asc"?$i:Hi:Wu}}const vFe="checkbox";function wFe(t,e,r){return nQ(t,e.dateFormat,r)}const yFe="date";function CFe(t,e,r){return nQ(t,e.timeFormat,r)}const SFe="time",{register:iS,getItem:ZV,hasItem:bFe}=Uc("sorting.compareFunctionFactory"),{register:QJ,getItem:xFe}=Uc("sorting.mainSortComparator");function ZJ(t){return bFe(t)?ZV(t):ZV(JJ)}iS(vFe,pFe);iS(yFe,wFe);iS(JJ,qJ);iS(mFe,gFe);iS(SFe,CFe);const Wu=0,Hi=-1,$i=1;function EFe(t,e){const r=xFe(e);for(var i=arguments.length,s=new Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];t.sort(r(...s))}const iT="asc",sT="desc",eQ="colHeader";function TFe(t){if(Qr(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[iT,sT].includes(r)}function _Fe(t){if(t.some(r=>TFe(r)===!1))return!1;const e=t.map(r=>{let{column:i}=r;return i});return new Set(e).size===e.length}function eW(t){if(t!==sT)return t===iT?sT:iT}function tQ(t){return t.querySelector(`.${eQ}`)}function rQ(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function w6(t,e,r){return t===-1&&e>=0&&Og(r)===!1}function nQ(t,e,r){return function(i,s){const{sortEmptyCells:n}=r;if(i===s)return Wu;if(Zi(i))return Zi(s)?Wu:n&&t==="asc"?Hi:$i;if(Zi(s))return n&&t==="asc"?$i:Hi;const o=mt(i,e),l=mt(s,e);return o.isValid()?l.isValid()?l.isAfter(o)?t==="asc"?Hi:$i:l.isBefore(o)?t==="asc"?$i:Hi:Wu:Hi:$i}}const RFe="ascending",AFe="descending",iQ="indicatorDisabled",sQ="columnSorting",oQ="sortAction",aQ=new Map([[iT,RFe],[sT,AFe]]);function OFe(t,e,r,i){const s=[sQ];if(i&&s.push(oQ),r===!1)return s.push(iQ),s;const n=t.getSortOrderOfColumn(e);return rr(n)&&s.push(aQ.get(n)),s}function IFe(){return Array.from(aQ.values()).concat(oQ,iQ,sQ)}function PFe(t,e){return function(r,i){const[,...s]=r,[,...n]=i;return function(l){const h=t[l],d=e[l],g=s[l],y=n[l],C=d.columnSorting;return(C.compareFunctionFactory?C.compareFunctionFactory:ZJ(d.type))(h,d,C)(g,y)}(0)}}function FFe(t,e){MFe(t,e),e.add(t)}function MFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dx(t,e,r){return(e=kFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kFe(t){var e=NFe(t,"string");return typeof e=="symbol"?e:e+""}function NFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function up(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oT="columnSorting",DFe=50,aT="append",LFe="replace",tW=oT;QJ(oT,PFe);Xt.getSingleton().register("beforeColumnSort");Xt.getSingleton().register("afterColumnSort");var q0=new WeakSet;class lQ extends On{constructor(){super(...arguments),FFe(this,q0),dx(this,"columnStatesManager",null),dx(this,"columnMetaCache",null),dx(this,"pluginKey",oT),dx(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return oT}static get PLUGIN_PRIORITY(){return DFe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new dFe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new $d(r=>{let i=this.hot.toVisualColumn(r);return i===null&&(i=r),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,i)=>up(q0,this,HFe).call(this,r,i)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return up(q0,e,BFe).call(e,...i)}),this.addHook("afterOnCellMouseDown",(r,i)=>this.onAfterOnCellMouseDown(r,i)),this.addHook("afterInit",()=>up(q0,this,gF).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return up(q0,e,$Fe).call(e,...i)}),this.hot.view&&up(q0,this,gF).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,i)=>{const s=tQ(i);rQ(r,i)===!1||s===null||this.updateHeaderClasses(s)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Bd,position:"before",group:tW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tW)}sort(e){const r=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),s=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",r,i,s)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new jq),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),s&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",r,s?i:r,s),s&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return rr(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return _Fe(e)&&e.every(i=>{let{column:s}=i;return s<=r&&s>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),i=s=>{let{column:n,...o}=s;return{column:this.hot.toPhysicalColumn(n),...o}};r.initialConfig=on(e,i),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,i=s=>{let{column:n,...o}=s;return{column:this.hot.toVisualColumn(n),...o}};return rr(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=on(r.initialConfig,i)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(rr(r)){const s=eW(r);return rr(s)?{column:e,sortOrder:s}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:eW()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:aT;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),s=i!==-1,n=this.getSortConfig(),o=this.getColumnNextConfig(e);if(s){if(Ai(o))return[...n.slice(0,i),...n.slice(i+1)];if(r===aT)return[...n.slice(0,i),...n.slice(i+1),o];if(r===LFe)return[...n.slice(0,i),o,...n.slice(i+1)]}return rr(o)?n.concat(o):n}getPluginColumnConfig(e){if(Qr(e)){const r=e[this.pluginKey];if(Qr(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),s=this.hot.getCellMeta(0,e),n=Object.getPrototypeOf(s);return Array.isArray(n.columns)?Object.assign(i,r,this.getPluginColumnConfig(n.columns[e])):ci(n.columns)?Object.assign(i,r,this.getPluginColumnConfig(n.columns(e))):Object.assign(i,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),i=Object.create(r);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],i=this.hot.countRows(),s=d=>on(e,g=>this.hot.getDataAtCell(d,g.column));for(let d=0;d<this.getNumberOfRowsToSort(i);d+=1)r.push([this.hot.toPhysicalRow(d)].concat(s(d)));const n=on(r,d=>d[0]);EFe(r,this.pluginKey,on(e,d=>d.sortOrder),on(e,d=>this.getFirstCellSettings(d.column)));for(let d=r.length;d<i;d+=1)r.push([d].concat(s(d)));const o=on(r,d=>d[0]),l=new Map(on(n,(d,g)=>[d,o[g]])),h=on(this.hot.rowIndexMapper.getIndexesSequence(),d=>l.has(d)?l.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(Qr(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||Qr(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(_r(e,IFe()),this.enabled!==!1){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];at(e,OFe(...i))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),rr(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Rr(e.target,eQ)}onAfterOnCellMouseDown(e,r){if(w6(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const i=this.hot.getActiveEditor(),s=this.getColumnNextConfig(r.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(s)}):this.sort(s)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function gF(){const t=this.getAllSavedSortSettings();if(Qr(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function HFe(t,e){const r=tQ(e);if(rQ(t,e)===!1||r===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],s=i.indicator,n=i.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,s,n),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);Or(e,...dSe(o?`${o}ending`:"none"))}}function $Fe(t){t===!0&&this.hot.view&&up(q0,this,gF).call(this)}function BFe(t,e,r,i){w6(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function E0(t,e,r){return(e=VFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VFe(t){var e=WFe(t,"string");return typeof e=="symbol"?e:e+""}function WFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jFe{constructor(e,r){E0(this,"plugin",void 0),E0(this,"hot",void 0),E0(this,"endpoints",[]),E0(this,"settings",void 0),E0(this,"settingsType","array"),E0(this,"currentEndpoint",null),E0(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),xe(i,s=>{const n={};this.assignSetting(s,n,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(s,n,"reversedRowCoords",!1),this.assignSetting(s,n,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,n,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(s,n,"sourceColumn",s.destinationColumn),this.assignSetting(s,n,"type","sum"),this.assignSetting(s,n,"forceNumeric",!1),this.assignSetting(s,n,"suppressDataTypeErrors",!0),this.assignSetting(s,n,"customFunction",null),this.assignSetting(s,n,"readOnly",!0),this.assignSetting(s,n,"roundFloat",!1),r.push(n)}),r}assignSetting(e,r,i,s){if(i==="ranges"&&e[i]===void 0){r[i]=s;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(s instanceof Error)throw s;r[i]=s}else i==="destinationRow"&&r.reversedRowCoords?r[i]=this.hot.countRows()-e[i]-1:r[i]=e[i]}resetSetupBeforeStructureAlteration(e,r,i){if(this.settingsType!=="function")return;const s=e.indexOf("row")>-1?"row":"col",n=this.getAllEndpoints();xe(n,o=>{s==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),s==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(n,!1)}resetSetupAfterStructureAlteration(e,r,i,s,n){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const C=()=>(this.hot.removeHook("beforeViewRender",C),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",C);return}const l=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),g=e.indexOf("move_row")===0,y=r;xe(d,C=>{l==="row"&&C.destinationRow>=y&&(C.alterRowOffset=h*i),l==="col"&&C.destinationColumn>=y&&(C.alterColumnOffset=h*i)}),this.resetAllEndpoints(d,!g),g?xe(d,C=>{this.extendEndpointRanges(C,y,s[0],s.length),this.recreatePhysicalRanges(C),this.clearOffsetInformation(C)}):xe(d,C=>{this.shiftEndpointCoordinates(C,y)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,i,s){xe(e.ranges,n=>{n[1]&&(r>=n[0]&&r<=n[1]?i>n[1]?n[1]+=s:i<n[0]&&(n[0]-=s):i>=n[0]&&i<=n[1]&&(n[1]-=s,r<=n[0]&&(n[0]+=1,n[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,i=[],s=[];xe(r,n=>{const o=[];if(n[1])for(let l=n[0];l<=n[1];l++)o.push(this.hot.toPhysicalRow(l));else o.push(this.hot.toPhysicalRow(n[0]));s.push(o)}),xe(s,n=>{let o=[];xe(n,(l,h)=>{h===0?o.push(l):n[h]!==n[h-1]+1&&(o.push(n[h-1]),i.push(o),o=[],o.push(l)),h===n.length-1&&(o.push(l),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,xe(e.ranges,i=>{xe(i,(s,n)=>{s>=r&&(i[n]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(s=>{const n=s.alterRowOffset||0,o=s.alterColumnOffset||0;return s.destinationRow+n>=this.hot.countRows()||s.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],xe(e,s=>{this.resetEndpointValue(s,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],xe(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],xe(e,(i,s,n)=>{`${i[2]||""}`!=`${i[3]}`&&xe(this.getAllEndpoints(),(o,l)=>{this.hot.propToCol(n[s][1])===o.sourceColumn&&r.indexOf(l)===-1&&r.push(l)})}),xe(r,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const i=this.hot.getCellMeta(r,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,s=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?i:0)),this.hot.toVisualColumn(e.destinationColumn+(r?s:0)),""])}setEndpointValue(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const o=this.hot.getCellMeta(n,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let l=0;Number.isInteger(o)&&(l=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(l)}i?this.hot.setDataAtCell(s,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([s,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Nn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function eI(t){return t==null||isNaN(t)}function UFe(t,e){zFe(t,e),e.add(t)}function zFe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GFe(t,e,r){return(e=YFe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function YFe(t){var e=KFe(t,"string");return typeof e=="symbol"?e:e+""}function KFe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const tI="columnSummary",XFe=220;var iw=new WeakSet;class qFe extends On{constructor(){super(...arguments),UFe(this,iw),GFe(this,"endpoints",null)}static get PLUGIN_KEY(){return tI}static get PLUGIN_PRIORITY(){return XFe}isEnabled(){return!!this.hot.getSettings()[tI]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[tI],this.endpoints=new jFe(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,JFe).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,ZFe).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,QFe).call(e,...i)}),this.addHook("beforeCreateRow",(r,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,i,null,s)),this.addHook("beforeCreateCol",(r,i,s)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,i,null,s)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(r,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,i,null,s)),this.addHook("afterCreateCol",(r,i,s)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,i,null,s)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return gx(iw,e,eMe).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return Zr(e.ranges,i=>{r+=this.getPartialSum(i,e.sourceColumn)}),r}getPartialSum(e,r){let i=0,s=e[1]||e[0],n=null,o=0;do{if(n=this.getCellValue(s,r),n=eI(n)?null:n,n!==null){const l=(`${n}`.split(".")[1]||[]).length||1;l>o&&(o=l)}i+=n||0,s-=1}while(s>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,r){let i=null;return Zr(e.ranges,s=>{const n=this.getPartialMinMax(s,e.sourceColumn,r);if(i===null&&n!==null&&(i=n),n!==null)switch(r){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n);break}}),i===null?"Not enough data":i}getPartialMinMax(e,r,i){let s=null,n=e[1]||e[0],o;do{if(o=this.getCellValue(n,r),o=eI(o)?null:o,s===null)s=o;else if(o!==null)switch(i){case"min":s=Math.min(s,o);break;case"max":s=Math.max(s,o);break}n-=1}while(n>=e[0]);return s}countEmpty(e,r){let i,s=0,n=e[1]||e[0];do i=this.getCellValue(n,r),i=eI(i)?null:i,i===null&&(s+=1),n-=1;while(n>=e[0]);return s}countEntries(e){let r=0;const i=e.ranges;return Zr(i,s=>{const n=s[1]===void 0?1:s[1]-s[0]+1,o=this.countEmpty(s,e.sourceColumn);r+=n,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),i=this.countEntries(e);return r/i}getCellValue(e,r){const i=this.hot.toVisualRow(e),s=this.hot.toVisualColumn(r);let n=this.hot.getSourceDataAtCell(e,r),o="";if(i!==null&&s!==null&&(o=this.hot.getCellMeta(i,s).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof n=="string"&&(n=n.replace(/,/,".")),n=parseFloat(n)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ln`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return n}}function JFe(){this.endpoints.initEndpoints()}function QFe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function ZFe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function eMe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function tMe(t,e){cQ(t,e),e.add(t)}function rI(t,e,r){cQ(t,e),e.set(t,r)}function cQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hp(t,e){return t.get(y6(t,e))}function mF(t,e,r){return t.set(y6(t,e),r),r}function y6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var lT=new WeakMap,mx=new WeakMap,px=new WeakMap,rW=new WeakSet;class uQ{constructor(){tMe(this,rW),rI(this,lT,!0),rI(this,mx,null),rI(this,px,new ResizeObserver(e=>y6(rW,this,rMe).call(this,e)))}setObservedElement(e){mF(mx,this,e)}unobserve(){hp(px,this).unobserve(hp(mx,this))}observe(){mF(lT,this,!0),hp(px,this).observe(hp(mx,this))}destroy(){hp(px,this).disconnect()}}function rMe(t){if(hp(lT,this)||!Array.isArray(t)||!t.length){mF(lT,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:i,blockSize:s}=r[0];this.runLocalHooks("resize",i,s)})}qn(uQ,mo);function T0(t,e,r){nMe(t,e),e.set(t,r)}function nMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get(hQ(t,e))}function ph(t,e,r){return t.set(hQ(t,e),r),r}function hQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var _0=new WeakMap,nI=new WeakMap,vh=new WeakMap,Af=new WeakMap,Of=new WeakMap,vx=new WeakMap,Dm=new WeakMap;class ag{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){var i=this;T0(this,_0,void 0),T0(this,nI,!1),T0(this,vh,null),T0(this,Af,void 0),T0(this,Of,void 0),T0(this,vx,!0),T0(this,Dm,new uQ),ph(_0,this,e),ph(nI,this,r),ph(Af,this,this.createEditor()),ph(Of,this,Wn(Af,this).style),Wn(Dm,this).setObservedElement(this.getInputElement()),Wn(Dm,this).addLocalHook("resize",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.runLocalHooks("resize",...n)}),this.hide()}setPosition(e,r){Wn(Of,this).left=`${e}px`,Wn(Of,this).top=`${r}px`}setSize(e,r){if(e&&r){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${r}px`}}getSize(){return{width:os(this.getInputElement()),height:es(this.getInputElement())}}observeSize(){Wn(Dm,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Wn(Of,this).display="block",ph(vx,this,!1)}hide(){Wn(Dm,this).unobserve(),Wn(vx,this)||(Wn(Of,this).display="none"),ph(vx,this,!0)}isVisible(){return Wn(Of,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Wn(_0,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Wn(_0,this).createElement("div"),r=Wn(_0,this).createElement("textarea");return e.style.display="none",ph(vh,this,Wn(_0,this).createElement("div")),Wn(vh,this).setAttribute("dir",Wn(nI,this)?"rtl":"ltr"),at(Wn(vh,this),ag.CLASS_EDITOR_CONTAINER),Wn(_0,this).body.appendChild(Wn(vh,this)),at(e,ag.CLASS_EDITOR),at(r,ag.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Wn(vh,this).appendChild(e),e}getInputElement(){return Wn(Af,this).querySelector(`.${ag.CLASS_INPUT}`)}getEditorElement(){return Wn(Af,this)}destroy(){const e=Wn(vh,this)?Wn(vh,this).parentNode:null;Wn(Af,this).parentNode.removeChild(Wn(Af,this)),ph(Af,this,null),ph(Of,this,null),Wn(Dm,this).destroy(),e&&e.removeChild(Wn(vh,this))}}qn(ag,mo);function iI(t,e,r){return(e=iMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iMe(t){var e=sMe(t,"string");return typeof e=="symbol"?e:e+""}function sMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oMe=250,aMe=250;class fQ{constructor(e){iI(this,"wasLastActionShow",!0),iI(this,"showDebounced",null),iI(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},aMe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:oMe;this.showDebounced=Gk(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}qn(fQ,mo);function lMe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function cMe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function R0(t,e){const r={};return xe(t,i=>{i.forAll((s,n)=>{s>=0&&n>=0&&(r[s]||(r[s]=[]),r[s][n]=e(s,n))})}),r}function Wf(t,e,r,i,s){xe(t,n=>{n.forAll((o,l)=>{o>=0&&l>=0&&uMe(o,l,e,r,i,s)})})}function uMe(t,e,r,i,s,n){const o=s(t,e);let l=i;o.className&&(r==="vertical"?l=lMe(o.className,i):l=cMe(o.className,i)),n(t,e,"className",l)}function dQ(t){return`<span class="selected"></span>${t}`}function U2(t,e){let r=!1;return Array.isArray(t)&&xe(t,i=>(i.forAll((s,n)=>{if(s>=0&&n>=0&&e(s,n))return r=!0,!1}),r)),r}function Z_(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:s,left:n}=i.getBoundingClientRect();r.top=s,r.left=n}return r}const Xr="---------";function hMe(){return{name:Xr}}const Fl="alignment";function fMe(){return{key:Fl,name(){return this.getTranslatedPhrase(KN)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Fl}:left`,name(){return this.getTranslatedPhrase(XN)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Fl}:center`,name(){return this.getTranslatedPhrase(qN)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Fl}:right`,name(){return this.getTranslatedPhrase(JN)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Fl}:justify`,name(){return this.getTranslatedPhrase(QN)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{name:Xr},{key:`${Fl}:top`,name(){return this.getTranslatedPhrase(ZN)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Fl}:middle`,name(){return this.getTranslatedPhrase(eD)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1},{key:`${Fl}:bottom`,name(){return this.getTranslatedPhrase(tD)},callback(){const t=this.getSelectedRange(),e=R0(t,(s,n)=>this.getCellMeta(s,n).className),r="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,r,i),Wf(t,r,i,(s,n)=>this.getCellMeta(s,n),(s,n,o,l)=>this.setCellMeta(s,n,o,l)),this.render()},disabled:!1}]}}}const eR="clear_column";function dMe(){return{key:eR,name(){return this.getTranslatedPhrase(kN)},callback(t,e){const r=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const sS="col_left";function gMe(){return{key:sS,name(){return this.getTranslatedPhrase(AN)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const oS="col_right";function mMe(){return{key:oS,name(){return this.getTranslatedPhrase(ON)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const aS="make_read_only";function pMe(){return{key:aS,checkable:!0,ariaChecked(){return U2(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(JE)},name(){let t=this.getTranslatedPhrase(JE);return U2(this.getSelectedRange(),(r,i)=>this.getCellMeta(r,i).readOnly)&&(t=dQ(t)),t},callback(){const t=this.getSelectedRange(),e=U2(t,(r,i)=>this.getCellMeta(r,i).readOnly);xe(t,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&this.setCellMeta(i,s,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const tR="redo";function vMe(){return{key:tR,name(){return this.getTranslatedPhrase(MN)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const lS="remove_col";function wMe(){return{key:lS,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(PN,e)},callback(){this.alter("remove_col",ORe(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const rR="remove_row";function yMe(){return{key:rR,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,i]=t[0];r-i!==0&&(e=1)}return this.getTranslatedPhrase(IN,e)},callback(){this.alter("remove_row",IRe(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const nR="row_above";function CMe(){return{key:nR,name(){return this.getTranslatedPhrase(_N)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const iR="row_below";function SMe(){return{key:iR,name(){return this.getTranslatedPhrase(RN)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const cC="no_items";function bMe(){return{key:cC,name(){return this.getTranslatedPhrase(TN)},disabled:!0,isCommand:!1}}const sR="undo";function xMe(){return{key:sR,name(){return this.getTranslatedPhrase(FN)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const EMe=[nR,iR,sS,oS,eR,rR,lS,sR,tR,aS,Fl,Xr,cC],TMe={[Xr]:hMe,[cC]:bMe,[nR]:CMe,[iR]:SMe,[sS]:gMe,[oS]:mMe,[eR]:dMe,[rR]:yMe,[lS]:wMe,[sR]:xMe,[tR]:vMe,[aS]:pMe,[Fl]:fMe};function gQ(){const t={};return Zr(TMe,(e,r)=>{t[r]=e()}),t}function _Me(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(zN):this.getTranslatedPhrase(UN)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function RMe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(GN)},callback(){this.getSelectedRangeLast().forAll((r,i)=>{r>=0&&i>=0&&t.removeCommentAtCell(r,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function AMe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(YN);return U2(this.getSelectedRange(),(i,s)=>t.getCommentMeta(i,s,z2))?dQ(e):e},callback(){this.getSelectedRangeLast().forAll((r,i)=>{if(r>=0&&i>=0){const s=!!t.getCommentMeta(r,i,z2);t.updateCommentMeta(r,i,{[z2]:!s})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function OMe(t,e){mQ(t,e),e.add(t)}function Lm(t,e,r){mQ(t,e),e.set(t,r)}function mQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IMe(t,e,r){return(e=PMe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PMe(t){var e=FMe(t,"string");return typeof e=="symbol"?e:e+""}function FMe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ld(t,e,r){return t.set(Ol(t,e),r),r}function tn(t,e){return t.get(Ol(t,e))}function Ol(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const cT="comments",MMe=60,Oh="comment",jw="value",pQ="style",z2="readOnly",wx=cT,pF=`plugin:${cT}`;var ei=new WeakMap,Ru=new WeakMap,oR=new WeakMap,G2=new WeakMap,vF=new WeakMap,uT=new WeakMap,oc=new WeakSet;class kMe extends On{constructor(){super(...arguments),OMe(this,oc),IMe(this,"range",{}),Lm(this,ei,null),Lm(this,Ru,null),Lm(this,oR,!1),Lm(this,G2,!1),Lm(this,vF,null),Lm(this,uT,"")}static get PLUGIN_KEY(){return cT}static get PLUGIN_PRIORITY(){return MMe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[cT]}enablePlugin(){var e=this;this.enabled||(tn(ei,this)||(ld(ei,this,new ag(this.hot.rootDocument,this.hot.isRtl())),tn(ei,this).addLocalHook("resize",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ol(oc,e,VMe).call(e,...i)})),tn(Ru,this)||ld(Ru,this,new fQ(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,i,s,n,o,l)=>Ol(oc,this,HMe).call(this,r,l)),this.addHook("afterScroll",()=>Ol(oc,this,jMe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>Ol(oc,this,WMe).call(this,r)),this.addHook("afterSetTheme",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Ol(oc,e,UMe).call(e,...i)}),tn(Ru,this).addLocalHook("hide",()=>this.hide()),tn(Ru,this).addLocalHook("show",(r,i)=>this.showAtCell(r,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){tn(Ru,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),i=e.addContext(pF);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const s=this.hot.getSelectedRangeLast();ld(G2,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(s),this.show(),this.focusEditor(),e.setActiveContextName(pF),this.hot._registerTimeout(()=>{ld(G2,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var s;return(s=this.hot.getSelectedRangeLast())===null||s===void 0?void 0:s.highlight.isCell()},group:wx}),i.addShortcut({keys:[["Escape"]],callback:()=>{tn(ei,this).setValue(tn(uT,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tn(ei,this).isVisible()&&tn(ei,this).isFocused(),group:wx}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>tn(ei,this).isVisible()&&tn(ei,this).isFocused(),group:wx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wx)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Ol(oc,this,DMe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Ol(oc,this,NMe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Ol(oc,this,LMe).call(this)),this.eventManager.addEventListener(r,"focus",()=>Ol(oc,this,BMe).call(this)),this.eventManager.addEventListener(r,"blur",()=>Ol(oc,this,$Me).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=Rg(e.target,"TD","TBODY");return!!(r&&Rr(r,"htCommentCell")&&Rg(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=tn(ei,this).getValue();let i="";e!=null?i=e:r!=null&&(i=r);const s=this.range.from.row,n=this.range.from.col;this.updateCommentMeta(s,n,{[jw]:i}),this.hot.render()}setCommentAtCell(e,r,i){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Oh),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(i)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,jw)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,jw)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:i}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const s=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return tn(Ru,this).cancelHiding(),tn(ei,this).setValue((e=s[Oh]?s[Oh][jw]:null)!==null&&e!==void 0?e:""),tn(ei,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){tn(ei,this).hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!tn(ei,this).isVisible()))return;const{rowIndexMapper:s,columnIndexMapper:n}=this.hot,{row:o,col:l}=this.range.from;let h=s.getRenderableFromVisualIndex(o),d=n.getRenderableFromVisualIndex(l);const g=h===null;tn(ei,this).setPosition(0,0),h===null&&(h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(o,-1))),d===null&&(d=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(l,-1)));const y=h===null,C=d===null;h=(e=h)!==null&&e!==void 0?e:0,d=(r=d)!==null&&r!==void 0?r:0;const{rootWindow:x,view:{_wt:_}}=this.hot,{wtTable:E}=_,R=_.getCell({row:h,col:d},!0),I=this.getCommentMeta(o,l,pQ);I?tn(ei,this).setSize(I.width,I.height):tn(ei,this).resetSize();const F=C?0:E.getColumnWidth(d),H=g&&!y?es(R):0,{left:z,top:q,width:re,height:Y}=R.getBoundingClientRect(),{width:oe,height:me}=tn(ei,this).getSize(),{innerWidth:de,innerHeight:Re}=this.hot.rootWindow,Ie=this.hot.rootDocument.documentElement;let Be=z+x.scrollX+F,lt=q+x.scrollY+H;this.hot.isRtl()&&(Be-=oe+F),this.hot.isLtr()&&z+re+oe>de?Be=z+x.scrollX-oe-1:this.hot.isRtl()&&Be<-(Ie.scrollWidth-Ie.clientWidth)&&(Be=z+x.scrollX+F+1),q+me>Re&&(lt-=me-Y+1),tn(ei,this).setPosition(Be,lt),tn(ei,this).setReadOnlyState(this.getCommentMeta(o,l,z2)),tn(ei,this).observeSize()}focusEditor(){tn(ei,this).focus()}updateCommentMeta(e,r,i){const s=this.hot.getCellMeta(e,r)[Oh];let n;s?(n=la(s),H_(n,i)):n=i,this.hot.setCellMeta(e,r,Oh,n)}getCommentMeta(e,r,i){const s=this.hot.getCellMeta(e,r);if(s[Oh])return s[Oh][i]}addToContextMenu(e){e.items.push({name:Xr},_Me(this),RMe(this),AMe(this))}getEditorInputElement(){return tn(ei,this).getInputElement()}destroy(){var e,r;(e=tn(ei,this))===null||e===void 0||e.destroy(),(r=tn(Ru,this))===null||r===void 0||r.destroy(),super.destroy()}}function NMe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!tn(oR,this)&&!this.targetIsCommentTextArea(t)){const e=Rg(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function DMe(t){const{rootDocument:e}=this.hot;if(!(tn(oR,this)||tn(ei,this).isFocused()||Rr(t.target,"wtBorder")||tn(vF,this)===t.target||!tn(ei,this)))if(ld(vF,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));tn(Ru,this).show(r)}else vg(t.target,e)&&!this.targetIsCommentTextArea(t)&&tn(Ru,this).hide()}function LMe(){ld(oR,this,!1)}function HMe(t,e){e[Oh]&&e[Oh][jw]&&at(t,e.commentedCellClassName)}function $Me(){ld(uT,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function BMe(){ld(uT,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(pF)}function VMe(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[pQ]:{width:t,height:e}})}function WMe(t){tn(ei,this).isFocused()&&jc(t)}function jMe(){tn(G2,this)||this.hide()}function UMe(){const t=tn(ei,this).getEditorElement();_r(t,/ht-theme-.*/g),at(t,this.hot.getCurrentThemeName())}var nW=S_,zMe=TypeError,GMe=function(t,e){if(!delete t[e])throw new zMe("Cannot delete property "+nW(e)+" of "+nW(t))},YMe=si,KMe=x1,XMe=T1,qMe=XY,JMe=GMe,QMe=qY,ZMe=[].unshift(0)!==1,eke=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},tke=ZMe||!eke();YMe({target:"Array",proto:!0,arity:1,forced:tke},{unshift:function(e){var r=KMe(this),i=XMe(r),s=arguments.length;if(s){QMe(i+s);for(var n=i;n--;){var o=n+s;n in r?r[o]=r[n]:JMe(r,o)}for(var l=0;l<s;l++)r[l]=arguments[l]}return qMe(r,i+s)}});function sI(t,e,r){return(e=rke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rke(t){var e=nke(t,"string");return typeof e=="symbol"?e:e+""}function nke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vQ{constructor(e){sI(this,"hot",void 0),sI(this,"commands",{}),sI(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const n=e.split(":"),o=n[0],l=n.length===2?n[1]:null;let h=this.commands[o];if(!h)throw new Error(`Menu command '${o}' not exists.`);if(l&&h.submenu&&(h=ike(l,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||vs(h,"submenu"))return;const d=[];typeof h.callback=="function"&&d.push(h.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),i.unshift(n.join(":")),xe(d,g=>g.apply(this.hot,i))}}function ike(t,e){let r;return xe(e,i=>{const s=i.key?i.key.split(":"):null;if(Array.isArray(s)&&s[1]===t)return r=i,!1}),r}function oI(t,e,r){return(e=ske(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ske(t){var e=oke(t,"string");return typeof e=="symbol"?e:e+""}function oke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wQ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;oI(this,"hot",void 0),oI(this,"predefinedItems",gQ()),oI(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,Zr(e,(i,s)=>{let n="";i.name===Xr?(r[Xr]=i,n=Xr):isNaN(parseInt(s,10))?(i.key=i.key===void 0?s:i.key,r[s]=i,n=i.key):(r[i.key]=i,n=i.key),this.defaultOrderPattern.push(n)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return ake(e,this.defaultOrderPattern,this.predefinedItems)}}function ake(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let s=t;return s&&s.items?s=s.items:Array.isArray(s)||(s=e),Qr(s)?Zr(s,(n,o)=>{let l=r[typeof n=="string"?n:o];l||(l=n),Qr(n)?Cs(l,n):typeof l=="string"&&(l={name:l}),l.key===void 0&&(l.key=o),i.push(l)}):xe(s,(n,o)=>{let l=r[n];!l&&EMe.indexOf(n)>=0||(l||(l={name:n,key:`${o}`}),Qr(n)&&Cs(l,n),l.key===void 0&&(l.key=o),i.push(l))}),i}function If(t,e,r){return(e=lke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lke(t){var e=cke(t,"string");return typeof e=="symbol"?e:e+""}function cke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uke{constructor(e,r){If(this,"top",void 0),If(this,"topRelative",void 0),If(this,"left",void 0),If(this,"leftRelative",void 0),If(this,"scrollTop",void 0),If(this,"scrollLeft",void 0),If(this,"cellHeight",void 0),If(this,"cellWidth",void 0);const i=r.scrollY,s=r.scrollX;let n,o,l,h,d,g;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(n=parseInt(e.top,10),l=parseInt(e.left,10),d=e.height||0,g=e.width||0,o=n,h=l,n+=i,l+=s):this.type==="event"&&(n=parseInt(e.pageY,10),l=parseInt(e.pageX,10),d=e.target.clientHeight,g=e.target.clientWidth,o=n-i,h=l-s),this.top=n,this.topRelative=o,this.left=l,this.leftRelative=h,this.scrollTop=i,this.scrollLeft=s,this.cellHeight=d,this.cellWidth=g}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function sw(t,e,r){hke(t,e),e.set(t,r)}function hke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function en(t,e){return t.get(yQ(t,e))}function yx(t,e,r){return t.set(yQ(t,e),r),r}function yQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yo=new WeakMap,cu=new WeakMap,wa=new WeakMap,aI=new WeakMap,Hm=new WeakMap;class fke{constructor(e){sw(this,Yo,void 0),sw(this,cu,void 0),sw(this,wa,void 0),sw(this,aI,!1),sw(this,Hm,{above:0,below:0,left:0,right:0}),yx(aI,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return en(Hm,this)[e]=r,this}setElement(e){return yx(Yo,this,e),this}setParentElement(e){return yx(cu,this,e),this}updatePosition(e){yx(wa,this,new uke(e,en(Yo,this).ownerDocument.defaultView)),en(aI,this)?(en(wa,this).fitsBelow(en(Yo,this))?this.setPositionBelowCursor():en(wa,this).fitsAbove(en(Yo,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){en(Yo,this).dir==="rtl"?en(wa,this).fitsOnLeft(en(Yo,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():en(wa,this).fitsOnRight(en(Yo,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=en(Hm,this).above+en(wa,this).top-en(Yo,this).offsetHeight;en(cu,this)&&(e=en(wa,this).top+en(wa,this).cellHeight-en(Yo,this).offsetHeight+3),en(Yo,this).style.top=`${e}px`}setPositionBelowCursor(){let e=en(Hm,this).below+en(wa,this).top+1;en(cu,this)&&(e=en(wa,this).top-1),en(Yo,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=en(wa,this).left;if(en(cu,this)){const r=en(cu,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(en(cu,this).querySelector(".htCore")).borderRightWidth,10);e+=en(wa,this).cellWidth+i}else e+=en(Hm,this).right;en(Yo,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=en(Hm,this).left+en(wa,this).left-en(Yo,this).offsetWidth;if(en(cu,this)){const r=en(cu,this).ownerDocument.defaultView,i=Number.parseInt(r.getComputedStyle(en(cu,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}en(Yo,this).style.left=`${e}px`}}function CQ(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:i=()=>{},onClear:s=()=>{}}=t;const n=new Set;let o=vn(e,-1,_()-1);function l(R,I){const F=_()-1;return R<0&&(R=F),R>F&&(R=0),n.has(R)?-1:(n.add(R),i(R,!1)===!1&&(R=l(I===1?++R:--R,I)),R)}function h(R){R>-1&&R<_()&&i(R,!0)!==!1&&(o=R)}function d(){return o}function g(){_()>0&&(n.clear(),o=l(0,1))}function y(){_()>0&&(n.clear(),o=l(_()-1,-1))}function C(){_()>0&&(n.clear(),o=l(++o,1))}function x(){_()>0&&(n.clear(),o=l(--o,-1))}function _(){return Math.max(r(),0)}function E(){n.clear(),o=e,s()}return{setCurrentPage:h,getCurrentPage:d,toFirstItem:g,toLastItem:y,toNextItem:C,toPreviousItem:x,getSize:_,clear:E}}function dke(t){return on(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function wF(t){return vs(t,"submenu")}function yF(t){return new RegExp(Xr,"i").test(t.name)}function Y2(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function iW(t){return vs(t,"disableSelection")}function gke(t){return Rr(t,"htSeparator")}function mke(t){return Rr(t,"htSubmenu")}function pke(t){return Rr(t,"htDisabled")}function vke(t){return Rr(t,"htSelectionDisabled")}function wke(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function SQ(t,e){const r=t.slice(0);for(let i=0;i<r.length&&r[i].name===e;)r.shift();return r}function yke(t,e){let r=t.slice(0);return r.reverse(),r=SQ(r,e),r.reverse(),r}function Cke(t){const e=[];return xe(t,(r,i)=>{i>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function Ske(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xr,r=t.slice(0);return r=SQ(r,e),r=yke(r,e),r=Cke(r),r}function bke(t){return t.checkable===!0}function xke(t){return CQ({size:()=>t.countRows(),onItemSelect(e,r){const i=t.getCell(e,0);if(!i||gke(i)||pke(i)||vke(i))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Eke(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,s)=>{const n=e.getSettings(),o=typeof n.tabMoves=="function"?n.tabMoves(i):n.tabMoves;s.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const i=r.getSelectedLast();if(i){const s=t.openSubMenu(i[0]);s&&s.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const s=r.getSelectedLast();s&&(r.getSourceDataAtRow(s[0]).submenu?t.openSubMenu(s[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const bQ="menu",sW=bQ;function Tke(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];i(Eke(t)),e.forEach(d=>{let{shortcuts:g,contextName:y}=d;s(g,y)});function i(d,g){l(g).addShortcuts(d,{group:bQ})}function s(d,g){const y=l(g);d.forEach(C=>{let{keys:x}=C;x.forEach(_=>y.removeShortcutsByKeys(_))}),r.push({shortcuts:d,contextName:g}),i(d,g)}function n(){return[...r]}function o(d){return d?`${sW}:${d}`:sW}function l(d){var g;const y=t.hotMenu.getShortcutManager(),C=o(d);return(g=y.getContext(C))!==null&&g!==void 0?g:y.addContext(C)}function h(d){t.hotMenu.getShortcutManager().setActiveContextName(o(d))}return{addCustomShortcuts:s,getCustomShortcuts:n,getContext:l,listen:h}}function _ke(t){return(e,r,i,s,n,o)=>{const l=e.getSourceDataAtRow(i),h=t.rootDocument.createElement("div"),d=typeof o=="function"?o.call(t):o,g=typeof l.ariaLabel=="function"?l.ariaLabel.call(t):l.ariaLabel,y=typeof l.ariaChecked=="function"?l.ariaChecked.call(t):l.ariaChecked;if(Uu(r),at(h,"htItemWrapper"),t.getSettings().ariaTags){const C=!Y2(l,t)&&!iW(l)&&!yF(l);Or(r,[...bke(l)?[iSe(),WE(g),$X(y)]:[nSe(),WE(d)],...C?[P1(-1)]:[],...Y2(l,t)?[hSe()]:[],...wF(l)?[jl(!1)]:[]])}r.className="",r.appendChild(h),yF(l)?at(r,"htSeparator"):typeof l.renderer=="function"?(at(r,"htCustomMenuRenderer"),r.appendChild(l.renderer(e,h,i,s,n,d))):M1(h,d),Y2(l,t)?at(r,"htDisabled"):iW(l)?at(r,"htSelectionDisabled"):wF(l)&&at(r,"htSubmenu")}}function lI(t,e,r){Rke(t,e),e.set(t,r)}function Rke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uu(t,e,r){return(e=Ake(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ake(t){var e=Oke(t,"string");return typeof e=="symbol"?e:e+""}function Oke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cI(t,e,r){return t.set(xQ(t,e),r),r}function A0(t,e){return t.get(xQ(t,e))}function xQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oW=215;var ow=new WeakMap,Cx=new WeakMap,Sx=new WeakMap;class L1{get tableBorderWidth(){return A0(Sx,this)===void 0&&this.hotMenu&&cI(Sx,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),A0(Sx,this)}constructor(e,r){var i=this;uu(this,"hot",void 0),uu(this,"options",void 0),uu(this,"eventManager",new $c(this)),uu(this,"container",void 0),uu(this,"positioner",void 0),uu(this,"hotMenu",null),uu(this,"hotSubMenus",{}),uu(this,"parentMenu",void 0),uu(this,"menuItems",null),uu(this,"origOutsideClickDeselects",null),lI(this,ow,void 0),lI(this,Cx,void 0),lI(this,Sx,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:oW,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new fke(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...n)}),this.hot.addHook("afterSetTheme",(s,n)=>{if(!n){var o;(o=this.hotMenu)===null||o===void 0||o.useTheme(s)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=a1(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return A0(ow,this)}getKeyboardShortcutsCtrl(){return A0(Cx,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Gk(l=>this.openSubMenu(l),300),r=this.options.minWidth||oW;let i=!1,s=Ad(this.menuItems,l=>(l.key===cC&&(i=!0),wke(l,this.hot)));if(s.length<1&&!i)s.push(gQ()[cC]);else if(s.length===0)return;s=Ske(s,Xr);let n=!1;const o={data:s,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(l){return rr(l)&&l<r?r:l},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:_ke(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeOnCellMouseOver:(l,h)=>{A0(ow,this).setCurrentPage(h.row)},afterOnCellMouseOver:(l,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},rowHeights:l=>s[l].name===Xr?1:void 0,afterOnCellContextMenu:l=>{l.preventDefault(),aB()&&n&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(l,h,d,g,y)=>{this.hotMenu.view.isMouseDown()&&(y.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:l=>{this.hasSelectedItem()&&(n=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(l))},afterOnCellMouseUp:l=>{(!aB()||!Og(l))&&n&&this.hasSelectedItem()&&(od()||oq()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),cI(ow,this,xke(this.hotMenu)),cI(Cx,this,Tke(this)),A0(Cx,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(A0(ow,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const i=this.parentMenu.hotMenu.getCell(r[0],0);Or(i,[jl(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!mke(r))return!1;const i=this.hotMenu.getSourceDataAtRow(e),s=new L1(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return s.setMenuItems(i.submenu.items),s.open(),s.setPosition(r.getBoundingClientRect()),this.hotSubMenus[i.key]=s,this.hot.getSettings().ariaTags&&Or(r,[jl(!0)]),s}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[r.key];if(i){i.destroy(),delete this.hotSubMenus[r.key];const s=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Or(s,[jl(!1)])}}closeAllSubMenus(){xe(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const i=this.hot.getSelectedRange(),s=i?dke(i):[];this.runLocalHooks("executeCommand",r.key,s,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,s,e)}isCommandPassive(e){return e.isCommand===!1||yF(e)||Y2(e,this.hot)||wF(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,i=e.hider.style,s=e.holder.style,n=parseInt(i.width,10),o=ha(r,(l,h,d)=>{const y=this.hotMenu.getCell(d,0)?es(this.hotMenu.getCell(d,0)):0;return l+(h.name===Xr?1:y)},0);s.width=`${n}px`,s.height=`${o}px`,i.height=s.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let i=e,s;return i&&(ci(i)&&(i=i.call(this.hot),i===null||Ai(i)?i="":i=i.toString()),i=i.replace(/[^A-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,s=r.querySelector(`.${this.options.className}.${i}`)),s||(s=r.createElement("div"),at(s,`htMenu ${this.options.className}`),i&&at(s,i),this.options.container.appendChild(s)),s}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&Or(this.hotMenu.rootElement,[rSe(),P1(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!vg(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!vg(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Rr(e.target,"htCore")&&vg(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}qn(L1,mo);function Ike(t,e){Pke(t,e),e.add(t)}function Pke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uI(t,e,r){return(e=Fke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fke(t){var e=Mke(t,"string");return typeof e=="symbol"?e:e+""}function Mke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bx(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Uw="contextMenu",kke=70,aW=Uw;Xt.getSingleton().register("afterContextMenuDefaultOptions");Xt.getSingleton().register("beforeContextMenuShow");Xt.getSingleton().register("afterContextMenuShow");Xt.getSingleton().register("afterContextMenuHide");Xt.getSingleton().register("afterContextMenuExecute");var aw=new WeakSet;class aR extends On{constructor(){super(...arguments),Ike(this,aw),uI(this,"commandExecutor",new vQ(this.hot)),uI(this,"itemsFactory",null),uI(this,"menu",null)}static get PLUGIN_KEY(){return Uw}static get PLUGIN_PRIORITY(){return kke}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nR,iR,Xr,sS,oS,Xr,rR,lS,Xr,sR,tR,Xr,aS,Xr,Fl]}isEnabled(){return!!this.hot.getSettings()[Uw]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Uw];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new L1(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>bx(aw,this,Dke).call(this)),this.menu.addLocalHook("afterOpen",()=>bx(aw,this,Lke).call(this)),this.menu.addLocalHook("afterClose",()=>bx(aw,this,Hke).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return e.executeCommand.call(e,...s)}),this.addHook("afterOnCellContextMenu",i=>bx(aw,this,Nke).call(this,i)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=Z_(this.menu.container,this.hot.rootDocument);this.open({left:r.left+i.left,top:r.top+i.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:aW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aW)}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(i.below+=1,i.right+=1,i.above-=1,i.left-=1),Zr(i,(n,o)=>{this.menu.setOffset(o,n)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new wQ(this.hot,aR.DEFAULT_ITEMS);const e=this.hot.getSettings()[Uw],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),xe(i,s=>this.commandExecutor.registerCommand(s.key,s))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Nke(t){const e=this.hot.getSettings(),r=e.rowHeaders,i=e.colHeaders;function s(l){return l.nodeName==="TD"||l.parentNode.nodeName==="TD"}const n=t.target;if(this.close(),Rr(n,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||i)&&!s(n)&&!(Rr(n,"current")&&Rr(n,"wtBorder"))))return;const o=Z_(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Dke(){this.hot.runHooks("beforeContextMenuShow",this)}function Lke(){this.hot.runHooks("afterContextMenuShow",this)}function Hke(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}aR.SEPARATOR={name:Xr};function $ke(t){return{key:"copy",name(){return this.getTranslatedPhrase(NN)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Bke(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(HN,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Vke(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(LN,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Wke(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?vn(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(DN,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function jke(t){return{key:"cut",name(){return this.getTranslatedPhrase($N)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Uke{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class zke{constructor(){this.clipboardData=new Uke}preventDefault(){}}function Gke(t,e){EQ(t,e),e.add(t)}function $m(t,e,r){EQ(t,e),e.set(t,r)}function EQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qo(t,e){return t.get(Pp(t,e))}function Bm(t,e,r){return t.set(Pp(t,e),r),r}function Pp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pf=new WeakMap,hI=new WeakMap,lw=new WeakMap,CF=new WeakMap,SF=new WeakMap,cw=new WeakMap,uw=new WeakSet;class Yke{constructor(e){let{countRows:r,countColumns:i,rowsLimit:s,columnsLimit:n,countColumnHeaders:o}=e;Gke(this,uw),$m(this,Pf,void 0),$m(this,hI,void 0),$m(this,lw,void 0),$m(this,CF,void 0),$m(this,SF,void 0),$m(this,cw,void 0),Bm(hI,this,r),Bm(lw,this,i),Bm(CF,this,s),Bm(SF,this,n),Bm(cw,this,o)}setSelectedRange(e){Bm(Pf,this,e)}getCellsRange(){if(qo(hI,this).call(this)===0||qo(lw,this).call(this)===0)return null;const{row:e,col:r}=qo(Pf,this).getTopStartCorner(),{row:i,col:s}=qo(Pf,this).getBottomEndCorner(),n=Pp(uw,this,Kke).call(this,e,i),o=Pp(uw,this,fI).call(this,r,s);return{isRangeTrimmed:i!==n||s!==o,startRow:e,startCol:r,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(qo(lw,this).call(this)===0||qo(cw,this).call(this)===0)return null;const{col:e}=qo(Pf,this).getTopStartCorner(),{col:r}=qo(Pf,this).getBottomEndCorner(),i=Pp(uw,this,fI).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(qo(lw,this).call(this)===0||qo(cw,this).call(this)===0)return null;const{col:e}=qo(Pf,this).getTopStartCorner(),{col:r}=qo(Pf,this).getBottomEndCorner(),i=Pp(uw,this,fI).call(this,e,r);return{isRangeTrimmed:r!==i,startRow:-qo(cw,this).call(this),startCol:e,endRow:-1,endCol:i}}}function fI(t,e){return Math.min(e,Math.max(t+qo(SF,this).call(this)-1,t))}function Kke(t,e){return Math.min(e,Math.max(t+qo(CF,this).call(this)-1,t))}function TQ(t){const e=[],r=[];return xe(t,i=>{const s=Math.min(i.startRow,i.endRow),n=Math.max(i.startRow,i.endRow);pr(s,n,h=>{e.indexOf(h)===-1&&e.push(h)});const o=Math.min(i.startCol,i.endCol),l=Math.max(i.startCol,i.endCol);pr(o,l,h=>{r.indexOf(h)===-1&&r.push(h)})}),{rows:e,columns:r}}function Xke(t,e){_Q(t,e),e.add(t)}function Ff(t,e,r){_Q(t,e),e.set(t,r)}function _Q(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hw(t,e,r){return(e=qke(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qke(t){var e=Jke(t,"string");return typeof e=="symbol"?e:e+""}function Jke(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ea(t,e){return t.get(Ta(t,e))}function gc(t,e,r){return t.set(Ta(t,e),r),r}function Ta(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("afterCopyLimit");Xt.getSingleton().register("modifyCopyableRange");Xt.getSingleton().register("beforeCut");Xt.getSingleton().register("afterCut");Xt.getSingleton().register("beforePaste");Xt.getSingleton().register("afterPaste");Xt.getSingleton().register("beforeCopy");Xt.getSingleton().register("afterCopy");const dI="copyPaste",Qke=80,Zke=["fragmentSelection"],lW=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var bF=new WeakMap,xF=new WeakMap,EF=new WeakMap,Vm=new WeakMap,xx=new WeakMap,Ex=new WeakMap,Wm=new WeakMap,hT=new WeakMap,Ga=new WeakSet;class eNe extends On{constructor(){super(...arguments),Xke(this,Ga),hw(this,"columnsLimit",1/0),hw(this,"rowsLimit",1/0),hw(this,"pasteMode","overwrite"),hw(this,"uiContainer",this.hot.rootDocument.body),Ff(this,bF,!1),Ff(this,xF,!1),Ff(this,EF,!1),Ff(this,Vm,"cells-only"),Ff(this,xx,!1),Ff(this,Ex,!1),Ff(this,Wm,new Yke({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ff(this,hT,!1),hw(this,"copyableRanges",[])}static get PLUGIN_KEY(){return dI}static get SETTING_KEYS(){return[dI,...Zke]}static get PLUGIN_PRIORITY(){return Qke}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[dI]}enablePlugin(){var e,r,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),gc(bF,this,this.getSetting("copyColumnHeaders")),gc(xF,this,this.getSetting("copyColumnGroupHeaders")),gc(EF,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(r=this.getSetting("uiContainer"))!==null&&r!==void 0?r:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",s=>Ta(Ga,this,nNe).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Ta(Ga,i,iNe).call(i,...n)}),this.addHook("afterSelectionEnd",()=>Ta(Ga,this,sNe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),iq()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Ta(Ga,i,oNe).call(i,...n)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Ta(Ga,i,aNe).call(i,...n)}),this.addHook("afterSelection",()=>Ta(Ga,this,lNe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";gc(Vm,this,e),gc(xx,this,!0),Ta(Ga,this,cW).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){gc(Ex,this,!0),Ta(Ga,this,cW).call(this,"cut")}getRangedCopyableData(e){return ly(this.getRangedData(e))}getRangedData(e){const r=[],{rows:i,columns:s}=TQ(e);return xe(i,n=>{const o=[];xe(s,l=>{n<0?o.push(this.hot.getColHeader(l,n)):o.push(this.hot.getCopyableData(n,l))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const i=new zke;e&&i.clipboardData.setData("text/plain",e),r&&i.clipboardData.setData("text/html",r),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}Ea(Wm,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);Ea(Vm,this)==="column-headers-only"?r.set("headers",Ea(Wm,this).getMostBottomColumnHeadersRange()):(Ea(Vm,this)==="with-column-headers"?r.set("headers",Ea(Wm,this).getMostBottomColumnHeadersRange()):Ea(Vm,this)==="with-column-group-headers"&&r.set("headers",Ea(Wm,this).getAllColumnHeadersRange()),r.set("cells",Ea(Wm,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(s=>s!==null).map(s=>{let{startRow:n,startCol:o,endRow:l,endCol:h}=s;return{startRow:n,startCol:o,endRow:l,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=r.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:s,startCol:n,endRow:o,endCol:l}=i;this.hot.runHooks("afterCopyLimit",o-s+1,l-n+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const i=e.length,s=e[0].length,n=[],{row:o,col:l}=r.getTopStartCorner(),{row:h,col:d}=r.getBottomEndCorner();let g=o,y=l,C=o,x=l;for(;n.length<i||g<=h;){const{skipRowOnPaste:_,visualRow:E}=this.hot.getCellMeta(g,l);if(g=E+1,_===!0)continue;C=E,y=l;const R=[],I=n.length%i;for(;R.length<s||y<=d;){const{skipColumnOnPaste:F,visualCol:H}=this.hot.getCellMeta(o,y);if(y=H+1,F===!0)continue;x=H;const z=R.length%s;R.push(e[I][z])}n.push(R)}return gc(hT,this,!0),this.hot.populateFromArray(o,l,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,l,C,x]}onCopy(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ea(xx,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),gc(xx,this,!1);const n=this.getRangedData(this.copyableRanges),o=Ta(Ga,this,tNe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,o)){const h=ly(n);if(e&&e.clipboardData){const d=yB(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",h),e.clipboardData.setData("text/html",[lW,d].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",h);this.hot.runHooks("afterCopy",n,this.copyableRanges,o)}gc(Vm,this,"cells-only")}onCut(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!Ea(Ex,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),gc(Ex,this,!1);const n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){const l=ly(n);if(e&&e.clipboardData){const h=yB(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[lW,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}}onPaste(e){var r;const i=this.hot.getFocusManager().getRefocusElement(),s=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(s&&e.target!==i||!s&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){const g=Bk(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});g&&/(<table)|(<TABLE)/g.test(g)?n=$xe(g,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=NRe(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;const[o,l,h,d]=this.populateValues(n);this.hot.selectCell(o,l,Math.min(this.hot.countRows()-1,h),Math.min(this.hot.countCols()-1,d)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}}function cW(t){if(iq()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:i}=e.highlight,s=this.hot.getCell(r,i,!0);s&&kSe(s,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function tNe(t){const{rows:e}=TQ(t);let r=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)r+=1;return{columnHeadersCount:r}}function rNe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i&&XX(i)}}}function RQ(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,i=this.hot.getCell(e,r,!0);i!=null&&i.hasAttribute("contenteditable")&&qX(i)}}}function nNe(t){t.items.push({name:"---------"},$ke(this)),Ea(bF,this)&&t.items.push(Wke(this)),Ea(xF,this)&&t.items.push(Vke(this)),Ea(EF,this)&&t.items.push(Bke(this)),t.items.push(jke(this))}function iNe(t,e,r,i,s){Ea(hT,this)&&(s.value=!0),gc(hT,this,!1)}function sNe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function oNe(){Ta(Ga,this,RQ).call(this)}function aNe(){Ta(Ga,this,rNe).call(this)}function lNe(){Ta(Ga,this,RQ).call(this)}function AQ(t,e){return`border_row${t}col${e}`}function zw(){return{width:1,color:"#000"}}function Bh(){return{hide:!0}}function cNe(){return{width:1,color:"#000",cornerVisible:!1}}function gI(t){if(rr(t.start)||rr(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(rr(t.end)||rr(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function fw(t){return rr(t.start)&&(t.left=t.start),rr(t.end)&&(t.right=t.end),t}function mI(t,e){return{id:AQ(t,e),border:cNe(),row:t,col:e,top:Bh(),bottom:Bh(),start:Bh(),end:Bh()}}function uNe(t,e){return vs(e,"border")&&e.border&&(t.border=e.border),vs(e,"top")&&rr(e.top)&&(e.top?(Qr(e.top)||(e.top=zw()),t.top=e.top):(e.top=Bh(),t.top=e.top)),vs(e,"bottom")&&rr(e.bottom)&&(e.bottom?(Qr(e.bottom)||(e.bottom=zw()),t.bottom=e.bottom):(e.bottom=Bh(),t.bottom=e.bottom)),vs(e,"start")&&rr(e.start)&&(e.start?(Qr(e.start)||(e.start=zw()),t.start=e.start):(e.start=Bh(),t.start=e.start)),vs(e,"end")&&rr(e.end)&&(e.end?(Qr(e.end)||(e.end=zw()),t.end=e.end):(e.end=Bh(),t.end=e.end)),t}function nf(t,e){let r=!1;return xe(t.getSelectedRange(),i=>{i.forAll((s,n)=>{if(s<0||n<0)return;const o=t.getCellMeta(s,n).borders;if(o)if(e){if(!vs(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function lR(t){return`<span class="selected"></span>${t}`}function hNe(t){return t.some(e=>rr(e.left)||rr(e.right))}function fNe(t){return t.some(e=>rr(e.start)||rr(e.end))}const dNe=new Map([["left","start"],["right","end"]]);function gNe(t){var e;return(e=dNe.get(t))!==null&&e!==void 0?e:t}function mNe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(sD);return nf(this,"bottom")&&(e=lR(e)),e},callback(e,r){const i=nf(this,"bottom");t.prepareBorder(r,"bottom",i)}}}function pNe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(oD);return nf(this,e)&&(r=lR(r)),r},callback(r,i){const s=nf(this,e);t.prepareBorder(i,e,s)}}}function vNe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(aD)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!nf(this)}}}function wNe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(iD);return nf(this,e)&&(r=lR(r)),r},callback(r,i){const s=nf(this,e);t.prepareBorder(i,e,s)}}}function yNe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(nD);return nf(this,"top")&&(e=lR(e)),e},callback(e,r){const i=nf(this,"top");t.prepareBorder(r,"top",i)}}}function CNe(t,e){SNe(t,e),e.add(t)}function SNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bNe(t,e,r){return(e=xNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xNe(t){var e=ENe(t,"string");return typeof e=="symbol"?e:e+""}function ENe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const K2="customBorders",TNe=90;var pI=new WeakSet;class _Ne extends On{constructor(){super(...arguments),CNe(this,pI),bNe(this,"savedBorders",[])}static get PLUGIN_KEY(){return K2}static get PLUGIN_PRIORITY(){return TNe}isEnabled(){return!!this.hot.getSettings()[K2]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>uW(pI,this,RNe).call(this,e)),this.addHook("init",()=>uW(pI,this,ANe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let i=["top","bottom","start","end"],s=null;r&&(this.checkSettingsCohesion([r]),i=Object.keys(r),s=gI(r));const n=h1(e),o=sC(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});xe(e,l=>{o(l).forAll((h,d)=>{xe(i,g=>{this.prepareBorderFromCustomAdded(h,d,s,gNe(g))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=h1(e),i=sC(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),s=[];return xe(e,n=>{i(n).forAll((o,l)=>{xe(this.savedBorders,h=>{h.row===o&&h.col===l&&s.push(fw(h))})})}),s}clearBorders(e){e?this.setBorders(e):(xe(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const s=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,s,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:s})}prepareBorderFromCustomAdded(e,r,i,s){const n=this.hot.countRows(),o=this.hot.countCols();if(e>=n||r>=o)return;let l=mI(e,r);i&&(l=uNe(l,i),xe(this.hot.selection.highlight.customSelections,h=>{if(l.id===h.settings.id)return Object.assign(h.settings,i),l.id=h.settings.id,l.top=h.settings.top,l.bottom=h.settings.bottom,l.start=h.settings.start,l.end=h.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",fw(l)),this.insertBorderIntoSettings(l,s)}prepareBorderFromCustomAddedRange(e,r){const i=Math.min(e.to.row,this.hot.countRows()-1),s=Math.min(e.to.col,this.hot.countCols()-1);pr(e.from.row,i,n=>{pr(e.from.col,s,o=>{const l=mI(n,o);let h=0;n===e.from.row&&vs(r,"top")&&(h+=1,l.top=r.top),n===e.to.row&&vs(r,"bottom")&&(h+=1,l.bottom=r.bottom),o===e.from.col&&vs(r,"start")&&(h+=1,l.start=r.start),o===e.to.col&&vs(r,"end")&&(h+=1,l.end=r.end),h>0&&(this.hot.setCellMeta(n,o,"borders",fw(l)),this.insertBorderIntoSettings(l))})})}removeAllBorders(e,r){const i=AQ(e,r);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,i,s){let n=this.hot.getCellMeta(e,r).borders;!n||n.border===void 0?n=mI(e,r):n=gI(n),s?(n[i]=Bh(),this.countHide(n)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(n,i,s)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,r,"borders",fw(n)))):(n[i]=zw(),this.checkCustomSelectionsFromContextMenu(n,i,s)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,r,"borders",fw(n)))}prepareBorder(e,r,i){xe(e,s=>{let{start:n,end:o}=s;if(n.row===o.row&&n.col===o.col)r==="noBorders"?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,r,i);else switch(r){case"noBorders":pr(n.col,o.col,l=>{pr(n.row,o.row,h=>{this.removeAllBorders(h,l)})});break;case"top":pr(n.col,o.col,l=>{this.setBorder(n.row,l,r,i)});break;case"bottom":pr(n.col,o.col,l=>{this.setBorder(o.row,l,r,i)});break;case"start":pr(n.row,o.row,l=>{this.setBorder(l,n.col,r,i)});break;case"end":pr(n.row,o.row,l=>{this.setBorder(l,o.col,r,i)});break}})}createCustomBorders(e){xe(e,r=>{const i=gI(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,i):this.prepareBorderFromCustomAdded(r.row,r.col,i)})}countHide(e){const{top:r,bottom:i,start:s,end:n}=e;return ha([r,i,s,n],(l,h)=>{let d=l;return h&&h.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){const r=on(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){xe(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){xe(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=on(this.savedBorders,i=>i.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):xe(this.savedBorders,(s,n)=>{if(e.id===s.id)return this.savedBorders[n]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,i){let s=!1;return xe(this.hot.selection.highlight.customSelections,n=>{if(e.id===n.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(n);return xe(o,l=>{l.toggleHiddenClass(r,i)}),s=!0,!1}}),s}checkCustomSelections(e,r,i){const s=this.countHide(e);let n=!1;return s===4?(this.removeAllBorders(e.row,e.col),n=!0):xe(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),i){const l=this.hot.view._wt.selectionManager.getBorderInstances(o);xe(l,h=>{h.changeBorderStyle(i,e)})}return n=!0,!1}}),n}changeBorderSettings(){const e=this.hot.getSettings()[K2];if(Array.isArray(e)){const r=la(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=hNe(e),i=fNe(e);if(r&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function RNe(t){this.hot.getSettings()[K2]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(rD)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[yNe(this),wNe(this),mNe(this),pNe(this),vNe(this)]}})}function ANe(){this.changeBorderSettings()}function ONe(t,e){INe(t,e),e.add(t)}function INe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vI(t,e,r){return(e=PNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PNe(t){var e=FNe(t,"string");return typeof e=="symbol"?e:e+""}function FNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const fW="dragToScroll",MNe=100;var wI=new WeakSet;class kNe extends On{constructor(){super(...arguments),ONe(this,wI),vI(this,"boundaries",null),vI(this,"callback",null),vI(this,"listening",!1)}static get PLUGIN_KEY(){return fW}static get PLUGIN_PRIORITY(){return MNe}isEnabled(){return!!this.hot.getSettings()[fW]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>hW(wI,this,dW).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>hW(wI,this,dW).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let i=0,s=0;r<this.boundaries.top?s=r-this.boundaries.top:r>this.boundaries.bottom&&(s=r-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,s)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",i=>this.onMouseMove(i)),r=a1(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function dW(t){if(Og(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,i)=>{var s,n;const o=(s=e.scrollLeft)!==null&&s!==void 0?s:e.scrollX,l=(n=e.scrollTop)!==null&&n!==void 0?n:e.scrollY;e.scroll(o+Math.sign(r)*50,l+Math.sign(i)*20)}),this.listen()}function NNe(t,e){OQ(t,e),e.add(t)}function DNe(t,e,r){OQ(t,e),e.set(t,r)}function OQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yI(t,e,r){return(e=LNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LNe(t){var e=HNe(t,"string");return typeof e=="symbol"?e:e+""}function HNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Ne(t,e){return t.get(Ml(t,e))}function IQ(t,e,r){return t.set(Ml(t,e),r),r}function Ml(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("afterDropdownMenuDefaultOptions");Xt.getSingleton().register("beforeDropdownMenuShow");Xt.getSingleton().register("afterDropdownMenuShow");Xt.getSingleton().register("afterDropdownMenuHide");Xt.getSingleton().register("afterDropdownMenuExecute");const X2="dropdownMenu",BNe=230,uC="changeType",CI=X2;var cR=new WeakMap,vc=new WeakSet;class uR extends On{static get PLUGIN_KEY(){return X2}static get PLUGIN_PRIORITY(){return BNe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[sS,oS,Xr,lS,Xr,eR,Xr,aS,Xr,Fl]}constructor(e){super(e),NNe(this,vc),yI(this,"commandExecutor",new vQ(this.hot)),yI(this,"itemsFactory",null),yI(this,"menu",null),DNe(this,cR,!1),this.hot.addHook("afterGetColHeader",(r,i)=>Ml(vc,this,WNe).call(this,r,i))}isEnabled(){return this.hot.getSettings()[X2]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new wQ(this.hot,uR.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Ml(vc,e,KNe).call(e,...n)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var s=arguments.length,n=new Array(s),o=0;o<s;o++)n[o]=arguments[o];return Ml(vc,e,YNe).call(e,...n)});const r=this.hot.getSettings()[X2],i={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const s=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new L1(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",s),this.menu.setMenuItems(s),this.menu.addLocalHook("beforeOpen",()=>Ml(vc,this,jNe).call(this)),this.menu.addLocalHook("afterOpen",()=>Ml(vc,this,UNe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",n=>Ml(vc,this,zNe).call(this,n)),this.menu.addLocalHook("afterClose",()=>Ml(vc,this,GNe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return e.executeCommand.call(e,...o)}),xe(s,n=>this.commandExecutor.registerCommand(n.key,n))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:i}=this.hot.getSelectedRangeLast();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:s}=this.hot.getSelectedRangeLast(),n=Z_(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,s.col,!0).querySelector(`.${uC}`),l=o.getBoundingClientRect();this.open({left:l.left+n.left,top:l.top+o.offsetHeight+n.top},{left:l.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:CI},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var i;const s=(i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;return s&&this.hot.selection.isCellVisible(s)&&s.isCell()&&!this.menu.isOpened()},group:CI}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(CI)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Ml(vc,this,VNe).call(this,e))}open(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),Zr(i,(s,n)=>{this.menu.setOffset(n,s)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function PQ(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function VNe(t){if(Rr(t.target,uC)){const e=Z_(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),IQ(cR,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function WNe(t,e){const r=e.parentNode;if(!r)return;const i=r.parentNode.childNodes,s=Array.prototype.indexOf.call(i,r);if(t<0||s!==i.length-1)return;const n=e.querySelector(`.${uC}`);if(this.enabled&&n)return;if(!this.enabled){n&&n.parentNode.removeChild(n);return}const o=this.hot.rootDocument.createElement("button");o.className=uC,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(Or(o,[Ld(),WE(" ")]),Or(e,[DX("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function jNe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function UNe(){this.hot.runHooks("afterDropdownMenuShow",this),Ml(vc,this,PQ).call(this,this.menu)}function zNe(t){Ml(vc,this,PQ).call(this,t)}function GNe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function YNe(t){return $Ne(cR,this)?null:t}function KNe(t){Rr(t.target,uC)&&IQ(cR,this,!0)}uR.SEPARATOR={name:Xr};function gW(t,e,r){return(e=XNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XNe(t){var e=qNe(t,"string");return typeof e=="symbol"?e:e+""}function qNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class JNe{constructor(e){gW(this,"hot",void 0),gW(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:i,endCol:s}=this._getDataRange(),n=this.options,o=[];return pr(e,i,l=>{const h=[];!n.exportHiddenRows&&this._isHiddenRow(l)||(pr(r,s,d=>{!n.exportHiddenColumns&&this._isHiddenColumn(d)||h.push(this.hot.getDataAtCell(l,d))}),o.push(h))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:i}=this._getDataRange(),s=this.hot.getRowHeader();pr(r,i,n=>{!this.options.exportHiddenRows&&this._isHiddenRow(n)||e.push(s[n])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:i}=this._getDataRange(),s=this.hot.getColHeader();pr(r,i,n=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(n)||e.push(s[n])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[i=0,s=0,n=r,o=e]=this.options.range;return i=Math.max(i,0),s=Math.max(s,0),n=Math.min(n,r),o=Math.min(o,e),{startRow:i,startCol:s,endRow:n,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function mW(t,e,r){return(e=QNe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QNe(t){var e=ZNe(t,"string");return typeof e=="symbol"?e:e+""}function ZNe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class C6{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){mW(this,"dataProvider",void 0),mW(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=zu(this.constructor.DEFAULT_OPTIONS);const i=new Date;return r=Cs(zu(C6.DEFAULT_OPTIONS),r),r=Cs(r,e),r.filename=MX(r.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),r}}const eDe="\r",tDe='"',rDe=`
`;class nDe extends C6{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const s=i.length>0,n=this.dataProvider.getRowHeaders(),o=n.length>0;let l=e.bom?"\uFEFF":"";return s&&(i=on(i,h=>this._escapeCell(h,!0)),o&&(l+=e.columnDelimiter),l+=i.join(e.columnDelimiter),l+=e.rowDelimiter),xe(r,(h,d)=>{d>0&&(l+=e.rowDelimiter),o&&(l+=this._escapeCell(n[d])+e.columnDelimiter),l+=h.map(g=>this._escapeCell(g)).join(e.columnDelimiter)}),l}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=as(e);return i!==""&&(r||i.indexOf(eDe)>=0||i.indexOf(tDe)>=0||i.indexOf(rDe)>=0||i.indexOf(this.options.columnDelimiter)>=0)&&(i=i.replace(new RegExp('"',"g"),'""'),i=`"${i}"`),i}}const iDe="csv",TF={[iDe]:nDe};function sDe(t,e,r){return typeof TF[t]=="function"?new TF[t](e,r):null}const oDe="exportFile",aDe=240;class lDe extends On{static get PLUGIN_KEY(){return oDe}static get PLUGIN_PRIORITY(){return aDe}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:s}=this.hot,n=this._createTypeFormatter(e,r),o=this._createBlob(n),l=s.URL||s.webkitURL,h=i.createElement("a"),d=`${n.options.filename}.${n.options.fileExtension}`;if(h.download!==void 0){const g=l.createObjectURL(o);h.style.display="none",h.setAttribute("href",g),h.setAttribute("download",d),i.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),i.body.removeChild(h),setTimeout(()=>{l.revokeObjectURL(g)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,d)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!TF[e])throw new Error(`Export format type "${e}" is not supported.`);return sDe(e,new JNe(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function jm(t,e,r){return(e=cDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cDe(t){var e=uDe(t,"string");return typeof e=="symbol"?e:e+""}function uDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cS{constructor(e,r){let{id:i,stateless:s=!0}=r;jm(this,"hot",void 0),jm(this,"id",void 0),jm(this,"elements",[]),jm(this,"hidden",!1),jm(this,"stateId",""),jm(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=s?null:this.hot.columnIndexMapper.registerMap(this.stateId,new U_)}getElements(){return this.elements}reset(){xe(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),xe(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}qn(cS,mo);const hC={};function Od(t,e){if(!hC[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:i}=hC[t];let s=e;return i.inputValuesDecorator&&(s=i.inputValuesDecorator(s)),function(n){return r.apply(n.meta.instance,[].concat([n],[s]))}}function lg(t){if(!hC[t])throw Error(`Filter condition "${t}" does not exist.`);return hC[t].descriptor}function cs(t,e,r){r.key=t,hC[t]={condition:e,descriptor:r}}const Us="none";function hDe(){return!0}cs(Us,hDe,{name:z_,inputsCount:0,showOperators:!1});const hy="empty";function fDe(t){return Zi(t.value)}cs(hy,fDe,{name:gD,inputsCount:0,showOperators:!0});const q2="not_empty";function dDe(t,e){return!Od(hy,e)(t)}cs(q2,dDe,{name:mD,inputsCount:0,showOperators:!0});const fy="eq";function gDe(t,e){let[r]=e;return as(t.value).toLocaleLowerCase(t.meta.locale)===as(r)}cs(fy,gDe,{name:pD,inputsCount:1,showOperators:!0});const J2="neq";function mDe(t,e){return!Od(fy,e)(t)}cs(J2,mDe,{name:vD,inputsCount:1,showOperators:!0});const FQ="gt";function pDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}cs(FQ,pDe,{name:bD,inputsCount:1,showOperators:!0});const MQ="gte";function vDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}cs(MQ,vDe,{name:xD,inputsCount:1,showOperators:!0});const kQ="lt";function wDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}cs(kQ,wDe,{name:ED,inputsCount:1,showOperators:!0});const NQ="lte";function yDe(t,e){let[r]=e,i=r;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}cs(NQ,yDe,{name:TD,inputsCount:1,showOperators:!0});const S6="date_after";function CDe(t,e){let[r]=e;const i=mt(t.value,t.meta.dateFormat),s=mt(r,t.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)>=0}cs(S6,CDe,{name:AD,inputsCount:1,showOperators:!0});const b6="date_before";function SDe(t,e){let[r]=e;const i=mt(t.value,t.meta.dateFormat),s=mt(r,t.meta.dateFormat);return!i.isValid()||!s.isValid()?!1:i.diff(s)<=0}cs(b6,SDe,{name:OD,inputsCount:1,showOperators:!0});const fT="between";function bDe(t,e){let[r,i]=e,s=r,n=i;if(t.meta.type==="numeric"){const o=parseFloat(s,10),l=parseFloat(n,10);s=Math.min(o,l),n=Math.max(o,l)}else if(t.meta.type==="date"){const o=Od(b6,[n]),l=Od(S6,[s]);return o(t)&&l(t)}return t.value>=s&&t.value<=n}cs(fT,bDe,{name:_D,inputsCount:2,showOperators:!0});const DQ="not_between";function xDe(t,e){return!Od(fT,e)(t)}cs(DQ,xDe,{name:RD,inputsCount:2,showOperators:!0});const LQ="begins_with";function EDe(t,e){let[r]=e;return as(t.value).toLocaleLowerCase(t.meta.locale).startsWith(as(r))}cs(LQ,EDe,{name:wD,inputsCount:1,showOperators:!0});const HQ="ends_with";function TDe(t,e){let[r]=e;return as(t.value).toLocaleLowerCase(t.meta.locale).endsWith(as(r))}cs(HQ,TDe,{name:yD,inputsCount:1,showOperators:!0});const x6="contains";function _De(t,e){let[r]=e;return as(t.value).toLocaleLowerCase(t.meta.locale).indexOf(as(r))>=0}cs(x6,_De,{name:CD,inputsCount:1,showOperators:!0});const $Q="not_contains";function RDe(t,e){return!Od(x6,e)(t)}cs($Q,RDe,{name:SD,inputsCount:1,showOperators:!0});const BQ="date_tomorrow";function ADe(t){const e=mt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(mt().subtract(-1,"days").startOf("day"),"d"):!1}cs(BQ,ADe,{name:PD,inputsCount:0});const VQ="date_today";function ODe(t){const e=mt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(mt().startOf("day"),"d"):!1}cs(VQ,ODe,{name:ID,inputsCount:0});const WQ="date_yesterday";function IDe(t){const e=mt(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(mt().subtract(1,"days").startOf("day"),"d"):!1}cs(WQ,IDe,{name:FD,inputsCount:0});ZSe();function PDe(t,e){let r=t;return r===""&&(r=`(${e})`),r}const _F=new Set([1]).has(1),FDe=_F&&typeof Array.from=="function";function uS(t){let e=t;return _F&&(e=new Set(e)),function(r){let i;return _F?i=e.has(r):i=!!~e.indexOf(r),i}}function jQ(t){return t??""}function RF(t){let e=t;return FDe?e=Array.from(new Set(e)):e=IX(e),e=e.sort((r,i)=>typeof r=="number"&&typeof i=="number"?r-i:r===i?0:r>i?1:-1),e}function pW(t,e,r,i){const s=[],n=t===e;let o;return n||(o=uS(e)),xe(t,l=>{let h=!1;(n||o(l))&&(h=!0);const d={checked:h,value:l,visualValue:PDe(l,r)};i&&i(d),s.push(d)}),s}const cg="by_value";function MDe(t,e){let[r]=e;return r(t.value)}cs(cg,MDe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[uS(e)]},showOperators:!1});const fC={};function kDe(t){if(!fC[t])throw Error(`Operation with id "${t}" does not exist.`);const e=fC[t].func;return function(r,i){return e(r,i)}}function NDe(t){return fC[t].name}function E6(t,e,r){fC[t]={name:e,func:r}}const Ed="conjunction",DDe=ND;function LDe(t,e){return t.every(r=>r.func(e))}E6(Ed,DDe,LDe);const dT="disjunction",HDe=G_;function $De(t,e){return t.some(r=>r.func(e))}E6(dT,HDe,$De);const T6="disjunctionWithExtraCondition",BDe=G_;function VDe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}E6(T6,BDe,VDe);const WDe="numeric",UQ="text",jDe="date",vW={[WDe]:[Us,Xr,hy,q2,Xr,fy,J2,Xr,FQ,MQ,kQ,NQ,fT,DQ],[UQ]:[Us,Xr,hy,q2,Xr,fy,J2,Xr,LQ,HQ,Xr,x6,$Q],[jDe]:[Us,Xr,hy,q2,Xr,fy,J2,Xr,b6,S6,fT,Xr,BQ,VQ,WQ]};function UDe(t){const e=[];let r=t;return vW[r]||(r=UQ),xe(vW[r],i=>{let s;i===Xr?s={name:Xr}:s=zu(lg(i)),e.push(s)}),e}function dw(t,e,r){return(e=zDe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zDe(t){var e=GDe(t,"string");return typeof e=="symbol"?e:e+""}function GDe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const SI="built",bI="building",wW=["click","input","keydown","keypress","keyup","focus","blur","change"];let Mc=class zQ{static get DEFAULTS(){return zu({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){dw(this,"hot",void 0),dw(this,"eventManager",new $c(this)),dw(this,"options",void 0),dw(this,"_element",void 0),dw(this,"buildState",void 0),this.hot=e,this.options=Cs(zQ.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===bI?this._element:this.buildState===SI?(this.update(),this._element):(this.buildState=bI,this.build(),this.buildState=SI,this._element)}isBuilt(){return this.buildState===SI}translateIfPossible(e){return typeof e=="string"&&e.startsWith(fa)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,i)=>{this.eventManager.addEventListener(r,i,s=>this.runLocalHooks(i,s,this))};if(this.buildState||(this.buildState=bI),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&at(this._element,this.options.className),this.options.children.length)xe(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),Zr(this.options,(i,s)=>{r[s]!==void 0&&s!=="className"&&s!=="tagName"&&s!=="children"&&(r[s]=this.translateIfPossible(i))}),this._element.appendChild(r),xe(wW,i=>e(r,i))}else xe(wW,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};qn(Mc,mo);function YDe(t,e){GQ(t,e),e.add(t)}function KDe(t,e,r){GQ(t,e),e.set(t,r)}function GQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tx(t,e){return t.get(_6(t,e))}function XDe(t,e,r){return t.set(_6(t,e),r),r}function _6(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Um=new WeakMap,yW=new WeakSet;class Td extends Mc{static get DEFAULTS(){return zu({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,Cs(Td.DEFAULTS,r)),YDe(this,yW),KDe(this,Um,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>_6(yW,this,qDe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");XDe(Um,this,this._element.firstChild),at(this._element,"htUIInput"),at(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Tx(Um,this).type=this.options.type,Tx(Um,this).placeholder=this.translateIfPossible(this.options.placeholder),Tx(Um,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&Tx(Um,this).focus()}}function qDe(t){this.options.value=t.target.value}function JDe(t,e){YQ(t,e),e.add(t)}function gw(t,e,r){YQ(t,e),e.set(t,r)}function YQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zm(t,e,r){return t.set(dy(t,e),r),r}function Fi(t,e){return t.get(dy(t,e))}function dy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var As=new WeakMap,_x=new WeakMap,Rx=new WeakMap,xI=new WeakMap,Ax=new WeakMap,Ox=new WeakSet;class dC extends Mc{static get DEFAULTS(){return zu({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,Cs(dC.DEFAULTS,r)),JDe(this,Ox),gw(this,As,null),gw(this,_x,[]),gw(this,Rx,void 0),gw(this,xI,void 0),gw(this,Ax,void 0),this.registerHooks()}getMenu(){return Fi(As,this)}registerHooks(){this.addLocalHook("click",()=>dy(Ox,this,e6e).call(this))}setItems(e){zm(_x,this,this.translateNames(e)),Fi(As,this)&&Fi(As,this).setMenuItems(Fi(_x,this))}translateNames(e){return xe(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),zm(As,this,new L1(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Fi(As,this).setMenuItems(Fi(_x,this));const e=new Mc(this.hot,{className:"htUISelectCaption"}),r=new Mc(this.hot,{className:"htUISelectDropdown"});zm(Rx,this,e),zm(xI,this,e.element),zm(Ax,this,r),this.hot.getSettings().ariaTags&&(Or(r.element,[Ld()]),Or(this._element,[NX()])),xe([e,r],i=>this._element.appendChild(i.element)),Fi(As,this).addLocalHook("select",i=>dy(Ox,this,QDe).call(this,i)),Fi(As,this).addLocalHook("afterClose",()=>dy(Ox,this,ZDe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Fi(As,this).hot.getTranslatedPhrase(z_),Fi(xI,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Fi(As,this)&&(Fi(As,this).open(),Fi(As,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Fi(As,this).getNavigator().toFirstItem(),Fi(As,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Fi(As,this)&&Fi(As,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Fi(As,this)&&(Fi(As,this).destroy(),zm(As,this,null)),Fi(Rx,this)&&Fi(Rx,this).destroy(),Fi(Ax,this)&&Fi(Ax,this).destroy(),super.destroy()}}function QDe(t){t.name!==Xr&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function ZDe(){this.runLocalHooks("afterClose")}function e6e(){this.openOptions()}function t6e(t,e){r6e(t,e),e.add(t)}function r6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CW(t,e,r){return(e=n6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n6e(t){var e=i6e(t,"string");return typeof e=="symbol"?e:e+""}function i6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function SW(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var EI=new WeakSet;class AF extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),t6e(this,EI),CW(this,"name",""),CW(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new dC(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new Td(this.hot,{placeholder:VD})),this.elements.push(new Td(this.hot,{placeholder:WD})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>SW(EI,this,s6e).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),xe(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>SW(EI,this,o6e).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=zu(e.command);r.name.startsWith(Wi)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),xe(e.args,(i,s)=>{if(s>r.inputsCount-1)return!1;const n=this.getInputElement(s);n.setValue(i),n[r.inputsCount>s?"show":"hide"](),s||this.hot._registerTimeout(()=>n.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||lg(Us),r=[];return xe(this.getInputElements(),(i,s)=>{e.inputsCount>s&&r.push(i.getValue())}),{command:e,args:r}}updateState(e,r){const i=lg(e?e.name:Us);this.state.setValueAtIndex(r,{command:i,args:e?e.args:[]}),e||xe(this.getInputElements(),s=>s.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof dC)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Td)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,s,n,o)=>{at(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&at(r.parentNode,"border");const l=this.hot.rootDocument.createElement("div");return at(l,"htFiltersMenuLabel"),l.textContent=o,r.appendChild(l),r.parentElement.hasAttribute("ghost-table")||xe(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[lg(Us)];if(e!==null){const{visualIndex:i}=e;r=UDe(this.hot.getDataType(0,i,this.hot.countRows(),i))}xe(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function s6e(t){xe(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function o6e(t){qC(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),jc(t))}function bW(t,e,r){a6e(t,e),e.set(t,r)}function a6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mw(t,e){return t.get(KQ(t,e))}function xW(t,e,r){return t.set(KQ(t,e),r),r}function KQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Gm=new WeakMap,TI=new WeakMap;class gT extends Mc{static get DEFAULTS(){return zu({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,Cs(gT.DEFAULTS,r)),bW(this,Gm,void 0),bW(this,TI,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),xW(TI,this,e),xW(Gm,this,this._element.firstChild),mw(Gm,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(mw(TI,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?mw(Gm,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(mw(Gm,this).checked=e)}focus(){this.isBuilt()&&mw(Gm,this).focus()}}function l6e(t,e){c6e(t,e),e.add(t)}function c6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u6e(t,e,r){return(e=h6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h6e(t){var e=f6e(t,"string");return typeof e=="symbol"?e:e+""}function f6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d6e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const EW=0;var TW=new WeakSet;class g6e extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),l6e(this,TW),u6e(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(at(r.parentNode,"htFiltersMenuOperators"),xe(this.elements,i=>r.appendChild(i.element)),r)}}buildOperatorsElement(){const e=[Ed,dT];xe(e,r=>{const i=new gT(this.hot,{name:"operator",label:{htmlFor:r,textContent:NDe(r)},value:r,checked:r===e[EW],id:r});i.addLocalHook("change",s=>d6e(TW,this,m6e).call(this,s)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(Ln`Radio button with index ${e} doesn't exist.`);xe(this.elements,(r,i)=>{r.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof gT&&r.isChecked());return e?e.getValue():Ed}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&xe(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ed,r=arguments.length>1?arguments[1]:void 0,i=e;i===T6&&(i=dT),this.state.setValueAtIndex(r,i)}reset(){this.setChecked(EW)}}function m6e(t){this.setState(t.target.value)}function p6e(t,e,r){v6e(t,e),e.set(t,r)}function v6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _I(t,e){return t.get(XQ(t,e))}function w6e(t,e,r){return t.set(XQ(t,e),r),r}function XQ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var pw=new WeakMap;class gC extends Mc{static get DEFAULTS(){return zu({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,Cs(gC.DEFAULTS,r)),p6e(this,pw,void 0)}build(){super.build(),w6e(pw,this,this._element.firstChild)}update(){this.isBuilt()&&(_I(pw,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_I(pw,this).focus()}activate(){_I(pw,this).click()}}function y6e(t,e){qQ(t,e),e.add(t)}function Ym(t,e,r){qQ(t,e),e.set(t,r)}function qQ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hr(t,e){return t.get(Fp(t,e))}function ac(t,e,r){return t.set(Fp(t,e),r),r}function Fp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const _W="multipleSelect.itemBox";var wc=new WeakMap,Ki=new WeakMap,RI=new WeakMap,wh=new WeakMap,Mf=new WeakMap,kf=new WeakMap,vw=new WeakSet;class mC extends Mc{static get DEFAULTS(){return zu({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,Cs(mC.DEFAULTS,r)),y6e(this,vw),Ym(this,wc,[]),Ym(this,Ki,void 0),Ym(this,RI,void 0),Ym(this,wh,void 0),Ym(this,Mf,void 0),Ym(this,kf,void 0),ac(wh,this,new Td(this.hot,{placeholder:BD,className:"htUIMultipleSelectSearch"})),ac(Mf,this,new gC(this.hot,{textContent:DD,className:"htUISelectAll"})),ac(kf,this,new gC(this.hot,{textContent:LD,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return Hr(Ki,this)}registerHooks(){Hr(wh,this).addLocalHook("keydown",e=>Fp(vw,this,S6e).call(this,e)),Hr(wh,this).addLocalHook("input",e=>Fp(vw,this,C6e).call(this,e)),Hr(Mf,this).addLocalHook("click",e=>Fp(vw,this,b6e).call(this,e)),Hr(kf,this).addLocalHook("click",e=>Fp(vw,this,x6e).call(this,e))}setItems(e){var r;ac(wc,this,e),(r=Hr(Ki,this))===null||r===void 0||r.loadData(Hr(wc,this))}setLocale(e){ac(RI,this,e)}getLocale(){return Hr(RI,this)}getItems(){return[...Hr(wc,this)]}getValue(){return T6e(Hr(wc,this))}getSearchInputElement(){return Hr(wh,this)}getSelectAllElement(){return Hr(Mf,this)}getClearAllElement(){return Hr(kf,this)}isSelectedAllValues(){return Hr(wc,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),i=new Mc(this.hot,{className:"htUISelectionControls",children:[Hr(Mf,this),Hr(kf,this)]});this._element.appendChild(Hr(wh,this).element),this._element.appendChild(i.element),this._element.appendChild(r);const s=n=>{var o;if(!this._element)return;(o=Hr(Ki,this))===null||o===void 0||o.destroy(),at(n,"htUIMultipleSelectHot"),ac(Ki,this,new this.hot.constructor(n,{data:Hr(wc,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,g,y,C,x,_)=>{d.title=_.instance.getDataAtRowProp(g,_.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{Hr(Ki,this).listen()},colWidths:()=>Hr(Ki,this).container.scrollWidth-co(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),Hr(Ki,this).init(),this.hot.addHook("afterSetTheme",(d,g)=>{g||Hr(Ki,this).useTheme(d)});const h=Hr(Ki,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:_W}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{Hr(Ki,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:_W})};s(r),this.hot._registerTimeout(()=>s(r),100)}focus(){this.isBuilt()&&Hr(Ki,this).listen()}reset(){Hr(wh,this).reset(),Hr(Mf,this).reset(),Hr(kf,this).reset()}update(){this.isBuilt()&&(Hr(Ki,this).loadData(E6e(Hr(wc,this),this.options.value)),super.update())}destroy(){var e;(e=Hr(Ki,this))===null||e===void 0||e.destroy(),Hr(wh,this).destroy(),Hr(kf,this).destroy(),Hr(Mf,this).destroy(),ac(wh,this,null),ac(kf,this,null),ac(Mf,this,null),ac(Ki,this,null),ac(wc,this,null),super.destroy()}}function C6e(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...Hr(wc,this)]:r=Hr(wc,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),Hr(Ki,this).loadData(r)}function S6e(t){this.runLocalHooks("keydown",t,this),JX(qC,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),jc(t),Hr(Ki,this).listen(),Hr(Ki,this).selectCell(0,0))}function b6e(t){const e=[];t.preventDefault(),Hr(Ki,this).getSourceData().forEach((r,i)=>{r.checked=!0,e.push(Bq(r,i)[0])}),Hr(Ki,this).setSourceDataAtCell(e)}function x6e(t){const e=[];t.preventDefault(),Hr(Ki,this).getSourceData().forEach((r,i)=>{r.checked=!1,e.push(Bq(r,i)[0])}),Hr(Ki,this).setSourceDataAtCell(e)}function E6e(t,e){const r=uS(e);return t.map(i=>(i.checked=r(i.value),i))}function T6e(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function _6e(t,e){R6e(t,e),e.add(t)}function R6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function A6e(t,e,r){return(e=O6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function O6e(t){var e=I6e(t,"string");return typeof e=="symbol"?e:e+""}function I6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ix(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ww=new WeakSet;class P6e extends cS{constructor(e,r){super(e,{id:r.id,stateless:!1}),_6e(this,ww),A6e(this,"name",""),this.name=r.name,this.elements.push(new mC(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Ix(ww,this,F6e).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>Ix(ww,this,M6e).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===cg){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?Us:cg},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(i,s,n,o,l)=>{const[h]=Ad(s,y=>y.name===cg),d={},g=this.hot.getTranslatedPhrase(QE);if(h){const y=o(i,l),C=on(y,F=>F.value),x=new Map(y.map(F=>[F.value,this.hot.getCellMeta(F.meta.visualRow,F.meta.visualCol)])),_=RF(C);n&&(h.args[0]=n);const E=[],R=pW(_,h.args[0],g,F=>{F.checked&&E.push(F.value),Ix(ww,this,RW).call(this,F,x)}),I=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,I).locale,d.args=[E],d.command=lg(cg),d.itemsSnapshot=R}else d.args=[],d.command=lg(Us);this.state.setValueAtIndex(i,d)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof mC)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,i,s,n,o)=>{at(r.parentNode,"htFiltersMenuValue");const l=this.hot.rootDocument.createElement("div");return at(l,"htFiltersMenuLabel"),l.textContent=o,r.appendChild(l),r.parentElement.hasAttribute("ghost-table")||xe(this.elements,h=>r.appendChild(h.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(QE),r=this._getColumnVisibleValues(),i=r.map(h=>h.value),s=new Map(r.map(h=>[h.value,h.meta])),n=RF(i),o=pW(n,n,e,h=>{Ix(ww,this,RW).call(this,h,s)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(n);const l=this.hot.getPlugin("filters").getSelectedColumn();l!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,l.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:on(this.hot.getDataAtCol(e.visualIndex),(r,i)=>({value:jQ(r),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function F6e(t){qC(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),jc(t))}function RW(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function M6e(t,e){switch(e.type){case"numeric":return VJ(t,e);default:return t}}var JQ;function k6e(t,e){N6e(t,e),e.add(t)}function N6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function D6e(t,e,r){return(e=L6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function L6e(t){var e=H6e(t,"string");return typeof e=="symbol"?e:e+""}function H6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $6e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var AW=new WeakSet;class pC extends cS{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),k6e(this,AW),D6e(this,"name",""),this.name=r.name,this.elements.push(new Td(this.hot,{type:"button",value:HD,className:"htUIButton htUIButtonOK",identifier:pC.BUTTON_OK})),this.elements.push(new Td(this.hot,{type:"button",value:$D,className:"htUIButton htUIButtonCancel",identifier:pC.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){xe(this.elements,e=>{e.addLocalHook("click",(r,i)=>$6e(AW,this,B6e).call(this,r,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(at(r.parentNode,"htFiltersMenuActionBar"),xe(this.elements,i=>r.appendChild(i.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}JQ=pC;function B6e(t,e){e.options.identifier===JQ.BUTTON_OK?this.accept():this.cancel()}function Px(t,e,r){return(e=V6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V6e(t){var e=W6e(t,"string");return typeof e=="symbol"?e:e+""}function W6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const OW="ConditionCollection.filteringStates";class R6{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Px(this,"hot",void 0),Px(this,"isMapRegistrable",void 0),Px(this,"filteringStates",new U_),Px(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(OW,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var i;const s=this.filteringStates.getValueAtIndex(r),n=(i=s==null?void 0:s.conditions)!==null&&i!==void 0?i:[],o=s==null?void 0:s.operation;return this.isMatchInConditions(n,e,o)}isMatchInConditions(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ed;return e.length?kDe(i)(e,r):!0}addCondition(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ed,s=arguments.length>3?arguments[3]:void 0;const n=this.hot.getCellMeta(0,e).locale,o=on(r.args,g=>typeof g=="string"?g.toLocaleLowerCase(n):g),l=r.name||r.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==i)throw Error(Ln`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Ai(fC[i]))throw new Error(Ln`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:l,args:o,func:Od(l,o)}]},s):d.push({name:l,args:o,func:Od(l,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,i;return(r=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return ha(this.filteringStates.getEntries(),(e,r)=>{let[i,{operation:s,conditions:n}]=r;return e.push({column:i,operation:s,conditions:on(n,o=>{let{name:l,args:h}=o;return{name:l,args:h}})}),e},[])}importAllConditions(e){this.clean(),xe(e,r=>{xe(r.conditions,i=>this.addCondition(r.column,i))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const i=this.getConditions(e);return r?i.some(s=>s.name===r):i.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(OW),this.filteringStates=null,this.clearLocalHooks()}}qn(R6,mo);function IW(t,e,r){return(e=j6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j6e(t){var e=U6e(t,"string");return typeof e=="symbol"?e:e+""}function U6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QQ{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];IW(this,"conditionCollection",void 0),IW(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return xe(this.conditionCollection.getFilteredColumns(),(r,i)=>{let s=this.columnDataFactory(r);i&&(s=this._getIntersectData(s,e)),e=this.filterByColumn(r,s)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return xe(r,s=>{s!==void 0&&this.conditionCollection.isMatch(s,e)&&i.push(s)}),i}_getIntersectData(e,r){const i=[];return xe(r,s=>{const n=s.meta.visualRow;e[n]!==void 0&&(i[n]=e[n])}),i}}function z6e(t,e){G6e(t,e),e.add(t)}function G6e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function O0(t,e,r){return(e=Y6e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y6e(t){var e=K6e(t,"string");return typeof e=="symbol"?e:e+""}function K6e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function AI(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Fx=new WeakSet;class ZQ{constructor(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];z6e(this,Fx),O0(this,"hot",void 0),O0(this,"conditionCollection",void 0),O0(this,"columnDataFactory",void 0),O0(this,"changes",[]),O0(this,"grouping",!1),O0(this,"latestEditedColumnPosition",-1),O0(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",s=>AI(Fx,this,X6e).call(this,s)),this.conditionCollection.addLocalHook("afterRemove",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("afterAdd",s=>this.updateStatesAtColumn(s)),this.conditionCollection.addLocalHook("beforeClean",()=>AI(Fx,this,q6e).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>AI(Fx,this,J6e).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,xe(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const s=this.conditionCollection.exportAllConditions();let n=this.conditionCollection.getColumnStackPosition(e);n===-1&&(n=this.latestEditedColumnPosition);const o=s.slice(0,n),l=s.slice(n);l.length&&l[0].column===e&&l.shift();const h=NSe(function(g,y){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const x=new R6(i.hot,!1),_=[].concat(g,C);x.importAllConditions(_);const E=i.columnDataFactory(y);let R;x.isEmpty()?R=E:R=new QQ(x,F=>i.columnDataFactory(F)).filter(),R=on(R,F=>F.meta.visualRow);const I=uS(R);return x.destroy(),Ad(E,F=>I(F.meta.visualRow))})(o),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:l,filteredRowsFactory:h,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),Zr(this,(e,r)=>{this[r]=null})}}function X6e(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function q6e(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function J6e(){xe(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}qn(ZQ,mo);function Q6e(t){return CQ({initialPage:0,size:()=>t.length,onItemSelect:(r,i)=>{const s=t[r];if(s instanceof mC)return i;if(s.element&&!l1(s.element))return!1;s.focus()}})}const yw="filters";function Z6e(t,e){let r=-1,i;const s=Q6e(e),n=y=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(yw),s.setCurrentPage(e.indexOf(y))};e.forEach(y=>{y instanceof Mc&&(y.addLocalHook("click",n(y)),y.addLocalHook("focus",n(y)),y.addLocalHook("afterClose",n(y)))}),h(t);function o(y){const C=i.getKeyboardShortcutsCtrl(),x=y.getKeyboardShortcutsCtrl();s.clear(),x.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:C.getContext(yw),callback:()=>{y.isSubMenu()&&y.close(),C.listen(yw)}}]),!y.isSubMenu()&&C.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:_=>{const E=i.getNavigator();E.getCurrentPage()>-1&&(r=E.getCurrentPage()),E.clear(),_.shiftKey?s.toPreviousItem():s.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:_=>{const E=e[s.getCurrentPage()];E instanceof dC&&(E.openOptions(),_.preventDefault()),E instanceof gC&&(E.activate(),_.preventDefault()),E instanceof Mc||_.preventDefault()}}],yw)}function l(){i.focus(),i.getKeyboardShortcutsCtrl().listen(yw)}function h(y){y.addLocalHook("afterSelectionChange",C=>{C.key.startsWith("filter_")||s.clear()}),y.addLocalHook("afterSubmenuOpen",o),y.addLocalHook("afterOpen",o),i=y}function d(){return i}function g(){return r}return{...s,listen:l,setMenu:h,getMenu:d,getLastMenuPage:g}}function e5e(t,e){eZ(t,e),e.add(t)}function PW(t,e,r){eZ(t,e),e.set(t,r)}function eZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cw(t,e,r){return(e=t5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function t5e(t){var e=r5e(t,"string");return typeof e=="symbol"?e:e+""}function r5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function n5e(t,e,r){return t.set(Sa(t,e),r),r}function Mh(t,e){return t.get(Sa(t,e))}function Sa(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const OF="filters",i5e=250,FW=OF;var Eh=new WeakMap,IF=new WeakMap,Ba=new WeakSet;class s5e extends On{static get PLUGIN_KEY(){return OF}static get PLUGIN_PRIORITY(){return i5e}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),e5e(this,Ba),Cw(this,"dropdownMenuPlugin",null),Cw(this,"conditionCollection",null),Cw(this,"conditionUpdateObserver",null),Cw(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Cw(this,"filtersRowsMap",null),PW(this,Eh,void 0),PW(this,IF,new WeakSet),this.hot.addHook("afterGetColHeader",(r,i)=>Sa(Ba,this,f5e).call(this,r,i))}isEnabled(){return!!this.hot.getSettings()[OF]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new eS),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const r=this.hot.getSettings().dropdownMenu,i=r&&r.uiContainer||this.hot.rootDocument.body,s=l=>(l.addLocalHook("accept",()=>Sa(Ba,this,MW).call(this,"accept")),l.addLocalHook("cancel",()=>Sa(Ba,this,MW).call(this,"cancel")),l.addLocalHook("change",h=>Sa(Ba,this,h5e).call(this,l,h)),l),n=()=>`${this.hot.getTranslatedPhrase(MD)}:`,o=()=>`${this.hot.getTranslatedPhrase(kD)}:`;if(!this.components.get("filter_by_condition")){const l=new AF(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:i});l.addLocalHook("afterClose",()=>Sa(Ba,this,kW).call(this)),this.components.set("filter_by_condition",s(l))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new g6e(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const l=new AF(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});l.addLocalHook("afterClose",()=>Sa(Ba,this,kW).call(this)),this.components.set("filter_by_condition2",s(l))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",s(new P6e(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",s(new pC(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new R6(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ZQ(this.hot,this.conditionCollection,l=>this.getDataMapAtColumn(l)),this.conditionUpdateObserver.addLocalHook("update",l=>Sa(Ba,this,d5e).call(this,l))),this.components.forEach(l=>l.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var l=arguments.length,h=new Array(l),d=0;d<l;d++)h[d]=arguments[d];return Sa(Ba,e,u5e).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>Sa(Ba,this,c5e).call(this)),this.addHook("afterDropdownMenuShow",()=>Sa(Ba,this,a5e).call(this)),this.addHook("afterDropdownMenuHide",()=>Sa(Ba,this,l5e).call(this)),this.addHook("afterChange",l=>Sa(Ba,this,o5e).call(this,l)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Mh(Eh,this)&&this.dropdownMenuPlugin.enabled){const l=[{focus:()=>{const d=Mh(Eh,this).getMenu(),g=d.getNavigator(),y=Mh(Eh,this).getLastMenuPage();d.focus(),y>0?g.setCurrentPage(y):g.toFirstItem()}},...Array.from(this.components).map(d=>{let[,g]=d;return g.getElements()}).flat()];n5e(Eh,this,Z6e(this.dropdownMenuPlugin.menu,l));const h=d=>{Mh(Eh,this).listen(),d.preventDefault(),qC(d.keyCode,"TAB")&&(d.shiftKey?Mh(Eh,this).toPreviousItem():Mh(Eh,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,i)=>{r.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:FW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FW)}addCondition(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ed;const n=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(n,{command:{key:r},args:i},s)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let s=[];const n=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",n,this.conditionCollection.previousConditionStack)!==!1)if(i){const l=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),s=on(r.filter(),d=>d.meta.visualRow);const h=uS(s);pr(this.hot.countSourceRows()-1,d=>{h(d)||l.push(d)}),xe(l,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!s.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",n),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),i=[];return xe(this.hot.getSourceDataAtCol(r),(s,n)=>{var o;const{row:l,col:h,visualCol:d,visualRow:g,type:y,instance:C,dateFormat:x,locale:_}=this.hot.getCellMeta(n,r),E=(o=this.hot.getDataAtCell(this.hot.toVisualRow(n),r))!==null&&o!==void 0?o:s;i.push({meta:{row:l,col:h,visualCol:d,visualRow:g,type:y,instance:C,dateFormat:x,locale:_},value:jQ(E)})}),i}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),i=RF(r);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var r;const i=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(s=>{s.isHidden()||s.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,i,s){let n=e;return n===dT&&r.command.key!==Us&&i.command.key!==Us&&s.command.key!==Us?n=T6:s.command.key!==Us&&(r.command.key===Us||i.command.key===Us)&&(n=Ed),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new QQ(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return xe(s,o=>{xe(r.menuItems,(l,h)=>{l.key===o.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,s=i.getPlugin("hiddenRows");for(var n=arguments.length,o=new Array(n>1?n-1:0),l=1;l<n;l++)o[l-1]=arguments[l];const h=this.getIndexesOfComponents(...o);e?s.showRows(h):s.hideRows(h),i.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function o5e(t){t&&xe(t,e=>{const[,r]=e,i=this.hot.propToCol(r);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function a5e(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function l5e(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function c5e(){const t=this.dropdownMenuPlugin.menu;Mh(IF,this).has(t)||Mh(Eh,this).setMenu(t),Mh(IF,this).add(t)}function u5e(t){t.items.push({name:Xr}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function MW(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:s}=i,n=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),l=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,o,l);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(s);d===-1&&(d=void 0),this.conditionCollection.removeConditions(s),n.command.key!==Us&&(this.conditionCollection.addCondition(s,n,h,d),o.command.key!==Us&&this.conditionCollection.addCondition(s,o,h,d)),l.command.key!==Us&&this.conditionCollection.addCondition(s,l,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(s)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function h5e(t,e){const r=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===AF&&!e.inputsCount&&this.setListeningDropdownMenu(),r.updateMenuDimensions()}function kW(){this.setListeningDropdownMenu()}function f5e(t,e){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?at(e,"htFiltersActive"):_r(e,"htFiltersActive")}function d5e(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:i}}=t,s=r.filter(o=>o.name===cg),n=r.filter(o=>o.name!==cg);if(s.length>=2||n.length>=3)Nn(Ln`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(n[0],i),this.components.get("filter_by_condition2").updateState(n[1],i),this.components.get("filter_operators").updateState(o,i),this.components.get("filter_by_value").updateState(t)}}const tZ="internal-use-in-handsontable",PF={licenseKey:tZ,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function rZ(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Mo])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function nZ(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function g5e(t){var e;const r=t[Mo],i=nZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),s=rZ(t);return{...PF,...i,...s}}function m5e(t){var e;const r=t[Mo],i=nZ(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),s=rZ(t);return{...i,...s}}function p5e(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function hR(){const t="engine_relationship",e=Uc(Mo);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function A6(){const t="shared_engine_usage",e=Uc(Mo);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function v5e(t){const e=t.getSettings(),r=e[Mo],i=r==null?void 0:r.engine;if(r===!0||Ai(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var s;return w5e((s=i.hyperformula)!==null&&s!==void 0?s:i,e,t)}else if(typeof i=="object"&&Ai(i.hyperformula)){const n=hR(),o=A6().get(i);return n.has(i)||n.set(i,[]),n.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:tZ}),(i.getConfig().leapYear1900!==PF.leapYear1900||Yk(i.getConfig().nullDate,PF.nullDate)===!1)&&Nn(Ln`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function w5e(t,e,r){const i=e[Mo],s=g5e(e),n=hR(),o=A6();y5e(t,i.functions),C5e(t,i.language);const l=t.buildEmpty(s);return n.set(l,[r]),o.set(l,[r.guid]),S5e(l,i.namedExpressions),l.on("sheetAdded",()=>{l.rebuildAndRecalculate()}),l.on("sheetRemoved",()=>{l.rebuildAndRecalculate()}),l}function NW(t){var e;const r=hR(),i=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(s=>[s.getPlugin("formulas").sheetId,s]))}function DW(t,e){if(t){const r=hR(),i=r.get(t),s=A6(),n=s.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&r.delete(t)),n&&n.includes(e.guid)&&(n.splice(n.indexOf(e.guid),1),n.length===0&&(s.delete(t),t.destroy()))}}function y5e(t,e){e&&e.forEach(r=>{const{name:i,plugin:s,translations:n}=r;try{t.registerFunction(i,s,n)}catch(o){Nn(o.message)}})}function C5e(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(i){Nn(i.message)}}}function S5e(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:i,expression:s,scope:n,options:o}=r;try{t.addNamedExpression(i,s,n,o)}catch(l){Nn(l.message)}}),t.resumeEvaluation())}function b5e(t,e){return(Ai(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const iZ="DD/MM/YYYY";function sZ(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function x5e(t){return sZ(t)?t.substr(1):t}function E5e(t){return typeof t=="string"&&t.startsWith("=")}function O6(t,e){return typeof t=="string"&&e==="date"}function oZ(t,e){return mt(t,e,!0).isValid()}function aZ(t,e){return mt(t,e,!0).format(iZ)}function T5e(t,e){return mt(t,iZ,!0).format(e)}function lZ(t,e){const i=new Date(Date.UTC(0,0,t+-1));return mt(i).format(e)}function _5e(t,e,r){const i=Array.from(Array(r).keys()).filter(n=>t.includes(n)===!1);if(e===0){var s;return(s=i[e])!==null&&s!==void 0?s:0}return i[e-1]+1}function R5e(t,e){const r=[];return t.forEach(i=>{const s={from:i,to:e};r.forEach(n=>{const o=n.from>n.to,l=n.to<=s.from;n.from>s.from&&l&&o&&(s.from+=1)}),s.from>=e&&(e+=1),r.push(s)}),r}function A5e(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(s=>{const n=s.from<s.to;s.from>e.from&&n&&(s.from-=1)})}),t}function I6(t,e,r){const i=R5e(t,_5e(t,e,r));return A5e(i)}function I0(t,e,r){O5e(t,e),e.set(t,r)}function O5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pi(t,e){return t.get(cZ(t,e))}function Nf(t,e,r){return t.set(cZ(t,e),r),r}function cZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Sw=new WeakMap,Df=new WeakMap,Va=new WeakMap,Mx=new WeakMap,OI=new WeakMap,II=new WeakMap,kx=new WeakMap;class LW{constructor(e,r,i){I0(this,Sw,void 0),I0(this,Df,void 0),I0(this,Va,void 0),I0(this,Mx,[]),I0(this,OI,[]),I0(this,II,void 0),I0(this,kx,[]),Nf(Sw,this,e),Nf(Df,this,r),Nf(Va,this,i)}setRemovedHfIndexes(e){return Nf(kx,this,e.map(r=>{const i=pi(Df,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(i)})),pi(kx,this)}getRemovedHfIndexes(){return pi(kx,this)}getHfIndexFromVisualIndex(e){const r=pi(Df,this).getIndexesSequence(),i=pi(Df,this).getNotTrimmedIndexes();return r.indexOf(i[e])}syncMoves(e){const i=`move${Hc(pi(Sw,this))}s`;pi(Va,this).getEngine().batch(()=>{e.forEach(s=>{const n=s.from!==s.to,o=s.from+1!==s.to;n&&o&&pi(Va,this).getEngine()[i](pi(Va,this).getSheetId(),s.from,1,s.to)})})}storeMovesInformation(e,r,i){i!==!1&&(Nf(OI,this,e.map(s=>this.getHfIndexFromVisualIndex(s))),Nf(II,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(pi(Va,this).isPerformingUndoRedo()||e===!1||r===!1)return;const i=I6(pi(OI,this),pi(II,this),pi(Df,this).getNumberOfIndexes());pi(Va,this).getSheetId()===null?pi(Va,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Hc(pi(Sw,this))}Order`;return r=>{if(pi(Va,this).isPerformingUndoRedo())return;const i=pi(Df,this).getIndexesSequence();if(r==="update"&&i.length>0){const s=pi(Mx,this).map(h=>i.indexOf(h)),n=pi(Va,this).getEngine().getSheetDimensions(pi(Va,this).getSheetId());let o;pi(Sw,this)==="row"?o=n.height:o=n.width;const l=s.length;for(let h=l;h<o;h+=1)s.push(h);pi(Va,this).getEngine()[e](pi(Va,this).getSheetId(),s)}Nf(Mx,this,i)}}init(){Nf(Mx,this,pi(Df,this).getIndexesSequence())}}function P0(t,e,r){I5e(t,e),e.set(t,r)}function I5e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yh(t,e){return t.get(uZ(t,e))}function F0(t,e,r){return t.set(uZ(t,e),r),r}function uZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Nx=new WeakMap,Dx=new WeakMap,PI=new WeakMap,FI=new WeakMap,MI=new WeakMap,kI=new WeakMap,NI=new WeakMap;class P5e{constructor(e,r,i){P0(this,Nx,void 0),P0(this,Dx,void 0),P0(this,PI,void 0),P0(this,FI,!1),P0(this,MI,!1),P0(this,kI,null),P0(this,NI,null),F0(Nx,this,new LW("row",e,this)),F0(Dx,this,new LW("column",r,this)),F0(PI,this,i)}getForAxis(e){return e==="row"?yh(Nx,this):yh(Dx,this)}setPerformUndo(e){F0(FI,this,e)}setPerformRedo(e){F0(MI,this,e)}isPerformingUndoRedo(){return yh(FI,this)||yh(MI,this)}getSheetId(){return yh(NI,this)}getEngine(){return yh(kI,this)}getPostponeAction(){return yh(PI,this)}setupSyncEndpoint(e,r){F0(kI,this,e),F0(NI,this,r),yh(Nx,this).init(),yh(Dx,this).init()}}function F5e(t,e){hZ(t,e),e.add(t)}function Km(t,e,r){return(e=M5e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function M5e(t){var e=k5e(t,"string");return typeof e=="symbol"?e:e+""}function k5e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DI(t,e,r){hZ(t,e),e.set(t,r)}function hZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Id(t,e,r){return t.set(jn(t,e),r),r}function Yp(t,e){return t.get(jn(t,e))}function jn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Mo="formulas",N5e=["maxRows","maxColumns","language"],D5e=260;Xt.getSingleton().register("afterNamedExpressionAdded");Xt.getSingleton().register("afterNamedExpressionRemoved");Xt.getSingleton().register("afterSheetAdded");Xt.getSingleton().register("afterSheetRemoved");Xt.getSingleton().register("afterSheetRenamed");Xt.getSingleton().register("afterFormulasValuesUpdate");const H1=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var sf=new WeakMap,P6=new WeakMap,bw=new WeakMap,Zn=new WeakSet;class L5e extends On{constructor(){var e;super(...arguments),e=this,F5e(this,Zn),DI(this,sf,!1),DI(this,P6,!1),DI(this,bw,[["valuesUpdated",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,Z5e).call(e,...i)}],["namedExpressionAdded",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,eLe).call(e,...i)}],["namedExpressionRemoved",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,tLe).call(e,...i)}],["sheetAdded",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,rLe).call(e,...i)}],["sheetRenamed",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,nLe).call(e,...i)}],["sheetRemoved",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return jn(Zn,e,iLe).call(e,...i)}]]),Km(this,"staticRegister",Uc("formulas")),Km(this,"engine",null),Km(this,"sheetName",null),Km(this,"indexSyncer",null),Km(this,"rowAxisSyncer",null),Km(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Mo}static get PLUGIN_PRIORITY(){return D5e}static get SETTING_KEYS(){return[Mo,...N5e]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Mo]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=v5e(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Nn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,this.hot.getSourceDataArray());i!==!1&&(this.sheetName=i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,HW).call(r,...s)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,$W).call(r,...s)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,HW).call(r,...s)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,$W).call(r,...s)}),this.addHook("modifyData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,V5e).call(r,...s)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,W5e).call(r,...s)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,H5e).call(r,...s)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,j5e).call(r,...s)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,BW).call(r,...s)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,BW).call(r,...s)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,U5e).call(r,...s)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,z5e).call(r,...s)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,K5e).call(r,...s)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,X5e).call(r,...s)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,G5e).call(r,...s)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,Y5e).call(r,...s)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,q5e).call(r,...s)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,J5e).call(r,...s)}),this.indexSyncer=new P5e(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,s,n,o)=>{this.rowAxisSyncer.storeMovesInformation(i,s,o)}),this.hot.addHook("beforeColumnMove",(i,s,n,o)=>{this.columnAxisSyncer.storeMovesInformation(i,s,o)}),this.hot.addHook("afterRowMove",(i,s,n,o,l)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,l)}),this.hot.addHook("afterColumnMove",(i,s,n,o,l)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,l)}),this.hot.addHook("beforeColumnFreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,s)}),this.hot.addHook("afterColumnFreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.hot.addHook("beforeColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,s)}),this.hot.addHook("afterColumnUnfreeze",(i,s)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,s)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,B5e).call(r,...s)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,Q5e).call(r,...s)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return jn(Zn,r,$5e).call(r,...s)}),Yp(bw,this).forEach(i=>{let[s,n]=i;return this.engine.on(s,n)}),super.enablePlugin()}}disablePlugin(){Yp(bw,this).forEach(e=>{let[r,i]=e;return this.engine.off(r,i)}),DW(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=m5e(this.hot.getSettings());p5e(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const i=this.hot.getSettings()[Mo];if(rr(i)&&rr(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const s=this.hot.getSettings()[Mo].sheetName;s&&this.engine.doesSheetExist(s)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(s??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Yp(bw,this).forEach(e=>{var r;let[i,s]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(i,s)}),Id(bw,this,null),DW(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(rr(r)&&!v_e(r))return Nn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Nn("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(i),r),i}catch(i){return Nn(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){qk(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${Hc(Mo)}.switchSheet`)}getCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const s=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(r);return s!==null&&n!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(s=>{var n;const o=s==null||(n=s.address)===null||n===void 0?void 0:n.sheet;o!==void 0&&(i.has(o)||i.add(o))}),NW(this.engine).forEach((s,n)=>{if((r||n!==this.sheetId)&&i.has(n)){var o;s.render(),(o=s.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=n=>{var o;const{row:l,col:h,sheet:d}=(o=n==null?void 0:n.address)!==null&&o!==void 0?o:{};return rr(d)?`${d}:${l}x${h}`:""},s=new Set(r.map(n=>i(n)));e.forEach(n=>{var o,l;const{row:h,col:d}=(o=n.address)!==null&&o!==void 0?o:{};if(rr(h)===!1||rr(d)===!1||h>=this.hot.countRows()||d>=this.hot.countCols())return;const g=n==null||(l=n.address)===null||l===void 0?void 0:l.sheet,y=i(n);if(g!==void 0&&!s.has(y)){const C=NW(this.engine).get(g);if(!C)return;C.validateCell(C.getDataAtCell(h,d),C.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(e,r,i){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(s)){Nn(`Not possible to set cell data at ${JSON.stringify(s)}`);return}const n=this.hot.getCellMeta(e,r);return O6(i,n.type)&&(oZ(i,n.dateFormat)?i=aZ(i,n.dateFormat):E5e(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(s,i)}}function H5e(t,e,r){const i=this.hot.propToCol(r);if(this.isFormulaCellType(e,i)){const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},n=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(s);return n.type==="date"&&na(o)&&(o=lZ(o,n.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function $5e(t,e,r){const{row:i,col:s}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),{row:l,col:h}=r.getTopStartCorner(),{row:d,col:g}=r.getBottomEndCorner(),y={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},C={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(C)===!1)return!1;const x=this.engine.getFillRangeData(y,C),{row:_,col:E}=y.start,{row:R,col:I}=y.end,F=R-_+1,H=I-E+1;for(let z=0;z<x.length;z+=1)for(let q=0;q<x[z].length;q+=1){const re=x[z][q],Y=_+z%F,oe=E+q%H,me=this.hot.getCellMeta(Y,oe);O6(re,me.type)&&(re.startsWith("'")?x[z][q]=re.slice(1):this.isFormulaCellType(Y,oe,this.sheetId)===!1&&(x[z][q]=T5e(re,me.dateFormat)))}return x}function HW(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Hc(Mo))||Id(P6,this,Ai(this.hot.getSettings().data))}function B5e(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((r,i)=>{r.forEach((s,n)=>{const o=this.hot.getCellMeta(i,n),l=o.dateFormat;O6(s,o.type)&&(e=!0,oZ(s,l)?t[i][n]=aZ(s,l):this.isFormulaCellType(i,n)===!1&&(t[i][n]=`'${s}`))})}),e===!0&&(Id(sf,this,!0),this.engine.setSheetContent(this.sheetId,t),Id(sf,this,!1))}function $W(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Hc(Mo)))if(this.sheetName=b5e(this.engine,this.hot.getSettings()[Mo].sheetName),Yp(P6,this))this.switchSheet(this.sheetName);else{const i=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,i)){Id(sf,this,!0);const s=this.engine.setSheetContent(this.sheetId,i);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Id(sf,this,!1)}}}function V5e(t,e,r,i){if(i!=="get"||Yp(sf,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t);if(s===null||e===null)return;if(!this.isFormulaCellType(s,e)&&this.getCellType(s,e)!=="ARRAY"){sZ(r.value)&&(r.value=x5e(r.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let l=this.engine.getCellValue(o),h=this.hot.getCellsMeta().find(g=>g.visualRow===s&&g.visualCol===e);h===void 0&&(h={}),h.type==="date"&&na(l)&&(l=lZ(l,h.dateFormat));const d=typeof l=="object"&&l!==null?l.value:l;r.value=d}function W5e(t,e,r,i){if(i!=="get"||Yp(sf,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const s=this.hot.toVisualRow(t),n=this.hot.propToCol(e);if(s===null||n===null||!this.isFormulaCellType(s,n)&&this.getCellType(s,n)!=="ARRAY")return;const l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(l.width===0&&l.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};r.value=this.engine.getCellSerialized(h)}function BW(t,e){if(H1(e))return;const r=[],i=[],s=this.engine.batch(()=>{t.forEach(n=>{let[o,l,,h]=n;const d=this.hot.propToCol(l),g=this.hot.toPhysicalRow(o),y=this.hot.toPhysicalColumn(d),C={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};g!==null&&y!==null?this.syncChangeWithEngine(o,d,h):r.push([o,d,h]),i.push({address:C})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const n=this.engine.batch(()=>{r.forEach(o=>{let[l,h,d]=o;this.syncChangeWithEngine(l,h,d)})});this.renderDependentSheets(n,!0)}),this.renderDependentSheets(s),this.validateDependentCells(s,i)}function j5e(t,e){if(H1(e))return;const r=[],i=[];t.forEach(s=>{let[n,o,,l]=s;const h=this.hot.propToCol(o);if(!na(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){Nn(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),r.push(...this.engine.setCellContents(d,l))}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function U5e(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function z5e(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function G5e(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(n=>this.engine.isItPossibleToRemoveRows(this.sheetId,[n,1]))===!1?!1:void 0}function Y5e(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(n=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[n,1]))===!1?!1:void 0}function K5e(t,e,r){if(H1(r))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function X5e(t,e,r){if(H1(r))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function q5e(t,e,r,i){if(H1(i))return;const s=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,l)=>l-o),n=this.engine.batch(()=>{s.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(n)}function J5e(t,e,r,i){if(H1(i))return;const s=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,l)=>l-o),n=this.engine.batch(()=>{s.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(n)}function Q5e(t,e,r){var i;Id(sf,this,!0);const s=this.hot.getSourceDataArray(r,0,r+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Id(sf,this,!1),s.forEach((n,o)=>{n.forEach((l,h)=>{this.engine.setCellContents({col:h,row:r+o,sheet:this.sheetId},[[l]])})})}function Z5e(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function eLe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function tLe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rLe(t){this.hot.runHooks("afterSheetAdded",t)}function nLe(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function iLe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function sLe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,i,,s]=e;i-s!==0&&(r=1)}return this.getTranslatedPhrase(uD,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.col,r.col),0),s=Math.max(e.col,r.col),n=[];for(let h=i;h<=s;h+=1)n.push(h);t.hideColumns(n);const o=n[n.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function oLe(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(hD,r)},callback(){var r,i;if(e.length===0)return;let s=e[0],n=e[e.length-1];s=(r=this.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&r!==void 0?r:0,n=(i=this.columnIndexMapper.getNearestNotHiddenIndex(n+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),n-s+1===this.countCols()||this.selectColumns(s,n)},disabled:!1,hidden(){const r=on(t.getHiddenColumns(),y=>this.toPhysicalColumn(y));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().col,n=i.getBottomEndCorner().col,o=this.columnIndexMapper,l=o.getRenderableFromVisualIndex(s),h=o.getRenderableFromVisualIndex(n),d=o.getNotTrimmedIndexes(),g=[];if(s!==n){const y=n-s+1,C=h-l+1;if(y>C){const x=d.slice(s,n+1);g.push(...x.filter(_=>r.includes(_)))}}else if(l===0&&l<s)g.push(...d.slice(0,s));else if(l===null)g.push(...d.slice(0,this.countCols()));else{const y=this.countCols()-1,C=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,-1));h===C&&y>n&&g.push(...d.slice(n+1))}return xe(g,y=>{e.push(this.toVisualColumn(y))}),e.length===0}}}function aLe(t,e){fZ(t,e),e.add(t)}function lLe(t,e,r){fZ(t,e),e.set(t,r)}function fZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function M0(t,e){return t.get(Gf(t,e))}function VW(t,e,r){return t.set(Gf(t,e),r),r}function Gf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeHideColumns");Xt.getSingleton().register("afterHideColumns");Xt.getSingleton().register("beforeUnhideColumns");Xt.getSingleton().register("afterUnhideColumns");const WW="hiddenColumns",cLe=310;var hu=new WeakMap,k0=new WeakSet;class uLe extends On{constructor(){super(...arguments),aLe(this,k0),lLe(this,hu,null)}static get PLUGIN_KEY(){return WW}static get PLUGIN_PRIORITY(){return cLe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[WW]}enablePlugin(){var e=this;this.enabled||(VW(hu,this,new j_),M0(hu,this).addLocalHook("init",()=>Gf(k0,this,pLe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,M0(hu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gf(k0,e,mLe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Gf(k0,this,fLe).call(this,r,i,s)),this.addHook("modifyColWidth",(r,i)=>Gf(k0,this,hLe).call(this,r,i),2),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Gf(k0,e,gLe).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Gf(k0,this,dLe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let s=r;const n=M0(hu,this).getValues().slice(),o=e.length>0;if(i&&o){const h=e.map(d=>this.hot.toPhysicalColumn(d));xe(h,d=>{n[d]=!1}),s=ha(n,(d,g,y)=>(g&&d.push(this.hot.toVisualColumn(y)),d),[])}this.hot.runHooks("beforeUnhideColumns",r,s,i&&o)!==!1&&(i&&o&&M0(hu,this).setValues(n),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,s,i&&o,i&&s.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{xe(e,o=>{M0(hu,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,s,i,i&&s.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideColumns(r)}getHiddenColumns(){return on(M0(hu,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return M0(hu,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){xe(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){VW(hu,this,null),super.destroy()}}function hLe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function fLe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenColumn");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}function dLe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,s,n,o)=>{e.push({startRow:i,endRow:s,startCol:n,endCol:o})};return xe(t,i=>{let s=!0,n=0;pr(i.startCol,i.endCol,o=>{this.isHidden(o)?(s||r(i.startRow,i.endRow,n,o-1),s=!0):(s&&(n=o),o===i.endCol&&r(i.startRow,i.endRow,n,o),s=!1)})}),e}function gLe(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),at(e,r)}function mLe(t){t.items.push({name:Xr},sLe(this),oLe(this))}function pLe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function vLe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[i,,s]=e;i-s!==0&&(r=1)}return this.getTranslatedPhrase(fD,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),i=Math.max(Math.min(e.row,r.row),0),s=Math.max(e.row,r.row),n=[];for(let h=i;h<=s;h+=1)n.push(h);t.hideRows(n);const o=n[n.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function wLe(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(dD,r)},callback(){var r,i;if(e.length===0)return;let s=e[0],n=e[e.length-1];s=(r=this.rowIndexMapper.getNearestNotHiddenIndex(s-1,-1))!==null&&r!==void 0?r:0,n=(i=this.rowIndexMapper.getNearestNotHiddenIndex(n+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),n-s+1===this.countRows()||this.selectRows(s,n)},disabled:!1,hidden(){const r=on(t.getHiddenRows(),y=>this.toPhysicalRow(y));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const i=this.getSelectedRangeLast(),s=i.getTopStartCorner().row,n=i.getBottomEndCorner().row,o=this.rowIndexMapper,l=o.getRenderableFromVisualIndex(s),h=o.getRenderableFromVisualIndex(n),d=o.getNotTrimmedIndexes(),g=[];if(s!==n){const y=n-s+1,C=h-l+1;if(y>C){const x=d.slice(s,n+1);g.push(...x.filter(_=>r.includes(_)))}}else if(l===0&&l<s)g.push(...d.slice(0,s));else if(l===null)g.push(...d.slice(0,this.countRows()));else{const y=this.countRows()-1,C=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(y,-1));h===C&&y>n&&g.push(...d.slice(n+1))}return xe(g,y=>{e.push(this.toVisualRow(y))}),e.length===0}}}function yLe(t,e){dZ(t,e),e.add(t)}function CLe(t,e,r){dZ(t,e),e.set(t,r)}function dZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N0(t,e){return t.get(Yf(t,e))}function jW(t,e,r){return t.set(Yf(t,e),r),r}function Yf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeHideRows");Xt.getSingleton().register("afterHideRows");Xt.getSingleton().register("beforeUnhideRows");Xt.getSingleton().register("afterUnhideRows");const UW="hiddenRows",SLe=320;var fu=new WeakMap,D0=new WeakSet;class bLe extends On{constructor(){super(...arguments),yLe(this,D0),CLe(this,fu,null)}static get PLUGIN_KEY(){return UW}static get PLUGIN_PRIORITY(){return SLe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[UW]}enablePlugin(){var e=this;this.enabled||(jW(fu,this,new j_),N0(fu,this).addLocalHook("init",()=>Yf(D0,this,ALe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,N0(fu,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Yf(D0,e,RLe).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,s)=>Yf(D0,this,ELe).call(this,r,i,s)),this.addHook("modifyRowHeight",(r,i)=>Yf(D0,this,xLe).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Yf(D0,e,_Le).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Yf(D0,this,TLe).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let s=r;const n=N0(fu,this).getValues().slice(),o=e.length>0;if(i&&o){const h=e.map(d=>this.hot.toPhysicalRow(d));xe(h,d=>{n[d]=!1}),s=ha(n,(d,g,y)=>(g&&d.push(this.hot.toVisualRow(y)),d),[])}this.hot.runHooks("beforeUnhideRows",r,s,i&&o)!==!1&&(i&&o&&N0(fu,this).setValues(n),this.hot.runHooks("afterUnhideRows",r,s,i&&o,i&&s.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{xe(e,o=>{N0(fu,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,s,i,i&&s.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.hideRows(r)}getHiddenRows(){return on(N0(fu,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return N0(fu,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<r):!1}resetCellsMeta(){xe(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){jW(fu,this,null),super.destroy()}}function xLe(t,e){return this.isHidden(e)?0:t}function ELe(t,e,r){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const i=r.className.split(" ");if(i.length>0){const s=i.indexOf("afterHiddenRow");s>-1&&i.splice(s,1),r.className=i.join(" ")}}}function TLe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],r=(i,s,n,o)=>{e.push({startRow:i,endRow:s,startCol:n,endCol:o})};return xe(t,i=>{let s=!0,n=0;pr(i.startRow,i.endRow,o=>{this.isHidden(o)?(s||r(n,o-1,i.startCol,i.endCol),s=!0):(s&&(n=o),o===i.endRow&&r(n,o,i.startCol,i.endCol),s=!1)})}),e}function _Le(t,e){if(!this.getSetting("indicators")||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),at(e,r)}function RLe(t){t.items.push({name:Xr},vLe(this),wLe(this))}function ALe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function OLe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(BN)},callback(e,r){const[{start:{col:i}}]=r;t.freezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function ILe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(VN)},callback(e,r){const[{start:{col:i}}]=r;t.unfreezeColumn(i),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function PLe(t,e){gZ(t,e),e.add(t)}function FLe(t,e,r){gZ(t,e),e.set(t,r)}function gZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FF(t,e){return t.get(mT(t,e))}function LI(t,e,r){return t.set(mT(t,e),r),r}function mT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeColumnFreeze");Xt.getSingleton().register("afterColumnFreeze");Xt.getSingleton().register("beforeColumnUnfreeze");Xt.getSingleton().register("afterColumnUnfreeze");const zW="manualColumnFreeze",MLe=110;var J0=new WeakMap,HI=new WeakSet;class kLe extends On{constructor(){super(...arguments),PLe(this,HI),FLe(this,J0,!1)}static get PLUGIN_KEY(){return zW}static get PLUGIN_PRIORITY(){return MLe}isEnabled(){return!!this.hot.getSettings()[zW]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>mT(HI,this,NLe).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>mT(HI,this,DLe).call(this,e,r)),super.enablePlugin())}disablePlugin(){LI(J0,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;FF(J0,this)||LI(J0,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const r=this.hot.getSettings(),i=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;FF(J0,this)||LI(J0,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function NLe(t){t.items.push({name:"---------"},OLe(this),ILe(this))}function DLe(t,e){if(FF(J0,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(i=>i<r))return!1}}function Lx(t,e,r){return(e=LLe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function LLe(t){var e=HLe(t,"string");return typeof e=="symbol"?e:e+""}function HLe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const $I=0,GW=1,YW=2,Xm="px";let mZ=class{constructor(e){Lx(this,"hot",void 0),Lx(this,"_element",null),Lx(this,"state",$I),Lx(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=YW}build(){this.state===$I&&(this._element=this.hot.rootDocument.createElement("div"),this.state=GW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=$I}isAppended(){return this.state===YW}isBuilt(){return this.state>=GW}setPosition(e,r){na(e)&&(this._element.style.top=e+Xm),na(r)&&(this._element.style[this.inlineProperty]=r+Xm)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){na(e)&&(this._element.style.width=e+Xm),na(r)&&(this._element.style.height=r+Xm)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){na(e)&&(this._element.style.marginTop=e+Xm),na(r)&&(this._element.style[`margin${Hc(this.inlineProperty)}`]=r+Xm)}getOffset(){const e=this._element.style,r=`margin${Hc(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const $Le="ht__manualColumnMove--backlight";let BLe=class extends mZ{build(){super.build(),at(this._element,$Le)}};const VLe="ht__manualColumnMove--guideline";let WLe=class extends mZ{build(){super.build(),at(this._element,VLe)}};function jLe(t,e){pZ(t,e),e.add(t)}function lc(t,e,r){pZ(t,e),e.set(t,r)}function pZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,r){return t.set(Kf(t,e),r),r}function lr(t,e){return t.get(Kf(t,e))}function Kf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeColumnMove");Xt.getSingleton().register("afterColumnMove");const BI="manualColumnMove",ULe=120,KW="ht__manualColumnMove",pT="show-ui",MF="on-moving--columns",kF="after-selection--columns";var ta=new WeakMap,Qf=new WeakMap,Vh=new WeakMap,Q2=new WeakMap,cd=new WeakMap,Qo=new WeakMap,Hx=new WeakMap,Il=new WeakMap,fp=new WeakMap,vT=new WeakMap,gy=new WeakMap,L0=new WeakSet;class zLe extends On{constructor(){super(...arguments),jLe(this,L0),lc(this,ta,new BLe(this.hot)),lc(this,Qf,new WLe(this.hot)),lc(this,Vh,[]),lc(this,Q2,0),lc(this,cd,!1),lc(this,Qo,{}),lc(this,Hx,void 0),lc(this,Il,void 0),lc(this,fp,void 0),lc(this,vT,void 0),lc(this,gy,void 0)}static get PLUGIN_KEY(){return BI}static get PLUGIN_PRIORITY(){return ULe}isEnabled(){return!!this.hot.getSettings()[BI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,GLe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,KLe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Kf(L0,this,qLe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Kf(L0,e,JLe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),at(this.hot.rootElement,KW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_r(this.hot.rootElement,KW),this.unregisterEvents(),lr(ta,this).destroy(),lr(Qf,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const i=lr(Hx,this),s=this.isMovePossible(e,r),n=this.hot.runHooks("beforeColumnMove",e,r,i,s);if(_a(Hx,this,void 0),n===!1)return;s&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=s&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,i,s,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const i=this.countFinalIndex(e,r);return _a(Hx,this,r),this.moveColumns(e,i)}isMovePossible(e,r){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),s=e.length+r>i,n=r<0,o=e.some(h=>h<0),l=e.some(h=>h>=i);return!(s||n||o||l)}isColumnOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}countFinalIndex(e,r){const i=ha(e,(s,n)=>(n<r&&(s+=1),s),0);return r-i}getColumnsWidth(e,r){const i=this.hot.columnIndexMapper;let s=0;for(let n=e;n<=r;n+=1){const o=i.getRenderableFromVisualIndex(n);n<0?s+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(s+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[BI];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const i=[];return pr(e,r,s=>{i.push(s)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(lr(Il,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,s=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let n=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,lr(Il,this)-1);const o=r.hider.offsetWidth,l=r.TBODY.offsetLeft,h=lr(ta,this).getOffset().start,d=lr(ta,this).getSize().width;let g=0,y=0;if(this.hot.isRtl()){const _=this.hot.rootWindow,E=os(this.hot.rootElement),R=_.innerWidth-lr(fp,this)-E;y=_.innerWidth-lr(Qo,this).eventPageX-R-(i.scrollX===void 0?s:0)}else y=lr(Qo,this).eventPageX-(lr(fp,this)-(i.scrollX===void 0?s:0));if(lr(vT,this)&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(lr(Il,this))&&(n+=s),n+=g,lr(Il,this)<0)lr(gy,this)>0?lr(Qo,this).col=0:lr(Qo,this).col=e>0?e-1:e;else if(lr(Qo,this).TD.offsetWidth/2+n<=y){const _=lr(Il,this)>=lr(Q2,this)?lr(Q2,this)-1:lr(Il,this);lr(Qo,this).col=_+1,n+=lr(Qo,this).TD.offsetWidth}else lr(Qo,this).col=lr(Il,this);let C=y,x=n;y+d+h>=o?C=o-d-h:y+h<l+g&&(C=l+g+Math.abs(h)),n>=o-1?x=o-1:x===0?x=1:i.scrollX!==void 0&&lr(Il,this)<lr(gy,this)&&(x-=lr(fp,this)<=i.scrollX?lr(fp,this):0),lr(ta,this).setPosition(null,C),lr(Qf,this).setPosition(null,x)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Kf(L0,this,YLe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Kf(L0,this,XLe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){lr(ta,this).build(),lr(Qf,this).build()}destroy(){lr(ta,this).destroy(),lr(Qf,this).destroy(),super.destroy()}}function GLe(t,e,r,i){const s=this.hot.view._wt.wtTable,n=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),l=Rr(t.target,"sortAction");if(!o||!n||lr(cd,this)||t.button!==0||l){_a(cd,this,!1),lr(Vh,this).length=0,_r(this.hot.rootElement,[MF,pT]);return}const h=lr(Qf,this).isBuilt()&&!lr(Qf,this).isAppended(),d=lr(ta,this).isBuilt()&&!lr(ta,this).isAppended();h&&d&&(lr(Qf,this).appendTo(s.hider),lr(ta,this).appendTo(s.hider));const{from:g,to:y}=o,C=Math.min(g.col,y.col),x=Math.max(g.col,y.col);if(e.row<0&&e.col>=C&&e.col<=x){i.column=!0,_a(cd,this,!0);const _=r.firstChild?cbe(t,r.firstChild).x:t.offsetX;lr(Qo,this).eventPageX=t.pageX,_a(Il,this,e.col),lr(Qo,this).TD=r,lr(Qo,this).col=e.col,_a(Vh,this,this.prepareColumnsToMoving(C,x)),_a(vT,this,!!this.hot.getSettings().rowHeaders),_a(Q2,this,this.hot.countCols()),_a(gy,this,this.hot.getSettings().fixedColumnsStart),_a(fp,this,zs(this.hot.rootElement).left);const E=lr(vT,this)?-1:0,R=s.holder.scrollTop+s.getColumnHeaderHeight(0)+1,I=e.col<lr(gy,this),F=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),H=Math.abs(_-(this.hot.isRtl()?r.offsetWidth:0)),z=this.getColumnsWidth(C,e.col-1)+H,q=this.getColumnsWidth(E,C-1)+(I?F:0)+z;lr(ta,this).setPosition(R,q),lr(ta,this).setSize(this.getColumnsWidth(C,x),s.hider.offsetHeight-R),lr(ta,this).setOffset(null,-z),at(this.hot.rootElement,MF)}else _r(this.hot.rootElement,kF),_a(cd,this,!1),lr(Vh,this).length=0}function YLe(t){lr(cd,this)&&(lr(Qo,this).eventPageX=t.pageX,this.refreshPositions())}function KLe(t,e,r,i){!this.hot.getSelectedRangeLast()||!lr(cd,this)||(lr(Vh,this).indexOf(e.col)>-1?_r(this.hot.rootElement,pT):at(this.hot.rootElement,pT),i.row=!0,i.column=!0,i.cell=!0,_a(Il,this,e.col),lr(Qo,this).TD=r)}function XLe(){const t=lr(Qo,this).col,e=lr(Vh,this).length;if(_a(Il,this,void 0),_a(cd,this,!1),_r(this.hot.rootElement,[MF,pT,kF]),this.hot.selection.isSelectedByColumnHeader()&&at(this.hot.rootElement,kF),e<1||t===void 0)return;const r=lr(Vh,this)[0],i=this.hot.toPhysicalColumn(r),s=this.dragColumns(lr(Vh,this),t);if(lr(Vh,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const n=this.hot.toVisualColumn(i),o=n+e-1;this.hot.selectColumns(n,o)}}function qLe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,i=e+r;lr(ta,this).setPosition(i),lr(ta,this).setSize(null,t.hider.offsetHeight-i)}function JLe(){this.moveBySettingsOrLoad()}function QLe(t,e){vZ(t,e),e.add(t)}function Ro(t,e,r){vZ(t,e),e.set(t,r)}function vZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qi(t,e,r){return t.set(yc(t,e),r),r}function Gt(t,e){return t.get(yc(t,e))}function yc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wT="manualColumnResize",ZLe=130,XW="manualColumnWidths";var Ih=new WeakMap,$x=new WeakMap,Ka=new WeakMap,yT=new WeakMap,Du=new WeakMap,e8e=new WeakMap,Kp=new WeakMap,Bx=new WeakMap,Ca=new WeakMap,Th=new WeakMap,kg=new WeakMap,CT=new WeakMap,my=new WeakMap,py=new WeakMap,Qa=new WeakMap,vy=new WeakMap,du=new WeakSet;class t8e extends On{static get PLUGIN_KEY(){return wT}static get PLUGIN_PRIORITY(){return ZLe}constructor(e){super(e),QLe(this,du),Ro(this,Ih,null),Ro(this,$x,null),Ro(this,Ka,[]),Ro(this,yT,null),Ro(this,Du,null),Ro(this,e8e,null),Ro(this,Kp,null),Ro(this,Bx,null),Ro(this,Ca,this.hot.rootDocument.createElement("DIV")),Ro(this,Th,this.hot.rootDocument.createElement("DIV")),Ro(this,kg,null),Ro(this,CT,!1),Ro(this,my,0),Ro(this,py,null),Ro(this,Qa,void 0),Ro(this,vy,void 0),at(Gt(Ca,this),"manualColumnResizer"),at(Gt(Th,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[wT]}enablePlugin(){var e=this;this.enabled||(qi(Qa,this,new $d),Gt(Qa,this).addLocalHook("init",()=>yc(du,this,r8e).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Gt(Qa,this)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return yc(du,e,l8e).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return yc(du,e,c8e).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return yc(du,e,u8e).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){qi(vy,this,Gt(Qa,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",XW,Gt(Qa,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",XW,e),e.value}setManualSize(e,r){const i=Math.max(r,20),s=this.hot.toPhysicalColumn(e);return Gt(Qa,this).setValueAtIndex(s,i),i}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);Gt(Qa,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;qi(Ih,this,e);const{_wt:r}=this.hot.view,i=r.wtTable.getCoords(Gt(Ih,this)),s=i.col;if(s<0)return;const n=es(Gt(Ih,this)),o=Gt(Ih,this).getBoundingClientRect(),l=s<r.getSetting("fixedColumnsStart");let h;l&&(h=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Gt(Ih,this),i.row,i.col)),h||(h=r.wtOverlays.topOverlay.getRelativeCellPosition(Gt(Ih,this),i.row,i.col)),qi($x,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(s)),qi(Ka,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();xe(g,y=>{const C=y.getTopStartCorner().col,x=y.getBottomEndCorner().col;pr(C,x,_=>{Gt(Ka,this).includes(_)||Gt(Ka,this).push(_)})})}Gt(Ka,this).includes(Gt($x,this))||qi(Ka,this,[Gt($x,this)]),qi(Bx,this,h.start-6),qi(Kp,this,parseInt(o.width,10)),Gt(Ca,this).style.top=`${h.top}px`,Gt(Ca,this).style[this.inlineDir]=`${Gt(Bx,this)+Gt(Kp,this)}px`,Gt(Ca,this).style.height=`${n}px`,this.hot.rootElement.appendChild(Gt(Ca,this))}refreshHandlePosition(){Gt(Ca,this).style[this.inlineDir]=`${Gt(Bx,this)+Gt(yT,this)}px`}setupGuidePosition(){const e=parseInt(es(Gt(Ca,this)),10),r=parseInt(Gt(Ca,this).style.top,10)+e,i=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);at(Gt(Ca,this),"active"),at(Gt(Th,this),"active"),Gt(Th,this).style.top=`${r}px`,this.refreshGuidePosition(),Gt(Th,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(Gt(Th,this))}refreshGuidePosition(){Gt(Th,this).style[this.inlineDir]=Gt(Ca,this).style[this.inlineDir]}hideHandleAndGuide(){_r(Gt(Ca,this),"active"),_r(Gt(Th,this),"active")}checkIfColumnHeader(e){const r=Rg(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,s.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(i,s)=>{const n=this.hot.runHooks("beforeColumnResize",Gt(Du,this),i,!0);n!==void 0&&qi(Du,this,n),this.setManualSize(i,Gt(Du,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Gt(Du,this),i,!0),s&&e()};Gt(my,this)>=2&&(Gt(Ka,this).length>1?(xe(Gt(Ka,this),s=>{r(s)}),e()):xe(Gt(Ka,this),s=>{r(s,!0)})),qi(my,this,0),qi(py,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",i=>yc(du,this,n8e).call(this,i)),this.eventManager.addEventListener(r,"mousedown",i=>yc(du,this,i8e).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>yc(du,this,s8e).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>yc(du,this,o8e).call(this)),this.eventManager.addEventListener(Gt(Ca,this),"contextmenu",()=>yc(du,this,a8e).call(this))}destroy(){super.destroy()}}function r8e(){const t=this.hot.getSettings()[wT],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,i)=>{Gt(Qa,this).setValueAtIndex(i,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,i)=>{Gt(Qa,this).setValueAtIndex(i,r)})},!0),qi(vy,this,t)):t===!0&&Array.isArray(Gt(vy,this))&&this.hot.batchExecution(()=>{Gt(vy,this).forEach((r,i)=>{Gt(Qa,this).setValueAtIndex(i,r)})},!0)}function n8e(t){if(!KX(t.target)&&Gt(CT,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(Gt(kg,this)||this.setupHandlePosition(e))}}function i8e(t){t.target.parentNode===this.hot.rootElement&&Rr(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Gt(Ih,this)),this.setupGuidePosition(),qi(kg,this,!0),Gt(py,this)===null&&(qi(py,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Gt(py,this))),qi(my,this,Gt(my,this)+1),this.startX=t.pageX,qi(Du,this,Gt(Kp,this)))}function s8e(t){if(Gt(kg,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();qi(yT,this,Gt(Kp,this)+e),xe(Gt(Ka,this),r=>{qi(Du,this,this.setManualSize(r,Gt(yT,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function o8e(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeColumnResize",Gt(Du,this),r,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Gt(Du,this),r,!1)};Gt(kg,this)&&(this.hideHandleAndGuide(),qi(kg,this,!1),Gt(Du,this)!==Gt(Kp,this)&&(Gt(Ka,this).length>1?(xe(Gt(Ka,this),i=>{e(i)}),t()):xe(Gt(Ka,this),i=>{e(i,!0)})),this.setupHandlePosition(Gt(Ih,this)))}function a8e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Gt(Ca,this)),this.hot.rootElement.removeChild(Gt(Th,this)),qi(kg,this,!1),qi(CT,this,!0),this.hot._registerImmediate(()=>{qi(CT,this,!1)})}function l8e(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),s=Gt(Qa,this).getValueAtIndex(i);this.hot.getSettings()[wT]&&s&&(r=s)}return r}function c8e(t,e){const r=Gt(Qa,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof r=="number"?r:t}function u8e(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function VI(t,e,r){return(e=h8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h8e(t){var e=f8e(t,"string");return typeof e=="symbol"?e:e+""}function f8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const WI=0,qW=1,JW=2,qm="px";let wZ=class{constructor(e){VI(this,"hot",void 0),VI(this,"_element",null),VI(this,"state",WI),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=JW}build(){this.state===WI&&(this._element=this.hot.rootDocument.createElement("div"),this.state=qW)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=WI}isAppended(){return this.state===JW}isBuilt(){return this.state>=qW}setPosition(e,r){e!==void 0&&(this._element.style.top=e+qm),r!==void 0&&(this._element.style.left=r+qm)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+qm),r&&(this._element.style.height=r+qm)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+qm),r&&(this._element.style.marginLeft=r+qm)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const d8e="ht__manualRowMove--backlight";class g8e extends wZ{build(){super.build(),at(this._element,d8e)}}const m8e="ht__manualRowMove--guideline";class p8e extends wZ{build(){super.build(),at(this._element,m8e)}}function v8e(t,e){yZ(t,e),e.add(t)}function Jm(t,e,r){yZ(t,e),e.set(t,r)}function yZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ug(t,e,r){return t.set(Xf(t,e),r),r}function Dr(t,e){return t.get(Xf(t,e))}function Xf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeRowMove");Xt.getSingleton().register("afterRowMove");const jI="manualRowMove",w8e=140,QW="ht__manualRowMove",ST="show-ui",NF="on-moving--rows",DF="after-selection--rows";var ra=new WeakMap,Zf=new WeakMap,Wh=new WeakMap,ud=new WeakMap,Ra=new WeakMap,Vx=new WeakMap,H0=new WeakSet;class y8e extends On{constructor(){super(...arguments),v8e(this,H0),Jm(this,ra,new g8e(this.hot)),Jm(this,Zf,new p8e(this.hot)),Jm(this,Wh,[]),Jm(this,ud,void 0),Jm(this,Ra,{}),Jm(this,Vx,void 0)}static get PLUGIN_KEY(){return jI}static get PLUGIN_PRIORITY(){return w8e}isEnabled(){return!!this.hot.getSettings()[jI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xf(H0,e,C8e).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xf(H0,e,b8e).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Xf(H0,this,E8e).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Xf(H0,e,T8e).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),at(this.hot.rootElement,QW),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){_r(this.hot.rootElement,QW),this.unregisterEvents(),Dr(ra,this).destroy(),Dr(Zf,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const i=Dr(Vx,this),s=this.isMovePossible(e,r),n=this.hot.runHooks("beforeRowMove",e,r,i,s);if(ug(Vx,this,void 0),n===!1)return;s&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=s&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,i,s,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const i=this.countFinalIndex(e,r);return ug(Vx,this,r),this.moveRows(e,i)}isMovePossible(e,r){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),s=e.length+r>i,n=r<0,o=e.some(h=>h<0),l=e.some(h=>h>=i);return!(s||n||o||l)}isRowOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}countFinalIndex(e,r){const i=ha(e,(s,n)=>(n<r&&(s+=1),s),0);return r-i}getRowsHeight(e,r){const i=this.hot.rowIndexMapper;let s=0;for(let n=e;n<=r;n++){const o=i.getRenderableFromVisualIndex(n);o!==null&&(s+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.view.getDefaultRowHeight())}return s}moveBySettingsOrLoad(){const e=this.hot.getSettings()[jI];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:i,to:s}=e,n=Math.min(i.row,s.row),o=Math.max(i.row,s.row);return pr(n,o,l=>{r.push(l)}),r}refreshPositions(){const e=Dr(Ra,this).coords,r=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),s=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&i<s&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const n=this.hot.view._wt.wtTable,o=Dr(Ra,this).TD,l=this.hot.rootElement,h=zs(l),d=c1(l),g=n.holder.scrollTop,y=this.hot.rootWindow!==d?d.scrollTop:0,C=h.top-y,x=Dr(Ra,this).eventPageY-C+g,_=n.hider.offsetHeight,E=n.TBODY.offsetTop,R=Dr(ra,this).getOffset().top,I=Dr(ra,this).getSize().height,F=o.offsetHeight/2,H=o.offsetHeight;let z=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const q=x>=z+F;this.isFixedRowTop(e.row)&&(z+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?Dr(Ra,this).row=r>0?r-1:r:q?(Dr(Ra,this).row=e.row+1,z+=e.row===0?H-1:H):Dr(Ra,this).row=e.row;let re=x,Y=z;x+I+R>=_?re=_-I-R:x+R<E&&(re=E+Math.abs(R)),z>=_-1&&(Y=_-1),Dr(ra,this).setPosition(re),Dr(Zf,this).setPosition(Y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Xf(H0,this,S8e).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Xf(H0,this,x8e).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Dr(ra,this).build(),Dr(Zf,this).build()}destroy(){Dr(ra,this).destroy(),Dr(Zf,this).destroy(),super.destroy()}}function C8e(t,e,r,i){const{wtTable:s,wtViewport:n}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!o||Dr(ud,this)||t.button!==0){ug(ud,this,!1),Dr(Wh,this).length=0,_r(this.hot.rootElement,[NF,ST]);return}const h=Dr(Zf,this).isBuilt()&&!Dr(Zf,this).isAppended(),d=Dr(ra,this).isBuilt()&&!Dr(ra,this).isAppended();h&&d&&(Dr(Zf,this).appendTo(s.hider),Dr(ra,this).appendTo(s.hider));const{from:g,to:y}=l,C=Math.min(g.row,y.row),x=Math.max(g.row,y.row);if(e.col<0&&e.row>=C&&e.row<=x){i.row=!0,ug(ud,this,!0),Dr(Ra,this).eventPageY=t.pageY,Dr(Ra,this).coords=e,Dr(Ra,this).TD=r,ug(Wh,this,this.prepareRowsToMoving());const _=s.holder.scrollLeft+n.getRowHeaderWidth(),E=this.getRowsHeight(C,e.row-1)+t.offsetY;Dr(ra,this).setPosition(null,_),Dr(ra,this).setSize(s.hider.offsetWidth-_,this.getRowsHeight(C,x)),Dr(ra,this).setOffset(-E,null),at(this.hot.rootElement,NF),this.refreshPositions()}else _r(this.hot.rootElement,DF),ug(ud,this,!1),Dr(Wh,this).length=0}function S8e(t){Dr(ud,this)&&(Dr(Ra,this).eventPageY=t.pageY,this.refreshPositions())}function b8e(t,e,r,i){!this.hot.getSelectedRangeLast()||!Dr(ud,this)||(Dr(Wh,this).indexOf(e.row)>-1?_r(this.hot.rootElement,ST):at(this.hot.rootElement,ST),i.row=!0,i.column=!0,i.cell=!0,Dr(Ra,this).coords=e,Dr(Ra,this).TD=r)}function x8e(){const t=Dr(Ra,this).row,e=Dr(Wh,this).length;if(ug(ud,this,!1),_r(this.hot.rootElement,[NF,ST,DF]),this.hot.selection.isSelectedByRowHeader()&&at(this.hot.rootElement,DF),e<1||t===void 0)return;const r=Dr(Wh,this)[0],i=this.hot.toPhysicalRow(r),s=this.dragRows(Dr(Wh,this),t);if(Dr(Wh,this).length=0,s===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const n=this.hot.toVisualRow(i),o=n+e-1;this.hot.selectRows(n,o)}}function E8e(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,i=e+r;Dr(ra,this).setPosition(null,i),Dr(ra,this).setSize(t.hider.offsetWidth-i)}function T8e(){this.moveBySettingsOrLoad()}function _8e(t,e){CZ(t,e),e.add(t)}function Ao(t,e,r){CZ(t,e),e.set(t,r)}function CZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Di(t,e,r){return t.set(Ph(t,e),r),r}function Ut(t,e){return t.get(Ph(t,e))}function Ph(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bT="manualRowResize",R8e=30,ZW="manualRowHeights";var Au=new WeakMap,Wx=new WeakMap,Xa=new WeakMap,wy=new WeakMap,ed=new WeakMap,F6=new WeakMap,Xp=new WeakMap,jx=new WeakMap,Xo=new WeakMap,bu=new WeakMap,Ng=new WeakMap,xT=new WeakMap,yy=new WeakMap,Cy=new WeakMap,Ec=new WeakMap,Sy=new WeakMap,Lf=new WeakSet;class A8e extends On{static get PLUGIN_KEY(){return bT}static get PLUGIN_PRIORITY(){return R8e}constructor(e){super(e),_8e(this,Lf),Ao(this,Au,null),Ao(this,Wx,null),Ao(this,Xa,[]),Ao(this,wy,null),Ao(this,ed,null),Ao(this,F6,null),Ao(this,Xp,null),Ao(this,jx,null),Ao(this,Xo,this.hot.rootDocument.createElement("DIV")),Ao(this,bu,this.hot.rootDocument.createElement("DIV")),Ao(this,Ng,!1),Ao(this,xT,!1),Ao(this,yy,0),Ao(this,Cy,null),Ao(this,Ec,void 0),Ao(this,Sy,void 0),at(Ut(Xo,this),"manualRowResizer"),at(Ut(bu,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[bT]}enablePlugin(){this.enabled||(Di(Ec,this,new $d),Ut(Ec,this).addLocalHook("init",()=>Ph(Lf,this,N8e).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ut(Ec,this)),this.addHook("modifyRowHeight",(e,r)=>Ph(Lf,this,k8e).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Di(Sy,this,Ut(Ec,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",ZW,Ut(Ec,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",ZW,e),e.value}setManualSize(e,r){const i=this.hot.toPhysicalRow(e),s=Math.max(r,this.hot.view.getDefaultRowHeight());return Ut(Ec,this).setValueAtIndex(i,s),s}getLastDesiredRowHeight(){return Ut(wy,this)}setupHandlePosition(e){Di(Au,this,e);const{view:r}=this.hot,{_wt:i}=r,s=i.wtTable.getCoords(Ut(Au,this)),n=s.row;if(n<0)return;const o=os(Ut(Au,this)),l=Ut(Au,this).getBoundingClientRect(),h=n<i.getSetting("fixedRowsTop"),d=n>=r.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let g;h?g=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ut(Au,this),s.row,s.col):d&&(g=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Ut(Au,this),s.row,s.col)),g||(g=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Ut(Au,this),s.row,s.col)),Di(Wx,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(n)),Di(Xa,this,[]);const y=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&y){const C=this.hot.getSelectedRange();xe(C,x=>{const _=x.getTopStartCorner().row,E=x.getBottomStartCorner().row;pr(_,E,R=>{Ut(Xa,this).includes(R)||Ut(Xa,this).push(R)})})}Ut(Xa,this).includes(Ut(Wx,this))||Di(Xa,this,[Ut(Wx,this)]),Di(jx,this,g.top-6),Di(Xp,this,parseInt(l.height,10)),Ut(Xo,this).style.top=`${Ut(jx,this)+Ut(Xp,this)}px`,Ut(Xo,this).style[this.inlineDir]=`${g.start}px`,Ut(Xo,this).style.width=`${o}px`,this.hot.rootElement.appendChild(Ut(Xo,this))}refreshHandlePosition(){Ut(Xo,this).style.top=`${Ut(jx,this)+Ut(wy,this)}px`}setupGuidePosition(){const e=parseInt(os(Ut(Xo,this)),10),r=parseInt(Ut(Xo,this).style[this.inlineDir],10)+e,i=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);at(Ut(Xo,this),"active"),at(Ut(bu,this),"active"),Ut(bu,this).style.top=Ut(Xo,this).style.top,Ut(bu,this).style[this.inlineDir]=`${r}px`,Ut(bu,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Ut(bu,this))}refreshGuidePosition(){Ut(bu,this).style.top=Ut(Xo,this).style.top}hideHandleAndGuide(){_r(Ut(Xo,this),"active"),_r(Ut(bu,this),"active")}checkIfRowHeader(e){const r=Rg(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:s,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,s.clone.wtTable.TBODY,n.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&Ut(ed,this)<r?r:Ut(ed,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(i,s)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);n!==void 0&&Di(ed,this,n),this.setManualSize(i,Ut(ed,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),s&&e()};Ut(yy,this)>=2&&(Ut(Xa,this).length>1?(xe(Ut(Xa,this),s=>{r(s)}),e()):xe(Ut(Xa,this),s=>{r(s,!0)})),Di(yy,this,0),Di(Cy,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Ph(Lf,this,O8e).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Ph(Lf,this,I8e).call(this,i)),this.eventManager.addEventListener(r,"mousemove",i=>Ph(Lf,this,P8e).call(this,i)),this.eventManager.addEventListener(r,"mouseup",()=>Ph(Lf,this,F8e).call(this)),this.eventManager.addEventListener(Ut(Xo,this),"contextmenu",()=>Ph(Lf,this,M8e).call(this))}destroy(){super.destroy()}}function O8e(t){if(!KX(t.target)&&Ut(xT,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Ut(Ng,this)||this.setupHandlePosition(e))}}function I8e(t){Rr(t.target,"manualRowResizer")&&(this.setupHandlePosition(Ut(Au,this)),this.setupGuidePosition(),Di(Ng,this,!0),Ut(Cy,this)===null&&(Di(Cy,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ut(Cy,this))),Di(yy,this,Ut(yy,this)+1),Di(F6,this,t.pageY),Di(ed,this,Ut(Xp,this)))}function P8e(t){Ut(Ng,this)&&(Di(wy,this,Ut(Xp,this)+(t.pageY-Ut(F6,this))),xe(Ut(Xa,this),e=>{Di(ed,this,this.setManualSize(e,Ut(wy,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function F8e(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};Ut(Ng,this)&&(this.hideHandleAndGuide(),Di(Ng,this,!1),Ut(ed,this)!==Ut(Xp,this)&&(Ut(Xa,this).length>1?(xe(Ut(Xa,this),i=>{e(i)}),t()):xe(Ut(Xa,this),i=>{e(i,!0)})),this.setupHandlePosition(Ut(Au,this)))}function M8e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ut(Xo,this)),this.hot.rootElement.removeChild(Ut(bu,this)),Di(Ng,this,!1),Di(xT,this,!0),this.hot._registerImmediate(()=>{Di(xT,this,!1)})}function k8e(t,e){let r=t;if(this.enabled){const i=this.hot.toPhysicalRow(e),s=Ut(Ec,this).getValueAtIndex(i);this.hot.getSettings()[bT]&&s&&(r=s)}return r}function N8e(){const t=this.hot.getSettings()[bT],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,i)=>{Ut(Ec,this).setValueAtIndex(i,r)}):Array.isArray(t)?(t.forEach((r,i)=>{Ut(Ec,this).setValueAtIndex(i,r)}),Di(Sy,this,t)):t===!0&&Array.isArray(Ut(Sy,this))&&Ut(Sy,this).forEach((r,i)=>{Ut(Ec,this).setValueAtIndex(i,r)})},!0)}var D8e=$_;D8e("flatMap");var L8e=$o,ej=xs,H8e=Xu,$8e=mk,B8e=function(t,e){(!e||typeof t!="string")&&ej(t);var r=$8e(t);return H8e(ej(r!==void 0?L8e(r,t):t))},V8e=si,tj=$o,W8e=La,LF=xs,j8e=Xu,U8e=B8e,z8e=gk,rj=_1,G8e=QM,Y8e=z8e(function(){for(var t=this.iterator,e=this.mapper,r,i;;){if(i=this.inner)try{if(r=LF(tj(i.next,i.iterator)),!r.done)return r.value;this.inner=null}catch(s){rj(t,"throw",s)}if(r=LF(tj(this.next,t)),this.done=!!r.done)return;try{this.inner=U8e(e(r.value,this.counter++),!1)}catch(s){rj(t,"throw",s)}}});V8e({target:"Iterator",proto:!0,real:!0,forced:G8e},{flatMap:function(e){return LF(this),W8e(e),new Y8e(j8e(this),{mapper:e,inner:null})}});function K8e(t,e,r){X8e(t,e),e.set(t,r)}function X8e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $0(t,e,r){return(e=q8e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q8e(t){var e=J8e(t,"string");return typeof e=="symbol"?e:e+""}function J8e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nj(t,e){return t.get(SZ(t,e))}function Ux(t,e,r){return t.set(SZ(t,e),r),r}function SZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var B0=new WeakMap;class Ou{constructor(e,r,i,s,n,o){$0(this,"row",void 0),$0(this,"col",void 0),$0(this,"rowspan",void 0),$0(this,"colspan",void 0),$0(this,"removed",!1),$0(this,"cellCoordsFactory",void 0),$0(this,"cellRangeFactory",void 0),K8e(this,B0,null),this.row=e,this.col=r,this.rowspan=i,this.colspan=s,this.cellCoordsFactory=n,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:i,rowspan:s,colspan:n}=e;return Ln`The merged cell declared with {row: ${r}, col: ${i},\x20
      rowspan: ${s}, colspan: ${n}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:i,rowspan:s,colspan:n}=e;return r<0||i<0||s<0||n<0}static isSingleCell(e){let{rowspan:r,colspan:i}=e;return i===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:i}=e;return i===0||r===0}static isOutOfBounds(e,r,i){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const r=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Ux(B0,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const i=e[0]||e[1],s=r+Math.abs(e[0]||e[1])-1,n=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",l=Math.min(r,s),h=Math.max(r,s),d=this[o],g=this[o]+this[n]-1;if(d>=r&&(this[o]+=i),i>0)r<=g&&r>d&&(this[n]+=i);else if(i<0){if(l<=d&&h>=g)return this.removed=!0,Ux(B0,this,null),!1;if(d>=l&&d<=h){const y=h-d+1,C=Math.abs(i)-y;this[o]-=C+i,this[n]-=y}else if(d<=l&&g>=h)this[n]+=i;else if(d<=l&&g>=l&&g<h){const y=g-l+1;this[n]-=y}}return Ux(B0,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return nj(B0,this)||Ux(B0,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),nj(B0,this)}}function Q8e(t,e){Z8e(t,e),e.add(t)}function Z8e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zx(t,e,r){return(e=eHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eHe(t){var e=tHe(t,"string");return typeof e=="symbol"?e:e+""}function tHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function V0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hf=new WeakSet;class ET{constructor(e){Q8e(this,Hf),zx(this,"plugin",void 0),zx(this,"mergedCells",[]),zx(this,"mergedCellsMatrix",new Map),zx(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:i}=e;return Ln`The merged cell declared at [${r}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(r))!==null&&i!==void 0?i:!1}getByRange(e){let r=!1;return xe(this.mergedCells,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(s=>{const{row:n,col:o,colspan:l,rowspan:h}=s;for(let d=n;d<n+h;d++)for(let g=o;g<o+l;g++)r.add(`r${d},c${g}`)}),e.filter(s=>{const{row:n,col:o,colspan:l,rowspan:h}=s,d=new Set;let g=!1;for(let y=n;y<n+h;y++){for(let C=o;C<o+l;C++){const x=`r${y},c${C}`;if(r.has(x)){Nn(ET.IS_OVERLAPPING_WARNING(s)),g=!0;break}d.add(x)}if(g)break}return g||r.add(...d),!g})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:s}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),l=[];for(let h=i;h<=n;h++)for(let d=s;d<=o;d++){const g=this.get(h,d);g&&(r||!r&&g.row===h&&g.col===d)&&l.push(g)}return l}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,s=e.col,n=e.rowspan,o=e.colspan,l=new Ou(i,s,n,o,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,s),d=r?!1:this.isOverlapping(l);return!h&&!d?(this.hot&&l.normalize(this.hot),this.mergedCells.push(l),V0(Hf,this,ij).call(this,l),l):(Nn(ET.IS_OVERLAPPING_WARNING(l)),!1)}remove(e,r){const i=this.get(e,r),s=i?this.mergedCells.indexOf(i):-1;return i&&s!==-1?(this.mergedCells.splice(s,1),V0(Hf,this,rHe).call(this,i),i):!1}clear(){xe(this.mergedCells,e=>{let{row:r,col:i,rowspan:s,colspan:n}=e;pr(r,r+s,o=>{pr(i,i+n,l=>{const h=this.hot.getCell(o,l);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const i=this.get(e,r);if(!i)return!1;const{row:s,col:n,rowspan:o,colspan:l}=i,h=this.hot.view.getActiveOverlayName(),d=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),y=vn(d,s,s+o-1),C=vn(g,n,n+l-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(C,1)===r}getFirstRenderableCoords(e,r){const i=this.get(e,r);if(!i||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const s=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(s,n)}getStartMostColumnIndex(e,r){const i=V0(Hf,this,Gx).call(this,e,"col",-1);let s=r;for(let n=0;n<i.length;n++)if(i[n]<=r){s=i[n];break}return s}getEndMostColumnIndex(e,r){const i=V0(Hf,this,Gx).call(this,e,"col",1);let s=r;for(let n=0;n<i.length;n++)if(i[n]>=r){s=i[n];break}return s}getTopMostRowIndex(e,r){const i=V0(Hf,this,Gx).call(this,e,"row",-1);let s=r;for(let n=0;n<i.length;n++)if(i[n]<=r){s=i[n];break}return s}getBottomMostRowIndex(e,r){const i=V0(Hf,this,Gx).call(this,e,"row",1);let s=r;for(let n=0;n<i.length;n++)if(i[n]>=r){s=i[n];break}return s}shiftCollections(e,r,i){const s=[0,0];switch(e){case"right":s[0]+=i;break;case"left":s[0]-=i;break;case"down":s[1]+=i;break;case"up":s[1]-=i;break}const n=[];this.mergedCells.forEach(o=>{o.shift(s,r),o.removed&&n.push(o)}),n.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{V0(Hf,this,ij).call(this,o)})}}function Gx(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,s=r===1?t.getTopStartCorner():t.getBottomEndCorner(),n=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=s.row;r===1?o<=n.row:o>=n.row;o+=r)for(let l=s.col;r===1?l<=n.col:l>=n.col;l+=r){const h=e==="row"?o:l,d=this.get(o,l);let g=h;d&&(g=r===1?d[e]+d[`${e}span`]-1:d[e]),i.has(h)||i.set(h,new Set),i.get(h).add(g)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,l]=o;return l.size===1}).flatMap(o=>{let[,l]=o;return Array.from(l)})))}function ij(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function rHe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function UI(t,e,r){return(e=nHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nHe(t){var e=iHe(t,"string");return typeof e=="symbol"?e:e+""}function iHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sHe{constructor(e){UI(this,"plugin",void 0),UI(this,"mergedCellsCollection",void 0),UI(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let i=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?i="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?i="up":r[1]===e[1]&&r[2]===e[2]?i="right":i="left",i}snapDragArea(e,r,i,s){const n=r.slice(0),o=this.getAutofillSize(e,r,i),[l,h,d,g]=e,C=["up","down"].indexOf(i)>-1?d-l+1:g-h+1,x=Math.floor(o/C)*C,_=o-x,E=this.getFarthestCollection(e,r,i,s);if(E){if(i==="down"){const R=E.row+E.rowspan-l-_;n[2]+R>=this.plugin.hot.countRows()?n[2]-=_:n[2]+=_?R:0}else if(i==="right"){const R=E.col+E.colspan-h-_;n[3]+R>=this.plugin.hot.countCols()?n[3]-=_:n[3]+=_?R:0}else if(i==="up"){const R=d-_-E.row+1;n[0]+R<0?n[0]+=_:n[0]-=_?R:0}else if(i==="left"){const R=g-_-E.col+1;n[1]+R<0?n[1]+=_:n[1]-=_?R:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:s,fillSize:o,dragArea:n,cycleLength:C}),n}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Cs(this.currentFillData,e)}getAutofillSize(e,r,i){const[s,n,o,l]=e,[h,d,g,y]=r;switch(i){case"up":return s-h;case"down":return g-o;case"left":return n-d;case"right":return y-l;default:return null}}getDragArea(e,r,i){const[s,n,o,l]=e,[h,d,g,y]=r;switch(i){case"up":return[h,d,s-1,l];case"down":return[o+1,n,g,l];case"left":return[h,d,o,n-1];case"right":return[s,l+1,g,y];default:return null}}getFarthestCollection(e,r,i,s){const[n,o,l,h]=e,d=["up","down"].indexOf(i)>-1,g=d?l:h,y=d?n:o,C=this.getAutofillSize(e,r,i),x=d?l-n+1:h-o+1,_=Math.floor(C/x)*x,E=C-_;let R=null,I=null,F=null;switch(i){case"up":R="includesVertically",F=g-E+1;break;case"left":R="includesHorizontally",F=g-E+1;break;case"down":R="includesVertically",F=y+E-1;break;case"right":R="includesHorizontally",F=y+E-1;break}return xe(s,H=>{H[R](F)&&H.isFarther(I,i)&&(I=H)}),I}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,s=this.currentFillData.dragDirection,n=(d,g)=>{switch(s){case"up":return d.row-g>=r.from.row;case"down":return d.row+d.rowspan-1+g<=r.to.row;case"left":return d.col-g>=r.from.column;case"right":return d.col+d.colspan-1+g<=r.to.column;default:return null}};let o=0,l=null,h=1;do for(let d=0;d<i.length;d+=1){if(l=i[d],o=h*this.currentFillData.cycleLength,n(l,o))switch(s){case"up":this.plugin.mergedCellsCollection.add({row:l.row-o,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:l.row+o,rowspan:l.rowspan,col:l.col,colspan:l.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col-o,colspan:l.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:l.row,rowspan:l.rowspan,col:l.col+o,colspan:l.colspan});break}d===i.length-1&&(h+=1)}while(n(l,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},i={min:null,max:null};return xe(e,s=>{const n=s[0],o=this.plugin.hot.propToCol(s[1]);(r.min===null||n<r.min)&&(r.min=n),(r.max===null||n>r.max)&&(r.max=n),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:r.min,column:i.min},to:{row:r.max,column:i.max}}}dragAreaOverlapsCollections(e,r,i){const s=this.getDragArea(e,r,i),[n,o,l,h]=s,d=this.plugin.hot._createCellCoords(n,o),g=this.plugin.hot._createCellCoords(l,h),y=this.plugin.hot._createCellRange(d,d,g);return this.mergedCellsCollection.getWithinRange(y,!0).length>0}}function zI(t,e,r){return(e=oHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oHe(t){var e=aHe(t,"string");return typeof e=="symbol"?e:e+""}function aHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lHe{constructor(e){zI(this,"plugin",void 0),zI(this,"hot",void 0),zI(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,i,s){const n=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),l=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]);if(s===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const g=this.plugin.mergedCellsCollection.get(e,r);if(!g)return;const y=g.getLastRow(),C=g.getLastColumn();if(n<=g.row&&o<=g.col&&l>=y&&h>=C)return`${this.fullySelectedMergedCellClassName}-${s}`;if(this.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const i=[];if(!r||!e)return!1;for(let s=0;s<e.rowspan;s+=1)for(let n=0;n<e.colspan;n+=1)i.push(this.hot._createCellCoords(e.row+s,e.col+n));for(let s=0;s<i.length;s+=1){const n=[];for(let o=0;o<r.length;o+=1)n[o]=r[o].includes(i[s]);if(!n.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function cHe(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(jN)}return this.getTranslatedPhrase(WN)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedLast();return e?Ou.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function by(t,e,r){return(e=uHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uHe(t){var e=hHe(t,"string");return typeof e=="symbol"?e:e+""}function hHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sj{constructor(e){by(this,"data",void 0),by(this,"next",null),by(this,"prev",null),this.data=e}}class Yx{constructor(){by(this,"first",null),by(this,"last",null)}push(e){const r=new sj(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.last;this.last=r,r.prev=i,i.next=r}return r}unshift(e){const r=new sj(e);if(this.first===null)this.first=r,this.last=r;else{const i=this.first;this.first=r,r.next=i,i.prev=r}}inorder(e){let r=this.first;for(;r;){const i=e(r);if(r===this.last||i===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,i,s;for(;r;){if(r.data===e)return i=r.next,s=r.prev,i&&(i.prev=s),s&&(s.next=i),r===this.first&&(this.first=i),r===this.last&&(this.last=s),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,s){s&&(e(s,s.next),s.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,i;for(;e;)i=e.next,e.next=r,r.prev=e,r=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=r,this.last=i}}function fHe(t,e){bZ(t,e),e.add(t)}function W0(t,e,r){bZ(t,e),e.set(t,r)}function bZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fn(t,e){return t.get(TT(t,e))}function Wa(t,e,r){return t.set(TT(t,e),r),r}function TT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var gu=new WeakMap,mu=new WeakMap,pu=new WeakMap,vu=new WeakMap,HF=new WeakMap,Kx=new WeakMap,Xx=new WeakMap,GI=new WeakSet;class dHe{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:i,columnIndexMapper:s}=e;fHe(this,GI),W0(this,gu,new Yx),W0(this,mu,new Yx),W0(this,pu,null),W0(this,vu,null),W0(this,HF,null),W0(this,Kx,null),W0(this,Xx,null),Wa(HF,this,r),Wa(Kx,this,i),Wa(Xx,this,s)}getCurrentVerticalNode(){return Fn(vu,this).data}getFirstVerticalNode(){return Fn(mu,this).first.data}getNextVerticalNode(){return Fn(vu,this).next.data}getPrevVerticalNode(){return Fn(vu,this).prev.data}getCurrentHorizontalNode(){return Fn(pu,this).data}getFirstHorizontalNode(){return Fn(gu,this).first.data}getNextHorizontalNode(){return Fn(pu,this).next.data}getPrevHorizontalNode(){return Fn(pu,this).prev.data}setPrevNodeAsActive(){Wa(vu,this,Fn(vu,this).prev),Wa(pu,this,Fn(pu,this).prev)}setNextNodeAsActive(){Wa(vu,this,Fn(vu,this).next),Wa(pu,this,Fn(pu,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),i=e.getBottomEndCorner(),s=new WeakSet;Wa(gu,this,new Yx);for(let o=r.row;o<=i.row;o++)if(!Fn(Kx,this).isHidden(o))for(let l=r.col;l<=i.col;l++){if(Fn(Xx,this).isHidden(l))continue;const h=TT(GI,this,oj).call(this,e,Fn(gu,this),s,o,l);h&&Wa(pu,this,h)}Fn(gu,this).first&&(Fn(gu,this).first.prev=Fn(gu,this).last,Fn(gu,this).last.next=Fn(gu,this).first);const n=new WeakSet;Wa(mu,this,new Yx);for(let o=r.col;o<=i.col;o++)if(!Fn(Xx,this).isHidden(o))for(let l=r.row;l<=i.row;l++){if(Fn(Kx,this).isHidden(l))continue;const h=TT(GI,this,oj).call(this,e,Fn(mu,this),n,l,o);h&&Wa(vu,this,h)}Fn(mu,this).first&&(Fn(mu,this).first.prev=Fn(mu,this).last,Fn(mu,this).last.next=Fn(mu,this).first)}setActiveNode(e,r){return Fn(gu,this).inorder(i=>{const{rowStart:s,rowEnd:n,colStart:o,colEnd:l}=i.data;if(e>=s&&e<=n&&r>=o&&r<=l)return Wa(pu,this,i),!1}),Fn(mu,this).inorder(i=>{const{rowStart:s,rowEnd:n,colStart:o,colEnd:l}=i.data;if(e>=s&&e<=n&&r>=o&&r<=l)return Wa(vu,this,i),!1}),this}}function oj(t,e,r,i,s){const n=t.getTopStartCorner(),o=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),h=Fn(HF,this).call(this,i,s);if(h&&r.has(h))return null;const d={colStart:s,colEnd:s,rowStart:i,rowEnd:i};if(h){if(r.add(h),h.row<n.row||h.row+h.rowspan-1>o.row||h.col<n.col||h.col+h.colspan-1>o.col)return null;d.colStart=h.col,d.colEnd=h.col+h.colspan-1,d.rowStart=h.row,d.rowEnd=h.row+h.rowspan-1}const g=e.push(d);return i===l.row&&s===l.col||h&&l.row>=h.row&&l.row<=h.row+h.rowspan-1&&l.col>=h.col&&l.col<=h.col+h.colspan-1?g:null}function gHe(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:i}=e;function s(){}function n(o,l,h){const d=t.mergedCellsCollection.get(l,h);if(!Qr(d)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:g,col:y,colspan:C,rowspan:x}=d,[_,E]=t.translateMergedCellToRenderable(g,x,y,C),R=t.getSetting("virtualized"),I=r.getRenderableFromVisualIndex(l),F=i.getRenderableFromVisualIndex(h),H=_-I+1,z=E-F+1;let q=r.getNearestNotHiddenIndex(g,1),re=i.getNearestNotHiddenIndex(y,1);if(R){const me=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(me)||(q=Math.max(q,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(me)||(re=Math.max(re,e.getFirstRenderedVisibleColumn()))}const Y=Math.min(x,H),oe=Math.min(C,z);q===l&&re===h?(o.setAttribute("rowspan",Y),o.setAttribute("colspan",oe)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:s,after:n}}function mHe(t,e){xZ(t,e),e.add(t)}function qx(t,e,r){xZ(t,e),e.set(t,r)}function xZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YI(t,e,r){return(e=pHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pHe(t){var e=vHe(t,"string");return typeof e=="symbol"?e:e+""}function vHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vC(t,e,r){return t.set(Mn(t,e),r),r}function ii(t,e){return t.get(Mn(t,e))}function Mn(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}Xt.getSingleton().register("beforeMergeCells");Xt.getSingleton().register("afterMergeCells");Xt.getSingleton().register("beforeUnmergeCells");Xt.getSingleton().register("afterUnmergeCells");const $F="mergeCells",wHe=150,aj=$F;var $l=new WeakMap,Bl=new WeakMap,Lu=new WeakMap,lj=new WeakMap,Dn=new WeakSet;class yHe extends On{constructor(){super(...arguments),mHe(this,Dn),YI(this,"mergedCellsCollection",null),YI(this,"autofillCalculations",null),YI(this,"selectionCalculations",null),qx(this,$l,null),qx(this,Bl,{row:0,col:0}),qx(this,Lu,new dHe({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),qx(this,lj,gHe(this))}static get PLUGIN_KEY(){return $F}static get PLUGIN_PRIORITY(){return wHe}static get DEFAULT_SETTINGS(){return{[zJ]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[$F]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new ET(this),this.autofillCalculations=new sHe(this),this.selectionCalculations=new lHe(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,CHe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,bHe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,xHe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,EHe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,THe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,uj).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,uj).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,RHe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,AHe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,OHe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,cj).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,cj).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,SHe).call(e,...i)}),this.addHook("afterRenderer",function(){return ii(lj,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,_He).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,IHe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,PHe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,FHe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,MHe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,kHe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,NHe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,DHe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,LHe).call(e,...i)}),this.addHook("afterChange",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,HHe).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,$He).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,BHe).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,VHe).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,WHe).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Mn(Dn,e,jHe).call(e,...i)}),this.addHook("beforeUndoStackChange",(r,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!nq())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:s,rowspan:n}=i;for(let o=s+1;o<s+n;o++)r.push(o)}),r=[...new Set(r)],r.forEach(i=>{const s=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(n=>(n==null?void 0:n.name)==="master"?n:n.clone.wtTable).forEach(n=>{const o=n.getRow(s);o&&(o.style.background=UE(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{i.style.background=UE(i,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ou.containsNegativeValues(e)?(Nn(Ou.NEGATIVE_VALUES_WARNING(e)),!1):Ou.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Nn(Ou.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ou.isSingleCell(e)?(Nn(Ou.IS_SINGLE_CELL(e)),!1):Ou.containsZeroSpan(e)?(Nn(Ou.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(s=>this.validateSetting(s)),r=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];r.forEach(s=>{const{row:n,col:o,rowspan:l,colspan:h}=s,d=this.hot._createCellCoords(n,o),g=this.hot._createCellCoords(n+l-1,o+h-1),y=this.hot._createCellRange(d,d,g);this.mergeRange(y,!0,!0);for(let C=n;C<n+l;C++)for(let x=o;x<o+h;x++)(C!==n||x!==o)&&i.push([C,x,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,i.row,i.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=e.getTopStartCorner(),n=e.getBottomEndCorner(),o={row:s.row,col:s.col,rowspan:n.row-s.row+1,colspan:n.col-s.col+1},l=[];let h=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),pr(0,o.rowspan-1,g=>{pr(0,o.colspan-1,y=>{let C=null;l[g]||(l[g]=[]),g===0&&y===0?C=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+g,o.col+y,"hidden",!0),l[g][y]=C})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(i?h=[o.row,o.col,l]:this.hot.populateFromArray(o.row,o.col,l,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),h):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),xe(i,s=>{this.mergedCellsCollection.remove(s.row,s.col),pr(0,s.rowspan-1,n=>{pr(0,s.colspan-1,o=>{this.hot.removeCellMeta(s.row+n,s.col+o,"hidden"),this.hot.removeCellMeta(s.row+n,s.col+o,"copyable")})}),this.hot.removeCellMeta(s.row,s.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,i,s){const n=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,s);this.mergeRange(this.hot._createCellRange(n,n,o))}unmerge(e,r,i,s){const n=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(i,s);this.unmergeRange(this.hot._createCellRange(n,n,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeLast();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:aj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(aj)}modifyViewportRowStart(e,r){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.startRow);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(s,n);if(Qr(o)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(l<e.startRow){e.startRow=l,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const i=this.hot.rowIndexMapper,s=i.getVisualFromRenderableIndex(e.endRow);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(s,n);if(Qr(o)){const l=o.row+o.rowspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.startColumn);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(n,s);if(Qr(o)){const l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(l<e.startColumn){e.startColumn=l,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const i=this.hot.columnIndexMapper,s=i.getVisualFromRenderableIndex(e.endColumn);for(let n=0;n<r;n+=1){const o=this.mergedCellsCollection.get(n,s);if(Qr(o)){const l=o.col+o.colspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(l,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,i,s){const{rowIndexMapper:n,columnIndexMapper:o}=this.hot;let l,h;r===0?l=n.getNearestNotHiddenIndex(e,1):l=n.getNearestNotHiddenIndex(e+r-1,-1),s===0?h=o.getNearestNotHiddenIndex(i,1):h=o.getNearestNotHiddenIndex(i+s-1,-1);const d=e>=0?n.getRenderableFromVisualIndex(l):e,g=i>=0?o.getRenderableFromVisualIndex(h):i;return[d,g]}}function CHe(){this.generateFromSettings(),this.hot.render()}function SHe(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),i=r.getTopStartCorner(),s=r.getBottomEndCorner();for(let n=0;n<e.length;n+=1)if(i.row===e[n].row&&i.col===e[n].col&&s.row===e[n].row+e[n].rowspan-1&&s.col===e[n].col+e[n].colspan-1)return!1}return t}function bHe(t){ii(Bl,this).row=t.row,ii(Bl,this).col=t.col}function xHe(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot;ii($l,this)&&(s.getRenderableFromVisualIndex(ii($l,this).row)!==null&&(r.row=ii($l,this).row),i.getRenderableFromVisualIndex(ii($l,this).col)!==null&&(r.col=ii($l,this).col),vC($l,this,null));const n=this.mergedCellsCollection.get(r.row,r.col);if(!n)return;const o=n.col,l=n.col+n.colspan-1;if(t.col<0){const g=r.col>=o&&r.col<=l?o-1:l,y=i.getNearestNotHiddenIndex(g,-1);y===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(y,r.col)-1,1)}else if(t.col>0){const g=r.col>=o&&r.col<=l?l+1:o,y=i.getNearestNotHiddenIndex(g,1);y===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,y)-1,1)}const h=n.row,d=n.row+n.rowspan-1;if(t.row<0){const g=r.row>=h&&r.row<=d?h-1:d,y=s.getNearestNotHiddenIndex(g,-1);y===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(y,r.row)-1,1)}else if(t.row>0){const g=r.row>=h&&r.row<=d?d+1:h,y=s.getNearestNotHiddenIndex(g,1);y===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,y)-1,1)}}function EHe(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:i}=e,{columnIndexMapper:s,rowIndexMapper:n}=this.hot,o=(l,h)=>{r.expand(this.hot._createCellCoords(l,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let l=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,l),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(l=r.getTopStartCorner().col);const h=s.getNearestNotHiddenIndex(l,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(t.col>0){let l=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,l),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(l=r.getBottomEndCorner().col);const h=s.getNearestNotHiddenIndex(l,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(t.row<0){let l=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(l,i.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(l=r.getTopStartCorner().row);const h=n.getNearestNotHiddenIndex(l,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(t.row>0){let l=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(l,i.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(l=r.getBottomStartCorner().row);const h=n.getNearestNotHiddenIndex(l,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function THe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){vC($l,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);vC($l,this,e.clone()),r&&e.assign(r)}function cj(t,e,r,i){if(t<0||e<0)return;const s=this.mergedCellsCollection.get(t,e);if(!s)return;const{row:n,col:o,colspan:l,rowspan:h}=s,d=n,g=o,y=n+h-1,C=o+l-1;if(i==="render"&&this.getSetting("virtualized")){const x=this.hot.view.getActiveOverlayName(),_=["top","top_inline_start_corner"].includes(x)?0:this.hot.getFirstRenderedVisibleRow(),E=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(x)?0:this.hot.getFirstRenderedVisibleColumn();return[vn(_,d,y),vn(E,g,C),vn(this.hot.getLastRenderedVisibleRow(),d,y),vn(this.hot.getLastRenderedVisibleColumn(),g,C)]}return[d,g,y,C]}function _He(t){t.items.push({name:"---------"},cHe(this))}function uj(){vC($l,this,null)}function RHe(){if(ii($l,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),i=ii($l,this).clone().normalize();ii(Lu,this).setActiveNode(i.row,i.col),ii(Bl,this).row>0||ii(Bl,this).col>0?ii(Lu,this).setPrevNodeAsActive():(r==="E-W"&&ii(Bl,this).col<0||e==="S-N"&&ii(Bl,this).row<0)&&ii(Lu,this).setNextNodeAsActive()}function AHe(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:s}=this.hot;let n=null,o=null;if(ii(Bl,this).col<0){const{rowEnd:l,colEnd:h}=ii(Lu,this).getPrevHorizontalNode();o=i.getNearestNotHiddenIndex(h,-1),n=s.getNearestNotHiddenIndex(l,-1)}else if(ii(Bl,this).col>0){const{rowStart:l,colStart:h}=ii(Lu,this).getNextHorizontalNode();o=i.getNearestNotHiddenIndex(h,1),n=s.getNearestNotHiddenIndex(l,1)}else if(ii(Bl,this).row<0){const{rowEnd:l,colEnd:h}=ii(Lu,this).getPrevVerticalNode();o=i.getNearestNotHiddenIndex(h,-1),n=s.getNearestNotHiddenIndex(l,-1)}else if(ii(Bl,this).row>0){const{rowStart:l,colStart:h}=ii(Lu,this).getNextVerticalNode();o=i.getNearestNotHiddenIndex(h,1),n=s.getNearestNotHiddenIndex(l,1)}if(n!==null||o!==null){const l=this.hot._createCellCoords(n,o),h=this.mergedCellsCollection.get(l.row,l.col),d=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,h?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(h.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(h.col,1)}):r.highlight.assign(l),d.clear(),d.add(l).commit()}ii(Lu,this).setActiveNode(t,e),vC(Bl,this,{row:0,col:0})}function OHe(){this.hot.getSelectedRangeLast().isHeader()||ii(Lu,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function IHe(t,e,r){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?r.copyable=!1:(r.rowspan=i.rowspan,r.colspan=i.colspan))}function PHe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function FHe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function MHe(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const r=this.autofillCalculations.getDirection(e,t);let i=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,i,r))return i=e,i;const s=this.hot._createCellCoords(e[0],e[1]),n=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(s,s,n),l=this.mergedCellsCollection.getWithinRange(o);return l.length===0||(i=this.autofillCalculations.snapDragArea(e,i,r,l)),i}function kHe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function NHe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function DHe(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function LHe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function HHe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function $He(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(r);xe(i,s=>{r.getBottomEndCorner().row===s.getLastRow()&&r.getBottomEndCorner().col===s.getLastColumn()&&(t[2]=s.row,t[3]=s.col)})}}function BHe(t,e,r,i){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,i)}function VHe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function WHe(t,e,r,i){if(!(i instanceof MouseEvent))return;const s=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getByRange(s);if(!n)return;const o=this.hot._createCellCoords(n.row,n.col),l=this.hot._createCellCoords(n.row+n.rowspan-1,n.col+n.colspan-1);return this.hot.selection.getLayerLevel()===0&&s.isEqual(this.hot._createCellRange(o,o,l))}function jHe(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let i,s;if(r==="master")i=this.hot.getFirstRenderedVisibleColumn(),s=this.hot.getLastRenderedVisibleColumn();else{const C=this.hot.view.getOverlayByName(r);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getFirstRenderedColumn()),s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(C.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),l=this.hot._createCellCoords(e,s),h=this.hot._createCellRange(o,o,l),d=this.mergedCellsCollection.getWithinRange(h,!0),g=d.reduce((C,x)=>{let{rowspan:_}=x;return Math.max(C,_)},1);let y=0;return d.length>1&&d[0].rowspan<g&&(y=g-d[0].rowspan),d.forEach(C=>{var x;let{rowspan:_}=C,E=0;r==="top"||r==="top_inline_start_corner"?E=Math.min(g,this.hot.view.countNotHiddenFixedRowsTop()-e):E=_-y,t=Math.max((x=t)!==null&&x!==void 0?x:0,Mn(Dn,this,UHe).call(this,e,E))}),t}function UHe(t,e){const r=this.hot.view.getDefaultRowHeight(),i=this.hot.getPlugin("autoRowSize");let s=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var n;s+=(n=i==null?void 0:i.getRowHeight(o))!==null&&n!==void 0?n:r}return s}function zHe(t,e){return function(r,i){const[,...s]=r,[,...n]=i;return function o(l){const h=t[l],d=e[l],g=s[l],y=n[l],C=d.multiColumnSorting,_=(C.compareFunctionFactory?C.compareFunctionFactory:ZJ(d.type))(h,d,C)(g,y);if(_===Wu){const E=l+1;if(typeof e[E]<"u")return o(E)}return _}(0)}}function hj(){Nn(Ln`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const EZ="sort";function GHe(t,e,r){const i=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${EZ}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function YHe(t){const e=t.className.split(" "),r=new RegExp(`^${EZ}-[0-9]{1,2}$`);return e.filter(i=>r.test(i))}function KHe(t,e,r){return(e=XHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XHe(t){var e=qHe(t,"string");return typeof e=="symbol"?e:e+""}function qHe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const _T="multiColumnSorting",JHe=170,KI="columnSorting",fj=_T;QJ(_T,zHe);class QHe extends lQ{constructor(){super(...arguments),KHe(this,"pluginKey",_T)}static get PLUGIN_KEY(){return _T}static get PLUGIN_PRIORITY(){return JHe}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[KI]&&(hj(),this.hot.getPlugin(KI).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,aT)),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Bd,position:"before",group:fj})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fj)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];super.updateHeaderClasses(e,...i),_r(e,YHe(e)),this.enabled!==!1&&at(e,GHe(...i))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[KI]&&hj(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){w6(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,aT))):this.sort(this.getColumnNextConfig(r.col)))}}function dj(t,e,r){return(e=ZHe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZHe(t){var e=e7e(t,"string");return typeof e=="symbol"?e:e+""}function e7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const t7e="multipleSelectionHandles",r7e=160;class n7e extends On{constructor(){super(...arguments),dj(this,"dragged",[]),dj(this,"lastSetCell",null)}static get PLUGIN_KEY(){return t7e}static get PLUGIN_PRIORITY(){return r7e}isEnabled(){return od()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function i(s){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const n=e.dragged.indexOf(s);if(n===-1)return!1;n===0?e.dragged=e.dragged.slice(0,1):n===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",s=>{let n;if(Rr(s.target,"topSelectionHandle-HitArea"))return n=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},s.preventDefault(),!1;if(Rr(s.target,"bottomSelectionHandle-HitArea"))return n=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},s.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",s=>{if(Rr(s.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,s.preventDefault(),!1;if(Rr(s.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,s.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",s=>{const{rootDocument:n}=this.hot;let o,l,h,d,g,y;if(e.dragged.length===0)return;const C=n.elementFromPoint(s.touches[0].clientX,s.touches[0].clientY);!C||C===e.lastSetCell||((C.nodeName==="TD"||C.nodeName==="TH")&&(o=e.hot.getCoords(C),o.col===-1&&(o.col=0),l=e.hot.getSelectedRangeLast(),h=l.getWidth(),d=l.getHeight(),g=l.getDirection(),h===1&&d===1&&e.hot.selection.setRangeEnd(o),y=e.getCurrentRangeCoords(l,o,e.touchStartRange.direction,g,e.dragged[0]),y.start!==null&&e.hot.selection.setRangeStart(y.start),e.hot.selection.setRangeEnd(y.end),e.lastSetCell=C),s.preventDefault())})}getCurrentRangeCoords(e,r,i,s,n){const o=e.getTopStartCorner(),l=e.getBottomEndCorner(),h=e.getBottomStartCorner(),d=e.getTopEndCorner();let g={start:null,end:null};switch(i){case"NE-SW":switch(s){case"NE-SW":case"NW-SE":n==="top"?g={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(h.row,r.col)}:g={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":n==="bottom"&&(g={start:this.hot._createCellCoords(l.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(s){case"NE-SW":n==="top"?g={start:r,end:h}:g.end=r;break;case"NW-SE":n==="top"?g={start:r,end:l}:g.end=r;break;case"SE-NW":n==="top"?g={start:r,end:o}:g.end=r;break;case"SW-NE":n==="top"?g={start:r,end:d}:g.end=r;break}break;case"SW-NE":switch(s){case"NW-SE":n==="bottom"?g={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(h.row,r.col)}:g={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,l.col)};break;case"SW-NE":n==="top"?g={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,l.col)}:g={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":n==="bottom"?g={start:this.hot._createCellCoords(r.row,d.col),end:this.hot._createCellCoords(o.row,r.col)}:n==="top"&&(g={start:h,end:r});break}break;case"SE-NW":switch(s){case"NW-SE":case"NE-SW":case"SW-NE":n==="top"&&(g.end=r);break;case"SE-NW":n==="top"?g.end=r:g={start:r,end:o};break}break}return g}isDragged(){return this.dragged.length>0}}function BF(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:i=!1,crossHiddenColumns:s=[],isCollapsed:n=!1,isHidden:o=!1,isRoot:l=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:i,isCollapsed:n,crossHiddenColumns:s,isHidden:o,isRoot:l,isPlaceholder:h,headerClassNames:d}}function TZ(){return{label:"",isPlaceholder:!0}}function i7e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;xe(t,s=>{const n=[];let o=0;r.push(n),xe(s,l=>{const h=BF();if(Qr(l)){const{label:g,colspan:y,headerClassName:C}=l;h.label=as(g),typeof y=="number"&&y>1&&(h.colspan=y,h.origColspan=y),typeof C=="string"&&(h.headerClassNames=[...C.split(" ")])}else h.label=as(l);o+=h.origColspan;let d=!1;if(o>=e&&(h.colspan=h.origColspan-(o-e),h.origColspan=h.colspan,d=!0),n.push(h),h.colspan>1)for(let g=0;g<h.colspan-1;g++)n.push(TZ());return!d})});const i=Math.max(...on(r,s=>s.length));return xe(r,s=>{if(s.length<i){const n=on(new Array(i-s.length),()=>BF());s.splice(s.length,0,...n)}}),r}function XI(t,e,r){s7e(t,e),e.set(t,r)}function s7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cc(t,e){return t.get(_Z(t,e))}function xw(t,e,r){return t.set(_Z(t,e),r),r}function _Z(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gj=["label","collapsible"];var Ch=new WeakMap,j0=new WeakMap,qI=new WeakMap;class o7e{constructor(){XI(this,Ch,[]),XI(this,j0,0),XI(this,qI,1/0)}setColumnsLimit(e){xw(qI,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];xw(Ch,this,i7e(e,cc(qI,this))),xw(j0,this,cc(Ch,this).length)}getData(){return cc(Ch,this)}mergeWith(e){xe(e,r=>{let{row:i,col:s,...n}=r;const o=this.getHeaderSettings(i,s);o!==null&&Cs(o,n,gj)})}map(e){xe(cc(Ch,this),r=>{xe(r,i=>{const s=e({...i});Qr(s)&&Cs(i,s,gj)})})}getHeaderSettings(e,r){var i;if(e>=cc(j0,this)||e<0)return null;const s=cc(Ch,this)[e];return Array.isArray(s)===!1||r>=s.length?null:(i=s[r])!==null&&i!==void 0?i:null}getHeadersSettings(e,r){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const s=[];if(e>=cc(j0,this)||e<0)return s;const n=cc(Ch,this)[e];let o=0;for(let l=r;l<n.length;l++){const h=n[l];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=h.colspan,s.push(h),h.colspan>1&&(l+=h.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return s}getLayersCount(){return cc(j0,this)}getColumnsCount(){return cc(j0,this)>0?cc(Ch,this)[0].length:0}clear(){xw(Ch,this,[]),xw(j0,this,0)}}function JI(t,e,r){return(e=a7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a7e(t){var e=l7e(t,"string");return typeof e=="symbol"?e:e+""}function l7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const RZ="DF-pre-order";function AZ(t,e){let r=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(r===!1)return!1;r=AZ.call(this.childs[i],t,e)}return r}const c7e="DF-post-order";function OZ(t,e){for(let r=0;r<this.childs.length;r++)if(OZ.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const IZ="BF";function u7e(t,e){const r=[this];function i(){if(r.length===0)return;const s=r.shift();r.push(...s.childs),t.call(e,s)!==!1&&i()}i()}const h7e=IZ,mj=new Map([[RZ,AZ],[c7e,OZ],[IZ,u7e]]);class RT{constructor(e){JI(this,"data",{}),JI(this,"parent",null),JI(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new RT({...e.data});for(let i=0;i<e.childs.length;i++)r.addChild(this.cloneTree(e.childs[i]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:h7e;if(!mj.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);mj.get(r).call(this,e,this)}walkUp(e){const r=this,i=s=>{e.call(r,s)!==!1&&s.parent!==null&&i(s.parent)};i(this)}}function QI(t,e,r){f7e(t,e),e.set(t,r)}function f7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ko(t,e){return t.get(PZ(t,e))}function d7e(t,e,r){return t.set(PZ(t,e),r),r}function PZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Qm=new WeakMap,U0=new WeakMap,Zm=new WeakMap;class g7e{constructor(e){QI(this,Qm,new Map),QI(this,U0,new Map),QI(this,Zm,null),d7e(Zm,this,e)}getRoots(){return Array.from(Ko(Qm,this).values())}getRootByColumn(e){let r;return Ko(U0,this).has(e)&&(r=Ko(Qm,this).get(Ko(U0,this).get(e))),r}getNode(e,r){const i=this.getRootByColumn(r);if(!i)return;const s=r-Ko(U0,this).get(r);let n=0,o;return i.walkDown(l=>{const{data:{origColspan:h,headerLevel:d}}=l;if(e===d){if(s>=n&&s<=n+h-1)return o=l,o.data.isRoot=r===o.data.columnIndex,!1;n+=h}}),o}rebuildTreeIndex(){let e=0;Ko(U0,this).clear(),xe(Ko(Qm,this),r=>{let[,{data:{colspan:i}}]=r;for(let s=e;s<e+i;s++)Ko(U0,this).set(s,e);e+=i})}buildTree(){this.clear();const e=Ko(Zm,this).getColumnsCount();let r=0;for(;r<e;){const i=Ko(Zm,this).getHeaderSettings(0,r),s=new RT;Ko(Qm,this).set(r,s),this.buildLeaves(s,r,0,i.origColspan),r+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,i){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const n=Ko(Zm,this).getHeadersSettings(i,r,s);i+=1,xe(n,o=>{const l={...o,headerLevel:i-1,columnIndex:r};let h;i===1?(e.data=l,h=e):(h=new RT(l),e.addChild(h)),i<Ko(Zm,this).getLayersCount()&&this.buildLeaves(h,r,i,o.origColspan),r+=o.origColspan})}clear(){Ko(Qm,this).clear(),Ko(U0,this).clear()}}function FZ(t,e){t.walkDown(r=>{let{data:i,childs:s}=r;if(!i.isHidden&&(e(i.columnIndex),s.length===0))for(let n=1;n<i.colspan;n++)e(i.columnIndex+n)})}function AT(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function OT(t){return AT(t,"origColspan")===t.data.origColspan}function M6(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(OT(t))return M6(r[0]);e.isCollapsed=!1;const s=r.slice(1),n=new Set;let o=0;if(s.length>0)xe(s,l=>{l.replaceTreeWith(l.data.clonedTree),l.data.clonedTree=null;const h=l.data;o+=h.colspan,FZ(l,d=>{n.add(d)})});else{const{colspan:l,origColspan:h,columnIndex:d}=e;o=h-l;for(let g=1;g<h;g++)n.add(d+g)}return t.walkUp(l=>{const{data:h}=l;h.colspan+=o,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):OT(l)&&(h.isCollapsed=AT(l,"isCollapsed"))}),{rollbackModification:()=>k6(t),affectedColumns:Array.from(n),colspanCompensation:o}}function k6(t){var e;const{data:r,childs:i}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(OT(t))return k6(i[0]);r.isCollapsed=!0;const n=i.slice(1),o=new Set;if(n.length>0)xe(n,h=>{FZ(h,d=>{o.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:g}=d;g.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=r;for(let g=1;g<h;g++){const y=d+g;o.add(y)}}const l=r.colspan-((e=AT(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:d}=h;d.colspan-=l,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):OT(h)&&(d.isCollapsed=AT(h,"isCollapsed"))}),{rollbackModification:()=>M6(t),affectedColumns:Array.from(o),colspanCompensation:l}}function m7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ln`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let i=!1;t.walkUp(s=>{const{data:{collapsible:n}}=s;if(n)return i=!0,!1}),!i&&t.walkUp(s=>{const{data:n}=s;n.crossHiddenColumns.push(e),n.colspan>1?n.colspan-=1:n.isHidden=!0})}function p7e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ln`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let i=!1;t.walkUp(s=>{const{data:{collapsible:n}}=s;if(n)return i=!0,!1}),!i&&t.walkUp(s=>{const{data:n}=s;n.crossHiddenColumns.splice(n.crossHiddenColumns.indexOf(e),1),!n.isHidden&&n.colspan<n.origColspan&&(n.colspan+=1),n.isHidden=!1})}const pj=new Map([["collapse",k6],["expand",M6],["hide-column",m7e],["show-column",p7e]]);function v7e(t,e,r){if(!pj.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return pj.get(t)(e,r)}function Jx(t){const e=[];return xe(t,r=>{r.walkDown(i=>{const s=i.data,{origColspan:n,columnIndex:o,headerLevel:l,crossHiddenColumns:h}=s,d=y7e(e,l);let g=!1;for(let y=o;y<o+n;y++)if(h.includes(y)||g)d.push(TZ());else{const x=w7e(s);x.isRoot=!0,d.push(x),g=!0}})}),e}function w7e(t){const{crossHiddenColumns:e,...r}=BF(t);return r}function y7e(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function ZI(t,e,r){C7e(t,e),e.set(t,r)}function C7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ew(t,e,r){return t.set(MZ(t,e),r),r}function Mi(t,e){return t.get(MZ(t,e))}function MZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var wu=new WeakMap,ya=new WeakMap,z0=new WeakMap;class S7e{constructor(){ZI(this,wu,new o7e),ZI(this,ya,new g7e(Mi(wu,this))),ZI(this,z0,[[]])}setState(e){Mi(wu,this).setData(e);let r=!1;try{Mi(ya,this).buildTree()}catch{Mi(ya,this).clear(),Mi(wu,this).clear(),r=!0}return Ew(z0,this,Jx(Mi(ya,this).getRoots())),r}setColumnsLimit(e){Mi(wu,this).setColumnsLimit(e)}mergeStateWith(e){const r=on(e,i=>{let{row:s,...n}=i;return{row:s<0?this.rowCoordsToLevel(s):s,...n}});Mi(wu,this).mergeWith(r),Mi(ya,this).buildTree(),Ew(z0,this,Jx(Mi(ya,this).getRoots()))}mapState(e){Mi(wu,this).map(e),Mi(ya,this).buildTree(),Ew(z0,this,Jx(Mi(ya,this).getRoots()))}mapNodes(e){return ha(Mi(ya,this).getRoots(),(r,i)=>(i.walkDown(s=>{const n=e(s.data);n!==void 0&&r.push(n)}),r),[])}triggerNodeModification(e,r,i){r<0&&(r=this.rowCoordsToLevel(r));const s=Mi(ya,this).getNode(r,i);let n;return s&&(n=v7e(e,s,i),Ew(z0,this,Jx(Mi(ya,this).getRoots()))),n}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var i,s;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(s=Mi(z0,this)[e])===null||s===void 0?void 0:s[r])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,r){const i=this.getHeaderTreeNode(e,r);return i?{...i.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Mi(ya,this).getNode(e,r);return i||null}findTopMostEntireHeaderLevel(e){var r;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const s=i-e+1;let n=!1,o=null;for(let l=e;l<=i;l++){const h=Mi(ya,this).getRootByColumn(l);if(!h)break;n=!0,h.walkDown(d=>{const{columnIndex:g,headerLevel:y,origColspan:C,isHidden:x}=d.data;x||C<=s&&g>=e&&g+C-1<=i&&(o===null||y<o)&&(o=y)},RZ)}return n&&o===null?-1:this.levelToRowCoords((r=o)!==null&&r!==void 0?r:0)}findLeftMostColumnIndex(e,r){var i;const{isRoot:s}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0};if(s)return r;let n=r-1;for(;n>=0;){var o;const{isRoot:l}=(o=this.getHeaderSettings(e,n))!==null&&o!==void 0?o:{isRoot:!0};if(l)break;n-=1}return n}findRightMostColumnIndex(e,r){var i;const{isRoot:s,origColspan:n}=(i=this.getHeaderSettings(e,r))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(s)return r+n-1;let o=r+1;for(;o<this.getColumnsCount();){var l;const{isRoot:h}=(l=this.getHeaderSettings(e,o))!==null&&l!==void 0?l:{isRoot:!0};if(h)break;o+=1}return o-1}getLayersCount(){return Mi(wu,this).getLayersCount()}getColumnsCount(){return Mi(wu,this).getColumnsCount()}clear(){Ew(z0,this,[]),Mi(wu,this).clear(),Mi(ya,this).clear()}}function Tw(t,e,r){return(e=b7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b7e(t){var e=x7e(t,"string");return typeof e=="symbol"?e:e+""}function x7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class E7e{constructor(e,r){Tw(this,"hot",void 0),Tw(this,"nestedHeaderSettingsGetter",void 0),Tw(this,"layersCount",0),Tw(this,"container",void 0),Tw(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let i=0;i<r;i++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i),n=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(n,e[i].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:i}=this.hot,s=r.createDocumentFragment(),n=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,l=i.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const d=r.createElement("tr");for(let g=0;g<l;g++){let y=i.getVisualFromRenderableIndex(g);y===null&&(y=g);const C=r.createElement("th"),x=this.nestedHeaderSettingsGetter(h,y);if(x&&(!x.isPlaceholder||x.isHidden)){let _=x.label;o&&(_+='<button class="changeType"></button>'),M1(C,_),C.colSpan=x.colspan,d.appendChild(C)}}n.appendChild(d)}s.appendChild(n),e.appendChild(s)}clear(){this.widthsMap.clear(),this.container=null}}function T7e(t,e){kZ(t,e),e.add(t)}function vj(t,e,r){return(e=_7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _7e(t){var e=R7e(t,"string");return typeof e=="symbol"?e:e+""}function R7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _w(t,e,r){kZ(t,e),e.set(t,r)}function kZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jh(t,e,r){return t.set(ki(t,e),r),r}function dn(t,e){return t.get(ki(t,e))}function ki(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wj="nestedHeaders",A7e=280;var zn=new WeakMap,$f=new WeakMap,xy=new WeakMap,fR=new WeakMap,IT=new WeakMap,Gi=new WeakSet;class O7e extends On{constructor(){super(...arguments),T7e(this,Gi),_w(this,zn,new S7e),_w(this,$f,null),_w(this,xy,null),_w(this,fR,!1),_w(this,IT,null),vj(this,"ghostTable",new E7e(this.hot,(e,r)=>this.getHeaderSettings(e,r))),vj(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return wj}static get PLUGIN_PRIORITY(){return A7e}isEnabled(){return!!this.hot.getSettings()[wj]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&Nn(Ln`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>ki(Gi,this,z7e).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,G7e).call(e,...s)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,M7e).call(e,...s)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,k7e).call(e,...s)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,N7e).call(e,...s)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,D7e).call(e,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,L7e).call(e,...s)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,H7e).call(e,...s)}),this.addHook("afterSelection",()=>ki(Gi,this,Qx).call(this)),this.addHook("afterSelectionFocusSet",()=>ki(Gi,this,Qx).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,I7e).call(e,...s)}),this.addHook("afterGetColumnHeaderRenderers",i=>ki(Gi,this,B7e).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,W7e).call(e,...s)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,j7e).call(e,...s)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,P7e).call(e,...s)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,F7e).call(e,...s)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,$7e).call(e,...s)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,V7e).call(e,...s)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return ki(Gi,e,U7e).call(e,...s)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>ki(Gi,this,Qx).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>ki(Gi,this,Qx).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();dn(zn,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=dn(zn,this).setState(e)),this.detectedOverlappedHeaders&&Nn(Ln`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,i)=>{const s=r===!0?"hide-column":"show-column";dn(zn,this).triggerColumnModification(s,i)}),!dn($f,this)&&this.enabled&&jh($f,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(i=>{let{op:s,index:n,newValue:o}=i;if(s==="replace"){const l=o===!0?"hide-column":"show-column";dn(zn,this).triggerColumnModification(l,n)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),dn(zn,this).clear(),dn($f,this).unsubscribe(),jh($f,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return dn(zn,this)}getLayersCount(){return dn(zn,this).getLayersCount()}getHeaderSettings(e,r){return dn(zn,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,s=e.wtOverlays.topOverlay.clone.wtTable.THEAD,n=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const l=i.childNodes[o];if(!l)break;const h=s.childNodes[o],d=n?n.childNodes[o]:null;for(let g=0,y=l.childNodes.length;g<y;g++)l.childNodes[g].removeAttribute("colspan"),_r(l.childNodes[g],"hiddenHeader"),h&&h.childNodes[g]&&(h.childNodes[g].removeAttribute("colspan"),_r(h.childNodes[g],"hiddenHeader")),n&&d&&d.childNodes[g]&&(d.childNodes[g].removeAttribute("colspan"),_r(d.childNodes[g],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(s,n)=>{var o;const{columnIndexMapper:l,view:h}=this.hot;let d=l.getVisualFromRenderableIndex(s);d===null&&(d=s),n.removeAttribute("colspan"),_r(n,"hiddenHeader");const{colspan:g,isHidden:y,isPlaceholder:C,headerClassNames:x}=(o=dn(zn,this).getHeaderSettings(e,d))!==null&&o!==void 0?o:{label:""};if(C||y)at(n,"hiddenHeader");else if(g>1){var _,E;const{wtOverlays:R}=h._wt,I=(_=R.topInlineStartCornerOverlay)===null||_===void 0?void 0:_.clone.wtTable.THEAD.contains(n),F=(E=R.inlineStartOverlay)===null||E===void 0?void 0:E.clone.wtTable.THEAD.contains(n),H=I||F?Math.min(g,i-s):g;H>1&&n.setAttribute("colspan",H)}if(this.hot.view.appendColHeader(d,n,function(){return r.getColumnHeaderValue(...arguments)},e),!C&&!y){const R=n.querySelector("div.relative");R&&x&&x.length>0&&(_r(R,this.hot.getColumnMeta(d).headerClassName),at(R,x))}}}getColumnHeaderValue(e,r){var i;const{isHidden:s,isPlaceholder:n}=(i=dn(zn,this).getHeaderSettings(r,e))!==null&&i!==void 0?i:{};return n||s?"":this.hot.getColHeader(e,r)}destroy(){jh(zn,this,null),dn($f,this)!==null&&(dn($f,this).unsubscribe(),jh($f,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return dn(zn,this).getHeaderTreeNodeData(e.row,e.col)}}function Qx(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const s=dn(zn,this).findLeftMostColumnIndex(r.row,r.col),n=this.hot.selection.highlight.getFocus();n.visualCellRange.highlight.col=s,n.visualCellRange.from.col=s,n.visualCellRange.to.col=s,n.commit()}}function I7e(t,e){var r;const i=this.hot.getSelectedRangeLast();if(!i)return t;const{highlight:s}=i,{navigableHeaders:n}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),l=n?s.row:(r=dn(IT,this))===null||r===void 0?void 0:r.row,h=o?t:s.col,d=l<0&&h>=0;if(jh(IT,this,null),!d)return t;const g=this.hot.getFirstFullyVisibleColumn(),y=this.hot.getLastFullyVisibleColumn(),C=y-g+1,x=dn(zn,this).findLeftMostColumnIndex(l,h),_=dn(zn,this).findRightMostColumnIndex(l,h),E=_-x+1;if(x<g&&_>y)return x;if(o){let R=null;return x>=g&&_>y?E>C?(e.value="start",R=x):(e.value="end",R=_):x<g&&_<=y&&(E>C?(e.value="end",R=_):(e.value="start",R=x)),R}return x<=g?x:_}function P7e(t,e,r){const i=dn(zn,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:s,selectionType:n,selectionWidth:o}=r,{isRoot:l,colspan:h}=dn(zn,this).getHeaderSettings(e,t);if(n===lN){if(!l)return i.columnIndex}else if(n===Pq&&(h>o-s||!l))return null;return t}function F7e(t,e,r){let{columnHeadersCount:i}=r;if(i!==0)for(let n=0;n<e.length;n++){const{startRow:o,startCol:l,endRow:h,endCol:d}=e[n],g=h-o+1,y=l-d+1;if(o>=0||y===1)break;for(let C=l;C<=d;C++)for(let x=o;x<=h;x++){var s;const _=g+x,E=C-l;if(E===0)continue;((s=dn(zn,this).getHeaderTreeNodeData(x,C))===null||s===void 0?void 0:s.isRoot)===!1&&(t[_][E]="")}}}function M7e(t,e,r,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function k7e(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;jh(xy,this,e.clone()),jh(fR,this,!0);const{selection:i}=this.hot,s=i.isSelected()?i.getSelectedRange().current():null,n=[],{columnIndex:o,origColspan:l}=r,h=!i.inInSelection(e);t.shiftKey&&s?e.col<s.from.col?n.push(s.getTopEndCorner().col,o,e.row):e.col>s.from.col?n.push(s.getTopStartCorner().col,o+l-1,e.row):n.push(o,o+l-1,e.row):(Xk(t)||Og(t)&&h||lbe(t))&&n.push(o,o+l-1,e.row),i.selectColumns(...n)}function N7e(t,e,r,i){if(!this.hot.view.isMouseDown()||i.column)return;const s=this._getHeaderTreeNodeDataByCoords(e);if(!s)return;const{columnIndex:n,origColspan:o}=s,l=this.hot.getSelectedRangeLast(),h=l.getTopStartCorner(),d=l.getBottomEndCorner(),{from:g}=l;i.column=!0,i.cell=!0;const y=[],C=vn(e.row,-1/0,-1);e.col<g.col?y.push(d.col,n,C):e.col>g.col?y.push(h.col,n+o-1,C):y.push(n,n+o-1,C),this.hot.selection.selectColumns(...y)}function D7e(){jh(fR,this,!1)}function L7e(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!dn(fR,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:s,origColspan:n}=dn(zn,this).getHeaderTreeNodeData(dn(xy,this).row,dn(xy,this).col);if(e.setHighlight(dn(xy,this)),n>e.getWidth()||s<r||s+n-1>i){const o=dn(zn,this).findTopMostEntireHeaderLevel(vn(r,s,s+n-1),vn(i,s,s+n-1));e.highlight.row=o,e.highlight.col=e.from.col}}function H7e(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const s=dn(zn,this).findLeftMostColumnIndex(r.row,r.col),n=dn(zn,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=s&&e.col<=n?s-1:n,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);l===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,e.col)-1,1)}else if(t.col>0){const o=e.col>=s&&e.col<=n?n+1:s,l=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);l===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,l)-1,1)}}function $7e(t,e,r){const i=t.row,s=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),n=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});jh(IT,this,r.clone()),e.col<t.col?(s&&(t.col=s.columnIndex+s.origColspan-1),n&&(e.col=n.columnIndex)):e.col>=t.col&&(s&&(t.col=s.columnIndex),n&&(e.col=n.columnIndex+n.origColspan-1))}function B7e(t){t.length=0;for(let e=0;e<dn(zn,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function V7e(t){const e=dn(zn,this).getLayersCount();let r=t.startColumn,i=!!e;for(let s=0;s<e;s++){const n=dn(zn,this).findLeftMostColumnIndex(s,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(n);if(n>=0&&(i=!1),na(o)&&o<t.startColumn){r=o;break}}t.startColumn=i?dn(zn,this).getHeaderTreeNodeData(0,r).columnIndex:r}function W7e(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function j7e(t,e,r){var i;const{label:s}=(i=dn(zn,this).getHeaderTreeNodeData(r,e))!==null&&i!==void 0?i:{label:""};return s}function U7e(t,e){if(t<0)return this.hot.getCell(t,dn(zn,this).findLeftMostColumnIndex(t,e),!0)}function z7e(){this.updatePlugin()}function G7e(t,e){e||this.updatePlugin()}function Rw(t,e,r){return(e=Y7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Y7e(t){var e=K7e(t,"string");return typeof e=="symbol"?e:e+""}function K7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X7e{constructor(e,r){Rw(this,"hot",void 0),Rw(this,"data",null),Rw(this,"plugin",void 0),Rw(this,"parentReference",new WeakMap),Rw(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pr(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,i){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&xe(e.__children,s=>{this.cacheNode(s,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,i,s){let n=!1,o=r;if(isNaN(o)&&o.end)return o;let l=e;return l||(l={__children:this.data},n=!0,o-=1),i!=null&&o===i?{result:l,end:!0}:s!=null&&l===s?{result:o,end:!0}:(o+=1,l.__children&&xe(l.__children,h=>{if(this.parentReference.set(h,n?null:l),o=this.readTreeNodes(h,o,i,s),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Zr(this.data[0],(r,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(r):i.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(xe(i.__children,s=>{r+=1,s.__children&&(r+=this.countChildren(s))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var i;return((i=e.__children)===null||i===void 0?void 0:i[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((r=i.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let i=r;this.hot.runHooks("beforeAddChild",e,i);let s=null;e&&(s=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",s+this.countChildren(e)+1,1);let n=e;e||(n=this.mockParent()),n.__children||(n.__children=[]),i||(i=this.mockNode()),n.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,r,i){let s=i,n;if(s||(s=this.mockNode()),this.hot.runHooks("beforeAddChild",e,s,r),e){const l=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",l,1),e.__children.splice(r,null,s),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(l,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",l,1),n=l}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[r]);s=this.getDataObject(n),this.hot.runHooks("afterAddChild",e,s,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),s=this.getRowParent(i),n=this.getRowIndexWithinParent(i);switch(r){case"below":this.addChildAtIndex(s,n+1,null);break;case"above":this.addChildAtIndex(s,n,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const s=[];Array.isArray(e)?(pr(e[0],e[2],C=>{const x=this.translateTrimmedRow(C);s.push(this.getDataObject(x))}),pr(0,s.length-2,C=>{this.detachFromParent(s[C],!1)}),i=s[s.length-1]):i=e;const n=this.getRowIndex(i),o=this.countChildren(i),l=this.getRowIndexWithinParent(i),h=this.getRowParent(i),d=this.getRowParent(h),g=this.getRowIndex(d);let y=null;if(this.hot.runHooks("beforeDetachChild",h,i),l!=null){const C=Array.from(new Array(n+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",n,o+1,C,this.plugin.pluginName),h.__children.splice(l,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",n,o+1,C,this.plugin.pluginName),d){y=g+this.countChildren(d);const x=this.getChild(d,this.countChildren(d)-1),_=this.getRowIndex(x);this.hot.runHooks("beforeCreateRow",_+1,o+1,this.plugin.pluginName),d.__children.push(i)}else y=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",y-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",y-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,i,this.getRowIndex(i)),r&&this.hot.render()}filterData(e,r,i){const s=[];xe(i,n=>{s.push(this.getDataObject(n))}),xe(s,n=>{const o=this.getRowIndexWithinParent(n),l=this.getRowParent(n);l===null?this.data.splice(o,1):l.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,i){const s=this.getDataObject(e-1);let n=null,o=e;s&&s.__children&&s.__children.length===0?(n=s,o=0):e<this.countAllRows()&&(n=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),n?i?n.__children.splice(o,r,...i):n.__children.splice(o,r):i?this.data.splice(o,r,...i):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,i=null;do i=this.getRowParent(i),i!==null&&(r=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,i,s){const n=r===this.hot.countRows(),o=this.getRowParent(e),l=this.getRowIndexWithinParent(e),h=o.__children.slice(l,l+1),d=e>r;let g=n?this.getRowParent(r-1):this.getRowParent(r);g==null&&(g=this.getRowParent(r-1)),g==null&&(g=this.getDataObject(r-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(r),g.__children=[]);const y=n||i||s?g.__children.length:this.getRowIndexWithinParent(r),C=o===g;g.__children.splice(y,0,h[0]),o.__children.splice(l+(d&&C?1:0),1),this.syncRowWithRawSource(o),C||this.syncRowWithRawSource(g)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function yj(t,e,r){return(e=q7e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function q7e(t){var e=J7e(t,"string");return typeof e=="symbol"?e:e+""}function J7e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class N6{constructor(e,r){yj(this,"hot",void 0),yj(this,"plugin",void 0),this.hot=r,this.plugin=e}}class Fu extends N6{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const i=this.hot.toPhysicalRow(e),s=this.dataManager.getRowLevel(i),n=this.dataManager.getDataObject(i),o=r.getElementsByTagName("DIV")[0],l=o.querySelector("span.rowHeader"),h=o.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(xe(h,g=>{g&&o.removeChild(g)}),at(r,Fu.CSS_CLASSES.indicatorContainer),s){const{rootDocument:g}=this.hot,y=l.cloneNode(!0);o.innerHTML="",pr(0,s-1,()=>{const C=g.createElement("SPAN");at(C,Fu.CSS_CLASSES.emptyIndicator),o.appendChild(C)}),o.appendChild(y)}if(this.dataManager.hasChildren(n)){const g=this.hot.rootDocument.createElement("DIV");d&&Or(g,[Ld()]),at(r,Fu.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(at(g,`${Fu.CSS_CLASSES.button} ${Fu.CSS_CLASSES.expandButton}`),d&&Or(r,[jl(!1)])):(at(g,`${Fu.CSS_CLASSES.button} ${Fu.CSS_CLASSES.collapseButton}`),d&&Or(r,[jl(!0)])),o.appendChild(g)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount);const i=this.hot.view.getStylesHandler();let s=11;i.isClassicTheme()||(s=i.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,s+10*r+25),this.hot.render()}}class Q7e extends N6{constructor(e,r){var i;super(e,r),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,s)},shiftStash:function(s,n){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;n==null&&(n=1/0),xe(i.lastCollapsedRows,(l,h)=>{l>=s&&l<n&&(i.lastCollapsedRows[h]=l+o)})},applyStash:function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,s),i.lastCollapsedRows=void 0},trimStash:(s,n)=>{pr(s,s+n-1,o=>{const l=this.lastCollapsedRows.indexOf(o);l>-1&&this.lastCollapsedRows.splice(l,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let n=null,o=null,l=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(n)):(n=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(n)&&xe(n.__children,h=>{s.push(this.dataManager.getRowIndex(h))}),l=this.collapseRows(s,!0,!1),i&&this.trimRows(l),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),l}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];xe(e,n=>{s.push(...this.collapseChildren(n,!1,!1))}),i&&this.trimRows(s),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return xe(e,n=>{s.push(n),r&&this.collapseChildRows(n,s)}),i&&this.trimRows(s),s}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);xe(s.__children,n=>{const o=this.dataManager.getRowIndex(n);r.push(o),this.collapseChildRows(o,r)})}i&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const s=[];return xe(e,n=>{s.push(n),r&&this.expandChildRows(n,s)}),i&&this.untrimRows(s),s}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const s=this.dataManager.getDataObject(e);xe(s.__children,n=>{if(!this.isAnyParentCollapsed(n)){const o=this.dataManager.getRowIndex(n);r.push(o),this.expandChildRows(o,r)}})}i&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];let n=null,o=null,l=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(e)):(n=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(n)&&xe(n.__children,h=>{const d=this.dataManager.getRowIndex(h);s.push(d)}),l=this.expandRows(s,!0,!1),i&&this.untrimRows(l),r&&this.renderAndAdjust(),l}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const s=[];xe(e,n=>{s.push(...this.expandChildren(n,!1,!1))}),i&&this.untrimRows(s),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];xe(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];xe(e,i=>{this.dataManager.hasChildren(i)&&r.push(i)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{xe(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{xe(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&xe(r.__children,s=>{const n=this.dataManager.getRowIndex(s);if(!this.plugin.collapsedRowsMap.getValueAtIndex(n))return i=!1,!1}),i}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const i=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const i=this.translateTrimmedRow(r.row);Rr(e.target,Fu.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),jc(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function Z7e(t,e,r){e$e(t,e),e.set(t,r)}function e$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t$e(t,e,r){return(e=r$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r$e(t){var e=n$e(t,"string");return typeof e=="symbol"?e:e+""}function n$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function i$e(t,e){return t.get(s$e(t,e))}function s$e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cj=new WeakMap;class o$e extends N6{constructor(){super(...arguments),t$e(this,"dataManager",this.plugin.dataManager),Z7e(this,Cj,{row_above:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,r)=>{const i=r[r.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(lD)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),s=this.dataManager.getDataObject(i);this.dataManager.addChild(s)},disabled:()=>{const i=this.hot.getSelectedLast();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(cD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const i=this.hot.getSelectedLast(),s=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(s)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pr(0,e.items.length-1,i=>{if(i===0)return xe(r,(s,n)=>{e.items.splice(i+n,0,s)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pr(0,e.items.length-1,r=>{const i=i$e(Cj,this)[e.items[r].key];i!=null&&(e.items[r].callback=i)}),e}}function Zx(t,e,r){return(e=a$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a$e(t){var e=l$e(t,"string");return typeof e=="symbol"?e:e+""}function l$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c$e{constructor(e){Zx(this,"plugin",void 0),Zx(this,"hot",void 0),Zx(this,"dataManager",void 0),Zx(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,i,s){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:i,movePossible:s}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),l=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let h=!0;const d=e.map(_=>{if(!h)return!1;const E=this.dataManager.translateTrimmedRow(_);return h=this.shouldAllowMoving(E,l),E}),g=d.indexOf(l)===-1;if(!h||!g)return!1;const y=this.getBaseParent(d),C=this.getTargetParent(o,l),x=y===C;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(C),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,l,x),this.moveRows(d,l,C),this.dataManager.rewriteCache(),this.moveCellsMeta(d,l),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,i,s,s&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:i,dropIndex:s,movePossible:n}=e;let o=!1;return Ai(s)&&(Nn(Ln`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,i,s,n,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let i=this.dataManager.getRowParent(e?r-1:r);return i==null&&(i=this.dataManager.getRowParent(r-1)),i}shiftCollapsibleParentsLocations(e,r,i){i||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,i){const s=r===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(n=>{this.dataManager.moveRow(n,r,this.movedToCollapsed,s)})})}moveCellsMeta(e,r){const i=[],s=Math.max(...e)<r;e.forEach(n=>{i.push(this.hot.getCellMetaAtRow(n))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(s?i.length:0),0,...i)}selectCells(e,r){const i=e.length;let s=0,n=0,o=null,l=null;if(this.movedToCollapsed){let h=null;e[i-1]<r?h=this.dataManager.translateTrimmedRow(r-i):h=this.dataManager.translateTrimmedRow(r);const d=this.dataManager.getRowParent(h===null?this.hot.countSourceRows()-1:h-1),g=this.dataManager.getRowIndex(d);s=this.dataManager.untranslateTrimmedRow(g),n=s}else e[i-1]<r?(n=r-1,s=n-i+1):(s=r,n=s+i-1);o=this.hot.selection,l=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(s,0)),o.setRangeEnd(this.hot._createCellCoords(n,l),!0)}isRowOrderChanged(e,r){return e.some((i,s)=>i-s!==r)}}function u$e(t,e){NZ(t,e),e.add(t)}function Sj(t,e,r){NZ(t,e),e.set(t,r)}function NZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e3(t,e,r){return(e=h$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h$e(t){var e=f$e(t,"string");return typeof e=="symbol"?e:e+""}function f$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Z2(t,e){return t.get(Is(t,e))}function PT(t,e,r){return t.set(Is(t,e),r),r}function Is(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FT="nestedRows",d$e=300,bj=FT,g$e="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var dR=new WeakMap,ep=new WeakMap,Vs=new WeakSet;class m$e extends On{constructor(){super(...arguments),u$e(this,Vs),e3(this,"dataManager",null),e3(this,"headersUI",null),e3(this,"collapsedRowsMap",null),Sj(this,dR,!1),Sj(this,ep,!1)}static get PLUGIN_KEY(){return FT}static get PLUGIN_PRIORITY(){return d$e}isEnabled(){return!!this.hot.getSettings()[FT]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new eS),this.dataManager=new X7e(this,this.hot),this.collapsingUI=new Q7e(this,this.hot),this.headersUI=new Fu(this,this.hot),this.contextMenuUI=new o$e(this,this.hot),this.rowMoveController=new c$e(this),this.addHook("afterInit",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,O$e).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,I$e).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,w$e).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,y$e).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,C$e).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,v$e).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,x$e).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,b$e).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,E$e).call(e,...i)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,T$e).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,_$e).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,R$e).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,S$e).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,A$e).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Is(Vs,e,p$e).call(e,...i)}),this.addHook("beforeLoadData",r=>Is(Vs,this,xj).call(this,r)),this.addHook("beforeUpdateData",r=>Is(Vs,this,xj).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const i=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return i&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:bj,relativeToGroup:Bd,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bj)}disableCoreAPIModifiers(){PT(ep,this,!0)}enableCoreAPIModifiers(){PT(ep,this,!1)}onModifyRowData(e){if(!Z2(ep,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!Z2(ep,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,i){return Z2(ep,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,i),!1)}destroy(){super.destroy()}}function p$e(t,e,r,i){return this.rowMoveController.onBeforeRowMove(t,e,r,i)}function v$e(t,e,r){this.collapsingUI.toggleState(t,e,r)}function w$e(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),PT(dR,this,!0),this.dataManager.getData().slice()}function y$e(t){return this.contextMenuUI.appendOptions(t)}function C$e(t,e){this.headersUI.appendLevelIndicators(t,e)}function S$e(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function b$e(t,e,r,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{PT(dR,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function x$e(t,e,r){const i=Array.from(r.reduce((s,n)=>{if(this.dataManager.isParent(n)){const o=this.dataManager.getDataObject(n).__children;return s.add(n),Array.isArray(o)&&o.forEach(l=>s.add(this.dataManager.getRowIndex(l))),s}return s.add(n)},new Set));r.length=0,r.push(...i)}function E$e(){this.collapsingUI.collapsedRowsStash.stash()}function T$e(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _$e(){this.collapsingUI.collapsedRowsStash.stash()}function R$e(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function A$e(){this.dataManager.rewriteCache()}function O$e(){this.headersUI.updateRowHeaderWidth()}function I$e(t,e){Z2(dR,this)&&(e.skipRender=!0)}function xj(t){if(!w_e(t)){qk(g$e),this.hot.getSettings()[FT]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function t3(t,e,r){return(e=P$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function P$e(t){var e=F$e(t,"string");return typeof e=="symbol"?e:e+""}function F$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M$e{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;t3(this,"rootWindow",void 0),t3(this,"prefix",void 0),t3(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const i=typeof e>"u"?r:e,s=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return s===null?void 0:JSON.parse(s)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){xe(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function k$e(t,e,r){return(e=N$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function N$e(t){var e=D$e(t,"string");return typeof e=="symbol"?e:e+""}function D$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Xt.getSingleton().register("persistentStateSave");Xt.getSingleton().register("persistentStateLoad");Xt.getSingleton().register("persistentStateReset");const Ej="persistentState",L$e=0;class H$e extends On{constructor(){super(...arguments),k$e(this,"storage",void 0)}static get PLUGIN_KEY(){return Ej}static get PLUGIN_PRIORITY(){return L$e}isEnabled(){return!!this.hot.getSettings()[Ej]}enablePlugin(){this.enabled||(this.storage||(this.storage=new M$e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function $$e(t,e){B$e(t,e),e.add(t)}function B$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function r3(t,e,r){return(e=V$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V$e(t){var e=W$e(t,"string");return typeof e=="symbol"?e:e+""}function W$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tj(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const n3="search",j$e=190,U$e="htSearchResult",z$e=function(t,e,r,i,s){t.getCellMeta(e,r).isSearchResult=s},G$e=function(t,e,r){return Ai(t)||t===null||!t.toLocaleLowerCase||t.length===0||Ai(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var i3=new WeakSet;class Y$e extends On{constructor(){super(...arguments),$$e(this,i3),r3(this,"callback",z$e),r3(this,"queryMethod",G$e),r3(this,"searchResultClass",U$e)}static get PLUGIN_KEY(){return n3}static get PLUGIN_PRIORITY(){return j$e}isEnabled(){return this.hot.getSettings()[n3]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[n3];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Tj(i3,e,_j).call(e,...s)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var i=arguments.length,s=new Array(i),n=0;n<i;n++)s[n]=arguments[n];return Tj(i3,e,_j).call(e,...s)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const s=this.hot.countRows(),n=this.hot.countCols(),o=[],l=this.hot;return pr(0,s-1,h=>{pr(0,n-1,d=>{const g=this.hot.getDataAtCell(h,d),y=this.hot.getCellMeta(h,d),C=y.search.callback||r,_=(y.search.queryMethod||i)(e,g,y);if(_){const E={row:h,col:d,data:g};o.push(E)}C&&C(l,h,d,g,_)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Qr(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function _j(t,e,r,i,s,n){const o=n.className||[];let l=[];typeof o=="string"?l=o.split(" "):l.push(...o),this.isEnabled()&&n.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),n.className=l.join(" ")}function e2(t,e,r){return(e=K$e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function K$e(t){var e=X$e(t,"string");return typeof e=="symbol"?e:e+""}function X$e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DZ{constructor(e){e2(this,"viewportWidth",void 0),e2(this,"overwriteColumnWidthFn",void 0),e2(this,"baseWidths",new Map),e2(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:r}=e;this.viewportWidth=r,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,r){this.baseWidths.set(e,r)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class q$e extends DZ{calculate(){const e=Array.from(this.baseWidths).reduce((y,C)=>{let[,x]=C;return y+x},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,s=[],n=[];let o=this.viewportWidth,l=0;if(this.baseWidths.forEach((y,C)=>{const x=Math.round(y*i),_=this.overwriteColumnWidthFn(x,C);x===_&&x>=u1?(s.push([C,_]),l+=_):x!==_&&(s.push([C,_]),n.push(C),o-=_)}),o<=u1){this.stretchedWidths.clear();return}const h=o/l;let d=-1,g=0;s.forEach((y,C)=>{let[x,_]=y,E=_;n.includes(x)||(E=Math.round(_*h)),this.stretchedWidths.set(x,E),d=x,C<s.length-1&&(g+=E)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(d,Math.round(this.viewportWidth-g))}}function Rj(t,e,r){J$e(t,e),e.set(t,r)}function J$e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function s3(t,e){return t.get(LZ(t,e))}function t2(t,e,r){return t.set(LZ(t,e),r),r}function LZ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var r2=new WeakMap,Aw=new WeakMap;class Q$e extends DZ{constructor(){super(...arguments),Rj(this,r2,0),Rj(this,Aw,-1)}prepare(e){super.prepare(e),t2(r2,this,0),t2(Aw,this,-1)}setColumnBaseWidth(e,r){super.setColumnBaseWidth(e,r),t2(Aw,this,e),t2(r2,this,r)}calculate(){if(s3(Aw,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,s)=>{let[,n]=s;return i+n},0),r=Math.max(this.viewportWidth-e+s3(r2,this),0);this.stretchedWidths.set(s3(Aw,this),r)}}function Z$e(t,e){HZ(t,e),e.add(t)}function n2(t,e,r){HZ(t,e),e.set(t,r)}function HZ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e){return t.get(Mp(t,e))}function o3(t,e,r){return t.set(Mp(t,e),r),r}function Mp(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const e9e="stretchColumns";var Po=new WeakMap,tp=new WeakMap,a3=new WeakMap,i2=new WeakMap,Ow=new WeakSet;class t9e{constructor(e){Z$e(this,Ow),n2(this,Po,void 0),n2(this,tp,void 0),n2(this,a3,new Map([["all",new q$e(Mp(Ow,this,Aj).bind(this))],["last",new Q$e(Mp(Ow,this,Aj).bind(this))]])),n2(this,i2,"none"),o3(Po,this,e),o3(tp,this,Yi(Po,this).columnIndexMapper.createAndRegisterIndexMap(e9e,"physicalIndexToValue"))}useStrategy(e){o3(i2,this,Yi(a3,this).has(e)?e:"none")}refreshStretching(){if(Yi(i2,this)==="none"){Yi(tp,this).clear();return}Yi(Po,this).batchExecution(()=>{Yi(tp,this).clear();const e=Yi(a3,this).get(Yi(i2,this));let i=Yi(Po,this).view.getViewportWidth();Mp(Ow,this,r9e).call(this)&&(i-=co(Yi(Po,this).rootDocument)),e.prepare({viewportWidth:i});for(let s=0;s<Yi(Po,this).countCols();s++)Yi(Po,this).columnIndexMapper.isHidden(Yi(Po,this).toPhysicalColumn(s))||e.setColumnBaseWidth(s,Mp(Ow,this,n9e).call(this,s));e.calculate(),e.getWidths().forEach(s=>{let[n,o]=s;Yi(tp,this).setValueAtIndex(Yi(Po,this).toPhysicalColumn(n),o)})},!0)}getStretchedWidth(e){return Yi(tp,this).getValueAtIndex(Yi(Po,this).toPhysicalColumn(e))}}function r9e(){const{view:t}=Yi(Po,this);if(t.isVerticallyScrollableByWindow())return!1;const e=t.getViewportHeight(),r=Yi(Po,this).countRows(),i=t.getStylesHandler().getDefaultRowHeight();let s=0,n=!1;for(let l=0;l<r;l++){var o;if(s+=((o=Yi(Po,this).getRowHeight(l))!==null&&o!==void 0?o:i)+(l===0?1:0),s>e){n=!0;break}}return n}function n9e(t){var e;return(e=Yi(Po,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:u1}function Aj(t,e){return Yi(Po,this).runHooks("beforeStretchingColumnWidth",t,e)}function i9e(t,e){$Z(t,e),e.add(t)}function l3(t,e,r){$Z(t,e),e.set(t,r)}function $Z(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c3(t,e,r){return t.set(MT(t,e),r),r}function _h(t,e){return t.get(MT(t,e))}function MT(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const s9e="stretchColumns",o9e=155;var dp=new WeakMap,s2=new WeakMap,Iw=new WeakMap,u3=new WeakSet;class a9e extends On{constructor(){super(...arguments),i9e(this,u3),l3(this,dp,new t9e(this.hot)),l3(this,s2,null),l3(this,Iw,new ResizeObserver(e=>{requestAnimationFrame(()=>{var r;(r=this.hot)!==null&&r!==void 0&&r.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:s}=i;_h(s2,this)!==null&&_h(s2,this)!==s.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),c3(s2,this,s.width)})})}))}static get PLUGIN_KEY(){return s9e}static get PLUGIN_PRIORITY(){return o9e}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(_h(dp,this).useStrategy(this.hot.getSettings().stretchH),_h(Iw,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return MT(u3,e,c9e).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return MT(u3,e,l9e).call(e,...i)},10),super.enablePlugin())}updatePlugin(){_h(dp,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_h(Iw,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return _h(dp,this).getStretchedWidth(e)}destroy(){_h(Iw,this).disconnect(),c3(Iw,this,null),c3(dp,this,null),super.destroy()}}function l9e(t,e,r){if(r===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function c9e(t){t&&_h(dp,this).refreshStretching()}function u9e(t,e){h9e(t,e),e.add(t)}function h9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o2(t,e,r){return(e=f9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f9e(t){var e=d9e(t,"string");return typeof e=="symbol"?e:e+""}function d9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function h3(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const g9e="touchScroll",m9e=200;var a2=new WeakSet;class p9e extends On{constructor(){super(...arguments),u9e(this,a2),o2(this,"scrollbars",[]),o2(this,"clones",[]),o2(this,"lockedCollection",!1),o2(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return g9e}static get PLUGIN_PRIORITY(){return m9e}static get SETTING_KEYS(){return!0}isEnabled(){return rq()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>h3(a2,this,v9e).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>h3(a2,this,w9e).call(this)),this.addHook("afterMomentumScroll",()=>h3(a2,this,y9e).call(this))}}function v9e(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),i&&this.scrollbars.push(i),s&&s.clone&&this.scrollbars.push(s),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),s&&s.clone&&this.clones.push(s.clone.wtTable.holder.parentNode)}function w9e(){this.freezeOverlays=!0,xe(this.clones,t=>{at(t,"hide-tween")})}function y9e(){this.freezeOverlays=!1,xe(this.clones,t=>{_r(t,"hide-tween"),at(t,"show-tween")}),this.hot._registerTimeout(()=>{xe(this.clones,t=>{_r(t,"show-tween")})},400),xe(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function C9e(t,e){S9e(t,e),e.add(t)}function S9e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function b9e(t,e,r){return(e=x9e(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function x9e(t){var e=E9e(t,"string");return typeof e=="symbol"?e:e+""}function E9e(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function T9e(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const eE="trimRows",_9e=330;var Oj=new WeakSet;class R9e extends On{constructor(){super(...arguments),C9e(this,Oj),b9e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return eE}static get PLUGIN_PRIORITY(){return _9e}isEnabled(){return!!this.hot.getSettings()[eE]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new eS),this.trimmedRowsMap.addLocalHook("init",()=>T9e(Oj,this,A9e).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[eE];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),xe(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let s=r;i&&(s=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,s,i)!==!1&&(i&&this.hot.batchExecution(()=>{xe(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,s,i,i&&s.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),i=this.isValidConfig(e);let s=r;const n=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(xe(e,h=>{n[h]=!1}),s=ha(n,(h,d,g)=>(d&&h.push(g),h),[])),this.hot.runHooks("beforeUntrimRow",r,s,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(n),this.hot.runHooks("afterUntrimRow",r,s,i&&o,i&&s.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<r)}destroy(){super.destroy()}}function A9e(){const t=this.hot.getSettings()[eE];Array.isArray(t)&&this.hot.batchExecution(()=>{xe(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var O9e=si,I9e=R1,P9e=oK;O9e({target:"Object",stat:!0},{fromEntries:function(e){var r={};return I9e(e,function(i,s){P9e(r,i,s)},{AS_ENTRIES:!0}),r}});const BZ="undoRedo",F9e="undoRedo";function Bt(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(i,s){const n=i&&i.length;if(!n||!i.find(h=>{const[,,d,g]=h;return d!==g}))return;const l=()=>{const h=i.reduce((g,y)=>(g.push([...y]),g),[]);xe(h,g=>{g[1]=t.propToCol(g[1])});const d=n>1?this.getSelected():[[h[0][0],h[0][1]]];return new Bt.ChangeAction(h,d)};e.done(l,s)}),t.addHook("afterCreateRow",(i,s,n)=>{e.done(()=>new Bt.CreateRowAction(i,s),n)});const r=(i,s,n,o)=>{const l=["visualRow","visualCol","row","col","prop"],h=l.length,d=[];return pr(n,o,g=>{pr(i,s,y=>{const C=t.getCellMeta(y,g);if(Object.keys(C).length!==h){const x=Object.fromEntries(Object.entries(C).filter(_=>{let[E]=_;return l.includes(E)===!1}));d.push([C.visualRow,C.visualCol,x])}})}),d};t.addHook("beforeRemoveRow",(i,s,n,o)=>{const l=()=>{const h=t.toPhysicalRow(i),d=h+s-1,g=la(e.instance.getSourceData(h,0,h+s-1,e.instance.countSourceCols()-1));return new Bt.RemoveRowAction(h,g,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),r(h,d,0,t.countCols()-1))};e.done(l,o)}),t.addHook("afterCreateCol",(i,s,n)=>{e.done(()=>new Bt.CreateColumnAction(i,s),n)}),t.addHook("beforeRemoveCol",(i,s,n,o)=>{const l=()=>{const h=e.instance.getSourceDataArray(),d=(e.instance.countCols()+i)%e.instance.countCols(),g=d+s-1,y=[],C=[],x=[];pr(h.length-1,R=>{const I=[],F=h[R];pr(d,g,H=>{I.push(F[t.toPhysicalColumn(H)])}),y.push(I)}),pr(s-1,R=>{x.push(t.toPhysicalColumn(d+R))}),Array.isArray(t.getSettings().colHeaders)&&pr(s-1,R=>{C.push(t.getSettings().colHeaders[t.toPhysicalColumn(d+R)]||null)});const _=t.columnIndexMapper.getIndexesSequence(),E=t.rowIndexMapper.getIndexesSequence();return new Bt.RemoveColumnAction(d,x,y,C,_,E,t.getSettings().fixedColumnsStart,r(0,t.countRows(),d,g))};e.done(l,o)}),t.addHook("beforeCellAlignment",(i,s,n,o)=>{e.done(()=>new Bt.CellAlignmentAction(i,s,n,o))}),t.addHook("beforeFilter",(i,s)=>{e.done(()=>new Bt.FiltersAction(i,s))}),t.addHook("beforeRowMove",(i,s)=>{i!==!1&&e.done(()=>new Bt.RowMoveAction(i,s))}),t.addHook("beforeColumnMove",(i,s)=>{i!==!1&&e.done(()=>new Bt.ColumnMoveAction(i,s))}),t.addHook("beforeMergeCells",(i,s)=>{s||e.done(()=>new Bt.MergeCellsAction(t,i))}),t.addHook("afterUnmergeCells",(i,s)=>{s||e.done(()=>new Bt.UnmergeCellsAction(t,i))}),t.addHook("beforeColumnSort",(i,s,n)=>{n&&e.done(()=>new Bt.ColumnSortAction(i,s))}),t.addHook("afterInit",()=>{e.init()})}Bt.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const i=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",i,e)===!1)return;const n=t(),o=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};Bt.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=la(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const s=this,n=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",n),e.undo(this.instance,()=>{s.ignoreNewActions=!1,s.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",n,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Bt.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=la(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const s=this,n=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",n),e.redo(this.instance,()=>{s.ignoreNewActions=!1,s.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Bt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Bt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Bt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Bt.prototype.isEnabled=function(){return this.enabled};Bt.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,N9e(t),this.registerShortcuts(),t.addHook("afterChange",VZ)};Bt.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,D9e(t),this.unregisterShortcuts(),t.removeHook("afterChange",VZ)};Bt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Bt.Action=function(){};Bt.Action.prototype.undo=function(){};Bt.Action.prototype.redo=function(){};Bt.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Qu(Bt.ChangeAction,Bt.Action);Bt.ChangeAction.prototype.undo=function(t,e){const r=la(this.changes),i=t.countEmptyRows(!0),s=t.countEmptyCols(!0);for(let o=0,l=r.length;o<l;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let o=0,l=r.length;o<l;o++){const[h,d]=r[o];t.getSettings().minSpareRows&&h+1+t.getSettings().minSpareRows===t.countRows()&&i===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(h+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&d+1+t.getSettings().minSpareCols===t.countCols()&&s===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(d+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const n=t.getSelectedLast();if(n!==void 0){const[o,l]=r[0],[h,d]=n,g=t.getFirstFullyVisibleRow(),y=t.getFirstFullyVisibleColumn(),C=o>=g,x=l>=y;if((C&&x)===!1&&(h!==o||d!==l)===!0){const R={row:o,col:l};C===!1&&(R.verticalSnap="top"),x===!1&&(R.horizontalSnap="start"),t.scrollViewportTo(R)}}t.selectCells(this.selected,!1,!1)};Bt.ChangeAction.prototype.redo=function(t,e){const r=la(this.changes);for(let i=0,s=r.length;i<s;i++)r[i].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Bt.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Qu(Bt.CreateRowAction,Bt.Action);Bt.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),i=t.getSettings().minSpareRows;this.index>=r&&this.index-i<r&&(this.index-=i),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Bt.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Bt.RemoveRowAction=function(t,e,r,i,s,n){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=i,this.rowIndexesSequence=s,this.removedCellMetas=n};Qu(Bt.RemoveRowAction,Bt.Action);Bt.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),i=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,n)=>{Object.keys(s).forEach(o=>{const l=parseInt(o,10);i.push([this.index+n,isNaN(l)?o:l,s[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(s=>{let[n,o,l]=s;t.setCellMetaObject(n,o,l)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(i,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Bt.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Bt.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Qu(Bt.CreateColumnAction,Bt.Action);Bt.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Bt.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Bt.RemoveColumnAction=function(t,e,r,i,s,n,o,l){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=i,this.columnPositions=s.slice(0),this.rowPositions=n.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=l};Qu(Bt.RemoveColumnAction,Bt.Action);Bt.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const i=this.indexes.slice(0).sort(),s=(d,g,y)=>y[this.indexes.indexOf(i[g])],n=this.data.length,o=[];for(let d=0;d<n;d++)o.push(on(this.data[d],s));const l=on(this.headers,s),h=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),xe(t.getSourceDataArray(),(d,g)=>{xe(i,(y,C)=>{d[y]=o[g][C],h.push([g,y,d[y]])})}),t.setSourceDataAtCell(h,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&xe(l,(d,g)=>{t.getSettings().colHeaders[i[g]]=d}),this.removedCellMetas.forEach(d=>{let[g,y,C]=d;t.setCellMetaObject(g,y,C)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Bt.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Bt.CellAlignmentAction=function(t,e,r,i){this.stateBefore=t,this.range=e,this.type=r,this.alignment=i};Bt.CellAlignmentAction.prototype.undo=function(t,e){xe(this.range,r=>{r.forAll((i,s)=>{i>=0&&s>=0&&t.setCellMeta(i,s,"className",this.stateBefore[i][s]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Bt.CellAlignmentAction.prototype.redo=function(t,e){Wf(this.range,this.type,this.alignment,(r,i)=>t.getCellMeta(r,i),(r,i,s,n)=>t.setCellMeta(r,i,s,n)),t.addHookOnce("afterViewRender",e),t.render()};Bt.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Qu(Bt.FiltersAction,Bt.Action);Bt.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()};Bt.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class M9e extends Bt.Action{constructor(e,r){super(),this.cellRange=r;const i=this.cellRange.getTopStartCorner(),s=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(i.row,i.col,s.row,s.col)}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0);const s=this.cellRange.getTopStartCorner();e.populateFromArray(s.row,s.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange)}}Bt.MergeCellsAction=M9e;class k9e extends Bt.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.mergeRange(this.cellRange,!0)}redo(e,r){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),i.unmergeRange(this.cellRange,!0),e.render()}}Bt.UnmergeCellsAction=k9e;Bt.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Qu(Bt.RowMoveAction,Bt.Action);Bt.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),I6(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:n,to:o}=s;n<o&&(o-=1),r.moveRow(o,n)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Bt.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};Bt.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Qu(Bt.ColumnMoveAction,Bt.Action);Bt.ColumnMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),I6(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:n,to:o}=s;n<o&&(o-=1),r.moveColumn(o,n)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};Bt.ColumnMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),r.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};Bt.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Qu(Bt.ColumnSortAction,Bt.Action);Bt.ColumnSortAction.prototype.undo=function(t,e){const r=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting"),s=i.isEnabled()?i:r;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),e()};Bt.ColumnSortAction.prototype.redo=function(t,e){const r=t.getPlugin("columnSorting"),i=t.getPlugin("multiColumnSorting");(i.isEnabled()?i:r).sort(this.nextSortState),e()};Bt.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Bt.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),i={runOnlyIf:s=>!s.altKey,group:BZ};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],i)};Bt.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(BZ)};function VZ(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function N9e(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function D9e(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const hS=Xt.getSingleton();hS.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});hS.register("beforeUndo");hS.register("afterUndo");hS.register("beforeRedo");hS.register("afterRedo");Bt.PLUGIN_KEY=F9e;Bt.SETTING_KEYS=!0;function L9e(){wn(cy),wn(mPe),wn(uy),wn(KPe),wn(rFe),wn(lQ),wn(qFe),wn(kMe),wn(aR),wn(eNe),wn(_Ne),wn(kNe),wn(uR),wn(lDe),wn(s5e),wn(L5e),wn(uLe),wn(bLe),wn(kLe),wn(zLe),wn(t8e),wn(y8e),wn(A8e),wn(yHe),wn(QHe),wn(n7e),wn(O7e),wn(m$e),wn(H$e),wn(Y$e),wn(a9e),wn(p9e),wn(R9e),wn(Bt)}function H9e(){$Oe(),l3e(),v3e(),L3e(),L9e()}H9e();const $9e=()=>{const t=MC(),[e,r]=He.useState("convert");He.useEffect(()=>{var Ct;(Ct=t.state)!=null&&Ct.activeTab&&r(t.state.activeTab)},[t]);const[i,s]=He.useState(null),[n,o]=He.useState([]),[l,h]=He.useState(!1),d=He.useRef(null),[g,y]=He.useState(null),[C,x]=He.useState(!1);He.useState([]);const[_,E]=He.useState(!1),[R,I]=He.useState(0),[F,H]=He.useState(null),[z,q]=He.useState(!1),re=Ct=>{const ct=Ct.target.files[0];if(!ct)return;const Ue=new FileReader;Ue.onload=Je=>{try{const Fe=new Uint8Array(Je.target.result),A=Tf.read(Fe,{type:"array"}),O=A.SheetNames[0],k=A.Sheets[O],L=Tf.utils.sheet_to_json(k,{header:1,raw:!1,defval:""});if(L.length>0){const D=L[0],K=L.slice(1);o(D),s(K),h(!0)}else Vt.error("File Excel khng c d liu")}catch(Fe){console.error("Error reading Excel:",Fe),Vt.error("Li khi c file Excel")}},Ue.readAsArrayBuffer(ct)},Y=()=>{try{if(!d.current)return;const Ct=d.current.hotInstance,ct=Ct.getData(),Ue=Ct.getColHeader(),Je=Tf.utils.aoa_to_sheet([Ue,...ct]),Fe=Tf.utils.book_new();Tf.utils.book_append_sheet(Fe,Je,"Sheet1"),Tf.writeFile(Fe,"edited_spreadsheet.xlsx"),Vt.success(" lu thnh cng!")}catch(Ct){console.error("Error saving Excel:",Ct),Vt.error("Li khi lu file")}},oe=Ct=>{Ct.preventDefault()},me=async Ct=>{Ct.preventDefault();const ct=Array.from(Ct.dataTransfer.files).filter(Ue=>Ue.name.endsWith(".xlsx")||Ue.name.endsWith(".xls"));if(ct.length===0){Vt.error("Vui lng ch ko file Excel (.xlsx, .xls)");return}await de(ct)},de=async Ct=>{if(Ct.length!==0)try{const ct=[];for(const Ue of Ct){const Je=await Ue.arrayBuffer(),Fe=new Uint8Array(Je),A=Tf.read(Fe,{type:"array"}),O=A.SheetNames[0],k=A.Sheets[O],L=Tf.utils.sheet_to_json(k,{header:1,raw:!1,defval:""}),D=L.find(j=>j.some(X=>X==="Tn"||X==="n gi"||X==="n v"));if(!D){Vt.error(`File "${Ue.name}": Khng tm thy ct "Tn", "n gi" hoc "n v"`);continue}const K=D.findIndex(j=>j==="Tn"),Q=D.findIndex(j=>j==="n gi"),pe=D.findIndex(j=>j==="n v"),ye=L.slice(L.indexOf(D)+1).filter(j=>j[K]&&j[Q]).map(j=>{var X;return{name:j[K].trim(),price:parseFloat(j[Q].replace(/[,.]/g,""))||0,unit:((X=j[pe])==null?void 0:X.trim())||"",sourceFile:Ue.name}});ct.push(...ye)}y(ct),x(!0),q(!1),Vt.success(` chuyn i ${Ct.length} file thnh cng`)}catch(ct){console.error("Error converting files:",ct),Vt.error("Li khi chuyn i file")}},Re=()=>{if(!g)return;const Ct=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),ct=URL.createObjectURL(Ct),Ue=document.createElement("a");Ue.href=ct,Ue.download="converted_data.json",document.body.appendChild(Ue),Ue.click(),document.body.removeChild(Ue),URL.revokeObjectURL(ct),Vt.success(" ti xung file JSON")},Ie=async()=>{if(!g||g.length===0){Vt.error("Khng c d liu  import");return}try{E(!0),I(0);const Ct=g.filter(Fe=>Fe.name&&Fe.price).map((Fe,A)=>({...Fe,originalIndex:A+1,unit:Fe.unit||"Ci"}));if(Ct.length===0){Vt.error("Khng c sn phm no  thng tin bt buc (name v price)");return}const ct=localStorage.getItem("token"),Ue=Ct.length,Je={successCount:0,failedCount:0,failedProducts:[]};for(let Fe=0;Fe<Ct.length;Fe++){const A=Ct[Fe];H(A),I(Math.round(Fe/Ue*100));try{const O=await fetch("https://backend-giahung.onrender.com/api/products/bulk",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ct}`},body:JSON.stringify({products:[A]})}),k=await O.json();O.ok?Je.successCount++:(Je.failedCount++,Je.failedProducts.push({...A,error:k.message||"Li khng xc nh"}))}catch(O){Je.failedCount++,Je.failedProducts.push({...A,error:O.message})}}if(I(100),Je.failedProducts.length>0){console.error("=== Failed Products ==="),console.table(Je.failedProducts);const Fe=`
          Import tht bi:
          - S sn phm li: ${Je.failedProducts.length}
          - Chi tit li:
          ${Je.failedProducts.map(A=>`
  + Dng ${A.originalIndex}: ${A.name} - ${A.error}`).join("")}
        `;Vt.error(Fe,{autoClose:!1,closeOnClick:!1})}Vt.success(`Import hon tt:
Thnh cng: ${Je.successCount} sn phm
Tht bi: ${Je.failedCount} sn phm`),E(!1),H(null),x(!1),y(null)}catch(Ct){console.error("=== Import Error ==="),console.error(Ct),Vt.error(`Li: ${Ct.message}`),E(!1),H(null)}},Be=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-auto",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsx("h3",{className:"text-xl font-semibold",children:"Kt qu chuyn i JSON"}),V.jsxs("div",{className:"space-x-2",children:[V.jsx("button",{onClick:Ie,disabled:_,className:`px-4 py-2 ${_?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"} text-white rounded`,children:_?"ang Import...":"Import vo DB"}),V.jsx("button",{onClick:Re,disabled:_,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Ti JSON"}),V.jsx("button",{onClick:()=>x(!1),disabled:_,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"ng"})]})]}),_&&V.jsxs("div",{className:"mb-4",children:[V.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-2",children:V.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${R}%`}})}),V.jsxs("div",{className:"text-sm text-gray-600",children:[V.jsxs("p",{children:["ang import: ",F==null?void 0:F.name]}),V.jsxs("p",{children:["Tin trnh: ",R,"%"]})]})]}),V.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:V.jsx("pre",{className:"text-sm overflow-x-auto whitespace-pre-wrap",children:JSON.stringify(g,null,2)})}),V.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[V.jsxs("div",{children:["Tng s sn phm: ",(g==null?void 0:g.length)||0]}),V.jsxs("div",{children:["S file  x l: ",[...new Set((g==null?void 0:g.map(Ct=>Ct.sourceFile))||[])].length]})]})]})}),lt=()=>V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4",children:[V.jsxs("div",{className:"flex justify-between items-center mb-4",children:[V.jsx("h3",{className:"text-xl font-semibold",children:"Chuyn i Excel sang JSON"}),V.jsx("button",{onClick:()=>q(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),V.jsx("div",{onDragOver:oe,onDrop:me,className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{className:"text-gray-600",children:[V.jsx("p",{className:"text-lg mb-2",children:"Ko v th file Excel vo y"}),V.jsx("p",{className:"text-sm",children:"hoc"})]}),V.jsxs("label",{onClick:()=>q(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:[V.jsx(p4,{className:"mr-2"}),V.jsx("span",{children:"Chn File Excel"})]}),V.jsx("p",{className:"text-sm text-gray-500",children:"Chp nhn cc file .xlsx, .xls"})]})})]})}),pt={data:i||[],colHeaders:n,rowHeaders:!0,width:"100%",height:"70vh",licenseKey:"non-commercial-and-evaluation",stretchH:"all",minRows:100,maxRows:500,minCols:20,maxCols:50,autoInsertRow:!0,manualRowMove:!0,manualColumnMove:!0,manualRowResize:!0,manualColumnResize:!0,fillHandle:{autoInsertRow:!0,direction:"vertical"},contextMenu:{items:{row_above:{name:"Thm hng pha trn"},row_below:{name:"Thm hng pha di"},col_left:{name:"Thm ct bn tri"},col_right:{name:"Thm ct bn phi"},remove_row:{name:"Xa hng"},remove_col:{name:"Xa ct"},undo:{name:"Hon tc"},redo:{name:"Lm li"},copy:{name:"Sao chp"},cut:{name:"Ct"},paste:{name:"Dn"}}},dropdownMenu:!0,filters:!0,multiColumnSorting:!0,viewportRowRenderingOffset:100,viewportColumnRenderingOffset:20,afterScrollVertically:function(){const Ct=this,ct=Ct.countRows()-1;Ct.getLastVisibleRow()>=ct-20&&Ct.alter("insert_row",ct+1,50)},afterChange:function(Ct,ct){if(Ct){const Ue=this,Je=Ue.countRows()-1,Fe=Ue.countCols()-1;Ct.forEach(([A,O,k,L])=>{A===Je-5&&Ue.alter("insert_row",Je+1,20),O===Fe-2&&Ue.alter("insert_col",Fe+1,5)})}}};return V.jsxs("div",{className:"p-6",children:[V.jsxs("div",{className:"mb-8",children:[V.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Cng c Excel"}),V.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[V.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 ${e==="convert"?"ring-2 ring-blue-500":""}`,children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chuyn Excel sang JSON"}),V.jsxs("div",{className:"mb-6",children:[V.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Chn file Excel  chuyn i thnh JSON"}),V.jsx("div",{className:"flex items-center space-x-4",children:V.jsxs("label",{onClick:()=>q(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:[V.jsx(p4,{className:"mr-2"}),V.jsx("span",{children:"Chn File Excel"})]})})]})]}),V.jsxs("div",{className:`bg-white rounded-lg shadow-md p-6 ${e==="edit"?"ring-2 ring-blue-500":""}`,children:[V.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Chnh sa Spreadsheet"}),V.jsxs("div",{className:"mb-4",children:[V.jsx("label",{className:"block mb-2 text-sm font-medium text-gray-700",children:"Chn file Excel  chnh sa"}),V.jsxs("div",{className:"flex items-center space-x-4",children:[V.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 cursor-pointer",children:[V.jsx(p4,{className:"mr-2"}),V.jsx("span",{children:"Chn File Excel"}),V.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:re,className:"hidden"})]}),l&&V.jsxs("button",{onClick:Y,className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[V.jsx(lce,{className:"mr-2"}),"Lu Excel"]})]})]}),l&&V.jsx("div",{className:"border rounded-lg overflow-hidden mt-4",style:{height:"70vh",maxWidth:"100%",overflow:"auto"},children:V.jsx(TJ,{ref:d,settings:pt})})]})]})]}),z&&V.jsx(lt,{}),C&&V.jsx(Be,{})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kT={};kT.version="0.18.5";var WZ=1252,B9e=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jZ=function(t){B9e.indexOf(t)!=-1&&(WZ=t)};function V9e(){jZ(1252)}var wC=function(t){jZ(t)};function W9e(){wC(1200),V9e()}var l2=function(e){return String.fromCharCode(e)},Ij=function(e){return String.fromCharCode(e)},NT,hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yC(t){for(var e="",r=0,i=0,s=0,n=0,o=0,l=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),n=r>>2,i=t.charCodeAt(d++),o=(r&3)<<4|i>>4,s=t.charCodeAt(d++),l=(i&15)<<2|s>>6,h=s&63,isNaN(i)?l=h=64:isNaN(s)&&(h=64),e+=hd.charAt(n)+hd.charAt(o)+hd.charAt(l)+hd.charAt(h);return e}function of(t){var e="",r=0,i=0,s=0,n=0,o=0,l=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)n=hd.indexOf(t.charAt(d++)),o=hd.indexOf(t.charAt(d++)),r=n<<2|o>>4,e+=String.fromCharCode(r),l=hd.indexOf(t.charAt(d++)),i=(o&15)<<4|l>>2,l!==64&&(e+=String.fromCharCode(i)),h=hd.indexOf(t.charAt(d++)),s=(l&3)<<6|h,h!==64&&(e+=String.fromCharCode(s));return e}var kn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),mf=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Dg(t){return kn?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Pj(t){return kn?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Rc=function(e){return kn?mf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function gR(t){if(typeof ArrayBuffer>"u")return Rc(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),i=0;i!=t.length;++i)r[i]=t.charCodeAt(i)&255;return e}function fS(t){if(Array.isArray(t))return t.map(function(i){return String.fromCharCode(i)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function j9e(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var oo=kn?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:mf(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var i=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)i.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";i.set(new Uint8Array(t[e]),r)}return i}return[].concat.apply([],t.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function U9e(t){for(var e=[],r=0,i=t.length+250,s=Dg(t.length+255),n=0;n<t.length;++n){var o=t.charCodeAt(n);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++n)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>i&&(e.push(s.slice(0,r)),r=0,s=Dg(65535),i=65530)}return e.push(s.slice(0,r)),oo(e)}var Ey=/\u0000/g,c2=/[\u0001-\u0006]/g;function qp(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Oc(t,e){var r=""+t;return r.length>=e?r:Qi("0",e-r.length)+r}function D6(t,e){var r=""+t;return r.length>=e?r:Qi(" ",e-r.length)+r}function DT(t,e){var r=""+t;return r.length>=e?r:r+Qi(" ",e-r.length)}function z9e(t,e){var r=""+Math.round(t);return r.length>=e?r:Qi("0",e-r.length)+r}function G9e(t,e){var r=""+t;return r.length>=e?r:Qi("0",e-r.length)+r}var Fj=Math.pow(2,32);function rp(t,e){if(t>Fj||t<-Fj)return z9e(t,e);var r=Math.round(t);return G9e(r,e)}function LT(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Mj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f3=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Y9e(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ts={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},kj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K9e={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function HT(t,e,r){for(var i=t<0?-1:1,s=t*i,n=0,o=1,l=0,h=1,d=0,g=0,y=Math.floor(s);d<e&&(y=Math.floor(s),l=y*o+n,g=y*d+h,!(s-y<5e-8));)s=1/(s-y),n=o,o=l,h=d,d=g;if(g>e&&(d>e?(g=h,l=n):(g=d,l=o)),!r)return[0,i*l,g];var C=Math.floor(i*l/g);return[C,i*l-C*g,g]}function u2(t,e,r){if(t>2958465||t<0)return null;var i=t|0,s=Math.floor(86400*(t-i)),n=0,o=[],l={D:i,T:s,u:86400*(t-i)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),e&&e.date1904&&(i+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++i,++l.D)),i===60)o=r?[1317,10,29]:[1900,2,29],n=3;else if(i===0)o=r?[1317,8,29]:[1900,1,0],n=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),o=[h.getFullYear(),h.getMonth()+1,h.getDate()],n=h.getDay(),i<60&&(n=(n+6)%7),r&&(n=tBe(h,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=n,l}var UZ=new Date(1899,11,31,0,0,0),X9e=UZ.getTime(),q9e=new Date(1900,2,1,0,0,0);function zZ(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=q9e&&(r+=24*60*60*1e3),(r-(X9e+(t.getTimezoneOffset()-UZ.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function L6(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J9e(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Q9e(t){var e=t<0?12:11,r=L6(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Z9e(t){var e=L6(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function eBe(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Q9e(t):e===10?r=t.toFixed(10).substr(0,12):r=Z9e(t),L6(J9e(r.toUpperCase()))}function VF(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):eBe(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Pd(14,zZ(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function tBe(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function rBe(t,e,r,i){var s="",n=0,o=0,l=r.y,h,d=0;switch(t){case 98:l=r.y+543;case 121:switch(e.length){case 1:case 2:h=l%100,d=2;break;default:h=l%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return f3[r.m-1][1];case 5:return f3[r.m-1][0];default:return f3[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return Mj[r.q][0];default:return Mj[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Oc(r.S,e.length):(i>=2?o=i===3?1e3:100:o=i===1?10:1,n=Math.round(o*(r.S+r.u)),n>=60*o&&(n=0),e==="s"?n===0?"0":""+n/o:(s=Oc(n,2+i),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=l,d=1;break}var g=d>0?Oc(h,d):"";return g}function fd(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,i=t.substr(0,r);r!=t.length;r+=e)i+=(i.length>0?",":"")+t.substr(r,e);return i}var GZ=/%/g;function nBe(t,e,r){var i=e.replace(GZ,""),s=e.length-i.length;return Yh(t,i,r*Math.pow(10,2*s))+Qi("%",s)}function iBe(t,e,r){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Yh(t,e.substr(0,i),r/Math.pow(10,3*(e.length-i)))}function YZ(t,e){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+YZ(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var n=Math.floor(Math.log(e)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(e/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,d,g){return h+d+g.substr(0,(s+n)%s)+"."+g.substr(n)+"E"})}else r=e.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var KZ=/# (\?+)( ?)\/( ?)(\d+)/;function sBe(t,e,r){var i=parseInt(t[4],10),s=Math.round(e*i),n=Math.floor(s/i),o=s-n*i,l=i;return r+(n===0?"":""+n)+" "+(o===0?Qi(" ",t[1].length+1+t[4].length):D6(o,t[1].length)+t[2]+"/"+t[3]+Oc(l,t[4].length))}function oBe(t,e,r){return r+(e===0?"":""+e)+Qi(" ",t[1].length+2+t[4].length)}var XZ=/^#*0*\.([0#]+)/,qZ=/\).*[0#]/,JZ=/\(###\) ###\\?-####/;function Zo(t){for(var e="",r,i=0;i!=t.length;++i)switch(r=t.charCodeAt(i)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Nj(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Dj(t,e){var r=t-Math.floor(t),i=Math.pow(10,e);return e<(""+Math.round(r*i)).length?0:Math.round(r*i)}function aBe(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function lBe(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Al(t,e,r){if(t.charCodeAt(0)===40&&!e.match(qZ)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Al("n",i,r):"("+Al("n",i,-r)+")"}if(e.charCodeAt(e.length-1)===44)return iBe(t,e,r);if(e.indexOf("%")!==-1)return nBe(t,e,r);if(e.indexOf("E")!==-1)return YZ(e,r);if(e.charCodeAt(0)===36)return"$"+Al(t,e.substr(e.charAt(1)==" "?2:1),r);var s,n,o,l,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+rp(h,e.length);if(e.match(/^[#?]+$/))return s=rp(r,0),s==="0"&&(s=""),s.length>e.length?s:Zo(e.substr(0,e.length-s.length))+s;if(n=e.match(KZ))return sBe(n,h,d);if(e.match(/^#+0+$/))return d+rp(h,e.length-e.indexOf("0"));if(n=e.match(XZ))return s=Nj(r,n[1].length).replace(/^([^\.]+)$/,"$1."+Zo(n[1])).replace(/\.$/,"."+Zo(n[1])).replace(/\.(\d*)$/,function(_,E){return"."+E+Qi("0",Zo(n[1]).length-E.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),n=e.match(/^(0*)\.(#*)$/))return d+Nj(h,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=e.match(/^#{1,3},##0(\.?)$/))return d+fd(rp(h,0));if(n=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Al(t,e,-r):fd(""+(Math.floor(r)+aBe(r,n[1].length)))+"."+Oc(Dj(r,n[1].length),n[1].length);if(n=e.match(/^#,#*,#0/))return Al(t,e.replace(/^#,#*,/,""),r);if(n=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qp(Al(t,e.replace(/[\\-]/g,""),r)),o=0,qp(qp(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<s.length?s.charAt(o++):_==="0"?"0":""}));if(e.match(JZ))return s=Al(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(n=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),l=HT(h,Math.pow(10,o)-1,!1),s=""+d,g=Yh("n",n[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+n[2]+"/"+n[3],g=DT(l[2],o),g.length<n[4].length&&(g=Zo(n[4].substr(n[4].length-g.length))+g),s+=g,s;if(n=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),l=HT(h,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?D6(l[1],o)+n[2]+"/"+n[3]+DT(l[2],o):Qi(" ",2*o+1+n[2].length+n[3].length));if(n=e.match(/^[#0?]+$/))return s=rp(r,0),e.length<=s.length?s:Zo(e.substr(0,e.length-s.length))+s;if(n=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var y=e.indexOf(".")-o,C=e.length-s.length-y;return Zo(e.substr(0,y)+s+e.substr(e.length-C))}if(n=e.match(/^00,000\.([#0]*0)$/))return o=Dj(r,n[1].length),r<0?"-"+Al(t,e,-r):fd(lBe(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Oc(0,3-_.length):"")+_})+"."+Oc(o,n[1].length);switch(e){case"###,##0.00":return Al(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=fd(rp(h,0));return x!=="0"?d+x:"";case"###,###.00":return Al(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Al(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function cBe(t,e,r){for(var i=e.length-1;e.charCodeAt(i-1)===44;)--i;return Yh(t,e.substr(0,i),r/Math.pow(10,3*(e.length-i)))}function uBe(t,e,r){var i=e.replace(GZ,""),s=e.length-i.length;return Yh(t,i,r*Math.pow(10,2*s))+Qi("%",s)}function QZ(t,e){var r,i=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+QZ(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var n=Math.floor(Math.log(e)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(e/Math.pow(10,n)).toPrecision(i+1+(s+n)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+n):r+="E+"+(o-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,h,d,g){return h+d+g.substr(0,(s+n)%s)+"."+g.substr(n)+"E"})}else r=e.toExponential(i);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function xu(t,e,r){if(t.charCodeAt(0)===40&&!e.match(qZ)){var i=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xu("n",i,r):"("+xu("n",i,-r)+")"}if(e.charCodeAt(e.length-1)===44)return cBe(t,e,r);if(e.indexOf("%")!==-1)return uBe(t,e,r);if(e.indexOf("E")!==-1)return QZ(e,r);if(e.charCodeAt(0)===36)return"$"+xu(t,e.substr(e.charAt(1)==" "?2:1),r);var s,n,o,l,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Oc(h,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:Zo(e.substr(0,e.length-s.length))+s;if(n=e.match(KZ))return oBe(n,h,d);if(e.match(/^#+0+$/))return d+Oc(h,e.length-e.indexOf("0"));if(n=e.match(XZ))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Zo(n[1])).replace(/\.$/,"."+Zo(n[1])),s=s.replace(/\.(\d*)$/,function(_,E){return"."+E+Qi("0",Zo(n[1]).length-E.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),n=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=e.match(/^#{1,3},##0(\.?)$/))return d+fd(""+h);if(n=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xu(t,e,-r):fd(""+r)+"."+Qi("0",n[1].length);if(n=e.match(/^#,#*,#0/))return xu(t,e.replace(/^#,#*,/,""),r);if(n=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=qp(xu(t,e.replace(/[\\-]/g,""),r)),o=0,qp(qp(e.replace(/\\/g,"")).replace(/[0#]/g,function(_){return o<s.length?s.charAt(o++):_==="0"?"0":""}));if(e.match(JZ))return s=xu(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var g="";if(n=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(n[4].length,7),l=HT(h,Math.pow(10,o)-1,!1),s=""+d,g=Yh("n",n[1],l[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),s+=g+n[2]+"/"+n[3],g=DT(l[2],o),g.length<n[4].length&&(g=Zo(n[4].substr(n[4].length-g.length))+g),s+=g,s;if(n=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(n[1].length,n[4].length),7),l=HT(h,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?D6(l[1],o)+n[2]+"/"+n[3]+DT(l[2],o):Qi(" ",2*o+1+n[2].length+n[3].length));if(n=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:Zo(e.substr(0,e.length-s.length))+s;if(n=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var y=e.indexOf(".")-o,C=e.length-s.length-y;return Zo(e.substr(0,y)+s+e.substr(e.length-C))}if(n=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+xu(t,e,-r):fd(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(_){return"00,"+(_.length<3?Oc(0,3-_.length):"")+_})+"."+Oc(0,n[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=fd(""+h);return x!=="0"?d+x:"";default:if(e.match(/\.[0#?]*$/))return xu(t,e.slice(0,e.lastIndexOf(".")),r)+Zo(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Yh(t,e,r){return(r|0)===r?xu(t,e,r):Al(t,e,r)}function hBe(t){for(var e=[],r=!1,i=0,s=0;i<t.length;++i)switch(t.charCodeAt(i)){case 34:r=!r;break;case 95:case 42:case 92:++i;break;case 59:e[e.length]=t.substr(s,i-s),s=i+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var ZZ=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function eee(t){for(var e=0,r="",i="";e<t.length;)switch(r=t.charAt(e)){case"G":LT(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(i=r;t.charAt(e++)!=="]"&&e<t.length;)i+=t.charAt(e);if(i.match(ZZ))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function fBe(t,e,r,i){for(var s=[],n="",o=0,l="",h="t",d,g,y,C="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!LT(t,o))throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(n="";(y=t.charCodeAt(++o))!==34&&o<t.length;)n+=String.fromCharCode(y);s[s.length]={t:"t",v:n},++o;break;case"\\":var x=t.charAt(++o),_=x==="("||x===")"?x:"t";s[s.length]={t:_,v:x},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=u2(e,r,t.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:t.substr(o,2)},h=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=u2(e,r),d==null))return"";for(n=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)n+=l;l==="m"&&h.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=C),s[s.length]={t:l,v:n},h=l;break;case"A":case"a":case"":var E={t:l,v:l};if(d==null&&(d=u2(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",C="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",o+=5,C="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",o+=5,C="h"):(E.t="t",++o),d==null&&E.t==="T")return"";s[s.length]=E,h=l;break;case"[":for(n=l;t.charAt(o++)!=="]"&&o<t.length;)n+=t.charAt(o);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(ZZ)){if(d==null&&(d=u2(e,r),d==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},h=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",eee(t)||(s[s.length]={t:"t",v:n}));break;case".":if(d!=null){for(n=l;++o<t.length&&(l=t.charAt(o))==="0";)n+=l;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)n+=l;s[s.length]={t:"n",v:n};break;case"?":for(n=l;t.charAt(++o)===l;)n+=l;s[s.length]={t:l,v:n},h=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:i===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)n+=t.charAt(o);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);s[s.length]={t:"t",v:l},++o;break}var R=0,I=0,F;for(o=s.length-1,h="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=C,h="h",R<1&&(R=1);break;case"s":(F=s[o].v.match(/\.0+$/))&&(I=Math.max(I,F[0].length-1)),R<3&&(R=3);case"d":case"y":case"M":case"e":h=s[o].t;break;case"m":h==="s"&&(s[o].t="M",R<2&&(R=2));break;case"X":break;case"Z":R<1&&s[o].v.match(/[Hh]/)&&(R=1),R<2&&s[o].v.match(/[Mm]/)&&(R=2),R<3&&s[o].v.match(/[Ss]/)&&(R=3)}switch(R){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var H="",z;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=rBe(s[o].t.charCodeAt(0),s[o].v,d,I),s[o].t="t";break;case"n":case"?":for(z=o+1;s[z]!=null&&((l=s[z].t)==="?"||l==="D"||(l===" "||l==="t")&&s[z+1]!=null&&(s[z+1].t==="?"||s[z+1].t==="t"&&s[z+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[z].v==="/"||s[z].v===" "&&s[z+1]!=null&&s[z+1].t=="?"));)s[o].v+=s[z].v,s[z]={v:"",t:";"},++z;H+=s[o].v,o=z-1;break;case"G":s[o].t="t",s[o].v=VF(e,r);break}var q="",re,Y;if(H.length>0){H.charCodeAt(0)==40?(re=e<0&&H.charCodeAt(0)===45?-e:e,Y=Yh("n",H,re)):(re=e<0&&i>1?-e:e,Y=Yh("n",H,re),re<0&&s[0]&&s[0].t=="t"&&(Y=Y.substr(1),s[0].v="-"+s[0].v)),z=Y.length-1;var oe=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){oe=o;break}var me=s.length;if(oe===s.length&&Y.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(z>=s[o].v.length-1?(z-=s[o].v.length,s[o].v=Y.substr(z+1,s[o].v.length)):z<0?s[o].v="":(s[o].v=Y.substr(0,z+1),z=-1),s[o].t="t",me=o);z>=0&&me<s.length&&(s[me].v=Y.substr(0,z+1)+s[me].v)}else if(oe!==s.length&&Y.indexOf("E")===-1){for(z=Y.indexOf(".")-1,o=oe;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(g=s[o].v.indexOf(".")>-1&&o===oe?s[o].v.indexOf(".")-1:s[o].v.length-1,q=s[o].v.substr(g+1);g>=0;--g)z>=0&&(s[o].v.charAt(g)==="0"||s[o].v.charAt(g)==="#")&&(q=Y.charAt(z--)+q);s[o].v=q,s[o].t="t",me=o}for(z>=0&&me<s.length&&(s[me].v=Y.substr(0,z+1)+s[me].v),z=Y.indexOf(".")+1,o=oe;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==oe)){for(g=s[o].v.indexOf(".")>-1&&o===oe?s[o].v.indexOf(".")+1:0,q=s[o].v.substr(0,g);g<s[o].v.length;++g)z<Y.length&&(q+=Y.charAt(z++));s[o].v=q,s[o].t="t",me=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(re=i>1&&e<0&&o>0&&s[o-1].v==="-"?-e:e,s[o].v=Yh(s[o].t,s[o].v,re),s[o].t="t");var de="";for(o=0;o!==s.length;++o)s[o]!=null&&(de+=s[o].v);return de}var Lj=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hj(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function dBe(t,e){var r=hBe(t),i=r.length,s=r[i-1].indexOf("@");if(i<4&&s>-1&&--i,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[i,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(Lj),l=r[1].match(Lj);return Hj(e,o)?[i,r[0]]:Hj(e,l)?[i,r[1]]:[i,r[o!=null&&l!=null?2:1]]}return[i,n]}function Pd(t,e,r){r==null&&(r={});var i="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?i=r.dateNF:i=t;break;case"number":t==14&&r.dateNF?i=r.dateNF:i=(r.table!=null?r.table:ts)[t],i==null&&(i=r.table&&r.table[kj[t]]||ts[kj[t]]),i==null&&(i=K9e[t]||"General");break}if(LT(i,0))return VF(e,r);e instanceof Date&&(e=zZ(e,r.date1904));var s=dBe(i,e);if(LT(s[1]))return VF(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return fBe(s[1],e,r,s[0])}function tee(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ts[r]==null){e<0&&(e=r);continue}if(ts[r]==t){e=r;break}}e<0&&(e=391)}return ts[e]=t,e}function mR(t){for(var e=0;e!=392;++e)t[e]!==void 0&&tee(t[e],e)}function pR(){ts=Y9e()}var ree=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function gBe(t){var e=typeof t=="number"?ts[t]:t;return e=e.replace(ree,"(\\d+)"),new RegExp("^"+e+"$")}function mBe(t,e,r){var i=-1,s=-1,n=-1,o=-1,l=-1,h=-1;(e.match(ree)||[]).forEach(function(y,C){var x=parseInt(r[C+1],10);switch(y.toLowerCase().charAt(0)){case"y":i=x;break;case"d":n=x;break;case"h":o=x;break;case"s":h=x;break;case"m":o>=0?l=x:s=x;break}}),h>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return o==-1&&l==-1&&h==-1?d:i==-1&&s==-1&&n==-1?g:d+"T"+g}var pBe=function(){var t={};t.version="1.2.0";function e(){for(var Y=0,oe=new Array(256),me=0;me!=256;++me)Y=me,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,Y=Y&1?-306674912^Y>>>1:Y>>>1,oe[me]=Y;return typeof Int32Array<"u"?new Int32Array(oe):oe}var r=e();function i(Y){var oe=0,me=0,de=0,Re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(de=0;de!=256;++de)Re[de]=Y[de];for(de=0;de!=256;++de)for(me=Y[de],oe=256+de;oe<4096;oe+=256)me=Re[oe]=me>>>8^Y[me&255];var Ie=[];for(de=1;de!=16;++de)Ie[de-1]=typeof Int32Array<"u"?Re.subarray(de*256,de*256+256):Re.slice(de*256,de*256+256);return Ie}var s=i(r),n=s[0],o=s[1],l=s[2],h=s[3],d=s[4],g=s[5],y=s[6],C=s[7],x=s[8],_=s[9],E=s[10],R=s[11],I=s[12],F=s[13],H=s[14];function z(Y,oe){for(var me=oe^-1,de=0,Re=Y.length;de<Re;)me=me>>>8^r[(me^Y.charCodeAt(de++))&255];return~me}function q(Y,oe){for(var me=oe^-1,de=Y.length-15,Re=0;Re<de;)me=H[Y[Re++]^me&255]^F[Y[Re++]^me>>8&255]^I[Y[Re++]^me>>16&255]^R[Y[Re++]^me>>>24]^E[Y[Re++]]^_[Y[Re++]]^x[Y[Re++]]^C[Y[Re++]]^y[Y[Re++]]^g[Y[Re++]]^d[Y[Re++]]^h[Y[Re++]]^l[Y[Re++]]^o[Y[Re++]]^n[Y[Re++]]^r[Y[Re++]];for(de+=15;Re<de;)me=me>>>8^r[(me^Y[Re++])&255];return~me}function re(Y,oe){for(var me=oe^-1,de=0,Re=Y.length,Ie=0,Be=0;de<Re;)Ie=Y.charCodeAt(de++),Ie<128?me=me>>>8^r[(me^Ie)&255]:Ie<2048?(me=me>>>8^r[(me^(192|Ie>>6&31))&255],me=me>>>8^r[(me^(128|Ie&63))&255]):Ie>=55296&&Ie<57344?(Ie=(Ie&1023)+64,Be=Y.charCodeAt(de++)&1023,me=me>>>8^r[(me^(240|Ie>>8&7))&255],me=me>>>8^r[(me^(128|Ie>>2&63))&255],me=me>>>8^r[(me^(128|Be>>6&15|(Ie&3)<<4))&255],me=me>>>8^r[(me^(128|Be&63))&255]):(me=me>>>8^r[(me^(224|Ie>>12&15))&255],me=me>>>8^r[(me^(128|Ie>>6&63))&255],me=me>>>8^r[(me^(128|Ie&63))&255]);return~me}return t.table=r,t.bstr=z,t.buf=q,t.str=re,t}(),ti=function(){var e={};e.version="1.2.1";function r(ee,ge){for(var ae=ee.split("/"),le=ge.split("/"),ue=0,ve=0,ke=Math.min(ae.length,le.length);ue<ke;++ue){if(ve=ae[ue].length-le[ue].length)return ve;if(ae[ue]!=le[ue])return ae[ue]<le[ue]?-1:1}return ae.length-le.length}function i(ee){if(ee.charAt(ee.length-1)=="/")return ee.slice(0,-1).indexOf("/")===-1?ee:i(ee.slice(0,-1));var ge=ee.lastIndexOf("/");return ge===-1?ee:ee.slice(0,ge+1)}function s(ee){if(ee.charAt(ee.length-1)=="/")return s(ee.slice(0,-1));var ge=ee.lastIndexOf("/");return ge===-1?ee:ee.slice(ge+1)}function n(ee,ge){typeof ge=="string"&&(ge=new Date(ge));var ae=ge.getHours();ae=ae<<6|ge.getMinutes(),ae=ae<<5|ge.getSeconds()>>>1,ee.write_shift(2,ae);var le=ge.getFullYear()-1980;le=le<<4|ge.getMonth()+1,le=le<<5|ge.getDate(),ee.write_shift(2,le)}function o(ee){var ge=ee.read_shift(2)&65535,ae=ee.read_shift(2)&65535,le=new Date,ue=ae&31;ae>>>=5;var ve=ae&15;ae>>>=4,le.setMilliseconds(0),le.setFullYear(ae+1980),le.setMonth(ve-1),le.setDate(ue);var ke=ge&31;ge>>>=5;var Ye=ge&63;return ge>>>=6,le.setHours(ge),le.setMinutes(Ye),le.setSeconds(ke<<1),le}function l(ee){Za(ee,0);for(var ge={},ae=0;ee.l<=ee.length-4;){var le=ee.read_shift(2),ue=ee.read_shift(2),ve=ee.l+ue,ke={};switch(le){case 21589:ae=ee.read_shift(1),ae&1&&(ke.mtime=ee.read_shift(4)),ue>5&&(ae&2&&(ke.atime=ee.read_shift(4)),ae&4&&(ke.ctime=ee.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}ee.l=ve,ge[le]=ke}return ge}var h;function d(){return h||(h={})}function g(ee,ge){if(ee[0]==80&&ee[1]==75)return ar(ee,ge);if((ee[0]|32)==109&&(ee[1]|32)==105)return Gc(ee,ge);if(ee.length<512)throw new Error("CFB file size "+ee.length+" < 512");var ae=3,le=512,ue=0,ve=0,ke=0,Ye=0,$e=0,Oe=[],ie=ee.slice(0,512);Za(ie,0);var Me=y(ie);switch(ae=Me[0],ae){case 3:le=512;break;case 4:le=4096;break;case 0:if(Me[1]==0)return ar(ee,ge);default:throw new Error("Major Version: Expected 3 or 4 saw "+ae)}le!==512&&(ie=ee.slice(0,le),Za(ie,28));var Qe=ee.slice(0,le);C(ie,ae);var bt=ie.read_shift(4,"i");if(ae===3&&bt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+bt);ie.l+=4,ke=ie.read_shift(4,"i"),ie.l+=4,ie.chk("00100000","Mini Stream Cutoff Size: "),Ye=ie.read_shift(4,"i"),ue=ie.read_shift(4,"i"),$e=ie.read_shift(4,"i"),ve=ie.read_shift(4,"i");for(var ut=-1,vt=0;vt<109&&(ut=ie.read_shift(4,"i"),!(ut<0));++vt)Oe[vt]=ut;var gr=x(ee,le);R($e,ve,gr,le,Oe);var Er=F(gr,ke,Oe,le);Er[ke].name="!Directory",ue>0&&Ye!==Be&&(Er[Ye].name="!MiniFAT"),Er[Oe[0]].name="!FAT",Er.fat_addrs=Oe,Er.ssz=le;var Br={},mn=[],Ir=[],dl=[];H(ke,Er,gr,mn,ue,Br,Ir,Ye),_(Ir,dl,mn),mn.shift();var vf={FileIndex:Ir,FullPaths:dl};return ge&&ge.raw&&(vf.raw={header:Qe,sectors:gr}),vf}function y(ee){if(ee[ee.l]==80&&ee[ee.l+1]==75)return[0,0];ee.chk(lt,"Header Signature: "),ee.l+=16;var ge=ee.read_shift(2,"u");return[ee.read_shift(2,"u"),ge]}function C(ee,ge){var ae=9;switch(ee.l+=2,ae=ee.read_shift(2)){case 9:if(ge!=3)throw new Error("Sector Shift: Expected 9 saw "+ae);break;case 12:if(ge!=4)throw new Error("Sector Shift: Expected 12 saw "+ae);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ae)}ee.chk("0600","Mini Sector Shift: "),ee.chk("000000000000","Reserved: ")}function x(ee,ge){for(var ae=Math.ceil(ee.length/ge)-1,le=[],ue=1;ue<ae;++ue)le[ue-1]=ee.slice(ue*ge,(ue+1)*ge);return le[ae-1]=ee.slice(ae*ge),le}function _(ee,ge,ae){for(var le=0,ue=0,ve=0,ke=0,Ye=0,$e=ae.length,Oe=[],ie=[];le<$e;++le)Oe[le]=ie[le]=le,ge[le]=ae[le];for(;Ye<ie.length;++Ye)le=ie[Ye],ue=ee[le].L,ve=ee[le].R,ke=ee[le].C,Oe[le]===le&&(ue!==-1&&Oe[ue]!==ue&&(Oe[le]=Oe[ue]),ve!==-1&&Oe[ve]!==ve&&(Oe[le]=Oe[ve])),ke!==-1&&(Oe[ke]=le),ue!==-1&&le!=Oe[le]&&(Oe[ue]=Oe[le],ie.lastIndexOf(ue)<Ye&&ie.push(ue)),ve!==-1&&le!=Oe[le]&&(Oe[ve]=Oe[le],ie.lastIndexOf(ve)<Ye&&ie.push(ve));for(le=1;le<$e;++le)Oe[le]===le&&(ve!==-1&&Oe[ve]!==ve?Oe[le]=Oe[ve]:ue!==-1&&Oe[ue]!==ue&&(Oe[le]=Oe[ue]));for(le=1;le<$e;++le)if(ee[le].type!==0){if(Ye=le,Ye!=Oe[Ye])do Ye=Oe[Ye],ge[le]=ge[Ye]+"/"+ge[le];while(Ye!==0&&Oe[Ye]!==-1&&Ye!=Oe[Ye]);Oe[le]=-1}for(ge[0]+="/",le=1;le<$e;++le)ee[le].type!==2&&(ge[le]+="/")}function E(ee,ge,ae){for(var le=ee.start,ue=ee.size,ve=[],ke=le;ae&&ue>0&&ke>=0;)ve.push(ge.slice(ke*Ie,ke*Ie+Ie)),ue-=Ie,ke=eg(ae,ke*4);return ve.length===0?rt(0):oo(ve).slice(0,ee.size)}function R(ee,ge,ae,le,ue){var ve=Be;if(ee===Be){if(ge!==0)throw new Error("DIFAT chain shorter than expected")}else if(ee!==-1){var ke=ae[ee],Ye=(le>>>2)-1;if(!ke)return;for(var $e=0;$e<Ye&&(ve=eg(ke,$e*4))!==Be;++$e)ue.push(ve);R(eg(ke,le-4),ge-1,ae,le,ue)}}function I(ee,ge,ae,le,ue){var ve=[],ke=[];ue||(ue=[]);var Ye=le-1,$e=0,Oe=0;for($e=ge;$e>=0;){ue[$e]=!0,ve[ve.length]=$e,ke.push(ee[$e]);var ie=ae[Math.floor($e*4/le)];if(Oe=$e*4&Ye,le<4+Oe)throw new Error("FAT boundary crossed: "+$e+" 4 "+le);if(!ee[ie])break;$e=eg(ee[ie],Oe)}return{nodes:ve,data:Gj([ke])}}function F(ee,ge,ae,le){var ue=ee.length,ve=[],ke=[],Ye=[],$e=[],Oe=le-1,ie=0,Me=0,Qe=0,bt=0;for(ie=0;ie<ue;++ie)if(Ye=[],Qe=ie+ge,Qe>=ue&&(Qe-=ue),!ke[Qe]){$e=[];var ut=[];for(Me=Qe;Me>=0;){ut[Me]=!0,ke[Me]=!0,Ye[Ye.length]=Me,$e.push(ee[Me]);var vt=ae[Math.floor(Me*4/le)];if(bt=Me*4&Oe,le<4+bt)throw new Error("FAT boundary crossed: "+Me+" 4 "+le);if(!ee[vt]||(Me=eg(ee[vt],bt),ut[Me]))break}ve[Qe]={nodes:Ye,data:Gj([$e])}}return ve}function H(ee,ge,ae,le,ue,ve,ke,Ye){for(var $e=0,Oe=le.length?2:0,ie=ge[ee].data,Me=0,Qe=0,bt;Me<ie.length;Me+=128){var ut=ie.slice(Me,Me+128);Za(ut,64),Qe=ut.read_shift(2),bt=W6(ut,0,Qe-Oe),le.push(bt);var vt={name:bt,type:ut.read_shift(1),color:ut.read_shift(1),L:ut.read_shift(4,"i"),R:ut.read_shift(4,"i"),C:ut.read_shift(4,"i"),clsid:ut.read_shift(16),state:ut.read_shift(4,"i"),start:0,size:0},gr=ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2);gr!==0&&(vt.ct=z(ut,ut.l-8));var Er=ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2)+ut.read_shift(2);Er!==0&&(vt.mt=z(ut,ut.l-8)),vt.start=ut.read_shift(4,"i"),vt.size=ut.read_shift(4,"i"),vt.size<0&&vt.start<0&&(vt.size=vt.type=0,vt.start=Be,vt.name=""),vt.type===5?($e=vt.start,ue>0&&$e!==Be&&(ge[$e].name="!StreamData")):vt.size>=4096?(vt.storage="fat",ge[vt.start]===void 0&&(ge[vt.start]=I(ae,vt.start,ge.fat_addrs,ge.ssz)),ge[vt.start].name=vt.name,vt.content=ge[vt.start].data.slice(0,vt.size)):(vt.storage="minifat",vt.size<0?vt.size=0:$e!==Be&&vt.start!==Be&&ge[$e]&&(vt.content=E(vt,ge[$e].data,(ge[Ye]||{}).data))),vt.content&&Za(vt.content,0),ve[bt]=vt,ke.push(vt)}}function z(ee,ge){return new Date((tl(ee,ge+4)/1e7*Math.pow(2,32)+tl(ee,ge)/1e7-11644473600)*1e3)}function q(ee,ge){return d(),g(h.readFileSync(ee),ge)}function re(ee,ge){var ae=ge&&ge.type;switch(ae||kn&&Buffer.isBuffer(ee)&&(ae="buffer"),ae||"base64"){case"file":return q(ee,ge);case"base64":return g(Rc(of(ee)),ge);case"binary":return g(Rc(ee),ge)}return g(ee,ge)}function Y(ee,ge){var ae=ge||{},le=ae.root||"Root Entry";if(ee.FullPaths||(ee.FullPaths=[]),ee.FileIndex||(ee.FileIndex=[]),ee.FullPaths.length!==ee.FileIndex.length)throw new Error("inconsistent CFB structure");ee.FullPaths.length===0&&(ee.FullPaths[0]=le+"/",ee.FileIndex[0]={name:le,type:5}),ae.CLSID&&(ee.FileIndex[0].clsid=ae.CLSID),oe(ee)}function oe(ee){var ge="Sh33tJ5";if(!ti.find(ee,"/"+ge)){var ae=rt(4);ae[0]=55,ae[1]=ae[3]=50,ae[2]=54,ee.FileIndex.push({name:ge,type:2,content:ae,size:4,L:69,R:69,C:69}),ee.FullPaths.push(ee.FullPaths[0]+ge),me(ee)}}function me(ee,ge){Y(ee);for(var ae=!1,le=!1,ue=ee.FullPaths.length-1;ue>=0;--ue){var ve=ee.FileIndex[ue];switch(ve.type){case 0:le?ae=!0:(ee.FileIndex.pop(),ee.FullPaths.pop());break;case 1:case 2:case 5:le=!0,isNaN(ve.R*ve.L*ve.C)&&(ae=!0),ve.R>-1&&ve.L>-1&&ve.R==ve.L&&(ae=!0);break;default:ae=!0;break}}if(!(!ae&&!ge)){var ke=new Date(1987,1,19),Ye=0,$e=Object.create?Object.create(null):{},Oe=[];for(ue=0;ue<ee.FullPaths.length;++ue)$e[ee.FullPaths[ue]]=!0,ee.FileIndex[ue].type!==0&&Oe.push([ee.FullPaths[ue],ee.FileIndex[ue]]);for(ue=0;ue<Oe.length;++ue){var ie=i(Oe[ue][0]);le=$e[ie],le||(Oe.push([ie,{name:s(ie).replace("/",""),type:1,clsid:Ct,ct:ke,mt:ke,content:null}]),$e[ie]=!0)}for(Oe.sort(function(bt,ut){return r(bt[0],ut[0])}),ee.FullPaths=[],ee.FileIndex=[],ue=0;ue<Oe.length;++ue)ee.FullPaths[ue]=Oe[ue][0],ee.FileIndex[ue]=Oe[ue][1];for(ue=0;ue<Oe.length;++ue){var Me=ee.FileIndex[ue],Qe=ee.FullPaths[ue];if(Me.name=s(Qe).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||Ct,ue===0)Me.C=Oe.length>1?1:-1,Me.size=0,Me.type=5;else if(Qe.slice(-1)=="/"){for(Ye=ue+1;Ye<Oe.length&&i(ee.FullPaths[Ye])!=Qe;++Ye);for(Me.C=Ye>=Oe.length?-1:Ye,Ye=ue+1;Ye<Oe.length&&i(ee.FullPaths[Ye])!=i(Qe);++Ye);Me.R=Ye>=Oe.length?-1:Ye,Me.type=1}else i(ee.FullPaths[ue+1]||"")==i(Qe)&&(Me.R=ue+1),Me.type=2}}}function de(ee,ge){var ae=ge||{};if(ae.fileType=="mad")return eh(ee,ae);switch(me(ee),ae.fileType){case"zip":return Ur(ee,ae)}var le=function(bt){for(var ut=0,vt=0,gr=0;gr<bt.FileIndex.length;++gr){var Er=bt.FileIndex[gr];if(Er.content){var Br=Er.content.length;Br>0&&(Br<4096?ut+=Br+63>>6:vt+=Br+511>>9)}}for(var mn=bt.FullPaths.length+3>>2,Ir=ut+7>>3,dl=ut+127>>7,vf=Ir+vt+mn+dl,Ha=vf+127>>7,fi=Ha<=109?0:Math.ceil((Ha-109)/127);vf+Ha+fi+127>>7>Ha;)fi=++Ha<=109?0:Math.ceil((Ha-109)/127);var Ql=[1,fi,Ha,dl,mn,vt,ut,0];return bt.FileIndex[0].size=ut<<6,Ql[7]=(bt.FileIndex[0].start=Ql[0]+Ql[1]+Ql[2]+Ql[3]+Ql[4]+Ql[5])+(Ql[6]+7>>3),Ql}(ee),ue=rt(le[7]<<9),ve=0,ke=0;{for(ve=0;ve<8;++ve)ue.write_shift(1,pt[ve]);for(ve=0;ve<8;++ve)ue.write_shift(2,0);for(ue.write_shift(2,62),ue.write_shift(2,3),ue.write_shift(2,65534),ue.write_shift(2,9),ue.write_shift(2,6),ve=0;ve<3;++ve)ue.write_shift(2,0);for(ue.write_shift(4,0),ue.write_shift(4,le[2]),ue.write_shift(4,le[0]+le[1]+le[2]+le[3]-1),ue.write_shift(4,0),ue.write_shift(4,4096),ue.write_shift(4,le[3]?le[0]+le[1]+le[2]-1:Be),ue.write_shift(4,le[3]),ue.write_shift(-4,le[1]?le[0]-1:Be),ue.write_shift(4,le[1]),ve=0;ve<109;++ve)ue.write_shift(-4,ve<le[2]?le[1]+ve:-1)}if(le[1])for(ke=0;ke<le[1];++ke){for(;ve<236+ke*127;++ve)ue.write_shift(-4,ve<le[2]?le[1]+ve:-1);ue.write_shift(-4,ke===le[1]-1?Be:ke+1)}var Ye=function(bt){for(ke+=bt;ve<ke-1;++ve)ue.write_shift(-4,ve+1);bt&&(++ve,ue.write_shift(-4,Be))};for(ke=ve=0,ke+=le[1];ve<ke;++ve)ue.write_shift(-4,ct.DIFSECT);for(ke+=le[2];ve<ke;++ve)ue.write_shift(-4,ct.FATSECT);Ye(le[3]),Ye(le[4]);for(var $e=0,Oe=0,ie=ee.FileIndex[0];$e<ee.FileIndex.length;++$e)ie=ee.FileIndex[$e],ie.content&&(Oe=ie.content.length,!(Oe<4096)&&(ie.start=ke,Ye(Oe+511>>9)));for(Ye(le[6]+7>>3);ue.l&511;)ue.write_shift(-4,ct.ENDOFCHAIN);for(ke=ve=0,$e=0;$e<ee.FileIndex.length;++$e)ie=ee.FileIndex[$e],ie.content&&(Oe=ie.content.length,!(!Oe||Oe>=4096)&&(ie.start=ke,Ye(Oe+63>>6)));for(;ue.l&511;)ue.write_shift(-4,ct.ENDOFCHAIN);for(ve=0;ve<le[4]<<2;++ve){var Me=ee.FullPaths[ve];if(!Me||Me.length===0){for($e=0;$e<17;++$e)ue.write_shift(4,0);for($e=0;$e<3;++$e)ue.write_shift(4,-1);for($e=0;$e<12;++$e)ue.write_shift(4,0);continue}ie=ee.FileIndex[ve],ve===0&&(ie.start=ie.size?ie.start-1:Be);var Qe=ve===0&&ae.root||ie.name;if(Oe=2*(Qe.length+1),ue.write_shift(64,Qe,"utf16le"),ue.write_shift(2,Oe),ue.write_shift(1,ie.type),ue.write_shift(1,ie.color),ue.write_shift(-4,ie.L),ue.write_shift(-4,ie.R),ue.write_shift(-4,ie.C),ie.clsid)ue.write_shift(16,ie.clsid,"hex");else for($e=0;$e<4;++$e)ue.write_shift(4,0);ue.write_shift(4,ie.state||0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,ie.start),ue.write_shift(4,ie.size),ue.write_shift(4,0)}for(ve=1;ve<ee.FileIndex.length;++ve)if(ie=ee.FileIndex[ve],ie.size>=4096)if(ue.l=ie.start+1<<9,kn&&Buffer.isBuffer(ie.content))ie.content.copy(ue,ue.l,0,ie.size),ue.l+=ie.size+511&-512;else{for($e=0;$e<ie.size;++$e)ue.write_shift(1,ie.content[$e]);for(;$e&511;++$e)ue.write_shift(1,0)}for(ve=1;ve<ee.FileIndex.length;++ve)if(ie=ee.FileIndex[ve],ie.size>0&&ie.size<4096)if(kn&&Buffer.isBuffer(ie.content))ie.content.copy(ue,ue.l,0,ie.size),ue.l+=ie.size+63&-64;else{for($e=0;$e<ie.size;++$e)ue.write_shift(1,ie.content[$e]);for(;$e&63;++$e)ue.write_shift(1,0)}if(kn)ue.l=ue.length;else for(;ue.l<ue.length;)ue.write_shift(1,0);return ue}function Re(ee,ge){var ae=ee.FullPaths.map(function($e){return $e.toUpperCase()}),le=ae.map(function($e){var Oe=$e.split("/");return Oe[Oe.length-($e.slice(-1)=="/"?2:1)]}),ue=!1;ge.charCodeAt(0)===47?(ue=!0,ge=ae[0].slice(0,-1)+ge):ue=ge.indexOf("/")!==-1;var ve=ge.toUpperCase(),ke=ue===!0?ae.indexOf(ve):le.indexOf(ve);if(ke!==-1)return ee.FileIndex[ke];var Ye=!ve.match(c2);for(ve=ve.replace(Ey,""),Ye&&(ve=ve.replace(c2,"!")),ke=0;ke<ae.length;++ke)if((Ye?ae[ke].replace(c2,"!"):ae[ke]).replace(Ey,"")==ve||(Ye?le[ke].replace(c2,"!"):le[ke]).replace(Ey,"")==ve)return ee.FileIndex[ke];return null}var Ie=64,Be=-2,lt="d0cf11e0a1b11ae1",pt=[208,207,17,224,161,177,26,225],Ct="00000000000000000000000000000000",ct={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Be,FREESECT:-1,HEADER_SIGNATURE:lt,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ct,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ue(ee,ge,ae){d();var le=de(ee,ae);h.writeFileSync(ge,le)}function Je(ee){for(var ge=new Array(ee.length),ae=0;ae<ee.length;++ae)ge[ae]=String.fromCharCode(ee[ae]);return ge.join("")}function Fe(ee,ge){var ae=de(ee,ge);switch(ge&&ge.type||"buffer"){case"file":return d(),h.writeFileSync(ge.filename,ae),ae;case"binary":return typeof ae=="string"?ae:Je(ae);case"base64":return yC(typeof ae=="string"?ae:Je(ae));case"buffer":if(kn)return Buffer.isBuffer(ae)?ae:mf(ae);case"array":return typeof ae=="string"?Rc(ae):ae}return ae}var A;function O(ee){try{var ge=ee.InflateRaw,ae=new ge;if(ae._processChunk(new Uint8Array([3,0]),ae._finishFlushFlag),ae.bytesRead)A=ee;else throw new Error("zlib does not expose bytesRead")}catch(le){console.error("cannot use native zlib: "+(le.message||le))}}function k(ee,ge){if(!A)return ot(ee,ge);var ae=A.InflateRaw,le=new ae,ue=le._processChunk(ee.slice(ee.l),le._finishFlushFlag);return ee.l+=le.bytesRead,ue}function L(ee){return A?A.deflateRawSync(ee):xi(ee)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(ee){var ge=(ee<<1|ee<<11)&139536|(ee<<5|ee<<15)&558144;return(ge>>16|ge>>8|ge)&255}for(var ye=typeof Uint8Array<"u",j=ye?new Uint8Array(256):[],X=0;X<256;++X)j[X]=pe(X);function te(ee,ge){var ae=j[ee&255];return ge<=8?ae>>>8-ge:(ae=ae<<8|j[ee>>8&255],ge<=16?ae>>>16-ge:(ae=ae<<8|j[ee>>16&255],ae>>>24-ge))}function we(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=6?0:ee[le+1]<<8))>>>ae&3}function ce(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=5?0:ee[le+1]<<8))>>>ae&7}function _e(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=4?0:ee[le+1]<<8))>>>ae&15}function Ee(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=3?0:ee[le+1]<<8))>>>ae&31}function he(ee,ge){var ae=ge&7,le=ge>>>3;return(ee[le]|(ae<=1?0:ee[le+1]<<8))>>>ae&127}function Ae(ee,ge,ae){var le=ge&7,ue=ge>>>3,ve=(1<<ae)-1,ke=ee[ue]>>>le;return ae<8-le||(ke|=ee[ue+1]<<8-le,ae<16-le)||(ke|=ee[ue+2]<<16-le,ae<24-le)||(ke|=ee[ue+3]<<24-le),ke&ve}function Ne(ee,ge,ae){var le=ge&7,ue=ge>>>3;return le<=5?ee[ue]|=(ae&7)<<le:(ee[ue]|=ae<<le&255,ee[ue+1]=(ae&7)>>8-le),ge+3}function Le(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae=(ae&1)<<le,ee[ue]|=ae,ge+1}function Xe(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae<<=le,ee[ue]|=ae&255,ae>>>=8,ee[ue+1]=ae,ge+8}function Ft(ee,ge,ae){var le=ge&7,ue=ge>>>3;return ae<<=le,ee[ue]|=ae&255,ae>>>=8,ee[ue+1]=ae&255,ee[ue+2]=ae>>>8,ge+16}function St(ee,ge){var ae=ee.length,le=2*ae>ge?2*ae:ge+5,ue=0;if(ae>=ge)return ee;if(kn){var ve=Pj(le);if(ee.copy)ee.copy(ve);else for(;ue<ee.length;++ue)ve[ue]=ee[ue];return ve}else if(ye){var ke=new Uint8Array(le);if(ke.set)ke.set(ee);else for(;ue<ae;++ue)ke[ue]=ee[ue];return ke}return ee.length=le,ee}function zt(ee){for(var ge=new Array(ee),ae=0;ae<ee;++ae)ge[ae]=0;return ge}function kr(ee,ge,ae){var le=1,ue=0,ve=0,ke=0,Ye=0,$e=ee.length,Oe=ye?new Uint16Array(32):zt(32);for(ve=0;ve<32;++ve)Oe[ve]=0;for(ve=$e;ve<ae;++ve)ee[ve]=0;$e=ee.length;var ie=ye?new Uint16Array($e):zt($e);for(ve=0;ve<$e;++ve)Oe[ue=ee[ve]]++,le<ue&&(le=ue),ie[ve]=0;for(Oe[0]=0,ve=1;ve<=le;++ve)Oe[ve+16]=Ye=Ye+Oe[ve-1]<<1;for(ve=0;ve<$e;++ve)Ye=ee[ve],Ye!=0&&(ie[ve]=Oe[Ye+16]++);var Me=0;for(ve=0;ve<$e;++ve)if(Me=ee[ve],Me!=0)for(Ye=te(ie[ve],le)>>le-Me,ke=(1<<le+4-Me)-1;ke>=0;--ke)ge[Ye|ke<<Me]=Me&15|ve<<4;return le}var xr=ye?new Uint16Array(512):zt(512),ir=ye?new Uint16Array(32):zt(32);if(!ye){for(var hr=0;hr<512;++hr)xr[hr]=0;for(hr=0;hr<32;++hr)ir[hr]=0}(function(){for(var ee=[],ge=0;ge<32;ge++)ee.push(5);kr(ee,ir,32);var ae=[];for(ge=0;ge<=143;ge++)ae.push(8);for(;ge<=255;ge++)ae.push(9);for(;ge<=279;ge++)ae.push(7);for(;ge<=287;ge++)ae.push(8);kr(ae,xr,288)})();var Hn=function(){for(var ge=ye?new Uint8Array(32768):[],ae=0,le=0;ae<Q.length-1;++ae)for(;le<Q[ae+1];++le)ge[le]=ae;for(;le<32768;++le)ge[le]=29;var ue=ye?new Uint8Array(259):[];for(ae=0,le=0;ae<K.length-1;++ae)for(;le<K[ae+1];++le)ue[le]=ae;function ve(Ye,$e){for(var Oe=0;Oe<Ye.length;){var ie=Math.min(65535,Ye.length-Oe),Me=Oe+ie==Ye.length;for($e.write_shift(1,+Me),$e.write_shift(2,ie),$e.write_shift(2,~ie&65535);ie-- >0;)$e[$e.l++]=Ye[Oe++]}return $e.l}function ke(Ye,$e){for(var Oe=0,ie=0,Me=ye?new Uint16Array(32768):[];ie<Ye.length;){var Qe=Math.min(65535,Ye.length-ie);if(Qe<10){for(Oe=Ne($e,Oe,+(ie+Qe==Ye.length)),Oe&7&&(Oe+=8-(Oe&7)),$e.l=Oe/8|0,$e.write_shift(2,Qe),$e.write_shift(2,~Qe&65535);Qe-- >0;)$e[$e.l++]=Ye[ie++];Oe=$e.l*8;continue}Oe=Ne($e,Oe,+(ie+Qe==Ye.length)+2);for(var bt=0;Qe-- >0;){var ut=Ye[ie];bt=(bt<<5^ut)&32767;var vt=-1,gr=0;if((vt=Me[bt])&&(vt|=ie&-32768,vt>ie&&(vt-=32768),vt<ie))for(;Ye[vt+gr]==Ye[ie+gr]&&gr<250;)++gr;if(gr>2){ut=ue[gr],ut<=22?Oe=Xe($e,Oe,j[ut+1]>>1)-1:(Xe($e,Oe,3),Oe+=5,Xe($e,Oe,j[ut-23]>>5),Oe+=3);var Er=ut<8?0:ut-4>>2;Er>0&&(Ft($e,Oe,gr-K[ut]),Oe+=Er),ut=ge[ie-vt],Oe=Xe($e,Oe,j[ut]>>3),Oe-=3;var Br=ut<4?0:ut-2>>1;Br>0&&(Ft($e,Oe,ie-vt-Q[ut]),Oe+=Br);for(var mn=0;mn<gr;++mn)Me[bt]=ie&32767,bt=(bt<<5^Ye[ie])&32767,++ie;Qe-=gr-1}else ut<=143?ut=ut+48:Oe=Le($e,Oe,1),Oe=Xe($e,Oe,j[ut]),Me[bt]=ie&32767,++ie}Oe=Xe($e,Oe,0)-1}return $e.l=(Oe+7)/8|0,$e.l}return function($e,Oe){return $e.length<8?ve($e,Oe):ke($e,Oe)}}();function xi(ee){var ge=rt(50+Math.floor(ee.length*1.1)),ae=Hn(ee,ge);return ge.slice(0,ae)}var qs=ye?new Uint16Array(32768):zt(32768),oi=ye?new Uint16Array(32768):zt(32768),Jn=ye?new Uint16Array(128):zt(128),$n=1,Lr=1;function Nr(ee,ge){var ae=Ee(ee,ge)+257;ge+=5;var le=Ee(ee,ge)+1;ge+=5;var ue=_e(ee,ge)+4;ge+=4;for(var ve=0,ke=ye?new Uint8Array(19):zt(19),Ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$e=1,Oe=ye?new Uint8Array(8):zt(8),ie=ye?new Uint8Array(8):zt(8),Me=ke.length,Qe=0;Qe<ue;++Qe)ke[D[Qe]]=ve=ce(ee,ge),$e<ve&&($e=ve),Oe[ve]++,ge+=3;var bt=0;for(Oe[0]=0,Qe=1;Qe<=$e;++Qe)ie[Qe]=bt=bt+Oe[Qe-1]<<1;for(Qe=0;Qe<Me;++Qe)(bt=ke[Qe])!=0&&(Ye[Qe]=ie[bt]++);var ut=0;for(Qe=0;Qe<Me;++Qe)if(ut=ke[Qe],ut!=0){bt=j[Ye[Qe]]>>8-ut;for(var vt=(1<<7-ut)-1;vt>=0;--vt)Jn[bt|vt<<ut]=ut&7|Qe<<3}var gr=[];for($e=1;gr.length<ae+le;)switch(bt=Jn[he(ee,ge)],ge+=bt&7,bt>>>=3){case 16:for(ve=3+we(ee,ge),ge+=2,bt=gr[gr.length-1];ve-- >0;)gr.push(bt);break;case 17:for(ve=3+ce(ee,ge),ge+=3;ve-- >0;)gr.push(0);break;case 18:for(ve=11+he(ee,ge),ge+=7;ve-- >0;)gr.push(0);break;default:gr.push(bt),$e<bt&&($e=bt);break}var Er=gr.slice(0,ae),Br=gr.slice(ae);for(Qe=ae;Qe<286;++Qe)Er[Qe]=0;for(Qe=le;Qe<30;++Qe)Br[Qe]=0;return $n=kr(Er,qs,286),Lr=kr(Br,oi,30),ge}function Ve(ee,ge){if(ee[0]==3&&!(ee[1]&3))return[Dg(ge),2];for(var ae=0,le=0,ue=Pj(ge||1<<18),ve=0,ke=ue.length>>>0,Ye=0,$e=0;!(le&1);){if(le=ce(ee,ae),ae+=3,le>>>1)le>>1==1?(Ye=9,$e=5):(ae=Nr(ee,ae),Ye=$n,$e=Lr);else{ae&7&&(ae+=8-(ae&7));var Oe=ee[ae>>>3]|ee[(ae>>>3)+1]<<8;if(ae+=32,Oe>0)for(!ge&&ke<ve+Oe&&(ue=St(ue,ve+Oe),ke=ue.length);Oe-- >0;)ue[ve++]=ee[ae>>>3],ae+=8;continue}for(;;){!ge&&ke<ve+32767&&(ue=St(ue,ve+32767),ke=ue.length);var ie=Ae(ee,ae,Ye),Me=le>>>1==1?xr[ie]:qs[ie];if(ae+=Me&15,Me>>>=4,!(Me>>>8&255))ue[ve++]=Me;else{if(Me==256)break;Me-=257;var Qe=Me<8?0:Me-4>>2;Qe>5&&(Qe=0);var bt=ve+K[Me];Qe>0&&(bt+=Ae(ee,ae,Qe),ae+=Qe),ie=Ae(ee,ae,$e),Me=le>>>1==1?ir[ie]:oi[ie],ae+=Me&15,Me>>>=4;var ut=Me<4?0:Me-2>>1,vt=Q[Me];for(ut>0&&(vt+=Ae(ee,ae,ut),ae+=ut),!ge&&ke<bt&&(ue=St(ue,bt+100),ke=ue.length);ve<bt;)ue[ve]=ue[ve-vt],++ve}}}return ge?[ue,ae+7>>>3]:[ue.slice(0,ve),ae+7>>>3]}function ot(ee,ge){var ae=ee.slice(ee.l||0),le=Ve(ae,ge);return ee.l+=le[1],le[0]}function It(ee,ge){if(ee)typeof console<"u"&&console.error(ge);else throw new Error(ge)}function ar(ee,ge){var ae=ee;Za(ae,0);var le=[],ue=[],ve={FileIndex:le,FullPaths:ue};Y(ve,{root:ge.root});for(var ke=ae.length-4;(ae[ke]!=80||ae[ke+1]!=75||ae[ke+2]!=5||ae[ke+3]!=6)&&ke>=0;)--ke;ae.l=ke+4,ae.l+=4;var Ye=ae.read_shift(2);ae.l+=6;var $e=ae.read_shift(4);for(ae.l=$e,ke=0;ke<Ye;++ke){ae.l+=20;var Oe=ae.read_shift(4),ie=ae.read_shift(4),Me=ae.read_shift(2),Qe=ae.read_shift(2),bt=ae.read_shift(2);ae.l+=8;var ut=ae.read_shift(4),vt=l(ae.slice(ae.l+Me,ae.l+Me+Qe));ae.l+=Me+Qe+bt;var gr=ae.l;ae.l=ut+4,Oi(ae,Oe,ie,ve,vt),ae.l=gr}return ve}function Oi(ee,ge,ae,le,ue){ee.l+=2;var ve=ee.read_shift(2),ke=ee.read_shift(2),Ye=o(ee);if(ve&8257)throw new Error("Unsupported ZIP encryption");for(var $e=ee.read_shift(4),Oe=ee.read_shift(4),ie=ee.read_shift(4),Me=ee.read_shift(2),Qe=ee.read_shift(2),bt="",ut=0;ut<Me;++ut)bt+=String.fromCharCode(ee[ee.l++]);if(Qe){var vt=l(ee.slice(ee.l,ee.l+Qe));(vt[21589]||{}).mt&&(Ye=vt[21589].mt),((ue||{})[21589]||{}).mt&&(Ye=ue[21589].mt)}ee.l+=Qe;var gr=ee.slice(ee.l,ee.l+Oe);switch(ke){case 8:gr=k(ee,ie);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Er=!1;ve&8&&($e=ee.read_shift(4),$e==134695760&&($e=ee.read_shift(4),Er=!0),Oe=ee.read_shift(4),ie=ee.read_shift(4)),Oe!=ge&&It(Er,"Bad compressed size: "+ge+" != "+Oe),ie!=ae&&It(Er,"Bad uncompressed size: "+ae+" != "+ie),hi(le,bt,gr,{unsafe:!0,mt:Ye})}function Ur(ee,ge){var ae=ge||{},le=[],ue=[],ve=rt(1),ke=ae.compression?8:0,Ye=0,$e=0,Oe=0,ie=0,Me=0,Qe=ee.FullPaths[0],bt=Qe,ut=ee.FileIndex[0],vt=[],gr=0;for($e=1;$e<ee.FullPaths.length;++$e)if(bt=ee.FullPaths[$e].slice(Qe.length),ut=ee.FileIndex[$e],!(!ut.size||!ut.content||bt=="Sh33tJ5")){var Er=ie,Br=rt(bt.length);for(Oe=0;Oe<bt.length;++Oe)Br.write_shift(1,bt.charCodeAt(Oe)&127);Br=Br.slice(0,Br.l),vt[Me]=pBe.buf(ut.content,0);var mn=ut.content;ke==8&&(mn=L(mn)),ve=rt(30),ve.write_shift(4,67324752),ve.write_shift(2,20),ve.write_shift(2,Ye),ve.write_shift(2,ke),ut.mt?n(ve,ut.mt):ve.write_shift(4,0),ve.write_shift(-4,vt[Me]),ve.write_shift(4,mn.length),ve.write_shift(4,ut.content.length),ve.write_shift(2,Br.length),ve.write_shift(2,0),ie+=ve.length,le.push(ve),ie+=Br.length,le.push(Br),ie+=mn.length,le.push(mn),ve=rt(46),ve.write_shift(4,33639248),ve.write_shift(2,0),ve.write_shift(2,20),ve.write_shift(2,Ye),ve.write_shift(2,ke),ve.write_shift(4,0),ve.write_shift(-4,vt[Me]),ve.write_shift(4,mn.length),ve.write_shift(4,ut.content.length),ve.write_shift(2,Br.length),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(4,0),ve.write_shift(4,Er),gr+=ve.l,ue.push(ve),gr+=Br.length,ue.push(Br),++Me}return ve=rt(22),ve.write_shift(4,101010256),ve.write_shift(2,0),ve.write_shift(2,0),ve.write_shift(2,Me),ve.write_shift(2,Me),ve.write_shift(4,gr),ve.write_shift(4,ie),ve.write_shift(2,0),oo([oo(le),oo(ue),ve])}var Bo={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zt(ee,ge){if(ee.ctype)return ee.ctype;var ae=ee.name||"",le=ae.match(/\.([^\.]+)$/);return le&&Bo[le[1]]||ge&&(le=(ae=ge).match(/[\.\\]([^\.\\])+$/),le&&Bo[le[1]])?Bo[le[1]]:"application/octet-stream"}function ji(ee){for(var ge=yC(ee),ae=[],le=0;le<ge.length;le+=76)ae.push(ge.slice(le,le+76));return ae.join(`\r
`)+`\r
`}function da(ee){var ge=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Oe){var ie=Oe.charCodeAt(0).toString(16).toUpperCase();return"="+(ie.length==1?"0"+ie:ie)});ge=ge.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ge.charAt(0)==`
`&&(ge="=0D"+ge.slice(1)),ge=ge.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ae=[],le=ge.split(`\r
`),ue=0;ue<le.length;++ue){var ve=le[ue];if(ve.length==0){ae.push("");continue}for(var ke=0;ke<ve.length;){var Ye=76,$e=ve.slice(ke,ke+Ye);$e.charAt(Ye-1)=="="?Ye--:$e.charAt(Ye-2)=="="?Ye-=2:$e.charAt(Ye-3)=="="&&(Ye-=3),$e=ve.slice(ke,ke+Ye),ke+=Ye,ke<ve.length&&($e+="="),ae.push($e)}}return ae.join(`\r
`)}function ai(ee){for(var ge=[],ae=0;ae<ee.length;++ae){for(var le=ee[ae];ae<=ee.length&&le.charAt(le.length-1)=="=";)le=le.slice(0,le.length-1)+ee[++ae];ge.push(le)}for(var ue=0;ue<ge.length;++ue)ge[ue]=ge[ue].replace(/[=][0-9A-Fa-f]{2}/g,function(ve){return String.fromCharCode(parseInt(ve.slice(1),16))});return Rc(ge.join(`\r
`))}function Wd(ee,ge,ae){for(var le="",ue="",ve="",ke,Ye=0;Ye<10;++Ye){var $e=ge[Ye];if(!$e||$e.match(/^\s*$/))break;var Oe=$e.match(/^(.*?):\s*([^\s].*)$/);if(Oe)switch(Oe[1].toLowerCase()){case"content-location":le=Oe[2].trim();break;case"content-type":ve=Oe[2].trim();break;case"content-transfer-encoding":ue=Oe[2].trim();break}}switch(++Ye,ue.toLowerCase()){case"base64":ke=Rc(of(ge.slice(Ye).join("")));break;case"quoted-printable":ke=ai(ge.slice(Ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ue)}var ie=hi(ee,le.slice(ae.length),ke,{unsafe:!0});ve&&(ie.ctype=ve)}function Gc(ee,ge){if(Je(ee.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ae=ge&&ge.root||"",le=(kn&&Buffer.isBuffer(ee)?ee.toString("binary"):Je(ee)).split(`\r
`),ue=0,ve="";for(ue=0;ue<le.length;++ue)if(ve=le[ue],!!/^Content-Location:/i.test(ve)&&(ve=ve.slice(ve.indexOf("file")),ae||(ae=ve.slice(0,ve.lastIndexOf("/")+1)),ve.slice(0,ae.length)!=ae))for(;ae.length>0&&(ae=ae.slice(0,ae.length-1),ae=ae.slice(0,ae.lastIndexOf("/")+1),ve.slice(0,ae.length)!=ae););var ke=(le[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Ye="--"+(ke[1]||""),$e=[],Oe=[],ie={FileIndex:$e,FullPaths:Oe};Y(ie);var Me,Qe=0;for(ue=0;ue<le.length;++ue){var bt=le[ue];bt!==Ye&&bt!==Ye+"--"||(Qe++&&Wd(ie,le.slice(Me,ue),ae),Me=ue)}return ie}function eh(ee,ge){var ae=ge||{},le=ae.boundary||"SheetJS";le="------="+le;for(var ue=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+le.slice(2)+'"',"","",""],ve=ee.FullPaths[0],ke=ve,Ye=ee.FileIndex[0],$e=1;$e<ee.FullPaths.length;++$e)if(ke=ee.FullPaths[$e].slice(ve.length),Ye=ee.FileIndex[$e],!(!Ye.size||!Ye.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gr){return"_x"+gr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gr){return"_u"+gr.charCodeAt(0).toString(16)+"_"});for(var Oe=Ye.content,ie=kn&&Buffer.isBuffer(Oe)?Oe.toString("binary"):Je(Oe),Me=0,Qe=Math.min(1024,ie.length),bt=0,ut=0;ut<=Qe;++ut)(bt=ie.charCodeAt(ut))>=32&&bt<128&&++Me;var vt=Me>=Qe*4/5;ue.push(le),ue.push("Content-Location: "+(ae.root||"file:///C:/SheetJS/")+ke),ue.push("Content-Transfer-Encoding: "+(vt?"quoted-printable":"base64")),ue.push("Content-Type: "+Zt(Ye,ke)),ue.push(""),ue.push(vt?da(ie):ji(ie))}return ue.push(le+`--\r
`),ue.join(`\r
`)}function th(ee){var ge={};return Y(ge,ee),ge}function hi(ee,ge,ae,le){var ue=le&&le.unsafe;ue||Y(ee);var ve=!ue&&ti.find(ee,ge);if(!ve){var ke=ee.FullPaths[0];ge.slice(0,ke.length)==ke?ke=ge:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+ge).replace("//","/")),ve={name:s(ge),type:2},ee.FileIndex.push(ve),ee.FullPaths.push(ke),ue||ti.utils.cfb_gc(ee)}return ve.content=ae,ve.size=ae?ae.length:0,le&&(le.CLSID&&(ve.clsid=le.CLSID),le.mt&&(ve.mt=le.mt),le.ct&&(ve.ct=le.ct)),ve}function Js(ee,ge){Y(ee);var ae=ti.find(ee,ge);if(ae){for(var le=0;le<ee.FileIndex.length;++le)if(ee.FileIndex[le]==ae)return ee.FileIndex.splice(le,1),ee.FullPaths.splice(le,1),!0}return!1}function pf(ee,ge,ae){Y(ee);var le=ti.find(ee,ge);if(le){for(var ue=0;ue<ee.FileIndex.length;++ue)if(ee.FileIndex[ue]==le)return ee.FileIndex[ue].name=s(ae),ee.FullPaths[ue]=ae,!0}return!1}function jd(ee){me(ee,!0)}return e.find=Re,e.read=re,e.parse=g,e.write=Fe,e.writeFile=Ue,e.utils={cfb_new:th,cfb_add:hi,cfb_del:Js,cfb_mov:pf,cfb_gc:jd,ReadShift:_y,CheckField:Cee,prep_blob:Za,bconcat:oo,use_zlib:O,_deflateRaw:xi,_inflateRaw:ot,consts:ct},e}();function vBe(t){return typeof t=="string"?gR(t):Array.isArray(t)?j9e(t):t}function dS(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=gR(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var i=r=="utf8"?SC(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,t);if(typeof Blob<"u"){var s=new Blob([vBe(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var n=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),chrome.downloads.download({url:n,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(n)},6e4),n}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(e)&&(e=fS(e)),l.write(e),l.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function fo(t){for(var e=Object.keys(t),r=[],i=0;i<e.length;++i)Object.prototype.hasOwnProperty.call(t,e[i])&&r.push(e[i]);return r}function $j(t,e){for(var r=[],i=fo(t),s=0;s!==i.length;++s)r[t[i[s]][e]]==null&&(r[t[i[s]][e]]=i[s]);return r}function H6(t){for(var e=[],r=fo(t),i=0;i!==r.length;++i)e[t[r[i]]]=r[i];return e}function vR(t){for(var e=[],r=fo(t),i=0;i!==r.length;++i)e[t[r[i]]]=parseInt(r[i],10);return e}function wBe(t){for(var e=[],r=fo(t),i=0;i!==r.length;++i)e[t[r[i]]]==null&&(e[t[r[i]]]=[]),e[t[r[i]]].push(r[i]);return e}var $T=new Date(1899,11,30,0,0,0);function Na(t,e){var r=t.getTime(),i=$T.getTime()+(t.getTimezoneOffset()-$T.getTimezoneOffset())*6e4;return(r-i)/(24*60*60*1e3)}var nee=new Date,yBe=$T.getTime()+(nee.getTimezoneOffset()-$T.getTimezoneOffset())*6e4,Bj=nee.getTimezoneOffset();function iee(t){var e=new Date;return e.setTime(t*24*60*60*1e3+yBe),e.getTimezoneOffset()!==Bj&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Bj)*6e4),e}var Vj=new Date("2017-02-19T19:06:09.000Z"),see=isNaN(Vj.getFullYear())?new Date("2/19/17"):Vj,CBe=see.getFullYear()==2017;function oa(t,e){var r=new Date(t);if(CBe)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(see.getFullYear()==1917&&!isNaN(r.getFullYear())){var i=r.getFullYear();return t.indexOf(""+i)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function wR(t,e){if(kn&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(n){return r[n]||n})}catch{}for(var i=[],s=0;s!=t.length;++s)i.push(String.fromCharCode(t[s]));return i.join("")}function Da(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Da(t[r]));return e}function Qi(t,e){for(var r="";r.length<e;)r+=t;return r}function Kh(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,i=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(i))||(i=i.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(e=Number(i)))?e/r:e}var SBe=["january","february","march","april","may","june","july","august","september","october","november","december"];function CC(t){var e=new Date(t),r=new Date(NaN),i=e.getYear(),s=e.getMonth(),n=e.getDate();if(isNaN(n))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&SBe.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return i<0||i>8099?r:(s>0||n>1)&&i!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function Jr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var i;return kn?i=mf(r):i=U9e(r),ti.utils.cfb_add(t,e,i)}ti.utils.cfb_add(t,e,r)}else t.file(e,r)}function $6(){return ti.utils.cfb_new()}var Es=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bBe={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},B6=H6(bBe),V6=/[&<>'"]/g,xBe=/[\u0000-\u0008\u000b-\u001f]/g;function Yn(t){var e=t+"";return e.replace(V6,function(r){return B6[r]}).replace(xBe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Wj(t){return Yn(t).replace(/ /g,"_x0020_")}var oee=/[\u0000-\u001f]/g;function EBe(t){var e=t+"";return e.replace(V6,function(r){return B6[r]}).replace(/\n/g,"<br/>").replace(oee,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function TBe(t){var e=t+"";return e.replace(V6,function(r){return B6[r]}).replace(oee,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function _Be(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function RBe(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function d3(t){for(var e="",r=0,i=0,s=0,n=0,o=0,l=0;r<t.length;){if(i=t.charCodeAt(r++),i<128){e+=String.fromCharCode(i);continue}if(s=t.charCodeAt(r++),i>191&&i<224){o=(i&31)<<6,o|=s&63,e+=String.fromCharCode(o);continue}if(n=t.charCodeAt(r++),i<240){e+=String.fromCharCode((i&15)<<12|(s&63)<<6|n&63);continue}o=t.charCodeAt(r++),l=((i&7)<<18|(s&63)<<12|(n&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(l>>>10&1023)),e+=String.fromCharCode(56320+(l&1023))}return e}function jj(t){var e=Dg(2*t.length),r,i,s=1,n=0,o=0,l;for(i=0;i<t.length;i+=s)s=1,(l=t.charCodeAt(i))<128?r=l:l<224?(r=(l&31)*64+(t.charCodeAt(i+1)&63),s=2):l<240?(r=(l&15)*4096+(t.charCodeAt(i+1)&63)*64+(t.charCodeAt(i+2)&63),s=3):(s=4,r=(l&7)*262144+(t.charCodeAt(i+1)&63)*4096+(t.charCodeAt(i+2)&63)*64+(t.charCodeAt(i+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[n++]=o&255,e[n++]=o>>>8,o=0),e[n++]=r%256,e[n++]=r>>>8;return e.slice(0,n).toString("ucs2")}function Uj(t){return mf(t,"binary").toString("utf8")}var h2="foo bar baz",Ty=kn&&(Uj(h2)==d3(h2)&&Uj||jj(h2)==d3(h2)&&jj)||d3,SC=kn?function(t){return mf(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,i=0,s=0;r<t.length;)switch(i=t.charCodeAt(r++),!0){case i<128:e.push(String.fromCharCode(i));break;case i<2048:e.push(String.fromCharCode(192+(i>>6))),e.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,s=t.charCodeAt(r++)-56320+(i<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(i>>12))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)))}return e.join("")},ABe=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var i=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)i=i.replace(t[s][0],t[s][1]);return i}}(),aee=/(^\s|\s$|\n)/;function ao(t,e){return"<"+t+(e.match(aee)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function bC(t){return fo(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function kt(t,e,r){return"<"+t+(r!=null?bC(r):"")+(e!=null?(e.match(aee)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function WF(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function OBe(t,e){switch(typeof t){case"string":var r=kt("vt:lpwstr",Yn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return kt((t|0)==t?"vt:i4":"vt:r8",Yn(String(t)));case"boolean":return kt("vt:bool",t?"true":"false")}if(t instanceof Date)return kt("vt:filetime",WF(t));throw new Error("Unable to serialize "+t)}var Gs={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$1=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],el={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IBe(t,e){for(var r=1-2*(t[e+7]>>>7),i=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,n=5;n>=0;--n)s=s*256+t[e+n];return i==2047?s==0?r*(1/0):NaN:(i==0?i=-1022:(i-=1023,s+=Math.pow(2,52)),r*Math.pow(2,i-52)*s)}function PBe(t,e,r){var i=(e<0||1/e==-1/0?1:0)<<7,s=0,n=0,o=i?-e:e;isFinite(o)?o==0?s=n=0:(s=Math.floor(Math.log(o)/Math.LN2),n=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(e)?26985:0);for(var l=0;l<=5;++l,n/=256)t[r+l]=n&255;t[r+6]=(s&15)<<4|n&15,t[r+7]=s>>4|i}var zj=function(t){for(var e=[],r=10240,i=0;i<t[0].length;++i)if(t[0][i])for(var s=0,n=t[0][i].length;s<n;s+=r)e.push.apply(e,t[0][i].slice(s,s+r));return e},Gj=kn?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:mf(e)})):zj(t)}:zj,Yj=function(t,e,r){for(var i=[],s=e;s<r;s+=2)i.push(String.fromCharCode(Gw(t,s)));return i.join("").replace(Ey,"")},W6=kn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Ey,""):Yj(t,e,r)}:Yj,Kj=function(t,e,r){for(var i=[],s=e;s<e+r;++s)i.push(("0"+t[s].toString(16)).slice(-2));return i.join("")},lee=kn?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Kj(t,e,r)}:Kj,Xj=function(t,e,r){for(var i=[],s=e;s<r;s++)i.push(String.fromCharCode(gp(t,s)));return i.join("")},gS=kn?function(e,r,i){return Buffer.isBuffer(e)?e.toString("utf8",r,i):Xj(e,r,i)}:Xj,cee=function(t,e){var r=tl(t,e);return r>0?gS(t,e+4,e+4+r-1):""},uee=cee,hee=function(t,e){var r=tl(t,e);return r>0?gS(t,e+4,e+4+r-1):""},fee=hee,dee=function(t,e){var r=2*tl(t,e);return r>0?gS(t,e+4,e+4+r-1):""},gee=dee,mee=function(e,r){var i=tl(e,r);return i>0?W6(e,r+4,r+4+i):""},pee=mee,vee=function(t,e){var r=tl(t,e);return r>0?gS(t,e+4,e+4+r):""},wee=vee,yee=function(t,e){return IBe(t,e)},BT=yee,j6=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};kn&&(uee=function(e,r){if(!Buffer.isBuffer(e))return cee(e,r);var i=e.readUInt32LE(r);return i>0?e.toString("utf8",r+4,r+4+i-1):""},fee=function(e,r){if(!Buffer.isBuffer(e))return hee(e,r);var i=e.readUInt32LE(r);return i>0?e.toString("utf8",r+4,r+4+i-1):""},gee=function(e,r){if(!Buffer.isBuffer(e))return dee(e,r);var i=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+i-1)},pee=function(e,r){if(!Buffer.isBuffer(e))return mee(e,r);var i=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+i)},wee=function(e,r){if(!Buffer.isBuffer(e))return vee(e,r);var i=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+i)},BT=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):yee(e,r)},j6=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var gp=function(t,e){return t[e]},Gw=function(t,e){return t[e+1]*256+t[e]},FBe=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},tl=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},eg=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},MBe=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function _y(t,e){var r="",i,s,n=[],o,l,h,d;switch(e){case"dbcs":if(d=this.l,kn&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Gw(this,d)),d+=2;t*=2;break;case"utf8":r=gS(this,this.l,this.l+t);break;case"utf16le":t*=2,r=W6(this,this.l,this.l+t);break;case"wstr":return _y.call(this,t,"dbcs");case"lpstr-ansi":r=uee(this,this.l),t=4+tl(this,this.l);break;case"lpstr-cp":r=fee(this,this.l),t=4+tl(this,this.l);break;case"lpwstr":r=gee(this,this.l),t=4+2*tl(this,this.l);break;case"lpp4":t=4+tl(this,this.l),r=pee(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+tl(this,this.l),r=wee(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=gp(this,this.l+t++))!==0;)n.push(l2(o));r=n.join("");break;case"_wstr":for(t=0,r="";(o=Gw(this,this.l+t))!==0;)n.push(l2(o)),t+=2;t+=2,r=n.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=gp(this,d),this.l=d+1,l=_y.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),n.join("")+l;n.push(l2(Gw(this,d))),d+=2}r=n.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return o=gp(this,d),this.l=d+1,l=_y.call(this,t-h,o?"dbcs-cont":"sbcs-cont"),n.join("")+l;n.push(l2(gp(this,d))),d+=1}r=n.join("");break;default:switch(t){case 1:return i=gp(this,this.l),this.l++,i;case 2:return i=(e==="i"?FBe:Gw)(this,this.l),this.l+=2,i;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(i=(t>0?eg:MBe)(this,this.l),this.l+=4,i):(s=tl(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=BT(this,this.l):s=BT([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=lee(this,this.l,t);break}}return this.l+=t,r}var kBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},NBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},DBe=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function LBe(t,e,r){var i=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)DBe(this,e.charCodeAt(s),this.l+2*s);i=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;i=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var o=e.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(t){case 1:i=1,this[this.l]=e&255;break;case 2:i=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:i=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:i=4,kBe(this,e,this.l);break;case 8:if(i=8,r==="f"){PBe(this,e,this.l);break}case 16:break;case-4:i=4,NBe(this,e,this.l);break}return this.l+=i,this}function Cee(t,e){var r=lee(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Za(t,e){t.l=e,t.read_shift=_y,t.chk=Cee,t.write_shift=LBe}function Gu(t,e){t.l+=e}function rt(t){var e=Dg(t);return Za(e,0),e}function Ma(){var t=[],e=kn?256:2048,r=function(d){var g=rt(d);return Za(g,0),g},i=r(e),s=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i),i=null)},n=function(d){return i&&d<i.length-i.l?i:(s(),i=r(Math.max(d+1,e)))},o=function(){return s(),oo(t)},l=function(d){s(),i=d,i.l==null&&(i.l=i.length),n(e)};return{next:n,push:l,end:o,_bufs:t}}function dt(t,e,r,i){var s=+e,n;if(!isNaN(s)){i||(i=IGe[s].p||(r||[]).length||0),n=1+(s>=128?1:0)+1,i>=128&&++n,i>=16384&&++n,i>=2097152&&++n;var o=t.next(n);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(i>=128)o.write_shift(1,(i&127)+128),i>>=7;else{o.write_shift(1,i);break}i>0&&j6(r)&&t.push(r)}}function Ry(t,e,r){var i=Da(t);if(e.s?(i.cRel&&(i.c+=e.s.c),i.rRel&&(i.r+=e.s.r)):(i.cRel&&(i.c+=e.c),i.rRel&&(i.r+=e.r)),!r||r.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function qj(t,e,r){var i=Da(t);return i.s=Ry(i.s,e.s,r),i.e=Ry(i.e,e.s,r),i}function Ay(t,e){if(t.cRel&&t.c<0)for(t=Da(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Da(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Xn(t);return!t.cRel&&t.cRel!=null&&(r=BBe(r)),!t.rRel&&t.rRel!=null&&(r=HBe(r)),r}function g3(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Do(t.s.c)+":"+(t.e.cRel?"":"$")+Do(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+uo(t.s.r)+":"+(t.e.rRel?"":"$")+uo(t.e.r):Ay(t.s,e.biff)+":"+Ay(t.e,e.biff)}function U6(t){return parseInt($Be(t),10)-1}function uo(t){return""+(t+1)}function HBe(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $Be(t){return t.replace(/\$(\d+)$/,"$1")}function z6(t){for(var e=VBe(t),r=0,i=0;i!==e.length;++i)r=26*r+e.charCodeAt(i)-64;return r-1}function Do(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function BBe(t){return t.replace(/^([A-Z])/,"$$$1")}function VBe(t){return t.replace(/^\$([A-Z])/,"$1")}function WBe(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ys(t){for(var e=0,r=0,i=0;i<t.length;++i){var s=t.charCodeAt(i);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Xn(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function cl(t){var e=t.indexOf(":");return e==-1?{s:Ys(t),e:Ys(t)}:{s:Ys(t.slice(0,e)),e:Ys(t.slice(e+1))}}function ys(t,e){return typeof e>"u"||typeof e=="number"?ys(t.s,t.e):(typeof t!="string"&&(t=Xn(t)),typeof e!="string"&&(e=Xn(e)),t==e?t:t+":"+e)}function Si(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,i=0,s=0,n=t.length;for(r=0;i<n&&!((s=t.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(e.s.c=--r,r=0;i<n&&!((s=t.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;if(e.s.r=--r,i===n||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++i,r=0;i!=n&&!((s=t.charCodeAt(i)-64)<1||s>26);++i)r=26*r+s;for(e.e.c=--r,r=0;i!=n&&!((s=t.charCodeAt(i)-48)<0||s>9);++i)r=10*r+s;return e.e.r=--r,e}function Jj(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Pd(t.z,r?Na(e):e)}catch{}try{return t.w=Pd((t.XF||{}).numFmtId||(r?14:0),r?Na(e):e)}catch{return""+e}}function af(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?mS[t.v]||t.v:e==null?Jj(t,t.v):Jj(t,e))}function Qg(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",i={};return i[r]=t,{SheetNames:[r],Sheets:i}}function See(t,e,r){var i=r||{},s=t?Array.isArray(t):i.dense,n=t||(s?[]:{}),o=0,l=0;if(n&&i.origin!=null){if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?Ys(i.origin):i.origin;o=h.r,l=h.c}n["!ref"]||(n["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var g=Si(n["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(d.e.r=o=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var C=0;C!=e[y].length;++C)if(!(typeof e[y][C]>"u")){var x={v:e[y][C]},_=o+y,E=l+C;if(d.s.r>_&&(d.s.r=_),d.s.c>E&&(d.s.c=E),d.e.r<_&&(d.e.r=_),d.e.c<E&&(d.e.c=E),e[y][C]&&typeof e[y][C]=="object"&&!Array.isArray(e[y][C])&&!(e[y][C]instanceof Date))x=e[y][C];else if(Array.isArray(x.v)&&(x.f=e[y][C][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(i.nullError)x.t="e",x.v=0;else if(i.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=i.dateNF||ts[14],i.cellDates?(x.t="d",x.w=Pd(x.z,Na(x.v))):(x.t="n",x.v=Na(x.v),x.w=Pd(x.z,x.v))):x.t="s";if(s)n[_]||(n[_]=[]),n[_][E]&&n[_][E].z&&(x.z=n[_][E].z),n[_][E]=x;else{var R=Xn({c:E,r:_});n[R]&&n[R].z&&(x.z=n[R].z),n[R]=x}}}return d.s.c<1e7&&(n["!ref"]=ys(d)),n}function B1(t,e){return See(null,t,e)}function jBe(t){return t.read_shift(4,"i")}function kc(t,e){return e||(e=rt(4)),e.write_shift(4,t),e}function Lo(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Ks(t,e){var r=!1;return e==null&&(r=!0,e=rt(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function UBe(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zBe(t,e){return e||(e=rt(4)),e.write_shift(2,0),e.write_shift(2,0),e}function G6(t,e){var r=t.l,i=t.read_shift(1),s=Lo(t),n=[],o={t:s,h:s};if(i&1){for(var l=t.read_shift(4),h=0;h!=l;++h)n.push(UBe(t));o.r=n}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function GBe(t,e){var r=!1;return e==null&&(r=!0,e=rt(15+4*t.t.length)),e.write_shift(1,0),Ks(t.t,e),r?e.slice(0,e.l):e}var YBe=G6;function KBe(t,e){var r=!1;return e==null&&(r=!0,e=rt(23+4*t.t.length)),e.write_shift(1,1),Ks(t.t,e),e.write_shift(4,1),zBe({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function Jl(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Zg(t,e){return e==null&&(e=rt(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function em(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function tm(t,e){return e==null&&(e=rt(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var XBe=Lo,bee=Ks;function Y6(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function VT(t,e){var r=!1;return e==null&&(r=!0,e=rt(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var qBe=Lo,jF=Y6,K6=VT;function xee(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,i=e[0]&2;t.l+=4;var s=i===0?BT([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):eg(e,0)>>2;return r?s/100:s}function Eee(t,e){e==null&&(e=rt(4));var r=0,i=0,s=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?i=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(i=1,r=1),i)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function Tee(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function JBe(t,e){return e||(e=rt(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var rm=Tee,V1=JBe;function W1(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Lg(t,e){return(e||rt(8)).write_shift(8,t,"f")}function QBe(t){var e={},r=t.read_shift(1),i=r>>>1,s=t.read_shift(1),n=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),h=t.read_shift(1);switch(t.l++,i){case 0:e.auto=1;break;case 1:e.index=s;var d=aVe[s];d&&(e.rgb=lU(d));break;case 2:e.rgb=lU([o,l,h]);break;case 3:e.theme=s;break}return n!=0&&(e.tint=n>0?n/32767:n/32768),e}function WT(t,e){if(e||(e=rt(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var i=t.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),e.write_shift(1,parseInt(i.slice(0,2),16)),e.write_shift(1,parseInt(i.slice(2,4),16)),e.write_shift(1,parseInt(i.slice(4,6),16)),e.write_shift(1,255)}return e}function ZBe(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function eVe(t,e){e||(e=rt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var _ee=2,qa=3,f2=11,jT=19,d2=64,tVe=65,rVe=71,nVe=4108,iVe=4126,so=80,Qj={1:{n:"CodePage",t:_ee},2:{n:"Category",t:so},3:{n:"PresentationFormat",t:so},4:{n:"ByteCount",t:qa},5:{n:"LineCount",t:qa},6:{n:"ParagraphCount",t:qa},7:{n:"SlideCount",t:qa},8:{n:"NoteCount",t:qa},9:{n:"HiddenCount",t:qa},10:{n:"MultimediaClipCount",t:qa},11:{n:"ScaleCrop",t:f2},12:{n:"HeadingPairs",t:nVe},13:{n:"TitlesOfParts",t:iVe},14:{n:"Manager",t:so},15:{n:"Company",t:so},16:{n:"LinksUpToDate",t:f2},17:{n:"CharacterCount",t:qa},19:{n:"SharedDoc",t:f2},22:{n:"HyperlinksChanged",t:f2},23:{n:"AppVersion",t:qa,p:"version"},24:{n:"DigSig",t:tVe},26:{n:"ContentType",t:so},27:{n:"ContentStatus",t:so},28:{n:"Language",t:so},29:{n:"Version",t:so},255:{},2147483648:{n:"Locale",t:jT},2147483651:{n:"Behavior",t:jT},1919054434:{}},Zj={1:{n:"CodePage",t:_ee},2:{n:"Title",t:so},3:{n:"Subject",t:so},4:{n:"Author",t:so},5:{n:"Keywords",t:so},6:{n:"Comments",t:so},7:{n:"Template",t:so},8:{n:"LastAuthor",t:so},9:{n:"RevNumber",t:so},10:{n:"EditTime",t:d2},11:{n:"LastPrinted",t:d2},12:{n:"CreatedDate",t:d2},13:{n:"ModifiedDate",t:d2},14:{n:"PageCount",t:qa},15:{n:"WordCount",t:qa},16:{n:"CharCount",t:qa},17:{n:"Thumbnail",t:rVe},18:{n:"Application",t:so},19:{n:"DocSecurity",t:qa},255:{},2147483648:{n:"Locale",t:jT},2147483651:{n:"Behavior",t:jT},1919054434:{}};function sVe(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var oVe=sVe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),aVe=Da(oVe),mS={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lVe={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},g2={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ree(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Aee(t,e){var r=wBe(lVe),i=[],s;i[i.length]=Es,i[i.length]=kt("Types",null,{xmlns:Gs.CT,"xmlns:xsd":Gs.xsd,"xmlns:xsi":Gs.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return kt("Default",null,{Extension:h[0],ContentType:h[1]})}));var n=function(h){t[h]&&t[h].length>0&&(s=t[h][0],i[i.length]=kt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:g2[h][e.bookType]||g2[h].xlsx}))},o=function(h){(t[h]||[]).forEach(function(d){i[i.length]=kt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:g2[h][e.bookType]||g2[h].xlsx})})},l=function(h){(t[h]||[]).forEach(function(d){i[i.length]=kt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return n("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(n),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var _n={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Oee(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Jp(t){var e=[Es,kt("Relationships",null,{xmlns:Gs.RELS})];return fo(t["!id"]).forEach(function(r){e[e.length]=kt("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Gn(t,e,r,i,s,n){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=i,s.Target=r,[_n.HLINK,_n.XPATH,_n.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}function cVe(t){var e=[Es];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function eU(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function uVe(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function hVe(t){var e=[Es];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(eU(t[r][0],t[r][1])),e.push(uVe("",t[r][0]));return e.push(eU("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function Iee(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kT.version+"</meta:generator></office:meta></office:document-meta>"}var wg=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function m3(t,e,r,i,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Yn(e),i[i.length]=r?kt(t,e,r):ao(t,e))}function Pee(t,e){var r=e||{},i=[Es,kt("cp:coreProperties",null,{"xmlns:cp":Gs.CORE_PROPS,"xmlns:dc":Gs.dc,"xmlns:dcterms":Gs.dcterms,"xmlns:dcmitype":Gs.dcmitype,"xmlns:xsi":Gs.xsi})],s={};if(!t&&!r.Props)return i.join("");t&&(t.CreatedDate!=null&&m3("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:WF(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s),t.ModifiedDate!=null&&m3("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:WF(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},i,s));for(var n=0;n!=wg.length;++n){var o=wg[n],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&m3(o[0],l,null,i,s)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var Qp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Fee=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Mee(t){var e=[],r=kt;return t||(t={}),t.Application="SheetJS",e[e.length]=Es,e[e.length]=kt("Properties",null,{xmlns:Gs.EXT_PROPS,"xmlns:vt":Gs.vt}),Qp.forEach(function(i){if(t[i[1]]!==void 0){var s;switch(i[2]){case"string":s=Yn(String(t[i[1]]));break;case"bool":s=t[i[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(i[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(i){return"<vt:lpstr>"+Yn(i)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function kee(t){var e=[Es,kt("Properties",null,{xmlns:Gs.CUST_PROPS,"xmlns:vt":Gs.vt})];if(!t)return e.join("");var r=1;return fo(t).forEach(function(s){++r,e[e.length]=kt("property",OBe(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Yn(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var tU={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function fVe(t,e){var r=[];return fo(tU).map(function(i){for(var s=0;s<wg.length;++s)if(wg[s][1]==i)return wg[s];for(s=0;s<Qp.length;++s)if(Qp[s][1]==i)return Qp[s];throw i}).forEach(function(i){if(t[i[1]]!=null){var s=e&&e.Props&&e.Props[i[1]]!=null?e.Props[i[1]]:t[i[1]];switch(i[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ao(tU[i[1]]||i[1],s))}}),kt("DocumentProperties",r.join(""),{xmlns:el.o})}function dVe(t,e){var r=["Worksheets","SheetNames"],i="CustomDocumentProperties",s=[];return t&&fo(t).forEach(function(n){if(Object.prototype.hasOwnProperty.call(t,n)){for(var o=0;o<wg.length;++o)if(n==wg[o][1])return;for(o=0;o<Qp.length;++o)if(n==Qp[o][1])return;for(o=0;o<r.length;++o)if(n==r[o])return;var l=t[n],h="string";typeof l=="number"?(h="float",l=String(l)):l===!0||l===!1?(h="boolean",l=l?"1":"0"):l=String(l),s.push(kt(Wj(n),l,{"dt:dt":h}))}}),e&&fo(e).forEach(function(n){if(Object.prototype.hasOwnProperty.call(e,n)&&!(t&&Object.prototype.hasOwnProperty.call(t,n))){var o=e[n],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(kt(Wj(n),o,{"dt:dt":l}))}}),"<"+i+' xmlns="'+el.o+'">'+s.join("")+"</"+i+">"}function gVe(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,i=r%Math.pow(2,32),s=(r-i)/Math.pow(2,32);i*=1e7,s*=1e7;var n=i/Math.pow(2,32)|0;n>0&&(i=i%Math.pow(2,32),s+=n);var o=rt(8);return o.write_shift(4,i),o.write_shift(4,s),o}function rU(t,e){var r=rt(4),i=rt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:i.write_shift(-4,e);break;case 5:i=rt(8),i.write_shift(8,e,"f");break;case 11:i.write_shift(4,e?1:0);break;case 64:i=gVe(e);break;case 31:case 80:for(i=rt(4+2*(e.length+1)+(e.length%2?0:2)),i.write_shift(4,e.length+1),i.write_shift(0,e,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return oo([r,i])}var Nee=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mVe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function nU(t,e,r){var i=rt(8),s=[],n=[],o=8,l=0,h=rt(8),d=rt(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),n.push(h),s.push(d),o+=8+h.length,!e){d=rt(8),d.write_shift(4,0),s.unshift(d);var g=[rt(4)];for(g[0].write_shift(4,t.length),l=0;l<t.length;++l){var y=t[l][0];for(h=rt(8+2*(y.length+1)+(y.length%2?0:2)),h.write_shift(4,l+2),h.write_shift(4,y.length+1),h.write_shift(0,y,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=oo(g),n.unshift(h),o+=8+h.length}for(l=0;l<t.length;++l)if(!(e&&!e[t[l][0]])&&!(Nee.indexOf(t[l][0])>-1||Fee.indexOf(t[l][0])>-1)&&t[l][1]!=null){var C=t[l][1],x=0;if(e){x=+e[t[l][0]];var _=r[x];if(_.p=="version"&&typeof C=="string"){var E=C.split(".");C=(+E[0]<<16)+(+E[1]||0)}h=rU(_.t,C)}else{var R=mVe(C);R==-1&&(R=31,C=String(C)),h=rU(R,C)}n.push(h),d=rt(8),d.write_shift(4,e?x:2+l),s.push(d),o+=8+h.length}var I=8*(n.length+1);for(l=0;l<n.length;++l)s[l].write_shift(4,I),I+=n[l].length;return i.write_shift(4,o),i.write_shift(4,n.length),oo([i].concat(s).concat(n))}function iU(t,e,r,i,s,n){var o=rt(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,ti.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,s?68:48);var h=nU(t,r,i);if(l.push(h),s){var d=nU(s,null,null);o.write_shift(16,n,"hex"),o.write_shift(4,68+h.length),l.push(d)}return oo(l)}function pVe(t,e){e||(e=rt(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function vVe(t,e){return t.read_shift(e)===1}function ea(t,e){return e||(e=rt(2)),e.write_shift(2,+!!t),e}function Dee(t){return t.read_shift(2,"u")}function kl(t,e){return e||(e=rt(2)),e.write_shift(2,t),e}function Lee(t,e,r){return r||(r=rt(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Hee(t,e,r){var i=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=t.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=i?t.read_shift(i,s):"";return o}function wVe(t){var e=t.t||"",r=rt(3);r.write_shift(2,e.length),r.write_shift(1,1);var i=rt(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[r,i];return oo(s)}function yVe(t,e,r){var i;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?i=t.read_shift(e,"sbcs-cont"):i=t.read_shift(e,"dbcs-cont"),i}function CVe(t,e,r){var i=t.read_shift(r&&r.biff==2?1:2);return i===0?(t.l++,""):yVe(t,i,r)}function SVe(t,e,r){if(r.biff>5)return CVe(t,e,r);var i=t.read_shift(1);return i===0?(t.l++,""):t.read_shift(i,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function $ee(t,e,r){return r||(r=rt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function sU(t,e){e||(e=rt(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function bVe(t){var e=rt(512),r=0,i=t.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var s=i.indexOf("#"),n=s>-1?31:23;switch(i.charAt(0)){case"#":n=28;break;case".":n&=-3;break}e.write_shift(4,2),e.write_shift(4,n);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(n==28)i=i.slice(1),sU(i,e);else if(n&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var l=s>-1?i.slice(0,s):i;for(e.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)e.write_shift(2,l.charCodeAt(r));e.write_shift(2,0),n&8&&sU(s>-1?i.slice(s+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var h=0;i.slice(h*3,h*3+3)=="../"||i.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,i.length-3*h+1),r=0;r<i.length-3*h;++r)e.write_shift(1,i.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function Hg(t,e,r,i){return i||(i=rt(6)),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,r||0),i}function xVe(t,e,r){var i=r.biff>8?4:2,s=t.read_shift(i),n=t.read_shift(i,"i"),o=t.read_shift(i,"i");return[s,n,o]}function EVe(t){var e=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);return{s:{c:i,r:e},e:{c:s,r}}}function Bee(t,e){return e||(e=rt(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function X6(t,e,r){var i=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":i=1280,s=8;break;case"biff4":i=4,s=6;break;case"biff3":i=3,s=6;break;case"biff2":i=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var n=rt(s);return n.write_shift(2,i),n.write_shift(2,e),s>4&&n.write_shift(2,29282),s>6&&n.write_shift(2,1997),s>8&&(n.write_shift(2,49161),n.write_shift(2,1),n.write_shift(2,1798),n.write_shift(2,0)),n}function TVe(t,e){var r=!e||e.biff==8,i=rt(r?112:54);for(i.write_shift(e.biff==8?2:1,7),r&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(r?0:536870912));i.l<i.length;)i.write_shift(1,r?0:32);return i}function _Ve(t,e){var r=!e||e.biff>=8?2:1,i=rt(8+r*t.name.length);i.write_shift(4,t.pos),i.write_shift(1,t.hs||0),i.write_shift(1,t.dt),i.write_shift(1,t.name.length),e.biff>=8&&i.write_shift(1,1),i.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=i.slice(0,i.l);return s.l=i.l,s}function RVe(t,e){var r=rt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var i=[],s=0;s<t.length;++s)i[s]=wVe(t[s]);var n=oo([r].concat(i));return n.parts=[r.length].concat(i.map(function(o){return o.length})),n}function AVe(){var t=rt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function OVe(t){var e=rt(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function IVe(t,e){var r=t.name||"Arial",i=e.biff==5,s=i?15+r.length:16+2*r.length,n=rt(s);return n.write_shift(2,(t.sz||12)*20),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le"),n}function PVe(t,e,r,i){var s=rt(10);return Hg(t,e,i,s),s.write_shift(4,r),s}function FVe(t,e,r,i,s){var n=!s||s.biff==8,o=rt(8+ +n+(1+n)*r.length);return Hg(t,e,i,o),o.write_shift(2,r.length),n&&o.write_shift(1,1),o.write_shift((1+n)*r.length,r,n?"utf16le":"sbcs"),o}function MVe(t,e,r,i){var s=r.biff==5;i||(i=rt(s?3+e.length:5+2*e.length)),i.write_shift(2,t),i.write_shift(s?1:2,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var n=i.length>i.l?i.slice(0,i.l):i;return n.l==null&&(n.l=n.length),n}function kVe(t,e){var r=e.biff==8||!e.biff?4:2,i=rt(2*r+6);return i.write_shift(r,t.s.r),i.write_shift(r,t.e.r+1),i.write_shift(2,t.s.c),i.write_shift(2,t.e.c+1),i.write_shift(2,0),i}function oU(t,e,r,i){var s=r.biff==5;i||(i=rt(s?16:20)),i.write_shift(2,0),t.style?(i.write_shift(2,t.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,t.numFmtId||0),i.write_shift(2,e<<4));var n=0;return t.numFmtId>0&&s&&(n|=1024),i.write_shift(4,n),i.write_shift(4,0),s||i.write_shift(4,0),i.write_shift(2,0),i}function NVe(t){var e=rt(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function DVe(t,e,r,i,s,n){var o=rt(8);return Hg(t,e,i,o),Lee(r,n,o),o}function LVe(t,e,r,i){var s=rt(14);return Hg(t,e,i,s),Lg(r,s),s}function HVe(t,e,r){if(r.biff<8)return $Ve(t,e,r);for(var i=[],s=t.l+e,n=t.read_shift(r.biff>8?4:2);n--!==0;)i.push(xVe(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return i}function $Ve(t,e,r){t[t.l+1]==3&&t[t.l]++;var i=Hee(t,e,r);return i.charCodeAt(0)==3?i.slice(1):i}function BVe(t){var e=rt(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)Bee(t[r],e);return e}function VVe(t){var e=rt(24),r=Ys(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(i[s],16));return oo([e,bVe(t[1])])}function WVe(t){var e=t[1].Tooltip,r=rt(10+2*(e.length+1));r.write_shift(2,2048);var i=Ys(t[0]);r.write_shift(2,i.r),r.write_shift(2,i.r),r.write_shift(2,i.c),r.write_shift(2,i.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function jVe(t){return t||(t=rt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function UVe(t,e,r){if(!r.cellStyles)return Gu(t,e);var i=r&&r.biff>=12?4:2,s=t.read_shift(i),n=t.read_shift(i),o=t.read_shift(i),l=t.read_shift(i),h=t.read_shift(2);i==2&&(t.l+=2);var d={s,e:n,w:o,ixfe:l,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function zVe(t,e){var r=rt(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var i=0;return t.hidden&&(i|=1),r.write_shift(1,i),i=t.level||0,r.write_shift(1,i),r.write_shift(2,0),r}function GVe(t){for(var e=rt(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function YVe(t,e,r){var i=rt(15);return vS(i,t,e),i.write_shift(8,r,"f"),i}function KVe(t,e,r){var i=rt(9);return vS(i,t,e),i.write_shift(2,r),i}var XVe=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=H6({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,h){var d=[],g=Dg(1);switch(h.type){case"base64":g=Rc(of(l));break;case"binary":g=Rc(l);break;case"buffer":case"array":g=l;break}Za(g,0);var y=g.read_shift(1),C=!!(y&136),x=!1,_=!1;switch(y){case 2:break;case 3:break;case 48:x=!0,C=!0;break;case 49:x=!0,C=!0;break;case 131:break;case 139:break;case 140:_=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var E=0,R=521;y==2&&(E=g.read_shift(2)),g.l+=3,y!=2&&(E=g.read_shift(4)),E>1048576&&(E=1e6),y!=2&&(R=g.read_shift(2));var I=g.read_shift(2),F=h.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(F=t[g[g.l]]),g.l+=1,g.l+=2),_&&(g.l+=36);for(var H=[],z={},q=Math.min(g.length,y==2?521:R-10-(x?264:0)),re=_?32:11;g.l<q&&g[g.l]!=13;)switch(z={},z.name=NT.utils.decode(F,g.slice(g.l,g.l+re)).replace(/[\u0000\r\n].*$/g,""),g.l+=re,z.type=String.fromCharCode(g.read_shift(1)),y!=2&&!_&&(z.offset=g.read_shift(4)),z.len=g.read_shift(1),y==2&&(z.offset=g.read_shift(2)),z.dec=g.read_shift(1),z.name.length&&H.push(z),y!=2&&(g.l+=_?13:14),z.type){case"B":(!x||z.len!=8)&&h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(g[g.l]!==13&&(g.l=R-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=R;var Y=0,oe=0;for(d[0]=[],oe=0;oe!=H.length;++oe)d[0][oe]=H[oe].name;for(;E-- >0;){if(g[g.l]===42){g.l+=I;continue}for(++g.l,d[++Y]=[],oe=0,oe=0;oe!=H.length;++oe){var me=g.slice(g.l,g.l+H[oe].len);g.l+=H[oe].len,Za(me,0);var de=NT.utils.decode(F,me);switch(H[oe].type){case"C":de.trim().length&&(d[Y][oe]=de.replace(/\s+$/,""));break;case"D":de.length===8?d[Y][oe]=new Date(+de.slice(0,4),+de.slice(4,6)-1,+de.slice(6,8)):d[Y][oe]=de;break;case"F":d[Y][oe]=parseFloat(de.trim());break;case"+":case"I":d[Y][oe]=_?me.read_shift(-4,"i")^2147483648:me.read_shift(4,"i");break;case"L":switch(de.trim().toUpperCase()){case"Y":case"T":d[Y][oe]=!0;break;case"N":case"F":d[Y][oe]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+de+"|")}break;case"M":if(!C)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));d[Y][oe]="##MEMO##"+(_?parseInt(de.trim(),10):me.read_shift(4));break;case"N":de=de.replace(/\u0000/g,"").trim(),de&&de!="."&&(d[Y][oe]=+de||0);break;case"@":d[Y][oe]=new Date(me.read_shift(-8,"f")-621356832e5);break;case"T":d[Y][oe]=new Date((me.read_shift(4)-2440588)*864e5+me.read_shift(4));break;case"Y":d[Y][oe]=me.read_shift(4,"i")/1e4+me.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[Y][oe]=-me.read_shift(-8,"f");break;case"B":if(x&&H[oe].len==8){d[Y][oe]=me.read_shift(8,"f");break}case"G":case"P":me.l+=H[oe].len;break;case"0":if(H[oe].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+H[oe].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=H,d}function i(l,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=B1(r(l,d),d);return g["!cols"]=d.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete d.DBF,g}function s(l,h){try{return Qg(i(l,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,h){var d=h||{};if(+d.codepage>=0&&wC(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ma(),y=KT(l,{header:1,raw:!0,cellDates:!0}),C=y[0],x=y.slice(1),_=l["!cols"]||[],E=0,R=0,I=0,F=1;for(E=0;E<C.length;++E){if(((_[E]||{}).DBF||{}).name){C[E]=_[E].DBF.name,++I;continue}if(C[E]!=null){if(++I,typeof C[E]=="number"&&(C[E]=C[E].toString(10)),typeof C[E]!="string")throw new Error("DBF Invalid column name "+C[E]+" |"+typeof C[E]+"|");if(C.indexOf(C[E])!==E){for(R=0;R<1024;++R)if(C.indexOf(C[E]+"_"+R)==-1){C[E]+="_"+R;break}}}}var H=Si(l["!ref"]),z=[],q=[],re=[];for(E=0;E<=H.e.c-H.s.c;++E){var Y="",oe="",me=0,de=[];for(R=0;R<x.length;++R)x[R][E]!=null&&de.push(x[R][E]);if(de.length==0||C[E]==null){z[E]="?";continue}for(R=0;R<de.length;++R){switch(typeof de[R]){case"number":oe="B";break;case"string":oe="C";break;case"boolean":oe="L";break;case"object":oe=de[R]instanceof Date?"D":"C";break;default:oe="C"}me=Math.max(me,String(de[R]).length),Y=Y&&Y!=oe?"C":oe}me>250&&(me=250),oe=((_[E]||{}).DBF||{}).type,oe=="C"&&_[E].DBF.len>me&&(me=_[E].DBF.len),Y=="B"&&oe=="N"&&(Y="N",re[E]=_[E].DBF.dec,me=_[E].DBF.len),q[E]=Y=="C"||oe=="N"?me:n[Y]||0,F+=q[E],z[E]=Y}var Re=g.next(32);for(Re.write_shift(4,318902576),Re.write_shift(4,x.length),Re.write_shift(2,296+32*I),Re.write_shift(2,F),E=0;E<4;++E)Re.write_shift(4,0);for(Re.write_shift(4,0|(+e[WZ]||3)<<8),E=0,R=0;E<C.length;++E)if(C[E]!=null){var Ie=g.next(32),Be=(C[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ie.write_shift(1,Be,"sbcs"),Ie.write_shift(1,z[E]=="?"?"C":z[E],"sbcs"),Ie.write_shift(4,R),Ie.write_shift(1,q[E]||n[z[E]]||0),Ie.write_shift(1,re[E]||0),Ie.write_shift(1,2),Ie.write_shift(4,0),Ie.write_shift(1,0),Ie.write_shift(4,0),Ie.write_shift(4,0),R+=q[E]||n[z[E]]||0}var lt=g.next(264);for(lt.write_shift(4,13),E=0;E<65;++E)lt.write_shift(4,0);for(E=0;E<x.length;++E){var pt=g.next(F);for(pt.write_shift(1,0),R=0;R<C.length;++R)if(C[R]!=null)switch(z[R]){case"L":pt.write_shift(1,x[E][R]==null?63:x[E][R]?84:70);break;case"B":pt.write_shift(8,x[E][R]||0,"f");break;case"N":var Ct="0";for(typeof x[E][R]=="number"&&(Ct=x[E][R].toFixed(re[R]||0)),I=0;I<q[R]-Ct.length;++I)pt.write_shift(1,32);pt.write_shift(1,Ct,"sbcs");break;case"D":x[E][R]?(pt.write_shift(4,("0000"+x[E][R].getFullYear()).slice(-4),"sbcs"),pt.write_shift(2,("00"+(x[E][R].getMonth()+1)).slice(-2),"sbcs"),pt.write_shift(2,("00"+x[E][R].getDate()).slice(-2),"sbcs")):pt.write_shift(8,"00000000","sbcs");break;case"C":var ct=String(x[E][R]!=null?x[E][R]:"").slice(0,q[R]);for(pt.write_shift(1,ct,"sbcs"),I=0;I<q[R]-ct.length;++I)pt.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:s,to_sheet:i,from_sheet:o}}(),qVe=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fo(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(C,x){var _=t[x];return typeof _=="number"?Ij(_):_},i=function(C,x,_){var E=x.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return E==59?C:Ij(E)};t["|"]=254;function s(C,x){switch(x.type){case"base64":return n(of(C),x);case"binary":return n(C,x);case"buffer":return n(kn&&Buffer.isBuffer(C)?C.toString("binary"):fS(C),x);case"array":return n(wR(C),x)}throw new Error("Unrecognized type "+x.type)}function n(C,x){var _=C.split(/[\n\r]+/),E=-1,R=-1,I=0,F=0,H=[],z=[],q=null,re={},Y=[],oe=[],me=[],de=0,Re;for(+x.codepage>=0&&wC(+x.codepage);I!==_.length;++I){de=0;var Ie=_[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(e,r),Be=Ie.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),lt=Be[0],pt;if(Ie.length>0)switch(lt){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Be[1].charAt(0)=="P"&&z.push(Ie.slice(3).replace(/;;/g,";"));break;case"C":var Ct=!1,ct=!1,Ue=!1,Je=!1,Fe=-1,A=-1;for(F=1;F<Be.length;++F)switch(Be[F].charAt(0)){case"A":break;case"X":R=parseInt(Be[F].slice(1))-1,ct=!0;break;case"Y":for(E=parseInt(Be[F].slice(1))-1,ct||(R=0),Re=H.length;Re<=E;++Re)H[Re]=[];break;case"K":pt=Be[F].slice(1),pt.charAt(0)==='"'?pt=pt.slice(1,pt.length-1):pt==="TRUE"?pt=!0:pt==="FALSE"?pt=!1:isNaN(Kh(pt))?isNaN(CC(pt).getDate())||(pt=oa(pt)):(pt=Kh(pt),q!==null&&eee(q)&&(pt=iee(pt))),Ct=!0;break;case"E":Je=!0;var O=KWe(Be[F].slice(1),{r:E,c:R});H[E][R]=[H[E][R],O];break;case"S":Ue=!0,H[E][R]=[H[E][R],"S5S"];break;case"G":break;case"R":Fe=parseInt(Be[F].slice(1))-1;break;case"C":A=parseInt(Be[F].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ie)}if(Ct&&(H[E][R]&&H[E][R].length==2?H[E][R][0]=pt:H[E][R]=pt,q=null),Ue){if(Je)throw new Error("SYLK shared formula cannot have own formula");var k=Fe>-1&&H[Fe][A];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");H[E][R][1]=XWe(k[1],{r:E-Fe,c:R-A})}break;case"F":var L=0;for(F=1;F<Be.length;++F)switch(Be[F].charAt(0)){case"X":R=parseInt(Be[F].slice(1))-1,++L;break;case"Y":for(E=parseInt(Be[F].slice(1))-1,Re=H.length;Re<=E;++Re)H[Re]=[];break;case"M":de=parseInt(Be[F].slice(1))/20;break;case"F":break;case"G":break;case"P":q=z[parseInt(Be[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(me=Be[F].slice(1).split(" "),Re=parseInt(me[0],10);Re<=parseInt(me[1],10);++Re)de=parseInt(me[2],10),oe[Re-1]=de===0?{hidden:!0}:{wch:de},q6(oe[Re-1]);break;case"C":R=parseInt(Be[F].slice(1))-1,oe[R]||(oe[R]={});break;case"R":E=parseInt(Be[F].slice(1))-1,Y[E]||(Y[E]={}),de>0?(Y[E].hpt=de,Y[E].hpx=zee(de)):de===0&&(Y[E].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ie)}L<1&&(q=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+Ie)}}return Y.length>0&&(re["!rows"]=Y),oe.length>0&&(re["!cols"]=oe),x&&x.sheetRows&&(H=H.slice(0,x.sheetRows)),[H,re]}function o(C,x){var _=s(C,x),E=_[0],R=_[1],I=B1(E,x);return fo(R).forEach(function(F){I[F]=R[F]}),I}function l(C,x){return Qg(o(C,x),x)}function h(C,x,_,E){var R="C;Y"+(_+1)+";X"+(E+1)+";K";switch(C.t){case"n":R+=C.v||0,C.f&&!C.F&&(R+=";E"+Q6(C.f,{r:_,c:E}));break;case"b":R+=C.v?"TRUE":"FALSE";break;case"e":R+=C.w||C.v;break;case"d":R+='"'+(C.w||C.v)+'"';break;case"s":R+='"'+C.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return R}function d(C,x){x.forEach(function(_,E){var R="F;W"+(E+1)+" "+(E+1)+" ";_.hidden?R+="0":(typeof _.width=="number"&&!_.wpx&&(_.wpx=UT(_.width)),typeof _.wpx=="number"&&!_.wch&&(_.wch=zT(_.wpx)),typeof _.wch=="number"&&(R+=Math.round(_.wch))),R.charAt(R.length-1)!=" "&&C.push(R)})}function g(C,x){x.forEach(function(_,E){var R="F;";_.hidden?R+="M0;":_.hpt?R+="M"+20*_.hpt+";":_.hpx&&(R+="M"+20*GT(_.hpx)+";"),R.length>2&&C.push(R+"R"+(E+1))})}function y(C,x){var _=["ID;PWXL;N;E"],E=[],R=Si(C["!ref"]),I,F=Array.isArray(C),H=`\r
`;_.push("P;PGeneral"),_.push("F;P0;DG0G8;M255"),C["!cols"]&&d(_,C["!cols"]),C["!rows"]&&g(_,C["!rows"]),_.push("B;Y"+(R.e.r-R.s.r+1)+";X"+(R.e.c-R.s.c+1)+";D"+[R.s.c,R.s.r,R.e.c,R.e.r].join(" "));for(var z=R.s.r;z<=R.e.r;++z)for(var q=R.s.c;q<=R.e.c;++q){var re=Xn({r:z,c:q});I=F?(C[z]||[])[q]:C[re],!(!I||I.v==null&&(!I.f||I.F))&&E.push(h(I,C,z,q))}return _.join(H)+H+E.join(H)+H+"E"+H}return{to_workbook:l,to_sheet:o,from_sheet:y}}(),JVe=function(){function t(n,o){switch(o.type){case"base64":return e(of(n),o);case"binary":return e(n,o);case"buffer":return e(kn&&Buffer.isBuffer(n)?n.toString("binary"):fS(n),o);case"array":return e(wR(n),o)}throw new Error("Unrecognized type "+o.type)}function e(n,o){for(var l=n.split(`
`),h=-1,d=-1,g=0,y=[];g!==l.length;++g){if(l[g].trim()==="BOT"){y[++h]=[],d=0;continue}if(!(h<0)){var C=l[g].trim().split(","),x=C[0],_=C[1];++g;for(var E=l[g]||"";(E.match(/["]/g)||[]).length&1&&g<l.length-1;)E+=`
`+l[++g];switch(E=E.trim(),+x){case-1:if(E==="BOT"){y[++h]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?y[h][d]=!0:E==="FALSE"?y[h][d]=!1:isNaN(Kh(_))?isNaN(CC(_).getDate())?y[h][d]=_:y[h][d]=oa(_):y[h][d]=Kh(_),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),y[h][d++]=E!==""?E:null;break}if(E==="EOD")break}}return o&&o.sheetRows&&(y=y.slice(0,o.sheetRows)),y}function r(n,o){return B1(t(n,o),o)}function i(n,o){return Qg(r(n,o),o)}var s=function(){var n=function(h,d,g,y,C){h.push(d),h.push(g+","+y),h.push('"'+C.replace(/"/g,'""')+'"')},o=function(h,d,g,y){h.push(d+","+g),h.push(d==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(h){var d=[],g=Si(h["!ref"]),y,C=Array.isArray(h);n(d,"TABLE",0,1,"sheetjs"),n(d,"VECTORS",0,g.e.r-g.s.r+1,""),n(d,"TUPLES",0,g.e.c-g.s.c+1,""),n(d,"DATA",0,0,"");for(var x=g.s.r;x<=g.e.r;++x){o(d,-1,0,"BOT");for(var _=g.s.c;_<=g.e.c;++_){var E=Xn({r:x,c:_});if(y=C?(h[x]||[])[_]:h[E],!y){o(d,1,0,"");continue}switch(y.t){case"n":var R=y.w;!R&&y.v!=null&&(R=y.v),R==null?y.f&&!y.F?o(d,1,0,"="+y.f):o(d,1,0,""):o(d,0,R,"V");break;case"b":o(d,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Pd(y.z||ts[14],Na(oa(y.v)))),o(d,0,y.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var I=`\r
`,F=d.join(I);return F}}();return{to_workbook:i,to_sheet:r,from_sheet:s}}(),Vee=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,C){for(var x=y.split(`
`),_=-1,E=-1,R=0,I=[];R!==x.length;++R){var F=x[R].trim().split(":");if(F[0]==="cell"){var H=Ys(F[1]);if(I.length<=H.r)for(_=I.length;_<=H.r;++_)I[_]||(I[_]=[]);switch(_=H.r,E=H.c,F[2]){case"t":I[_][E]=t(F[3]);break;case"v":I[_][E]=+F[3];break;case"vtf":var z=F[F.length-1];case"vtc":switch(F[3]){case"nl":I[_][E]=!!+F[4];break;default:I[_][E]=+F[4];break}F[2]=="vtf"&&(I[_][E]=[I[_][E],z])}}}return C&&C.sheetRows&&(I=I.slice(0,C.sheetRows)),I}function i(y,C){return B1(r(y,C),C)}function s(y,C){return Qg(i(y,C),C)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(y){if(!y||!y["!ref"])return"";for(var C=[],x=[],_,E="",R=cl(y["!ref"]),I=Array.isArray(y),F=R.s.r;F<=R.e.r;++F)for(var H=R.s.c;H<=R.e.c;++H)if(E=Xn({r:F,c:H}),_=I?(y[F]||[])[H]:y[E],!(!_||_.v==null||_.t==="z")){switch(x=["cell",E,"t"],_.t){case"s":case"str":x.push(e(_.v));break;case"n":_.f?(x[2]="vtf",x[3]="n",x[4]=_.v,x[5]=e(_.f)):(x[2]="v",x[3]=_.v);break;case"b":x[2]="vt"+(_.f?"f":"c"),x[3]="nl",x[4]=_.v?"1":"0",x[5]=e(_.f||(_.v?"TRUE":"FALSE"));break;case"d":var z=Na(oa(_.v));x[2]="vtc",x[3]="nd",x[4]=""+z,x[5]=_.w||Pd(_.z||ts[14],z);break;case"e":continue}C.push(x.join(":"))}return C.push("sheet:c:"+(R.e.c-R.s.c+1)+":r:"+(R.e.r-R.s.r+1)+":tvf:1"),C.push("valueformat:1:text-wiki"),C.join(`
`)}function g(y){return[n,o,l,o,d(y),h].join(`
`)}return{to_workbook:s,to_sheet:i,from_sheet:g}}(),QVe=function(){function t(g,y,C,x,_){_.raw?y[C][x]=g:g===""||(g==="TRUE"?y[C][x]=!0:g==="FALSE"?y[C][x]=!1:isNaN(Kh(g))?isNaN(CC(g).getDate())?y[C][x]=g:y[C][x]=oa(g):y[C][x]=Kh(g))}function e(g,y){var C=y||{},x=[];if(!g||g.length===0)return x;for(var _=g.split(/[\r\n]/),E=_.length-1;E>=0&&_[E].length===0;)--E;for(var R=10,I=0,F=0;F<=E;++F)I=_[F].indexOf(" "),I==-1?I=_[F].length:I++,R=Math.max(R,I);for(F=0;F<=E;++F){x[F]=[];var H=0;for(t(_[F].slice(0,R).trim(),x,F,H,C),H=1;H<=(_[F].length-R)/10+1;++H)t(_[F].slice(R+(H-1)*10,R+H*10).trim(),x,F,H,C)}return C.sheetRows&&(x=x.slice(0,C.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function s(g){for(var y={},C=!1,x=0,_=0;x<g.length;++x)(_=g.charCodeAt(x))==34?C=!C:!C&&_ in r&&(y[_]=(y[_]||0)+1);_=[];for(x in y)Object.prototype.hasOwnProperty.call(y,x)&&_.push([y[x],x]);if(!_.length){y=i;for(x in y)Object.prototype.hasOwnProperty.call(y,x)&&_.push([y[x],x])}return _.sort(function(E,R){return E[0]-R[0]||i[E[1]]-i[R[1]]}),r[_.pop()[1]]||44}function n(g,y){var C=y||{},x="",_=C.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(x=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(x=g.charAt(4),g=g.slice(6)):x=s(g.slice(0,1024)):C.FS?x=C.FS:x=s(g.slice(0,1024));var R=0,I=0,F=0,H=0,z=0,q=x.charCodeAt(0),re=!1,Y=0,oe=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var me=C.dateNF!=null?gBe(C.dateNF):null;function de(){var Re=g.slice(H,z),Ie={};if(Re.charAt(0)=='"'&&Re.charAt(Re.length-1)=='"'&&(Re=Re.slice(1,-1).replace(/""/g,'"')),Re.length===0)Ie.t="z";else if(C.raw)Ie.t="s",Ie.v=Re;else if(Re.trim().length===0)Ie.t="s",Ie.v=Re;else if(Re.charCodeAt(0)==61)Re.charCodeAt(1)==34&&Re.charCodeAt(Re.length-1)==34?(Ie.t="s",Ie.v=Re.slice(2,-1).replace(/""/g,'"')):qWe(Re)?(Ie.t="n",Ie.f=Re.slice(1)):(Ie.t="s",Ie.v=Re);else if(Re=="TRUE")Ie.t="b",Ie.v=!0;else if(Re=="FALSE")Ie.t="b",Ie.v=!1;else if(!isNaN(F=Kh(Re)))Ie.t="n",C.cellText!==!1&&(Ie.w=Re),Ie.v=F;else if(!isNaN(CC(Re).getDate())||me&&Re.match(me)){Ie.z=C.dateNF||ts[14];var Be=0;me&&Re.match(me)&&(Re=mBe(Re,C.dateNF,Re.match(me)||[]),Be=1),C.cellDates?(Ie.t="d",Ie.v=oa(Re,Be)):(Ie.t="n",Ie.v=Na(oa(Re,Be))),C.cellText!==!1&&(Ie.w=Pd(Ie.z,Ie.v instanceof Date?Na(Ie.v):Ie.v)),C.cellNF||delete Ie.z}else Ie.t="s",Ie.v=Re;if(Ie.t=="z"||(C.dense?(_[R]||(_[R]=[]),_[R][I]=Ie):_[Xn({c:I,r:R})]=Ie),H=z+1,oe=g.charCodeAt(H),E.e.c<I&&(E.e.c=I),E.e.r<R&&(E.e.r=R),Y==q)++I;else if(I=0,++R,C.sheetRows&&C.sheetRows<=R)return!0}e:for(;z<g.length;++z)switch(Y=g.charCodeAt(z)){case 34:oe===34&&(re=!re);break;case q:case 10:case 13:if(!re&&de())break e;break}return z-H>0&&de(),_["!ref"]=ys(E),_}function o(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?n(g,y):B1(e(g,y),y)}function l(g,y){var C="",x=y.type=="string"?[0,0,0,0]:uYe(g,y);switch(y.type){case"base64":C=of(g);break;case"binary":C=g;break;case"buffer":y.codepage==65001?C=g.toString("utf8"):y.codepage&&typeof NT<"u"||(C=kn&&Buffer.isBuffer(g)?g.toString("binary"):fS(g));break;case"array":C=wR(g);break;case"string":C=g;break;default:throw new Error("Unrecognized type "+y.type)}return x[0]==239&&x[1]==187&&x[2]==191?C=Ty(C.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?C=Ty(C):y.type=="binary"&&typeof NT<"u",C.slice(0,19)=="socialcalc:version:"?Vee.to_sheet(y.type=="string"?C:Ty(C),y):o(C,y)}function h(g,y){return Qg(l(g,y),y)}function d(g){for(var y=[],C=Si(g["!ref"]),x,_=Array.isArray(g),E=C.s.r;E<=C.e.r;++E){for(var R=[],I=C.s.c;I<=C.e.c;++I){var F=Xn({r:E,c:I});if(x=_?(g[E]||[])[I]:g[F],!x||x.v==null){R.push("          ");continue}for(var H=(x.w||(af(x),x.w)||"").slice(0,10);H.length<10;)H+=" ";R.push(H+(I===0?" ":""))}y.push(R.join(""))}return y.join(`
`)}return{to_workbook:h,to_sheet:l,from_sheet:d}}(),aU=function(){function t(O,k,L){if(O){Za(O,O.l||0);for(var D=L.Enum||Fe;O.l<O.length;){var K=O.read_shift(2),Q=D[K]||D[65535],pe=O.read_shift(2),ye=O.l+pe,j=Q.f&&Q.f(O,pe,L);if(O.l=ye,k(j,Q,K))return}}}function e(O,k){switch(k.type){case"base64":return r(Rc(of(O)),k);case"binary":return r(Rc(O),k);case"buffer":case"array":return r(O,k)}throw"Unsupported type "+k.type}function r(O,k){if(!O)return O;var L=k||{},D=L.dense?[]:{},K="Sheet1",Q="",pe=0,ye={},j=[],X=[],te={s:{r:0,c:0},e:{r:0,c:0}},we=L.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)L.Enum=Fe,t(O,function(he,Ae,Ne){switch(Ne){case 0:L.vers=he,he>=4096&&(L.qpro=!0);break;case 6:te=he;break;case 204:he&&(Q=he);break;case 222:Q=he;break;case 15:case 51:L.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:Ne==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=L.dateNF||ts[14],L.cellDates&&(he[1].t="d",he[1].v=iee(he[1].v))),L.qpro&&he[3]>pe&&(D["!ref"]=ys(te),ye[K]=D,j.push(K),D=L.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},pe=he[3],K=Q||"Sheet"+(pe+1),Q="");var Le=L.dense?(D[he[0].r]||[])[he[0].c]:D[Xn(he[0])];if(Le){Le.t=he[1].t,Le.v=he[1].v,he[1].z!=null&&(Le.z=he[1].z),he[1].f!=null&&(Le.f=he[1].f);break}L.dense?(D[he[0].r]||(D[he[0].r]=[]),D[he[0].r][he[0].c]=he[1]):D[Xn(he[0])]=he[1];break}},L);else if(O[2]==26||O[2]==14)L.Enum=A,O[2]==14&&(L.qpro=!0,O.l=0),t(O,function(he,Ae,Ne){switch(Ne){case 204:K=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>pe&&(D["!ref"]=ys(te),ye[K]=D,j.push(K),D=L.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},pe=he[3],K="Sheet"+(pe+1)),we>0&&he[0].r>=we)break;L.dense?(D[he[0].r]||(D[he[0].r]=[]),D[he[0].r][he[0].c]=he[1]):D[Xn(he[0])]=he[1],te.e.c<he[0].c&&(te.e.c=he[0].c),te.e.r<he[0].r&&(te.e.r=he[0].r);break;case 27:he[14e3]&&(X[he[14e3][0]]=he[14e3][1]);break;case 1537:X[he[0]]=he[1],he[0]==pe&&(K=he[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(D["!ref"]=ys(te),ye[Q||K]=D,j.push(Q||K),!X.length)return{SheetNames:j,Sheets:ye};for(var ce={},_e=[],Ee=0;Ee<X.length;++Ee)ye[j[Ee]]?(_e.push(X[Ee]||j[Ee]),ce[X[Ee]]=ye[X[Ee]]||ye[j[Ee]]):(_e.push(X[Ee]),ce[X[Ee]]={"!ref":"A1"});return{SheetNames:_e,Sheets:ce}}function i(O,k){var L=k||{};if(+L.codepage>=0&&wC(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Ma(),K=Si(O["!ref"]),Q=Array.isArray(O),pe=[];Lt(D,0,n(1030)),Lt(D,6,h(K));for(var ye=Math.min(K.e.r,8191),j=K.s.r;j<=ye;++j)for(var X=uo(j),te=K.s.c;te<=K.e.c;++te){j===K.s.r&&(pe[te]=Do(te));var we=pe[te]+X,ce=Q?(O[j]||[])[te]:O[we];if(!(!ce||ce.t=="z"))if(ce.t=="n")(ce.v|0)==ce.v&&ce.v>=-32768&&ce.v<=32767?Lt(D,13,x(j,te,ce.v)):Lt(D,14,E(j,te,ce.v));else{var _e=af(ce);Lt(D,15,y(j,te,_e.slice(0,239)))}}return Lt(D,1),D.end()}function s(O,k){var L=k||{};if(+L.codepage>=0&&wC(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Ma();Lt(D,0,o(O));for(var K=0,Q=0;K<O.SheetNames.length;++K)(O.Sheets[O.SheetNames[K]]||{})["!ref"]&&Lt(D,27,Je(O.SheetNames[K],Q++));var pe=0;for(K=0;K<O.SheetNames.length;++K){var ye=O.Sheets[O.SheetNames[K]];if(!(!ye||!ye["!ref"])){for(var j=Si(ye["!ref"]),X=Array.isArray(ye),te=[],we=Math.min(j.e.r,8191),ce=j.s.r;ce<=we;++ce)for(var _e=uo(ce),Ee=j.s.c;Ee<=j.e.c;++Ee){ce===j.s.r&&(te[Ee]=Do(Ee));var he=te[Ee]+_e,Ae=X?(ye[ce]||[])[Ee]:ye[he];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")Lt(D,23,de(ce,Ee,pe,Ae.v));else{var Ne=af(Ae);Lt(D,22,Y(ce,Ee,pe,Ne.slice(0,239)))}}++pe}}return Lt(D,1),D.end()}function n(O){var k=rt(2);return k.write_shift(2,O),k}function o(O){var k=rt(26);k.write_shift(2,4096),k.write_shift(2,4),k.write_shift(4,0);for(var L=0,D=0,K=0,Q=0;Q<O.SheetNames.length;++Q){var pe=O.SheetNames[Q],ye=O.Sheets[pe];if(!(!ye||!ye["!ref"])){++K;var j=cl(ye["!ref"]);L<j.e.r&&(L=j.e.r),D<j.e.c&&(D=j.e.c)}}return L>8191&&(L=8191),k.write_shift(2,L),k.write_shift(1,K),k.write_shift(1,D),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(1,1),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(4,0),k}function l(O,k,L){var D={s:{c:0,r:0},e:{c:0,r:0}};return k==8&&L.qpro?(D.s.c=O.read_shift(1),O.l++,D.s.r=O.read_shift(2),D.e.c=O.read_shift(1),O.l++,D.e.r=O.read_shift(2),D):(D.s.c=O.read_shift(2),D.s.r=O.read_shift(2),k==12&&L.qpro&&(O.l+=2),D.e.c=O.read_shift(2),D.e.r=O.read_shift(2),k==12&&L.qpro&&(O.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function h(O){var k=rt(8);return k.write_shift(2,O.s.c),k.write_shift(2,O.s.r),k.write_shift(2,O.e.c),k.write_shift(2,O.e.r),k}function d(O,k,L){var D=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(D[0].c=O.read_shift(1),D[3]=O.read_shift(1),D[0].r=O.read_shift(2),O.l+=2):(D[2]=O.read_shift(1),D[0].c=O.read_shift(2),D[0].r=O.read_shift(2)),D}function g(O,k,L){var D=O.l+k,K=d(O,k,L);if(K[1].t="s",L.vers==20768){O.l++;var Q=O.read_shift(1);return K[1].v=O.read_shift(Q,"utf8"),K}return L.qpro&&O.l++,K[1].v=O.read_shift(D-O.l,"cstr"),K}function y(O,k,L){var D=rt(7+L.length);D.write_shift(1,255),D.write_shift(2,k),D.write_shift(2,O),D.write_shift(1,39);for(var K=0;K<D.length;++K){var Q=L.charCodeAt(K);D.write_shift(1,Q>=128?95:Q)}return D.write_shift(1,0),D}function C(O,k,L){var D=d(O,k,L);return D[1].v=O.read_shift(2,"i"),D}function x(O,k,L){var D=rt(7);return D.write_shift(1,255),D.write_shift(2,k),D.write_shift(2,O),D.write_shift(2,L,"i"),D}function _(O,k,L){var D=d(O,k,L);return D[1].v=O.read_shift(8,"f"),D}function E(O,k,L){var D=rt(13);return D.write_shift(1,255),D.write_shift(2,k),D.write_shift(2,O),D.write_shift(8,L,"f"),D}function R(O,k,L){var D=O.l+k,K=d(O,k,L);if(K[1].v=O.read_shift(8,"f"),L.qpro)O.l=D;else{var Q=O.read_shift(2);z(O.slice(O.l,O.l+Q),K),O.l+=Q}return K}function I(O,k,L){var D=k&32768;return k&=-32769,k=(D?O:0)+(k>=8192?k-16384:k),(D?"":"$")+(L?Do(k):uo(k))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},H=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(O,k){Za(O,0);for(var L=[],D=0,K="",Q="",pe="",ye="";O.l<O.length;){var j=O[O.l++];switch(j){case 0:L.push(O.read_shift(8,"f"));break;case 1:Q=I(k[0].c,O.read_shift(2),!0),K=I(k[0].r,O.read_shift(2),!1),L.push(Q+K);break;case 2:{var X=I(k[0].c,O.read_shift(2),!0),te=I(k[0].r,O.read_shift(2),!1);Q=I(k[0].c,O.read_shift(2),!0),K=I(k[0].r,O.read_shift(2),!1),L.push(X+te+":"+Q+K)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(O.read_shift(2));break;case 6:{for(var we="";j=O[O.l++];)we+=String.fromCharCode(j);L.push('"'+we.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ye=L.pop(),pe=L.pop(),L.push(["AND","OR"][j-20]+"("+pe+","+ye+")");break;default:if(j<32&&H[j])ye=L.pop(),pe=L.pop(),L.push(pe+H[j]+ye);else if(F[j]){if(D=F[j][1],D==69&&(D=O[O.l++]),D>L.length){console.error("WK1 bad formula parse 0x"+j.toString(16)+":|"+L.join("|")+"|");return}var ce=L.slice(-D);L.length-=D,L.push(F[j][0]+"("+ce.join(",")+")")}else return j<=7?console.error("WK1 invalid opcode "+j.toString(16)):j<=24?console.error("WK1 unsupported op "+j.toString(16)):j<=30?console.error("WK1 invalid opcode "+j.toString(16)):j<=115?console.error("WK1 unsupported function opcode "+j.toString(16)):console.error("WK1 unrecognized opcode "+j.toString(16))}}L.length==1?k[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function q(O){var k=[{c:0,r:0},{t:"n",v:0},0];return k[0].r=O.read_shift(2),k[3]=O[O.l++],k[0].c=O[O.l++],k}function re(O,k){var L=q(O);return L[1].t="s",L[1].v=O.read_shift(k-4,"cstr"),L}function Y(O,k,L,D){var K=rt(6+D.length);K.write_shift(2,O),K.write_shift(1,L),K.write_shift(1,k),K.write_shift(1,39);for(var Q=0;Q<D.length;++Q){var pe=D.charCodeAt(Q);K.write_shift(1,pe>=128?95:pe)}return K.write_shift(1,0),K}function oe(O,k){var L=q(O);L[1].v=O.read_shift(2);var D=L[1].v>>1;if(L[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return L[1].v=D,L}function me(O,k){var L=q(O),D=O.read_shift(4),K=O.read_shift(4),Q=O.read_shift(2);if(Q==65535)return D===0&&K===3221225472?(L[1].t="e",L[1].v=15):D===0&&K===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var pe=Q&32768;return Q=(Q&32767)-16446,L[1].v=(1-pe*2)*(K*Math.pow(2,Q+32)+D*Math.pow(2,Q)),L}function de(O,k,L,D){var K=rt(14);if(K.write_shift(2,O),K.write_shift(1,L),K.write_shift(1,k),D==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var Q=0,pe=0,ye=0,j=0;return D<0&&(Q=1,D=-D),pe=Math.log2(D)|0,D/=Math.pow(2,pe-31),j=D>>>0,j&2147483648||(D/=2,++pe,j=D>>>0),D-=j,j|=2147483648,j>>>=0,D*=Math.pow(2,32),ye=D>>>0,K.write_shift(4,ye),K.write_shift(4,j),pe+=16383+(Q?32768:0),K.write_shift(2,pe),K}function Re(O,k){var L=me(O);return O.l+=k-14,L}function Ie(O,k){var L=q(O),D=O.read_shift(4);return L[1].v=D>>6,L}function Be(O,k){var L=q(O),D=O.read_shift(8,"f");return L[1].v=D,L}function lt(O,k){var L=Be(O);return O.l+=k-10,L}function pt(O,k){return O[O.l+k-1]==0?O.read_shift(k,"cstr"):""}function Ct(O,k){var L=O[O.l++];L>k-1&&(L=k-1);for(var D="";D.length<L;)D+=String.fromCharCode(O[O.l++]);return D}function ct(O,k,L){if(!(!L.qpro||k<21)){var D=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var K=O.read_shift(k-21,"cstr");return[D,K]}}function Ue(O,k){for(var L={},D=O.l+k;O.l<D;){var K=O.read_shift(2);if(K==14e3){for(L[K]=[0,""],L[K][0]=O.read_shift(2);O[O.l];)L[K][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return L}function Je(O,k){var L=rt(5+O.length);L.write_shift(2,14e3),L.write_shift(2,k);for(var D=0;D<O.length;++D){var K=O.charCodeAt(D);L[L.l++]=K>127?95:K}return L[L.l++]=0,L}var Fe={0:{n:"BOF",f:Dee},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:C},14:{n:"NUMBER",f:_},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:R},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:pt},222:{n:"SHEETNAMELP",f:Ct},65535:{n:""}},A={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:re},23:{n:"NUMBER17",f:me},24:{n:"NUMBER18",f:oe},25:{n:"FORMULA19",f:Re},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Ie},38:{n:"??"},39:{n:"NUMBER27",f:Be},40:{n:"FORMULA28",f:lt},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:pt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ct},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:s,to_workbook:e}}(),ZVe=/^\s|\s$|[\t\n\r]/;function Wee(t,e){if(!e.bookSST)return"";var r=[Es];r[r.length]=kt("sst",null,{xmlns:$1[0],count:t.Count,uniqueCount:t.Unique});for(var i=0;i!=t.length;++i)if(t[i]!=null){var s=t[i],n="<si>";s.r?n+=s.r:(n+="<t",s.t||(s.t=""),s.t.match(ZVe)&&(n+=' xml:space="preserve"'),n+=">"+Yn(s.t)+"</t>"),n+="</si>",r[r.length]=n}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function eWe(t){return[t.read_shift(4),t.read_shift(4)]}function tWe(t,e){return e||(e=rt(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var rWe=GBe;function nWe(t){var e=Ma();dt(e,159,tWe(t));for(var r=0;r<t.length;++r)dt(e,19,rWe(t[r]));return dt(e,160),e.end()}function iWe(t){for(var e=[],r=t.split(""),i=0;i<r.length;++i)e[i]=r[i].charCodeAt(0);return e}function jee(t){var e=0,r,i=iWe(t),s=i.length+1,n,o,l,h,d;for(r=Dg(s),r[0]=i.length,n=1;n!=s;++n)r[n]=i[n-1];for(n=s-1;n>=0;--n)o=r[n],l=e&16384?1:0,h=e<<1&32767,d=l|h,e=d^o;return e^52811}var sWe=function(){function t(s,n){switch(n.type){case"base64":return e(of(s),n);case"binary":return e(s,n);case"buffer":return e(kn&&Buffer.isBuffer(s)?s.toString("binary"):fS(s),n);case"array":return e(wR(s),n)}throw new Error("Unrecognized type "+n.type)}function e(s,n){var o=n||{},l=o.dense?[]:{},h=s.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,y){Array.isArray(l)&&(l[y]=[]);for(var C=/\\\w+\b/g,x=0,_,E=-1;_=C.exec(g);){switch(_[0]){case"\\cell":var R=g.slice(x,C.lastIndex-_[0].length);if(R[0]==" "&&(R=R.slice(1)),++E,R.length){var I={v:R,t:"s"};Array.isArray(l)?l[y][E]=I:l[Xn({r:y,c:E})]=I}break}x=C.lastIndex}E>d.e.c&&(d.e.c=E)}),l["!ref"]=ys(d),l}function r(s,n){return Qg(t(s,n),n)}function i(s){for(var n=["{\\rtf1\\ansi"],o=Si(s["!ref"]),l,h=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){n.push("\\trowd\\trautofit1");for(var g=o.s.c;g<=o.e.c;++g)n.push("\\cellx"+(g+1));for(n.push("\\pard\\intbl"),g=o.s.c;g<=o.e.c;++g){var y=Xn({r:d,c:g});l=h?(s[d]||[])[g]:s[y],!(!l||l.v==null&&(!l.f||l.F))&&(n.push(" "+(l.w||(af(l),l.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:i}}();function lU(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var oWe=6,Xh=oWe;function UT(t){return Math.floor((t+Math.round(128/Xh)/256)*Xh)}function zT(t){return Math.floor((t-5)/Xh*100+.5)/100}function UF(t){return Math.round((t*Xh+5)/Xh*256)/256}function q6(t){t.width?(t.wpx=UT(t.width),t.wch=zT(t.wpx),t.MDW=Xh):t.wpx?(t.wch=zT(t.wpx),t.width=UF(t.wch),t.MDW=Xh):typeof t.wch=="number"&&(t.width=UF(t.wch),t.wpx=UT(t.width),t.MDW=Xh),t.customWidth&&delete t.customWidth}var aWe=96,Uee=aWe;function GT(t){return t*96/Uee}function zee(t){return t*Uee/96}function lWe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&(e[e.length]=kt("numFmt",null,{numFmtId:i,formatCode:Yn(t[i])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=kt("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function cWe(t){var e=[];return e[e.length]=kt("cellXfs",null),t.forEach(function(r){e[e.length]=kt("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=kt("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function Gee(t,e){var r=[Es,kt("styleSheet",null,{xmlns:$1[0],"xmlns:vt":Gs.vt})],i;return t.SSF&&(i=lWe(t.SSF))!=null&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=cWe(e.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uWe(t,e){var r=t.read_shift(2),i=Lo(t);return[r,i]}function hWe(t,e,r){r||(r=rt(6+4*e.length)),r.write_shift(2,t),Ks(e,r);var i=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),i}function fWe(t,e,r){var i={};i.sz=t.read_shift(2)/20;var s=ZBe(t);s.fItalic&&(i.italic=1),s.fCondense&&(i.condense=1),s.fExtend&&(i.extend=1),s.fShadow&&(i.shadow=1),s.fOutline&&(i.outline=1),s.fStrikeout&&(i.strike=1);var n=t.read_shift(2);switch(n===700&&(i.bold=1),t.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(i.underline=o);var l=t.read_shift(1);l>0&&(i.family=l);var h=t.read_shift(1);switch(h>0&&(i.charset=h),t.l++,i.color=QBe(t),t.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Lo(t),i}function dWe(t,e){e||(e=rt(25+4*32)),e.write_shift(2,t.sz*20),eVe(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),WT(t.color,e);var i=0;return t.scheme=="major"&&(i=1),t.scheme=="minor"&&(i=2),e.write_shift(1,i),Ks(t.name,e),e.length>e.l?e.slice(0,e.l):e}var gWe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],p3,mWe=Gu;function cU(t,e){e||(e=rt(4*3+8*7+16*1)),p3||(p3=H6(gWe));var r=p3[t.patternType];r==null&&(r=40),e.write_shift(4,r);var i=0;if(r!=40)for(WT({auto:1},e),WT({auto:1},e);i<12;++i)e.write_shift(4,0);else{for(;i<4;++i)e.write_shift(4,0);for(;i<12;++i)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function pWe(t,e){var r=t.l+e,i=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:i,numFmtId:s}}function Yee(t,e,r){r||(r=rt(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var i=0;return r.write_shift(1,i),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Pw(t,e){return e||(e=rt(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var vWe=Gu;function wWe(t,e){return e||(e=rt(51)),e.write_shift(1,0),Pw(null,e),Pw(null,e),Pw(null,e),Pw(null,e),Pw(null,e),e.length>e.l?e.slice(0,e.l):e}function yWe(t,e){return e||(e=rt(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),VT(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function CWe(t,e,r){var i=rt(2052);return i.write_shift(4,t),VT(e,i),VT(r,i),i.length>i.l?i.slice(0,i.l):i}function SWe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&++r}),r!=0&&(dt(t,615,kc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&dt(t,44,hWe(s,e[s]))}),dt(t,616))}}function bWe(t){var e=1;dt(t,611,kc(e)),dt(t,43,dWe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),dt(t,612)}function xWe(t){var e=2;dt(t,603,kc(e)),dt(t,45,cU({patternType:"none"})),dt(t,45,cU({patternType:"gray125"})),dt(t,604)}function EWe(t){var e=1;dt(t,613,kc(e)),dt(t,46,wWe()),dt(t,614)}function TWe(t){var e=1;dt(t,626,kc(e)),dt(t,47,Yee({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),dt(t,627)}function _We(t,e){dt(t,617,kc(e.length)),e.forEach(function(r){dt(t,47,Yee(r,0))}),dt(t,618)}function RWe(t){var e=1;dt(t,619,kc(e)),dt(t,48,yWe({xfId:0,builtinId:0,name:"Normal"})),dt(t,620)}function AWe(t){var e=0;dt(t,505,kc(e)),dt(t,506)}function OWe(t){var e=0;dt(t,508,CWe(e,"TableStyleMedium9","PivotStyleMedium4")),dt(t,509)}function IWe(t,e){var r=Ma();return dt(r,278),SWe(r,t.SSF),bWe(r),xWe(r),EWe(r),TWe(r),_We(r,e.cellXfs),RWe(r),AWe(r),OWe(r),dt(r,279),r.end()}function Kee(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Es];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function PWe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Lo(t)}}function FWe(t){var e=rt(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Ks(t.name,e),e.slice(0,e.l)}function MWe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function kWe(t){var e=rt(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function NWe(t,e){var r=rt(8+2*e.length);return r.write_shift(4,t),Ks(e,r),r.slice(0,r.l)}function DWe(t){return t.l+=4,t.read_shift(4)!=0}function LWe(t,e){var r=rt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function HWe(){var t=Ma();return dt(t,332),dt(t,334,kc(1)),dt(t,335,FWe({name:"XLDAPR",version:12e4,flags:3496657072})),dt(t,336),dt(t,339,NWe(1,"XLDAPR")),dt(t,52),dt(t,35,kc(514)),dt(t,4096,kc(0)),dt(t,4097,kl(1)),dt(t,36),dt(t,53),dt(t,340),dt(t,337,LWe(1)),dt(t,51,kWe([[1,0]])),dt(t,338),dt(t,333),t.end()}function Xee(){var t=[Es];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function $We(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Xn(r);var i=t.read_shift(1);return i&2&&(e.l="1"),i&8&&(e.a="1"),e}var kp=1024;function qee(t,e){for(var r=[21600,21600],i=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[kt("xml",null,{"xmlns:v":el.v,"xmlns:o":el.o,"xmlns:x":el.x,"xmlns:mv":el.mv}).replace(/\/>/,">"),kt("o:shapelayout",kt("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),kt("v:shapetype",[kt("v:stroke",null,{joinstyle:"miter"}),kt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:i})];kp<t*1e3;)kp+=1e3;return e.forEach(function(n){var o=Ys(n[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var h=l.type=="gradient"?kt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=kt("v:fill",h,l),g={on:"t",obscured:"t"};++kp,s=s.concat(["<v:shape"+bC({id:"_x0000_s"+kp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,kt("v:shadow",null,g),kt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ao("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ao("x:AutoFill","False"),ao("x:Row",String(o.r)),ao("x:Column",String(o.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Jee(t){var e=[Es,kt("comments",null,{xmlns:$1[0]})],r=[];return e.push("<authors>"),t.forEach(function(i){i[1].forEach(function(s){var n=Yn(s.a);r.indexOf(n)==-1&&(r.push(n),e.push("<author>"+n+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(i){var s=0,n=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?s=r.indexOf("tc="+i[1][0].ID):i[1].forEach(function(h){h.a&&(s=r.indexOf(Yn(h.a))),n.push(h.t||"")}),e.push('<comment ref="'+i[0]+'" authorId="'+s+'"><text>'),n.length<=1)e.push(ao("t",Yn(n[0]||"")));else{for(var o=`Comment:
    `+n[0]+`
`,l=1;l<n.length;++l)o+=`Reply:
    `+n[l]+`
`;e.push(ao("t",Yn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function BWe(t,e,r){var i=[Es,kt("ThreadedComments",null,{xmlns:Gs.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var n="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var h={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?n=h.id:h.parentId=n,o.ID=h.id,o.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),i.push(kt("threadedComment",ao("text",o.t||""),h))})}),i.push("</ThreadedComments>"),i.join("")}function VWe(t){var e=[Es,kt("personList",null,{xmlns:Gs.TCMNT,"xmlns:x":$1[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,i){e.push(kt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function WWe(t){var e={};e.iauthor=t.read_shift(4);var r=rm(t);return e.rfx=r.s,e.ref=Xn(r.s),t.l+=16,e}function jWe(t,e){return e==null&&(e=rt(36)),e.write_shift(4,t[1].iauthor),V1(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var UWe=Lo;function zWe(t){return Ks(t.slice(0,54))}function GWe(t){var e=Ma(),r=[];return dt(e,628),dt(e,630),t.forEach(function(i){i[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),dt(e,632,zWe(s.a)))})}),dt(e,631),dt(e,633),t.forEach(function(i){i[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var n={s:Ys(i[0]),e:Ys(i[0])};dt(e,635,jWe([n,s])),s.t&&s.t.length>0&&dt(e,637,KBe(s)),dt(e,636),delete s.iauthor})}),dt(e,634),dt(e,629),e.end()}function YWe(t,e){e.FullPaths.forEach(function(r,i){if(i!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&ti.utils.cfb_add(t,s,e.FileIndex[i].content)}})}var Qee=["xlsb","xlsm","xlam","biff8","xla"],KWe=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(i,s,n,o){var l=!1,h=!1;n.length==0?h=!0:n.charAt(0)=="["&&(h=!0,n=n.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=n.length>0?parseInt(n,10)|0:0,g=o.length>0?parseInt(o,10)|0:0;return l?g+=e.c:--g,h?d+=e.r:--d,s+(l?"":"$")+Do(g)+(h?"":"$")+uo(d)}return function(s,n){return e=n,s.replace(t,r)}}(),J6=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Q6=function(){return function(e,r){return e.replace(J6,function(i,s,n,o,l,h){var d=z6(o)-(n?0:r.c),g=U6(h)-(l?0:r.r),y=g==0?"":l?g+1:"["+g+"]",C=d==0?"":n?d+1:"["+d+"]";return s+"R"+y+"C"+C})}}();function XWe(t,e){return t.replace(J6,function(r,i,s,n,o,l){return i+(s=="$"?s+n:Do(z6(n)+e.c))+(o=="$"?o+l:uo(U6(l)+e.r))})}function qWe(t){return t.length!=1}function gs(t){t.l+=1}function Fd(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Zee(t,e,r){var i=2;if(r){if(r.biff>=2&&r.biff<=5)return ete(t);r.biff==12&&(i=4)}var s=t.read_shift(i),n=t.read_shift(i),o=Fd(t),l=Fd(t);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function ete(t){var e=Fd(t),r=Fd(t),i=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:i,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function JWe(t,e,r){if(r.biff<8)return ete(t);var i=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),n=Fd(t),o=Fd(t);return{s:{r:i,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function tte(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return QWe(t);var i=t.read_shift(r&&r.biff==12?4:2),s=Fd(t);return{r:i,c:s[0],cRel:s[1],rRel:s[2]}}function QWe(t){var e=Fd(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function ZWe(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function eje(t,e,r){var i=r&&r.biff?r.biff:8;if(i>=2&&i<=5)return tje(t);var s=t.read_shift(i>=12?4:2),n=t.read_shift(2),o=(n&16384)>>14,l=(n&32768)>>15;if(n&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:o,rRel:l}}function tje(t){var e=t.read_shift(2),r=t.read_shift(1),i=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,i==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:i}}function rje(t,e,r){var i=(t[t.l++]&96)>>5,s=Zee(t,r.biff>=2&&r.biff<=5?6:8,r);return[i,s]}function nje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}var o=Zee(t,n,r);return[i,s,o]}function ije(t,e,r){var i=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[i]}function sje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2),n=8;if(r)switch(r.biff){case 5:t.l+=12,n=6;break;case 12:n=12;break}return t.l+=n,[i,s]}function oje(t,e,r){var i=(t[t.l++]&96)>>5,s=JWe(t,e-1,r);return[i,s]}function aje(t,e,r){var i=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[i]}function uU(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function lje(t,e,r){t.l+=2;for(var i=t.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=i;++n)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function cje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function uje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=2,[i,t.read_shift(r&&r.biff==2?1:2)]}function hje(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function fje(t,e,r){var i=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[i]}function rte(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function dje(t){return t.read_shift(2),rte(t)}function gje(t){return t.read_shift(2),rte(t)}function mje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=tte(t,0,r);return[i,s]}function pje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=eje(t,0,r);return[i,s]}function vje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var n=tte(t,0,r);return[i,s,n]}function wje(t,e,r){var i=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[wUe[s],ste[s],i]}function yje(t,e,r){var i=t[t.l++],s=t.read_shift(1),n=r&&r.biff<=3?[i==88?-1:0,t.read_shift(1)]:Cje(t);return[s,(n[0]===0?ste:vUe)[n[1]]]}function Cje(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Sje(t,e,r){t.l+=r&&r.biff==2?3:4}function bje(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var i=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function xje(t){return t.l++,mS[t.read_shift(1)]}function Eje(t){return t.l++,t.read_shift(2)}function Tje(t){return t.l++,t.read_shift(1)!==0}function _je(t){return t.l++,W1(t)}function Rje(t,e,r){return t.l++,Hee(t,e-1,r)}function Aje(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vVe(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=mS[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=W1(t);break;case 2:r[1]=SVe(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Oje(t,e,r){for(var i=t.read_shift(r.biff==12?4:2),s=[],n=0;n!=i;++n)s.push((r.biff==12?rm:EVe)(t));return s}function Ije(t,e,r){var i=0,s=0;r.biff==12?(i=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),i=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--i,--s==0&&(s=256));for(var n=0,o=[];n!=i&&(o[n]=[]);++n)for(var l=0;l!=s;++l)o[n][l]=Aje(t,r.biff);return o}function Pje(t,e,r){var i=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[i,0,n]}function Fje(t,e,r){if(r.biff==5)return Mje(t);var i=t.read_shift(1)>>>5&3,s=t.read_shift(2),n=t.read_shift(4);return[i,s,n]}function Mje(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var i=t.read_shift(2);return t.l+=12,[e,r,i]}function kje(t,e,r){var i=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function Nje(t,e,r){var i=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[i,s]}function Dje(t,e,r){var i=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[i]}function Lje(t,e,r){var i=(t[t.l++]&96)>>5,s=t.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return t.l+=n,[i,s]}var Hje=Gu,$je=Gu,Bje=Gu;function pS(t,e,r){return t.l+=2,[ZWe(t)]}function Z6(t){return t.l+=6,[]}var Vje=pS,Wje=Z6,jje=Z6,Uje=pS;function nte(t){return t.l+=2,[Dee(t),t.read_shift(2)&1]}var zje=pS,Gje=nte,Yje=Z6,Kje=pS,Xje=pS,qje=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Jje(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(4),s=t.read_shift(2),n=t.read_shift(2),o=qje[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:i,c:s,C:n}}function Qje(t){return t.l+=2,[t.read_shift(4)]}function Zje(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function eUe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function tUe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function rUe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function nUe(t){return t.l+=4,[0,0]}var hU={1:{n:"PtgExp",f:bje},2:{n:"PtgTbl",f:Bje},3:{n:"PtgAdd",f:gs},4:{n:"PtgSub",f:gs},5:{n:"PtgMul",f:gs},6:{n:"PtgDiv",f:gs},7:{n:"PtgPower",f:gs},8:{n:"PtgConcat",f:gs},9:{n:"PtgLt",f:gs},10:{n:"PtgLe",f:gs},11:{n:"PtgEq",f:gs},12:{n:"PtgGe",f:gs},13:{n:"PtgGt",f:gs},14:{n:"PtgNe",f:gs},15:{n:"PtgIsect",f:gs},16:{n:"PtgUnion",f:gs},17:{n:"PtgRange",f:gs},18:{n:"PtgUplus",f:gs},19:{n:"PtgUminus",f:gs},20:{n:"PtgPercent",f:gs},21:{n:"PtgParen",f:gs},22:{n:"PtgMissArg",f:gs},23:{n:"PtgStr",f:Rje},26:{n:"PtgSheet",f:Zje},27:{n:"PtgEndSheet",f:eUe},28:{n:"PtgErr",f:xje},29:{n:"PtgBool",f:Tje},30:{n:"PtgInt",f:Eje},31:{n:"PtgNum",f:_je},32:{n:"PtgArray",f:aje},33:{n:"PtgFunc",f:wje},34:{n:"PtgFuncVar",f:yje},35:{n:"PtgName",f:Pje},36:{n:"PtgRef",f:mje},37:{n:"PtgArea",f:rje},38:{n:"PtgMemArea",f:kje},39:{n:"PtgMemErr",f:Hje},40:{n:"PtgMemNoMem",f:$je},41:{n:"PtgMemFunc",f:Nje},42:{n:"PtgRefErr",f:Dje},43:{n:"PtgAreaErr",f:ije},44:{n:"PtgRefN",f:pje},45:{n:"PtgAreaN",f:oje},46:{n:"PtgMemAreaN",f:tUe},47:{n:"PtgMemNoMemN",f:rUe},57:{n:"PtgNameX",f:Fje},58:{n:"PtgRef3d",f:vje},59:{n:"PtgArea3d",f:nje},60:{n:"PtgRefErr3d",f:Lje},61:{n:"PtgAreaErr3d",f:sje},255:{}},iUe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sUe={1:{n:"PtgElfLel",f:nte},2:{n:"PtgElfRw",f:Kje},3:{n:"PtgElfCol",f:Vje},6:{n:"PtgElfRwV",f:Xje},7:{n:"PtgElfColV",f:Uje},10:{n:"PtgElfRadical",f:zje},11:{n:"PtgElfRadicalS",f:Yje},13:{n:"PtgElfColS",f:Wje},15:{n:"PtgElfColSV",f:jje},16:{n:"PtgElfRadicalLel",f:Gje},25:{n:"PtgList",f:Jje},29:{n:"PtgSxName",f:Qje},255:{}},oUe={0:{n:"PtgAttrNoop",f:nUe},1:{n:"PtgAttrSemi",f:fje},2:{n:"PtgAttrIf",f:uje},4:{n:"PtgAttrChoose",f:lje},8:{n:"PtgAttrGoto",f:cje},16:{n:"PtgAttrSum",f:Sje},32:{n:"PtgAttrBaxcel",f:uU},33:{n:"PtgAttrBaxcel",f:uU},64:{n:"PtgAttrSpace",f:dje},65:{n:"PtgAttrSpaceSemi",f:gje},128:{n:"PtgAttrIfError",f:hje},255:{}};function aUe(t,e,r,i){if(i.biff<8)return Gu(t,e);for(var s=t.l+e,n=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Ije(t,0,i),n.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Oje(t,r[o][1],i),n.push(r[o][2]);break;case"PtgExp":i&&i.biff==12&&(r[o][1][1]=t.read_shift(4),n.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=s-t.l,e!==0&&n.push(Gu(t,e)),n}function lUe(t,e,r){for(var i=t.l+e,s,n,o=[];i!=t.l;)e=i-t.l,n=t[t.l],s=hU[n]||hU[iUe[n]],(n===24||n===25)&&(s=(n===24?sUe:oUe)[t[t.l+1]]),!s||!s.f?Gu(t,e):o.push([s.n,s.f(t,e,r)]);return o}function cUe(t){for(var e=[],r=0;r<t.length;++r){for(var i=t[r],s=[],n=0;n<i.length;++n){var o=i[n];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var uUe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hUe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ite(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var i=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!i)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[i[0]][0]){case 357:return s=i[1]==-1?"#REF":t.SheetNames[i[1]],i[1]==i[2]?s:s+":"+t.SheetNames[i[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[i[0]][0];case 355:default:return"SH33TJSSRC"+t[i[0]][0]}switch(t[i[0]][0][0]){case 1025:return s=i[1]==-1?"#REF":t.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?s:s+":"+t.SheetNames[i[2]];case 14849:return t[i[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return t[i[0]][0][3]?(s=i[1]==-1?"#REF":t[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?s:s+":"+t[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function fU(t,e,r){var i=ite(t,e,r);return i=="#REF"?i:hUe(i,r)}function v1(t,e,r,i,s){var n=s&&s.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],h,d,g,y=0,C=0,x,_="";if(!t[0]||!t[0][0])return"";for(var E=-1,R="",I=0,F=t[0].length;I<F;++I){var H=t[0][I];switch(H[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=l.pop(),d=l.pop(),E>=0){switch(t[0][E][1][0]){case 0:R=Qi(" ",t[0][E][1][1]);break;case 1:R=Qi("\r",t[0][E][1][1]);break;default:if(R="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}d=d+R,E=-1}l.push(d+uUe[H[0]]+h);break;case"PtgIsect":h=l.pop(),d=l.pop(),l.push(d+" "+h);break;case"PtgUnion":h=l.pop(),d=l.pop(),l.push(d+","+h);break;case"PtgRange":h=l.pop(),d=l.pop(),l.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Ry(H[1][1],o,s),l.push(Ay(g,n));break;case"PtgRefN":g=r?Ry(H[1][1],r,s):H[1][1],l.push(Ay(g,n));break;case"PtgRef3d":y=H[1][1],g=Ry(H[1][2],o,s),_=fU(i,y,s),l.push(_+"!"+Ay(g,n));break;case"PtgFunc":case"PtgFuncVar":var z=H[1][0],q=H[1][1];z||(z=0),z&=127;var re=z==0?[]:l.slice(-z);l.length-=z,q==="User"&&(q=re.shift()),l.push(q+"("+re.join(",")+")");break;case"PtgBool":l.push(H[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(H[1]);break;case"PtgNum":l.push(String(H[1]));break;case"PtgStr":l.push('"'+H[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(H[1]);break;case"PtgAreaN":x=qj(H[1][1],r?{s:r}:o,s),l.push(g3(x,s));break;case"PtgArea":x=qj(H[1][1],o,s),l.push(g3(x,s));break;case"PtgArea3d":y=H[1][1],x=H[1][2],_=fU(i,y,s),l.push(_+"!"+g3(x,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":C=H[1][2];var Y=(i.names||[])[C-1]||(i[0]||[])[C],oe=Y?Y.Name:"SH33TJSNAME"+String(C);oe&&oe.slice(0,6)=="_xlfn."&&!s.xlfn&&(oe=oe.slice(6)),l.push(oe);break;case"PtgNameX":var me=H[1][1];C=H[1][2];var de;if(s.biff<=5)me<0&&(me=-me),i[me]&&(de=i[me][C]);else{var Re="";if(((i[me]||[])[0]||[])[0]==14849||(((i[me]||[])[0]||[])[0]==1025?i[me][C]&&i[me][C].itab>0&&(Re=i.SheetNames[i[me][C].itab-1]+"!"):Re=i.SheetNames[C-1]+"!"),i[me]&&i[me][C])Re+=i[me][C].Name;else if(i[0]&&i[0][C])Re+=i[0][C].Name;else{var Ie=(ite(i,me,s)||"").split(";;");Ie[C-1]?Re=Ie[C-1]:Re+="SH33TJSERRX"}l.push(Re);break}de||(de={Name:"SH33TJSERRY"}),l.push(de.Name);break;case"PtgParen":var Be="(",lt=")";if(E>=0){switch(R="",t[0][E][1][0]){case 2:Be=Qi(" ",t[0][E][1][1])+Be;break;case 3:Be=Qi("\r",t[0][E][1][1])+Be;break;case 4:lt=Qi(" ",t[0][E][1][1])+lt;break;case 5:lt=Qi("\r",t[0][E][1][1])+lt;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}l.push(Be+l.pop()+lt);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":g={c:H[1][1],r:H[1][0]};var pt={c:r.c,r:r.r};if(i.sharedf[Xn(g)]){var Ct=i.sharedf[Xn(g)];l.push(v1(Ct,o,pt,i,s))}else{var ct=!1;for(h=0;h!=i.arrayf.length;++h)if(d=i.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){l.push(v1(d[1],o,pt,i,s)),ct=!0;break}ct||l.push(H[1])}break;case"PtgArray":l.push("{"+cUe(H[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+H[1].idx+"[#"+H[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(H));default:throw new Error("Unrecognized Formula Token: "+String(H))}var Ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&E>=0&&Ue.indexOf(t[0][I][0])==-1){H=t[0][E];var Je=!0;switch(H[1][0]){case 4:Je=!1;case 0:R=Qi(" ",H[1][1]);break;case 5:Je=!1;case 1:R=Qi("\r",H[1][1]);break;default:if(R="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+H[1][0])}l.push((Je?R:"")+l.pop()+(Je?"":R)),E=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function fUe(t){if(t==null){var e=rt(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Lg(t);return Lg(0)}function dUe(t,e,r,i,s){var n=Hg(e,r,s),o=fUe(t.v),l=rt(6),h=33;l.write_shift(2,h),l.write_shift(4,0);for(var d=rt(t.bf.length),g=0;g<t.bf.length;++g)d[g]=t.bf[g];var y=oo([n,o,l,d]);return y}function yR(t,e,r){var i=t.read_shift(4),s=lUe(t,i,r),n=t.read_shift(4),o=n>0?aUe(t,n,s,r):null;return[s,o]}var gUe=yR,CR=yR,mUe=yR,pUe=yR,vUe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ste={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wUe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function yUe(t){var e="of:="+t.replace(J6,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function CUe(t){return t.replace(/\./,"!")}var Oy=typeof Map<"u";function e5(t,e,r){var i=0,s=t.length;if(r){if(Oy?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var n=Oy?r.get(e):r[e];i<n.length;++i)if(t[n[i]].t===e)return t.Count++,n[i]}}else for(;i<s;++i)if(t[i].t===e)return t.Count++,i;return t[s]={t:e},t.Count++,t.Unique++,r&&(Oy?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function SR(t,e){var r={min:t+1,max:t+1},i=-1;return e.MDW&&(Xh=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?i=zT(e.wpx):e.wch!=null&&(i=e.wch),i>-1?(r.width=UF(i),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function ote(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Vd(t,e,r){var i=r.revssf[e.z!=null?e.z:"General"],s=60,n=t.length;if(i==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){tee(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=i=s;break}}for(s=0;s!=n;++s)if(t[s].numFmtId===i)return s;return t[n]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},n}function SUe(t,e,r){if(t&&t["!ref"]){var i=Si(t["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bUe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+ys(t[r])+'"/>';return e+"</mergeCells>"}function xUe(t,e,r,i,s){var n=!1,o={},l=null;if(i.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}n=!0,o.codeName=SC(Yn(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+kt("outlinePr",null,d)}!n&&!l||(s[s.length]=kt("sheetPr",l,o))}var EUe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],TUe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _Ue(t){var e={sheet:1};return EUe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),TUe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=jee(t.password).toString(16).toUpperCase()),kt("sheetProtection",null,e)}function RUe(t){return ote(t),kt("pageMargins",null,t)}function AUe(t,e){for(var r=["<cols>"],i,s=0;s!=e.length;++s)(i=e[s])&&(r[r.length]=kt("col",null,SR(s,i)));return r[r.length]="</cols>",r.join("")}function OUe(t,e,r,i){var s=typeof t.ref=="string"?t.ref:ys(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var n=r.Workbook.Names,o=cl(s);o.s.r==o.e.r&&(o.e.r=cl(e["!ref"]).e.r,s=ys(o));for(var l=0;l<n.length;++l){var h=n[l];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+r.SheetNames[i]+"'!"+s;break}}return l==n.length&&n.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+s}),kt("autoFilter",null,{ref:s})}function IUe(t,e,r,i){var s={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),kt("sheetViews",kt("sheetView",null,s),{})}function PUe(t,e,r,i){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",n=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=mS[t.v];break;case"d":i&&i.cellDates?s=oa(t.v,-1).toISOString():(t=Da(t),t.t="n",s=""+(t.v=Na(oa(t.v)))),typeof t.z>"u"&&(t.z=ts[14]);break;default:s=t.v;break}var l=ao("v",Yn(s)),h={r:e},d=Vd(i.cellXfs,t,i);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){l=ao("v",""+e5(i.Strings,t.v,i.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=n&&(t.t=n,t.v=o),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;l=kt("f",Yn(t.f),g)+(t.v!=null?l:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),kt("c",l,h)}function FUe(t,e,r,i){var s=[],n=[],o=Si(t["!ref"]),l="",h,d="",g=[],y=0,C=0,x=t["!rows"],_=Array.isArray(t),E={r:d},R,I=-1;for(C=o.s.c;C<=o.e.c;++C)g[C]=Do(C);for(y=o.s.r;y<=o.e.r;++y){for(n=[],d=uo(y),C=o.s.c;C<=o.e.c;++C){h=g[C]+d;var F=_?(t[y]||[])[C]:t[h];F!==void 0&&(l=PUe(F,h,t,e))!=null&&n.push(l)}(n.length>0||x&&x[y])&&(E={r:d},x&&x[y]&&(R=x[y],R.hidden&&(E.hidden=1),I=-1,R.hpx?I=GT(R.hpx):R.hpt&&(I=R.hpt),I>-1&&(E.ht=I,E.customHeight=1),R.level&&(E.outlineLevel=R.level)),s[s.length]=kt("row",n.join(""),E))}if(x)for(;y<x.length;++y)x&&x[y]&&(E={r:y+1},R=x[y],R.hidden&&(E.hidden=1),I=-1,R.hpx?I=GT(R.hpx):R.hpt&&(I=R.hpt),I>-1&&(E.ht=I,E.customHeight=1),R.level&&(E.outlineLevel=R.level),s[s.length]=kt("row","",E));return s.join("")}function ate(t,e,r,i){var s=[Es,kt("worksheet",null,{xmlns:$1[0],"xmlns:r":Gs.r})],n=r.SheetNames[t],o=0,l="",h=r.Sheets[n];h==null&&(h={});var d=h["!ref"]||"A1",g=Si(d);if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),d=ys(g)}i||(i={}),h["!comments"]=[];var y=[];xUe(h,r,t,e,s),s[s.length]=kt("dimension",null,{ref:d}),s[s.length]=IUe(h,e,t,r),e.sheetFormat&&(s[s.length]=kt("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(s[s.length]=AUe(h,h["!cols"])),s[o=s.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(l=FUe(h,e),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),h["!protect"]&&(s[s.length]=_Ue(h["!protect"])),h["!autofilter"]!=null&&(s[s.length]=OUe(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(s[s.length]=bUe(h["!merges"]));var C=-1,x,_=-1;return h["!links"].length>0&&(s[s.length]="<hyperlinks>",h["!links"].forEach(function(E){E[1].Target&&(x={ref:E[0]},E[1].Target.charAt(0)!="#"&&(_=Gn(i,-1,Yn(E[1].Target).replace(/#.*$/,""),_n.HLINK),x["r:id"]="rId"+_),(C=E[1].Target.indexOf("#"))>-1&&(x.location=Yn(E[1].Target.slice(C+1))),E[1].Tooltip&&(x.tooltip=Yn(E[1].Tooltip)),s[s.length]=kt("hyperlink",null,x))}),s[s.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(s[s.length]=RUe(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=ao("ignoredErrors",kt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),y.length>0&&(_=Gn(i,-1,"../drawings/drawing"+(t+1)+".xml",_n.DRAW),s[s.length]=kt("drawing",null,{"r:id":"rId"+_}),h["!drawing"]=y),h["!comments"].length>0&&(_=Gn(i,-1,"../drawings/vmlDrawing"+(t+1)+".vml",_n.VML),s[s.length]=kt("legacyDrawing",null,{"r:id":"rId"+_}),h["!legacy"]=_),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function MUe(t,e){var r={},i=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var n=t.read_shift(1);return t.l=i,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}function kUe(t,e,r){var i=rt(145),s=(r["!rows"]||[])[t]||{};i.write_shift(4,t),i.write_shift(4,0);var n=320;s.hpx?n=GT(s.hpx)*20:s.hpt&&(n=s.hpt*20),i.write_shift(2,n),i.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),i.write_shift(1,o),i.write_shift(1,0);var l=0,h=i.l;i.l+=4;for(var d={r:t,c:0},g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var y=-1,C=-1,x=g<<10;x<g+1<<10;++x){d.c=x;var _=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Xn(d)];_&&(y<0&&(y=x),C=x)}y<0||(++l,i.write_shift(4,y),i.write_shift(4,C))}var E=i.l;return i.l=h,i.write_shift(4,l),i.l=E,i.length>i.l?i.slice(0,i.l):i}function NUe(t,e,r,i){var s=kUe(i,r,e);(s.length>17||(e["!rows"]||[])[i])&&dt(t,0,s)}var DUe=rm,LUe=V1;function HUe(){}function $Ue(t,e){var r={},i=t[t.l];return++t.l,r.above=!(i&64),r.left=!(i&128),t.l+=18,r.name=XBe(t),r}function BUe(t,e,r){r==null&&(r=rt(84+4*t.length));var i=192;e&&(e.above&&(i&=-65),e.left&&(i&=-129)),r.write_shift(1,i);for(var s=1;s<3;++s)r.write_shift(1,0);return WT({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),bee(t,r),r.slice(0,r.l)}function VUe(t){var e=Jl(t);return[e]}function WUe(t,e,r){return r==null&&(r=rt(8)),Zg(e,r)}function jUe(t){var e=em(t);return[e]}function UUe(t,e,r){return r==null&&(r=rt(4)),tm(e,r)}function zUe(t){var e=Jl(t),r=t.read_shift(1);return[e,r,"b"]}function GUe(t,e,r){return r==null&&(r=rt(9)),Zg(e,r),r.write_shift(1,t.v?1:0),r}function YUe(t){var e=em(t),r=t.read_shift(1);return[e,r,"b"]}function KUe(t,e,r){return r==null&&(r=rt(5)),tm(e,r),r.write_shift(1,t.v?1:0),r}function XUe(t){var e=Jl(t),r=t.read_shift(1);return[e,r,"e"]}function qUe(t,e,r){return r==null&&(r=rt(9)),Zg(e,r),r.write_shift(1,t.v),r}function JUe(t){var e=em(t),r=t.read_shift(1);return[e,r,"e"]}function QUe(t,e,r){return r==null&&(r=rt(8)),tm(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ZUe(t){var e=Jl(t),r=t.read_shift(4);return[e,r,"s"]}function eze(t,e,r){return r==null&&(r=rt(12)),Zg(e,r),r.write_shift(4,e.v),r}function tze(t){var e=em(t),r=t.read_shift(4);return[e,r,"s"]}function rze(t,e,r){return r==null&&(r=rt(8)),tm(e,r),r.write_shift(4,e.v),r}function nze(t){var e=Jl(t),r=W1(t);return[e,r,"n"]}function ize(t,e,r){return r==null&&(r=rt(16)),Zg(e,r),Lg(t.v,r),r}function sze(t){var e=em(t),r=W1(t);return[e,r,"n"]}function oze(t,e,r){return r==null&&(r=rt(12)),tm(e,r),Lg(t.v,r),r}function aze(t){var e=Jl(t),r=xee(t);return[e,r,"n"]}function lze(t,e,r){return r==null&&(r=rt(12)),Zg(e,r),Eee(t.v,r),r}function cze(t){var e=em(t),r=xee(t);return[e,r,"n"]}function uze(t,e,r){return r==null&&(r=rt(8)),tm(e,r),Eee(t.v,r),r}function hze(t){var e=Jl(t),r=G6(t);return[e,r,"is"]}function fze(t){var e=Jl(t),r=Lo(t);return[e,r,"str"]}function dze(t,e,r){return r==null&&(r=rt(12+4*t.v.length)),Zg(e,r),Ks(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gze(t){var e=em(t),r=Lo(t);return[e,r,"str"]}function mze(t,e,r){return r==null&&(r=rt(8+4*t.v.length)),tm(e,r),Ks(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pze(t,e,r){var i=t.l+e,s=Jl(t);s.r=r["!row"];var n=t.read_shift(1),o=[s,n,"b"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function vze(t,e,r){var i=t.l+e,s=Jl(t);s.r=r["!row"];var n=t.read_shift(1),o=[s,n,"e"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function wze(t,e,r){var i=t.l+e,s=Jl(t);s.r=r["!row"];var n=W1(t),o=[s,n,"n"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}function yze(t,e,r){var i=t.l+e,s=Jl(t);s.r=r["!row"];var n=Lo(t),o=[s,n,"str"];if(r.cellFormula){t.l+=2;var l=CR(t,i-t.l,r);o[3]=v1(l,null,s,r.supbooks,r)}else t.l=i;return o}var Cze=rm,Sze=V1;function bze(t,e){return e==null&&(e=rt(4)),e.write_shift(4,t),e}function xze(t,e){var r=t.l+e,i=rm(t),s=Y6(t),n=Lo(t),o=Lo(t),l=Lo(t);t.l=r;var h={rfx:i,relId:s,loc:n,display:l};return o&&(h.Tooltip=o),h}function Eze(t,e){var r=rt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));V1({s:Ys(t[0]),e:Ys(t[0])},r),K6("rId"+e,r);var i=t[1].Target.indexOf("#"),s=i==-1?"":t[1].Target.slice(i+1);return Ks(s||"",r),Ks(t[1].Tooltip||"",r),Ks("",r),r.slice(0,r.l)}function Tze(){}function _ze(t,e,r){var i=t.l+e,s=Tee(t),n=t.read_shift(1),o=[s];if(o[2]=n,r.cellFormula){var l=gUe(t,i-t.l,r);o[1]=l}else t.l=i;return o}function Rze(t,e,r){var i=t.l+e,s=rm(t),n=[s];if(r.cellFormula){var o=pUe(t,i-t.l,r);n[1]=o,t.l=i}else t.l=i;return n}function Aze(t,e,r){r==null&&(r=rt(18));var i=SR(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(i.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof i.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var lte=["left","right","top","bottom","header","footer"];function Oze(t){var e={};return lte.forEach(function(r){e[r]=W1(t)}),e}function Ize(t,e){return e==null&&(e=rt(6*8)),ote(t),lte.forEach(function(r){Lg(t[r],e)}),e}function Pze(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Fze(t,e,r){r==null&&(r=rt(30));var i=924;return(((e||{}).Views||[])[0]||{}).RTL&&(i|=32),r.write_shift(2,i),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Mze(t){var e=rt(24);return e.write_shift(4,4),e.write_shift(4,1),V1(t,e),e}function kze(t,e){return e==null&&(e=rt(16*4+2)),e.write_shift(2,t.password?jee(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Nze(){}function Dze(){}function Lze(t,e,r,i,s,n,o){if(e.v===void 0)return!1;var l="";switch(e.t){case"b":l=e.v?"1":"0";break;case"d":e=Da(e),e.z=e.z||ts[14],e.v=Na(oa(e.v)),e.t="n";break;case"n":case"e":l=""+e.v;break;default:l=e.v;break}var h={r,c:i};switch(h.s=Vd(s.cellXfs,e,s),e.l&&n["!links"].push([Xn(h),e.l]),e.c&&n["!comments"].push([Xn(h),e.c]),e.t){case"s":case"str":return s.bookSST?(l=e5(s.Strings,e.v,s.revStrings),h.t="s",h.v=l,o?dt(t,18,rze(e,h)):dt(t,7,eze(e,h))):(h.t="str",o?dt(t,17,mze(e,h)):dt(t,6,dze(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?dt(t,13,uze(e,h)):dt(t,2,lze(e,h)):o?dt(t,16,oze(e,h)):dt(t,5,ize(e,h)),!0;case"b":return h.t="b",o?dt(t,15,KUe(e,h)):dt(t,4,GUe(e,h)),!0;case"e":return h.t="e",o?dt(t,14,QUe(e,h)):dt(t,3,qUe(e,h)),!0}return o?dt(t,12,UUe(e,h)):dt(t,1,WUe(e,h)),!0}function Hze(t,e,r,i){var s=Si(e["!ref"]||"A1"),n,o="",l=[];dt(t,145);var h=Array.isArray(e),d=s.e.r;e["!rows"]&&(d=Math.max(s.e.r,e["!rows"].length-1));for(var g=s.s.r;g<=d;++g){o=uo(g),NUe(t,e,s,g);var y=!1;if(g<=s.e.r)for(var C=s.s.c;C<=s.e.c;++C){g===s.s.r&&(l[C]=Do(C)),n=l[C]+o;var x=h?(e[g]||[])[C]:e[n];if(!x){y=!1;continue}y=Lze(t,x,g,C,i,e,y)}}dt(t,146)}function $ze(t,e){!e||!e["!merges"]||(dt(t,177,bze(e["!merges"].length)),e["!merges"].forEach(function(r){dt(t,176,Sze(r))}),dt(t,178))}function Bze(t,e){!e||!e["!cols"]||(dt(t,390),e["!cols"].forEach(function(r,i){r&&dt(t,60,Aze(i,r))}),dt(t,391))}function Vze(t,e){!e||!e["!ref"]||(dt(t,648),dt(t,649,Mze(Si(e["!ref"]))),dt(t,650))}function Wze(t,e,r){e["!links"].forEach(function(i){if(i[1].Target){var s=Gn(r,-1,i[1].Target.replace(/#.*$/,""),_n.HLINK);dt(t,494,Eze(i,s))}}),delete e["!links"]}function jze(t,e,r,i){if(e["!comments"].length>0){var s=Gn(i,-1,"../drawings/vmlDrawing"+(r+1)+".vml",_n.VML);dt(t,551,K6("rId"+s)),e["!legacy"]=s}}function Uze(t,e,r,i){if(e["!autofilter"]){var s=e["!autofilter"],n=typeof s.ref=="string"?s.ref:ys(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=cl(n);l.s.r==l.e.r&&(l.e.r=cl(e["!ref"]).e.r,n=ys(l));for(var h=0;h<o.length;++h){var d=o[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==i){d.Ref="'"+r.SheetNames[i]+"'!"+n;break}}h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+r.SheetNames[i]+"'!"+n}),dt(t,161,V1(Si(n))),dt(t,162)}}function zze(t,e,r){dt(t,133),dt(t,137,Fze(e,r)),dt(t,138),dt(t,134)}function Gze(t,e){e["!protect"]&&dt(t,535,kze(e["!protect"]))}function Yze(t,e,r,i){var s=Ma(),n=r.SheetNames[t],o=r.Sheets[n]||{},l=n;try{r&&r.Workbook&&(l=r.Workbook.Sheets[t].CodeName||l)}catch{}var h=Si(o["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],dt(s,129),(r.vbaraw||o["!outline"])&&dt(s,147,BUe(l,o["!outline"])),dt(s,148,LUe(h)),zze(s,o,r.Workbook),Bze(s,o),Hze(s,o,t,e),Gze(s,o),Uze(s,o,r,t),$ze(s,o),Wze(s,o,i),o["!margins"]&&dt(s,476,Ize(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Vze(s,o),jze(s,o,t,i),dt(s,130),s.end()}function Kze(t,e){t.l+=10;var r=Lo(t);return{name:r}}var Xze=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function qze(t){return!t.Workbook||!t.Workbook.WBProps?"false":RBe(t.Workbook.WBProps.date1904)?"true":"false"}var Jze="][*?/\\".split("");function cte(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Jze.forEach(function(i){if(t.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Qze(t,e,r){t.forEach(function(i,s){cte(i);for(var n=0;n<s;++n)if(i==t[n])throw new Error("Duplicate Sheet Name: "+i);if(r){var o=e[s]&&e[s].CodeName||i;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Zze(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];Qze(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)SUe(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function ute(t){var e=[Es];e[e.length]=kt("workbook",null,{xmlns:$1[0],"xmlns:r":Gs.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Xze.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(i[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(i.codeName=t.Workbook.WBProps.CodeName,delete i.CodeName)),e[e.length]=kt("workbookPr",null,i);var s=t.Workbook&&t.Workbook.Sheets||[],n=0;if(s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",n=0;n!=t.SheetNames.length&&!(!s[n]||!s[n].Hidden);++n);n==t.SheetNames.length&&(n=0),e[e.length]='<workbookView firstSheet="'+n+'" activeTab="'+n+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",n=0;n!=t.SheetNames.length;++n){var o={name:Yn(t.SheetNames[n].slice(0,31))};if(o.sheetId=""+(n+1),o["r:id"]="rId"+(n+1),s[n])switch(s[n].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=kt("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var h={name:l.Name};l.Comment&&(h.comment=l.Comment),l.Sheet!=null&&(h.localSheetId=""+l.Sheet),l.Hidden&&(h.hidden="1"),l.Ref&&(e[e.length]=kt("definedName",Yn(l.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function eGe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=jF(t),r.name=Lo(t),r}function tGe(t,e){return e||(e=rt(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),K6(t.strRelID,e),Ks(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function rGe(t,e){var r={},i=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Lo(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(i&65536),r.backupFile=!!(i&64),r.checkCompatibility=!!(i&4096),r.date1904=!!(i&1),r.filterPrivacy=!!(i&8),r.hidePivotFieldList=!!(i&1024),r.promptedSolutions=!!(i&16),r.publishItems=!!(i&2048),r.refreshAllConnections=!!(i&262144),r.saveExternalLinkValues=!!(i&128),r.showBorderUnselectedTables=!!(i&4),r.showInkAnnotation=!!(i&32),r.showObjects=["all","placeholders","none"][i>>13&3],r.showPivotChartFilter=!!(i&32768),r.updateLinks=["userSet","never","always"][i>>8&3],r}function nGe(t,e){e||(e=rt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),bee(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function iGe(t,e,r){var i=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),n=qBe(t),o=mUe(t,0,r),l=Y6(t);t.l=i;var h={Name:n,Ptg:o};return s<268435455&&(h.Sheet=s),l&&(h.Comment=l),h}function sGe(t,e){dt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var i=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:i,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};dt(t,156,tGe(s))}dt(t,144)}function oGe(t,e){e||(e=rt(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Ks("SheetJS",e),Ks(kT.version,e),Ks(kT.version,e),Ks("7262",e),e.length>e.l?e.slice(0,e.l):e}function aGe(t,e){e||(e=rt(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function lGe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,i=0,s=-1,n=-1;i<r.length;++i)!r[i]||!r[i].Hidden&&s==-1?s=i:r[i].Hidden==1&&n==-1&&(n=i);n>s||(dt(t,135),dt(t,158,aGe(s)),dt(t,136))}}function cGe(t,e){var r=Ma();return dt(r,131),dt(r,128,oGe()),dt(r,153,nGe(t.Workbook&&t.Workbook.WBProps||null)),lGe(r,t),sGe(r,t),dt(r,132),r.end()}function uGe(t,e,r){return(e.slice(-4)===".bin"?cGe:ute)(t)}function hGe(t,e,r,i,s){return(e.slice(-4)===".bin"?Yze:ate)(t,r,i,s)}function fGe(t,e,r){return(e.slice(-4)===".bin"?IWe:Gee)(t,r)}function dGe(t,e,r){return(e.slice(-4)===".bin"?nWe:Wee)(t,r)}function gGe(t,e,r){return(e.slice(-4)===".bin"?GWe:Jee)(t)}function mGe(t){return(t.slice(-4)===".bin"?HWe:Xee)()}function pGe(t,e){var r=[];return t.Props&&r.push(fVe(t.Props,e)),t.Custprops&&r.push(dVe(t.Props,t.Custprops)),r.join("")}function vGe(){return""}function wGe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(i,s){var n=[];n.push(kt("NumberFormat",null,{"ss:Format":Yn(ts[i.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(kt("Style",n.join(""),o))}),kt("Styles",r.join(""))}function hte(t){return kt("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Q6(t.Ref,{r:0,c:0})})}function yGe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],i=0;i<e.length;++i){var s=e[i];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(hte(s)))}return kt("Names",r.join(""))}function CGe(t,e,r,i){if(!t||!((i||{}).Workbook||{}).Names)return"";for(var s=i.Workbook.Names,n=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||n.push(hte(l)))}return n.join("")}function SGe(t,e,r,i){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(kt("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(kt("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(kt("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[r])if(i.Workbook.Sheets[r].Hidden)s.push(kt("Visible",i.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var n=0;n<r&&!(i.Workbook.Sheets[n]&&!i.Workbook.Sheets[n].Hidden);++n);n==r&&s.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(ao("ProtectContents","True")),t["!protect"].objects&&s.push(ao("ProtectObjects","True")),t["!protect"].scenarios&&s.push(ao("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(ao("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(ao("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":kt("WorksheetOptions",s.join(""),{xmlns:el.x})}function bGe(t){return t.map(function(e){var r=_Be(e.t||""),i=kt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return kt("Comment",i,{"ss:Author":e.a})}).join("")}function xGe(t,e,r,i,s,n,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Yn(Q6(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var h=Ys(t.F.slice(e.length+1));l["ss:ArrayRange"]="RC:R"+(h.r==o.r?"":"["+(h.r-o.r)+"]")+"C"+(h.c==o.c?"":"["+(h.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Yn(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Yn(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],g=0;g!=d.length;++g)d[g].s.c!=o.c||d[g].s.r!=o.r||(d[g].e.c>d[g].s.c&&(l["ss:MergeAcross"]=d[g].e.c-d[g].s.c),d[g].e.r>d[g].s.r&&(l["ss:MergeDown"]=d[g].e.r-d[g].s.r));var y="",C="";switch(t.t){case"z":if(!i.sheetStubs)return"";break;case"n":y="Number",C=String(t.v);break;case"b":y="Boolean",C=t.v?"1":"0";break;case"e":y="Error",C=mS[t.v];break;case"d":y="DateTime",C=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ts[14]);break;case"s":y="String",C=TBe(t.v||"");break}var x=Vd(i.cellXfs,t,i);l["ss:StyleID"]="s"+(21+x),l["ss:Index"]=o.c+1;var _=t.v!=null?C:"",E=t.t=="z"?"":'<Data ss:Type="'+y+'">'+_+"</Data>";return(t.c||[]).length>0&&(E+=bGe(t.c)),kt("Cell",E,l)}function EGe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=zee(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function TGe(t,e,r,i){if(!t["!ref"])return"";var s=Si(t["!ref"]),n=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(R,I){q6(R);var F=!!R.width,H=SR(I,R),z={"ss:Index":I+1};F&&(z["ss:Width"]=UT(H.width)),R.hidden&&(z["ss:Hidden"]="1"),l.push(kt("Column",null,z))});for(var h=Array.isArray(t),d=s.s.r;d<=s.e.r;++d){for(var g=[EGe(d,(t["!rows"]||[])[d])],y=s.s.c;y<=s.e.c;++y){var C=!1;for(o=0;o!=n.length;++o)if(!(n[o].s.c>y)&&!(n[o].s.r>d)&&!(n[o].e.c<y)&&!(n[o].e.r<d)){(n[o].s.c!=y||n[o].s.r!=d)&&(C=!0);break}if(!C){var x={r:d,c:y},_=Xn(x),E=h?(t[d]||[])[y]:t[_];g.push(xGe(E,_,t,e,r,i,x))}}g.push("</Row>"),g.length>2&&l.push(g.join(""))}return l.join("")}function _Ge(t,e,r){var i=[],s=r.SheetNames[t],n=r.Sheets[s],o=n?CGe(n,e,t,r):"";return o.length>0&&i.push("<Names>"+o+"</Names>"),o=n?TGe(n,e,t,r):"",o.length>0&&i.push("<Table>"+o+"</Table>"),i.push(SGe(n,e,t,r)),i.join("")}function RGe(t,e){e||(e={}),t.SSF||(t.SSF=Da(ts)),t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Vd(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(pGe(t,e)),r.push(vGe()),r.push(""),r.push("");for(var i=0;i<t.SheetNames.length;++i)r.push(kt("Worksheet",_Ge(i,e,t),{"ss:Name":Yn(t.SheetNames[i])}));return r[2]=wGe(t,e),r[3]=yGe(t),Es+kt("Workbook",r.join(""),{xmlns:el.ss,"xmlns:o":el.o,"xmlns:x":el.x,"xmlns:ss":el.ss,"xmlns:dt":el.dt,"xmlns:html":el.html})}var v3={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function AGe(t,e){var r=[],i=[],s=[],n=0,o,l=$j(Qj,"n"),h=$j(Zj,"n");if(t.Props)for(o=fo(t.Props),n=0;n<o.length;++n)(Object.prototype.hasOwnProperty.call(l,o[n])?r:Object.prototype.hasOwnProperty.call(h,o[n])?i:s).push([o[n],t.Props[o[n]]]);if(t.Custprops)for(o=fo(t.Custprops),n=0;n<o.length;++n)Object.prototype.hasOwnProperty.call(t.Props||{},o[n])||(Object.prototype.hasOwnProperty.call(l,o[n])?r:Object.prototype.hasOwnProperty.call(h,o[n])?i:s).push([o[n],t.Custprops[o[n]]]);var d=[];for(n=0;n<s.length;++n)Nee.indexOf(s[n][0])>-1||Fee.indexOf(s[n][0])>-1||s[n][1]!=null&&d.push(s[n]);i.length&&ti.utils.cfb_add(e,"/SummaryInformation",iU(i,v3.SI,h,Zj)),(r.length||d.length)&&ti.utils.cfb_add(e,"/DocumentSummaryInformation",iU(r,v3.DSI,l,Qj,d.length?d:null,v3.UDI))}function OGe(t,e){var r=e,i=ti.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ti.utils.cfb_add(i,s,fte(t,r)),r.biff==8&&(t.Props||t.Custprops)&&AGe(t,i),r.biff==8&&t.vbaraw&&YWe(i,ti.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),i}var IGe={0:{f:MUe},1:{f:VUe},2:{f:aze},3:{f:XUe},4:{f:zUe},5:{f:nze},6:{f:fze},7:{f:ZUe},8:{f:yze},9:{f:wze},10:{f:pze},11:{f:vze},12:{f:jUe},13:{f:cze},14:{f:JUe},15:{f:YUe},16:{f:sze},17:{f:gze},18:{f:tze},19:{f:G6},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:iGe},40:{},42:{},43:{f:fWe},44:{f:uWe},45:{f:mWe},46:{f:vWe},47:{f:pWe},48:{},49:{f:jBe},50:{},51:{f:MWe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:UVe},62:{f:hze},63:{f:$We},64:{f:Nze},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gu,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Pze},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:$Ue},148:{f:DUe,p:16},151:{f:Tze},152:{},153:{f:rGe},154:{},155:{},156:{f:eGe},157:{},158:{},159:{T:1,f:eWe},160:{T:-1},161:{T:1,f:rm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Cze},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PWe},336:{T:-1},337:{f:DWe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jF},357:{},358:{},359:{},360:{T:1},361:{},362:{f:HVe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_ze},427:{f:Rze},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Oze},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:HUe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:xze},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jF},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:UWe},633:{T:1},634:{T:-1},635:{T:1,f:WWe},636:{T:-1},637:{f:YBe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Kze},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Dze},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Lt(t,e,r,i){var s=e;if(!isNaN(s)){var n=i||(r||[]).length||0,o=t.next(4);o.write_shift(2,s),o.write_shift(2,n),n>0&&j6(r)&&t.push(r)}}function PGe(t,e,r,i){var s=(r||[]).length||0;if(s<=8224)return Lt(t,e,r,s);var n=e;if(!isNaN(n)){for(var o=r.parts||[],l=0,h=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var g=t.next(4);for(g.write_shift(2,n),g.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<s;){for(g=t.next(4),g.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;g.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function vS(t,e,r){return t||(t=rt(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function FGe(t,e,r,i){var s=rt(9);return vS(s,t,e),Lee(r,i||"b",s),s}function MGe(t,e,r){var i=rt(8+2*r.length);return vS(i,t,e),i.write_shift(1,r.length),i.write_shift(r.length,r,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function kGe(t,e,r,i){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?Na(oa(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Lt(t,2,KVe(r,i,s)):Lt(t,3,YVe(r,i,s));return;case"b":case"e":Lt(t,5,FGe(r,i,e.v,e.t));return;case"s":case"str":Lt(t,4,MGe(r,i,(e.v||"").slice(0,255)));return}Lt(t,1,vS(null,r,i))}function NGe(t,e,r,i){var s=Array.isArray(e),n=Si(e["!ref"]||"A1"),o,l="",h=[];if(n.e.c>255||n.e.r>16383){if(i.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");n.e.c=Math.min(n.e.c,255),n.e.r=Math.min(n.e.c,16383),o=ys(n)}for(var d=n.s.r;d<=n.e.r;++d){l=uo(d);for(var g=n.s.c;g<=n.e.c;++g){d===n.s.r&&(h[g]=Do(g)),o=h[g]+l;var y=s?(e[d]||[])[g]:e[o];y&&kGe(t,y,d,g)}}}function DGe(t,e){for(var r=e||{},i=Ma(),s=0,n=0;n<t.SheetNames.length;++n)t.SheetNames[n]==r.sheet&&(s=n);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Lt(i,r.biff==4?1033:r.biff==3?521:9,X6(t,16,r)),NGe(i,t.Sheets[t.SheetNames[s]],s,r),Lt(i,10),i.end()}function LGe(t,e,r){Lt(t,49,IVe({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function HGe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var s=i[0];s<=i[1];++s)e[s]!=null&&Lt(t,1054,MVe(s,e[s],r))})}function $Ge(t,e){var r=rt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Lt(t,2151,r),r=rt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Bee(Si(e["!ref"]||"A1"),r),r.write_shift(4,4),Lt(t,2152,r)}function BGe(t,e){for(var r=0;r<16;++r)Lt(t,224,oU({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(i){Lt(t,224,oU(i,0,e))})}function VGe(t,e){for(var r=0;r<e["!links"].length;++r){var i=e["!links"][r];Lt(t,440,VVe(i)),i[1].Tooltip&&Lt(t,2048,WVe(i))}delete e["!links"]}function WGe(t,e){if(e){var r=0;e.forEach(function(i,s){++r<=256&&i&&Lt(t,125,zVe(SR(s,i),s))})}}function jGe(t,e,r,i,s){var n=16+Vd(s.cellXfs,e,s);if(e.v==null&&!e.bf){Lt(t,513,Hg(r,i,n));return}if(e.bf)Lt(t,6,dUe(e,r,i,s,n));else switch(e.t){case"d":case"n":var o=e.t=="d"?Na(oa(e.v)):e.v;Lt(t,515,LVe(r,i,o,n));break;case"b":case"e":Lt(t,517,DVe(r,i,e.v,n,s,e.t));break;case"s":case"str":if(s.bookSST){var l=e5(s.Strings,e.v,s.revStrings);Lt(t,253,PVe(r,i,l,n))}else Lt(t,516,FVe(r,i,(e.v||"").slice(0,255),n,s));break;default:Lt(t,513,Hg(r,i,n))}}function UGe(t,e,r){var i=Ma(),s=r.SheetNames[t],n=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[t]||{},h=Array.isArray(n),d=e.biff==8,g,y="",C=[],x=Si(n["!ref"]||"A1"),_=d?65536:16384;if(x.e.c>255||x.e.r>=_){if(e.WTF)throw new Error("Range "+(n["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,_-1)}Lt(i,2057,X6(r,16,e)),Lt(i,13,kl(1)),Lt(i,12,kl(100)),Lt(i,15,ea(!0)),Lt(i,17,ea(!1)),Lt(i,16,Lg(.001)),Lt(i,95,ea(!0)),Lt(i,42,ea(!1)),Lt(i,43,ea(!1)),Lt(i,130,kl(1)),Lt(i,128,NVe()),Lt(i,131,ea(!1)),Lt(i,132,ea(!1)),d&&WGe(i,n["!cols"]),Lt(i,512,kVe(x,e)),d&&(n["!links"]=[]);for(var E=x.s.r;E<=x.e.r;++E){y=uo(E);for(var R=x.s.c;R<=x.e.c;++R){E===x.s.r&&(C[R]=Do(R)),g=C[R]+y;var I=h?(n[E]||[])[R]:n[g];I&&(jGe(i,I,E,R,e),d&&I.l&&n["!links"].push([g,I.l]))}}var F=l.CodeName||l.name||s;return d&&Lt(i,574,OVe((o.Views||[])[0])),d&&(n["!merges"]||[]).length&&Lt(i,229,BVe(n["!merges"])),d&&VGe(i,n),Lt(i,442,$ee(F)),d&&$Ge(i,n),Lt(i,10),i.end()}function zGe(t,e,r){var i=Ma(),s=(t||{}).Workbook||{},n=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,h=r.biff==5;if(Lt(i,2057,X6(t,5,r)),r.bookType=="xla"&&Lt(i,135),Lt(i,225,l?kl(1200):null),Lt(i,193,pVe(2)),h&&Lt(i,191),h&&Lt(i,192),Lt(i,226),Lt(i,92,TVe("SheetJS",r)),Lt(i,66,kl(l?1200:1252)),l&&Lt(i,353,kl(0)),l&&Lt(i,448),Lt(i,317,GVe(t.SheetNames.length)),l&&t.vbaraw&&Lt(i,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";Lt(i,442,$ee(d))}Lt(i,156,kl(17)),Lt(i,25,ea(!1)),Lt(i,18,ea(!1)),Lt(i,19,kl(0)),l&&Lt(i,431,ea(!1)),l&&Lt(i,444,kl(0)),Lt(i,61,AVe()),Lt(i,64,ea(!1)),Lt(i,141,kl(0)),Lt(i,34,ea(qze(t)=="true")),Lt(i,14,ea(!0)),l&&Lt(i,439,ea(!1)),Lt(i,218,kl(0)),LGe(i,t,r),HGe(i,t.SSF,r),BGe(i,r),l&&Lt(i,352,ea(!1));var g=i.end(),y=Ma();l&&Lt(y,140,jVe()),l&&r.Strings&&PGe(y,252,RVe(r.Strings)),Lt(y,10);var C=y.end(),x=Ma(),_=0,E=0;for(E=0;E<t.SheetNames.length;++E)_+=(l?12:11)+(l?2:1)*t.SheetNames[E].length;var R=g.length+_+C.length;for(E=0;E<t.SheetNames.length;++E){var I=n[E]||{};Lt(x,133,_Ve({pos:R,hs:I.Hidden||0,dt:0,name:t.SheetNames[E]},r)),R+=e[E].length}var F=x.end();if(_!=F.length)throw new Error("BS8 "+_+" != "+F.length);var H=[];return g.length&&H.push(g),F.length&&H.push(F),C.length&&H.push(C),oo(H)}function GGe(t,e){var r=e||{},i=[];t&&!t.SSF&&(t.SSF=Da(ts)),t&&t.SSF&&(pR(),mR(t.SSF),r.revssf=vR(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,t5(r),r.cellXfs=[],Vd(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)i[i.length]=UGe(s,r,t);return i.unshift(zGe(t,i,r)),oo(i)}function fte(t,e){for(var r=0;r<=t.SheetNames.length;++r){var i=t.Sheets[t.SheetNames[r]];if(!(!i||!i["!ref"])){var s=cl(i["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var n=e||{};switch(n.biff||2){case 8:case 5:return GGe(t,e);case 4:case 3:case 2:return DGe(t,e)}throw new Error("invalid type "+n.bookType+" for BIFF")}function YGe(t,e,r,i){for(var s=t["!merges"]||[],n=[],o=e.s.c;o<=e.e.c;++o){for(var l=0,h=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,h=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var g=Xn({r,c:o}),y=i.dense?(t[r]||[])[o]:t[g],C=y&&y.v!=null&&(y.h||EBe(y.w||(af(y),y.w)||""))||"",x={};l>1&&(x.rowspan=l),h>1&&(x.colspan=h),i.editable?C='<span contenteditable="true">'+C+"</span>":y&&(x["data-t"]=y&&y.t||"z",y.v!=null&&(x["data-v"]=y.v),y.z!=null&&(x["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(C='<a href="'+y.l.Target+'">'+C+"</a>")),x.id=(i.id||"sjs")+"-"+g,n.push(kt("td",C,x))}}var _="<tr>";return _+n.join("")+"</tr>"}var KGe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XGe="</body></html>";function qGe(t,e,r){var i=[];return i.join("")+"<table"+(r.id?' id="'+r.id+'"':"")+">"}function dte(t,e){var r=e||{},i=r.header!=null?r.header:KGe,s=r.footer!=null?r.footer:XGe,n=[i],o=cl(t["!ref"]);r.dense=Array.isArray(t),n.push(qGe(t,o,r));for(var l=o.s.r;l<=o.e.r;++l)n.push(YGe(t,o,l,r));return n.push("</table>"+s),n.join("")}function gte(t,e,r){var i=r||{},s=0,n=0;if(i.origin!=null)if(typeof i.origin=="number")s=i.origin;else{var o=typeof i.origin=="string"?Ys(i.origin):i.origin;s=o.r,n=o.c}var l=e.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:n}};if(t["!ref"]){var g=cl(t["!ref"]);d.s.r=Math.min(d.s.r,g.s.r),d.s.c=Math.min(d.s.c,g.s.c),d.e.r=Math.max(d.e.r,g.e.r),d.e.c=Math.max(d.e.c,g.e.c),s==-1&&(d.e.r=s=g.e.r+1)}var y=[],C=0,x=t["!rows"]||(t["!rows"]=[]),_=0,E=0,R=0,I=0,F=0,H=0;for(t["!cols"]||(t["!cols"]=[]);_<l.length&&E<h;++_){var z=l[_];if(dU(z)){if(i.display)continue;x[E]={hidden:!0}}var q=z.children;for(R=I=0;R<q.length;++R){var re=q[R];if(!(i.display&&dU(re))){var Y=re.hasAttribute("data-v")?re.getAttribute("data-v"):re.hasAttribute("v")?re.getAttribute("v"):ABe(re.innerHTML),oe=re.getAttribute("data-z")||re.getAttribute("z");for(C=0;C<y.length;++C){var me=y[C];me.s.c==I+n&&me.s.r<E+s&&E+s<=me.e.r&&(I=me.e.c+1-n,C=-1)}H=+re.getAttribute("colspan")||1,((F=+re.getAttribute("rowspan")||1)>1||H>1)&&y.push({s:{r:E+s,c:I+n},e:{r:E+s+(F||1)-1,c:I+n+(H||1)-1}});var de={t:"s",v:Y},Re=re.getAttribute("data-t")||re.getAttribute("t")||"";Y!=null&&(Y.length==0?de.t=Re||"z":i.raw||Y.trim().length==0||Re=="s"||(Y==="TRUE"?de={t:"b",v:!0}:Y==="FALSE"?de={t:"b",v:!1}:isNaN(Kh(Y))?isNaN(CC(Y).getDate())||(de={t:"d",v:oa(Y)},i.cellDates||(de={t:"n",v:Na(de.v)}),de.z=i.dateNF||ts[14]):de={t:"n",v:Kh(Y)})),de.z===void 0&&oe!=null&&(de.z=oe);var Ie="",Be=re.getElementsByTagName("A");if(Be&&Be.length)for(var lt=0;lt<Be.length&&!(Be[lt].hasAttribute("href")&&(Ie=Be[lt].getAttribute("href"),Ie.charAt(0)!="#"));++lt);Ie&&Ie.charAt(0)!="#"&&(de.l={Target:Ie}),i.dense?(t[E+s]||(t[E+s]=[]),t[E+s][I+n]=de):t[Xn({c:I+n,r:E+s})]=de,d.e.c<I+n&&(d.e.c=I+n),I+=H}}++E}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),d.e.r=Math.max(d.e.r,E-1+s),t["!ref"]=ys(d),E>=h&&(t["!fullref"]=ys((d.e.r=l.length-_+E-1+s,d))),t}function mte(t,e){var r=e||{},i=r.dense?[]:{};return gte(i,t,e)}function JGe(t,e){return Qg(mte(t,e),e)}function dU(t){var e="",r=QGe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function QGe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var ZGe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+bC({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Es+e}}(),gU=function(){var t=function(n){return Yn(n).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,i=function(n,o,l){var h=[];h.push('      <table:table table:name="'+Yn(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,g=0,y=cl(n["!ref"]||"A1"),C=n["!merges"]||[],x=0,_=Array.isArray(n);if(n["!cols"])for(g=0;g<=y.e.c;++g)h.push("        <table:table-column"+(n["!cols"][g]?' table:style-name="co'+n["!cols"][g].ods+'"':"")+`></table:table-column>
`);var E="",R=n["!rows"]||[];for(d=0;d<y.s.r;++d)E=R[d]?' table:style-name="ro'+R[d].ods+'"':"",h.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=y.e.r;++d){for(E=R[d]?' table:style-name="ro'+R[d].ods+'"':"",h.push("        <table:table-row"+E+`>
`),g=0;g<y.s.c;++g)h.push(e);for(;g<=y.e.c;++g){var I=!1,F={},H="";for(x=0;x!=C.length;++x)if(!(C[x].s.c>g)&&!(C[x].s.r>d)&&!(C[x].e.c<g)&&!(C[x].e.r<d)){(C[x].s.c!=g||C[x].s.r!=d)&&(I=!0),F["table:number-columns-spanned"]=C[x].e.c-C[x].s.c+1,F["table:number-rows-spanned"]=C[x].e.r-C[x].s.r+1;break}if(I){h.push(r);continue}var z=Xn({r:d,c:g}),q=_?(n[d]||[])[g]:n[z];if(q&&q.f&&(F["table:formula"]=Yn(yUe(q.f)),q.F&&q.F.slice(0,z.length)==z)){var re=cl(q.F);F["table:number-matrix-columns-spanned"]=re.e.c-re.s.c+1,F["table:number-matrix-rows-spanned"]=re.e.r-re.s.r+1}if(!q){h.push(e);continue}switch(q.t){case"b":H=q.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=q.v?"true":"false";break;case"n":H=q.w||String(q.v||0),F["office:value-type"]="float",F["office:value"]=q.v||0;break;case"s":case"str":H=q.v==null?"":q.v,F["office:value-type"]="string";break;case"d":H=q.w||oa(q.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=oa(q.v).toISOString(),F["table:style-name"]="ce1";break;default:h.push(e);continue}var Y=t(H);if(q.l&&q.l.Target){var oe=q.l.Target;oe=oe.charAt(0)=="#"?"#"+CUe(oe.slice(1)):oe,oe.charAt(0)!="#"&&!oe.match(/^\w+:/)&&(oe="../"+oe),Y=kt("text:a",Y,{"xlink:href":oe.replace(/&/g,"&amp;")})}h.push("          "+kt("table:table-cell",kt("text:p",Y,{}),F)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},s=function(n,o){n.push(` <office:automatic-styles>
`),n.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),n.push(`   <number:month number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:day number:style="long"/>
`),n.push(`   <number:text>/</number:text>
`),n.push(`   <number:year/>
`),n.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var g=0;g<d["!cols"].length;++g)if(d["!cols"][g]){var y=d["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;q6(y),y.ods=l;var C=d["!cols"][g].wpx+"px";n.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),n.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+C+`"/>
`),n.push(`  </style:style>
`),++l}}});var h=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var g=0;g<d["!rows"].length;++g)if(d["!rows"][g]){d["!rows"][g].ods=h;var y=d["!rows"][g].hpx+"px";n.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),n.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),n.push(`  </style:style>
`),++h}}}),n.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),n.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),n.push(`  </style:style>
`),n.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),n.push(` </office:automatic-styles>
`)};return function(o,l){var h=[Es],d=bC({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=bC({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(h.push("<office:document"+d+g+`>
`),h.push(Iee().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),s(h,o),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var y=0;y!=o.SheetNames.length;++y)h.push(i(o.Sheets[o.SheetNames[y]],o,y));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),l.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}}();function pte(t,e){if(e.bookType=="fods")return gU(t,e);var r=$6(),i="",s=[],n=[];return i="mimetype",Jr(r,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Jr(r,i,gU(t,e)),s.push([i,"text/xml"]),n.push([i,"ContentFile"]),i="styles.xml",Jr(r,i,ZGe(t,e)),s.push([i,"text/xml"]),n.push([i,"StylesFile"]),i="meta.xml",Jr(r,i,Es+Iee()),s.push([i,"text/xml"]),n.push([i,"MetadataFile"]),i="manifest.rdf",Jr(r,i,hVe(n)),s.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Jr(r,i,cVe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function YT(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function eYe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Rc(SC(t))}function tYe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var i=0;i<e.length;++i)if(t[r+i]!=e[i])continue e;return!0}return!1}function Md(t){var e=t.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(e),i=0;return t.forEach(function(s){r.set(s,i),i+=s.length}),r}function rYe(t,e,r){var i=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,i-6176);t[e+15]|=i>>7,t[e+14]|=(i&127)<<1;for(var n=0;s>=1;++n,s/=256)t[e+n]=s&255;t[e+15]|=r>=0?0:128}function xC(t,e){var r=e?e[0]:0,i=t[r]&127;e:if(t[r++]>=128&&(i|=(t[r]&127)<<7,t[r++]<128||(i|=(t[r]&127)<<14,t[r++]<128)||(i|=(t[r]&127)<<21,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(i+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),i}function Un(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Zp(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ps(t){for(var e=[],r=[0];r[0]<t.length;){var i=r[0],s=xC(t,r),n=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(n){case 0:{for(var h=r[0];t[r[0]++]>=128;);l=t.slice(h,r[0])}break;case 5:o=4,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=xC(t,r),l=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(i))}var d={data:l,type:n};e[s]==null?e[s]=[d]:e[s].push(d)}return e}function no(t){var e=[];return t.forEach(function(r,i){r.forEach(function(s){s.data&&(e.push(Un(i*8+s.type)),s.type==2&&e.push(Un(s.data.length)),e.push(s.data))})}),Md(e)}function uc(t){for(var e,r=[],i=[0];i[0]<t.length;){var s=xC(t,i),n=Ps(t.slice(i[0],i[0]+s));i[0]+=s;var o={id:Zp(n[1][0].data),messages:[]};n[2].forEach(function(l){var h=Ps(l.data),d=Zp(h[3][0].data);o.messages.push({meta:h,data:t.slice(i[0],i[0]+d)}),i[0]+=d}),(e=n[3])!=null&&e[0]&&(o.merge=Zp(n[3][0].data)>>>0>0),r.push(o)}return r}function np(t){var e=[];return t.forEach(function(r){var i=[];i[1]=[{data:Un(r.id),type:0}],i[2]=[],r.merge!=null&&(i[3]=[{data:Un(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:Un(o.data.length)}],i[2].push({data:no(o.meta),type:2})});var n=no(i);e.push(Un(n.length)),e.push(n),s.forEach(function(o){return e.push(o)})}),Md(e)}function nYe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],i=xC(e,r),s=[];r[0]<e.length;){var n=e[r[0]]&3;if(n==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=e[r[0]],l>1&&(o|=e[r[0]+1]<<8),l>2&&(o|=e[r[0]+2]<<16),l>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var h=0,d=0;if(n==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,n==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Md(s)],h==0)throw new Error("Invalid offset 0");if(h>s[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(s.push(s[0].slice(-h)),d-=h;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-h,-h+d))}}var g=Md(s);if(g.length!=i)throw new Error("Unexpected length: ".concat(g.length," != ").concat(i));return g}function hc(t){for(var e=[],r=0;r<t.length;){var i=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(nYe(i,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Md(e)}function ip(t){for(var e=[],r=0;r<t.length;){var i=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var n=Un(i),o=n.length;e.push(n),i<=60?(o++,e.push(new Uint8Array([i-1<<2]))):i<=256?(o+=2,e.push(new Uint8Array([240,i-1&255]))):i<=65536?(o+=3,e.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(o+=4,e.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(o+=5,e.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),e.push(t.slice(r,r+i)),o+=i,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=i}return Md(e)}function w3(t,e){var r=new Uint8Array(32),i=YT(r),s=12,n=0;switch(r[0]=5,t.t){case"n":r[1]=2,rYe(r,s,t.v),n|=1,s+=16;break;case"b":r[1]=6,i.setFloat64(s,t.v?1:0,!0),n|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,i.setUint32(s,e.indexOf(t.v),!0),n|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(8,n,!0),r.slice(0,s)}function y3(t,e){var r=new Uint8Array(32),i=YT(r),s=12,n=0;switch(r[0]=3,t.t){case"n":r[2]=2,i.setFloat64(s,t.v,!0),n|=32,s+=8;break;case"b":r[2]=6,i.setFloat64(s,t.v?1:0,!0),n|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,i.setUint32(s,e.indexOf(t.v),!0),n|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return i.setUint32(4,n,!0),r.slice(0,s)}function Bf(t){var e=Ps(t);return xC(e[1][0].data)}function iYe(t,e,r){var i,s,n,o;if(!((i=t[6])!=null&&i[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(n=t[8])==null?void 0:n[0])==null?void 0:o.data)&&Zp(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var h=0,d=YT(t[7][0].data),g=0,y=[],C=YT(t[4][0].data),x=0,_=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),C.setUint16(E*2,65535);continue}d.setUint16(E*2,g,!0),C.setUint16(E*2,x,!0);var R,I;switch(typeof e[E]){case"string":R=w3({t:"s",v:e[E]},r),I=y3({t:"s",v:e[E]},r);break;case"number":R=w3({t:"n",v:e[E]},r),I=y3({t:"n",v:e[E]},r);break;case"boolean":R=w3({t:"b",v:e[E]},r),I=y3({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}y.push(R),g+=R.length,_.push(I),x+=I.length,++h}for(t[2][0].data=Un(h);E<t[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),C.setUint16(E*2,65535,!0);return t[6][0].data=Md(y),t[3][0].data=Md(_),h}function sYe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=cl(r["!ref"]);i.s.r=i.s.c=0;var s=!1;i.e.c>9&&(s=!0,i.e.c=9),i.e.r>49&&(s=!0,i.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(ys(i)));var n=KT(r,{range:i,header:1}),o=["~Sh33tJ5~"];n.forEach(function(k){return k.forEach(function(L){typeof L=="string"&&o.push(L)})});var l={},h=[],d=ti.read(e.numbers,{type:"base64"});d.FileIndex.map(function(k,L){return[k,d.FullPaths[L]]}).forEach(function(k){var L=k[0],D=k[1];if(L.type==2&&L.name.match(/\.iwa/)){var K=L.content,Q=hc(K),pe=uc(Q);pe.forEach(function(ye){h.push(ye.id),l[ye.id]={deps:[],location:D,type:Zp(ye.messages[0].meta[1][0].data)}})}}),h.sort(function(k,L){return k-L});var g=h.filter(function(k){return k>1}).map(function(k){return[k,Un(k)]});d.FileIndex.map(function(k,L){return[k,d.FullPaths[L]]}).forEach(function(k){var L=k[0];if(k[1],!!L.name.match(/\.iwa/)){var D=uc(hc(L.content));D.forEach(function(K){K.messages.forEach(function(Q){g.forEach(function(pe){K.messages.some(function(ye){return Zp(ye.meta[1][0].data)!=11006&&tYe(ye.data,pe[1])})&&l[pe[0]].deps.push(K.id)})})})}});for(var y=ti.find(d,l[1].location),C=uc(hc(y.content)),x,_=0;_<C.length;++_){var E=C[_];E.id==1&&(x=E)}var R=Bf(Ps(x.messages[0].data)[1][0].data);for(y=ti.find(d,l[R].location),C=uc(hc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);for(R=Bf(Ps(x.messages[0].data)[2][0].data),y=ti.find(d,l[R].location),C=uc(hc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);for(R=Bf(Ps(x.messages[0].data)[2][0].data),y=ti.find(d,l[R].location),C=uc(hc(y.content)),_=0;_<C.length;++_)E=C[_],E.id==R&&(x=E);var I=Ps(x.messages[0].data);{I[6][0].data=Un(i.e.r+1),I[7][0].data=Un(i.e.c+1);var F=Bf(I[46][0].data),H=ti.find(d,l[F].location),z=uc(hc(H.content));{for(var q=0;q<z.length&&z[q].id!=F;++q);if(z[q].id!=F)throw"Bad ColumnRowUIDMapArchive";var re=Ps(z[q].messages[0].data);re[1]=[],re[2]=[],re[3]=[];for(var Y=0;Y<=i.e.c;++Y){var oe=[];oe[1]=oe[2]=[{type:0,data:Un(Y+420690)}],re[1].push({type:2,data:no(oe)}),re[2].push({type:0,data:Un(Y)}),re[3].push({type:0,data:Un(Y)})}re[4]=[],re[5]=[],re[6]=[];for(var me=0;me<=i.e.r;++me)oe=[],oe[1]=oe[2]=[{type:0,data:Un(me+726270)}],re[4].push({type:2,data:no(oe)}),re[5].push({type:0,data:Un(me)}),re[6].push({type:0,data:Un(me)});z[q].messages[0].data=no(re)}H.content=ip(np(z)),H.size=H.content.length,delete I[46];var de=Ps(I[4][0].data);{de[7][0].data=Un(i.e.r+1);var Re=Ps(de[1][0].data),Ie=Bf(Re[2][0].data);H=ti.find(d,l[Ie].location),z=uc(hc(H.content));{if(z[0].id!=Ie)throw"Bad HeaderStorageBucket";var Be=Ps(z[0].messages[0].data);for(me=0;me<n.length;++me){var lt=Ps(Be[2][0].data);lt[1][0].data=Un(me),lt[4][0].data=Un(n[me].length),Be[2][me]={type:Be[2][0].type,data:no(lt)}}z[0].messages[0].data=no(Be)}H.content=ip(np(z)),H.size=H.content.length;var pt=Bf(de[2][0].data);H=ti.find(d,l[pt].location),z=uc(hc(H.content));{if(z[0].id!=pt)throw"Bad HeaderStorageBucket";for(Be=Ps(z[0].messages[0].data),Y=0;Y<=i.e.c;++Y)lt=Ps(Be[2][0].data),lt[1][0].data=Un(Y),lt[4][0].data=Un(i.e.r+1),Be[2][Y]={type:Be[2][0].type,data:no(lt)};z[0].messages[0].data=no(Be)}H.content=ip(np(z)),H.size=H.content.length;var Ct=Bf(de[4][0].data);(function(){for(var k=ti.find(d,l[Ct].location),L=uc(hc(k.content)),D,K=0;K<L.length;++K){var Q=L[K];Q.id==Ct&&(D=Q)}var pe=Ps(D.messages[0].data);{pe[3]=[];var ye=[];o.forEach(function(te,we){ye[1]=[{type:0,data:Un(we)}],ye[2]=[{type:0,data:Un(1)}],ye[3]=[{type:2,data:eYe(te)}],pe[3].push({type:2,data:no(ye)})})}D.messages[0].data=no(pe);var j=np(L),X=ip(j);k.content=X,k.size=k.content.length})();var ct=Ps(de[3][0].data);{var Ue=ct[1][0];delete ct[2];var Je=Ps(Ue.data);{var Fe=Bf(Je[2][0].data);(function(){for(var k=ti.find(d,l[Fe].location),L=uc(hc(k.content)),D,K=0;K<L.length;++K){var Q=L[K];Q.id==Fe&&(D=Q)}var pe=Ps(D.messages[0].data);{delete pe[6],delete ct[7];var ye=new Uint8Array(pe[5][0].data);pe[5]=[];for(var j=0,X=0;X<=i.e.r;++X){var te=Ps(ye);j+=iYe(te,n[X],o),te[1][0].data=Un(X),pe[5].push({data:no(te),type:2})}pe[1]=[{type:0,data:Un(i.e.c+1)}],pe[2]=[{type:0,data:Un(i.e.r+1)}],pe[3]=[{type:0,data:Un(j)}],pe[4]=[{type:0,data:Un(i.e.r+1)}]}D.messages[0].data=no(pe);var we=np(L),ce=ip(we);k.content=ce,k.size=k.content.length})()}Ue.data=no(Je)}de[3][0].data=no(ct)}I[4][0].data=no(de)}x.messages[0].data=no(I);var A=np(C),O=ip(A);return y.content=O,y.size=y.content.length,d}function oYe(t){return function(r){for(var i=0;i!=t.length;++i){var s=t[i];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function t5(t){oYe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function aYe(t,e){return e.bookType=="ods"?pte(t,e):e.bookType=="numbers"?sYe(t,e):e.bookType=="xlsb"?lYe(t,e):cYe(t,e)}function lYe(t,e){kp=1024,t&&!t.SSF&&(t.SSF=Da(ts)),t&&t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oy?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",i=Qee.indexOf(e.bookType)>-1,s=Ree();t5(e=e||{});var n=$6(),o="",l=0;if(e.cellXfs=[],Vd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jr(n,o,Pee(t.Props,e)),s.coreprops.push(o),Gn(e.rels,2,o,_n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,Jr(n,o,Mee(t.Props)),s.extprops.push(o),Gn(e.rels,3,o,_n.EXT_PROPS),t.Custprops!==t.Props&&fo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jr(n,o,kee(t.Custprops)),s.custprops.push(o),Gn(e.rels,4,o,_n.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var g={"!id":{}},y=t.Sheets[t.SheetNames[l-1]],C=(y||{})["!type"]||"sheet";switch(C){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jr(n,o,hGe(l-1,o,e,t,g)),s.sheets.push(o),Gn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,_n.WS[0])}if(y){var x=y["!comments"],_=!1,E="";x&&x.length>0&&(E="xl/comments"+l+"."+r,Jr(n,E,gGe(x,E)),s.comments.push(E),Gn(g,-1,"../comments"+l+"."+r,_n.CMNT),_=!0),y["!legacy"]&&_&&Jr(n,"xl/drawings/vmlDrawing"+l+".vml",qee(l,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&Jr(n,Oee(o),Jp(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jr(n,o,dGe(e.Strings,o,e)),s.strs.push(o),Gn(e.wbrels,-1,"sharedStrings."+r,_n.SST)),o="xl/workbook."+r,Jr(n,o,uGe(t,o)),s.workbooks.push(o),Gn(e.rels,1,o,_n.WB),o="xl/theme/theme1.xml",Jr(n,o,Kee(t.Themes,e)),s.themes.push(o),Gn(e.wbrels,-1,"theme/theme1.xml",_n.THEME),o="xl/styles."+r,Jr(n,o,fGe(t,o,e)),s.styles.push(o),Gn(e.wbrels,-1,"styles."+r,_n.STY),t.vbaraw&&i&&(o="xl/vbaProject.bin",Jr(n,o,t.vbaraw),s.vba.push(o),Gn(e.wbrels,-1,"vbaProject.bin",_n.VBA)),o="xl/metadata."+r,Jr(n,o,mGe(o)),s.metadata.push(o),Gn(e.wbrels,-1,"metadata."+r,_n.XLMETA),Jr(n,"[Content_Types].xml",Aee(s,e)),Jr(n,"_rels/.rels",Jp(e.rels)),Jr(n,"xl/_rels/workbook."+r+".rels",Jp(e.wbrels)),delete e.revssf,delete e.ssf,n}function cYe(t,e){kp=1024,t&&!t.SSF&&(t.SSF=Da(ts)),t&&t.SSF&&(pR(),mR(t.SSF),e.revssf=vR(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Oy?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",i=Qee.indexOf(e.bookType)>-1,s=Ree();t5(e=e||{});var n=$6(),o="",l=0;if(e.cellXfs=[],Vd(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Jr(n,o,Pee(t.Props,e)),s.coreprops.push(o),Gn(e.rels,2,o,_n.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,Jr(n,o,Mee(t.Props)),s.extprops.push(o),Gn(e.rels,3,o,_n.EXT_PROPS),t.Custprops!==t.Props&&fo(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Jr(n,o,kee(t.Custprops)),s.custprops.push(o),Gn(e.rels,4,o,_n.CUST_PROPS));var g=["SheetJ5"];for(e.tcid=0,l=1;l<=t.SheetNames.length;++l){var y={"!id":{}},C=t.Sheets[t.SheetNames[l-1]],x=(C||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Jr(n,o,ate(l-1,e,t,y)),s.sheets.push(o),Gn(e.wbrels,-1,"worksheets/sheet"+l+"."+r,_n.WS[0])}if(C){var _=C["!comments"],E=!1,R="";if(_&&_.length>0){var I=!1;_.forEach(function(F){F[1].forEach(function(H){H.T==!0&&(I=!0)})}),I&&(R="xl/threadedComments/threadedComment"+l+"."+r,Jr(n,R,BWe(_,g,e)),s.threadedcomments.push(R),Gn(y,-1,"../threadedComments/threadedComment"+l+"."+r,_n.TCMNT)),R="xl/comments"+l+"."+r,Jr(n,R,Jee(_)),s.comments.push(R),Gn(y,-1,"../comments"+l+"."+r,_n.CMNT),E=!0}C["!legacy"]&&E&&Jr(n,"xl/drawings/vmlDrawing"+l+".vml",qee(l,C["!comments"])),delete C["!comments"],delete C["!legacy"]}y["!id"].rId1&&Jr(n,Oee(o),Jp(y))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Jr(n,o,Wee(e.Strings,e)),s.strs.push(o),Gn(e.wbrels,-1,"sharedStrings."+r,_n.SST)),o="xl/workbook."+r,Jr(n,o,ute(t)),s.workbooks.push(o),Gn(e.rels,1,o,_n.WB),o="xl/theme/theme1.xml",Jr(n,o,Kee(t.Themes,e)),s.themes.push(o),Gn(e.wbrels,-1,"theme/theme1.xml",_n.THEME),o="xl/styles."+r,Jr(n,o,Gee(t,e)),s.styles.push(o),Gn(e.wbrels,-1,"styles."+r,_n.STY),t.vbaraw&&i&&(o="xl/vbaProject.bin",Jr(n,o,t.vbaraw),s.vba.push(o),Gn(e.wbrels,-1,"vbaProject.bin",_n.VBA)),o="xl/metadata."+r,Jr(n,o,Xee()),s.metadata.push(o),Gn(e.wbrels,-1,"metadata."+r,_n.XLMETA),g.length>1&&(o="xl/persons/person.xml",Jr(n,o,VWe(g)),s.people.push(o),Gn(e.wbrels,-1,"persons/person.xml",_n.PEOPLE)),Jr(n,"[Content_Types].xml",Aee(s,e)),Jr(n,"_rels/.rels",Jp(e.rels)),Jr(n,"xl/_rels/workbook."+r+".rels",Jp(e.wbrels)),delete e.revssf,delete e.ssf,n}function uYe(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=of(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function vte(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return dS(e.file,ti.write(t,{type:kn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ti.write(t,e)}function hYe(t,e){var r=Da(e||{}),i=aYe(t,r);return fYe(i,r)}function fYe(t,e){var r={},i=kn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=i;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=i;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?ti.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(gR(s))}return e.password&&typeof encrypt_agile<"u"?vte(encrypt_agile(s,e.password),e):e.type==="file"?dS(e.file,s):e.type=="string"?Ty(s):s}function dYe(t,e){var r=e||{},i=OGe(t,r);return vte(i,r)}function Eu(t,e,r){r||(r="");var i=r+t;switch(e.type){case"base64":return yC(SC(i));case"binary":return SC(i);case"string":return t;case"file":return dS(e.file,i,"utf8");case"buffer":return kn?mf(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):Eu(i,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gYe(t,e){switch(e.type){case"base64":return yC(t);case"binary":return t;case"string":return t;case"file":return dS(e.file,t,"binary");case"buffer":return kn?mf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function m2(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",i=0;i<t.length;++i)r+=String.fromCharCode(t[i]);return e.type=="base64"?yC(r):e.type=="string"?Ty(r):r;case"file":return dS(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function wte(t,e){W9e(),Zze(t);var r=Da(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var i=wte(t,r);return r.type="array",gR(i)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Eu(RGe(t,r),r);case"slk":case"sylk":return Eu(qVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return Eu(dte(t.Sheets[t.SheetNames[s]],r),r);case"txt":return gYe(yte(t.Sheets[t.SheetNames[s]],r),r);case"csv":return Eu(r5(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return Eu(JVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return m2(XVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return Eu(QVe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return Eu(sWe.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return Eu(Vee.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return Eu(pte(t,r),r);case"wk1":return m2(aU.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return m2(aU.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),m2(fte(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dYe(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return hYe(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mYe(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function pYe(t,e,r){var i={};return i.type="file",i.file=e,mYe(i),wte(t,i)}function vYe(t,e,r,i,s,n,o,l){var h=uo(r),d=l.defval,g=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),y=!0,C=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(C,"__rowNum__",{value:r,enumerable:!1})}catch{C.__rowNum__=r}else C.__rowNum__=r;if(!o||t[r])for(var x=e.s.c;x<=e.e.c;++x){var _=o?t[r][x]:t[i[x]+h];if(_===void 0||_.t===void 0){if(d===void 0)continue;n[x]!=null&&(C[n[x]]=d);continue}var E=_.v;switch(_.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+_.t)}if(n[x]!=null){if(E==null)if(_.t=="e"&&E===null)C[n[x]]=null;else if(d!==void 0)C[n[x]]=d;else if(g&&E===null)C[n[x]]=null;else continue;else C[n[x]]=g&&(_.t!=="n"||_.t==="n"&&l.rawNumbers!==!1)?E:af(_,E,l);E!=null&&(y=!1)}}return{row:C,isempty:y}}function KT(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},i=0,s=1,n=[],o=0,l="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?i=1:d.header==="A"?i=2:Array.isArray(d.header)?i=3:d.header==null&&(i=0),typeof g){case"string":h=Si(g);break;case"number":h=Si(t["!ref"]),h.s.r=g;break;default:h=g}i>0&&(s=0);var y=uo(h.s.r),C=[],x=[],_=0,E=0,R=Array.isArray(t),I=h.s.r,F=0,H={};R&&!t[I]&&(t[I]=[]);var z=d.skipHidden&&t["!cols"]||[],q=d.skipHidden&&t["!rows"]||[];for(F=h.s.c;F<=h.e.c;++F)if(!(z[F]||{}).hidden)switch(C[F]=Do(F),r=R?t[I][F]:t[C[F]+y],i){case 1:n[F]=F-h.s.c;break;case 2:n[F]=C[F];break;case 3:n[F]=d.header[F-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=af(r,null,d),E=H[o]||0,!E)H[o]=1;else{do l=o+"_"+E++;while(H[l]);H[o]=E,H[l]=1}n[F]=l}for(I=h.s.r+s;I<=h.e.r;++I)if(!(q[I]||{}).hidden){var re=vYe(t,h,I,C,i,n,R,d);(re.isempty===!1||(i===1?d.blankrows!==!1:d.blankrows))&&(x[_++]=re.row)}return x.length=_,x}var mU=/"/g;function wYe(t,e,r,i,s,n,o,l){for(var h=!0,d=[],g="",y=uo(r),C=e.s.c;C<=e.e.c;++C)if(i[C]){var x=l.dense?(t[r]||[])[C]:t[i[C]+y];if(x==null)g="";else if(x.v!=null){h=!1,g=""+(l.rawNumbers&&x.t=="n"?x.v:af(x,null,l));for(var _=0,E=0;_!==g.length;++_)if((E=g.charCodeAt(_))===s||E===n||E===34||l.forceQuotes){g='"'+g.replace(mU,'""')+'"';break}g=="ID"&&(g='"ID"')}else x.f!=null&&!x.F?(h=!1,g="="+x.f,g.indexOf(",")>=0&&(g='"'+g.replace(mU,'""')+'"')):g="";d.push(g)}return l.blankrows===!1&&h?null:d.join(o)}function r5(t,e){var r=[],i=e??{};if(t==null||t["!ref"]==null)return"";var s=Si(t["!ref"]),n=i.FS!==void 0?i.FS:",",o=n.charCodeAt(0),l=i.RS!==void 0?i.RS:`
`,h=l.charCodeAt(0),d=new RegExp((n=="|"?"\\|":n)+"+$"),g="",y=[];i.dense=Array.isArray(t);for(var C=i.skipHidden&&t["!cols"]||[],x=i.skipHidden&&t["!rows"]||[],_=s.s.c;_<=s.e.c;++_)(C[_]||{}).hidden||(y[_]=Do(_));for(var E=0,R=s.s.r;R<=s.e.r;++R)(x[R]||{}).hidden||(g=wYe(t,s,R,y,o,h,n,i),g!=null&&(i.strip&&(g=g.replace(d,"")),(g||i.blankrows!==!1)&&r.push((E++?l:"")+g)));return delete i.dense,r.join("")}function yte(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=r5(t,e);return r}function yYe(t){var e="",r,i="";if(t==null||t["!ref"]==null)return[];var s=Si(t["!ref"]),n="",o=[],l,h=[],d=Array.isArray(t);for(l=s.s.c;l<=s.e.c;++l)o[l]=Do(l);for(var g=s.s.r;g<=s.e.r;++g)for(n=uo(g),l=s.s.c;l<=s.e.c;++l)if(e=o[l]+n,r=d?(t[g]||[])[l]:t[e],i="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;i=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)i=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)i=""+r.v;else if(r.t=="b")i=r.v?"TRUE":"FALSE";else if(r.w!==void 0)i="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?i="'"+r.v:i=""+r.v}}h[h.length]=e+"="+i}return h}function Cte(t,e,r){var i=r||{},s=+!i.skipHeader,n=t||{},o=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")o=i.origin;else{var h=typeof i.origin=="string"?Ys(i.origin):i.origin;o=h.r,l=h.c}var d,g={s:{c:0,r:0},e:{c:l,r:o+e.length-1+s}};if(n["!ref"]){var y=Si(n["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),o==-1&&(o=y.e.r+1,g.e.r=o+e.length-1+s)}else o==-1&&(o=0,g.e.r=e.length-1+s);var C=i.header||[],x=0;e.forEach(function(E,R){fo(E).forEach(function(I){(x=C.indexOf(I))==-1&&(C[x=C.length]=I);var F=E[I],H="z",z="",q=Xn({c:l+x,r:o+R+s});d=EC(n,q),F&&typeof F=="object"&&!(F instanceof Date)?n[q]=F:(typeof F=="number"?H="n":typeof F=="boolean"?H="b":typeof F=="string"?H="s":F instanceof Date?(H="d",i.cellDates||(H="n",F=Na(F)),z=i.dateNF||ts[14]):F===null&&i.nullError&&(H="e",F=0),d?(d.t=H,d.v=F,delete d.w,delete d.R,z&&(d.z=z)):n[q]=d={t:H,v:F},z&&(d.z=z))})}),g.e.c=Math.max(g.e.c,l+C.length-1);var _=uo(o);if(s)for(x=0;x<C.length;++x)n[Do(x+l)+_]={t:"s",v:C[x]};return n["!ref"]=ys(g),n}function CYe(t,e){return Cte(null,t,e)}function EC(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var i=Ys(e);return t[i.r]||(t[i.r]=[]),t[i.r][i.c]||(t[i.r][i.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?EC(t,Xn(e)):EC(t,Xn({r:e,c:r||0}))}function SYe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function bYe(){return{SheetNames:[],Sheets:{}}}function xYe(t,e,r,i){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&t.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var o=n&&n[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=o+s)!=-1;++s);}if(cte(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function EYe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var i=SYe(t,e);switch(t.Workbook.Sheets[i]||(t.Workbook.Sheets[i]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[i].Hidden=r}function TYe(t,e){return t.z=e,t}function Ste(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function _Ye(t,e,r){return Ste(t,"#"+e,r)}function RYe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function AYe(t,e,r,i){for(var s=typeof e!="string"?e:Si(e),n=typeof e=="string"?e:ys(e),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var h=EC(t,o,l);h.t="n",h.F=n,delete h.v,o==s.s.r&&l==s.s.c&&(h.f=r,i&&(h.D=!0))}return t}var Fw={encode_col:Do,encode_row:uo,encode_cell:Xn,encode_range:ys,decode_col:z6,decode_row:U6,split_cell:WBe,decode_cell:Ys,decode_range:cl,format_cell:af,sheet_add_aoa:See,sheet_add_json:Cte,sheet_add_dom:gte,aoa_to_sheet:B1,json_to_sheet:CYe,table_to_sheet:mte,table_to_book:JGe,sheet_to_csv:r5,sheet_to_txt:yte,sheet_to_json:KT,sheet_to_html:dte,sheet_to_formulae:yYe,sheet_to_row_object_array:KT,sheet_get_cell:EC,book_new:bYe,book_append_sheet:xYe,book_set_sheet_visibility:EYe,cell_set_number_format:TYe,cell_set_hyperlink:Ste,cell_set_internal_link:_Ye,cell_add_comment:RYe,sheet_set_array_formula:AYe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function bte(t,e){return function(){return t.apply(e,arguments)}}const{toString:OYe}=Object.prototype,{getPrototypeOf:n5}=Object,bR=(t=>e=>{const r=OYe.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),zc=t=>(t=t.toLowerCase(),e=>bR(e)===t),xR=t=>e=>typeof e===t,{isArray:j1}=Array,TC=xR("undefined");function IYe(t){return t!==null&&!TC(t)&&t.constructor!==null&&!TC(t.constructor)&&ol(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const xte=zc("ArrayBuffer");function PYe(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&xte(t.buffer),e}const FYe=xR("string"),ol=xR("function"),Ete=xR("number"),ER=t=>t!==null&&typeof t=="object",MYe=t=>t===!0||t===!1,tE=t=>{if(bR(t)!=="object")return!1;const e=n5(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},kYe=zc("Date"),NYe=zc("File"),DYe=zc("Blob"),LYe=zc("FileList"),HYe=t=>ER(t)&&ol(t.pipe),$Ye=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||ol(t.append)&&((e=bR(t))==="formdata"||e==="object"&&ol(t.toString)&&t.toString()==="[object FormData]"))},BYe=zc("URLSearchParams"),[VYe,WYe,jYe,UYe]=["ReadableStream","Request","Response","Headers"].map(zc),zYe=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wS(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let i,s;if(typeof t!="object"&&(t=[t]),j1(t))for(i=0,s=t.length;i<s;i++)e.call(null,t[i],i,t);else{const n=r?Object.getOwnPropertyNames(t):Object.keys(t),o=n.length;let l;for(i=0;i<o;i++)l=n[i],e.call(null,t[l],l,t)}}function Tte(t,e){e=e.toLowerCase();const r=Object.keys(t);let i=r.length,s;for(;i-- >0;)if(s=r[i],e===s.toLowerCase())return s;return null}const hg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,_te=t=>!TC(t)&&t!==hg;function zF(){const{caseless:t}=_te(this)&&this||{},e={},r=(i,s)=>{const n=t&&Tte(e,s)||s;tE(e[n])&&tE(i)?e[n]=zF(e[n],i):tE(i)?e[n]=zF({},i):j1(i)?e[n]=i.slice():e[n]=i};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&wS(arguments[i],r);return e}const GYe=(t,e,r,{allOwnKeys:i}={})=>(wS(e,(s,n)=>{r&&ol(s)?t[n]=bte(s,r):t[n]=s},{allOwnKeys:i}),t),YYe=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),KYe=(t,e,r,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},XYe=(t,e,r,i)=>{let s,n,o;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),n=s.length;n-- >0;)o=s[n],(!i||i(o,t,e))&&!l[o]&&(e[o]=t[o],l[o]=!0);t=r!==!1&&n5(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},qYe=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const i=t.indexOf(e,r);return i!==-1&&i===r},JYe=t=>{if(!t)return null;if(j1(t))return t;let e=t.length;if(!Ete(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},QYe=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&n5(Uint8Array)),ZYe=(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=i.next())&&!s.done;){const n=s.value;e.call(t,n[0],n[1])}},eKe=(t,e)=>{let r;const i=[];for(;(r=t.exec(e))!==null;)i.push(r);return i},tKe=zc("HTMLFormElement"),rKe=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,i,s){return i.toUpperCase()+s}),pU=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),nKe=zc("RegExp"),Rte=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),i={};wS(r,(s,n)=>{let o;(o=e(s,n,t))!==!1&&(i[n]=o||s)}),Object.defineProperties(t,i)},iKe=t=>{Rte(t,(e,r)=>{if(ol(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const i=t[r];if(ol(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},sKe=(t,e)=>{const r={},i=s=>{s.forEach(n=>{r[n]=!0})};return j1(t)?i(t):i(String(t).split(e)),r},oKe=()=>{},aKe=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e,C3="abcdefghijklmnopqrstuvwxyz",vU="0123456789",Ate={DIGIT:vU,ALPHA:C3,ALPHA_DIGIT:C3+C3.toUpperCase()+vU},lKe=(t=16,e=Ate.ALPHA_DIGIT)=>{let r="";const{length:i}=e;for(;t--;)r+=e[Math.random()*i|0];return r};function cKe(t){return!!(t&&ol(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const uKe=t=>{const e=new Array(10),r=(i,s)=>{if(ER(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[s]=i;const n=j1(i)?[]:{};return wS(i,(o,l)=>{const h=r(o,s+1);!TC(h)&&(n[l]=h)}),e[s]=void 0,n}}return i};return r(t,0)},hKe=zc("AsyncFunction"),fKe=t=>t&&(ER(t)||ol(t))&&ol(t.then)&&ol(t.catch),Ote=((t,e)=>t?setImmediate:e?((r,i)=>(hg.addEventListener("message",({source:s,data:n})=>{s===hg&&n===r&&i.length&&i.shift()()},!1),s=>{i.push(s),hg.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ol(hg.postMessage)),dKe=typeof queueMicrotask<"u"?queueMicrotask.bind(hg):typeof process<"u"&&process.nextTick||Ote,et={isArray:j1,isArrayBuffer:xte,isBuffer:IYe,isFormData:$Ye,isArrayBufferView:PYe,isString:FYe,isNumber:Ete,isBoolean:MYe,isObject:ER,isPlainObject:tE,isReadableStream:VYe,isRequest:WYe,isResponse:jYe,isHeaders:UYe,isUndefined:TC,isDate:kYe,isFile:NYe,isBlob:DYe,isRegExp:nKe,isFunction:ol,isStream:HYe,isURLSearchParams:BYe,isTypedArray:QYe,isFileList:LYe,forEach:wS,merge:zF,extend:GYe,trim:zYe,stripBOM:YYe,inherits:KYe,toFlatObject:XYe,kindOf:bR,kindOfTest:zc,endsWith:qYe,toArray:JYe,forEachEntry:ZYe,matchAll:eKe,isHTMLForm:tKe,hasOwnProperty:pU,hasOwnProp:pU,reduceDescriptors:Rte,freezeMethods:iKe,toObjectSet:sKe,toCamelCase:rKe,noop:oKe,toFiniteNumber:aKe,findKey:Tte,global:hg,isContextDefined:_te,ALPHABET:Ate,generateString:lKe,isSpecCompliantForm:cKe,toJSONObject:uKe,isAsyncFn:hKe,isThenable:fKe,setImmediate:Ote,asap:dKe};function jr(t,e,r,i,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),i&&(this.request=i),s&&(this.response=s,this.status=s.status?s.status:null)}et.inherits(jr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:et.toJSONObject(this.config),code:this.code,status:this.status}}});const Ite=jr.prototype,Pte={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Pte[t]={value:t}});Object.defineProperties(jr,Pte);Object.defineProperty(Ite,"isAxiosError",{value:!0});jr.from=(t,e,r,i,s,n)=>{const o=Object.create(Ite);return et.toFlatObject(t,o,function(h){return h!==Error.prototype},l=>l!=="isAxiosError"),jr.call(o,t.message,e,r,i,s),o.cause=t,o.name=t.name,n&&Object.assign(o,n),o};const gKe=null;function GF(t){return et.isPlainObject(t)||et.isArray(t)}function Fte(t){return et.endsWith(t,"[]")?t.slice(0,-2):t}function wU(t,e,r){return t?t.concat(e).map(function(s,n){return s=Fte(s),!r&&n?"["+s+"]":s}).join(r?".":""):e}function mKe(t){return et.isArray(t)&&!t.some(GF)}const pKe=et.toFlatObject(et,{},null,function(e){return/^is[A-Z]/.test(e)});function TR(t,e,r){if(!et.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=et.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,R){return!et.isUndefined(R[E])});const i=r.metaTokens,s=r.visitor||g,n=r.dots,o=r.indexes,h=(r.Blob||typeof Blob<"u"&&Blob)&&et.isSpecCompliantForm(e);if(!et.isFunction(s))throw new TypeError("visitor must be a function");function d(_){if(_===null)return"";if(et.isDate(_))return _.toISOString();if(!h&&et.isBlob(_))throw new jr("Blob is not supported. Use a Buffer instead.");return et.isArrayBuffer(_)||et.isTypedArray(_)?h&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function g(_,E,R){let I=_;if(_&&!R&&typeof _=="object"){if(et.endsWith(E,"{}"))E=i?E:E.slice(0,-2),_=JSON.stringify(_);else if(et.isArray(_)&&mKe(_)||(et.isFileList(_)||et.endsWith(E,"[]"))&&(I=et.toArray(_)))return E=Fte(E),I.forEach(function(H,z){!(et.isUndefined(H)||H===null)&&e.append(o===!0?wU([E],z,n):o===null?E:E+"[]",d(H))}),!1}return GF(_)?!0:(e.append(wU(R,E,n),d(_)),!1)}const y=[],C=Object.assign(pKe,{defaultVisitor:g,convertValue:d,isVisitable:GF});function x(_,E){if(!et.isUndefined(_)){if(y.indexOf(_)!==-1)throw Error("Circular reference detected in "+E.join("."));y.push(_),et.forEach(_,function(I,F){(!(et.isUndefined(I)||I===null)&&s.call(e,I,et.isString(F)?F.trim():F,E,C))===!0&&x(I,E?E.concat(F):[F])}),y.pop()}}if(!et.isObject(t))throw new TypeError("data must be an object");return x(t),e}function yU(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function i5(t,e){this._pairs=[],t&&TR(t,this,e)}const Mte=i5.prototype;Mte.append=function(e,r){this._pairs.push([e,r])};Mte.toString=function(e){const r=e?function(i){return e.call(this,i,yU)}:yU;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function vKe(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function kte(t,e,r){if(!e)return t;const i=r&&r.encode||vKe;et.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let n;if(s?n=s(e,r):n=et.isURLSearchParams(e)?e.toString():new i5(e,r).toString(i),n){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+n}return t}class CU{constructor(){this.handlers=[]}use(e,r,i){return this.handlers.push({fulfilled:e,rejected:r,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){et.forEach(this.handlers,function(i){i!==null&&e(i)})}}const Nte={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wKe=typeof URLSearchParams<"u"?URLSearchParams:i5,yKe=typeof FormData<"u"?FormData:null,CKe=typeof Blob<"u"?Blob:null,SKe={isBrowser:!0,classes:{URLSearchParams:wKe,FormData:yKe,Blob:CKe},protocols:["http","https","file","blob","url","data"]},s5=typeof window<"u"&&typeof document<"u",YF=typeof navigator=="object"&&navigator||void 0,bKe=s5&&(!YF||["ReactNative","NativeScript","NS"].indexOf(YF.product)<0),xKe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",EKe=s5&&window.location.href||"http://localhost",TKe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:s5,hasStandardBrowserEnv:bKe,hasStandardBrowserWebWorkerEnv:xKe,navigator:YF,origin:EKe},Symbol.toStringTag,{value:"Module"})),ko={...TKe,...SKe};function _Ke(t,e){return TR(t,new ko.classes.URLSearchParams,Object.assign({visitor:function(r,i,s,n){return ko.isNode&&et.isBuffer(r)?(this.append(i,r.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},e))}function RKe(t){return et.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function AKe(t){const e={},r=Object.keys(t);let i;const s=r.length;let n;for(i=0;i<s;i++)n=r[i],e[n]=t[n];return e}function Dte(t){function e(r,i,s,n){let o=r[n++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),h=n>=r.length;return o=!o&&et.isArray(s)?s.length:o,h?(et.hasOwnProp(s,o)?s[o]=[s[o],i]:s[o]=i,!l):((!s[o]||!et.isObject(s[o]))&&(s[o]=[]),e(r,i,s[o],n)&&et.isArray(s[o])&&(s[o]=AKe(s[o])),!l)}if(et.isFormData(t)&&et.isFunction(t.entries)){const r={};return et.forEachEntry(t,(i,s)=>{e(RKe(i),s,r,0)}),r}return null}function OKe(t,e,r){if(et.isString(t))try{return(e||JSON.parse)(t),et.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(0,JSON.stringify)(t)}const yS={transitional:Nte,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const i=r.getContentType()||"",s=i.indexOf("application/json")>-1,n=et.isObject(e);if(n&&et.isHTMLForm(e)&&(e=new FormData(e)),et.isFormData(e))return s?JSON.stringify(Dte(e)):e;if(et.isArrayBuffer(e)||et.isBuffer(e)||et.isStream(e)||et.isFile(e)||et.isBlob(e)||et.isReadableStream(e))return e;if(et.isArrayBufferView(e))return e.buffer;if(et.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(n){if(i.indexOf("application/x-www-form-urlencoded")>-1)return _Ke(e,this.formSerializer).toString();if((l=et.isFileList(e))||i.indexOf("multipart/form-data")>-1){const h=this.env&&this.env.FormData;return TR(l?{"files[]":e}:e,h&&new h,this.formSerializer)}}return n||s?(r.setContentType("application/json",!1),OKe(e)):e}],transformResponse:[function(e){const r=this.transitional||yS.transitional,i=r&&r.forcedJSONParsing,s=this.responseType==="json";if(et.isResponse(e)||et.isReadableStream(e))return e;if(e&&et.isString(e)&&(i&&!this.responseType||s)){const o=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(l){if(o)throw l.name==="SyntaxError"?jr.from(l,jr.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ko.classes.FormData,Blob:ko.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};et.forEach(["delete","get","head","post","put","patch"],t=>{yS.headers[t]={}});const IKe=et.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),PKe=t=>{const e={};let r,i,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),r=o.substring(0,s).trim().toLowerCase(),i=o.substring(s+1).trim(),!(!r||e[r]&&IKe[r])&&(r==="set-cookie"?e[r]?e[r].push(i):e[r]=[i]:e[r]=e[r]?e[r]+", "+i:i)}),e},SU=Symbol("internals");function Mw(t){return t&&String(t).trim().toLowerCase()}function rE(t){return t===!1||t==null?t:et.isArray(t)?t.map(rE):String(t)}function FKe(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=r.exec(t);)e[i[1]]=i[2];return e}const MKe=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function S3(t,e,r,i,s){if(et.isFunction(i))return i.call(this,e,r);if(s&&(e=r),!!et.isString(e)){if(et.isString(i))return e.indexOf(i)!==-1;if(et.isRegExp(i))return i.test(e)}}function kKe(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,i)=>r.toUpperCase()+i)}function NKe(t,e){const r=et.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+r,{value:function(s,n,o){return this[i].call(this,e,s,n,o)},configurable:!0})})}class ka{constructor(e){e&&this.set(e)}set(e,r,i){const s=this;function n(l,h,d){const g=Mw(h);if(!g)throw new Error("header name must be a non-empty string");const y=et.findKey(s,g);(!y||s[y]===void 0||d===!0||d===void 0&&s[y]!==!1)&&(s[y||h]=rE(l))}const o=(l,h)=>et.forEach(l,(d,g)=>n(d,g,h));if(et.isPlainObject(e)||e instanceof this.constructor)o(e,r);else if(et.isString(e)&&(e=e.trim())&&!MKe(e))o(PKe(e),r);else if(et.isHeaders(e))for(const[l,h]of e.entries())n(h,l,i);else e!=null&&n(r,e,i);return this}get(e,r){if(e=Mw(e),e){const i=et.findKey(this,e);if(i){const s=this[i];if(!r)return s;if(r===!0)return FKe(s);if(et.isFunction(r))return r.call(this,s,i);if(et.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=Mw(e),e){const i=et.findKey(this,e);return!!(i&&this[i]!==void 0&&(!r||S3(this,this[i],i,r)))}return!1}delete(e,r){const i=this;let s=!1;function n(o){if(o=Mw(o),o){const l=et.findKey(i,o);l&&(!r||S3(i,i[l],l,r))&&(delete i[l],s=!0)}}return et.isArray(e)?e.forEach(n):n(e),s}clear(e){const r=Object.keys(this);let i=r.length,s=!1;for(;i--;){const n=r[i];(!e||S3(this,this[n],n,e,!0))&&(delete this[n],s=!0)}return s}normalize(e){const r=this,i={};return et.forEach(this,(s,n)=>{const o=et.findKey(i,n);if(o){r[o]=rE(s),delete r[n];return}const l=e?kKe(n):String(n).trim();l!==n&&delete r[n],r[l]=rE(s),i[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return et.forEach(this,(i,s)=>{i!=null&&i!==!1&&(r[s]=e&&et.isArray(i)?i.join(", "):i)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const i=new this(e);return r.forEach(s=>i.set(s)),i}static accessor(e){const i=(this[SU]=this[SU]={accessors:{}}).accessors,s=this.prototype;function n(o){const l=Mw(o);i[l]||(NKe(s,o),i[l]=!0)}return et.isArray(e)?e.forEach(n):n(e),this}}ka.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);et.reduceDescriptors(ka.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(i){this[r]=i}}});et.freezeMethods(ka);function b3(t,e){const r=this||yS,i=e||r,s=ka.from(i.headers);let n=i.data;return et.forEach(t,function(l){n=l.call(r,n,s.normalize(),e?e.status:void 0)}),s.normalize(),n}function Lte(t){return!!(t&&t.__CANCEL__)}function U1(t,e,r){jr.call(this,t??"canceled",jr.ERR_CANCELED,e,r),this.name="CanceledError"}et.inherits(U1,jr,{__CANCEL__:!0});function Hte(t,e,r){const i=r.config.validateStatus;!r.status||!i||i(r.status)?t(r):e(new jr("Request failed with status code "+r.status,[jr.ERR_BAD_REQUEST,jr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function DKe(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function LKe(t,e){t=t||10;const r=new Array(t),i=new Array(t);let s=0,n=0,o;return e=e!==void 0?e:1e3,function(h){const d=Date.now(),g=i[n];o||(o=d),r[s]=h,i[s]=d;let y=n,C=0;for(;y!==s;)C+=r[y++],y=y%t;if(s=(s+1)%t,s===n&&(n=(n+1)%t),d-o<e)return;const x=g&&d-g;return x?Math.round(C*1e3/x):void 0}}function HKe(t,e){let r=0,i=1e3/e,s,n;const o=(d,g=Date.now())=>{r=g,s=null,n&&(clearTimeout(n),n=null),t.apply(null,d)};return[(...d)=>{const g=Date.now(),y=g-r;y>=i?o(d,g):(s=d,n||(n=setTimeout(()=>{n=null,o(s)},i-y)))},()=>s&&o(s)]}const XT=(t,e,r=3)=>{let i=0;const s=LKe(50,250);return HKe(n=>{const o=n.loaded,l=n.lengthComputable?n.total:void 0,h=o-i,d=s(h),g=o<=l;i=o;const y={loaded:o,total:l,progress:l?o/l:void 0,bytes:h,rate:d||void 0,estimated:d&&l&&g?(l-o)/d:void 0,event:n,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(y)},r)},bU=(t,e)=>{const r=t!=null;return[i=>e[0]({lengthComputable:r,total:t,loaded:i}),e[1]]},xU=t=>(...e)=>et.asap(()=>t(...e)),$Ke=ko.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,ko.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(ko.origin),ko.navigator&&/(msie|trident)/i.test(ko.navigator.userAgent)):()=>!0,BKe=ko.hasStandardBrowserEnv?{write(t,e,r,i,s,n){const o=[t+"="+encodeURIComponent(e)];et.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),et.isString(i)&&o.push("path="+i),et.isString(s)&&o.push("domain="+s),n===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function VKe(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function WKe(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function $te(t,e){return t&&!VKe(e)?WKe(t,e):e}const EU=t=>t instanceof ka?{...t}:t;function $g(t,e){e=e||{};const r={};function i(d,g,y,C){return et.isPlainObject(d)&&et.isPlainObject(g)?et.merge.call({caseless:C},d,g):et.isPlainObject(g)?et.merge({},g):et.isArray(g)?g.slice():g}function s(d,g,y,C){if(et.isUndefined(g)){if(!et.isUndefined(d))return i(void 0,d,y,C)}else return i(d,g,y,C)}function n(d,g){if(!et.isUndefined(g))return i(void 0,g)}function o(d,g){if(et.isUndefined(g)){if(!et.isUndefined(d))return i(void 0,d)}else return i(void 0,g)}function l(d,g,y){if(y in e)return i(d,g);if(y in t)return i(void 0,d)}const h={url:n,method:n,data:n,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(d,g,y)=>s(EU(d),EU(g),y,!0)};return et.forEach(Object.keys(Object.assign({},t,e)),function(g){const y=h[g]||s,C=y(t[g],e[g],g);et.isUndefined(C)&&y!==l||(r[g]=C)}),r}const Bte=t=>{const e=$g({},t);let{data:r,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:n,headers:o,auth:l}=e;e.headers=o=ka.from(o),e.url=kte($te(e.baseURL,e.url),t.params,t.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let h;if(et.isFormData(r)){if(ko.hasStandardBrowserEnv||ko.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((h=o.getContentType())!==!1){const[d,...g]=h?h.split(";").map(y=>y.trim()).filter(Boolean):[];o.setContentType([d||"multipart/form-data",...g].join("; "))}}if(ko.hasStandardBrowserEnv&&(i&&et.isFunction(i)&&(i=i(e)),i||i!==!1&&$Ke(e.url))){const d=s&&n&&BKe.read(n);d&&o.set(s,d)}return e},jKe=typeof XMLHttpRequest<"u",UKe=jKe&&function(t){return new Promise(function(r,i){const s=Bte(t);let n=s.data;const o=ka.from(s.headers).normalize();let{responseType:l,onUploadProgress:h,onDownloadProgress:d}=s,g,y,C,x,_;function E(){x&&x(),_&&_(),s.cancelToken&&s.cancelToken.unsubscribe(g),s.signal&&s.signal.removeEventListener("abort",g)}let R=new XMLHttpRequest;R.open(s.method.toUpperCase(),s.url,!0),R.timeout=s.timeout;function I(){if(!R)return;const H=ka.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),q={data:!l||l==="text"||l==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:H,config:t,request:R};Hte(function(Y){r(Y),E()},function(Y){i(Y),E()},q),R=null}"onloadend"in R?R.onloadend=I:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(I)},R.onabort=function(){R&&(i(new jr("Request aborted",jr.ECONNABORTED,t,R)),R=null)},R.onerror=function(){i(new jr("Network Error",jr.ERR_NETWORK,t,R)),R=null},R.ontimeout=function(){let z=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const q=s.transitional||Nte;s.timeoutErrorMessage&&(z=s.timeoutErrorMessage),i(new jr(z,q.clarifyTimeoutError?jr.ETIMEDOUT:jr.ECONNABORTED,t,R)),R=null},n===void 0&&o.setContentType(null),"setRequestHeader"in R&&et.forEach(o.toJSON(),function(z,q){R.setRequestHeader(q,z)}),et.isUndefined(s.withCredentials)||(R.withCredentials=!!s.withCredentials),l&&l!=="json"&&(R.responseType=s.responseType),d&&([C,_]=XT(d,!0),R.addEventListener("progress",C)),h&&R.upload&&([y,x]=XT(h),R.upload.addEventListener("progress",y),R.upload.addEventListener("loadend",x)),(s.cancelToken||s.signal)&&(g=H=>{R&&(i(!H||H.type?new U1(null,t,R):H),R.abort(),R=null)},s.cancelToken&&s.cancelToken.subscribe(g),s.signal&&(s.signal.aborted?g():s.signal.addEventListener("abort",g)));const F=DKe(s.url);if(F&&ko.protocols.indexOf(F)===-1){i(new jr("Unsupported protocol "+F+":",jr.ERR_BAD_REQUEST,t));return}R.send(n||null)})},zKe=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let i=new AbortController,s;const n=function(d){if(!s){s=!0,l();const g=d instanceof Error?d:this.reason;i.abort(g instanceof jr?g:new U1(g instanceof Error?g.message:g))}};let o=e&&setTimeout(()=>{o=null,n(new jr(`timeout ${e} of ms exceeded`,jr.ETIMEDOUT))},e);const l=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(n):d.removeEventListener("abort",n)}),t=null)};t.forEach(d=>d.addEventListener("abort",n));const{signal:h}=i;return h.unsubscribe=()=>et.asap(l),h}},GKe=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let i=0,s;for(;i<r;)s=i+e,yield t.slice(i,s),i=s},YKe=async function*(t,e){for await(const r of KKe(t))yield*GKe(r,e)},KKe=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:i}=await e.read();if(r)break;yield i}}finally{await e.cancel()}},TU=(t,e,r,i)=>{const s=YKe(t,e);let n=0,o,l=h=>{o||(o=!0,i&&i(h))};return new ReadableStream({async pull(h){try{const{done:d,value:g}=await s.next();if(d){l(),h.close();return}let y=g.byteLength;if(r){let C=n+=y;r(C)}h.enqueue(new Uint8Array(g))}catch(d){throw l(d),d}},cancel(h){return l(h),s.return()}},{highWaterMark:2})},_R=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Vte=_R&&typeof ReadableStream=="function",XKe=_R&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Wte=(t,...e)=>{try{return!!t(...e)}catch{return!1}},qKe=Vte&&Wte(()=>{let t=!1;const e=new Request(ko.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),_U=64*1024,KF=Vte&&Wte(()=>et.isReadableStream(new Response("").body)),qT={stream:KF&&(t=>t.body)};_R&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!qT[e]&&(qT[e]=et.isFunction(t[e])?r=>r[e]():(r,i)=>{throw new jr(`Response type '${e}' is not supported`,jr.ERR_NOT_SUPPORT,i)})})})(new Response);const JKe=async t=>{if(t==null)return 0;if(et.isBlob(t))return t.size;if(et.isSpecCompliantForm(t))return(await new Request(ko.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(et.isArrayBufferView(t)||et.isArrayBuffer(t))return t.byteLength;if(et.isURLSearchParams(t)&&(t=t+""),et.isString(t))return(await XKe(t)).byteLength},QKe=async(t,e)=>{const r=et.toFiniteNumber(t.getContentLength());return r??JKe(e)},ZKe=_R&&(async t=>{let{url:e,method:r,data:i,signal:s,cancelToken:n,timeout:o,onDownloadProgress:l,onUploadProgress:h,responseType:d,headers:g,withCredentials:y="same-origin",fetchOptions:C}=Bte(t);d=d?(d+"").toLowerCase():"text";let x=zKe([s,n&&n.toAbortSignal()],o),_;const E=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let R;try{if(h&&qKe&&r!=="get"&&r!=="head"&&(R=await QKe(g,i))!==0){let q=new Request(e,{method:"POST",body:i,duplex:"half"}),re;if(et.isFormData(i)&&(re=q.headers.get("content-type"))&&g.setContentType(re),q.body){const[Y,oe]=bU(R,XT(xU(h)));i=TU(q.body,_U,Y,oe)}}et.isString(y)||(y=y?"include":"omit");const I="credentials"in Request.prototype;_=new Request(e,{...C,signal:x,method:r.toUpperCase(),headers:g.normalize().toJSON(),body:i,duplex:"half",credentials:I?y:void 0});let F=await fetch(_);const H=KF&&(d==="stream"||d==="response");if(KF&&(l||H&&E)){const q={};["status","statusText","headers"].forEach(me=>{q[me]=F[me]});const re=et.toFiniteNumber(F.headers.get("content-length")),[Y,oe]=l&&bU(re,XT(xU(l),!0))||[];F=new Response(TU(F.body,_U,Y,()=>{oe&&oe(),E&&E()}),q)}d=d||"text";let z=await qT[et.findKey(qT,d)||"text"](F,t);return!H&&E&&E(),await new Promise((q,re)=>{Hte(q,re,{data:z,headers:ka.from(F.headers),status:F.status,statusText:F.statusText,config:t,request:_})})}catch(I){throw E&&E(),I&&I.name==="TypeError"&&/fetch/i.test(I.message)?Object.assign(new jr("Network Error",jr.ERR_NETWORK,t,_),{cause:I.cause||I}):jr.from(I,I&&I.code,t,_)}}),XF={http:gKe,xhr:UKe,fetch:ZKe};et.forEach(XF,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const RU=t=>`- ${t}`,eXe=t=>et.isFunction(t)||t===null||t===!1,jte={getAdapter:t=>{t=et.isArray(t)?t:[t];const{length:e}=t;let r,i;const s={};for(let n=0;n<e;n++){r=t[n];let o;if(i=r,!eXe(r)&&(i=XF[(o=String(r)).toLowerCase()],i===void 0))throw new jr(`Unknown adapter '${o}'`);if(i)break;s[o||"#"+n]=i}if(!i){const n=Object.entries(s).map(([l,h])=>`adapter ${l} `+(h===!1?"is not supported by the environment":"is not available in the build"));let o=e?n.length>1?`since :
`+n.map(RU).join(`
`):" "+RU(n[0]):"as no adapter specified";throw new jr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return i},adapters:XF};function x3(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new U1(null,t)}function AU(t){return x3(t),t.headers=ka.from(t.headers),t.data=b3.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),jte.getAdapter(t.adapter||yS.adapter)(t).then(function(i){return x3(t),i.data=b3.call(t,t.transformResponse,i),i.headers=ka.from(i.headers),i},function(i){return Lte(i)||(x3(t),i&&i.response&&(i.response.data=b3.call(t,t.transformResponse,i.response),i.response.headers=ka.from(i.response.headers))),Promise.reject(i)})}const Ute="1.7.9",RR={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{RR[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const OU={};RR.transitional=function(e,r,i){function s(n,o){return"[Axios v"+Ute+"] Transitional option '"+n+"'"+o+(i?". "+i:"")}return(n,o,l)=>{if(e===!1)throw new jr(s(o," has been removed"+(r?" in "+r:"")),jr.ERR_DEPRECATED);return r&&!OU[o]&&(OU[o]=!0,console.warn(s(o," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(n,o,l):!0}};RR.spelling=function(e){return(r,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function tXe(t,e,r){if(typeof t!="object")throw new jr("options must be an object",jr.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let s=i.length;for(;s-- >0;){const n=i[s],o=e[n];if(o){const l=t[n],h=l===void 0||o(l,n,t);if(h!==!0)throw new jr("option "+n+" must be "+h,jr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new jr("Unknown option "+n,jr.ERR_BAD_OPTION)}}const nE={assertOptions:tXe,validators:RR},yu=nE.validators;class yg{constructor(e){this.defaults=e,this.interceptors={request:new CU,response:new CU}}async request(e,r){try{return await this._request(e,r)}catch(i){if(i instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const n=s.stack?s.stack.replace(/^.+\n/,""):"";try{i.stack?n&&!String(i.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+n):i.stack=n}catch{}}throw i}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=$g(this.defaults,r);const{transitional:i,paramsSerializer:s,headers:n}=r;i!==void 0&&nE.assertOptions(i,{silentJSONParsing:yu.transitional(yu.boolean),forcedJSONParsing:yu.transitional(yu.boolean),clarifyTimeoutError:yu.transitional(yu.boolean)},!1),s!=null&&(et.isFunction(s)?r.paramsSerializer={serialize:s}:nE.assertOptions(s,{encode:yu.function,serialize:yu.function},!0)),nE.assertOptions(r,{baseUrl:yu.spelling("baseURL"),withXsrfToken:yu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=n&&et.merge(n.common,n[r.method]);n&&et.forEach(["delete","get","head","post","put","patch","common"],_=>{delete n[_]}),r.headers=ka.concat(o,n);const l=[];let h=!0;this.interceptors.request.forEach(function(E){typeof E.runWhen=="function"&&E.runWhen(r)===!1||(h=h&&E.synchronous,l.unshift(E.fulfilled,E.rejected))});const d=[];this.interceptors.response.forEach(function(E){d.push(E.fulfilled,E.rejected)});let g,y=0,C;if(!h){const _=[AU.bind(this),void 0];for(_.unshift.apply(_,l),_.push.apply(_,d),C=_.length,g=Promise.resolve(r);y<C;)g=g.then(_[y++],_[y++]);return g}C=l.length;let x=r;for(y=0;y<C;){const _=l[y++],E=l[y++];try{x=_(x)}catch(R){E.call(this,R);break}}try{g=AU.call(this,x)}catch(_){return Promise.reject(_)}for(y=0,C=d.length;y<C;)g=g.then(d[y++],d[y++]);return g}getUri(e){e=$g(this.defaults,e);const r=$te(e.baseURL,e.url);return kte(r,e.params,e.paramsSerializer)}}et.forEach(["delete","get","head","options"],function(e){yg.prototype[e]=function(r,i){return this.request($g(i||{},{method:e,url:r,data:(i||{}).data}))}});et.forEach(["post","put","patch"],function(e){function r(i){return function(n,o,l){return this.request($g(l||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:n,data:o}))}}yg.prototype[e]=r(),yg.prototype[e+"Form"]=r(!0)});class o5{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(n){r=n});const i=this;this.promise.then(s=>{if(!i._listeners)return;let n=i._listeners.length;for(;n-- >0;)i._listeners[n](s);i._listeners=null}),this.promise.then=s=>{let n;const o=new Promise(l=>{i.subscribe(l),n=l}).then(s);return o.cancel=function(){i.unsubscribe(n)},o},e(function(n,o,l){i.reason||(i.reason=new U1(n,o,l),r(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=i=>{e.abort(i)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new o5(function(s){e=s}),cancel:e}}}function rXe(t){return function(r){return t.apply(null,r)}}function nXe(t){return et.isObject(t)&&t.isAxiosError===!0}const qF={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qF).forEach(([t,e])=>{qF[e]=t});function zte(t){const e=new yg(t),r=bte(yg.prototype.request,e);return et.extend(r,yg.prototype,e,{allOwnKeys:!0}),et.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return zte($g(t,s))},r}const Ss=zte(yS);Ss.Axios=yg;Ss.CanceledError=U1;Ss.CancelToken=o5;Ss.isCancel=Lte;Ss.VERSION=Ute;Ss.toFormData=TR;Ss.AxiosError=jr;Ss.Cancel=Ss.CanceledError;Ss.all=function(e){return Promise.all(e)};Ss.spread=rXe;Ss.isAxiosError=nXe;Ss.mergeConfig=$g;Ss.AxiosHeaders=ka;Ss.formToJSON=t=>Dte(et.isHTMLForm(t)?new FormData(t):t);Ss.getAdapter=jte.getAdapter;Ss.HttpStatusCode=qF;Ss.default=Ss;const iXe=()=>{const t=["Ngy","STT","Tn","n v","S lng","n gi","Thnh tin","Tng"],[e,r]=He.useState([]),[i,s]=He.useState([]),[n,o]=He.useState(null),[l,h]=He.useState(""),[d,g]=He.useState(!1),[y,C]=He.useState(""),[x,_]=He.useState([]),[E,R]=He.useState(!1),[I,F]=He.useState(""),H=He.useRef(null),[z,q]=He.useState(!1),[re,Y]=He.useState(!0);He.useEffect(()=>{const k=L=>{H.current&&!H.current.contains(L.target)&&R(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);function oe(k){const L={};return k.forEach(D=>{L[D]=""}),L}const me=()=>{if(!y){alert("Vui lng nhp tn file");return}h(y),r(t);const k=Array(20).fill(null).map(()=>oe(t));s(k),g(!1),C("")},de=()=>{const k=[...i,oe(e)];s(pt(k))},Re=()=>{const k=prompt("Nhp tn ct mi:");if(k&&!e.includes(k)){const L=[...e,k];r(L);const D=i.map(K=>({...K,[k]:""}));s(D)}},Ie=(k,L)=>{const[D,K]=k.split("/").map(Number),[Q,pe]=L.split("/").map(Number);return K!==pe?K-pe:D-Q},Be=(k,L,D)=>{if(!L.Ngy)return"";let K="",Q=D;for(let j=D;j>=0;j--)if(k[j].Ngy&&k[j].STT){K=k[j].STT,Q=j;break}if(!K)return"";let pe=D+1;for(;pe<k.length&&(!k[pe].Ngy||!k[pe].STT);)pe++;let ye=0;for(let j=Q;j<pe;j++)k[j]["Thnh tin"]&&(ye+=Number(k[j]["Thnh tin"])||0);return ye||""},lt=(k,L,D)=>{let K=[...i];if(L==="Ngy"){if(!/^(0?[1-9]|[12][0-9]|3[01])\/(0?[1-9]|1[0-2])$/.test(D)&&D!==""){alert("Vui lng nhp ngy theo nh dng dd/mm");return}K[k][L]=D,K=pt(K)}else if(L==="S lng"||L==="n gi"){const Q=D.replace(/[^0-9]/g,"");K[k][L]=Q;const pe=Number(K[k]["S lng"])||0,ye=Number(K[k]["n gi"])||0;K[k]["Thnh tin"]=pe*ye,K=K.map((j,X)=>(j.Ngy?j.Tng=Be(K,j,X):j.Tng="",j))}else L!=="STT"&&L!=="Thnh tin"&&L!=="Tng"&&(K[k][L]=D);s(K),L!=="Tn"&&o(null)},pt=k=>{const L=k.map((D,K)=>({...D,originalIndex:K})).filter(D=>D.Ngy);if(L.length>0){L.sort((pe,ye)=>Ie(pe.Ngy,ye.Ngy));let D=1;const K=new Map;L.forEach(pe=>{K.set(pe.originalIndex,D++)});const Q=k.map((pe,ye)=>(pe.Ngy?(pe.STT=K.get(ye),pe.Tng=Be(k,pe)):(pe.STT="",pe.Tng=""),pe));for(let pe=0;pe<Q.length;pe++){const ye=Be(Q,Q[pe],pe);ye>0?Q[pe].Tng=ye:Q[pe].Tng=""}return Q}return k},Ct=()=>{try{if(!i||!e||e.length===0)throw new Error("D liu khng hp l");const k=i.filter(j=>Object.values(j).some(X=>X!==""&&X!==null&&X!==void 0)),L=Fw.book_new(),D=[["Tn file"],[],e];k.forEach(j=>{const X=e.map(te=>j[te]||"");D.push(X)});const K=k.reduce((j,X)=>j+(Number(X["Thnh tin"])||0),0),Q=k.reduce((j,X)=>j+(Number(X.Tng)||0),0);if(re){const j=K*.03,X=Q*.03,te=K-j,we=Q-X;D.push(Array(e.length).fill(""),["","","Tng tin","","","",K,Q],["","","Chit khu 3%","","","",j,X],["","","Tng","","","",te,we])}else D.push(Array(e.length).fill(""),["","","Tng thnh tin","","","",K,Q]);const pe=Fw.aoa_to_sheet(D);pe["!merges"]=[{s:{r:0,c:0},e:{r:0,c:4}}];const ye=Fw.decode_range(pe["!ref"]);for(let j=ye.s.r;j<=ye.e.r;j++)for(let X=ye.s.c;X<=ye.e.c;X++){const te=Fw.encode_cell({r:j,c:X});pe[te]&&(pe[te].s={font:{name:"Arial",sz:j===0?40:11,bold:j===0||j===2||j>ye.e.r-3},alignment:{vertical:"center",horizontal:X===2?"left":"center",wrapText:!0},border:{top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}},j>2&&(X===5||X===6||X===7)&&(pe[te].z="#,##0",pe[te].v&&(pe[te].t="n")))}pe["!cols"]=e.map(j=>({wch:j==="Tn"?30:15})),pe["!rows"]=[{hpt:50}],Fw.book_append_sheet(L,pe,"Bng d liu"),pYe(L,`${l||"bang_du_lieu"}.xlsx`)}catch(k){throw console.error("Li xut Excel:",k),new Error("Khng th xut file Excel. Vui lng th li.")}},ct=(k,L)=>{let D;return function(...Q){const pe=()=>{clearTimeout(D),k(...Q)};clearTimeout(D),D=setTimeout(pe,L)}},Ue=async k=>{if(!k.trim()){_([]);return}try{q(!0);const D=(await Ss.get("https://backend-giahung.onrender.com/api/products/search",{params:{q:k,limit:10}})).data.data.map(K=>({...K,relevance:Je(K.name,k)})).sort((K,Q)=>Q.relevance-K.relevance).slice(0,10);_(D)}catch(L){console.error("Error searching products:",L),_([])}finally{q(!1)}},Je=(k,L)=>{const D=k.toLowerCase(),K=L.toLowerCase();return D===K?100:D.startsWith(K)?80:D.includes(` ${K} `)?60:D.includes(K)?40:0},Fe=He.useCallback(ct(k=>Ue(k),300),[]),A=(k,L)=>{const D=[...i];if(D[L].Tn=k.name,D[L]["n v"]=k.unit,D[L]["n gi"]=k.price,D[L]["S lng"]){const K=Number(D[L]["S lng"]);D[L]["Thnh tin"]=K*k.price}s(D),R(!1),F("")},O=k=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(k);return V.jsxs("div",{className:"tool-container",children:[V.jsx("h1",{children:"Excel Tool"}),V.jsxs("div",{className:"tool-header",children:[V.jsx("button",{onClick:()=>g(!0),className:"create-btn",children:"Create New File"}),l&&V.jsxs("div",{className:"current-file",children:["Current file: ",l]})]}),d&&V.jsx("div",{className:"modal",children:V.jsxs("div",{className:"modal-content",children:[V.jsx("h2",{children:"Create New Excel File"}),V.jsx("input",{type:"text",value:y,onChange:k=>C(k.target.value),placeholder:"Enter file name (without extension)",className:"file-name-input"}),V.jsxs("div",{className:"modal-buttons",children:[V.jsx("button",{onClick:me,className:"create-btn",children:"Create"}),V.jsx("button",{onClick:()=>{g(!1),C("")},className:"cancel-btn",children:"Cancel"})]})]})}),e.length>0&&V.jsxs(V.Fragment,{children:[V.jsxs("div",{className:"table-controls",children:[V.jsx("button",{onClick:de,className:"control-btn",children:"Add Row"}),V.jsx("button",{onClick:Re,className:"control-btn",children:"Add Column"}),V.jsxs("div",{className:"tax-control",children:[V.jsx("input",{type:"checkbox",id:"taxCheckbox",checked:re,onChange:k=>Y(k.target.checked)}),V.jsx("label",{htmlFor:"taxCheckbox",children:"Tnh thu v chit khu"})]}),V.jsx("button",{onClick:Ct,className:"export-btn",children:"Export to Excel"})]}),V.jsx("div",{className:"table-container",children:V.jsxs("table",{className:"min-w-full border-collapse border border-gray-300",children:[V.jsx("thead",{children:V.jsx("tr",{children:e.map(k=>V.jsx("th",{className:"border border-gray-300 bg-gray-100 px-4 py-2 text-center",children:k},k))})}),V.jsx("tbody",{children:i.map((k,L)=>V.jsx("tr",{children:e.map(D=>V.jsx("td",{onClick:()=>{["STT","Thnh tin","Tng"].includes(D)||(o({rowIndex:L,column:D}),D==="Tn"&&F(k[D]))},className:`relative border border-gray-300 px-4 py-4
                          ${!k.Ngy&&(D==="STT"||D==="Tng")?"text-transparent":""}
                          ${["STT","Thnh tin","Tng"].includes(D)?"bg-gray-50":""}
                          ${["Ngy","STT","n v","S lng","n gi","Thnh tin","Tng"].includes(D)?"text-center":""}
                          ${D==="Tn"?"text-left":""}`,children:(n==null?void 0:n.rowIndex)===L&&(n==null?void 0:n.column)===D?V.jsxs("div",{ref:D==="Tn"?H:null,children:[V.jsx("input",{type:"text",value:D==="Tn"?I:k[D],autoFocus:!0,className:`w-full px-2 py-1 border border-blue-500 rounded
                                ${["Ngy","STT","n v","S lng","n gi","Thnh tin","Tng"].includes(D)?"text-center":"text-left"}`,onChange:K=>{if(D==="Tn")F(K.target.value),Fe(K.target.value),R(!0);else{const Q=[...i];Q[L][D]=K.target.value,s(Q)}},onBlur:K=>{lt(L,D,K.target.value),D!=="Tn"&&o(null)},onKeyPress:K=>{K.key==="Enter"&&(lt(L,D,K.target.value),o(null))}}),D==="Tn"&&E&&V.jsx("div",{className:"suggestions-container",children:z?V.jsx("div",{className:"suggestion-item loading",children:"ang tm kim..."}):x.length>0?x.map((K,Q)=>V.jsx("div",{className:"suggestion-item",onClick:()=>A(K,L),children:K.name},Q)):I&&V.jsx("div",{className:"suggestion-item no-results",children:"Khng tm thy kt qu"})})]}):!k.Ngy&&(D==="STT"||D==="Tng")?"":["n gi","Thnh tin","Tng"].includes(D)&&k[D]!==""?O(Number(k[D])||0):k[D]},`${L}-${D}`))},L))})]})})]})]})},sXe=()=>{const t=YM(),e=MC(),[r,i]=He.useState(!0),[s,n]=He.useState("dashboard"),[o,l]=He.useState("");He.useEffect(()=>{const g=localStorage.getItem("userRole");l(g||"")},[]),Cr.useEffect(()=>{var g;(g=e.state)!=null&&g.showToast&&Vt.success("ng nhp thnh cng!")},[e]);const h=()=>{localStorage.removeItem("token"),t("/login")},d=()=>[{id:"dashboard",label:"Dashboard",icon:""},{id:"products",label:"Products",icon:""},{id:"categories",label:"Categories",icon:""},{id:"customers",label:"Customers",icon:""},{id:"settings",label:"Settings",icon:""},{id:"tool",label:"Tool",icon:""}];return V.jsxs("div",{className:"min-h-1 flex bg-gray-100",children:[V.jsxs("div",{className:`bg-white shadow-lg ${r?"w-64":"w-20"} transition-all duration-300`,children:[V.jsxs("div",{className:"p-4 flex justify-between items-center border-b",children:[V.jsx("h2",{className:`font-bold ${r?"block":"hidden"}`,children:"Admin Panel"}),V.jsx("button",{onClick:()=>i(!r),className:"p-2 rounded-lg hover:bg-gray-100",children:r?"":""})]}),V.jsx("nav",{className:"mt-4",children:d().map(g=>V.jsxs("button",{onClick:()=>n(g.id),className:`w-full flex items-center p-3 hover:bg-blue-50 transition-colors
                ${s===g.id?"bg-blue-100 text-blue-600":""}
                ${r?"justify-start":"justify-center"}`,children:[V.jsx("span",{className:"text-xl",children:g.icon}),r&&V.jsx("span",{className:"ml-3",children:g.label})]},g.id))})]}),V.jsxs("div",{className:"flex-1",children:[V.jsx("header",{className:"bg-white shadow-md",children:V.jsxs("div",{className:"flex justify-between items-center px-8 py-4",children:[V.jsx("h1",{className:"text-2xl font-bold",children:"Welcome to Dashboard"}),V.jsx("button",{onClick:h,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"Logout"})]})}),V.jsx("main",{className:"p-8",children:V.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[s==="dashboard"&&V.jsx(gce,{}),s==="products"&&V.jsx(uce,{}),s==="categories"&&V.jsx(hce,{}),s==="customers"&&V.jsx(fce,{}),s==="settings"&&V.jsx($9e,{}),s==="tool"&&V.jsx(iXe,{})]})})]}),V.jsx(hY,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0})]})},Sh="https://backend-giahung.onrender.com/api",IU={async login(t){try{console.log("Login request:",{url:`${Sh}/auth/login`,body:t});const r=await(await fetch(`${Sh}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("Login response:",r),r.status==="success"&&(localStorage.setItem("token",r.tokens.accessToken),localStorage.setItem("userName",r.user.name),localStorage.setItem("userRole",r.user.role),localStorage.setItem("userId",r.user.id),console.log("Stored user info:",{token:r.tokens.accessToken,name:r.user.name,role:r.user.role,id:r.user.id})),r}catch(e){throw console.error("Login error:",e),e}},async register(t){try{console.log("Register request:",{url:`${Sh}/auth/register`,body:t});const r=await(await fetch(`${Sh}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("Register response:",r),r}catch(e){throw console.error("Register error:",e),e}},async getProducts(){return(await fetch(`${Sh}/products`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json()},async getCategories(){return(await fetch(`${Sh}/categories`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json()},async verifyToken(){try{const t=localStorage.getItem("token");return t?(await fetch(`${Sh}users/me`,{headers:{Authorization:`Bearer ${t}`}})).ok:!1}catch{return!1}},async getCurrentUser(){try{const t=localStorage.getItem("token");console.log("Token for getCurrentUser:",t);const e=await fetch(`${Sh}/auth/profile`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to get user data");const r=await e.json();return console.log("Get user response:",r),r}catch(t){throw console.error("Get user error:",t),t}},async refreshToken(){try{const t=localStorage.getItem("refreshToken"),r=await(await fetch(`${Sh}/auth/refresh-token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})})).json();return console.log("Refresh token response:",r),r}catch(t){throw console.error("Refresh token error:",t),t}}};function oXe(){const t=YM(),[e,r]=He.useState(!0),[i,s]=He.useState({email:"",password:"",name:""}),n=async o=>{o.preventDefault();try{if(e){const l=await IU.login(i);l.status==="success"?(localStorage.setItem("token",l.tokens.accessToken),Vt.success("ng nhp thnh cng!"),t("/",{replace:!0})):Vt.error("ng nhp tht bi. Vui lng kim tra li thng tin!")}else{const l=await IU.register(i);l.user&&l.tokens?(Vt.success("ng k thnh cng!"),r(!0)):Vt.error("ng k tht bi. Vui lng th li!")}}catch(l){console.error(e?"Login error:":"Signup error:",l),Vt.error(e?"ng nhp tht bi!":"ng k tht bi!")}};return V.jsxs("div",{className:"min-h-screen",children:[V.jsx(hY,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0}),V.jsx("div",{className:"wrapper",children:V.jsxs("div",{className:"form-box",children:[V.jsxs("div",{className:"button-box",children:[V.jsx("button",{className:`toggle-btn ${e?"active":""}`,onClick:()=>r(!0),children:"Login"}),V.jsx("button",{className:`toggle-btn ${e?"":"active"}`,onClick:()=>r(!1),children:"Sign up"})]}),V.jsxs("form",{onSubmit:n,className:`input-group ${e?"active":""}`,children:[V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"email",placeholder:"Email",value:i.email,onChange:o=>s({...i,email:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"password",placeholder:"Password",value:i.password,onChange:o=>s({...i,password:o.target.value}),required:!0})}),e&&V.jsx("div",{className:"forgot-password",children:V.jsx("a",{href:"#",children:"Forgot Password?"})}),V.jsx("button",{type:"submit",className:"submit-btn",children:e?"Login":"Sign up"})]}),V.jsxs("form",{onSubmit:n,className:`input-group ${e?"":"active"}`,children:[V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"text",placeholder:"Full Name",value:i.name,onChange:o=>s({...i,name:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"email",placeholder:"Email",value:i.email,onChange:o=>s({...i,email:o.target.value}),required:!0})}),V.jsx("div",{className:"input-field",children:V.jsx("input",{type:"password",placeholder:"Password",value:i.password,onChange:o=>s({...i,password:o.target.value}),required:!0})}),V.jsx("button",{type:"submit",className:"submit-btn",children:"Sign up"})]})]})})]})}const aXe=({children:t})=>localStorage.getItem("token")?t:V.jsx(nY,{to:"/login"});function lXe(){return V.jsx(Cle,{children:V.jsxs(vle,{children:[V.jsx(A2,{path:"/",element:V.jsx(aXe,{children:V.jsx(sXe,{})})}),V.jsx(A2,{path:"/login",element:V.jsx(oXe,{})}),V.jsx(A2,{path:"*",element:V.jsx(nY,{to:"/"})})]})})}E3.createRoot(document.getElementById("root")).render(V.jsx(Cr.StrictMode,{children:V.jsx(lXe,{})}))});export default cXe();
